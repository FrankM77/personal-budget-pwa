(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function d6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fx={exports:{}},Kf={};var s2;function f6(){if(s2)return Kf;s2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Kf.Fragment=e,Kf.jsx=t,Kf.jsxs=t,Kf}var o2;function h6(){return o2||(o2=1,fx.exports=f6()),fx.exports}var v=h6(),hx={exports:{}},dt={};var l2;function p6(){if(l2)return dt;l2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(G,$,Z){this.props=G,this.context=$,this.refs=S,this.updater=Z||_}T.prototype.isReactComponent={},T.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function C(){}C.prototype=T.prototype;function D(G,$,Z){this.props=G,this.context=$,this.refs=S,this.updater=Z||_}var O=D.prototype=new C;O.constructor=D,w(O,T.prototype),O.isPureReactComponent=!0;var M=Array.isArray;function V(){}var A={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(G,$,Z){var ee=Z.ref;return{$$typeof:n,type:G,key:$,ref:ee!==void 0?ee:null,props:Z}}function z(G,$){return k(G.type,$,G.props)}function L(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function B(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(Z){return $[Z]})}var P=/\/+/g;function J(G,$){return typeof G=="object"&&G!==null&&G.key!=null?B(""+G.key):$.toString(36)}function Y(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(V,V):(G.status="pending",G.then(function($){G.status==="pending"&&(G.status="fulfilled",G.value=$)},function($){G.status==="pending"&&(G.status="rejected",G.reason=$)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function H(G,$,Z,ee,le){var he=typeof G;(he==="undefined"||he==="boolean")&&(G=null);var se=!1;if(G===null)se=!0;else switch(he){case"bigint":case"string":case"number":se=!0;break;case"object":switch(G.$$typeof){case n:case e:se=!0;break;case h:return se=G._init,H(se(G._payload),$,Z,ee,le)}}if(se)return le=le(G),se=ee===""?"."+J(G,0):ee,M(le)?(Z="",se!=null&&(Z=se.replace(P,"$&/")+"/"),H(le,$,Z,"",function(Ge){return Ge})):le!=null&&(L(le)&&(le=z(le,Z+(le.key==null||G&&G.key===le.key?"":(""+le.key).replace(P,"$&/")+"/")+se)),$.push(le)),1;se=0;var Se=ee===""?".":ee+":";if(M(G))for(var Me=0;Me<G.length;Me++)ee=G[Me],he=Se+J(ee,Me),se+=H(ee,$,Z,he,le);else if(Me=b(G),typeof Me=="function")for(G=Me.call(G),Me=0;!(ee=G.next()).done;)ee=ee.value,he=Se+J(ee,Me++),se+=H(ee,$,Z,he,le);else if(he==="object"){if(typeof G.then=="function")return H(Y(G),$,Z,ee,le);throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return se}function W(G,$,Z){if(G==null)return G;var ee=[],le=0;return H(G,ee,"","",function(he){return $.call(Z,he,le++)}),ee}function K(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(Z){(G._status===0||G._status===-1)&&(G._status=1,G._result=Z)},function(Z){(G._status===0||G._status===-1)&&(G._status=2,G._result=Z)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var de=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},te={map:W,forEach:function(G,$,Z){W(G,function(){$.apply(this,arguments)},Z)},count:function(G){var $=0;return W(G,function(){$++}),$},toArray:function(G){return W(G,function($){return $})||[]},only:function(G){if(!L(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return dt.Activity=p,dt.Children=te,dt.Component=T,dt.Fragment=t,dt.Profiler=i,dt.PureComponent=D,dt.StrictMode=r,dt.Suspense=u,dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,dt.__COMPILER_RUNTIME={__proto__:null,c:function(G){return A.H.useMemoCache(G)}},dt.cache=function(G){return function(){return G.apply(null,arguments)}},dt.cacheSignal=function(){return null},dt.cloneElement=function(G,$,Z){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var ee=w({},G.props),le=G.key;if($!=null)for(he in $.key!==void 0&&(le=""+$.key),$)!I.call($,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&$.ref===void 0||(ee[he]=$[he]);var he=arguments.length-2;if(he===1)ee.children=Z;else if(1<he){for(var se=Array(he),Se=0;Se<he;Se++)se[Se]=arguments[Se+2];ee.children=se}return k(G.type,le,ee)},dt.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},dt.createElement=function(G,$,Z){var ee,le={},he=null;if($!=null)for(ee in $.key!==void 0&&(he=""+$.key),$)I.call($,ee)&&ee!=="key"&&ee!=="__self"&&ee!=="__source"&&(le[ee]=$[ee]);var se=arguments.length-2;if(se===1)le.children=Z;else if(1<se){for(var Se=Array(se),Me=0;Me<se;Me++)Se[Me]=arguments[Me+2];le.children=Se}if(G&&G.defaultProps)for(ee in se=G.defaultProps,se)le[ee]===void 0&&(le[ee]=se[ee]);return k(G,he,le)},dt.createRef=function(){return{current:null}},dt.forwardRef=function(G){return{$$typeof:c,render:G}},dt.isValidElement=L,dt.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:K}},dt.memo=function(G,$){return{$$typeof:d,type:G,compare:$===void 0?null:$}},dt.startTransition=function(G){var $=A.T,Z={};A.T=Z;try{var ee=G(),le=A.S;le!==null&&le(Z,ee),typeof ee=="object"&&ee!==null&&typeof ee.then=="function"&&ee.then(V,de)}catch(he){de(he)}finally{$!==null&&Z.types!==null&&($.types=Z.types),A.T=$}},dt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},dt.use=function(G){return A.H.use(G)},dt.useActionState=function(G,$,Z){return A.H.useActionState(G,$,Z)},dt.useCallback=function(G,$){return A.H.useCallback(G,$)},dt.useContext=function(G){return A.H.useContext(G)},dt.useDebugValue=function(){},dt.useDeferredValue=function(G,$){return A.H.useDeferredValue(G,$)},dt.useEffect=function(G,$){return A.H.useEffect(G,$)},dt.useEffectEvent=function(G){return A.H.useEffectEvent(G)},dt.useId=function(){return A.H.useId()},dt.useImperativeHandle=function(G,$,Z){return A.H.useImperativeHandle(G,$,Z)},dt.useInsertionEffect=function(G,$){return A.H.useInsertionEffect(G,$)},dt.useLayoutEffect=function(G,$){return A.H.useLayoutEffect(G,$)},dt.useMemo=function(G,$){return A.H.useMemo(G,$)},dt.useOptimistic=function(G,$){return A.H.useOptimistic(G,$)},dt.useReducer=function(G,$,Z){return A.H.useReducer(G,$,Z)},dt.useRef=function(G){return A.H.useRef(G)},dt.useState=function(G){return A.H.useState(G)},dt.useSyncExternalStore=function(G,$,Z){return A.H.useSyncExternalStore(G,$,Z)},dt.useTransition=function(){return A.H.useTransition()},dt.version="19.2.0",dt}var c2;function iw(){return c2||(c2=1,hx.exports=p6()),hx.exports}var U=iw();const Em=d6(U);var px={exports:{}},Xf={},gx={exports:{}},mx={};var u2;function g6(){return u2||(u2=1,(function(n){function e(H,W){var K=H.length;H.push(W);e:for(;0<K;){var de=K-1>>>1,te=H[de];if(0<i(te,W))H[de]=W,H[K]=te,K=de;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var W=H[0],K=H.pop();if(K!==W){H[0]=K;e:for(var de=0,te=H.length,G=te>>>1;de<G;){var $=2*(de+1)-1,Z=H[$],ee=$+1,le=H[ee];if(0>i(Z,K))ee<te&&0>i(le,Z)?(H[de]=le,H[ee]=K,de=ee):(H[de]=Z,H[$]=K,de=$);else if(ee<te&&0>i(le,K))H[de]=le,H[ee]=K,de=ee;else break e}}return W}function i(H,W){var K=H.sortIndex-W.sortIndex;return K!==0?K:H.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function O(H){for(var W=t(d);W!==null;){if(W.callback===null)r(d);else if(W.startTime<=H)r(d),W.sortIndex=W.expirationTime,e(u,W);else break;W=t(d)}}function M(H){if(w=!1,O(H),!_)if(t(u)!==null)_=!0,V||(V=!0,B());else{var W=t(d);W!==null&&Y(M,W.startTime-H)}}var V=!1,A=-1,I=5,k=-1;function z(){return S?!0:!(n.unstable_now()-k<I)}function L(){if(S=!1,V){var H=n.unstable_now();k=H;var W=!0;try{e:{_=!1,w&&(w=!1,C(A),A=-1),b=!0;var K=m;try{t:{for(O(H),p=t(u);p!==null&&!(p.expirationTime>H&&z());){var de=p.callback;if(typeof de=="function"){p.callback=null,m=p.priorityLevel;var te=de(p.expirationTime<=H);if(H=n.unstable_now(),typeof te=="function"){p.callback=te,O(H),W=!0;break t}p===t(u)&&r(u),O(H)}else r(u);p=t(u)}if(p!==null)W=!0;else{var G=t(d);G!==null&&Y(M,G.startTime-H),W=!1}}break e}finally{p=null,m=K,b=!1}W=void 0}}finally{W?B():V=!1}}}var B;if(typeof D=="function")B=function(){D(L)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,J=P.port2;P.port1.onmessage=L,B=function(){J.postMessage(null)}}else B=function(){T(L,0)};function Y(H,W){A=T(function(){H(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(H){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var K=m;m=W;try{return H()}finally{m=K}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(H,W){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var K=m;m=H;try{return W()}finally{m=K}},n.unstable_scheduleCallback=function(H,W,K){var de=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?de+K:de):K=de,H){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=K+te,H={id:h++,callback:W,priorityLevel:H,startTime:K,expirationTime:te,sortIndex:-1},K>de?(H.sortIndex=K,e(d,H),t(u)===null&&H===t(d)&&(w?(C(A),A=-1):w=!0,Y(M,K-de))):(H.sortIndex=te,e(u,H),_||b||(_=!0,V||(V=!0,B()))),H},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(H){var W=m;return function(){var K=m;m=W;try{return H.apply(this,arguments)}finally{m=K}}}})(mx)),mx}var d2;function m6(){return d2||(d2=1,gx.exports=g6()),gx.exports}var vx={exports:{}},Ar={};var f2;function v6(){if(f2)return Ar;f2=1;var n=iw();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ar.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},Ar.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},Ar.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Ar.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Ar.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ar.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Ar.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ar.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Ar.requestFormReset=function(u){r.d.r(u)},Ar.unstable_batchedUpdates=function(u,d){return u(d)},Ar.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},Ar.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ar.version="19.2.0",Ar}var h2;function y6(){if(h2)return vx.exports;h2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vx.exports=v6(),vx.exports}var p2;function b6(){if(p2)return Xf;p2=1;var n=m6(),e=iw(),t=y6();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var E=x.alternate;if(E===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===f)return u(x),s;if(E===g)return u(x),l;E=E.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=E;else{for(var N=!1,F=x.child;F;){if(F===f){N=!0,f=x,g=E;break}if(F===g){N=!0,g=x,f=E;break}F=F.sibling}if(!N){for(F=E.child;F;){if(F===f){N=!0,f=E,g=x;break}if(F===g){N=!0,g=E,f=x;break}F=F.sibling}if(!N)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),D=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function J(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case M:return"Suspense";case V:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case D:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case O:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:J(s.type)||"Memo";case I:l=s._payload,s=s._init;try{return J(s(l))}catch{}}return null}var Y=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},de=[],te=-1;function G(s){return{current:s}}function $(s){0>te||(s.current=de[te],de[te]=null,te--)}function Z(s,l){te++,de[te]=s.current,s.current=l}var ee=G(null),le=G(null),he=G(null),se=G(null);function Se(s,l){switch(Z(he,l),Z(le,s),Z(ee,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?RC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=RC(l),s=DC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}$(ee),Z(ee,s)}function Me(){$(ee),$(le),$(he)}function Ge(s){s.memoizedState!==null&&Z(se,s);var l=ee.current,f=DC(l,s.type);l!==f&&(Z(le,s),Z(ee,f))}function Ee(s){le.current===s&&($(ee),$(le)),se.current===s&&($(se),qf._currentValue=K)}var ke,ut;function Le(s){if(ke===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);ke=l&&l[1]||"",ut=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ke+s+ut}var Fe=!1;function we(s,l){if(!s||Fe)return"";Fe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(ge){var fe=ge}Reflect.construct(s,[],be)}else{try{be.call()}catch(ge){fe=ge}s.call(be.prototype)}}else{try{throw Error()}catch(ge){fe=ge}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(ge){if(ge&&fe&&typeof ge.stack=="string")return[ge.stack,fe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=g.DetermineComponentFrameRoot(),N=E[0],F=E[1];if(N&&F){var X=N.split(`
`),ue=F.split(`
`);for(x=g=0;g<X.length&&!X[g].includes("DetermineComponentFrameRoot");)g++;for(;x<ue.length&&!ue[x].includes("DetermineComponentFrameRoot");)x++;if(g===X.length||x===ue.length)for(g=X.length-1,x=ue.length-1;1<=g&&0<=x&&X[g]!==ue[x];)x--;for(;1<=g&&0<=x;g--,x--)if(X[g]!==ue[x]){if(g!==1||x!==1)do if(g--,x--,0>x||X[g]!==ue[x]){var ve=`
`+X[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{Fe=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Le(f):""}function ze(s,l){switch(s.tag){case 26:case 27:case 5:return Le(s.type);case 16:return Le("Lazy");case 13:return s.child!==l&&l!==null?Le("Suspense Fallback"):Le("Suspense");case 19:return Le("SuspenseList");case 0:case 15:return we(s.type,!1);case 11:return we(s.type.render,!1);case 1:return we(s.type,!0);case 31:return Le("Activity");default:return""}}function st(s){try{var l="",f=null;do l+=ze(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Ne=Object.prototype.hasOwnProperty,Pe=n.unstable_scheduleCallback,nt=n.unstable_cancelCallback,Qe=n.unstable_shouldYield,Ft=n.unstable_requestPaint,rt=n.unstable_now,bt=n.unstable_getCurrentPriorityLevel,Ot=n.unstable_ImmediatePriority,an=n.unstable_UserBlockingPriority,Bn=n.unstable_NormalPriority,Or=n.unstable_LowPriority,ls=n.unstable_IdlePriority,_i=n.log,Xi=n.unstable_setDisableYieldValue,jr=null,An=null;function dr(s){if(typeof _i=="function"&&Xi(s),An&&typeof An.setStrictMode=="function")try{An.setStrictMode(jr,s)}catch{}}var sn=Math.clz32?Math.clz32:ba,Js=Math.log,ya=Math.LN2;function ba(s){return s>>>=0,s===0?32:31-(Js(s)/ya|0)|0}var Ce=256,Ze=262144,Dt=4194304;function Je(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function fn(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,E=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var F=g&134217727;return F!==0?(g=F&~E,g!==0?x=Je(g):(N&=F,N!==0?x=Je(N):f||(f=F&~s,f!==0&&(x=Je(f))))):(F=g&~E,F!==0?x=Je(F):N!==0?x=Je(N):f||(f=g&~s,f!==0&&(x=Je(f)))),x===0?0:l!==0&&l!==x&&(l&E)===0&&(E=x&-x,f=l&-l,E>=f||E===32&&(f&4194048)!==0)?l:x}function on(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Vr(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Un(){var s=Dt;return Dt<<=1,(Dt&62914560)===0&&(Dt=4194304),s}function Et(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function It(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function bn(s,l,f,g,x,E){var N=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var F=s.entanglements,X=s.expirationTimes,ue=s.hiddenUpdates;for(f=N&~f;0<f;){var ve=31-sn(f),be=1<<ve;F[ve]=0,X[ve]=-1;var fe=ue[ve];if(fe!==null)for(ue[ve]=null,ve=0;ve<fe.length;ve++){var ge=fe[ve];ge!==null&&(ge.lane&=-536870913)}f&=~be}g!==0&&jt(s,g,0),E!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=E&~(N&~l))}function jt(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-sn(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function xn(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-sn(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function xt(s,l){var f=l&-l;return f=(f&42)!==0?1:tn(f),(f&(s.suspendedLanes|l))!==0?0:f}function tn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function _n(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function xa(){var s=W.p;return s!==0?s:(s=window.event,s===void 0?32:JC(s.type))}function Mn(s,l){var f=W.p;try{return W.p=s,l()}finally{W.p=f}}var nr=Math.random().toString(36).slice(2),Bt="__reactFiber$"+nr,fr="__reactProps$"+nr,_a="__reactContainer$"+nr,Gc="__reactEvents$"+nr,yy="__reactListeners$"+nr,ng="__reactHandles$"+nr,rg="__reactResources$"+nr,wa="__reactMarker$"+nr;function qc(s){delete s[Bt],delete s[fr],delete s[Gc],delete s[yy],delete s[ng]}function Ea(s){var l=s[Bt];if(l)return l;for(var f=s.parentNode;f;){if(l=f[_a]||f[Bt]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=VC(s);s!==null;){if(f=s[Bt])return f;s=VC(s)}return l}s=f,f=s.parentNode}return null}function wi(s){if(s=s[Bt]||s[_a]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function li(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function Sa(s){var l=s[rg];return l||(l=s[rg]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Fn(s){s[wa]=!0}var Wd=new Set,Qd={};function Ta(s,l){Aa(s,l),Aa(s+"Capture",l)}function Aa(s,l){for(Qd[s]=l,s=0;s<l.length;s++)Wd.add(l[s])}var Zd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jd={},ef={};function ig(s){return Ne.call(ef,s)?!0:Ne.call(Jd,s)?!1:Zd.test(s)?ef[s]=!0:(Jd[s]=!0,!1)}function Hc(s,l,f){if(ig(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function ci(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function Gn(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function hr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function eo(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function tf(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,E=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(N){f=""+N,E.call(this,N)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(N){f=""+N},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Gt(s){if(!s._valueTracker){var l=eo(s)?"checked":"value";s._valueTracker=tf(s,l,""+s[l])}}function _l(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=eo(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function Ca(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var wl=/[\n"\\]/g;function Yr(s){return s.replace(wl,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function $c(s,l,f,g,x,E,N,F){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),l!=null?N==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+hr(l)):s.value!==""+hr(l)&&(s.value=""+hr(l)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),l!=null?nf(s,N,hr(l)):f!=null?nf(s,N,hr(f)):g!=null&&s.removeAttribute("value"),x==null&&E!=null&&(s.defaultChecked=!!E),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+hr(F):s.removeAttribute("name")}function ag(s,l,f,g,x,E,N,F){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){Gt(s);return}f=f!=null?""+hr(f):"",l=l!=null?""+hr(l):f,F||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=F?s.checked:!!g,s.defaultChecked=!!g,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),Gt(s)}function nf(s,l,f){l==="number"&&Ca(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function to(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+hr(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function sg(s,l,f){if(l!=null&&(l=""+hr(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+hr(f):""}function no(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(Y(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=hr(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Gt(s)}function Kr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var og=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||og.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function af(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&rf(s,x,g)}else for(var E in l)l.hasOwnProperty(E)&&rf(s,E,l[E])}function Yc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ro=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kc(s){return ro.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Wi(){}var sf=null;function Ei(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var io=null,Ia=null;function El(s){var l=wi(s);if(l&&(s=l.stateNode)){var f=s[fr]||null;e:switch(s=l.stateNode,l.type){case"input":if($c(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Yr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[fr]||null;if(!x)throw Error(r(90));$c(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&_l(g)}break e;case"textarea":sg(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&to(s,!!f.multiple,l,!1)}}}var Xc=!1;function ao(s,l,f){if(Xc)return s(l,f);Xc=!0;try{var g=s(l);return g}finally{if(Xc=!1,(io!==null||Ia!==null)&&(tm(),io&&(l=io,s=Ia,Ia=io=null,El(l),s)))for(l=0;l<s.length;l++)El(s[l])}}function Qi(s,l){var f=s.stateNode;if(f===null)return null;var g=f[fr]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var Si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sl=!1;if(Si)try{var Kt={};Object.defineProperty(Kt,"passive",{get:function(){Sl=!0}}),window.addEventListener("test",Kt,Kt),window.removeEventListener("test",Kt,Kt)}catch{Sl=!1}var Ra=null,of=null,Tl=null;function lf(){if(Tl)return Tl;var s,l=of,f=l.length,g,x="value"in Ra?Ra.value:Ra.textContent,E=x.length;for(s=0;s<f&&l[s]===x[s];s++);var N=f-s;for(g=1;g<=N&&l[f-g]===x[E-g];g++);return Tl=x.slice(s,1<g?1-g:void 0)}function Al(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function cs(){return!0}function Zi(){return!1}function mr(s){function l(f,g,x,E,N){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=E,this.target=N,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(f=s[F],this[F]=f?f(E):E[F]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?cs:Zi,this.isPropagationStopped=Zi,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),l}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Da=mr(us),so=p({},us,{view:0,detail:0}),cf=mr(so),oo,Wc,ka,Qc=p({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ka&&(ka&&s.type==="mousemove"?(oo=s.screenX-ka.screenX,Wc=s.screenY-ka.screenY):Wc=oo=0,ka=s),oo)},movementY:function(s){return"movementY"in s?s.movementY:Wc}}),uf=mr(Qc),Cl=p({},Qc,{dataTransfer:0}),cg=mr(Cl),ug=p({},so,{relatedTarget:0}),Il=mr(ug),df=p({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),dg=mr(df),Zc=p({},us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),fg=mr(Zc),hg=p({},us,{data:0}),Na=mr(hg),pg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=mg[s])?!!l[s]:!1}function lo(){return vg}var zr=p({},so,{key:function(s){if(s.key){var l=pg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Al(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?gg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(s){return s.type==="keypress"?Al(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Al(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),yg=mr(zr),bg=p({},Qc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ds=mr(bg),y=p({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),R=mr(y),j=p({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=mr(j),oe=p({},Qc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=mr(oe),Re=p({},us,{newState:0,oldState:0}),ft=mr(Re),Pn=[9,13,27,32],Vt=Si&&"CompositionEvent"in window,hn=null;Si&&"documentMode"in document&&(hn=document.documentMode);var Ti=Si&&"TextEvent"in window&&!hn,Ma=Si&&(!Vt||hn&&8<hn&&11>=hn),Ji=" ",ea=!1;function Rl(s,l){switch(s){case"keyup":return Pn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var eu=!1;function OV(s,l){switch(s){case"compositionend":return Jc(l);case"keypress":return l.which!==32?null:(ea=!0,Ji);case"textInput":return s=l.data,s===Ji&&ea?null:s;default:return null}}function jV(s,l){if(eu)return s==="compositionend"||!Vt&&Rl(s,l)?(s=lf(),Tl=of=Ra=null,eu=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ma&&l.locale!=="ko"?null:l.data;default:return null}}var VV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!VV[s.type]:l==="textarea"}function US(s,l,f,g){io?Ia?Ia.push(g):Ia=[g]:io=g,l=lm(l,"onChange"),0<l.length&&(f=new Da("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var ff=null,hf=null;function zV(s){EC(s,0)}function xg(s){var l=li(s);if(_l(l))return s}function FS(s,l){if(s==="change")return l}var GS=!1;if(Si){var by;if(Si){var xy="oninput"in document;if(!xy){var qS=document.createElement("div");qS.setAttribute("oninput","return;"),xy=typeof qS.oninput=="function"}by=xy}else by=!1;GS=by&&(!document.documentMode||9<document.documentMode)}function HS(){ff&&(ff.detachEvent("onpropertychange",$S),hf=ff=null)}function $S(s){if(s.propertyName==="value"&&xg(hf)){var l=[];US(l,hf,s,Ei(s)),ao(zV,l)}}function LV(s,l,f){s==="focusin"?(HS(),ff=l,hf=f,ff.attachEvent("onpropertychange",$S)):s==="focusout"&&HS()}function BV(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return xg(hf)}function UV(s,l){if(s==="click")return xg(l)}function FV(s,l){if(s==="input"||s==="change")return xg(l)}function GV(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ui=typeof Object.is=="function"?Object.is:GV;function pf(s,l){if(ui(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Ne.call(l,x)||!ui(s[x],l[x]))return!1}return!0}function YS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function KS(s,l){var f=YS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=YS(f)}}function XS(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?XS(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function WS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ca(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=Ca(s.document)}return l}function _y(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var qV=Si&&"documentMode"in document&&11>=document.documentMode,tu=null,wy=null,gf=null,Ey=!1;function QS(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Ey||tu==null||tu!==Ca(g)||(g=tu,"selectionStart"in g&&_y(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),gf&&pf(gf,g)||(gf=g,g=lm(wy,"onSelect"),0<g.length&&(l=new Da("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=tu)))}function Dl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var nu={animationend:Dl("Animation","AnimationEnd"),animationiteration:Dl("Animation","AnimationIteration"),animationstart:Dl("Animation","AnimationStart"),transitionrun:Dl("Transition","TransitionRun"),transitionstart:Dl("Transition","TransitionStart"),transitioncancel:Dl("Transition","TransitionCancel"),transitionend:Dl("Transition","TransitionEnd")},Sy={},ZS={};Si&&(ZS=document.createElement("div").style,"AnimationEvent"in window||(delete nu.animationend.animation,delete nu.animationiteration.animation,delete nu.animationstart.animation),"TransitionEvent"in window||delete nu.transitionend.transition);function kl(s){if(Sy[s])return Sy[s];if(!nu[s])return s;var l=nu[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in ZS)return Sy[s]=l[f];return s}var JS=kl("animationend"),eT=kl("animationiteration"),tT=kl("animationstart"),HV=kl("transitionrun"),$V=kl("transitionstart"),YV=kl("transitioncancel"),nT=kl("transitionend"),rT=new Map,Ty="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ty.push("scrollEnd");function ta(s,l){rT.set(s,l),Ta(l,[s])}var _g=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ai=[],ru=0,Ay=0;function wg(){for(var s=ru,l=Ay=ru=0;l<s;){var f=Ai[l];Ai[l++]=null;var g=Ai[l];Ai[l++]=null;var x=Ai[l];Ai[l++]=null;var E=Ai[l];if(Ai[l++]=null,g!==null&&x!==null){var N=g.pending;N===null?x.next=x:(x.next=N.next,N.next=x),g.pending=x}E!==0&&iT(f,x,E)}}function Eg(s,l,f,g){Ai[ru++]=s,Ai[ru++]=l,Ai[ru++]=f,Ai[ru++]=g,Ay|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function Cy(s,l,f,g){return Eg(s,l,f,g),Sg(s)}function Nl(s,l){return Eg(s,null,null,l),Sg(s)}function iT(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,E=s.return;E!==null;)E.childLanes|=f,g=E.alternate,g!==null&&(g.childLanes|=f),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(x=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,x&&l!==null&&(x=31-sn(f),s=E.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),E):null}function Sg(s){if(50<Vf)throw Vf=0,jb=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var iu={};function KV(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(s,l,f,g){return new KV(s,l,f,g)}function Iy(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fs(s,l){var f=s.alternate;return f===null?(f=di(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function aT(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Tg(s,l,f,g,x,E){var N=0;if(g=s,typeof s=="function")Iy(s)&&(N=1);else if(typeof s=="string")N=J5(s,f,ee.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=di(31,f,l,x),s.elementType=k,s.lanes=E,s;case w:return Ml(f.children,x,E,l);case S:N=8,x|=24;break;case T:return s=di(12,f,l,x|2),s.elementType=T,s.lanes=E,s;case M:return s=di(13,f,l,x),s.elementType=M,s.lanes=E,s;case V:return s=di(19,f,l,x),s.elementType=V,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:N=10;break e;case C:N=9;break e;case O:N=11;break e;case A:N=14;break e;case I:N=16,g=null;break e}N=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=di(N,f,l,x),l.elementType=s,l.type=g,l.lanes=E,l}function Ml(s,l,f,g){return s=di(7,s,g,l),s.lanes=f,s}function Ry(s,l,f){return s=di(6,s,null,l),s.lanes=f,s}function sT(s){var l=di(18,null,null,0);return l.stateNode=s,l}function Dy(s,l,f){return l=di(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var oT=new WeakMap;function Ci(s,l){if(typeof s=="object"&&s!==null){var f=oT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:st(l)},oT.set(s,l),l)}return{value:s,source:l,stack:st(l)}}var au=[],su=0,Ag=null,mf=0,Ii=[],Ri=0,co=null,Pa=1,Oa="";function hs(s,l){au[su++]=mf,au[su++]=Ag,Ag=s,mf=l}function lT(s,l,f){Ii[Ri++]=Pa,Ii[Ri++]=Oa,Ii[Ri++]=co,co=s;var g=Pa;s=Oa;var x=32-sn(g)-1;g&=~(1<<x),f+=1;var E=32-sn(l)+x;if(30<E){var N=x-x%5;E=(g&(1<<N)-1).toString(32),g>>=N,x-=N,Pa=1<<32-sn(l)+x|f<<x|g,Oa=E+s}else Pa=1<<E|f<<x|g,Oa=s}function ky(s){s.return!==null&&(hs(s,1),lT(s,1,0))}function Ny(s){for(;s===Ag;)Ag=au[--su],au[su]=null,mf=au[--su],au[su]=null;for(;s===co;)co=Ii[--Ri],Ii[Ri]=null,Oa=Ii[--Ri],Ii[Ri]=null,Pa=Ii[--Ri],Ii[Ri]=null}function cT(s,l){Ii[Ri++]=Pa,Ii[Ri++]=Oa,Ii[Ri++]=co,Pa=l.id,Oa=l.overflow,co=s}var vr=null,ln=null,Rt=!1,uo=null,Di=!1,My=Error(r(519));function fo(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vf(Ci(l,s)),My}function uT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[Bt]=s,l[fr]=g,f){case"dialog":wt("cancel",l),wt("close",l);break;case"iframe":case"object":case"embed":wt("load",l);break;case"video":case"audio":for(f=0;f<Lf.length;f++)wt(Lf[f],l);break;case"source":wt("error",l);break;case"img":case"image":case"link":wt("error",l),wt("load",l);break;case"details":wt("toggle",l);break;case"input":wt("invalid",l),ag(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":wt("invalid",l);break;case"textarea":wt("invalid",l),no(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||CC(l.textContent,f)?(g.popover!=null&&(wt("beforetoggle",l),wt("toggle",l)),g.onScroll!=null&&wt("scroll",l),g.onScrollEnd!=null&&wt("scrollend",l),g.onClick!=null&&(l.onclick=Wi),l=!0):l=!1,l||fo(s,!0)}function dT(s){for(vr=s.return;vr;)switch(vr.tag){case 5:case 31:case 13:Di=!1;return;case 27:case 3:Di=!0;return;default:vr=vr.return}}function ou(s){if(s!==vr)return!1;if(!Rt)return dT(s),Rt=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Qb(s.type,s.memoizedProps)),f=!f),f&&ln&&fo(s),dT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));ln=jC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));ln=jC(s)}else l===27?(l=ln,Ao(s.type)?(s=nx,nx=null,ln=s):ln=l):ln=vr?Ni(s.stateNode.nextSibling):null;return!0}function Pl(){ln=vr=null,Rt=!1}function Py(){var s=uo;return s!==null&&(Zr===null?Zr=s:Zr.push.apply(Zr,s),uo=null),s}function vf(s){uo===null?uo=[s]:uo.push(s)}var Oy=G(null),Ol=null,ps=null;function ho(s,l,f){Z(Oy,l._currentValue),l._currentValue=f}function gs(s){s._currentValue=Oy.current,$(Oy)}function jy(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Vy(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var E=x.dependencies;if(E!==null){var N=x.child;E=E.firstContext;e:for(;E!==null;){var F=E;E=x;for(var X=0;X<l.length;X++)if(F.context===l[X]){E.lanes|=f,F=E.alternate,F!==null&&(F.lanes|=f),jy(E.return,f,s),g||(N=null);break e}E=F.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(r(341));N.lanes|=f,E=N.alternate,E!==null&&(E.lanes|=f),jy(N,f,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function lu(s,l,f,g){s=null;for(var x=l,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var F=x.type;ui(x.pendingProps.value,N.value)||(s!==null?s.push(F):s=[F])}}else if(x===se.current){if(N=x.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(qf):s=[qf])}x=x.return}s!==null&&Vy(l,s,f,g),l.flags|=262144}function Cg(s){for(s=s.firstContext;s!==null;){if(!ui(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function jl(s){Ol=s,ps=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function yr(s){return fT(Ol,s)}function Ig(s,l){return Ol===null&&jl(s),fT(s,l)}function fT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},ps===null){if(s===null)throw Error(r(308));ps=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ps=ps.next=l;return f}var XV=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},WV=n.unstable_scheduleCallback,QV=n.unstable_NormalPriority,qn={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zy(){return{controller:new XV,data:new Map,refCount:0}}function yf(s){s.refCount--,s.refCount===0&&WV(QV,function(){s.controller.abort()})}var bf=null,Ly=0,cu=0,uu=null;function ZV(s,l){if(bf===null){var f=bf=[];Ly=0,cu=Fb(),uu={status:"pending",value:void 0,then:function(g){f.push(g)}}}return Ly++,l.then(hT,hT),l}function hT(){if(--Ly===0&&bf!==null){uu!==null&&(uu.status="fulfilled");var s=bf;bf=null,cu=0,uu=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function JV(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var pT=H.S;H.S=function(s,l){QA=rt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&ZV(s,l),pT!==null&&pT(s,l)};var Vl=G(null);function By(){var s=Vl.current;return s!==null?s:nn.pooledCache}function Rg(s,l){l===null?Z(Vl,Vl.current):Z(Vl,l.pool)}function gT(){var s=By();return s===null?null:{parent:qn._currentValue,pool:s}}var du=Error(r(460)),Uy=Error(r(474)),Dg=Error(r(542)),kg={then:function(){}};function mT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function vT(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Wi,Wi),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,bT(s),s;default:if(typeof l.status=="string")l.then(Wi,Wi);else{if(s=nn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,bT(s),s}throw Ll=l,du}}function zl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Ll=f,du):f}}var Ll=null;function yT(){if(Ll===null)throw Error(r(459));var s=Ll;return Ll=null,s}function bT(s){if(s===du||s===Dg)throw Error(r(483))}var fu=null,xf=0;function Ng(s){var l=xf;return xf+=1,fu===null&&(fu=[]),vT(fu,s,l)}function _f(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Mg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function xT(s){function l(ie,re){if(s){var ce=ie.deletions;ce===null?(ie.deletions=[re],ie.flags|=16):ce.push(re)}}function f(ie,re){if(!s)return null;for(;re!==null;)l(ie,re),re=re.sibling;return null}function g(ie){for(var re=new Map;ie!==null;)ie.key!==null?re.set(ie.key,ie):re.set(ie.index,ie),ie=ie.sibling;return re}function x(ie,re){return ie=fs(ie,re),ie.index=0,ie.sibling=null,ie}function E(ie,re,ce){return ie.index=ce,s?(ce=ie.alternate,ce!==null?(ce=ce.index,ce<re?(ie.flags|=67108866,re):ce):(ie.flags|=67108866,re)):(ie.flags|=1048576,re)}function N(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function F(ie,re,ce,ye){return re===null||re.tag!==6?(re=Ry(ce,ie.mode,ye),re.return=ie,re):(re=x(re,ce),re.return=ie,re)}function X(ie,re,ce,ye){var $e=ce.type;return $e===w?ve(ie,re,ce.props.children,ye,ce.key):re!==null&&(re.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===I&&zl($e)===re.type)?(re=x(re,ce.props),_f(re,ce),re.return=ie,re):(re=Tg(ce.type,ce.key,ce.props,null,ie.mode,ye),_f(re,ce),re.return=ie,re)}function ue(ie,re,ce,ye){return re===null||re.tag!==4||re.stateNode.containerInfo!==ce.containerInfo||re.stateNode.implementation!==ce.implementation?(re=Dy(ce,ie.mode,ye),re.return=ie,re):(re=x(re,ce.children||[]),re.return=ie,re)}function ve(ie,re,ce,ye,$e){return re===null||re.tag!==7?(re=Ml(ce,ie.mode,ye,$e),re.return=ie,re):(re=x(re,ce),re.return=ie,re)}function be(ie,re,ce){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=Ry(""+re,ie.mode,ce),re.return=ie,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case b:return ce=Tg(re.type,re.key,re.props,null,ie.mode,ce),_f(ce,re),ce.return=ie,ce;case _:return re=Dy(re,ie.mode,ce),re.return=ie,re;case I:return re=zl(re),be(ie,re,ce)}if(Y(re)||B(re))return re=Ml(re,ie.mode,ce,null),re.return=ie,re;if(typeof re.then=="function")return be(ie,Ng(re),ce);if(re.$$typeof===D)return be(ie,Ig(ie,re),ce);Mg(ie,re)}return null}function fe(ie,re,ce,ye){var $e=re!==null?re.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return $e!==null?null:F(ie,re,""+ce,ye);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:return ce.key===$e?X(ie,re,ce,ye):null;case _:return ce.key===$e?ue(ie,re,ce,ye):null;case I:return ce=zl(ce),fe(ie,re,ce,ye)}if(Y(ce)||B(ce))return $e!==null?null:ve(ie,re,ce,ye,null);if(typeof ce.then=="function")return fe(ie,re,Ng(ce),ye);if(ce.$$typeof===D)return fe(ie,re,Ig(ie,ce),ye);Mg(ie,ce)}return null}function ge(ie,re,ce,ye,$e){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ie=ie.get(ce)||null,F(re,ie,""+ye,$e);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case b:return ie=ie.get(ye.key===null?ce:ye.key)||null,X(re,ie,ye,$e);case _:return ie=ie.get(ye.key===null?ce:ye.key)||null,ue(re,ie,ye,$e);case I:return ye=zl(ye),ge(ie,re,ce,ye,$e)}if(Y(ye)||B(ye))return ie=ie.get(ce)||null,ve(re,ie,ye,$e,null);if(typeof ye.then=="function")return ge(ie,re,ce,Ng(ye),$e);if(ye.$$typeof===D)return ge(ie,re,ce,Ig(re,ye),$e);Mg(re,ye)}return null}function je(ie,re,ce,ye){for(var $e=null,Mt=null,Be=re,gt=re=0,Tt=null;Be!==null&&gt<ce.length;gt++){Be.index>gt?(Tt=Be,Be=null):Tt=Be.sibling;var Pt=fe(ie,Be,ce[gt],ye);if(Pt===null){Be===null&&(Be=Tt);break}s&&Be&&Pt.alternate===null&&l(ie,Be),re=E(Pt,re,gt),Mt===null?$e=Pt:Mt.sibling=Pt,Mt=Pt,Be=Tt}if(gt===ce.length)return f(ie,Be),Rt&&hs(ie,gt),$e;if(Be===null){for(;gt<ce.length;gt++)Be=be(ie,ce[gt],ye),Be!==null&&(re=E(Be,re,gt),Mt===null?$e=Be:Mt.sibling=Be,Mt=Be);return Rt&&hs(ie,gt),$e}for(Be=g(Be);gt<ce.length;gt++)Tt=ge(Be,ie,gt,ce[gt],ye),Tt!==null&&(s&&Tt.alternate!==null&&Be.delete(Tt.key===null?gt:Tt.key),re=E(Tt,re,gt),Mt===null?$e=Tt:Mt.sibling=Tt,Mt=Tt);return s&&Be.forEach(function(ko){return l(ie,ko)}),Rt&&hs(ie,gt),$e}function Xe(ie,re,ce,ye){if(ce==null)throw Error(r(151));for(var $e=null,Mt=null,Be=re,gt=re=0,Tt=null,Pt=ce.next();Be!==null&&!Pt.done;gt++,Pt=ce.next()){Be.index>gt?(Tt=Be,Be=null):Tt=Be.sibling;var ko=fe(ie,Be,Pt.value,ye);if(ko===null){Be===null&&(Be=Tt);break}s&&Be&&ko.alternate===null&&l(ie,Be),re=E(ko,re,gt),Mt===null?$e=ko:Mt.sibling=ko,Mt=ko,Be=Tt}if(Pt.done)return f(ie,Be),Rt&&hs(ie,gt),$e;if(Be===null){for(;!Pt.done;gt++,Pt=ce.next())Pt=be(ie,Pt.value,ye),Pt!==null&&(re=E(Pt,re,gt),Mt===null?$e=Pt:Mt.sibling=Pt,Mt=Pt);return Rt&&hs(ie,gt),$e}for(Be=g(Be);!Pt.done;gt++,Pt=ce.next())Pt=ge(Be,ie,gt,Pt.value,ye),Pt!==null&&(s&&Pt.alternate!==null&&Be.delete(Pt.key===null?gt:Pt.key),re=E(Pt,re,gt),Mt===null?$e=Pt:Mt.sibling=Pt,Mt=Pt);return s&&Be.forEach(function(u6){return l(ie,u6)}),Rt&&hs(ie,gt),$e}function Qt(ie,re,ce,ye){if(typeof ce=="object"&&ce!==null&&ce.type===w&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:e:{for(var $e=ce.key;re!==null;){if(re.key===$e){if($e=ce.type,$e===w){if(re.tag===7){f(ie,re.sibling),ye=x(re,ce.props.children),ye.return=ie,ie=ye;break e}}else if(re.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===I&&zl($e)===re.type){f(ie,re.sibling),ye=x(re,ce.props),_f(ye,ce),ye.return=ie,ie=ye;break e}f(ie,re);break}else l(ie,re);re=re.sibling}ce.type===w?(ye=Ml(ce.props.children,ie.mode,ye,ce.key),ye.return=ie,ie=ye):(ye=Tg(ce.type,ce.key,ce.props,null,ie.mode,ye),_f(ye,ce),ye.return=ie,ie=ye)}return N(ie);case _:e:{for($e=ce.key;re!==null;){if(re.key===$e)if(re.tag===4&&re.stateNode.containerInfo===ce.containerInfo&&re.stateNode.implementation===ce.implementation){f(ie,re.sibling),ye=x(re,ce.children||[]),ye.return=ie,ie=ye;break e}else{f(ie,re);break}else l(ie,re);re=re.sibling}ye=Dy(ce,ie.mode,ye),ye.return=ie,ie=ye}return N(ie);case I:return ce=zl(ce),Qt(ie,re,ce,ye)}if(Y(ce))return je(ie,re,ce,ye);if(B(ce)){if($e=B(ce),typeof $e!="function")throw Error(r(150));return ce=$e.call(ce),Xe(ie,re,ce,ye)}if(typeof ce.then=="function")return Qt(ie,re,Ng(ce),ye);if(ce.$$typeof===D)return Qt(ie,re,Ig(ie,ce),ye);Mg(ie,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,re!==null&&re.tag===6?(f(ie,re.sibling),ye=x(re,ce),ye.return=ie,ie=ye):(f(ie,re),ye=Ry(ce,ie.mode,ye),ye.return=ie,ie=ye),N(ie)):f(ie,re)}return function(ie,re,ce,ye){try{xf=0;var $e=Qt(ie,re,ce,ye);return fu=null,$e}catch(Be){if(Be===du||Be===Dg)throw Be;var Mt=di(29,Be,null,ie.mode);return Mt.lanes=ye,Mt.return=ie,Mt}finally{}}}var Bl=xT(!0),_T=xT(!1),po=!1;function Fy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function go(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function mo(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(zt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=Sg(s),iT(s,null,f),l}return Eg(s,g,l,f),Sg(s)}function wf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,xn(s,f)}}function qy(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var N={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?x=E=N:E=E.next=N,f=f.next}while(f!==null);E===null?x=E=l:E=E.next=l}else x=E=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Hy=!1;function Ef(){if(Hy){var s=uu;if(s!==null)throw s}}function Sf(s,l,f,g){Hy=!1;var x=s.updateQueue;po=!1;var E=x.firstBaseUpdate,N=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var X=F,ue=X.next;X.next=null,N===null?E=ue:N.next=ue,N=X;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,F=ve.lastBaseUpdate,F!==N&&(F===null?ve.firstBaseUpdate=ue:F.next=ue,ve.lastBaseUpdate=X))}if(E!==null){var be=x.baseState;N=0,ve=ue=X=null,F=E;do{var fe=F.lane&-536870913,ge=fe!==F.lane;if(ge?(St&fe)===fe:(g&fe)===fe){fe!==0&&fe===cu&&(Hy=!0),ve!==null&&(ve=ve.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var je=s,Xe=F;fe=l;var Qt=f;switch(Xe.tag){case 1:if(je=Xe.payload,typeof je=="function"){be=je.call(Qt,be,fe);break e}be=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Xe.payload,fe=typeof je=="function"?je.call(Qt,be,fe):je,fe==null)break e;be=p({},be,fe);break e;case 2:po=!0}}fe=F.callback,fe!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[fe]:ge.push(fe))}else ge={lane:fe,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ve===null?(ue=ve=ge,X=be):ve=ve.next=ge,N|=fe;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;ge=F,F=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);ve===null&&(X=be),x.baseState=X,x.firstBaseUpdate=ue,x.lastBaseUpdate=ve,E===null&&(x.shared.lanes=0),_o|=N,s.lanes=N,s.memoizedState=be}}function wT(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function ET(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)wT(f[s],l)}var hu=G(null),Pg=G(0);function ST(s,l){s=Ss,Z(Pg,s),Z(hu,l),Ss=s|l.baseLanes}function $y(){Z(Pg,Ss),Z(hu,hu.current)}function Yy(){Ss=Pg.current,$(hu),$(Pg)}var fi=G(null),ki=null;function vo(s){var l=s.alternate;Z(On,On.current&1),Z(fi,s),ki===null&&(l===null||hu.current!==null||l.memoizedState!==null)&&(ki=s)}function Ky(s){Z(On,On.current),Z(fi,s),ki===null&&(ki=s)}function TT(s){s.tag===22?(Z(On,On.current),Z(fi,s),ki===null&&(ki=s)):yo()}function yo(){Z(On,On.current),Z(fi,fi.current)}function hi(s){$(fi),ki===s&&(ki=null),$(On)}var On=G(0);function Og(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||ex(f)||tx(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ms=0,ht=null,Xt=null,Hn=null,jg=!1,pu=!1,Ul=!1,Vg=0,Tf=0,gu=null,e5=0;function Cn(){throw Error(r(321))}function Xy(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!ui(s[f],l[f]))return!1;return!0}function Wy(s,l,f,g,x,E){return ms=E,ht=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,H.H=s===null||s.memoizedState===null?lA:db,Ul=!1,E=f(g,x),Ul=!1,pu&&(E=CT(l,f,g,x)),AT(s),E}function AT(s){H.H=If;var l=Xt!==null&&Xt.next!==null;if(ms=0,Hn=Xt=ht=null,jg=!1,Tf=0,gu=null,l)throw Error(r(300));s===null||$n||(s=s.dependencies,s!==null&&Cg(s)&&($n=!0))}function CT(s,l,f,g){ht=s;var x=0;do{if(pu&&(gu=null),Tf=0,pu=!1,25<=x)throw Error(r(301));if(x+=1,Hn=Xt=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}H.H=cA,E=l(f,g)}while(pu);return E}function t5(){var s=H.H,l=s.useState()[0];return l=typeof l.then=="function"?Af(l):l,s=s.useState()[0],(Xt!==null?Xt.memoizedState:null)!==s&&(ht.flags|=1024),l}function Qy(){var s=Vg!==0;return Vg=0,s}function Zy(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function Jy(s){if(jg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}jg=!1}ms=0,Hn=Xt=ht=null,pu=!1,Tf=Vg=0,gu=null}function Lr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?ht.memoizedState=Hn=s:Hn=Hn.next=s,Hn}function jn(){if(Xt===null){var s=ht.alternate;s=s!==null?s.memoizedState:null}else s=Xt.next;var l=Hn===null?ht.memoizedState:Hn.next;if(l!==null)Hn=l,Xt=s;else{if(s===null)throw ht.alternate===null?Error(r(467)):Error(r(310));Xt=s,s={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},Hn===null?ht.memoizedState=Hn=s:Hn=Hn.next=s}return Hn}function zg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Af(s){var l=Tf;return Tf+=1,gu===null&&(gu=[]),s=vT(gu,s,l),l=ht,(Hn===null?l.memoizedState:Hn.next)===null&&(l=l.alternate,H.H=l===null||l.memoizedState===null?lA:db),s}function Lg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Af(s);if(s.$$typeof===D)return yr(s)}throw Error(r(438,String(s)))}function eb(s){var l=null,f=ht.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=ht.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=zg(),ht.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=z;return l.index++,f}function vs(s,l){return typeof l=="function"?l(s):l}function Bg(s){var l=jn();return tb(l,Xt,s)}function tb(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,E=g.pending;if(E!==null){if(x!==null){var N=x.next;x.next=E.next,E.next=N}l.baseQueue=x=E,g.pending=null}if(E=s.baseState,x===null)s.memoizedState=E;else{l=x.next;var F=N=null,X=null,ue=l,ve=!1;do{var be=ue.lane&-536870913;if(be!==ue.lane?(St&be)===be:(ms&be)===be){var fe=ue.revertLane;if(fe===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),be===cu&&(ve=!0);else if((ms&fe)===fe){ue=ue.next,fe===cu&&(ve=!0);continue}else be={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(F=X=be,N=E):X=X.next=be,ht.lanes|=fe,_o|=fe;be=ue.action,Ul&&f(E,be),E=ue.hasEagerState?ue.eagerState:f(E,be)}else fe={lane:be,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(F=X=fe,N=E):X=X.next=fe,ht.lanes|=be,_o|=be;ue=ue.next}while(ue!==null&&ue!==l);if(X===null?N=E:X.next=F,!ui(E,s.memoizedState)&&($n=!0,ve&&(f=uu,f!==null)))throw f;s.memoizedState=E,s.baseState=N,s.baseQueue=X,g.lastRenderedState=E}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function nb(s){var l=jn(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,E=l.memoizedState;if(x!==null){f.pending=null;var N=x=x.next;do E=s(E,N.action),N=N.next;while(N!==x);ui(E,l.memoizedState)||($n=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,g]}function IT(s,l,f){var g=ht,x=jn(),E=Rt;if(E){if(f===void 0)throw Error(r(407));f=f()}else f=l();var N=!ui((Xt||x).memoizedState,f);if(N&&(x.memoizedState=f,$n=!0),x=x.queue,ab(kT.bind(null,g,x,s),[s]),x.getSnapshot!==l||N||Hn!==null&&Hn.memoizedState.tag&1){if(g.flags|=2048,mu(9,{destroy:void 0},DT.bind(null,g,x,f,l),null),nn===null)throw Error(r(349));E||(ms&127)!==0||RT(g,l,f)}return f}function RT(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=ht.updateQueue,l===null?(l=zg(),ht.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function DT(s,l,f,g){l.value=f,l.getSnapshot=g,NT(l)&&MT(s)}function kT(s,l,f){return f(function(){NT(l)&&MT(s)})}function NT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!ui(s,f)}catch{return!0}}function MT(s){var l=Nl(s,2);l!==null&&Jr(l,s,2)}function rb(s){var l=Lr();if(typeof s=="function"){var f=s;if(s=f(),Ul){dr(!0);try{f()}finally{dr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:s},l}function PT(s,l,f,g){return s.baseState=f,tb(s,Xt,typeof g=="function"?g:vs)}function n5(s,l,f,g,x){if(Gg(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){E.listeners.push(N)}};H.T!==null?f(!0):E.isTransition=!1,g(E),f=l.pending,f===null?(E.next=l.pending=E,OT(l,E)):(E.next=f.next,l.pending=f.next=E)}}function OT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var E=H.T,N={};H.T=N;try{var F=f(x,g),X=H.S;X!==null&&X(N,F),jT(s,l,F)}catch(ue){ib(s,l,ue)}finally{E!==null&&N.types!==null&&(E.types=N.types),H.T=E}}else try{E=f(x,g),jT(s,l,E)}catch(ue){ib(s,l,ue)}}function jT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){VT(s,l,g)},function(g){return ib(s,l,g)}):VT(s,l,f)}function VT(s,l,f){l.status="fulfilled",l.value=f,zT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,OT(s,f)))}function ib(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,zT(l),l=l.next;while(l!==g)}s.action=null}function zT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function LT(s,l){return l}function BT(s,l){if(Rt){var f=nn.formState;if(f!==null){e:{var g=ht;if(Rt){if(ln){t:{for(var x=ln,E=Di;x.nodeType!==8;){if(!E){x=null;break t}if(x=Ni(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){ln=Ni(x.nextSibling),g=x.data==="F!";break e}}fo(g)}g=!1}g&&(l=f[0])}}return f=Lr(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:LT,lastRenderedState:l},f.queue=g,f=aA.bind(null,ht,g),g.dispatch=f,g=rb(!1),E=ub.bind(null,ht,!1,g.queue),g=Lr(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=n5.bind(null,ht,x,E,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function UT(s){var l=jn();return FT(l,Xt,s)}function FT(s,l,f){if(l=tb(s,l,LT)[0],s=Bg(vs)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Af(l)}catch(N){throw N===du?Dg:N}else g=l;l=jn();var x=l.queue,E=x.dispatch;return f!==l.memoizedState&&(ht.flags|=2048,mu(9,{destroy:void 0},r5.bind(null,x,f),null)),[g,E,s]}function r5(s,l){s.action=l}function GT(s){var l=jn(),f=Xt;if(f!==null)return FT(l,f,s);jn(),l=l.memoizedState,f=jn();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function mu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=ht.updateQueue,l===null&&(l=zg(),ht.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function qT(){return jn().memoizedState}function Ug(s,l,f,g){var x=Lr();ht.flags|=s,x.memoizedState=mu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Fg(s,l,f,g){var x=jn();g=g===void 0?null:g;var E=x.memoizedState.inst;Xt!==null&&g!==null&&Xy(g,Xt.memoizedState.deps)?x.memoizedState=mu(l,E,f,g):(ht.flags|=s,x.memoizedState=mu(1|l,E,f,g))}function HT(s,l){Ug(8390656,8,s,l)}function ab(s,l){Fg(2048,8,s,l)}function i5(s){ht.flags|=4;var l=ht.updateQueue;if(l===null)l=zg(),ht.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function $T(s){var l=jn().memoizedState;return i5({ref:l,nextImpl:s}),function(){if((zt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function YT(s,l){return Fg(4,2,s,l)}function KT(s,l){return Fg(4,4,s,l)}function XT(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function WT(s,l,f){f=f!=null?f.concat([s]):null,Fg(4,4,XT.bind(null,l,s),f)}function sb(){}function QT(s,l){var f=jn();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&Xy(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function ZT(s,l){var f=jn();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&Xy(l,g[1]))return g[0];if(g=s(),Ul){dr(!0);try{s()}finally{dr(!1)}}return f.memoizedState=[g,l],g}function ob(s,l,f){return f===void 0||(ms&1073741824)!==0&&(St&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=JA(),ht.lanes|=s,_o|=s,f)}function JT(s,l,f,g){return ui(f,l)?f:hu.current!==null?(s=ob(s,f,g),ui(s,l)||($n=!0),s):(ms&42)===0||(ms&1073741824)!==0&&(St&261930)===0?($n=!0,s.memoizedState=f):(s=JA(),ht.lanes|=s,_o|=s,l)}function eA(s,l,f,g,x){var E=W.p;W.p=E!==0&&8>E?E:8;var N=H.T,F={};H.T=F,ub(s,!1,l,f);try{var X=x(),ue=H.S;if(ue!==null&&ue(F,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ve=JV(X,g);Cf(s,l,ve,mi(s))}else Cf(s,l,g,mi(s))}catch(be){Cf(s,l,{then:function(){},status:"rejected",reason:be},mi())}finally{W.p=E,N!==null&&F.types!==null&&(N.types=F.types),H.T=N}}function a5(){}function lb(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=tA(s).queue;eA(s,x,l,K,f===null?a5:function(){return nA(s),f(g)})}function tA(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:K},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function nA(s){var l=tA(s);l.next===null&&(l=s.alternate.memoizedState),Cf(s,l.next.queue,{},mi())}function cb(){return yr(qf)}function rA(){return jn().memoizedState}function iA(){return jn().memoizedState}function s5(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=mi();s=go(f);var g=mo(l,s,f);g!==null&&(Jr(g,l,f),wf(g,l,f)),l={cache:zy()},s.payload=l;return}l=l.return}}function o5(s,l,f){var g=mi();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Gg(s)?sA(l,f):(f=Cy(s,l,f,g),f!==null&&(Jr(f,s,g),oA(f,l,g)))}function aA(s,l,f){var g=mi();Cf(s,l,f,g)}function Cf(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Gg(s))sA(l,x);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var N=l.lastRenderedState,F=E(N,f);if(x.hasEagerState=!0,x.eagerState=F,ui(F,N))return Eg(s,l,x,0),nn===null&&wg(),!1}catch{}finally{}if(f=Cy(s,l,x,g),f!==null)return Jr(f,s,g),oA(f,l,g),!0}return!1}function ub(s,l,f,g){if(g={lane:2,revertLane:Fb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Gg(s)){if(l)throw Error(r(479))}else l=Cy(s,f,g,2),l!==null&&Jr(l,s,2)}function Gg(s){var l=s.alternate;return s===ht||l!==null&&l===ht}function sA(s,l){pu=jg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function oA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,xn(s,f)}}var If={readContext:yr,use:Lg,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useLayoutEffect:Cn,useInsertionEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useSyncExternalStore:Cn,useId:Cn,useHostTransitionStatus:Cn,useFormState:Cn,useActionState:Cn,useOptimistic:Cn,useMemoCache:Cn,useCacheRefresh:Cn};If.useEffectEvent=Cn;var lA={readContext:yr,use:Lg,useCallback:function(s,l){return Lr().memoizedState=[s,l===void 0?null:l],s},useContext:yr,useEffect:HT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Ug(4194308,4,XT.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Ug(4194308,4,s,l)},useInsertionEffect:function(s,l){Ug(4,2,s,l)},useMemo:function(s,l){var f=Lr();l=l===void 0?null:l;var g=s();if(Ul){dr(!0);try{s()}finally{dr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Lr();if(f!==void 0){var x=f(l);if(Ul){dr(!0);try{f(l)}finally{dr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=o5.bind(null,ht,s),[g.memoizedState,s]},useRef:function(s){var l=Lr();return s={current:s},l.memoizedState=s},useState:function(s){s=rb(s);var l=s.queue,f=aA.bind(null,ht,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:sb,useDeferredValue:function(s,l){var f=Lr();return ob(f,s,l)},useTransition:function(){var s=rb(!1);return s=eA.bind(null,ht,s.queue,!0,!1),Lr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=ht,x=Lr();if(Rt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),nn===null)throw Error(r(349));(St&127)!==0||RT(g,l,f)}x.memoizedState=f;var E={value:f,getSnapshot:l};return x.queue=E,HT(kT.bind(null,g,E,s),[s]),g.flags|=2048,mu(9,{destroy:void 0},DT.bind(null,g,E,f,l),null),f},useId:function(){var s=Lr(),l=nn.identifierPrefix;if(Rt){var f=Oa,g=Pa;f=(g&~(1<<32-sn(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Vg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=e5++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:cb,useFormState:BT,useActionState:BT,useOptimistic:function(s){var l=Lr();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=ub.bind(null,ht,!0,f),f.dispatch=l,[s,l]},useMemoCache:eb,useCacheRefresh:function(){return Lr().memoizedState=s5.bind(null,ht)},useEffectEvent:function(s){var l=Lr(),f={impl:s};return l.memoizedState=f,function(){if((zt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},db={readContext:yr,use:Lg,useCallback:QT,useContext:yr,useEffect:ab,useImperativeHandle:WT,useInsertionEffect:YT,useLayoutEffect:KT,useMemo:ZT,useReducer:Bg,useRef:qT,useState:function(){return Bg(vs)},useDebugValue:sb,useDeferredValue:function(s,l){var f=jn();return JT(f,Xt.memoizedState,s,l)},useTransition:function(){var s=Bg(vs)[0],l=jn().memoizedState;return[typeof s=="boolean"?s:Af(s),l]},useSyncExternalStore:IT,useId:rA,useHostTransitionStatus:cb,useFormState:UT,useActionState:UT,useOptimistic:function(s,l){var f=jn();return PT(f,Xt,s,l)},useMemoCache:eb,useCacheRefresh:iA};db.useEffectEvent=$T;var cA={readContext:yr,use:Lg,useCallback:QT,useContext:yr,useEffect:ab,useImperativeHandle:WT,useInsertionEffect:YT,useLayoutEffect:KT,useMemo:ZT,useReducer:nb,useRef:qT,useState:function(){return nb(vs)},useDebugValue:sb,useDeferredValue:function(s,l){var f=jn();return Xt===null?ob(f,s,l):JT(f,Xt.memoizedState,s,l)},useTransition:function(){var s=nb(vs)[0],l=jn().memoizedState;return[typeof s=="boolean"?s:Af(s),l]},useSyncExternalStore:IT,useId:rA,useHostTransitionStatus:cb,useFormState:GT,useActionState:GT,useOptimistic:function(s,l){var f=jn();return Xt!==null?PT(f,Xt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:eb,useCacheRefresh:iA};cA.useEffectEvent=$T;function fb(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var hb={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=mi(),x=go(g);x.payload=l,f!=null&&(x.callback=f),l=mo(s,x,g),l!==null&&(Jr(l,s,g),wf(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=mi(),x=go(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=mo(s,x,g),l!==null&&(Jr(l,s,g),wf(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=mi(),g=go(f);g.tag=2,l!=null&&(g.callback=l),l=mo(s,g,f),l!==null&&(Jr(l,s,f),wf(l,s,f))}};function uA(s,l,f,g,x,E,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,N):l.prototype&&l.prototype.isPureReactComponent?!pf(f,g)||!pf(x,E):!0}function dA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&hb.enqueueReplaceState(l,l.state,null)}function Fl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function fA(s){_g(s)}function hA(s){console.error(s)}function pA(s){_g(s)}function qg(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function gA(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function pb(s,l,f){return f=go(f),f.tag=3,f.payload={element:null},f.callback=function(){qg(s,l)},f}function mA(s){return s=go(s),s.tag=3,s}function vA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var E=g.value;s.payload=function(){return x(E)},s.callback=function(){gA(l,f,g)}}var N=f.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){gA(l,f,g),typeof x!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var F=g.stack;this.componentDidCatch(g.value,{componentStack:F!==null?F:""})})}function l5(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&lu(l,f,x,!0),f=fi.current,f!==null){switch(f.tag){case 31:case 13:return ki===null?nm():f.alternate===null&&In===0&&(In=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===kg?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),Lb(s,g,x)),!1;case 22:return f.flags|=65536,g===kg?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),Lb(s,g,x)),!1}throw Error(r(435,f.tag))}return Lb(s,g,x),nm(),!1}if(Rt)return l=fi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==My&&(s=Error(r(422),{cause:g}),vf(Ci(s,f)))):(g!==My&&(l=Error(r(423),{cause:g}),vf(Ci(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=Ci(g,f),x=pb(s.stateNode,g,x),qy(s,x),In!==4&&(In=2)),!1;var E=Error(r(520),{cause:g});if(E=Ci(E,f),jf===null?jf=[E]:jf.push(E),In!==4&&(In=2),l===null)return!0;g=Ci(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=pb(f.stateNode,g,s),qy(f,s),!1;case 1:if(l=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(wo===null||!wo.has(E))))return f.flags|=65536,x&=-x,f.lanes|=x,x=mA(x),vA(x,s,f,g),qy(f,x),!1}f=f.return}while(f!==null);return!1}var gb=Error(r(461)),$n=!1;function br(s,l,f,g){l.child=s===null?_T(l,null,f,g):Bl(l,s.child,f,g)}function yA(s,l,f,g,x){f=f.render;var E=l.ref;if("ref"in g){var N={};for(var F in g)F!=="ref"&&(N[F]=g[F])}else N=g;return jl(l),g=Wy(s,l,f,N,E,x),F=Qy(),s!==null&&!$n?(Zy(s,l,x),ys(s,l,x)):(Rt&&F&&ky(l),l.flags|=1,br(s,l,g,x),l.child)}function bA(s,l,f,g,x){if(s===null){var E=f.type;return typeof E=="function"&&!Iy(E)&&E.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=E,xA(s,l,E,g,x)):(s=Tg(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!Eb(s,x)){var N=E.memoizedProps;if(f=f.compare,f=f!==null?f:pf,f(N,g)&&s.ref===l.ref)return ys(s,l,x)}return l.flags|=1,s=fs(E,g),s.ref=l.ref,s.return=l,l.child=s}function xA(s,l,f,g,x){if(s!==null){var E=s.memoizedProps;if(pf(E,g)&&s.ref===l.ref)if($n=!1,l.pendingProps=g=E,Eb(s,x))(s.flags&131072)!==0&&($n=!0);else return l.lanes=s.lanes,ys(s,l,x)}return mb(s,l,f,g,x)}function _A(s,l,f,g){var x=g.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~E}else g=0,l.child=null;return wA(s,l,E,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Rg(l,E!==null?E.cachePool:null),E!==null?ST(l,E):$y(),TT(l);else return g=l.lanes=536870912,wA(s,l,E!==null?E.baseLanes|f:f,f,g)}else E!==null?(Rg(l,E.cachePool),ST(l,E),yo(),l.memoizedState=null):(s!==null&&Rg(l,null),$y(),yo());return br(s,l,x,f),l.child}function Rf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function wA(s,l,f,g,x){var E=By();return E=E===null?null:{parent:qn._currentValue,pool:E},l.memoizedState={baseLanes:f,cachePool:E},s!==null&&Rg(l,null),$y(),TT(l),s!==null&&lu(s,l,g,!0),l.childLanes=x,null}function Hg(s,l){return l=Yg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function EA(s,l,f){return Bl(l,s.child,null,f),s=Hg(l,l.pendingProps),s.flags|=2,hi(l),l.memoizedState=null,s}function c5(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Rt){if(g.mode==="hidden")return s=Hg(l,g),l.lanes=536870912,Rf(null,s);if(Ky(l),(s=ln)?(s=OC(s,Di),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:co!==null?{id:Pa,overflow:Oa}:null,retryLane:536870912,hydrationErrors:null},f=sT(s),f.return=l,l.child=f,vr=l,ln=null)):s=null,s===null)throw fo(l);return l.lanes=536870912,null}return Hg(l,g)}var E=s.memoizedState;if(E!==null){var N=E.dehydrated;if(Ky(l),x)if(l.flags&256)l.flags&=-257,l=EA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if($n||lu(s,l,f,!1),x=(f&s.childLanes)!==0,$n||x){if(g=nn,g!==null&&(N=xt(g,f),N!==0&&N!==E.retryLane))throw E.retryLane=N,Nl(s,N),Jr(g,s,N),gb;nm(),l=EA(s,l,f)}else s=E.treeContext,ln=Ni(N.nextSibling),vr=l,Rt=!0,uo=null,Di=!1,s!==null&&cT(l,s),l=Hg(l,g),l.flags|=4096;return l}return s=fs(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function $g(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function mb(s,l,f,g,x){return jl(l),f=Wy(s,l,f,g,void 0,x),g=Qy(),s!==null&&!$n?(Zy(s,l,x),ys(s,l,x)):(Rt&&g&&ky(l),l.flags|=1,br(s,l,f,x),l.child)}function SA(s,l,f,g,x,E){return jl(l),l.updateQueue=null,f=CT(l,g,f,x),AT(s),g=Qy(),s!==null&&!$n?(Zy(s,l,E),ys(s,l,E)):(Rt&&g&&ky(l),l.flags|=1,br(s,l,f,E),l.child)}function TA(s,l,f,g,x){if(jl(l),l.stateNode===null){var E=iu,N=f.contextType;typeof N=="object"&&N!==null&&(E=yr(N)),E=new f(g,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=hb,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=g,E.state=l.memoizedState,E.refs={},Fy(l),N=f.contextType,E.context=typeof N=="object"&&N!==null?yr(N):iu,E.state=l.memoizedState,N=f.getDerivedStateFromProps,typeof N=="function"&&(fb(l,f,N,g),E.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(N=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),N!==E.state&&hb.enqueueReplaceState(E,E.state,null),Sf(l,g,E,x),Ef(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){E=l.stateNode;var F=l.memoizedProps,X=Fl(f,F);E.props=X;var ue=E.context,ve=f.contextType;N=iu,typeof ve=="object"&&ve!==null&&(N=yr(ve));var be=f.getDerivedStateFromProps;ve=typeof be=="function"||typeof E.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,ve||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F||ue!==N)&&dA(l,E,g,N),po=!1;var fe=l.memoizedState;E.state=fe,Sf(l,g,E,x),Ef(),ue=l.memoizedState,F||fe!==ue||po?(typeof be=="function"&&(fb(l,f,be,g),ue=l.memoizedState),(X=po||uA(l,f,X,g,fe,ue,N))?(ve||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ue),E.props=g,E.state=ue,E.context=N,g=X):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{E=l.stateNode,Gy(s,l),N=l.memoizedProps,ve=Fl(f,N),E.props=ve,be=l.pendingProps,fe=E.context,ue=f.contextType,X=iu,typeof ue=="object"&&ue!==null&&(X=yr(ue)),F=f.getDerivedStateFromProps,(ue=typeof F=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(N!==be||fe!==X)&&dA(l,E,g,X),po=!1,fe=l.memoizedState,E.state=fe,Sf(l,g,E,x),Ef();var ge=l.memoizedState;N!==be||fe!==ge||po||s!==null&&s.dependencies!==null&&Cg(s.dependencies)?(typeof F=="function"&&(fb(l,f,F,g),ge=l.memoizedState),(ve=po||uA(l,f,ve,g,fe,ge,X)||s!==null&&s.dependencies!==null&&Cg(s.dependencies))?(ue||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(g,ge,X),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(g,ge,X)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ge),E.props=g,E.state=ge,E.context=X,g=ve):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),g=!1)}return E=g,$g(s,l),g=(l.flags&128)!==0,E||g?(E=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&g?(l.child=Bl(l,s.child,null,x),l.child=Bl(l,null,f,x)):br(s,l,f,x),l.memoizedState=E.state,s=l.child):s=ys(s,l,x),s}function AA(s,l,f,g){return Pl(),l.flags|=256,br(s,l,f,g),l.child}var vb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yb(s){return{baseLanes:s,cachePool:gT()}}function bb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=gi),s}function CA(s,l,f){var g=l.pendingProps,x=!1,E=(l.flags&128)!==0,N;if((N=E)||(N=s!==null&&s.memoizedState===null?!1:(On.current&2)!==0),N&&(x=!0,l.flags&=-129),N=(l.flags&32)!==0,l.flags&=-33,s===null){if(Rt){if(x?vo(l):yo(),(s=ln)?(s=OC(s,Di),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:co!==null?{id:Pa,overflow:Oa}:null,retryLane:536870912,hydrationErrors:null},f=sT(s),f.return=l,l.child=f,vr=l,ln=null)):s=null,s===null)throw fo(l);return tx(s)?l.lanes=32:l.lanes=536870912,null}var F=g.children;return g=g.fallback,x?(yo(),x=l.mode,F=Yg({mode:"hidden",children:F},x),g=Ml(g,x,f,null),F.return=l,g.return=l,F.sibling=g,l.child=F,g=l.child,g.memoizedState=yb(f),g.childLanes=bb(s,N,f),l.memoizedState=vb,Rf(null,g)):(vo(l),xb(l,F))}var X=s.memoizedState;if(X!==null&&(F=X.dehydrated,F!==null)){if(E)l.flags&256?(vo(l),l.flags&=-257,l=_b(s,l,f)):l.memoizedState!==null?(yo(),l.child=s.child,l.flags|=128,l=null):(yo(),F=g.fallback,x=l.mode,g=Yg({mode:"visible",children:g.children},x),F=Ml(F,x,f,null),F.flags|=2,g.return=l,F.return=l,g.sibling=F,l.child=g,Bl(l,s.child,null,f),g=l.child,g.memoizedState=yb(f),g.childLanes=bb(s,N,f),l.memoizedState=vb,l=Rf(null,g));else if(vo(l),tx(F)){if(N=F.nextSibling&&F.nextSibling.dataset,N)var ue=N.dgst;N=ue,g=Error(r(419)),g.stack="",g.digest=N,vf({value:g,source:null,stack:null}),l=_b(s,l,f)}else if($n||lu(s,l,f,!1),N=(f&s.childLanes)!==0,$n||N){if(N=nn,N!==null&&(g=xt(N,f),g!==0&&g!==X.retryLane))throw X.retryLane=g,Nl(s,g),Jr(N,s,g),gb;ex(F)||nm(),l=_b(s,l,f)}else ex(F)?(l.flags|=192,l.child=s.child,l=null):(s=X.treeContext,ln=Ni(F.nextSibling),vr=l,Rt=!0,uo=null,Di=!1,s!==null&&cT(l,s),l=xb(l,g.children),l.flags|=4096);return l}return x?(yo(),F=g.fallback,x=l.mode,X=s.child,ue=X.sibling,g=fs(X,{mode:"hidden",children:g.children}),g.subtreeFlags=X.subtreeFlags&65011712,ue!==null?F=fs(ue,F):(F=Ml(F,x,f,null),F.flags|=2),F.return=l,g.return=l,g.sibling=F,l.child=g,Rf(null,g),g=l.child,F=s.child.memoizedState,F===null?F=yb(f):(x=F.cachePool,x!==null?(X=qn._currentValue,x=x.parent!==X?{parent:X,pool:X}:x):x=gT(),F={baseLanes:F.baseLanes|f,cachePool:x}),g.memoizedState=F,g.childLanes=bb(s,N,f),l.memoizedState=vb,Rf(s.child,g)):(vo(l),f=s.child,s=f.sibling,f=fs(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(N=l.deletions,N===null?(l.deletions=[s],l.flags|=16):N.push(s)),l.child=f,l.memoizedState=null,f)}function xb(s,l){return l=Yg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Yg(s,l){return s=di(22,s,null,l),s.lanes=0,s}function _b(s,l,f){return Bl(l,s.child,null,f),s=xb(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function IA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),jy(s.return,l,f)}function wb(s,l,f,g,x,E){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:E}:(N.isBackwards=l,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=f,N.tailMode=x,N.treeForkCount=E)}function RA(s,l,f){var g=l.pendingProps,x=g.revealOrder,E=g.tail;g=g.children;var N=On.current,F=(N&2)!==0;if(F?(N=N&1|2,l.flags|=128):N&=1,Z(On,N),br(s,l,g,f),g=Rt?mf:0,!F&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&IA(s,f,l);else if(s.tag===19)IA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Og(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),wb(l,!1,x,f,E,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Og(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}wb(l,!0,f,null,E,g);break;case"together":wb(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function ys(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),_o|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(lu(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=fs(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=fs(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function Eb(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Cg(s)))}function u5(s,l,f){switch(l.tag){case 3:Se(l,l.stateNode.containerInfo),ho(l,qn,s.memoizedState.cache),Pl();break;case 27:case 5:Ge(l);break;case 4:Se(l,l.stateNode.containerInfo);break;case 10:ho(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Ky(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(vo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?CA(s,l,f):(vo(l),s=ys(s,l,f),s!==null?s.sibling:null);vo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(lu(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return RA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Z(On,On.current),g)break;return null;case 22:return l.lanes=0,_A(s,l,f,l.pendingProps);case 24:ho(l,qn,s.memoizedState.cache)}return ys(s,l,f)}function DA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)$n=!0;else{if(!Eb(s,f)&&(l.flags&128)===0)return $n=!1,u5(s,l,f);$n=(s.flags&131072)!==0}else $n=!1,Rt&&(l.flags&1048576)!==0&&lT(l,mf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=zl(l.elementType),l.type=s,typeof s=="function")Iy(s)?(g=Fl(s,g),l.tag=1,l=TA(null,l,s,g,f)):(l.tag=0,l=mb(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===O){l.tag=11,l=yA(null,l,s,g,f);break e}else if(x===A){l.tag=14,l=bA(null,l,s,g,f);break e}}throw l=J(s)||s,Error(r(306,l,""))}}return l;case 0:return mb(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Fl(g,l.pendingProps),TA(s,l,g,x,f);case 3:e:{if(Se(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var E=l.memoizedState;x=E.element,Gy(s,l),Sf(l,g,null,f);var N=l.memoizedState;if(g=N.cache,ho(l,qn,g),g!==E.cache&&Vy(l,[qn],f,!0),Ef(),g=N.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:N.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=AA(s,l,g,f);break e}else if(g!==x){x=Ci(Error(r(424)),l),vf(x),l=AA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ln=Ni(s.firstChild),vr=l,Rt=!0,uo=null,Di=!0,f=_T(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Pl(),g===x){l=ys(s,l,f);break e}br(s,l,g,f)}l=l.child}return l;case 26:return $g(s,l),s===null?(f=UC(l.type,null,l.pendingProps,null))?l.memoizedState=f:Rt||(f=l.type,s=l.pendingProps,g=cm(he.current).createElement(f),g[Bt]=l,g[fr]=s,xr(g,f,s),Fn(g),l.stateNode=g):l.memoizedState=UC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Ge(l),s===null&&Rt&&(g=l.stateNode=zC(l.type,l.pendingProps,he.current),vr=l,Di=!0,x=ln,Ao(l.type)?(nx=x,ln=Ni(g.firstChild)):ln=x),br(s,l,l.pendingProps.children,f),$g(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Rt&&((x=g=ln)&&(g=B5(g,l.type,l.pendingProps,Di),g!==null?(l.stateNode=g,vr=l,ln=Ni(g.firstChild),Di=!1,x=!0):x=!1),x||fo(l)),Ge(l),x=l.type,E=l.pendingProps,N=s!==null?s.memoizedProps:null,g=E.children,Qb(x,E)?g=null:N!==null&&Qb(x,N)&&(l.flags|=32),l.memoizedState!==null&&(x=Wy(s,l,t5,null,null,f),qf._currentValue=x),$g(s,l),br(s,l,g,f),l.child;case 6:return s===null&&Rt&&((s=f=ln)&&(f=U5(f,l.pendingProps,Di),f!==null?(l.stateNode=f,vr=l,ln=null,s=!0):s=!1),s||fo(l)),null;case 13:return CA(s,l,f);case 4:return Se(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Bl(l,null,g,f):br(s,l,g,f),l.child;case 11:return yA(s,l,l.type,l.pendingProps,f);case 7:return br(s,l,l.pendingProps,f),l.child;case 8:return br(s,l,l.pendingProps.children,f),l.child;case 12:return br(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,ho(l,l.type,g.value),br(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,jl(l),x=yr(x),g=g(x),l.flags|=1,br(s,l,g,f),l.child;case 14:return bA(s,l,l.type,l.pendingProps,f);case 15:return xA(s,l,l.type,l.pendingProps,f);case 19:return RA(s,l,f);case 31:return c5(s,l,f);case 22:return _A(s,l,f,l.pendingProps);case 24:return jl(l),g=yr(qn),s===null?(x=By(),x===null&&(x=nn,E=zy(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=f),x=E),l.memoizedState={parent:g,cache:x},Fy(l),ho(l,qn,x)):((s.lanes&f)!==0&&(Gy(s,l),Sf(l,null,null,f),Ef()),x=s.memoizedState,E=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),ho(l,qn,g)):(g=E.cache,ho(l,qn,g),g!==x.cache&&Vy(l,[qn],f,!0))),br(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function bs(s){s.flags|=4}function Sb(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(rC())s.flags|=8192;else throw Ll=kg,Uy}else s.flags&=-16777217}function kA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!$C(l))if(rC())s.flags|=8192;else throw Ll=kg,Uy}function Kg(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Un():536870912,s.lanes|=l,xu|=l)}function Df(s,l){if(!Rt)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function cn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function d5(s,l,f){var g=l.pendingProps;switch(Ny(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(l),null;case 1:return cn(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),gs(qn),Me(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(ou(l)?bs(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Py())),cn(l),null;case 26:var x=l.type,E=l.memoizedState;return s===null?(bs(l),E!==null?(cn(l),kA(l,E)):(cn(l),Sb(l,x,null,g,f))):E?E!==s.memoizedState?(bs(l),cn(l),kA(l,E)):(cn(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&bs(l),cn(l),Sb(l,x,s,g,f)),null;case 27:if(Ee(l),f=he.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return cn(l),null}s=ee.current,ou(l)?uT(l):(s=zC(x,g,f),l.stateNode=s,bs(l))}return cn(l),null;case 5:if(Ee(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return cn(l),null}if(E=ee.current,ou(l))uT(l);else{var N=cm(he.current);switch(E){case 1:E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=N.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof g.is=="string"?N.createElement("select",{is:g.is}):N.createElement("select"),g.multiple?E.multiple=!0:g.size&&(E.size=g.size);break;default:E=typeof g.is=="string"?N.createElement(x,{is:g.is}):N.createElement(x)}}E[Bt]=l,E[fr]=g;e:for(N=l.child;N!==null;){if(N.tag===5||N.tag===6)E.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===l)break e;for(;N.sibling===null;){if(N.return===null||N.return===l)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}l.stateNode=E;e:switch(xr(E,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&bs(l)}}return cn(l),Sb(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&bs(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=he.current,ou(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=vr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[Bt]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||CC(s.nodeValue,f)),s||fo(l,!0)}else s=cm(s).createTextNode(g),s[Bt]=l,l.stateNode=s}return cn(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=ou(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Bt]=l}else Pl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;cn(l),s=!1}else f=Py(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(hi(l),l):(hi(l),null);if((l.flags&128)!==0)throw Error(r(558))}return cn(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=ou(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Bt]=l}else Pl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;cn(l),x=!1}else x=Py(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(hi(l),l):(hi(l),null)}return hi(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Kg(l,l.updateQueue),cn(l),null);case 4:return Me(),s===null&&$b(l.stateNode.containerInfo),cn(l),null;case 10:return gs(l.type),cn(l),null;case 19:if($(On),g=l.memoizedState,g===null)return cn(l),null;if(x=(l.flags&128)!==0,E=g.rendering,E===null)if(x)Df(g,!1);else{if(In!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Og(s),E!==null){for(l.flags|=128,Df(g,!1),s=E.updateQueue,l.updateQueue=s,Kg(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)aT(f,s),f=f.sibling;return Z(On,On.current&1|2),Rt&&hs(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&rt()>Jg&&(l.flags|=128,x=!0,Df(g,!1),l.lanes=4194304)}else{if(!x)if(s=Og(E),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Kg(l,s),Df(g,!0),g.tail===null&&g.tailMode==="hidden"&&!E.alternate&&!Rt)return cn(l),null}else 2*rt()-g.renderingStartTime>Jg&&f!==536870912&&(l.flags|=128,x=!0,Df(g,!1),l.lanes=4194304);g.isBackwards?(E.sibling=l.child,l.child=E):(s=g.last,s!==null?s.sibling=E:l.child=E,g.last=E)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=rt(),s.sibling=null,f=On.current,Z(On,x?f&1|2:f&1),Rt&&hs(l,g.treeForkCount),s):(cn(l),null);case 22:case 23:return hi(l),Yy(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(cn(l),l.subtreeFlags&6&&(l.flags|=8192)):cn(l),f=l.updateQueue,f!==null&&Kg(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&$(Vl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),gs(qn),cn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function f5(s,l){switch(Ny(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return gs(qn),Me(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return Ee(l),null;case 31:if(l.memoizedState!==null){if(hi(l),l.alternate===null)throw Error(r(340));Pl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(hi(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Pl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return $(On),null;case 4:return Me(),null;case 10:return gs(l.type),null;case 22:case 23:return hi(l),Yy(),s!==null&&$(Vl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return gs(qn),null;case 25:return null;default:return null}}function NA(s,l){switch(Ny(l),l.tag){case 3:gs(qn),Me();break;case 26:case 27:case 5:Ee(l);break;case 4:Me();break;case 31:l.memoizedState!==null&&hi(l);break;case 13:hi(l);break;case 19:$(On);break;case 10:gs(l.type);break;case 22:case 23:hi(l),Yy(),s!==null&&$(Vl);break;case 24:gs(qn)}}function kf(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var E=f.create,N=f.inst;g=E(),N.destroy=g}f=f.next}while(f!==x)}}catch(F){Ht(l,l.return,F)}}function bo(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var E=x.next;g=E;do{if((g.tag&s)===s){var N=g.inst,F=N.destroy;if(F!==void 0){N.destroy=void 0,x=l;var X=f,ue=F;try{ue()}catch(ve){Ht(x,X,ve)}}}g=g.next}while(g!==E)}}catch(ve){Ht(l,l.return,ve)}}function MA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{ET(l,f)}catch(g){Ht(s,s.return,g)}}}function PA(s,l,f){f.props=Fl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){Ht(s,l,g)}}function Nf(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){Ht(s,l,x)}}function ja(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){Ht(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Ht(s,l,x)}else f.current=null}function OA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){Ht(s,s.return,x)}}function Tb(s,l,f){try{var g=s.stateNode;P5(g,s.type,f,l),g[fr]=l}catch(x){Ht(s,s.return,x)}}function jA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ao(s.type)||s.tag===4}function Ab(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ao(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Cb(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Wi));else if(g!==4&&(g===27&&Ao(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(Cb(s,l,f),s=s.sibling;s!==null;)Cb(s,l,f),s=s.sibling}function Xg(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&Ao(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Xg(s,l,f),s=s.sibling;s!==null;)Xg(s,l,f),s=s.sibling}function VA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);xr(l,g,f),l[Bt]=s,l[fr]=f}catch(E){Ht(s,s.return,E)}}var xs=!1,Yn=!1,Ib=!1,zA=typeof WeakSet=="function"?WeakSet:Set,pr=null;function h5(s,l){if(s=s.containerInfo,Xb=mm,s=WS(s),_y(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var N=0,F=-1,X=-1,ue=0,ve=0,be=s,fe=null;t:for(;;){for(var ge;be!==f||x!==0&&be.nodeType!==3||(F=N+x),be!==E||g!==0&&be.nodeType!==3||(X=N+g),be.nodeType===3&&(N+=be.nodeValue.length),(ge=be.firstChild)!==null;)fe=be,be=ge;for(;;){if(be===s)break t;if(fe===f&&++ue===x&&(F=N),fe===E&&++ve===g&&(X=N),(ge=be.nextSibling)!==null)break;be=fe,fe=be.parentNode}be=ge}f=F===-1||X===-1?null:{start:F,end:X}}else f=null}f=f||{start:0,end:0}}else f=null;for(Wb={focusedElem:s,selectionRange:f},mm=!1,pr=l;pr!==null;)if(l=pr,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,pr=s;else for(;pr!==null;){switch(l=pr,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,f=l,x=E.memoizedProps,E=E.memoizedState,g=f.stateNode;try{var je=Fl(f.type,x);s=g.getSnapshotBeforeUpdate(je,E),g.__reactInternalSnapshotBeforeUpdate=s}catch(Xe){Ht(f,f.return,Xe)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)Jb(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Jb(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,pr=s;break}pr=l.return}}function LA(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:ws(s,f),g&4&&kf(5,f);break;case 1:if(ws(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(N){Ht(f,f.return,N)}else{var x=Fl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Ht(f,f.return,N)}}g&64&&MA(f),g&512&&Nf(f,f.return);break;case 3:if(ws(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{ET(s,l)}catch(N){Ht(f,f.return,N)}}break;case 27:l===null&&g&4&&VA(f);case 26:case 5:ws(s,f),l===null&&g&4&&OA(f),g&512&&Nf(f,f.return);break;case 12:ws(s,f);break;case 31:ws(s,f),g&4&&FA(s,f);break;case 13:ws(s,f),g&4&&GA(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=w5.bind(null,f),F5(s,f))));break;case 22:if(g=f.memoizedState!==null||xs,!g){l=l!==null&&l.memoizedState!==null||Yn,x=xs;var E=Yn;xs=g,(Yn=l)&&!E?Es(s,f,(f.subtreeFlags&8772)!==0):ws(s,f),xs=x,Yn=E}break;case 30:break;default:ws(s,f)}}function BA(s){var l=s.alternate;l!==null&&(s.alternate=null,BA(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&qc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var pn=null,Xr=!1;function _s(s,l,f){for(f=f.child;f!==null;)UA(s,l,f),f=f.sibling}function UA(s,l,f){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(jr,f)}catch{}switch(f.tag){case 26:Yn||ja(f,l),_s(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Yn||ja(f,l);var g=pn,x=Xr;Ao(f.type)&&(pn=f.stateNode,Xr=!1),_s(s,l,f),Uf(f.stateNode),pn=g,Xr=x;break;case 5:Yn||ja(f,l);case 6:if(g=pn,x=Xr,pn=null,_s(s,l,f),pn=g,Xr=x,pn!==null)if(Xr)try{(pn.nodeType===9?pn.body:pn.nodeName==="HTML"?pn.ownerDocument.body:pn).removeChild(f.stateNode)}catch(E){Ht(f,l,E)}else try{pn.removeChild(f.stateNode)}catch(E){Ht(f,l,E)}break;case 18:pn!==null&&(Xr?(s=pn,MC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Iu(s)):MC(pn,f.stateNode));break;case 4:g=pn,x=Xr,pn=f.stateNode.containerInfo,Xr=!0,_s(s,l,f),pn=g,Xr=x;break;case 0:case 11:case 14:case 15:bo(2,f,l),Yn||bo(4,f,l),_s(s,l,f);break;case 1:Yn||(ja(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&PA(f,l,g)),_s(s,l,f);break;case 21:_s(s,l,f);break;case 22:Yn=(g=Yn)||f.memoizedState!==null,_s(s,l,f),Yn=g;break;default:_s(s,l,f)}}function FA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Iu(s)}catch(f){Ht(l,l.return,f)}}}function GA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Iu(s)}catch(f){Ht(l,l.return,f)}}function p5(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new zA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new zA),l;default:throw Error(r(435,s.tag))}}function Wg(s,l){var f=p5(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=E5.bind(null,s,g);g.then(x,x)}})}function Wr(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],E=s,N=l,F=N;e:for(;F!==null;){switch(F.tag){case 27:if(Ao(F.type)){pn=F.stateNode,Xr=!1;break e}break;case 5:pn=F.stateNode,Xr=!1;break e;case 3:case 4:pn=F.stateNode.containerInfo,Xr=!0;break e}F=F.return}if(pn===null)throw Error(r(160));UA(E,N,x),pn=null,Xr=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)qA(l,s),l=l.sibling}var na=null;function qA(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Wr(l,s),Qr(s),g&4&&(bo(3,s,s.return),kf(3,s),bo(5,s,s.return));break;case 1:Wr(l,s),Qr(s),g&512&&(Yn||f===null||ja(f,f.return)),g&64&&xs&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=na;if(Wr(l,s),Qr(s),g&512&&(Yn||f===null||ja(f,f.return)),g&4){var E=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":E=x.getElementsByTagName("title")[0],(!E||E[wa]||E[Bt]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(g),x.head.insertBefore(E,x.querySelector("head > title"))),xr(E,g,f),E[Bt]=s,Fn(E),g=E;break e;case"link":var N=qC("link","href",x).get(g+(f.href||""));if(N){for(var F=0;F<N.length;F++)if(E=N[F],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){N.splice(F,1);break t}}E=x.createElement(g),xr(E,g,f),x.head.appendChild(E);break;case"meta":if(N=qC("meta","content",x).get(g+(f.content||""))){for(F=0;F<N.length;F++)if(E=N[F],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){N.splice(F,1);break t}}E=x.createElement(g),xr(E,g,f),x.head.appendChild(E);break;default:throw Error(r(468,g))}E[Bt]=s,Fn(E),g=E}s.stateNode=g}else HC(x,s.type,s.stateNode);else s.stateNode=GC(x,g,s.memoizedProps);else E!==g?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,g===null?HC(x,s.type,s.stateNode):GC(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&Tb(s,s.memoizedProps,f.memoizedProps)}break;case 27:Wr(l,s),Qr(s),g&512&&(Yn||f===null||ja(f,f.return)),f!==null&&g&4&&Tb(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Wr(l,s),Qr(s),g&512&&(Yn||f===null||ja(f,f.return)),s.flags&32){x=s.stateNode;try{Kr(x,"")}catch(je){Ht(s,s.return,je)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,Tb(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Ib=!0);break;case 6:if(Wr(l,s),Qr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(je){Ht(s,s.return,je)}}break;case 3:if(fm=null,x=na,na=um(l.containerInfo),Wr(l,s),na=x,Qr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Iu(l.containerInfo)}catch(je){Ht(s,s.return,je)}Ib&&(Ib=!1,HA(s));break;case 4:g=na,na=um(s.stateNode.containerInfo),Wr(l,s),Qr(s),na=g;break;case 12:Wr(l,s),Qr(s);break;case 31:Wr(l,s),Qr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 13:Wr(l,s),Qr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Zg=rt()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 22:x=s.memoizedState!==null;var X=f!==null&&f.memoizedState!==null,ue=xs,ve=Yn;if(xs=ue||x,Yn=ve||X,Wr(l,s),Yn=ve,xs=ue,Qr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||X||xs||Yn||Gl(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){X=f=l;try{if(E=X.stateNode,x)N=E.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{F=X.stateNode;var be=X.memoizedProps.style,fe=be!=null&&be.hasOwnProperty("display")?be.display:null;F.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(je){Ht(X,X.return,je)}}}else if(l.tag===6){if(f===null){X=l;try{X.stateNode.nodeValue=x?"":X.memoizedProps}catch(je){Ht(X,X.return,je)}}}else if(l.tag===18){if(f===null){X=l;try{var ge=X.stateNode;x?PC(ge,!0):PC(X.stateNode,!1)}catch(je){Ht(X,X.return,je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Wg(s,f))));break;case 19:Wr(l,s),Qr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 30:break;case 21:break;default:Wr(l,s),Qr(s)}}function Qr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(jA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,E=Ab(s);Xg(s,E,x);break;case 5:var N=f.stateNode;f.flags&32&&(Kr(N,""),f.flags&=-33);var F=Ab(s);Xg(s,F,N);break;case 3:case 4:var X=f.stateNode.containerInfo,ue=Ab(s);Cb(s,ue,X);break;default:throw Error(r(161))}}catch(ve){Ht(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function HA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;HA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function ws(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)LA(s,l.alternate,l),l=l.sibling}function Gl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:bo(4,l,l.return),Gl(l);break;case 1:ja(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&PA(l,l.return,f),Gl(l);break;case 27:Uf(l.stateNode);case 26:case 5:ja(l,l.return),Gl(l);break;case 22:l.memoizedState===null&&Gl(l);break;case 30:Gl(l);break;default:Gl(l)}s=s.sibling}}function Es(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,E=l,N=E.flags;switch(E.tag){case 0:case 11:case 15:Es(x,E,f),kf(4,E);break;case 1:if(Es(x,E,f),g=E,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ue){Ht(g,g.return,ue)}if(g=E,x=g.updateQueue,x!==null){var F=g.stateNode;try{var X=x.shared.hiddenCallbacks;if(X!==null)for(x.shared.hiddenCallbacks=null,x=0;x<X.length;x++)wT(X[x],F)}catch(ue){Ht(g,g.return,ue)}}f&&N&64&&MA(E),Nf(E,E.return);break;case 27:VA(E);case 26:case 5:Es(x,E,f),f&&g===null&&N&4&&OA(E),Nf(E,E.return);break;case 12:Es(x,E,f);break;case 31:Es(x,E,f),f&&N&4&&FA(x,E);break;case 13:Es(x,E,f),f&&N&4&&GA(x,E);break;case 22:E.memoizedState===null&&Es(x,E,f),Nf(E,E.return);break;case 30:break;default:Es(x,E,f)}l=l.sibling}}function Rb(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&yf(f))}function Db(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&yf(s))}function ra(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)$A(s,l,f,g),l=l.sibling}function $A(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:ra(s,l,f,g),x&2048&&kf(9,l);break;case 1:ra(s,l,f,g);break;case 3:ra(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&yf(s)));break;case 12:if(x&2048){ra(s,l,f,g),s=l.stateNode;try{var E=l.memoizedProps,N=E.id,F=E.onPostCommit;typeof F=="function"&&F(N,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(X){Ht(l,l.return,X)}}else ra(s,l,f,g);break;case 31:ra(s,l,f,g);break;case 13:ra(s,l,f,g);break;case 23:break;case 22:E=l.stateNode,N=l.alternate,l.memoizedState!==null?E._visibility&2?ra(s,l,f,g):Mf(s,l):E._visibility&2?ra(s,l,f,g):(E._visibility|=2,vu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Rb(N,l);break;case 24:ra(s,l,f,g),x&2048&&Db(l.alternate,l);break;default:ra(s,l,f,g)}}function vu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,N=l,F=f,X=g,ue=N.flags;switch(N.tag){case 0:case 11:case 15:vu(E,N,F,X,x),kf(8,N);break;case 23:break;case 22:var ve=N.stateNode;N.memoizedState!==null?ve._visibility&2?vu(E,N,F,X,x):Mf(E,N):(ve._visibility|=2,vu(E,N,F,X,x)),x&&ue&2048&&Rb(N.alternate,N);break;case 24:vu(E,N,F,X,x),x&&ue&2048&&Db(N.alternate,N);break;default:vu(E,N,F,X,x)}l=l.sibling}}function Mf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:Mf(f,g),x&2048&&Rb(g.alternate,g);break;case 24:Mf(f,g),x&2048&&Db(g.alternate,g);break;default:Mf(f,g)}l=l.sibling}}var Pf=8192;function yu(s,l,f){if(s.subtreeFlags&Pf)for(s=s.child;s!==null;)YA(s,l,f),s=s.sibling}function YA(s,l,f){switch(s.tag){case 26:yu(s,l,f),s.flags&Pf&&s.memoizedState!==null&&e6(f,na,s.memoizedState,s.memoizedProps);break;case 5:yu(s,l,f);break;case 3:case 4:var g=na;na=um(s.stateNode.containerInfo),yu(s,l,f),na=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Pf,Pf=16777216,yu(s,l,f),Pf=g):yu(s,l,f));break;default:yu(s,l,f)}}function KA(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Of(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];pr=g,WA(g,s)}KA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)XA(s),s=s.sibling}function XA(s){switch(s.tag){case 0:case 11:case 15:Of(s),s.flags&2048&&bo(9,s,s.return);break;case 3:Of(s);break;case 12:Of(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Qg(s)):Of(s);break;default:Of(s)}}function Qg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];pr=g,WA(g,s)}KA(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:bo(8,l,l.return),Qg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Qg(l));break;default:Qg(l)}s=s.sibling}}function WA(s,l){for(;pr!==null;){var f=pr;switch(f.tag){case 0:case 11:case 15:bo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:yf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,pr=g;else e:for(f=s;pr!==null;){g=pr;var x=g.sibling,E=g.return;if(BA(g),g===f){pr=null;break e}if(x!==null){x.return=E,pr=x;break e}pr=E}}}var g5={getCacheForType:function(s){var l=yr(qn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return yr(qn).controller.signal}},m5=typeof WeakMap=="function"?WeakMap:Map,zt=0,nn=null,_t=null,St=0,qt=0,pi=null,xo=!1,bu=!1,kb=!1,Ss=0,In=0,_o=0,ql=0,Nb=0,gi=0,xu=0,jf=null,Zr=null,Mb=!1,Zg=0,QA=0,Jg=1/0,em=null,wo=null,rr=0,Eo=null,_u=null,Ts=0,Pb=0,Ob=null,ZA=null,Vf=0,jb=null;function mi(){return(zt&2)!==0&&St!==0?St&-St:H.T!==null?Fb():xa()}function JA(){if(gi===0)if((St&536870912)===0||Rt){var s=Ze;Ze<<=1,(Ze&3932160)===0&&(Ze=262144),gi=s}else gi=536870912;return s=fi.current,s!==null&&(s.flags|=32),gi}function Jr(s,l,f){(s===nn&&(qt===2||qt===9)||s.cancelPendingCommit!==null)&&(wu(s,0),So(s,St,gi,!1)),It(s,f),((zt&2)===0||s!==nn)&&(s===nn&&((zt&2)===0&&(ql|=f),In===4&&So(s,St,gi,!1)),Va(s))}function eC(s,l,f){if((zt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||on(s,l),x=g?b5(s,l):zb(s,l,!0),E=g;do{if(x===0){bu&&!g&&So(s,l,0,!1);break}else{if(f=s.current.alternate,E&&!v5(f)){x=zb(s,l,!1),E=!1;continue}if(x===2){if(E=l,s.errorRecoveryDisabledLanes&E)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){l=N;e:{var F=s;x=jf;var X=F.current.memoizedState.isDehydrated;if(X&&(wu(F,N).flags|=256),N=zb(F,N,!1),N!==2){if(kb&&!X){F.errorRecoveryDisabledLanes|=E,ql|=E,x=4;break e}E=Zr,Zr=x,E!==null&&(Zr===null?Zr=E:Zr.push.apply(Zr,E))}x=N}if(E=!1,x!==2)continue}}if(x===1){wu(s,0),So(s,l,0,!0);break}e:{switch(g=s,E=x,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:So(g,l,gi,!xo);break e;case 2:Zr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Zg+300-rt(),10<x)){if(So(g,l,gi,!xo),fn(g,0,!0)!==0)break e;Ts=l,g.timeoutHandle=kC(tC.bind(null,g,f,Zr,em,Mb,l,gi,ql,xu,xo,E,"Throttled",-0,0),x);break e}tC(g,f,Zr,em,Mb,l,gi,ql,xu,xo,E,null,-0,0)}}break}while(!0);Va(s)}function tC(s,l,f,g,x,E,N,F,X,ue,ve,be,fe,ge){if(s.timeoutHandle=-1,be=l.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Wi},YA(l,E,be);var je=(E&62914560)===E?Zg-rt():(E&4194048)===E?QA-rt():0;if(je=t6(be,je),je!==null){Ts=E,s.cancelPendingCommit=je(cC.bind(null,s,l,E,f,g,x,N,F,X,ve,be,null,fe,ge)),So(s,E,N,!ue);return}}cC(s,l,E,f,g,x,N,F,X)}function v5(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],E=x.getSnapshot;x=x.value;try{if(!ui(E(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function So(s,l,f,g){l&=~Nb,l&=~ql,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var E=31-sn(x),N=1<<E;g[E]=-1,x&=~N}f!==0&&jt(s,f,l)}function tm(){return(zt&6)===0?(zf(0),!1):!0}function Vb(){if(_t!==null){if(qt===0)var s=_t.return;else s=_t,ps=Ol=null,Jy(s),fu=null,xf=0,s=_t;for(;s!==null;)NA(s.alternate,s),s=s.return;_t=null}}function wu(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,V5(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Ts=0,Vb(),nn=s,_t=f=fs(s.current,null),St=l,qt=0,pi=null,xo=!1,bu=on(s,l),kb=!1,xu=gi=Nb=ql=_o=In=0,Zr=jf=null,Mb=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-sn(g),E=1<<x;l|=s[x],g&=~E}return Ss=l,wg(),f}function nC(s,l){ht=null,H.H=If,l===du||l===Dg?(l=yT(),qt=3):l===Uy?(l=yT(),qt=4):qt=l===gb?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,pi=l,_t===null&&(In=1,qg(s,Ci(l,s.current)))}function rC(){var s=fi.current;return s===null?!0:(St&4194048)===St?ki===null:(St&62914560)===St||(St&536870912)!==0?s===ki:!1}function iC(){var s=H.H;return H.H=If,s===null?If:s}function aC(){var s=H.A;return H.A=g5,s}function nm(){In=4,xo||(St&4194048)!==St&&fi.current!==null||(bu=!0),(_o&134217727)===0&&(ql&134217727)===0||nn===null||So(nn,St,gi,!1)}function zb(s,l,f){var g=zt;zt|=2;var x=iC(),E=aC();(nn!==s||St!==l)&&(em=null,wu(s,l)),l=!1;var N=In;e:do try{if(qt!==0&&_t!==null){var F=_t,X=pi;switch(qt){case 8:Vb(),N=6;break e;case 3:case 2:case 9:case 6:fi.current===null&&(l=!0);var ue=qt;if(qt=0,pi=null,Eu(s,F,X,ue),f&&bu){N=0;break e}break;default:ue=qt,qt=0,pi=null,Eu(s,F,X,ue)}}y5(),N=In;break}catch(ve){nC(s,ve)}while(!0);return l&&s.shellSuspendCounter++,ps=Ol=null,zt=g,H.H=x,H.A=E,_t===null&&(nn=null,St=0,wg()),N}function y5(){for(;_t!==null;)sC(_t)}function b5(s,l){var f=zt;zt|=2;var g=iC(),x=aC();nn!==s||St!==l?(em=null,Jg=rt()+500,wu(s,l)):bu=on(s,l);e:do try{if(qt!==0&&_t!==null){l=_t;var E=pi;t:switch(qt){case 1:qt=0,pi=null,Eu(s,l,E,1);break;case 2:case 9:if(mT(E)){qt=0,pi=null,oC(l);break}l=function(){qt!==2&&qt!==9||nn!==s||(qt=7),Va(s)},E.then(l,l);break e;case 3:qt=7;break e;case 4:qt=5;break e;case 7:mT(E)?(qt=0,pi=null,oC(l)):(qt=0,pi=null,Eu(s,l,E,7));break;case 5:var N=null;switch(_t.tag){case 26:N=_t.memoizedState;case 5:case 27:var F=_t;if(N?$C(N):F.stateNode.complete){qt=0,pi=null;var X=F.sibling;if(X!==null)_t=X;else{var ue=F.return;ue!==null?(_t=ue,rm(ue)):_t=null}break t}}qt=0,pi=null,Eu(s,l,E,5);break;case 6:qt=0,pi=null,Eu(s,l,E,6);break;case 8:Vb(),In=6;break e;default:throw Error(r(462))}}x5();break}catch(ve){nC(s,ve)}while(!0);return ps=Ol=null,H.H=g,H.A=x,zt=f,_t!==null?0:(nn=null,St=0,wg(),In)}function x5(){for(;_t!==null&&!Qe();)sC(_t)}function sC(s){var l=DA(s.alternate,s,Ss);s.memoizedProps=s.pendingProps,l===null?rm(s):_t=l}function oC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=SA(f,l,l.pendingProps,l.type,void 0,St);break;case 11:l=SA(f,l,l.pendingProps,l.type.render,l.ref,St);break;case 5:Jy(l);default:NA(f,l),l=_t=aT(l,Ss),l=DA(f,l,Ss)}s.memoizedProps=s.pendingProps,l===null?rm(s):_t=l}function Eu(s,l,f,g){ps=Ol=null,Jy(l),fu=null,xf=0;var x=l.return;try{if(l5(s,x,l,f,St)){In=1,qg(s,Ci(f,s.current)),_t=null;return}}catch(E){if(x!==null)throw _t=x,E;In=1,qg(s,Ci(f,s.current)),_t=null;return}l.flags&32768?(Rt||g===1?s=!0:bu||(St&536870912)!==0?s=!1:(xo=s=!0,(g===2||g===9||g===3||g===6)&&(g=fi.current,g!==null&&g.tag===13&&(g.flags|=16384))),lC(l,s)):rm(l)}function rm(s){var l=s;do{if((l.flags&32768)!==0){lC(l,xo);return}s=l.return;var f=d5(l.alternate,l,Ss);if(f!==null){_t=f;return}if(l=l.sibling,l!==null){_t=l;return}_t=l=s}while(l!==null);In===0&&(In=5)}function lC(s,l){do{var f=f5(s.alternate,s);if(f!==null){f.flags&=32767,_t=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){_t=s;return}_t=s=f}while(s!==null);In=6,_t=null}function cC(s,l,f,g,x,E,N,F,X){s.cancelPendingCommit=null;do im();while(rr!==0);if((zt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Ay,bn(s,f,E,N,F,X),s===nn&&(_t=nn=null,St=0),_u=l,Eo=s,Ts=f,Pb=E,Ob=x,ZA=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,S5(Bn,function(){return pC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=H.T,H.T=null,x=W.p,W.p=2,N=zt,zt|=4;try{h5(s,l,f)}finally{zt=N,W.p=x,H.T=g}}rr=1,uC(),dC(),fC()}}function uC(){if(rr===1){rr=0;var s=Eo,l=_u,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=H.T,H.T=null;var g=W.p;W.p=2;var x=zt;zt|=4;try{qA(l,s);var E=Wb,N=WS(s.containerInfo),F=E.focusedElem,X=E.selectionRange;if(N!==F&&F&&F.ownerDocument&&XS(F.ownerDocument.documentElement,F)){if(X!==null&&_y(F)){var ue=X.start,ve=X.end;if(ve===void 0&&(ve=ue),"selectionStart"in F)F.selectionStart=ue,F.selectionEnd=Math.min(ve,F.value.length);else{var be=F.ownerDocument||document,fe=be&&be.defaultView||window;if(fe.getSelection){var ge=fe.getSelection(),je=F.textContent.length,Xe=Math.min(X.start,je),Qt=X.end===void 0?Xe:Math.min(X.end,je);!ge.extend&&Xe>Qt&&(N=Qt,Qt=Xe,Xe=N);var ie=KS(F,Xe),re=KS(F,Qt);if(ie&&re&&(ge.rangeCount!==1||ge.anchorNode!==ie.node||ge.anchorOffset!==ie.offset||ge.focusNode!==re.node||ge.focusOffset!==re.offset)){var ce=be.createRange();ce.setStart(ie.node,ie.offset),ge.removeAllRanges(),Xe>Qt?(ge.addRange(ce),ge.extend(re.node,re.offset)):(ce.setEnd(re.node,re.offset),ge.addRange(ce))}}}}for(be=[],ge=F;ge=ge.parentNode;)ge.nodeType===1&&be.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<be.length;F++){var ye=be[F];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}mm=!!Xb,Wb=Xb=null}finally{zt=x,W.p=g,H.T=f}}s.current=l,rr=2}}function dC(){if(rr===2){rr=0;var s=Eo,l=_u,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=H.T,H.T=null;var g=W.p;W.p=2;var x=zt;zt|=4;try{LA(s,l.alternate,l)}finally{zt=x,W.p=g,H.T=f}}rr=3}}function fC(){if(rr===4||rr===3){rr=0,Ft();var s=Eo,l=_u,f=Ts,g=ZA;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?rr=5:(rr=0,_u=Eo=null,hC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(wo=null),_n(f),l=l.stateNode,An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(jr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=H.T,x=W.p,W.p=2,H.T=null;try{for(var E=s.onRecoverableError,N=0;N<g.length;N++){var F=g[N];E(F.value,{componentStack:F.stack})}}finally{H.T=l,W.p=x}}(Ts&3)!==0&&im(),Va(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===jb?Vf++:(Vf=0,jb=s):Vf=0,zf(0)}}function hC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,yf(l)))}function im(){return uC(),dC(),fC(),pC()}function pC(){if(rr!==5)return!1;var s=Eo,l=Pb;Pb=0;var f=_n(Ts),g=H.T,x=W.p;try{W.p=32>f?32:f,H.T=null,f=Ob,Ob=null;var E=Eo,N=Ts;if(rr=0,_u=Eo=null,Ts=0,(zt&6)!==0)throw Error(r(331));var F=zt;if(zt|=4,XA(E.current),$A(E,E.current,N,f),zt=F,zf(0,!1),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(jr,E)}catch{}return!0}finally{W.p=x,H.T=g,hC(s,l)}}function gC(s,l,f){l=Ci(f,l),l=pb(s.stateNode,l,2),s=mo(s,l,2),s!==null&&(It(s,2),Va(s))}function Ht(s,l,f){if(s.tag===3)gC(s,s,f);else for(;l!==null;){if(l.tag===3){gC(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(wo===null||!wo.has(g))){s=Ci(f,s),f=mA(2),g=mo(l,f,2),g!==null&&(vA(f,g,l,s),It(g,2),Va(g));break}}l=l.return}}function Lb(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new m5;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(kb=!0,x.add(f),s=_5.bind(null,s,l,f),l.then(s,s))}function _5(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,nn===s&&(St&f)===f&&(In===4||In===3&&(St&62914560)===St&&300>rt()-Zg?(zt&2)===0&&wu(s,0):Nb|=f,xu===St&&(xu=0)),Va(s)}function mC(s,l){l===0&&(l=Un()),s=Nl(s,l),s!==null&&(It(s,l),Va(s))}function w5(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),mC(s,f)}function E5(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),mC(s,f)}function S5(s,l){return Pe(s,l)}var am=null,Su=null,Bb=!1,sm=!1,Ub=!1,To=0;function Va(s){s!==Su&&s.next===null&&(Su===null?am=Su=s:Su=Su.next=s),sm=!0,Bb||(Bb=!0,A5())}function zf(s,l){if(!Ub&&sm){Ub=!0;do for(var f=!1,g=am;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var E=0;else{var N=g.suspendedLanes,F=g.pingedLanes;E=(1<<31-sn(42|s)+1)-1,E&=x&~(N&~F),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,xC(g,E))}else E=St,E=fn(g,g===nn?E:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(E&3)===0||on(g,E)||(f=!0,xC(g,E));g=g.next}while(f);Ub=!1}}function T5(){vC()}function vC(){sm=Bb=!1;var s=0;To!==0&&j5()&&(s=To);for(var l=rt(),f=null,g=am;g!==null;){var x=g.next,E=yC(g,l);E===0?(g.next=null,f===null?am=x:f.next=x,x===null&&(Su=f)):(f=g,(s!==0||(E&3)!==0)&&(sm=!0)),g=x}rr!==0&&rr!==5||zf(s),To!==0&&(To=0)}function yC(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var N=31-sn(E),F=1<<N,X=x[N];X===-1?((F&f)===0||(F&g)!==0)&&(x[N]=Vr(F,l)):X<=l&&(s.expiredLanes|=F),E&=~F}if(l=nn,f=St,f=fn(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(qt===2||qt===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&nt(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||on(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&nt(g),_n(f)){case 2:case 8:f=an;break;case 32:f=Bn;break;case 268435456:f=ls;break;default:f=Bn}return g=bC.bind(null,s),f=Pe(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&nt(g),s.callbackPriority=2,s.callbackNode=null,2}function bC(s,l){if(rr!==0&&rr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(im()&&s.callbackNode!==f)return null;var g=St;return g=fn(s,s===nn?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(eC(s,g,l),yC(s,rt()),s.callbackNode!=null&&s.callbackNode===f?bC.bind(null,s):null)}function xC(s,l){if(im())return null;eC(s,l,!0)}function A5(){z5(function(){(zt&6)!==0?Pe(Ot,T5):vC()})}function Fb(){if(To===0){var s=cu;s===0&&(s=Ce,Ce<<=1,(Ce&261888)===0&&(Ce=256)),To=s}return To}function _C(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Kc(""+s)}function wC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function C5(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var E=_C((x[fr]||null).action),N=g.submitter;N&&(l=(l=N[fr]||null)?_C(l.formAction):N.getAttribute("formAction"),l!==null&&(E=l,N=null));var F=new Da("action","action",null,g,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(To!==0){var X=N?wC(x,N):new FormData(x);lb(f,{pending:!0,data:X,method:x.method,action:E},null,X)}}else typeof E=="function"&&(F.preventDefault(),X=N?wC(x,N):new FormData(x),lb(f,{pending:!0,data:X,method:x.method,action:E},E,X))},currentTarget:x}]})}}for(var Gb=0;Gb<Ty.length;Gb++){var qb=Ty[Gb],I5=qb.toLowerCase(),R5=qb[0].toUpperCase()+qb.slice(1);ta(I5,"on"+R5)}ta(JS,"onAnimationEnd"),ta(eT,"onAnimationIteration"),ta(tT,"onAnimationStart"),ta("dblclick","onDoubleClick"),ta("focusin","onFocus"),ta("focusout","onBlur"),ta(HV,"onTransitionRun"),ta($V,"onTransitionStart"),ta(YV,"onTransitionCancel"),ta(nT,"onTransitionEnd"),Aa("onMouseEnter",["mouseout","mouseover"]),Aa("onMouseLeave",["mouseout","mouseover"]),Aa("onPointerEnter",["pointerout","pointerover"]),Aa("onPointerLeave",["pointerout","pointerover"]),Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D5=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lf));function EC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var N=g.length-1;0<=N;N--){var F=g[N],X=F.instance,ue=F.currentTarget;if(F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ue;try{E(x)}catch(ve){_g(ve)}x.currentTarget=null,E=X}else for(N=0;N<g.length;N++){if(F=g[N],X=F.instance,ue=F.currentTarget,F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ue;try{E(x)}catch(ve){_g(ve)}x.currentTarget=null,E=X}}}}function wt(s,l){var f=l[Gc];f===void 0&&(f=l[Gc]=new Set);var g=s+"__bubble";f.has(g)||(SC(l,s,2,!1),f.add(g))}function Hb(s,l,f){var g=0;l&&(g|=4),SC(f,s,g,l)}var om="_reactListening"+Math.random().toString(36).slice(2);function $b(s){if(!s[om]){s[om]=!0,Wd.forEach(function(f){f!=="selectionchange"&&(D5.has(f)||Hb(f,!1,s),Hb(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[om]||(l[om]=!0,Hb("selectionchange",!1,l))}}function SC(s,l,f,g){switch(JC(l)){case 2:var x=i6;break;case 8:x=a6;break;default:x=ox}f=x.bind(null,l,f,s),x=void 0,!Sl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Yb(s,l,f,g,x){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var F=g.stateNode.containerInfo;if(F===x)break;if(N===4)for(N=g.return;N!==null;){var X=N.tag;if((X===3||X===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;F!==null;){if(N=Ea(F),N===null)return;if(X=N.tag,X===5||X===6||X===26||X===27){g=E=N;continue e}F=F.parentNode}}g=g.return}ao(function(){var ue=E,ve=Ei(f),be=[];e:{var fe=rT.get(s);if(fe!==void 0){var ge=Da,je=s;switch(s){case"keypress":if(Al(f)===0)break e;case"keydown":case"keyup":ge=yg;break;case"focusin":je="focus",ge=Il;break;case"focusout":je="blur",ge=Il;break;case"beforeblur":case"afterblur":ge=Il;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=uf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=R;break;case JS:case eT:case tT:ge=dg;break;case nT:ge=q;break;case"scroll":case"scrollend":ge=cf;break;case"wheel":ge=pe;break;case"copy":case"cut":case"paste":ge=fg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=ds;break;case"toggle":case"beforetoggle":ge=ft}var Xe=(l&4)!==0,Qt=!Xe&&(s==="scroll"||s==="scrollend"),ie=Xe?fe!==null?fe+"Capture":null:fe;Xe=[];for(var re=ue,ce;re!==null;){var ye=re;if(ce=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ce===null||ie===null||(ye=Qi(re,ie),ye!=null&&Xe.push(Bf(re,ye,ce))),Qt)break;re=re.return}0<Xe.length&&(fe=new ge(fe,je,null,f,ve),be.push({event:fe,listeners:Xe}))}}if((l&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",fe&&f!==sf&&(je=f.relatedTarget||f.fromElement)&&(Ea(je)||je[_a]))break e;if((ge||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,ge?(je=f.relatedTarget||f.toElement,ge=ue,je=je?Ea(je):null,je!==null&&(Qt=a(je),Xe=je.tag,je!==Qt||Xe!==5&&Xe!==27&&Xe!==6)&&(je=null)):(ge=null,je=ue),ge!==je)){if(Xe=uf,ye="onMouseLeave",ie="onMouseEnter",re="mouse",(s==="pointerout"||s==="pointerover")&&(Xe=ds,ye="onPointerLeave",ie="onPointerEnter",re="pointer"),Qt=ge==null?fe:li(ge),ce=je==null?fe:li(je),fe=new Xe(ye,re+"leave",ge,f,ve),fe.target=Qt,fe.relatedTarget=ce,ye=null,Ea(ve)===ue&&(Xe=new Xe(ie,re+"enter",je,f,ve),Xe.target=ce,Xe.relatedTarget=Qt,ye=Xe),Qt=ye,ge&&je)t:{for(Xe=k5,ie=ge,re=je,ce=0,ye=ie;ye;ye=Xe(ye))ce++;ye=0;for(var $e=re;$e;$e=Xe($e))ye++;for(;0<ce-ye;)ie=Xe(ie),ce--;for(;0<ye-ce;)re=Xe(re),ye--;for(;ce--;){if(ie===re||re!==null&&ie===re.alternate){Xe=ie;break t}ie=Xe(ie),re=Xe(re)}Xe=null}else Xe=null;ge!==null&&TC(be,fe,ge,Xe,!1),je!==null&&Qt!==null&&TC(be,Qt,je,Xe,!0)}}e:{if(fe=ue?li(ue):window,ge=fe.nodeName&&fe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&fe.type==="file")var Mt=FS;else if(BS(fe))if(GS)Mt=FV;else{Mt=BV;var Be=LV}else ge=fe.nodeName,!ge||ge.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ue&&Yc(ue.elementType)&&(Mt=FS):Mt=UV;if(Mt&&(Mt=Mt(s,ue))){US(be,Mt,f,ve);break e}Be&&Be(s,fe,ue),s==="focusout"&&ue&&fe.type==="number"&&ue.memoizedProps.value!=null&&nf(fe,"number",fe.value)}switch(Be=ue?li(ue):window,s){case"focusin":(BS(Be)||Be.contentEditable==="true")&&(tu=Be,wy=ue,gf=null);break;case"focusout":gf=wy=tu=null;break;case"mousedown":Ey=!0;break;case"contextmenu":case"mouseup":case"dragend":Ey=!1,QS(be,f,ve);break;case"selectionchange":if(qV)break;case"keydown":case"keyup":QS(be,f,ve)}var gt;if(Vt)e:{switch(s){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else eu?Rl(s,f)&&(Tt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(Tt="onCompositionStart");Tt&&(Ma&&f.locale!=="ko"&&(eu||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&eu&&(gt=lf()):(Ra=ve,of="value"in Ra?Ra.value:Ra.textContent,eu=!0)),Be=lm(ue,Tt),0<Be.length&&(Tt=new Na(Tt,s,null,f,ve),be.push({event:Tt,listeners:Be}),gt?Tt.data=gt:(gt=Jc(f),gt!==null&&(Tt.data=gt)))),(gt=Ti?OV(s,f):jV(s,f))&&(Tt=lm(ue,"onBeforeInput"),0<Tt.length&&(Be=new Na("onBeforeInput","beforeinput",null,f,ve),be.push({event:Be,listeners:Tt}),Be.data=gt)),C5(be,s,ue,f,ve)}EC(be,l)})}function Bf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function lm(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=Qi(s,f),x!=null&&g.unshift(Bf(s,x,E)),x=Qi(s,l),x!=null&&g.push(Bf(s,x,E))),s.tag===3)return g;s=s.return}return[]}function k5(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function TC(s,l,f,g,x){for(var E=l._reactName,N=[];f!==null&&f!==g;){var F=f,X=F.alternate,ue=F.stateNode;if(F=F.tag,X!==null&&X===g)break;F!==5&&F!==26&&F!==27||ue===null||(X=ue,x?(ue=Qi(f,E),ue!=null&&N.unshift(Bf(f,ue,X))):x||(ue=Qi(f,E),ue!=null&&N.push(Bf(f,ue,X)))),f=f.return}N.length!==0&&s.push({event:l,listeners:N})}var N5=/\r\n?/g,M5=/\u0000|\uFFFD/g;function AC(s){return(typeof s=="string"?s:""+s).replace(N5,`
`).replace(M5,"")}function CC(s,l){return l=AC(l),AC(s)===l}function Wt(s,l,f,g,x,E){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Kr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Kr(s,""+g);break;case"className":ci(s,"class",g);break;case"tabIndex":ci(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":ci(s,f,g);break;case"style":af(s,g,E);break;case"data":if(l!=="object"){ci(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=Kc(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(l!=="input"&&Wt(s,l,"name",x.name,x,null),Wt(s,l,"formEncType",x.formEncType,x,null),Wt(s,l,"formMethod",x.formMethod,x,null),Wt(s,l,"formTarget",x.formTarget,x,null)):(Wt(s,l,"encType",x.encType,x,null),Wt(s,l,"method",x.method,x,null),Wt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=Kc(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=Wi);break;case"onScroll":g!=null&&wt("scroll",s);break;case"onScrollEnd":g!=null&&wt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=Kc(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":wt("beforetoggle",s),wt("toggle",s),Hc(s,"popover",g);break;case"xlinkActuate":Gn(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Gn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Gn(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Gn(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Gn(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Gn(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Gn(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Gn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Gn(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Hc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=lg.get(f)||f,Hc(s,f,g))}}function Kb(s,l,f,g,x,E){switch(f){case"style":af(s,g,E);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Kr(s,g):(typeof g=="number"||typeof g=="bigint")&&Kr(s,""+g);break;case"onScroll":g!=null&&wt("scroll",s);break;case"onScrollEnd":g!=null&&wt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Wi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),E=s[fr]||null,E=E!=null?E[f]:null,typeof E=="function"&&s.removeEventListener(l,E,x),typeof g=="function")){typeof E!="function"&&E!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):Hc(s,f,g)}}}function xr(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wt("error",s),wt("load",s);var g=!1,x=!1,E;for(E in f)if(f.hasOwnProperty(E)){var N=f[E];if(N!=null)switch(E){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Wt(s,l,E,N,f,null)}}x&&Wt(s,l,"srcSet",f.srcSet,f,null),g&&Wt(s,l,"src",f.src,f,null);return;case"input":wt("invalid",s);var F=E=N=x=null,X=null,ue=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":N=ve;break;case"checked":X=ve;break;case"defaultChecked":ue=ve;break;case"value":E=ve;break;case"defaultValue":F=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:Wt(s,l,g,ve,f,null)}}ag(s,E,F,X,ue,N,x,!1);return;case"select":wt("invalid",s),g=N=E=null;for(x in f)if(f.hasOwnProperty(x)&&(F=f[x],F!=null))switch(x){case"value":E=F;break;case"defaultValue":N=F;break;case"multiple":g=F;default:Wt(s,l,x,F,f,null)}l=E,f=N,s.multiple=!!g,l!=null?to(s,!!g,l,!1):f!=null&&to(s,!!g,f,!0);return;case"textarea":wt("invalid",s),E=x=g=null;for(N in f)if(f.hasOwnProperty(N)&&(F=f[N],F!=null))switch(N){case"value":g=F;break;case"defaultValue":x=F;break;case"children":E=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(91));break;default:Wt(s,l,N,F,f,null)}no(s,g,x,E);return;case"option":for(X in f)if(f.hasOwnProperty(X)&&(g=f[X],g!=null))switch(X){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Wt(s,l,X,g,f,null)}return;case"dialog":wt("beforetoggle",s),wt("toggle",s),wt("cancel",s),wt("close",s);break;case"iframe":case"object":wt("load",s);break;case"video":case"audio":for(g=0;g<Lf.length;g++)wt(Lf[g],s);break;case"image":wt("error",s),wt("load",s);break;case"details":wt("toggle",s);break;case"embed":case"source":case"link":wt("error",s),wt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in f)if(f.hasOwnProperty(ue)&&(g=f[ue],g!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Wt(s,l,ue,g,f,null)}return;default:if(Yc(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Kb(s,l,ve,g,f,void 0));return}}for(F in f)f.hasOwnProperty(F)&&(g=f[F],g!=null&&Wt(s,l,F,g,f,null))}function P5(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,N=null,F=null,X=null,ue=null,ve=null;for(ge in f){var be=f[ge];if(f.hasOwnProperty(ge)&&be!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":X=be;default:g.hasOwnProperty(ge)||Wt(s,l,ge,null,g,be)}}for(var fe in g){var ge=g[fe];if(be=f[fe],g.hasOwnProperty(fe)&&(ge!=null||be!=null))switch(fe){case"type":E=ge;break;case"name":x=ge;break;case"checked":ue=ge;break;case"defaultChecked":ve=ge;break;case"value":N=ge;break;case"defaultValue":F=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,l));break;default:ge!==be&&Wt(s,l,fe,ge,g,be)}}$c(s,N,F,X,ue,ve,E,x);return;case"select":ge=N=F=fe=null;for(E in f)if(X=f[E],f.hasOwnProperty(E)&&X!=null)switch(E){case"value":break;case"multiple":ge=X;default:g.hasOwnProperty(E)||Wt(s,l,E,null,g,X)}for(x in g)if(E=g[x],X=f[x],g.hasOwnProperty(x)&&(E!=null||X!=null))switch(x){case"value":fe=E;break;case"defaultValue":F=E;break;case"multiple":N=E;default:E!==X&&Wt(s,l,x,E,g,X)}l=F,f=N,g=ge,fe!=null?to(s,!!f,fe,!1):!!g!=!!f&&(l!=null?to(s,!!f,l,!0):to(s,!!f,f?[]:"",!1));return;case"textarea":ge=fe=null;for(F in f)if(x=f[F],f.hasOwnProperty(F)&&x!=null&&!g.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:Wt(s,l,F,null,g,x)}for(N in g)if(x=g[N],E=f[N],g.hasOwnProperty(N)&&(x!=null||E!=null))switch(N){case"value":fe=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==E&&Wt(s,l,N,x,g,E)}sg(s,fe,ge);return;case"option":for(var je in f)if(fe=f[je],f.hasOwnProperty(je)&&fe!=null&&!g.hasOwnProperty(je))switch(je){case"selected":s.selected=!1;break;default:Wt(s,l,je,null,g,fe)}for(X in g)if(fe=g[X],ge=f[X],g.hasOwnProperty(X)&&fe!==ge&&(fe!=null||ge!=null))switch(X){case"selected":s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Wt(s,l,X,fe,g,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in f)fe=f[Xe],f.hasOwnProperty(Xe)&&fe!=null&&!g.hasOwnProperty(Xe)&&Wt(s,l,Xe,null,g,fe);for(ue in g)if(fe=g[ue],ge=f[ue],g.hasOwnProperty(ue)&&fe!==ge&&(fe!=null||ge!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,l));break;default:Wt(s,l,ue,fe,g,ge)}return;default:if(Yc(l)){for(var Qt in f)fe=f[Qt],f.hasOwnProperty(Qt)&&fe!==void 0&&!g.hasOwnProperty(Qt)&&Kb(s,l,Qt,void 0,g,fe);for(ve in g)fe=g[ve],ge=f[ve],!g.hasOwnProperty(ve)||fe===ge||fe===void 0&&ge===void 0||Kb(s,l,ve,fe,g,ge);return}}for(var ie in f)fe=f[ie],f.hasOwnProperty(ie)&&fe!=null&&!g.hasOwnProperty(ie)&&Wt(s,l,ie,null,g,fe);for(be in g)fe=g[be],ge=f[be],!g.hasOwnProperty(be)||fe===ge||fe==null&&ge==null||Wt(s,l,be,fe,g,ge)}function IC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function O5(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],E=x.transferSize,N=x.initiatorType,F=x.duration;if(E&&F&&IC(N)){for(N=0,F=x.responseEnd,g+=1;g<f.length;g++){var X=f[g],ue=X.startTime;if(ue>F)break;var ve=X.transferSize,be=X.initiatorType;ve&&IC(be)&&(X=X.responseEnd,N+=ve*(X<F?1:(F-ue)/(X-ue)))}if(--g,l+=8*(E+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Xb=null,Wb=null;function cm(s){return s.nodeType===9?s:s.ownerDocument}function RC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function DC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Qb(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Zb=null;function j5(){var s=window.event;return s&&s.type==="popstate"?s===Zb?!1:(Zb=s,!0):(Zb=null,!1)}var kC=typeof setTimeout=="function"?setTimeout:void 0,V5=typeof clearTimeout=="function"?clearTimeout:void 0,NC=typeof Promise=="function"?Promise:void 0,z5=typeof queueMicrotask=="function"?queueMicrotask:typeof NC<"u"?function(s){return NC.resolve(null).then(s).catch(L5)}:kC;function L5(s){setTimeout(function(){throw s})}function Ao(s){return s==="head"}function MC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Iu(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Uf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Uf(f);for(var E=f.firstChild;E;){var N=E.nextSibling,F=E.nodeName;E[wa]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=N}}else f==="body"&&Uf(s.ownerDocument.body);f=x}while(f);Iu(l)}function PC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function Jb(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Jb(f),qc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function B5(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[wa])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Ni(s.nextSibling),s===null)break}return null}function U5(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=Ni(s.nextSibling),s===null))return null;return s}function OC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ni(s.nextSibling),s===null))return null;return s}function ex(s){return s.data==="$?"||s.data==="$~"}function tx(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function F5(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Ni(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var nx=null;function jC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return Ni(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function VC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function zC(s,l,f){switch(l=cm(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Uf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);qc(s)}var Mi=new Map,LC=new Set;function um(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var As=W.d;W.d={f:G5,r:q5,D:H5,C:$5,L:Y5,m:K5,X:W5,S:X5,M:Q5};function G5(){var s=As.f(),l=tm();return s||l}function q5(s){var l=wi(s);l!==null&&l.tag===5&&l.type==="form"?nA(l):As.r(s)}var Tu=typeof document>"u"?null:document;function BC(s,l,f){var g=Tu;if(g&&typeof l=="string"&&l){var x=Yr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),LC.has(x)||(LC.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),xr(l,"link",s),Fn(l),g.head.appendChild(l)))}}function H5(s){As.D(s),BC("dns-prefetch",s,null)}function $5(s,l){As.C(s,l),BC("preconnect",s,l)}function Y5(s,l,f){As.L(s,l,f);var g=Tu;if(g&&s&&l){var x='link[rel="preload"][as="'+Yr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Yr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Yr(f.imageSizes)+'"]')):x+='[href="'+Yr(s)+'"]';var E=x;switch(l){case"style":E=Au(s);break;case"script":E=Cu(s)}Mi.has(E)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),Mi.set(E,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Ff(E))||l==="script"&&g.querySelector(Gf(E))||(l=g.createElement("link"),xr(l,"link",s),Fn(l),g.head.appendChild(l)))}}function K5(s,l){As.m(s,l);var f=Tu;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Yr(g)+'"][href="'+Yr(s)+'"]',E=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Cu(s)}if(!Mi.has(E)&&(s=p({rel:"modulepreload",href:s},l),Mi.set(E,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Gf(E)))return}g=f.createElement("link"),xr(g,"link",s),Fn(g),f.head.appendChild(g)}}}function X5(s,l,f){As.S(s,l,f);var g=Tu;if(g&&s){var x=Sa(g).hoistableStyles,E=Au(s);l=l||"default";var N=x.get(E);if(!N){var F={loading:0,preload:null};if(N=g.querySelector(Ff(E)))F.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=Mi.get(E))&&rx(s,f);var X=N=g.createElement("link");Fn(X),xr(X,"link",s),X._p=new Promise(function(ue,ve){X.onload=ue,X.onerror=ve}),X.addEventListener("load",function(){F.loading|=1}),X.addEventListener("error",function(){F.loading|=2}),F.loading|=4,dm(N,l,g)}N={type:"stylesheet",instance:N,count:1,state:F},x.set(E,N)}}}function W5(s,l){As.X(s,l);var f=Tu;if(f&&s){var g=Sa(f).hoistableScripts,x=Cu(s),E=g.get(x);E||(E=f.querySelector(Gf(x)),E||(s=p({src:s,async:!0},l),(l=Mi.get(x))&&ix(s,l),E=f.createElement("script"),Fn(E),xr(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function Q5(s,l){As.M(s,l);var f=Tu;if(f&&s){var g=Sa(f).hoistableScripts,x=Cu(s),E=g.get(x);E||(E=f.querySelector(Gf(x)),E||(s=p({src:s,async:!0,type:"module"},l),(l=Mi.get(x))&&ix(s,l),E=f.createElement("script"),Fn(E),xr(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function UC(s,l,f,g){var x=(x=he.current)?um(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Au(f.href),f=Sa(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Au(f.href);var E=Sa(x).hoistableStyles,N=E.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,N),(E=x.querySelector(Ff(s)))&&!E._p&&(N.instance=E,N.state.loading=5),Mi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Mi.set(s,f),E||Z5(x,s,f,N.state))),l&&g===null)throw Error(r(528,""));return N}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Cu(f),f=Sa(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Au(s){return'href="'+Yr(s)+'"'}function Ff(s){return'link[rel="stylesheet"]['+s+"]"}function FC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function Z5(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),xr(l,"link",f),Fn(l),s.head.appendChild(l))}function Cu(s){return'[src="'+Yr(s)+'"]'}function Gf(s){return"script[async]"+s}function GC(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Yr(f.href)+'"]');if(g)return l.instance=g,Fn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),Fn(g),xr(g,"style",x),dm(g,f.precedence,s),l.instance=g;case"stylesheet":x=Au(f.href);var E=s.querySelector(Ff(x));if(E)return l.state.loading|=4,l.instance=E,Fn(E),E;g=FC(f),(x=Mi.get(x))&&rx(g,x),E=(s.ownerDocument||s).createElement("link"),Fn(E);var N=E;return N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),xr(E,"link",g),l.state.loading|=4,dm(E,f.precedence,s),l.instance=E;case"script":return E=Cu(f.src),(x=s.querySelector(Gf(E)))?(l.instance=x,Fn(x),x):(g=f,(x=Mi.get(E))&&(g=p({},f),ix(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),Fn(x),xr(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,dm(g,f.precedence,s));return l.instance}function dm(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,E=x,N=0;N<g.length;N++){var F=g[N];if(F.dataset.precedence===l)E=F;else if(E!==x)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function rx(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function ix(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var fm=null;function qC(s,l,f){if(fm===null){var g=new Map,x=fm=new Map;x.set(f,g)}else x=fm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var E=f[x];if(!(E[wa]||E[Bt]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var N=E.getAttribute(l)||"";N=s+N;var F=g.get(N);F?F.push(E):g.set(N,[E])}}return g}function HC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function J5(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function $C(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function e6(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Au(g.href),E=l.querySelector(Ff(x));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=hm.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=E,Fn(E);return}E=l.ownerDocument||l,g=FC(g),(x=Mi.get(x))&&rx(g,x),E=E.createElement("link"),Fn(E);var N=E;N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),xr(E,"link",g),f.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=hm.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var ax=0;function t6(s,l){return s.stylesheets&&s.count===0&&gm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&gm(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&ax===0&&(ax=62500*O5());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&gm(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>ax?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function hm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var pm=null;function gm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,pm=new Map,l.forEach(n6,s),pm=null,hm.call(s))}function n6(s,l){if(!(l.state.loading&4)){var f=pm.get(s);if(f)var g=f.get(null);else{f=new Map,pm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var N=x[E];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(f.set(N.dataset.precedence,N),g=N)}g&&f.set(null,g)}x=l.instance,N=x.getAttribute("data-precedence"),E=f.get(N)||g,E===g&&f.set(null,x),f.set(N,x),this.count++,g=hm.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),E?E.parentNode.insertBefore(x,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var qf={$$typeof:D,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function r6(s,l,f,g,x,E,N,F,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Et(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Et(0),this.hiddenUpdates=Et(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function YC(s,l,f,g,x,E,N,F,X,ue,ve,be){return s=new r6(s,l,f,N,X,ue,ve,be,F),l=1,E===!0&&(l|=24),E=di(3,null,null,l),s.current=E,E.stateNode=s,l=zy(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:g,isDehydrated:f,cache:l},Fy(E),s}function KC(s){return s?(s=iu,s):iu}function XC(s,l,f,g,x,E){x=KC(x),g.context===null?g.context=x:g.pendingContext=x,g=go(l),g.payload={element:f},E=E===void 0?null:E,E!==null&&(g.callback=E),f=mo(s,g,l),f!==null&&(Jr(f,s,l),wf(f,s,l))}function WC(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function sx(s,l){WC(s,l),(s=s.alternate)&&WC(s,l)}function QC(s){if(s.tag===13||s.tag===31){var l=Nl(s,67108864);l!==null&&Jr(l,s,67108864),sx(s,67108864)}}function ZC(s){if(s.tag===13||s.tag===31){var l=mi();l=tn(l);var f=Nl(s,l);f!==null&&Jr(f,s,l),sx(s,l)}}var mm=!0;function i6(s,l,f,g){var x=H.T;H.T=null;var E=W.p;try{W.p=2,ox(s,l,f,g)}finally{W.p=E,H.T=x}}function a6(s,l,f,g){var x=H.T;H.T=null;var E=W.p;try{W.p=8,ox(s,l,f,g)}finally{W.p=E,H.T=x}}function ox(s,l,f,g){if(mm){var x=lx(g);if(x===null)Yb(s,l,g,vm,f),e2(s,g);else if(o6(x,s,l,f,g))g.stopPropagation();else if(e2(s,g),l&4&&-1<s6.indexOf(s)){for(;x!==null;){var E=wi(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var N=Je(E.pendingLanes);if(N!==0){var F=E;for(F.pendingLanes|=2,F.entangledLanes|=2;N;){var X=1<<31-sn(N);F.entanglements[1]|=X,N&=~X}Va(E),(zt&6)===0&&(Jg=rt()+500,zf(0))}}break;case 31:case 13:F=Nl(E,2),F!==null&&Jr(F,E,2),tm(),sx(E,2)}if(E=lx(g),E===null&&Yb(s,l,g,vm,f),E===x)break;x=E}x!==null&&g.stopPropagation()}else Yb(s,l,g,null,f)}}function lx(s){return s=Ei(s),cx(s)}var vm=null;function cx(s){if(vm=null,s=Ea(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return vm=s,null}function JC(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bt()){case Ot:return 2;case an:return 8;case Bn:case Or:return 32;case ls:return 268435456;default:return 32}default:return 32}}var ux=!1,Co=null,Io=null,Ro=null,Hf=new Map,$f=new Map,Do=[],s6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function e2(s,l){switch(s){case"focusin":case"focusout":Co=null;break;case"dragenter":case"dragleave":Io=null;break;case"mouseover":case"mouseout":Ro=null;break;case"pointerover":case"pointerout":Hf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":$f.delete(l.pointerId)}}function Yf(s,l,f,g,x,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:E,targetContainers:[x]},l!==null&&(l=wi(l),l!==null&&QC(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function o6(s,l,f,g,x){switch(l){case"focusin":return Co=Yf(Co,s,l,f,g,x),!0;case"dragenter":return Io=Yf(Io,s,l,f,g,x),!0;case"mouseover":return Ro=Yf(Ro,s,l,f,g,x),!0;case"pointerover":var E=x.pointerId;return Hf.set(E,Yf(Hf.get(E)||null,s,l,f,g,x)),!0;case"gotpointercapture":return E=x.pointerId,$f.set(E,Yf($f.get(E)||null,s,l,f,g,x)),!0}return!1}function t2(s){var l=Ea(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Mn(s.priority,function(){ZC(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Mn(s.priority,function(){ZC(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ym(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=lx(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);sf=g,f.target.dispatchEvent(g),sf=null}else return l=wi(f),l!==null&&QC(l),s.blockedOn=f,!1;l.shift()}return!0}function n2(s,l,f){ym(s)&&f.delete(l)}function l6(){ux=!1,Co!==null&&ym(Co)&&(Co=null),Io!==null&&ym(Io)&&(Io=null),Ro!==null&&ym(Ro)&&(Ro=null),Hf.forEach(n2),$f.forEach(n2)}function bm(s,l){s.blockedOn===l&&(s.blockedOn=null,ux||(ux=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,l6)))}var xm=null;function r2(s){xm!==s&&(xm=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){xm===s&&(xm=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(cx(g||f)===null)continue;break}var E=wi(f);E!==null&&(s.splice(l,3),l-=3,lb(E,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Iu(s){function l(X){return bm(X,s)}Co!==null&&bm(Co,s),Io!==null&&bm(Io,s),Ro!==null&&bm(Ro,s),Hf.forEach(l),$f.forEach(l);for(var f=0;f<Do.length;f++){var g=Do[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<Do.length&&(f=Do[0],f.blockedOn===null);)t2(f),f.blockedOn===null&&Do.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],E=f[g+1],N=x[fr]||null;if(typeof E=="function")N||r2(f);else if(N){var F=null;if(E&&E.hasAttribute("formAction")){if(x=E,N=E[fr]||null)F=N.formAction;else if(cx(x)!==null)continue}else F=N.action;typeof F=="function"?f[g+1]=F:(f.splice(g,3),g-=3),r2(f)}}}function i2(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function dx(s){this._internalRoot=s}_m.prototype.render=dx.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=mi();XC(f,g,s,l,null,null)},_m.prototype.unmount=dx.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;XC(s.current,2,null,s,null,null),tm(),l[_a]=null}};function _m(s){this._internalRoot=s}_m.prototype.unstable_scheduleHydration=function(s){if(s){var l=xa();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Do.length&&l!==0&&l<Do[f].priority;f++);Do.splice(f,0,s),f===0&&t2(s)}};var a2=e.version;if(a2!=="19.2.0")throw Error(r(527,a2,"19.2.0"));W.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var c6={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wm.isDisabled&&wm.supportsFiber)try{jr=wm.inject(c6),An=wm}catch{}}return Xf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=fA,E=hA,N=pA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=YC(s,1,!1,null,null,f,g,null,x,E,N,i2),s[_a]=l.current,$b(s),new dx(l)},Xf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",E=fA,N=hA,F=pA,X=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(N=f.onCaughtError),f.onRecoverableError!==void 0&&(F=f.onRecoverableError),f.formState!==void 0&&(X=f.formState)),l=YC(s,1,!0,l,f??null,g,x,X,E,N,F,i2),l.context=KC(null),f=l.current,g=mi(),g=tn(g),x=go(g),x.callback=null,mo(f,x,g),f=g,l.current.lanes=f,It(l,f),Va(l),s[_a]=l.current,$b(s),new _m(l)},Xf.version="19.2.0",Xf}var g2;function x6(){if(g2)return px.exports;g2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),px.exports=b6(),px.exports}var _6=x6();const w6="modulepreload",E6=function(n){return"/personal-budget-pwa/"+n},m2={},Zt=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(t.map(d=>{if(d=E6(d),d in m2)return;m2[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":w6,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,_)=>{m.addEventListener("load",b),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function S6(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await Zt(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}var v2="popstate";function T6(n={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Vc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),b1("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:zh(a))}function r(i,a){Hi(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return C6(e,t,r,n)}function Tn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Hi(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function A6(){return Math.random().toString(36).substring(2,10)}function y2(n,e){return{usr:n.state,key:n.key,idx:e}}function b1(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Vc(e):e,state:t,key:e&&e.key||r||A6()}}function zh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Vc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function C6(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:w.location,delta:T})}function m(S,T){c="PUSH";let C=b1(w.location,S,T);t&&t(C,S),d=h()+1;let D=y2(C,d),O=w.createHref(C);try{o.pushState(D,"",O)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;i.location.assign(O)}a&&u&&u({action:c,location:w.location,delta:1})}function b(S,T){c="REPLACE";let C=b1(w.location,S,T);t&&t(C,S),d=h();let D=y2(C,d),O=w.createHref(C);o.replaceState(D,"",O),a&&u&&u({action:c,location:w.location,delta:0})}function _(S){return I6(S)}let w={get action(){return c},get location(){return n(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(v2,p),u=S,()=>{i.removeEventListener(v2,p),u=null}},createHref(S){return e(i,S)},createURL:_,encodeLocation(S){let T=_(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return w}function I6(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Tn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:zh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Xk(n,e,t="/"){return R6(n,e,t,!1)}function R6(n,e,t,r){let i=typeof e=="string"?Vc(e):e,a=Vs(i.pathname||"/",t);if(a==null)return null;let o=Wk(n);D6(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=U6(a);c=L6(o[u],d,r)}return c}function Wk(n,e=[],t=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;Tn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Ns([r,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(Tn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Wk(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:V6(p,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of Qk(o.path))a(o,c,!0,u)}),e}function Qk(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=Qk(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function D6(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:z6(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var k6=/^:[\w-]+$/,N6=3,M6=2,P6=1,O6=10,j6=-2,b2=n=>n==="*";function V6(n,e){let t=n.split("/"),r=t.length;return t.some(b2)&&(r+=j6),e&&(r+=M6),t.filter(i=>!b2(i)).reduce((i,a)=>i+(k6.test(a)?N6:a===""?P6:O6),r)}function z6(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function L6(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Ns([a,p.pathname]),pathnameBase:H6(Ns([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Ns([a,p.pathnameBase]))}return o}function S0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=B6(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function B6(n,e=!1,t=!0){Hi(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function U6(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Hi(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Vs(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var F6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function G6(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Vc(n):n,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=x2(t.substring(1),"/"):a=x2(t,e)):a=e,{pathname:a,search:$6(r),hash:Y6(i)}}function x2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function yx(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function q6(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Zk(n){let e=q6(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Jk(n,e,t,r=!1){let i;typeof n=="string"?i=Vc(n):(i={...n},Tn(!i.pathname||!i.pathname.includes("?"),yx("?","pathname","search",i)),Tn(!i.pathname||!i.pathname.includes("#"),yx("#","pathname","hash",i)),Tn(!i.search||!i.search.includes("#"),yx("#","search","hash",i)));let a=n===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=G6(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Ns=n=>n.join("/").replace(/\/\/+/g,"/"),H6=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),$6=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Y6=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,K6=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function X6(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function W6(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var eN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function tN(n,e){let t=n;if(typeof t!="string"||!F6.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(eN)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=Vs(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:i=!0}catch{Hi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var nN=["POST","PUT","PATCH","DELETE"];new Set(nN);var Q6=["GET",...nN];new Set(Q6);var Pd=U.createContext(null);Pd.displayName="DataRouter";var bv=U.createContext(null);bv.displayName="DataRouterState";var Z6=U.createContext(!1),rN=U.createContext({isTransitioning:!1});rN.displayName="ViewTransition";var J6=U.createContext(new Map);J6.displayName="Fetchers";var ez=U.createContext(null);ez.displayName="Await";var Ki=U.createContext(null);Ki.displayName="Navigation";var vp=U.createContext(null);vp.displayName="Location";var as=U.createContext({outlet:null,matches:[],isDataRoute:!1});as.displayName="Route";var aw=U.createContext(null);aw.displayName="RouteError";var iN="REACT_ROUTER_ERROR",tz="REDIRECT",nz="ROUTE_ERROR_RESPONSE";function rz(n){if(n.startsWith(`${iN}:${tz}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function iz(n){if(n.startsWith(`${iN}:${nz}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new K6(e.status,e.statusText,e.data)}catch{}}function az(n,{relative:e}={}){Tn(yp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(Ki),{hash:i,pathname:a,search:o}=bp(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Ns([t,a])),r.createHref({pathname:c,search:o,hash:i})}function yp(){return U.useContext(vp)!=null}function va(){return Tn(yp(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(vp).location}var aN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sN(n){U.useContext(Ki).static||U.useLayoutEffect(n)}function Ys(){let{isDataRoute:n}=U.useContext(as);return n?bz():sz()}function sz(){Tn(yp(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Pd),{basename:e,navigator:t}=U.useContext(Ki),{matches:r}=U.useContext(as),{pathname:i}=va(),a=JSON.stringify(Zk(r)),o=U.useRef(!1);return sN(()=>{o.current=!0}),U.useCallback((u,d={})=>{if(Hi(o.current,aN),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=Jk(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ns([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}U.createContext(null);function oz(){let{matches:n}=U.useContext(as),e=n[n.length-1];return e?e.params:{}}function bp(n,{relative:e}={}){let{matches:t}=U.useContext(as),{pathname:r}=va(),i=JSON.stringify(Zk(t));return U.useMemo(()=>Jk(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function lz(n,e){return oN(n,e)}function oN(n,e,t,r,i){Tn(yp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(Ki),{matches:o}=U.useContext(as),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";cN(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=va(),b;if(e){let C=typeof e=="string"?Vc(e):e;Tn(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=Xk(n,{pathname:w});Hi(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Hi(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=hz(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:Ns([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Ns([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,t,r,i);return e&&T?U.createElement(vp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function cz(){let n=yz(),e=X6(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,o)}var uz=U.createElement(cz,null),lN=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=iz(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(as.Provider,{value:this.props.routeContext},U.createElement(aw.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(dz,{error:n},e):e}};lN.contextType=Z6;var bx=new WeakMap;function dz({children:n,error:e}){let{basename:t}=U.useContext(Ki);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=rz(e.digest);if(r){let i=bx.get(e);if(i)throw i;let a=tN(r.location,t);if(eN&&!bx.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw bx.set(e,o),o}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function fz({routeContext:n,match:e,children:t}){let r=U.useContext(Pd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(as.Provider,{value:n},t)}function hz(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);Tn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:W6(t.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,S=null;t&&(b=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||uz,c&&(u<0&&m===0?(cN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):u===m&&(_=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let D;return b?D=w:_?D=S:p.route.Component?D=U.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=h,U.createElement(fz,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:D})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?U.createElement(lN,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function sw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pz(n){let e=U.useContext(Pd);return Tn(e,sw(n)),e}function gz(n){let e=U.useContext(bv);return Tn(e,sw(n)),e}function mz(n){let e=U.useContext(as);return Tn(e,sw(n)),e}function ow(n){let e=mz(n),t=e.matches[e.matches.length-1];return Tn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function vz(){return ow("useRouteId")}function yz(){let n=U.useContext(aw),e=gz("useRouteError"),t=ow("useRouteError");return n!==void 0?n:e.errors?.[t]}function bz(){let{router:n}=pz("useNavigate"),e=ow("useNavigate"),t=U.useRef(!1);return sN(()=>{t.current=!0}),U.useCallback(async(i,a={})=>{Hi(t.current,aN),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var _2={};function cN(n,e,t){!e&&!_2[n]&&(_2[n]=!0,Hi(!1,t))}U.memo(xz);function xz({routes:n,future:e,state:t,onError:r}){return oN(n,void 0,t,r,e)}function zo(n){Tn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function _z({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){Tn(!yp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof t=="string"&&(t=Vc(t));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=t,_=U.useMemo(()=>{let w=Vs(d,c);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Hi(_!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement(Ki.Provider,{value:u},U.createElement(vp.Provider,{children:e,value:_}))}function wz({children:n,location:e}){return lz(x1(n),e)}function x1(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let a=[...e,i];if(r.type===U.Fragment){t.push.apply(t,x1(r.props.children,a));return}Tn(r.type===zo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Tn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=x1(r.props.children,a)),t.push(o)}),t}var Zm="get",Jm="application/x-www-form-urlencoded";function xv(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function Ez(n){return xv(n)&&n.tagName.toLowerCase()==="button"}function Sz(n){return xv(n)&&n.tagName.toLowerCase()==="form"}function Tz(n){return xv(n)&&n.tagName.toLowerCase()==="input"}function Az(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Cz(n,e){return n.button===0&&(!e||e==="_self")&&!Az(n)}function _1(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function Iz(n,e){let t=_1(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var Sm=null;function Rz(){if(Sm===null)try{new FormData(document.createElement("form"),0),Sm=!1}catch{Sm=!0}return Sm}var Dz=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xx(n){return n!=null&&!Dz.has(n)?(Hi(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jm}"`),null):n}function kz(n,e){let t,r,i,a,o;if(Sz(n)){let c=n.getAttribute("action");r=c?Vs(c,e):null,t=n.getAttribute("method")||Zm,i=xx(n.getAttribute("enctype"))||Jm,a=new FormData(n)}else if(Ez(n)||Tz(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?Vs(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||Zm,i=xx(n.getAttribute("formenctype"))||xx(c.getAttribute("enctype"))||Jm,a=new FormData(c,n),!Rz()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(xv(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Zm,r=null,i=Jm,o=n}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function lw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Nz(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Vs(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function Mz(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Pz(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Oz(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await Mz(a,t);return o.links?o.links():[]}return[]}));return Lz(r.flat(1).filter(Pz).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function w2(n,e,t,r,i,a){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function jz(n,e,{includeHydrateFallback:t}={}){return Vz(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function Vz(n){return[...new Set(n)]}function zz(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function Lz(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(zz(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function uN(){let n=U.useContext(Pd);return lw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Bz(){let n=U.useContext(bv);return lw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var cw=U.createContext(void 0);cw.displayName="FrameworkContext";function dN(){let n=U.useContext(cw);return lw(n,"You must render this element inside a <HydratedRouter> element"),n}function Uz(n,e){let t=U.useContext(cw),[r,i]=U.useState(!1),[a,o]=U.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let w=T=>{T.forEach(C=>{o(C.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),U.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Wf(c,b),onBlur:Wf(u,_),onMouseEnter:Wf(d,b),onMouseLeave:Wf(h,_),onTouchStart:Wf(p,b)}]:[!1,m,{}]}function Wf(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Fz({page:n,...e}){let{router:t}=uN(),r=U.useMemo(()=>Xk(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(qz,{page:n,matches:r,...e}):null}function Gz(n){let{manifest:e,routeModules:t}=dN(),[r,i]=U.useState([]);return U.useEffect(()=>{let a=!1;return Oz(n,e,t).then(o=>{a||i(o)}),()=>{a=!0}},[n,e,t]),r}function qz({page:n,matches:e,...t}){let r=va(),{future:i,manifest:a,routeModules:o}=dN(),{basename:c}=uN(),{loaderData:u,matches:d}=Bz(),h=U.useMemo(()=>w2(n,e,d,a,r,"data"),[n,e,d,a,r]),p=U.useMemo(()=>w2(n,e,d,a,r,"assets"),[n,e,d,a,r]),m=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,S=!1;if(e.forEach(C=>{let D=a.routes[C.route.id];!D||!D.hasLoader||(!h.some(O=>O.route.id===C.route.id)&&C.route.id in u&&o[C.route.id]?.shouldRevalidate||D.hasClientLoader?S=!0:w.add(C.route.id))}),w.size===0)return[];let T=Nz(n,c,i.unstable_trailingSlashAwareDataRequests,"data");return S&&w.size>0&&T.searchParams.set("_routes",e.filter(C=>w.has(C.route.id)).map(C=>C.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,n,o]),b=U.useMemo(()=>jz(p,a),[p,a]),_=Gz(p);return U.createElement(U.Fragment,null,m.map(w=>U.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>U.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),_.map(({key:w,link:S})=>U.createElement("link",{key:w,nonce:t.nonce,...S,crossOrigin:S.crossOrigin??t.crossOrigin})))}function Hz(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var $z=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{$z&&(window.__reactRouterVersion="7.13.0")}catch{}function Yz({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=T6({window:r,v5Compat:!0}));let a=i.current,[o,c]=U.useState({action:a.action,location:a.location}),u=U.useCallback(d=>{t===!1?c(d):U.startTransition(()=>c(d))},[t]);return U.useLayoutEffect(()=>a.listen(u),[a,u]),U.createElement(_z,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var fN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hN=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_){let{basename:w,unstable_useTransitions:S}=U.useContext(Ki),T=typeof d=="string"&&fN.test(d),C=tN(d,w);d=C.to;let D=az(d,{relative:i}),[O,M,V]=Uz(r,b),A=Qz(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:S});function I(z){e&&e(z),z.defaultPrevented||A(z)}let k=U.createElement("a",{...b,...V,href:C.absoluteURL||D,onClick:C.isExternal||a?e:I,ref:Hz(_,M),target:u,"data-discover":!T&&t==="render"?"true":void 0});return O&&!T?U.createElement(U.Fragment,null,k,U.createElement(Fz,{page:D})):k});hN.displayName="Link";var Kz=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=bp(o,{relative:d.relative}),m=va(),b=U.useContext(bv),{navigator:_,basename:w}=U.useContext(Ki),S=b!=null&&rL(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,C=m.pathname,D=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(C=C.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&w&&(D=Vs(D,w)||D);const O=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let M=C===T||!i&&C.startsWith(T)&&C.charAt(O)==="/",V=D!=null&&(D===T||!i&&D.startsWith(T)&&D.charAt(T.length)==="/"),A={isActive:M,isPending:V,isTransitioning:S},I=M?e:void 0,k;typeof r=="function"?k=r(A):k=[r,M?"active":null,V?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let z=typeof a=="function"?a(A):a;return U.createElement(hN,{...d,"aria-current":I,className:k,ref:h,style:z,to:o,viewTransition:c},typeof u=="function"?u(A):u)});Kz.displayName="NavLink";var Xz=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:o=Zm,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_)=>{let{unstable_useTransitions:w}=U.useContext(Ki),S=tL(),T=nL(c,{relative:d}),C=o.toLowerCase()==="get"?"get":"post",D=typeof c=="string"&&fN.test(c),O=M=>{if(u&&u(M),M.defaultPrevented)return;M.preventDefault();let V=M.nativeEvent.submitter,A=V?.getAttribute("formmethod")||o,I=()=>S(V||M.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});w&&t!==!1?U.startTransition(()=>I()):I()};return U.createElement("form",{ref:_,method:C,action:T,onSubmit:r?u:O,...b,"data-discover":!D&&n==="render"?"true":void 0})});Xz.displayName="Form";function Wz(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pN(n){let e=U.useContext(Pd);return Tn(e,Wz(n)),e}function Qz(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=Ys(),h=va(),p=bp(n,{relative:a});return U.useCallback(m=>{if(Cz(m,e)){m.preventDefault();let b=t!==void 0?t:zh(h)===zh(p),_=()=>d(n,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?U.startTransition(()=>_()):_()}},[h,d,p,t,r,e,n,i,a,o,c,u])}function Zz(n){Hi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(_1(n)),t=U.useRef(!1),r=va(),i=U.useMemo(()=>Iz(r.search,t.current?null:e.current),[r.search]),a=Ys(),o=U.useCallback((c,u)=>{const d=_1(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var Jz=0,eL=()=>`__${String(++Jz)}__`;function tL(){let{router:n}=pN("useSubmit"),{basename:e}=U.useContext(Ki),t=vz(),r=n.fetch,i=n.navigate;return U.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=kz(a,e);if(o.navigate===!1){let m=o.fetcherKey||eL();await r(m,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,t])}function nL(n,{relative:e}={}){let{basename:t}=U.useContext(Ki),r=U.useContext(as);Tn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...bp(n||".",{relative:e})},o=va();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Ns([t,a.pathname])),zh(a)}function rL(n,{relative:e}={}){let t=U.useContext(rN);Tn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=pN("useViewTransitionState"),i=bp(n,{relative:e});if(!t.isTransitioning)return!1;let a=Vs(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Vs(t.nextLocation.pathname,r)||t.nextLocation.pathname;return S0(i.pathname,o)!=null||S0(i.pathname,a)!=null}const iL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),aL=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),E2=n=>{const e=aL(n);return e.charAt(0).toUpperCase()+e.slice(1)},gN=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),sL=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var oL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lL=U.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>U.createElement("svg",{ref:u,...oL,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:gN("lucide",i),...!a&&!sL(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>U.createElement(d,h)),...Array.isArray(a)?a:[a]]));const at=(n,e)=>{const t=U.forwardRef(({className:r,...i},a)=>U.createElement(lL,{ref:a,iconNode:e,className:gN(`lucide-${iL(E2(n))}`,`lucide-${n}`,r),...i}));return t.displayName=E2(n),t};const cL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],od=at("arrow-left",cL);const uL=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],dL=at("arrow-right-left",uL);const fL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],hL=at("arrow-right",fL);const pL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],gL=at("calendar",pL);const mL=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],vL=at("chart-column",mL);const yL=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],bL=at("chart-pie",yL);const xL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_L=at("check",xL);const wL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],EL=at("chevron-left",wL);const SL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Cs=at("chevron-right",SL);const TL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],AL=at("circle-arrow-down",TL);const CL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],IL=at("circle-arrow-up",CL);const RL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],w1=at("circle-check-big",RL);const DL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],za=at("circle-check",DL);const kL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],S2=at("circle",kL);const NL=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],T2=at("dollar-sign",NL);const ML=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],A2=at("download",ML);const PL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],mN=at("ellipsis",PL);const OL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],jL=at("eye-off",OL);const VL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zL=at("eye",VL);const LL=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],BL=at("file-text",LL);const UL=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],FL=at("folder",UL);const GL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],qL=at("funnel",GL);const HL=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],vN=at("grip-vertical",HL);const $L=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],YL=at("house",$L);const KL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],XL=at("list",KL);const WL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],QL=at("loader-circle",WL);const ZL=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],C2=at("loader",ZL);const JL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],e9=at("log-out",JL);const t9=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],E1=at("mail",t9);const n9=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],r9=at("pause",n9);const i9=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],xc=at("piggy-bank",i9);const a9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],mh=at("plus",a9);const s9=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Lh=at("refresh-cw",s9);const o9=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],l9=at("search",o9);const c9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],u9=at("settings",c9);const d9=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Bh=at("sparkles",d9);const f9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],h9=at("target",f9);const p9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],S1=at("trash-2",p9);const g9=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],yN=at("trash",g9);const m9=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],T0=at("trending-up",m9);const v9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ed=at("triangle-alert",v9);const y9=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],b9=at("undo-2",y9);const x9=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],_9=at("upload",x9);const w9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],E9=at("user-plus",w9);const S9=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],_v=at("wallet",S9);const T9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],wv=at("x",T9),I2=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},A9=(n=>n?I2(n):I2),C9=n=>n;function I9(n,e=C9){const t=Em.useSyncExternalStore(n.subscribe,Em.useCallback(()=>e(n.getState()),[n,e]),Em.useCallback(()=>e(n.getInitialState()),[n,e]));return Em.useDebugValue(t),t}const R2=n=>{const e=A9(n),t=r=>I9(e,r);return Object.assign(t,e),t},uw=(n=>n?R2(n):R2),D2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",VITE_FIREBASE_APP_ID:"1:137454342284:web:ab8b52955e6f0ffd42aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-BCLXBQHT9L",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},Uh=new Map,Tm=n=>{const e=Uh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},R9=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=Uh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return Uh.set(t.name,i),{type:"tracked",store:n,...i}},D9=(n,e)=>{if(e===void 0)return;const t=Uh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&Uh.delete(n))},k9=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},N9=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(D2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=R9(c,d,u);let m=!0;i.setState=((w,S,T)=>{const C=t(w,S);if(!m)return C;const D=T===void 0?{type:o||k9(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(D,r()),C):(h?.send({...D,type:`${c}/${D.type}`},{...Tm(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),D9(u.name,c)}};const b=(...w)=>{const S=m;m=!1,t(...w),m=S},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,S])=>[w,w===p.store?_:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const S=i.dispatch;i.dispatch=(...T)=>{(D2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),S(...T)}}return h.subscribe(w=>{var S;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return _x(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(Tm(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Tm(u.name));case"ROLLBACK":return _x(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Tm(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return _x(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,C=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},M9=N9,_x=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function P9(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const T1=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return T1(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return T1(r)(t)}}}},O9=(n,e)=>(t,r,i)=>{let a={storage:P9(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,S)=>(p(w,S),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,S;if(!d)return;o=!1,c.forEach(C=>{var D;return C((D=r())!=null?D:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(w=r())!=null?w:m))||void 0;return T1(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const D=a.migrate(C.state,C.version);return D instanceof Promise?D.then(O=>[!0,O]):[!0,D]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var D;const[O,M]=C;if(b=a.merge(M,(D=r())!=null?D:m),t(b,!0),O)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},bN=O9,j9=()=>{};var k2={};const xN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},V9=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},_N={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(xN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):V9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new z9;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class z9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const L9=function(n){const e=xN(n);return _N.encodeByteArray(e,!0)},A0=function(n){return L9(n).replace(/\./g,"")},wN=function(n){try{return _N.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function EN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const B9=()=>EN().__FIREBASE_DEFAULTS__,U9=()=>{if(typeof process>"u"||typeof k2>"u")return;const n=k2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},F9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wN(n[1]);return e&&JSON.parse(e)},Ev=()=>{try{return j9()||B9()||U9()||F9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},SN=n=>Ev()?.emulatorHosts?.[n],G9=n=>{const e=SN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},TN=()=>Ev()?.config,AN=n=>Ev()?.[`_${n}`];class q9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Od(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function CN(n){return(await fetch(n,{credentials:"include"})).ok}function H9(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[A0(JSON.stringify(t)),A0(JSON.stringify(o)),""].join(".")}const vh={};function $9(){const n={prod:[],emulator:[]};for(const e of Object.keys(vh))vh[e]?n.emulator.push(e):n.prod.push(e);return n}function Y9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let N2=!1;function IN(n,e){if(typeof window>"u"||typeof document>"u"||!Od(window.location.host)||vh[n]===e||vh[n]||N2)return;vh[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=$9().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{N2=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=Y9(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),S=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const D=m.element;c(D),h(S,w);const O=d();u(C,T),D.append(C,_,S,O),document.body.appendChild(D)}a?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function K9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function RN(){const n=Ev()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function X9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function W9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Q9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Z9(){const n=cr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function DN(){return!RN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kN(){return!RN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function NN(){try{return typeof indexedDB=="object"}catch{return!1}}function J9(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const eB="FirebaseError";class Ks extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=eB,Object.setPrototypeOf(this,Ks.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xp.prototype.create)}}class xp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?tB(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ks(i,c,r)}}function tB(n,e){return n.replace(nB,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const nB=/\{\$([^}]+)}/g;function rB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function rl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],o=e[i];if(M2(a)&&M2(o)){if(!rl(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function M2(n){return n!==null&&typeof n=="object"}function _p(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ih(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ah(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function iB(n,e){const t=new aB(n,e);return t.subscribe.bind(t)}class aB{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");sB(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=wx),i.error===void 0&&(i.error=wx),i.complete===void 0&&(i.complete=wx);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wx(){}function dn(n){return n&&n._delegate?n._delegate:n}let _c=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Kl="[DEFAULT]";let oB=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new q9;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cB(e))try{this.getOrInitializeService({instanceIdentifier:Kl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Kl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kl){return this.instances.has(e)}getOptions(e=Kl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:lB(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kl){return this.component?this.component.multipleInstances?e:Kl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function lB(n){return n===Kl?void 0:n}function cB(n){return n.instantiationMode==="EAGER"}class uB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var At;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(At||(At={}));const dB={debug:At.DEBUG,verbose:At.VERBOSE,info:At.INFO,warn:At.WARN,error:At.ERROR,silent:At.SILENT},fB=At.INFO,hB={[At.DEBUG]:"log",[At.VERBOSE]:"log",[At.INFO]:"info",[At.WARN]:"warn",[At.ERROR]:"error"},pB=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=hB[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dw{constructor(e){this.name=e,this._logLevel=fB,this._logHandler=pB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in At))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,At.DEBUG,...e),this._logHandler(this,At.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,At.VERBOSE,...e),this._logHandler(this,At.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,At.INFO,...e),this._logHandler(this,At.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,At.WARN,...e),this._logHandler(this,At.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,At.ERROR,...e),this._logHandler(this,At.ERROR,...e)}}const gB=(n,e)=>e.some(t=>n instanceof t);let P2,O2;function mB(){return P2||(P2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vB(){return O2||(O2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const MN=new WeakMap,A1=new WeakMap,PN=new WeakMap,Ex=new WeakMap,fw=new WeakMap;function yB(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",o)},a=()=>{t(Wo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&MN.set(t,n)}).catch(()=>{}),fw.set(e,n),e}function bB(n){if(A1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",o),n.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",o),n.addEventListener("abort",o)});A1.set(n,e)}let C1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return A1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||PN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function xB(n){C1=n(C1)}function _B(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Sx(this),e,...t);return PN.set(r,e.sort?e.sort():[e]),Wo(r)}:vB().includes(n)?function(...e){return n.apply(Sx(this),e),Wo(MN.get(this))}:function(...e){return Wo(n.apply(Sx(this),e))}}function wB(n){return typeof n=="function"?_B(n):(n instanceof IDBTransaction&&bB(n),gB(n,mB())?new Proxy(n,C1):n)}function Wo(n){if(n instanceof IDBRequest)return yB(n);if(Ex.has(n))return Ex.get(n);const e=wB(n);return e!==n&&(Ex.set(n,e),fw.set(e,n)),e}const Sx=n=>fw.get(n);function EB(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(n,e),c=Wo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Wo(o.result),u.oldVersion,u.newVersion,Wo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const SB=["get","getKey","getAll","getAllKeys","count"],TB=["put","add","delete","clear"],Tx=new Map;function j2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Tx.get(e))return Tx.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=TB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||SB.includes(t)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return Tx.set(e,a),a}xB(n=>({...n,get:(e,t,r)=>j2(e,t)||n.get(e,t,r),has:(e,t)=>!!j2(e,t)||n.has(e,t)}));class AB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(CB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function CB(n){return n.getComponent()?.type==="VERSION"}const I1="@firebase/app",V2="0.14.6";const zs=new dw("@firebase/app"),IB="@firebase/app-compat",RB="@firebase/analytics-compat",DB="@firebase/analytics",kB="@firebase/app-check-compat",NB="@firebase/app-check",MB="@firebase/auth",PB="@firebase/auth-compat",OB="@firebase/database",jB="@firebase/data-connect",VB="@firebase/database-compat",zB="@firebase/functions",LB="@firebase/functions-compat",BB="@firebase/installations",UB="@firebase/installations-compat",FB="@firebase/messaging",GB="@firebase/messaging-compat",qB="@firebase/performance",HB="@firebase/performance-compat",$B="@firebase/remote-config",YB="@firebase/remote-config-compat",KB="@firebase/storage",XB="@firebase/storage-compat",WB="@firebase/firestore",QB="@firebase/ai",ZB="@firebase/firestore-compat",JB="firebase",eU="12.6.0";const R1="[DEFAULT]",tU={[I1]:"fire-core",[IB]:"fire-core-compat",[DB]:"fire-analytics",[RB]:"fire-analytics-compat",[NB]:"fire-app-check",[kB]:"fire-app-check-compat",[MB]:"fire-auth",[PB]:"fire-auth-compat",[OB]:"fire-rtdb",[jB]:"fire-data-connect",[VB]:"fire-rtdb-compat",[zB]:"fire-fn",[LB]:"fire-fn-compat",[BB]:"fire-iid",[UB]:"fire-iid-compat",[FB]:"fire-fcm",[GB]:"fire-fcm-compat",[qB]:"fire-perf",[HB]:"fire-perf-compat",[$B]:"fire-rc",[YB]:"fire-rc-compat",[KB]:"fire-gcs",[XB]:"fire-gcs-compat",[WB]:"fire-fst",[ZB]:"fire-fst-compat",[QB]:"fire-vertex","fire-js":"fire-js",[JB]:"fire-js-all"};const C0=new Map,nU=new Map,D1=new Map;function z2(n,e){try{n.container.addComponent(e)}catch(t){zs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ld(n){const e=n.name;if(D1.has(e))return zs.debug(`There were multiple attempts to register component ${e}.`),!1;D1.set(e,n);for(const t of C0.values())z2(t,n);for(const t of nU.values())z2(t,n);return!0}function hw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function zi(n){return n==null?!1:n.settings!==void 0}const rU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qo=new xp("app","Firebase",rU);class iU{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _c("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qo.create("app-deleted",{appName:this._name})}}const jd=eU;function ON(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:R1,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Qo.create("bad-app-name",{appName:String(i)});if(t||(t=TN()),!t)throw Qo.create("no-options");const a=C0.get(i);if(a){if(rl(t,a.options)&&rl(r,a.config))return a;throw Qo.create("duplicate-app",{appName:i})}const o=new uB(i);for(const u of D1.values())o.addComponent(u);const c=new iU(t,r,o);return C0.set(i,c),c}function jN(n=R1){const e=C0.get(n);if(!e&&n===R1&&TN())return ON();if(!e)throw Qo.create("no-app",{appName:n});return e}function Zo(n,e,t){let r=tU[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zs.warn(o.join(" "));return}ld(new _c(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const aU="firebase-heartbeat-database",sU=1,Fh="firebase-heartbeat-store";let Ax=null;function VN(){return Ax||(Ax=EB(aU,sU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qo.create("idb-open",{originalErrorMessage:n.message})})),Ax}async function oU(n){try{const t=(await VN()).transaction(Fh),r=await t.objectStore(Fh).get(zN(n));return await t.done,r}catch(e){if(e instanceof Ks)zs.warn(e.message);else{const t=Qo.create("idb-get",{originalErrorMessage:e?.message});zs.warn(t.message)}}}async function L2(n,e){try{const r=(await VN()).transaction(Fh,"readwrite");await r.objectStore(Fh).put(e,zN(n)),await r.done}catch(t){if(t instanceof Ks)zs.warn(t.message);else{const r=Qo.create("idb-set",{originalErrorMessage:t?.message});zs.warn(r.message)}}}function zN(n){return`${n.name}!${n.options.appId}`}const lU=1024,cU=30;class uU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fU(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=B2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>cU){const i=hU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){zs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=B2(),{heartbeatsToSend:t,unsentEntries:r}=dU(this._heartbeatsCache.heartbeats),i=A0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return zs.warn(e),""}}}function B2(){return new Date().toISOString().substring(0,10)}function dU(n,e=lU){const t=[];let r=n.slice();for(const i of n){const a=t.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),U2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),U2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class fU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return NN()?J9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return L2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return L2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function U2(n){return A0(JSON.stringify({version:2,heartbeats:n})).length}function hU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function pU(n){ld(new _c("platform-logger",e=>new AB(e),"PRIVATE")),ld(new _c("heartbeat",e=>new uU(e),"PRIVATE")),Zo(I1,V2,n),Zo(I1,V2,"esm2020"),Zo("fire-js","")}pU("");function LN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gU=LN,BN=new xp("auth","Firebase",LN());const I0=new dw("@firebase/auth");function mU(n,...e){I0.logLevel<=At.WARN&&I0.warn(`Auth (${jd}): ${n}`,...e)}function e0(n,...e){I0.logLevel<=At.ERROR&&I0.error(`Auth (${jd}): ${n}`,...e)}function ha(n,...e){throw pw(n,...e)}function Ka(n,...e){return pw(n,...e)}function UN(n,e,t){const r={...gU(),[e]:t};return new xp("auth","Firebase",r).create(e,{appName:n.name})}function Ms(n){return UN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return BN.create(n,...e)}function et(n,e,...t){if(!n)throw pw(e,...t)}function Is(n){const e="INTERNAL ASSERTION FAILED: "+n;throw e0(e),new Error(e)}function Ls(n,e){n||Is(e)}function k1(){return typeof self<"u"&&self.location?.href||""}function vU(){return F2()==="http:"||F2()==="https:"}function F2(){return typeof self<"u"&&self.location?.protocol||null}function yU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vU()||W9()||"connection"in navigator)?navigator.onLine:!0}function bU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class wp{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ls(t>e,"Short delay should be less than long delay!"),this.isMobile=K9()||Q9()}get(){return yU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function gw(n,e){Ls(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class FN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const xU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const _U=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],wU=new wp(3e4,6e4);function Xs(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ss(n,e,t,r,i={}){return GN(n,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=_p({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return X9()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Od(n.emulatorConfig.host)&&(d.credentials="include"),FN.fetch()(await qN(n,n.config.apiHost,t,c),d)})}async function GN(n,e,t){n._canInitEmulator=!1;const r={...xU,...e};try{const i=new SU(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Am(n,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Am(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Am(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Am(n,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw UN(n,h,d);ha(n,h)}}catch(i){if(i instanceof Ks)throw i;ha(n,"network-request-failed",{message:String(i)})}}async function Ep(n,e,t,r,i={}){const a=await ss(n,e,t,r,i);return"mfaPendingCredential"in a&&ha(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function qN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,o=a.config.emulator?gw(n.config,i):`${n.config.apiScheme}://${i}`;return _U.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function EU(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class SU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ka(this.auth,"network-request-failed")),wU.get())})}}function Am(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ka(n,e,r);return i.customData._tokenResponse=t,i}function G2(n){return n!==void 0&&n.enterprise!==void 0}class TU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return EU(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function AU(n,e){return ss(n,"GET","/v2/recaptchaConfig",Xs(n,e))}async function CU(n,e){return ss(n,"POST","/v1/accounts:delete",e)}async function R0(n,e){return ss(n,"POST","/v1/accounts:lookup",e)}function yh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function IU(n,e=!1){const t=dn(n),r=await t.getIdToken(e),i=mw(r);et(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:yh(Cx(i.auth_time)),issuedAtTime:yh(Cx(i.iat)),expirationTime:yh(Cx(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Cx(n){return Number(n)*1e3}function mw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return e0("JWT malformed, contained fewer than 3 sections"),null;try{const i=wN(t);return i?JSON.parse(i):(e0("Failed to decode base64 JWT payload"),null)}catch(i){return e0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function q2(n){const e=mw(n);return et(e,"internal-error"),et(typeof e.exp<"u","internal-error"),et(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function cd(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ks&&RU(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function RU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class DU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class N1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yh(this.lastLoginAt),this.creationTime=yh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function D0(n){const e=n.auth,t=await n.getIdToken(),r=await cd(n,R0(e,{idToken:t}));et(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?HN(i.providerUserInfo):[],o=NU(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new N1(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function kU(n){const e=dn(n);await D0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function NU(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function HN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function MU(n,e){const t=await GN(n,{},async()=>{const r=_p({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,o=await qN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Od(n.emulatorConfig.host)&&(u.credentials="include"),FN.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function PU(n,e){return ss(n,"POST","/v2/accounts:revokeToken",Xs(n,e))}class td{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){et(e.idToken,"internal-error"),et(typeof e.idToken<"u","internal-error"),et(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):q2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){et(e.length!==0,"internal-error");const t=q2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(et(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await MU(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,o=new td;return r&&(et(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(et(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(et(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new td,this.toJSON())}_performRefresh(){return Is("not implemented")}}function No(n,e){et(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class la{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new DU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new N1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await cd(this,this.stsTokenManager.getToken(this.auth,e));return et(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return IU(this,e)}reload(){return kU(this)}_assign(e){this!==e&&(et(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new la({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await D0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zi(this.auth.app))return Promise.reject(Ms(this.auth));const e=await this.getIdToken();return await cd(this,CU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;et(p&&w,e,"internal-error");const S=td.fromJSON(this.name,w);et(typeof p=="string",e,"internal-error"),No(r,e.name),No(i,e.name),et(typeof m=="boolean",e,"internal-error"),et(typeof b=="boolean",e,"internal-error"),No(a,e.name),No(o,e.name),No(c,e.name),No(u,e.name),No(d,e.name),No(h,e.name);const T=new la({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new td;i.updateFromServerResponse(t);const a=new la({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await D0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];et(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?HN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new td;c.updateFromIdToken(r);const u=new la({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new N1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const H2=new Map;function Rs(n){Ls(n instanceof Function,"Expected a class definition");let e=H2.get(n);return e?(Ls(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,H2.set(n,e),e)}class $N{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}$N.type="NONE";const $2=$N;function t0(n,e,t){return`firebase:${n}:${e}:${t}`}class nd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=t0(this.userKey,i.apiKey,a),this.fullPersistenceKey=t0("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await R0(this.auth,{idToken:e}).catch(()=>{});return t?la._fromGetAccountInfoResponse(this.auth,t,e):null}return la._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new nd(Rs($2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||Rs($2);const o=t0(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await R0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await la._fromGetAccountInfoResponse(e,m,h)}else p=la._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new nd(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new nd(a,e,r))}}function Y2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(WN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(YN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ZN(e))return"Blackberry";if(JN(e))return"Webos";if(KN(e))return"Safari";if((e.includes("chrome/")||XN(e))&&!e.includes("edge/"))return"Chrome";if(QN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function YN(n=cr()){return/firefox\//i.test(n)}function KN(n=cr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function XN(n=cr()){return/crios\//i.test(n)}function WN(n=cr()){return/iemobile/i.test(n)}function QN(n=cr()){return/android/i.test(n)}function ZN(n=cr()){return/blackberry/i.test(n)}function JN(n=cr()){return/webos/i.test(n)}function vw(n=cr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function OU(n=cr()){return vw(n)&&!!window.navigator?.standalone}function jU(){return Z9()&&document.documentMode===10}function eM(n=cr()){return vw(n)||QN(n)||JN(n)||ZN(n)||/windows phone/i.test(n)||WN(n)}function tM(n,e=[]){let t;switch(n){case"Browser":t=Y2(cr());break;case"Worker":t=`${Y2(cr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jd}/${r}`}class VU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function zU(n,e={}){return ss(n,"GET","/v2/passwordPolicy",Xs(n,e))}const LU=6;class BU{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??LU,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class UU{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new K2(this),this.idTokenSubscription=new K2(this),this.beforeStateQueue=new VU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Rs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nd.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await R0(this,{idToken:e}),r=await la._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return et(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await D0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zi(this.app))return Promise.reject(Ms(this));const t=e?dn(e):null;return t&&et(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&et(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zi(this.app)?Promise.reject(Ms(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zi(this.app)?Promise.reject(Ms(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zU(this),t=new BU(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await PU(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Rs(e)||this._popupRedirectResolver;et(t,this,"argument-error"),this.redirectPersistenceManager=await nd.create(this,[Rs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(et(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(zi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&mU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function pl(n){return dn(n)}class K2{constructor(e){this.auth=e,this.observer=null,this.addObserver=iB(t=>this.observer=t)}get next(){return et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Sv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function FU(n){Sv=n}function nM(n){return Sv.loadJS(n)}function GU(){return Sv.recaptchaEnterpriseScript}function qU(){return Sv.gapiScript}function HU(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class $U{constructor(){this.enterprise=new YU}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class YU{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const KU="recaptcha-enterprise",rM="NO_RECAPTCHA";class XU{constructor(e){this.type=KU,this.auth=pl(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{AU(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new TU(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;G2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(rM)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new $U().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!t&&G2(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=GU();u.length!==0&&(u+=c),nM(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function X2(n,e,t,r=!1,i=!1){const a=new XU(n);let o;if(i)o=rM;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function k0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await X2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await X2(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}function WU(n,e){const t=hw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(rl(a,e??{}))return i;ha(i,"already-initialized")}return t.initialize({options:e})}function QU(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Rs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function ZU(n,e,t){const r=pl(n);et(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=iM(e),{host:o,port:c}=JU(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){et(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),et(rl(d,r.config.emulator)&&rl(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Od(o)?(CN(`${a}//${o}${u}`),IN("Auth",!0)):e8()}function iM(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function JU(n){const e=iM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:W2(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:W2(o)}}}function W2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function e8(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class yw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Is("not implemented")}_getIdTokenResponse(e){return Is("not implemented")}_linkToIdToken(e,t){return Is("not implemented")}_getReauthenticationResolver(e){return Is("not implemented")}}async function t8(n,e){return ss(n,"POST","/v1/accounts:signUp",e)}async function n8(n,e){return Ep(n,"POST","/v1/accounts:signInWithPassword",Xs(n,e))}async function aM(n,e){return ss(n,"POST","/v1/accounts:sendOobCode",Xs(n,e))}async function r8(n,e){return aM(n,e)}async function i8(n,e){return aM(n,e)}async function a8(n,e){return Ep(n,"POST","/v1/accounts:signInWithEmailLink",Xs(n,e))}async function s8(n,e){return Ep(n,"POST","/v1/accounts:signInWithEmailLink",Xs(n,e))}class Gh extends yw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Gh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Gh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,t,"signInWithPassword",n8);case"emailLink":return a8(e,{email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,r,"signUpPassword",t8);case"emailLink":return s8(e,{idToken:t,email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function rd(n,e){return Ep(n,"POST","/v1/accounts:signInWithIdp",Xs(n,e))}const o8="http://localhost";class wc extends yw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new wc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ha("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const o=new wc(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return rd(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,rd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rd(e,t)}buildRequest(){const e={requestUri:o8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_p(t)}return e}}function l8(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function c8(n){const e=ih(ah(n)).link,t=e?ih(ah(e)).deep_link_id:null,r=ih(ah(n)).deep_link_id;return(r?ih(ah(r)).link:null)||r||t||e||n}class bw{constructor(e){const t=ih(ah(e)),r=t.apiKey??null,i=t.oobCode??null,a=l8(t.mode??null);et(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=c8(e);try{return new bw(t)}catch{return null}}}class zc{constructor(){this.providerId=zc.PROVIDER_ID}static credential(e,t){return Gh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=bw.parseLink(t);return et(r,"argument-error"),Gh._fromEmailAndCode(e,r.code,r.tenantId)}}zc.PROVIDER_ID="password";zc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class sM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Sp extends sM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uo extends Sp{constructor(){super("facebook.com")}static credential(e){return wc._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";class Fo extends Sp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return wc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Fo.credential(t,r)}catch{return null}}}Fo.GOOGLE_SIGN_IN_METHOD="google.com";Fo.PROVIDER_ID="google.com";class Go extends Sp{constructor(){super("github.com")}static credential(e){return wc._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Go.credential(e.oauthAccessToken)}catch{return null}}}Go.GITHUB_SIGN_IN_METHOD="github.com";Go.PROVIDER_ID="github.com";class qo extends Sp{constructor(){super("twitter.com")}static credential(e,t){return wc._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return qo.credential(t,r)}catch{return null}}}qo.TWITTER_SIGN_IN_METHOD="twitter.com";qo.PROVIDER_ID="twitter.com";async function u8(n,e){return Ep(n,"POST","/v1/accounts:signUp",Xs(n,e))}class Ec{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await la._fromIdTokenResponse(e,r,i),o=Q2(r);return new Ec({user:a,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=Q2(r);return new Ec({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function Q2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class N0 extends Ks{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,N0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new N0(e,t,r,i)}}function oM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?N0._fromErrorAndOperation(n,a,e,r):a})}async function d8(n,e,t=!1){const r=await cd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ec._forOperation(n,"link",r)}async function lM(n,e,t=!1){const{auth:r}=n;if(zi(r.app))return Promise.reject(Ms(r));const i="reauthenticate";try{const a=await cd(n,oM(r,i,e,n),t);et(a.idToken,r,"internal-error");const o=mw(a.idToken);et(o,r,"internal-error");const{sub:c}=o;return et(n.uid===c,r,"user-mismatch"),Ec._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ha(r,"user-mismatch"),a}}async function cM(n,e,t=!1){if(zi(n.app))return Promise.reject(Ms(n));const r="signIn",i=await oM(n,r,e),a=await Ec._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function f8(n,e){return cM(pl(n),e)}async function h8(n,e){return lM(dn(n),e)}async function uM(n){const e=pl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function p8(n,e,t){const r=pl(n);await k0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",i8)}async function g8(n,e,t){if(zi(n.app))return Promise.reject(Ms(n));const r=pl(n),o=await k0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",u8).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&uM(n),u}),c=await Ec._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function m8(n,e,t){return zi(n.app)?Promise.reject(Ms(n)):f8(dn(n),zc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&uM(n),r})}async function Z2(n,e){const t=dn(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:a}=await r8(t.auth,i);a!==n.email&&await n.reload()}async function v8(n,e){return ss(n,"POST","/v1/accounts:update",e)}async function y8(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=dn(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await cd(r,v8(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function b8(n,e,t,r){return dn(n).onIdTokenChanged(e,t,r)}function x8(n,e,t){return dn(n).beforeAuthStateChanged(e,t)}function _8(n,e,t,r){return dn(n).onAuthStateChanged(e,t,r)}function J2(n){return dn(n).signOut()}async function w8(n){return dn(n).delete()}const M0="__sak";class dM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(M0,"1"),this.storage.removeItem(M0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const E8=1e3,S8=10;class fM extends dM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eM(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);jU()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,S8):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},E8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fM.type="LOCAL";const T8=fM;class hM extends dM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hM.type="SESSION";const pM=hM;function A8(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Tv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Tv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(t.origin,a)),u=await A8(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tv.receivers=[];function xw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class C8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=xw("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Xa(){return window}function I8(n){Xa().location.href=n}function gM(){return typeof Xa().WorkerGlobalScope<"u"&&typeof Xa().importScripts=="function"}async function R8(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function D8(){return navigator?.serviceWorker?.controller||null}function k8(){return gM()?self:null}const mM="firebaseLocalStorageDb",N8=1,P0="firebaseLocalStorage",vM="fbase_key";class Tp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Av(n,e){return n.transaction([P0],e?"readwrite":"readonly").objectStore(P0)}function M8(){const n=indexedDB.deleteDatabase(mM);return new Tp(n).toPromise()}function M1(){const n=indexedDB.open(mM,N8);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(P0,{keyPath:vM})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(P0)?e(r):(r.close(),await M8(),e(await M1()))})})}async function eI(n,e,t){const r=Av(n,!0).put({[vM]:e,value:t});return new Tp(r).toPromise()}async function P8(n,e){const t=Av(n,!1).get(e),r=await new Tp(t).toPromise();return r===void 0?null:r.value}function tI(n,e){const t=Av(n,!0).delete(e);return new Tp(t).toPromise()}const O8=800,j8=3;class yM{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await M1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>j8)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tv._getInstance(k8()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await R8(),!this.activeServiceWorker)return;this.sender=new C8(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||D8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await M1();return await eI(e,M0,"1"),await tI(e,M0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>eI(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>P8(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Av(i,!1).getAll();return new Tp(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),O8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yM.type="LOCAL";const V8=yM;new wp(3e4,6e4);function z8(n,e){return e?Rs(e):(et(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class _w extends yw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function L8(n){return cM(n.auth,new _w(n),n.bypassAuthState)}function B8(n){const{auth:e,user:t}=n;return et(t,e,"internal-error"),lM(t,new _w(n),n.bypassAuthState)}async function U8(n){const{auth:e,user:t}=n;return et(t,e,"internal-error"),d8(t,new _w(n),n.bypassAuthState)}class bM{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return L8;case"linkViaPopup":case"linkViaRedirect":return U8;case"reauthViaPopup":case"reauthViaRedirect":return B8;default:ha(this.auth,"internal-error")}}resolve(e){Ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const F8=new wp(2e3,1e4);class Fu extends bM{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Fu.currentPopupAction&&Fu.currentPopupAction.cancel(),Fu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return et(e,this.auth,"internal-error"),e}async onExecution(){Ls(this.filter.length===1,"Popup operations only handle one event");const e=xw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ka(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ka(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ka(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,F8.get())};e()}}Fu.currentPopupAction=null;const G8="pendingRedirect",n0=new Map;class q8 extends bM{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=n0.get(this.auth._key());if(!e){try{const r=await H8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}n0.set(this.auth._key(),e)}return this.bypassAuthState||n0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function H8(n,e){const t=K8(e),r=Y8(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function $8(n,e){n0.set(n._key(),e)}function Y8(n){return Rs(n._redirectPersistence)}function K8(n){return t0(G8,n.config.apiKey,n.name)}async function X8(n,e,t=!1){if(zi(n.app))return Promise.reject(Ms(n));const r=pl(n),i=z8(r,e),o=await new q8(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const W8=600*1e3;class Q8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Z8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!xM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ka(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=W8&&this.cachedEventUids.clear(),this.cachedEventUids.has(nI(e))}saveEventToCache(e){this.cachedEventUids.add(nI(e)),this.lastProcessedEventTime=Date.now()}}function nI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Z8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xM(n);default:return!1}}async function J8(n,e={}){return ss(n,"GET","/v1/projects",e)}const eF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tF=/^https?/;async function nF(n){if(n.config.emulator)return;const{authorizedDomains:e}=await J8(n);for(const t of e)try{if(rF(t))return}catch{}ha(n,"unauthorized-domain")}function rF(n){const e=k1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!tF.test(t))return!1;if(eF.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const iF=new wp(3e4,6e4);function rI(){const n=Xa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function aF(n){return new Promise((e,t)=>{function r(){rI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rI(),t(Ka(n,"network-request-failed"))},timeout:iF.get()})}if(Xa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Xa().gapi?.load)r();else{const i=HU("iframefcb");return Xa()[i]=()=>{gapi.load?r():t(Ka(n,"network-request-failed"))},nM(`${qU()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw r0=null,e})}let r0=null;function sF(n){return r0=r0||aF(n),r0}const oF=new wp(5e3,15e3),lF="__/auth/iframe",cF="emulator/auth/iframe",uF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fF(n){const e=n.config;et(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?gw(e,cF):`https://${n.config.authDomain}/${lF}`,r={apiKey:e.apiKey,appName:n.name,v:jd},i=dF.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${_p(r).slice(1)}`}async function hF(n){const e=await sF(n),t=Xa().gapi;return et(t,n,"internal-error"),e.open({where:document.body,url:fF(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:uF,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Ka(n,"network-request-failed"),c=Xa().setTimeout(()=>{a(o)},oF.get());function u(){Xa().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const pF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},gF=500,mF=600,vF="_blank",yF="http://localhost";class iI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bF(n,e,t,r=gF,i=mF){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...pF,width:r.toString(),height:i.toString(),top:a,left:o},d=cr().toLowerCase();t&&(c=XN(d)?vF:t),YN(d)&&(e=e||yF,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(OU(d)&&c!=="_self")return xF(e||"",c),new iI(null);const p=window.open(e||"",c,h);et(p,n,"popup-blocked");try{p.focus()}catch{}return new iI(p)}function xF(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const _F="__/auth/handler",wF="emulator/auth/handler",EF=encodeURIComponent("fac");async function aI(n,e,t,r,i,a){et(n.config.authDomain,n,"auth-domain-config-required"),et(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:jd,eventId:i};if(e instanceof sM){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",rB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof Sp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${EF}=${encodeURIComponent(u)}`:"";return`${SF(n)}?${_p(c).slice(1)}${d}`}function SF({config:n}){return n.emulator?gw(n,wF):`https://${n.authDomain}/${_F}`}const Ix="webStorageSupport";class TF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pM,this._completeRedirectFn=X8,this._overrideRedirectResult=$8}async _openPopup(e,t,r,i){Ls(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await aI(e,t,r,k1(),i);return bF(e,a,xw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await aI(e,t,r,k1(),i);return I8(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Ls(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await hF(e),r=new Q8(e);return t.register("authEvent",i=>(et(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ix,{type:Ix},i=>{const a=i?.[0]?.[Ix];a!==void 0&&t(!!a),ha(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=nF(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eM()||KN()||vw()}}const AF=TF;var sI="@firebase/auth",oI="1.11.1";class CF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function IF(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RF(n){ld(new _c("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;et(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tM(n)},d=new UU(r,i,a,u);return QU(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ld(new _c("auth-internal",e=>{const t=pl(e.getProvider("auth").getImmediate());return(r=>new CF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zo(sI,oI,IF(n)),Zo(sI,oI,"esm2020")}const DF=300,kF=AN("authIdTokenMaxAge")||DF;let lI=null;const NF=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>kF)return;const i=t?.token;lI!==i&&(lI=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function MF(n=jN()){const e=hw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=WU(n,{popupRedirectResolver:AF,persistence:[V8,T8,pM]}),r=AN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=NF(a.toString());x8(t,o,()=>o(t.currentUser)),b8(t,c=>o(c))}}const i=SN("auth");return i&&ZU(t,`http://${i}`),t}function PF(){return document.getElementsByTagName("head")?.[0]??document}FU({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=Ka("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",PF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RF("Browser");var OF="firebase",jF="12.6.0";Zo(OF,jF,"app");var cI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Jo,_M;(function(){var n;function e(A,I){function k(){}k.prototype=I.prototype,A.F=I.prototype,A.prototype=new k,A.prototype.constructor=A,A.D=function(z,L,B){for(var P=Array(arguments.length-2),J=2;J<arguments.length;J++)P[J-2]=arguments[J];return I.prototype[L].apply(z,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,I,k){k||(k=0);const z=Array(16);if(typeof I=="string")for(var L=0;L<16;++L)z[L]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(L=0;L<16;++L)z[L]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=A.g[0],k=A.g[1],L=A.g[2];let B=A.g[3],P;P=I+(B^k&(L^B))+z[0]+3614090360&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[1]+3905402710&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[2]+606105819&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[3]+3250441966&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(B^k&(L^B))+z[4]+4118548399&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[5]+1200080426&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[6]+2821735955&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[7]+4249261313&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(B^k&(L^B))+z[8]+1770035416&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[9]+2336552879&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[10]+4294925233&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[11]+2304563134&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(B^k&(L^B))+z[12]+1804603682&4294967295,I=k+(P<<7&4294967295|P>>>25),P=B+(L^I&(k^L))+z[13]+4254626195&4294967295,B=I+(P<<12&4294967295|P>>>20),P=L+(k^B&(I^k))+z[14]+2792965006&4294967295,L=B+(P<<17&4294967295|P>>>15),P=k+(I^L&(B^I))+z[15]+1236535329&4294967295,k=L+(P<<22&4294967295|P>>>10),P=I+(L^B&(k^L))+z[1]+4129170786&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[6]+3225465664&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[11]+643717713&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[0]+3921069994&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(L^B&(k^L))+z[5]+3593408605&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[10]+38016083&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[15]+3634488961&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[4]+3889429448&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(L^B&(k^L))+z[9]+568446438&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[14]+3275163606&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[3]+4107603335&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[8]+1163531501&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(L^B&(k^L))+z[13]+2850285829&4294967295,I=k+(P<<5&4294967295|P>>>27),P=B+(k^L&(I^k))+z[2]+4243563512&4294967295,B=I+(P<<9&4294967295|P>>>23),P=L+(I^k&(B^I))+z[7]+1735328473&4294967295,L=B+(P<<14&4294967295|P>>>18),P=k+(B^I&(L^B))+z[12]+2368359562&4294967295,k=L+(P<<20&4294967295|P>>>12),P=I+(k^L^B)+z[5]+4294588738&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[8]+2272392833&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[11]+1839030562&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[14]+4259657740&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(k^L^B)+z[1]+2763975236&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[4]+1272893353&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[7]+4139469664&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[10]+3200236656&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(k^L^B)+z[13]+681279174&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[0]+3936430074&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[3]+3572445317&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[6]+76029189&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(k^L^B)+z[9]+3654602809&4294967295,I=k+(P<<4&4294967295|P>>>28),P=B+(I^k^L)+z[12]+3873151461&4294967295,B=I+(P<<11&4294967295|P>>>21),P=L+(B^I^k)+z[15]+530742520&4294967295,L=B+(P<<16&4294967295|P>>>16),P=k+(L^B^I)+z[2]+3299628645&4294967295,k=L+(P<<23&4294967295|P>>>9),P=I+(L^(k|~B))+z[0]+4096336452&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[7]+1126891415&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[14]+2878612391&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[5]+4237533241&4294967295,k=L+(P<<21&4294967295|P>>>11),P=I+(L^(k|~B))+z[12]+1700485571&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[3]+2399980690&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[10]+4293915773&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[1]+2240044497&4294967295,k=L+(P<<21&4294967295|P>>>11),P=I+(L^(k|~B))+z[8]+1873313359&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[15]+4264355552&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[6]+2734768916&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[13]+1309151649&4294967295,k=L+(P<<21&4294967295|P>>>11),P=I+(L^(k|~B))+z[4]+4149444226&4294967295,I=k+(P<<6&4294967295|P>>>26),P=B+(k^(I|~L))+z[11]+3174756917&4294967295,B=I+(P<<10&4294967295|P>>>22),P=L+(I^(B|~k))+z[2]+718787259&4294967295,L=B+(P<<15&4294967295|P>>>17),P=k+(B^(L|~I))+z[9]+3951481745&4294967295,A.g[0]=A.g[0]+I&4294967295,A.g[1]=A.g[1]+(L+(P<<21&4294967295|P>>>11))&4294967295,A.g[2]=A.g[2]+L&4294967295,A.g[3]=A.g[3]+B&4294967295}r.prototype.v=function(A,I){I===void 0&&(I=A.length);const k=I-this.blockSize,z=this.C;let L=this.h,B=0;for(;B<I;){if(L==0)for(;B<=k;)i(this,A,B),B+=this.blockSize;if(typeof A=="string"){for(;B<I;)if(z[L++]=A.charCodeAt(B++),L==this.blockSize){i(this,z),L=0;break}}else for(;B<I;)if(z[L++]=A[B++],L==this.blockSize){i(this,z),L=0;break}}this.h=L,this.o+=I},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var I=1;I<A.length-8;++I)A[I]=0;I=this.o*8;for(var k=A.length-8;k<A.length;++k)A[k]=I&255,I/=256;for(this.v(A),A=Array(16),I=0,k=0;k<4;++k)for(let z=0;z<32;z+=8)A[I++]=this.g[k]>>>z&255;return A};function a(A,I){var k=c;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=I(A)}function o(A,I){this.h=I;const k=[];let z=!0;for(let L=A.length-1;L>=0;L--){const B=A[L]|0;z&&B==I||(k[L]=B,z=!1)}this.g=k}var c={};function u(A){return-128<=A&&A<128?a(A,function(I){return new o([I|0],I<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return S(d(-A));const I=[];let k=1;for(let z=0;A>=k;z++)I[z]=A/k|0,k*=4294967296;return new o(I,0)}function h(A,I){if(A.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(A.charAt(0)=="-")return S(h(A.substring(1),I));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(I,8));let z=p;for(let B=0;B<A.length;B+=8){var L=Math.min(8,A.length-B);const P=parseInt(A.substring(B,B+L),I);L<8?(L=d(Math.pow(I,L)),z=z.j(L).add(d(P))):(z=z.j(k),z=z.add(d(P)))}return z}var p=u(0),m=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(w(this))return-S(this).m();let A=0,I=1;for(let k=0;k<this.g.length;k++){const z=this.i(k);A+=(z>=0?z:4294967296+z)*I,I*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(_(this))return"0";if(w(this))return"-"+S(this).toString(A);const I=d(Math.pow(A,6));var k=this;let z="";for(;;){const L=O(k,I).g;k=T(k,L.j(I));let B=((k.g.length>0?k.g[0]:k.h)>>>0).toString(A);if(k=L,_(k))return B+z;for(;B.length<6;)B="0"+B;z=B+z}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function _(A){if(A.h!=0)return!1;for(let I=0;I<A.g.length;I++)if(A.g[I]!=0)return!1;return!0}function w(A){return A.h==-1}n.l=function(A){return A=T(this,A),w(A)?-1:_(A)?0:1};function S(A){const I=A.g.length,k=[];for(let z=0;z<I;z++)k[z]=~A.g[z];return new o(k,~A.h).add(m)}n.abs=function(){return w(this)?S(this):this},n.add=function(A){const I=Math.max(this.g.length,A.g.length),k=[];let z=0;for(let L=0;L<=I;L++){let B=z+(this.i(L)&65535)+(A.i(L)&65535),P=(B>>>16)+(this.i(L)>>>16)+(A.i(L)>>>16);z=P>>>16,B&=65535,P&=65535,k[L]=P<<16|B}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(A,I){return A.add(S(I))}n.j=function(A){if(_(this)||_(A))return p;if(w(this))return w(A)?S(this).j(S(A)):S(S(this).j(A));if(w(A))return S(this.j(S(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const I=this.g.length+A.g.length,k=[];for(var z=0;z<2*I;z++)k[z]=0;for(z=0;z<this.g.length;z++)for(let L=0;L<A.g.length;L++){const B=this.i(z)>>>16,P=this.i(z)&65535,J=A.i(L)>>>16,Y=A.i(L)&65535;k[2*z+2*L]+=P*Y,C(k,2*z+2*L),k[2*z+2*L+1]+=B*Y,C(k,2*z+2*L+1),k[2*z+2*L+1]+=P*J,C(k,2*z+2*L+1),k[2*z+2*L+2]+=B*J,C(k,2*z+2*L+2)}for(A=0;A<I;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=I;A<2*I;A++)k[A]=0;return new o(k,0)};function C(A,I){for(;(A[I]&65535)!=A[I];)A[I+1]+=A[I]>>>16,A[I]&=65535,I++}function D(A,I){this.g=A,this.h=I}function O(A,I){if(_(I))throw Error("division by zero");if(_(A))return new D(p,p);if(w(A))return I=O(S(A),I),new D(S(I.g),S(I.h));if(w(I))return I=O(A,S(I)),new D(S(I.g),I.h);if(A.g.length>30){if(w(A)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var k=m,z=I;z.l(A)<=0;)k=M(k),z=M(z);var L=V(k,1),B=V(z,1);for(z=V(z,2),k=V(k,2);!_(z);){var P=B.add(z);P.l(A)<=0&&(L=L.add(k),B=P),z=V(z,1),k=V(k,1)}return I=T(A,L.j(I)),new D(L,I)}for(L=p;A.l(I)>=0;){for(k=Math.max(1,Math.floor(A.m()/I.m())),z=Math.ceil(Math.log(k)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),B=d(k),P=B.j(I);w(P)||P.l(A)>0;)k-=z,B=d(k),P=B.j(I);_(B)&&(B=m),L=L.add(B),A=T(A,P)}return new D(L,A)}n.B=function(A){return O(this,A).h},n.and=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)&A.i(z);return new o(k,this.h&A.h)},n.or=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)|A.i(z);return new o(k,this.h|A.h)},n.xor=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)^A.i(z);return new o(k,this.h^A.h)};function M(A){const I=A.g.length+1,k=[];for(let z=0;z<I;z++)k[z]=A.i(z)<<1|A.i(z-1)>>>31;return new o(k,A.h)}function V(A,I){const k=I>>5;I%=32;const z=A.g.length-k,L=[];for(let B=0;B<z;B++)L[B]=I>0?A.i(B+k)>>>I|A.i(B+k+1)<<32-I:A.i(B+k);return new o(L,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,_M=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Jo=o}).apply(typeof cI<"u"?cI:typeof self<"u"?self:typeof window<"u"?window:{});var Cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var wM,sh,EM,i0,P1,SM,TM,AM;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cm=="object"&&Cm];for(var R=0;R<y.length;++R){var j=y[R];if(j&&j.Math==Math)return j}throw Error("Cannot find global object")}var r=t(this);function i(y,R){if(R)e:{var j=r;y=y.split(".");for(var q=0;q<y.length-1;q++){var oe=y[q];if(!(oe in j))break e;j=j[oe]}y=y[y.length-1],q=j[y],R=R(q),R!=q&&R!=null&&e(j,y,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(R){var j=[],q;for(q in R)Object.prototype.hasOwnProperty.call(R,q)&&j.push([q,R[q]]);return j}});var a=a||{},o=this||self;function c(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function u(y,R,j){return y.call.apply(y.bind,arguments)}function d(y,R,j){return d=u,d.apply(null,arguments)}function h(y,R){var j=Array.prototype.slice.call(arguments,1);return function(){var q=j.slice();return q.push.apply(q,arguments),y.apply(this,q)}}function p(y,R){function j(){}j.prototype=R.prototype,y.Z=R.prototype,y.prototype=new j,y.prototype.constructor=y,y.Ob=function(q,oe,pe){for(var Re=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)Re[ft-2]=arguments[ft];return R.prototype[oe].apply(q,Re)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const R=y.length;if(R>0){const j=Array(R);for(let q=0;q<R;q++)j[q]=y[q];return j}return[]}function _(y,R){for(let q=1;q<arguments.length;q++){const oe=arguments[q];var j=typeof oe;if(j=j!="object"?j:oe?Array.isArray(oe)?"array":j:"null",j=="array"||j=="object"&&typeof oe.length=="number"){j=y.length||0;const pe=oe.length||0;y.length=j+pe;for(let Re=0;Re<pe;Re++)y[j+Re]=oe[Re]}else y.push(oe)}}class w{constructor(R,j){this.i=R,this.j=j,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function S(y){o.setTimeout(()=>{throw y},0)}function T(){var y=A;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class C{constructor(){this.h=this.g=null}add(R,j){const q=D.get();q.set(R,j),this.h?this.h.next=q:this.g=q,this.h=q}}var D=new w(()=>new O,y=>y.reset());class O{constructor(){this.next=this.g=this.h=null}set(R,j){this.h=R,this.g=j,this.next=null}reset(){this.next=this.g=this.h=null}}let M,V=!1,A=new C,I=()=>{const y=Promise.resolve(void 0);M=()=>{y.then(k)}};function k(){for(var y;y=T();){try{y.h.call(y.g)}catch(j){S(j)}var R=D;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}V=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const j=()=>{};o.addEventListener("test",j,R),o.removeEventListener("test",j,R)}catch{}return y})();function P(y){return/^[\s\xa0]*$/.test(y)}function J(y,R){L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}p(J,L),J.prototype.init=function(y,R){const j=this.type=y.type,q=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(j=="mouseover"?R=y.fromElement:j=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&J.Z.h.call(this)},J.prototype.h=function(){J.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var Y="closure_listenable_"+(Math.random()*1e6|0),H=0;function W(y,R,j,q,oe){this.listener=y,this.proxy=null,this.src=R,this.type=j,this.capture=!!q,this.ha=oe,this.key=++H,this.da=this.fa=!1}function K(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function de(y,R,j){for(const q in y)R.call(j,y[q],q,y)}function te(y,R){for(const j in y)R.call(void 0,y[j],j,y)}function G(y){const R={};for(const j in y)R[j]=y[j];return R}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(y,R){let j,q;for(let oe=1;oe<arguments.length;oe++){q=arguments[oe];for(j in q)y[j]=q[j];for(let pe=0;pe<$.length;pe++)j=$[pe],Object.prototype.hasOwnProperty.call(q,j)&&(y[j]=q[j])}}function ee(y){this.src=y,this.g={},this.h=0}ee.prototype.add=function(y,R,j,q,oe){const pe=y.toString();y=this.g[pe],y||(y=this.g[pe]=[],this.h++);const Re=he(y,R,q,oe);return Re>-1?(R=y[Re],j||(R.fa=!1)):(R=new W(R,this.src,pe,!!q,oe),R.fa=j,y.push(R)),R};function le(y,R){const j=R.type;if(j in y.g){var q=y.g[j],oe=Array.prototype.indexOf.call(q,R,void 0),pe;(pe=oe>=0)&&Array.prototype.splice.call(q,oe,1),pe&&(K(R),y.g[j].length==0&&(delete y.g[j],y.h--))}}function he(y,R,j,q){for(let oe=0;oe<y.length;++oe){const pe=y[oe];if(!pe.da&&pe.listener==R&&pe.capture==!!j&&pe.ha==q)return oe}return-1}var se="closure_lm_"+(Math.random()*1e6|0),Se={};function Me(y,R,j,q,oe){if(Array.isArray(R)){for(let pe=0;pe<R.length;pe++)Me(y,R[pe],j,q,oe);return null}return j=st(j),y&&y[Y]?y.J(R,j,c(q)?!!q.capture:!1,oe):Ge(y,R,j,!1,q,oe)}function Ge(y,R,j,q,oe,pe){if(!R)throw Error("Invalid event type");const Re=c(oe)?!!oe.capture:!!oe;let ft=we(y);if(ft||(y[se]=ft=new ee(y)),j=ft.add(R,j,q,Re,pe),j.proxy)return j;if(q=Ee(),j.proxy=q,q.src=y,q.listener=j,y.addEventListener)B||(oe=Re),oe===void 0&&(oe=!1),y.addEventListener(R.toString(),q,oe);else if(y.attachEvent)y.attachEvent(Le(R.toString()),q);else if(y.addListener&&y.removeListener)y.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return j}function Ee(){function y(j){return R.call(y.src,y.listener,j)}const R=Fe;return y}function ke(y,R,j,q,oe){if(Array.isArray(R))for(var pe=0;pe<R.length;pe++)ke(y,R[pe],j,q,oe);else q=c(q)?!!q.capture:!!q,j=st(j),y&&y[Y]?(y=y.i,pe=String(R).toString(),pe in y.g&&(R=y.g[pe],j=he(R,j,q,oe),j>-1&&(K(R[j]),Array.prototype.splice.call(R,j,1),R.length==0&&(delete y.g[pe],y.h--)))):y&&(y=we(y))&&(R=y.g[R.toString()],y=-1,R&&(y=he(R,j,q,oe)),(j=y>-1?R[y]:null)&&ut(j))}function ut(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[Y])le(R.i,y);else{var j=y.type,q=y.proxy;R.removeEventListener?R.removeEventListener(j,q,y.capture):R.detachEvent?R.detachEvent(Le(j),q):R.addListener&&R.removeListener&&R.removeListener(q),(j=we(R))?(le(j,y),j.h==0&&(j.src=null,R[se]=null)):K(y)}}}function Le(y){return y in Se?Se[y]:Se[y]="on"+y}function Fe(y,R){if(y.da)y=!0;else{R=new J(R,this);const j=y.listener,q=y.ha||y.src;y.fa&&ut(y),y=j.call(q,R)}return y}function we(y){return y=y[se],y instanceof ee?y:null}var ze="__closure_events_fn_"+(Math.random()*1e9>>>0);function st(y){return typeof y=="function"?y:(y[ze]||(y[ze]=function(R){return y.handleEvent(R)}),y[ze])}function Ne(){z.call(this),this.i=new ee(this),this.M=this,this.G=null}p(Ne,z),Ne.prototype[Y]=!0,Ne.prototype.removeEventListener=function(y,R,j,q){ke(this,y,R,j,q)};function Pe(y,R){var j,q=y.G;if(q)for(j=[];q;q=q.G)j.push(q);if(y=y.M,q=R.type||R,typeof R=="string")R=new L(R,y);else if(R instanceof L)R.target=R.target||y;else{var oe=R;R=new L(q,y),Z(R,oe)}oe=!0;let pe,Re;if(j)for(Re=j.length-1;Re>=0;Re--)pe=R.g=j[Re],oe=nt(pe,q,!0,R)&&oe;if(pe=R.g=y,oe=nt(pe,q,!0,R)&&oe,oe=nt(pe,q,!1,R)&&oe,j)for(Re=0;Re<j.length;Re++)pe=R.g=j[Re],oe=nt(pe,q,!1,R)&&oe}Ne.prototype.N=function(){if(Ne.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const j=y.g[R];for(let q=0;q<j.length;q++)K(j[q]);delete y.g[R],y.h--}}this.G=null},Ne.prototype.J=function(y,R,j,q){return this.i.add(String(y),R,!1,j,q)},Ne.prototype.K=function(y,R,j,q){return this.i.add(String(y),R,!0,j,q)};function nt(y,R,j,q){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let oe=!0;for(let pe=0;pe<R.length;++pe){const Re=R[pe];if(Re&&!Re.da&&Re.capture==j){const ft=Re.listener,Pn=Re.ha||Re.src;Re.fa&&le(y.i,Re),oe=ft.call(Pn,q)!==!1&&oe}}return oe&&!q.defaultPrevented}function Qe(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:o.setTimeout(y,R||0)}function Ft(y){y.g=Qe(()=>{y.g=null,y.i&&(y.i=!1,Ft(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class rt extends z{constructor(R,j){super(),this.m=R,this.l=j,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Ft(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bt(y){z.call(this),this.h=y,this.g={}}p(bt,z);var Ot=[];function an(y){de(y.g,function(R,j){this.g.hasOwnProperty(j)&&ut(R)},y),y.g={}}bt.prototype.N=function(){bt.Z.N.call(this),an(this)},bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bn=o.JSON.stringify,Or=o.JSON.parse,ls=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function _i(){}function Xi(){}var jr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function An(){L.call(this,"d")}p(An,L);function dr(){L.call(this,"c")}p(dr,L);var sn={},Js=null;function ya(){return Js=Js||new Ne}sn.Ia="serverreachability";function ba(y){L.call(this,sn.Ia,y)}p(ba,L);function Ce(y){const R=ya();Pe(R,new ba(R))}sn.STAT_EVENT="statevent";function Ze(y,R){L.call(this,sn.STAT_EVENT,y),this.stat=R}p(Ze,L);function Dt(y){const R=ya();Pe(R,new Ze(R,y))}sn.Ja="timingevent";function Je(y,R){L.call(this,sn.Ja,y),this.size=R}p(Je,L);function fn(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},R)}function on(){this.g=!0}on.prototype.ua=function(){this.g=!1};function Vr(y,R,j,q,oe,pe){y.info(function(){if(y.g)if(pe){var Re="",ft=pe.split("&");for(let Vt=0;Vt<ft.length;Vt++){var Pn=ft[Vt].split("=");if(Pn.length>1){const hn=Pn[0];Pn=Pn[1];const Ti=hn.split("_");Re=Ti.length>=2&&Ti[1]=="type"?Re+(hn+"="+Pn+"&"):Re+(hn+"=redacted&")}}}else Re=null;else Re=pe;return"XMLHTTP REQ ("+q+") [attempt "+oe+"]: "+R+`
`+j+`
`+Re})}function Un(y,R,j,q,oe,pe,Re){y.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+oe+"]: "+R+`
`+j+`
`+pe+" "+Re})}function Et(y,R,j,q){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+bn(y,j)+(q?" "+q:"")})}function It(y,R){y.info(function(){return"TIMEOUT: "+R})}on.prototype.info=function(){};function bn(y,R){if(!y.g)return R;if(!R)return null;try{const pe=JSON.parse(R);if(pe){for(y=0;y<pe.length;y++)if(Array.isArray(pe[y])){var j=pe[y];if(!(j.length<2)){var q=j[1];if(Array.isArray(q)&&!(q.length<1)){var oe=q[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(let Re=1;Re<q.length;Re++)q[Re]=""}}}}return Bn(pe)}catch{return R}}var jt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},xn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},xt;function tn(){}p(tn,_i),tn.prototype.g=function(){return new XMLHttpRequest},xt=new tn;function _n(y){return encodeURIComponent(String(y))}function xa(y){var R=1;y=y.split(":");const j=[];for(;R>0&&y.length;)j.push(y.shift()),R--;return y.length&&j.push(y.join(":")),j}function Mn(y,R,j,q){this.j=y,this.i=R,this.l=j,this.S=q||1,this.V=new bt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new nr}function nr(){this.i=null,this.g="",this.h=!1}var Bt={},fr={};function _a(y,R,j){y.M=1,y.A=_l(Gn(R)),y.u=j,y.R=!0,Gc(y,null)}function Gc(y,R){y.F=Date.now(),wa(y),y.B=Gn(y.A);var j=y.B,q=y.S;Array.isArray(q)||(q=[String(q)]),Yc(j.i,"t",q),y.C=0,j=y.j.L,y.h=new nr,y.g=mg(y.j,j?R:null,!y.u),y.P>0&&(y.O=new rt(d(y.Y,y,y.g),y.P)),R=y.V,j=y.g,q=y.ba;var oe="readystatechange";Array.isArray(oe)||(oe&&(Ot[0]=oe.toString()),oe=Ot);for(let pe=0;pe<oe.length;pe++){const Re=Me(j,oe[pe],q||R.handleEvent,!1,R.h||R);if(!Re)break;R.g[Re.key]=Re}R=y.J?G(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),Ce(),Vr(y.i,y.v,y.B,y.l,y.S,y.u)}Mn.prototype.ba=function(y){y=y.target;const R=this.O;R&&Zi(y)==3?R.j():this.Y(y)},Mn.prototype.Y=function(y){try{if(y==this.g)e:{const ft=Zi(this.g),Pn=this.g.ya(),Vt=this.g.ca();if(!(ft<3)&&(ft!=3||this.g&&(this.h.h||this.g.la()||mr(this.g)))){this.K||ft!=4||Pn==7||(Pn==8||Vt<=0?Ce(3):Ce(2)),Ea(this);var R=this.g.ca();this.X=R;var j=yy(this);if(this.o=R==200,Un(this.i,this.v,this.B,this.l,this.S,ft,R),this.o){if(this.U&&!this.L){t:{if(this.g){var q,oe=this.g;if((q=oe.g?oe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(q)){var pe=q;break t}}pe=null}if(y=pe)Et(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Sa(this,y);else{this.o=!1,this.m=3,Dt(12),li(this),wi(this);break e}}if(this.R){y=!0;let hn;for(;!this.K&&this.C<j.length;)if(hn=rg(this,j),hn==fr){ft==4&&(this.m=4,Dt(14),y=!1),Et(this.i,this.l,null,"[Incomplete Response]");break}else if(hn==Bt){this.m=4,Dt(15),Et(this.i,this.l,j,"[Invalid Chunk]"),y=!1;break}else Et(this.i,this.l,hn,null),Sa(this,hn);if(ng(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ft!=4||j.length!=0||this.h.h||(this.m=1,Dt(16),y=!1),this.o=this.o&&y,!y)Et(this.i,this.l,j,"[Invalid Chunked Response]"),li(this),wi(this);else if(j.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),df(Re),Re.P=!0,Dt(11))}}else Et(this.i,this.l,j,null),Sa(this,j);ft==4&&li(this),this.o&&!this.K&&(ft==4?fg(this.j,this):(this.o=!1,wa(this)))}else us(this.g),R==400&&j.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),li(this),wi(this)}}}catch{}finally{}};function yy(y){if(!ng(y))return y.g.la();const R=mr(y.g);if(R==="")return"";let j="";const q=R.length,oe=Zi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return li(y),wi(y),"";y.h.i=new o.TextDecoder}for(let pe=0;pe<q;pe++)y.h.h=!0,j+=y.h.i.decode(R[pe],{stream:!(oe&&pe==q-1)});return R.length=0,y.h.g+=j,y.C=0,y.h.g}function ng(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function rg(y,R){var j=y.C,q=R.indexOf(`
`,j);return q==-1?fr:(j=Number(R.substring(j,q)),isNaN(j)?Bt:(q+=1,q+j>R.length?fr:(R=R.slice(q,q+j),y.C=q+j,R)))}Mn.prototype.cancel=function(){this.K=!0,li(this)};function wa(y){y.T=Date.now()+y.H,qc(y,y.H)}function qc(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=fn(d(y.aa,y),R)}function Ea(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Mn.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(It(this.i,this.B),this.M!=2&&(Ce(),Dt(17)),li(this),this.m=2,wi(this)):qc(this,this.T-y)};function wi(y){y.j.I==0||y.K||fg(y.j,y)}function li(y){Ea(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,an(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function Sa(y,R){try{var j=y.j;if(j.I!=0&&(j.g==y||Aa(j.h,y))){if(!y.L&&Aa(j.h,y)&&j.I==3){try{var q=j.Ba.g.parse(R)}catch{q=null}if(Array.isArray(q)&&q.length==3){var oe=q;if(oe[0]==0){e:if(!j.v){if(j.g)if(j.g.F+3e3<y.F)Zc(j),oo(j);else break e;Il(j),Dt(18)}}else j.xa=oe[1],0<j.xa-j.K&&oe[2]<37500&&j.F&&j.A==0&&!j.C&&(j.C=fn(d(j.Va,j),6e3));Ta(j.h)<=1&&j.ta&&(j.ta=void 0)}else Na(j,11)}else if((y.L||j.g==y)&&Zc(j),!P(R))for(oe=j.Ba.g.parse(R),R=0;R<oe.length;R++){let Vt=oe[R];const hn=Vt[0];if(!(hn<=j.K))if(j.K=hn,Vt=Vt[1],j.I==2)if(Vt[0]=="c"){j.M=Vt[1],j.ba=Vt[2];const Ti=Vt[3];Ti!=null&&(j.ka=Ti,j.j.info("VER="+j.ka));const Ma=Vt[4];Ma!=null&&(j.za=Ma,j.j.info("SVER="+j.za));const Ji=Vt[5];Ji!=null&&typeof Ji=="number"&&Ji>0&&(q=1.5*Ji,j.O=q,j.j.info("backChannelRequestTimeoutMs_="+q)),q=j;const ea=y.g;if(ea){const Rl=ea.g?ea.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rl){var pe=q.h;pe.g||Rl.indexOf("spdy")==-1&&Rl.indexOf("quic")==-1&&Rl.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Zd(pe,pe.h),pe.h=null))}if(q.G){const Jc=ea.g?ea.g.getResponseHeader("X-HTTP-Session-Id"):null;Jc&&(q.wa=Jc,Gt(q.J,q.G,Jc))}}j.I=3,j.l&&j.l.ra(),j.aa&&(j.T=Date.now()-y.F,j.j.info("Handshake RTT: "+j.T+"ms")),q=j;var Re=y;if(q.na=gg(q,q.L?q.ba:null,q.W),Re.L){Jd(q.h,Re);var ft=Re,Pn=q.O;Pn&&(ft.H=Pn),ft.D&&(Ea(ft),wa(ft)),q.g=Re}else ug(q);j.i.length>0&&ka(j)}else Vt[0]!="stop"&&Vt[0]!="close"||Na(j,7);else j.I==3&&(Vt[0]=="stop"||Vt[0]=="close"?Vt[0]=="stop"?Na(j,7):cf(j):Vt[0]!="noop"&&j.l&&j.l.qa(Vt),j.A=0)}}Ce(4)}catch{}}var Fn=class{constructor(y,R){this.g=y,this.map=R}};function Wd(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qd(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Ta(y){return y.h?1:y.g?y.g.size:0}function Aa(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function Zd(y,R){y.g?y.g.add(R):y.h=R}function Jd(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}Wd.prototype.cancel=function(){if(this.i=ef(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function ef(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const j of y.g.values())R=R.concat(j.G);return R}return b(y.i)}var ig=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hc(y,R){if(y){y=y.split("&");for(let j=0;j<y.length;j++){const q=y[j].indexOf("=");let oe,pe=null;q>=0?(oe=y[j].substring(0,q),pe=y[j].substring(q+1)):oe=y[j],R(oe,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function ci(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof ci?(this.l=y.l,hr(this,y.j),this.o=y.o,this.g=y.g,eo(this,y.u),this.h=y.h,tf(this,lg(y.i)),this.m=y.m):y&&(R=String(y).match(ig))?(this.l=!1,hr(this,R[1]||"",!0),this.o=Ca(R[2]||""),this.g=Ca(R[3]||"",!0),eo(this,R[4]),this.h=Ca(R[5]||"",!0),tf(this,R[6]||"",!0),this.m=Ca(R[7]||"")):(this.l=!1,this.i=new no(null,this.l))}ci.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(wl(R,$c,!0),":");var j=this.g;return(j||R=="file")&&(y.push("//"),(R=this.o)&&y.push(wl(R,$c,!0),"@"),y.push(_n(j).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j=this.u,j!=null&&y.push(":",String(j))),(j=this.h)&&(this.g&&j.charAt(0)!="/"&&y.push("/"),y.push(wl(j,j.charAt(0)=="/"?nf:ag,!0))),(j=this.i.toString())&&y.push("?",j),(j=this.m)&&y.push("#",wl(j,sg)),y.join("")},ci.prototype.resolve=function(y){const R=Gn(this);let j=!!y.j;j?hr(R,y.j):j=!!y.o,j?R.o=y.o:j=!!y.g,j?R.g=y.g:j=y.u!=null;var q=y.h;if(j)eo(R,y.u);else if(j=!!y.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var oe=R.h.lastIndexOf("/");oe!=-1&&(q=R.h.slice(0,oe+1)+q)}if(oe=q,oe==".."||oe==".")q="";else if(oe.indexOf("./")!=-1||oe.indexOf("/.")!=-1){q=oe.lastIndexOf("/",0)==0,oe=oe.split("/");const pe=[];for(let Re=0;Re<oe.length;){const ft=oe[Re++];ft=="."?q&&Re==oe.length&&pe.push(""):ft==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),q&&Re==oe.length&&pe.push("")):(pe.push(ft),q=!0)}q=pe.join("/")}else q=oe}return j?R.h=q:j=y.i.toString()!=="",j?tf(R,lg(y.i)):j=!!y.m,j&&(R.m=y.m),R};function Gn(y){return new ci(y)}function hr(y,R,j){y.j=j?Ca(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function eo(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function tf(y,R,j){R instanceof no?(y.i=R,Kc(y.i,y.l)):(j||(R=wl(R,to)),y.i=new no(R,y.l))}function Gt(y,R,j){y.i.set(R,j)}function _l(y){return Gt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Ca(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function wl(y,R,j){return typeof y=="string"?(y=encodeURI(y).replace(R,Yr),j&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Yr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var $c=/[#\/\?@]/g,ag=/[#\?:]/g,nf=/[#\?]/g,to=/[#\?@]/g,sg=/#/g;function no(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Kr(y){y.g||(y.g=new Map,y.h=0,y.i&&Hc(y.i,function(R,j){y.add(decodeURIComponent(R.replace(/\+/g," ")),j)}))}n=no.prototype,n.add=function(y,R){Kr(this),this.i=null,y=ro(this,y);let j=this.g.get(y);return j||this.g.set(y,j=[]),j.push(R),this.h+=1,this};function og(y,R){Kr(y),R=ro(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function rf(y,R){return Kr(y),R=ro(y,R),y.g.has(R)}n.forEach=function(y,R){Kr(this),this.g.forEach(function(j,q){j.forEach(function(oe){y.call(R,oe,q,this)},this)},this)};function af(y,R){Kr(y);let j=[];if(typeof R=="string")rf(y,R)&&(j=j.concat(y.g.get(ro(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)j=j.concat(y[R]);return j}n.set=function(y,R){return Kr(this),this.i=null,y=ro(this,y),rf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},n.get=function(y,R){return y?(y=af(this,y),y.length>0?String(y[0]):R):R};function Yc(y,R,j){og(y,R),j.length>0&&(y.i=null,y.g.set(ro(y,R),b(j)),y.h+=j.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let q=0;q<R.length;q++){var j=R[q];const oe=_n(j);j=af(this,j);for(let pe=0;pe<j.length;pe++){let Re=oe;j[pe]!==""&&(Re+="="+_n(j[pe])),y.push(Re)}}return this.i=y.join("&")};function lg(y){const R=new no;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function ro(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function Kc(y,R){R&&!y.j&&(Kr(y),y.i=null,y.g.forEach(function(j,q){const oe=q.toLowerCase();q!=oe&&(og(this,q),Yc(this,oe,j))},y)),y.j=R}function Wi(y,R){const j=new on;if(o.Image){const q=new Image;q.onload=h(Ei,j,"TestLoadImage: loaded",!0,R,q),q.onerror=h(Ei,j,"TestLoadImage: error",!1,R,q),q.onabort=h(Ei,j,"TestLoadImage: abort",!1,R,q),q.ontimeout=h(Ei,j,"TestLoadImage: timeout",!1,R,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=y}else R(!1)}function sf(y,R){const j=new on,q=new AbortController,oe=setTimeout(()=>{q.abort(),Ei(j,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:q.signal}).then(pe=>{clearTimeout(oe),pe.ok?Ei(j,"TestPingServer: ok",!0,R):Ei(j,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(oe),Ei(j,"TestPingServer: error",!1,R)})}function Ei(y,R,j,q,oe){try{oe&&(oe.onload=null,oe.onerror=null,oe.onabort=null,oe.ontimeout=null),q(j)}catch{}}function io(){this.g=new ls}function Ia(y){this.i=y.Sb||null,this.h=y.ab||!1}p(Ia,_i),Ia.prototype.g=function(){return new El(this.i,this.h)};function El(y,R){Ne.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(El,Ne),n=El.prototype,n.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,Qi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||o).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Qi(this)),this.g&&(this.readyState=3,Qi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?ao(this):Qi(this),this.readyState==3&&Xc(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,ao(this))},n.Na=function(y){this.g&&(this.response=y,ao(this))},n.ga=function(){this.g&&ao(this)};function ao(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Qi(y)}n.setRequestHeader=function(y,R){this.A.append(y,R)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var j=R.next();!j.done;)j=j.value,y.push(j[0]+": "+j[1]),j=R.next();return y.join(`\r
`)};function Qi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(El.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Si(y){let R="";return de(y,function(j,q){R+=q,R+=":",R+=j,R+=`\r
`}),R}function Sl(y,R,j){e:{for(q in j){var q=!1;break e}q=!0}q||(j=Si(j),typeof y=="string"?j!=null&&_n(j):Gt(y,R,j))}function Kt(y){Ne.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Kt,Ne);var Ra=/^https?$/i,of=["POST","PUT"];n=Kt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,R,j,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():xt.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(pe){Tl(this,pe);return}if(y=j||"",j=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var oe in q)j.set(oe,q[oe]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const pe of q.keys())j.set(pe,q.get(pe));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(j.keys()).find(pe=>pe.toLowerCase()=="content-type"),oe=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(of,R,void 0)>=0)||q||oe||j.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,Re]of j)this.g.setRequestHeader(pe,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(pe){Tl(this,pe)}};function Tl(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,lf(y),cs(y)}function lf(y){y.A||(y.A=!0,Pe(y,"complete"),Pe(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Pe(this,"complete"),Pe(this,"abort"),cs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cs(this,!0)),Kt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Al(this):this.Xa())},n.Xa=function(){Al(this)};function Al(y){if(y.h&&typeof a<"u"){if(y.v&&Zi(y)==4)setTimeout(y.Ca.bind(y),0);else if(Pe(y,"readystatechange"),Zi(y)==4){y.h=!1;try{const pe=y.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var j;if(!(j=R)){var q;if(q=pe===0){let Re=String(y.D).match(ig)[1]||null;!Re&&o.self&&o.self.location&&(Re=o.self.location.protocol.slice(0,-1)),q=!Ra.test(Re?Re.toLowerCase():"")}j=q}if(j)Pe(y,"complete"),Pe(y,"success");else{y.o=6;try{var oe=Zi(y)>2?y.g.statusText:""}catch{oe=""}y.l=oe+" ["+y.ca()+"]",lf(y)}}finally{cs(y)}}}}function cs(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const j=y.g;y.g=null,R||Pe(y,"ready");try{j.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Zi(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Zi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),Or(R)}};function mr(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function us(y){const R={};y=(y.g&&Zi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<y.length;q++){if(P(y[q]))continue;var j=xa(y[q]);const oe=j[0];if(j=j[1],typeof j!="string")continue;j=j.trim();const pe=R[oe]||[];R[oe]=pe,pe.push(j)}te(R,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Da(y,R,j){return j&&j.internalChannelParams&&j.internalChannelParams[y]||R}function so(y){this.za=0,this.i=[],this.j=new on,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Da("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Da("baseRetryDelayMs",5e3,y),this.Za=Da("retryDelaySeedMs",1e4,y),this.Ta=Da("forwardChannelMaxRetries",2,y),this.va=Da("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Wd(y&&y.concurrentRequestLimit),this.Ba=new io,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=so.prototype,n.ka=8,n.I=1,n.connect=function(y,R,j,q){Dt(0),this.W=y,this.H=R||{},j&&q!==void 0&&(this.H.OSID=j,this.H.OAID=q),this.F=this.X,this.J=gg(this,null,this.W),ka(this)};function cf(y){if(Wc(y),y.I==3){var R=y.V++,j=Gn(y.J);if(Gt(j,"SID",y.M),Gt(j,"RID",R),Gt(j,"TYPE","terminate"),Cl(y,j),R=new Mn(y,y.j,R),R.M=2,R.A=_l(Gn(j)),j=!1,o.navigator&&o.navigator.sendBeacon)try{j=o.navigator.sendBeacon(R.A.toString(),"")}catch{}!j&&o.Image&&(new Image().src=R.A,j=!0),j||(R.g=mg(R.j,null),R.g.ea(R.A)),R.F=Date.now(),wa(R)}pg(y)}function oo(y){y.g&&(df(y),y.g.cancel(),y.g=null)}function Wc(y){oo(y),y.v&&(o.clearTimeout(y.v),y.v=null),Zc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function ka(y){if(!Qd(y.h)&&!y.m){y.m=!0;var R=y.Ea;M||I(),V||(M(),V=!0),A.add(R,y),y.D=0}}function Qc(y,R){return Ta(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=fn(d(y.Ea,y,R),hg(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const oe=new Mn(this,this.j,y);let pe=this.o;if(this.U&&(pe?(pe=G(pe),Z(pe,this.U)):pe=this.U),this.u!==null||this.R||(oe.J=pe,pe=null),this.S)e:{for(var R=0,j=0;j<this.i.length;j++){t:{var q=this.i[j];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(R+=q,R>4096){R=j;break e}if(R===4096||j===this.i.length-1){R=j+1;break e}}R=1e3}else R=1e3;R=cg(this,oe,R),j=Gn(this.J),Gt(j,"RID",y),Gt(j,"CVER",22),this.G&&Gt(j,"X-HTTP-Session-Id",this.G),Cl(this,j),pe&&(this.R?R="headers="+_n(Si(pe))+"&"+R:this.u&&Sl(j,this.u,pe)),Zd(this.h,oe),this.Ra&&Gt(j,"TYPE","init"),this.S?(Gt(j,"$req",R),Gt(j,"SID","null"),oe.U=!0,_a(oe,j,null)):_a(oe,j,R),this.I=2}}else this.I==3&&(y?uf(this,y):this.i.length==0||Qd(this.h)||uf(this))};function uf(y,R){var j;R?j=R.l:j=y.V++;const q=Gn(y.J);Gt(q,"SID",y.M),Gt(q,"RID",j),Gt(q,"AID",y.K),Cl(y,q),y.u&&y.o&&Sl(q,y.u,y.o),j=new Mn(y,y.j,j,y.D+1),y.u===null&&(j.J=y.o),R&&(y.i=R.G.concat(y.i)),R=cg(y,j,1e3),j.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Zd(y.h,j),_a(j,q,R)}function Cl(y,R){y.H&&de(y.H,function(j,q){Gt(R,q,j)}),y.l&&de({},function(j,q){Gt(R,q,j)})}function cg(y,R,j){j=Math.min(y.i.length,j);const q=y.l?d(y.l.Ka,y.l,y):null;e:{var oe=y.i;let ft=-1;for(;;){const Pn=["count="+j];ft==-1?j>0?(ft=oe[0].g,Pn.push("ofs="+ft)):ft=0:Pn.push("ofs="+ft);let Vt=!0;for(let hn=0;hn<j;hn++){var pe=oe[hn].g;const Ti=oe[hn].map;if(pe-=ft,pe<0)ft=Math.max(0,oe[hn].g-100),Vt=!1;else try{pe="req"+pe+"_"||"";try{var Re=Ti instanceof Map?Ti:Object.entries(Ti);for(const[Ma,Ji]of Re){let ea=Ji;c(Ji)&&(ea=Bn(Ji)),Pn.push(pe+Ma+"="+encodeURIComponent(ea))}}catch(Ma){throw Pn.push(pe+"type="+encodeURIComponent("_badmap")),Ma}}catch{q&&q(Ti)}}if(Vt){Re=Pn.join("&");break e}}Re=void 0}return y=y.i.splice(0,j),R.G=y,Re}function ug(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;M||I(),V||(M(),V=!0),A.add(R,y),y.A=0}}function Il(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=fn(d(y.Da,y),hg(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,dg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=fn(d(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),oo(this),dg(this))};function df(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function dg(y){y.g=new Mn(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=Gn(y.na);Gt(R,"RID","rpc"),Gt(R,"SID",y.M),Gt(R,"AID",y.K),Gt(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&Gt(R,"TO",y.ia),Gt(R,"TYPE","xmlhttp"),Cl(y,R),y.u&&y.o&&Sl(R,y.u,y.o),y.O&&(y.g.H=y.O);var j=y.g;y=y.ba,j.M=1,j.A=_l(Gn(R)),j.u=null,j.R=!0,Gc(j,y)}n.Va=function(){this.C!=null&&(this.C=null,oo(this),Il(this),Dt(19))};function Zc(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function fg(y,R){var j=null;if(y.g==R){Zc(y),df(y),y.g=null;var q=2}else if(Aa(y.h,R))j=R.G,Jd(y.h,R),q=1;else return;if(y.I!=0){if(R.o)if(q==1){j=R.u?R.u.length:0,R=Date.now()-R.F;var oe=y.D;q=ya(),Pe(q,new Je(q,j)),ka(y)}else ug(y);else if(oe=R.m,oe==3||oe==0&&R.X>0||!(q==1&&Qc(y,R)||q==2&&Il(y)))switch(j&&j.length>0&&(R=y.h,R.i=R.i.concat(j)),oe){case 1:Na(y,5);break;case 4:Na(y,10);break;case 3:Na(y,6);break;default:Na(y,2)}}}function hg(y,R){let j=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(j*=2),j*R}function Na(y,R){if(y.j.info("Error code "+R),R==2){var j=d(y.bb,y),q=y.Ua;const oe=!q;q=new ci(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||hr(q,"https"),_l(q),oe?Wi(q.toString(),j):sf(q.toString(),j)}else Dt(2);y.I=0,y.l&&y.l.pa(R),pg(y),Wc(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function pg(y){if(y.I=0,y.ja=[],y.l){const R=ef(y.h);(R.length!=0||y.i.length!=0)&&(_(y.ja,R),_(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function gg(y,R,j){var q=j instanceof ci?Gn(j):new ci(j);if(q.g!="")R&&(q.g=R+"."+q.g),eo(q,q.u);else{var oe=o.location;q=oe.protocol,R=R?R+"."+oe.hostname:oe.hostname,oe=+oe.port;const pe=new ci(null);q&&hr(pe,q),R&&(pe.g=R),oe&&eo(pe,oe),j&&(pe.h=j),q=pe}return j=y.G,R=y.wa,j&&R&&Gt(q,j,R),Gt(q,"VER",y.ka),Cl(y,q),q}function mg(y,R,j){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new Kt(new Ia({ab:j})):new Kt(y.ma),R.Fa(y.L),R}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function vg(){}n=vg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function lo(){}lo.prototype.g=function(y,R){return new zr(y,R)};function zr(y,R){Ne.call(this),this.g=new so(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!P(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!P(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new ds(this)}p(zr,Ne),zr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},zr.prototype.close=function(){cf(this.g)},zr.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var j={};j.__data__=y,y=j}else this.v&&(j={},j.__data__=Bn(y),y=j);R.i.push(new Fn(R.Ya++,y)),R.I==3&&ka(R)},zr.prototype.N=function(){this.g.l=null,delete this.j,cf(this.g),delete this.g,zr.Z.N.call(this)};function yg(y){An.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const j in R){y=j;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(yg,An);function bg(){dr.call(this),this.status=1}p(bg,dr);function ds(y){this.g=y}p(ds,vg),ds.prototype.ra=function(){Pe(this.g,"a")},ds.prototype.qa=function(y){Pe(this.g,new yg(y))},ds.prototype.pa=function(y){Pe(this.g,new bg)},ds.prototype.oa=function(){Pe(this.g,"b")},lo.prototype.createWebChannel=lo.prototype.g,zr.prototype.send=zr.prototype.o,zr.prototype.open=zr.prototype.m,zr.prototype.close=zr.prototype.close,AM=function(){return new lo},TM=function(){return ya()},SM=sn,P1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},jt.NO_ERROR=0,jt.TIMEOUT=8,jt.HTTP_ERROR=6,i0=jt,xn.COMPLETE="complete",EM=xn,Xi.EventType=jr,jr.OPEN="a",jr.CLOSE="b",jr.ERROR="c",jr.MESSAGE="d",Ne.prototype.listen=Ne.prototype.J,sh=Xi,Kt.prototype.listenOnce=Kt.prototype.K,Kt.prototype.getLastError=Kt.prototype.Ha,Kt.prototype.getLastErrorCode=Kt.prototype.ya,Kt.prototype.getStatus=Kt.prototype.ca,Kt.prototype.getResponseJson=Kt.prototype.La,Kt.prototype.getResponseText=Kt.prototype.la,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Fa,wM=Kt}).apply(typeof Cm<"u"?Cm:typeof self<"u"?self:typeof window<"u"?window:{});const uI="@firebase/firestore",dI="4.9.2";class Er{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Er.UNAUTHENTICATED=new Er(null),Er.GOOGLE_CREDENTIALS=new Er("google-credentials-uid"),Er.FIRST_PARTY=new Er("first-party-uid"),Er.MOCK_USER=new Er("mock-user");let Vd="12.3.0";const Sc=new dw("@firebase/firestore");function ju(){return Sc.logLevel}function Te(n,...e){if(Sc.logLevel<=At.DEBUG){const t=e.map(ww);Sc.debug(`Firestore (${Vd}): ${n}`,...t)}}function Fr(n,...e){if(Sc.logLevel<=At.ERROR){const t=e.map(ww);Sc.error(`Firestore (${Vd}): ${n}`,...t)}}function Tc(n,...e){if(Sc.logLevel<=At.WARN){const t=e.map(ww);Sc.warn(`Firestore (${Vd}): ${n}`,...t)}}function ww(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ve(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,CM(n,r,t)}function CM(n,e,t){let r=`FIRESTORE (${Vd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Fr(r),new Error(r)}function Ue(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||CM(e,i,r)}function ct(n,e){return n}const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends Ks{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Wa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class IM{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Er.UNAUTHENTICATED)))}shutdown(){}}class zF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class LF{constructor(e){this.t=e,this.currentUser=Er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ue(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new Wa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Wa,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Wa)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue(typeof r.accessToken=="string",31837,{l:r}),new IM(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string",2055,{h:e}),new Er(e)}}class BF{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Er.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class UF{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new BF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Er.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class FF{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ue(this.o===void 0,3512);const r=a=>{a.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ue(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new fI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function GF(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Ew{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=GF(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function ot(n,e){return n<e?-1:n>e?1:0}function O1(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Rx(i)===Rx(a)?ot(i,a):Rx(i)?1:-1}return ot(n.length,e.length)}const qF=55296,HF=57343;function Rx(n){const e=n.charCodeAt(0);return e>=qF&&e<=HF}function ud(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function RM(n){return n+"\0"}const hI="__name__";class La{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ve(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ve(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return La.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof La?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=La.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return ot(e.length,t.length)}static compareSegments(e,t){const r=La.isNumericId(e),i=La.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?La.extractNumericId(e).compare(La.extractNumericId(t)):O1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Jo.fromString(e.substring(4,e.length-2))}}class Lt extends La{construct(e,t,r){return new Lt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ie(me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Lt(t)}static emptyPath(){return new Lt([])}}const $F=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class En extends La{construct(e,t,r){return new En(e,t,r)}static isValidIdentifier(e){return $F.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),En.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hI}static keyField(){return new En([hI])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Ie(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ie(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ie(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Ie(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new En(t)}static emptyPath(){return new En([])}}class De{constructor(e){this.path=e}static fromPath(e){return new De(Lt.fromString(e))}static fromName(e){return new De(Lt.fromString(e).popFirst(5))}static empty(){return new De(Lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Lt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Lt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new Lt(e.slice()))}}function DM(n,e,t){if(!t)throw new Ie(me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function YF(n,e,t,r){if(e===!0&&r===!0)throw new Ie(me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pI(n){if(!De.isDocumentKey(n))throw new Ie(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function gI(n){if(De.isDocumentKey(n))throw new Ie(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function kM(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Cv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ve(12329,{type:typeof n})}function kr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Cv(n);throw new Ie(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Zn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ap(n,e){if(!kM(n))throw new Ie(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Ie(me.INVALID_ARGUMENT,t);return!0}const mI=-62135596800,vI=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*vI);return new vt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<mI)throw new Ie(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vI}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ap(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-mI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Zn("string",vt._jsonSchemaVersion),seconds:Zn("number"),nanoseconds:Zn("number")};class Ke{static fromTimestamp(e){return new Ke(e)}static min(){return new Ke(new vt(0,0))}static max(){return new Ke(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const qh=-1;class O0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function j1(n){return n.fields.find((e=>e.kind===2))}function Xl(n){return n.fields.filter((e=>e.kind!==2))}O0.UNKNOWN_ID=-1;class a0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Hh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Hh(0,bi.min())}}function KF(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ke.fromTimestamp(r===1e9?new vt(t+1,0):new vt(t,r));return new bi(i,De.empty(),e)}function NM(n){return new bi(n.readTime,n.key,qh)}class bi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new bi(Ke.min(),De.empty(),qh)}static max(){return new bi(Ke.max(),De.empty(),qh)}}function Sw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=De.comparator(n.documentKey,e.documentKey),t!==0?t:ot(n.largestBatchId,e.largestBatchId))}const MM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Lc(n){if(n.code!==me.FAILED_PRECONDITION||n.message!==MM)throw n;Te("LocalStore","Unexpectedly lost primary lease")}class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,r)=>{t(e)}))}static reject(e){return new ae(((t,r)=>{r(e)}))}static waitFor(e){return new ae(((t,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&t()}),(u=>r(u)))})),o=!0,a===i&&t()}))}static or(e){let t=ae.resolve(!1);for(const r of e)t=t.next((i=>i?ae.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new ae(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new ae(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const vi="SimpleDb";class Iv{static open(e,t,r,i){try{return new Iv(t,e.transaction(i,r))}catch(a){throw new bh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Wa,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new bh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Tw(r.target.error);this.S.reject(new bh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Te(vi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new WF(t)}}class el{static delete(e){return Te(vi,"Removing database:",e),Jl(EN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!NN())return!1;if(el.F())return!0;const e=cr(),t=el.M(e),r=0<t&&t<10,i=OM(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,el.M(cr())===12.2&&Fr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Te(vi,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;t(o)},i.onblocked=()=>{r(new bh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new Ie(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Ie(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new bh(e,o))},i.onupgradeneeded=a=>{Te(vi,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Te(vi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Iv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),ae.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Te(vi,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function OM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class XF{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Jl(this.U.delete())}}class bh extends Ie{constructor(e,t){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function gl(n){return n.name==="IndexedDbTransactionError"}class WF{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Te(vi,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Te(vi,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Jl(r)}add(e){return Te(vi,"ADD",this.store.name,e,e),Jl(this.store.add(e))}get(e){return Jl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Te(vi,"GET",this.store.name,e,t),t)))}delete(e){return Te(vi,"DELETE",this.store.name,e),Jl(this.store.delete(e))}count(){return Te(vi,"COUNT",this.store.name),Jl(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new ae(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new ae(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){Te(vi,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new ae(((r,i)=>{t.onerror=a=>{const o=Tw(a.target.error);i(o)},t.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){const r=[];return new ae(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new XF(c),d=t(c.primaryKey,c.value,u);if(d instanceof ae){const h=d.catch((p=>(u.done(),ae.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>ae.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Jl(n){return new ae(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Tw(r.target.error);t(i)}}))}let yI=!1;function Tw(n){const e=el.M(cr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yI||(yI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const xh="IndexBackfiller";class QF{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Te(xh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Te(xh,`Documents written: ${t}`)}catch(t){gl(t)?Te(xh,"Ignoring IndexedDB error during index backfill: ",t):await Lc(t)}await this.re(6e4)}))}}class ZF{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return ae.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Te(xh,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Te(xh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const o=NM(a);Sw(o,r)>0&&(r=o)})),new bi(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Bi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Bi.ce=-1;const hc=-1;function Rv(n){return n==null}function $h(n){return n===0&&1/n==-1/0}function JF(n){return typeof n=="number"&&Number.isInteger(n)&&!$h(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const j0="";function Nr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=bI(e)),e=e7(n.get(t),e);return bI(e)}function e7(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case j0:t+="";break;default:t+=a}}return t}function bI(n){return n+j0+""}function qa(n){const e=n.length;if(Ue(e>=2,64408,{path:n}),e===2)return Ue(n.charAt(0)===j0&&n.charAt(1)==="",56145,{path:n}),Lt.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const o=n.indexOf(j0,a);switch((o<0||o>t)&&Ve(50515,{path:n}),n.charAt(o+1)){case"":const c=n.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,o),i+="\0";break;case"":i+=n.substring(a,o+1);break;default:Ve(61167,{path:n})}a=o+2}return new Lt(r)}const Wl="remoteDocuments",Cp="owner",Ru="owner",Yh="mutationQueues",t7="userId",aa="mutations",xI="batchId",oc="userMutationsIndex",_I=["userId","batchId"];function s0(n,e){return[n,Nr(e)]}function jM(n,e,t){return[n,Nr(e),t]}const n7={},dd="documentMutations",V0="remoteDocumentsV14",r7=["prefixPath","collectionGroup","readTime","documentId"],o0="documentKeyIndex",i7=["prefixPath","collectionGroup","documentId"],VM="collectionGroupIndex",a7=["collectionGroup","readTime","prefixPath","documentId"],Kh="remoteDocumentGlobal",V1="remoteDocumentGlobalKey",fd="targets",zM="queryTargetsIndex",s7=["canonicalId","targetId"],hd="targetDocuments",o7=["targetId","path"],Aw="documentTargetsIndex",l7=["path","targetId"],z0="targetGlobalKey",pc="targetGlobal",Xh="collectionParents",c7=["collectionId","parent"],pd="clientMetadata",u7="clientId",Dv="bundles",d7="bundleId",kv="namedQueries",f7="name",Cw="indexConfiguration",h7="indexId",z1="collectionGroupIndex",p7="collectionGroup",_h="indexState",g7=["indexId","uid"],LM="sequenceNumberIndex",m7=["uid","sequenceNumber"],wh="indexEntries",v7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],BM="documentKeyIndex",y7=["indexId","uid","orderedDocumentKey"],Nv="documentOverlays",b7=["userId","collectionPath","documentId"],L1="collectionPathOverlayIndex",x7=["userId","collectionPath","largestBatchId"],UM="collectionGroupOverlayIndex",_7=["userId","collectionGroup","largestBatchId"],Iw="globals",w7="name",FM=[Yh,aa,dd,Wl,fd,Cp,pc,hd,pd,Kh,Xh,Dv,kv],E7=[...FM,Nv],GM=[Yh,aa,dd,V0,fd,Cp,pc,hd,pd,Kh,Xh,Dv,kv,Nv],qM=GM,Rw=[...qM,Cw,_h,wh],S7=Rw,HM=[...Rw,Iw],T7=HM;class B1 extends PM{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ur(n,e){const t=ct(n);return el.O(t.le,e)}function wI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ml(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $M(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class yn{constructor(e,t){this.comparator=e,this.root=t||Sr.EMPTY}insert(e,t){return new yn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Sr.BLACK,null,null))}remove(e){return new yn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Im(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Im(this.root,e,this.comparator,!1)}getReverseIterator(){return new Im(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Im(this.root,e,this.comparator,!0)}}class Im{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sr{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Sr.RED,this.left=i??Sr.EMPTY,this.right=a??Sr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Sr(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Sr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Sr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}Sr.EMPTY=null,Sr.RED=!0,Sr.BLACK=!1;Sr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new Sr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Yt{constructor(e){this.comparator=e,this.data=new yn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new EI(this.data.getIterator())}getIteratorFrom(e){return new EI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Yt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Yt(this.comparator);return t.data=e,t}}class EI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Du(n){return n.hasNext()?n.getNext():void 0}class ti{constructor(e){this.fields=e,e.sort(En.comparator)}static empty(){return new ti([])}unionWith(e){let t=new Yt(En.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ti(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ud(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class YM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new YM("Invalid base64 string: "+a):a}})(e);return new Jn(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const A7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(n){if(Ue(!!n,39018),typeof n=="string"){let e=0;const t=A7.exec(n);if(Ue(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mn(n.seconds),nanos:mn(n.nanos)}}function mn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Us(n){return typeof n=="string"?Jn.fromBase64String(n):Jn.fromUint8Array(n)}const KM="server_timestamp",XM="__type__",WM="__previous_value__",QM="__local_write_time__";function Dw(n){return(n?.mapValue?.fields||{})[XM]?.stringValue===KM}function Mv(n){const e=n.mapValue.fields[WM];return Dw(e)?Mv(e):e}function Wh(n){const e=Bs(n.mapValue.fields[QM].timestampValue);return new vt(e.seconds,e.nanos)}class C7{constructor(e,t,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const L0="(default)";class Ac{constructor(e,t){this.projectId=e,this.database=t||L0}static empty(){return new Ac("","")}get isDefaultDatabase(){return this.database===L0}isEqual(e){return e instanceof Ac&&e.projectId===this.projectId&&e.database===this.database}}const kw="__type__",ZM="__max__",$o={mapValue:{fields:{__type__:{stringValue:ZM}}}},Nw="__vector__",gd="value",l0={nullValue:"NULL_VALUE"};function il(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Dw(n)?4:JM(n)?9007199254740991:Pv(n)?10:11:Ve(28295,{value:n})}function ns(n,e){if(n===e)return!0;const t=il(n);if(t!==il(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Wh(n).isEqual(Wh(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Bs(i.timestampValue),c=Bs(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return Us(i.bytesValue).isEqual(Us(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return mn(i.geoPointValue.latitude)===mn(a.geoPointValue.latitude)&&mn(i.geoPointValue.longitude)===mn(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return mn(i.integerValue)===mn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=mn(i.doubleValue),c=mn(a.doubleValue);return o===c?$h(o)===$h(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return ud(n.arrayValue.values||[],e.arrayValue.values||[],ns);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(wI(o)!==wI(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!ns(o[u],c[u])))return!1;return!0})(n,e);default:return Ve(52216,{left:n})}}function Qh(n,e){return(n.values||[]).find((t=>ns(t,e)))!==void 0}function al(n,e){if(n===e)return 0;const t=il(n),r=il(e);if(t!==r)return ot(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ot(n.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=mn(a.integerValue||a.doubleValue),u=mn(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return SI(n.timestampValue,e.timestampValue);case 4:return SI(Wh(n),Wh(e));case 5:return O1(n.stringValue,e.stringValue);case 6:return(function(a,o){const c=Us(a),u=Us(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=ot(c[d],u[d]);if(h!==0)return h}return ot(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=ot(mn(a.latitude),mn(o.latitude));return c!==0?c:ot(mn(a.longitude),mn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return TI(n.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[gd]?.arrayValue,h=u[gd]?.arrayValue,p=ot(d?.values?.length||0,h?.values?.length||0);return p!==0?p:TI(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,o){if(a===$o.mapValue&&o===$o.mapValue)return 0;if(a===$o.mapValue)return 1;if(o===$o.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=O1(u[p],h[p]);if(m!==0)return m;const b=al(c[u[p]],d[h[p]]);if(b!==0)return b}return ot(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Ve(23264,{he:t})}}function SI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ot(n,e);const t=Bs(n),r=Bs(e),i=ot(t.seconds,r.seconds);return i!==0?i:ot(t.nanos,r.nanos)}function TI(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=al(t[i],r[i]);if(a)return a}return ot(t.length,r.length)}function md(n){return U1(n)}function U1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Bs(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Us(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return De.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=U1(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${U1(t.fields[o])}`;return i+"}"})(n.mapValue):Ve(61005,{value:n})}function c0(n){switch(il(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Mv(n);return e?16+c0(e):16;case 5:return 2*n.stringValue.length;case 6:return Us(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+c0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ml(r.fields,((a,o)=>{i+=a.length+c0(o)})),i})(n.mapValue);default:throw Ve(13486,{value:n})}}function Zh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function F1(n){return!!n&&"integerValue"in n}function Jh(n){return!!n&&"arrayValue"in n}function AI(n){return!!n&&"nullValue"in n}function CI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function u0(n){return!!n&&"mapValue"in n}function Pv(n){return(n?.mapValue?.fields||{})[kw]?.stringValue===Nw}function Eh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ml(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Eh(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Eh(n.arrayValue.values[t]);return e}return{...n}}function JM(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===ZM}const eP={mapValue:{fields:{[kw]:{stringValue:Nw},[gd]:{arrayValue:{}}}}};function I7(n){return"nullValue"in n?l0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Zh(Ac.empty(),De.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Pv(n)?eP:{mapValue:{}}:Ve(35942,{value:n})}function R7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Zh(Ac.empty(),De.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?eP:"mapValue"in n?Pv(n)?{mapValue:{}}:$o:Ve(61959,{value:n})}function II(n,e){const t=al(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function RI(n,e){const t=al(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Rr{constructor(e){this.value=e}static empty(){return new Rr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!u0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Eh(t)}setAll(e){let t=En.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=Eh(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());u0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ns(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];u0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ml(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Rr(Eh(this.value))}}function tP(n){const e=[];return ml(n.fields,((t,r)=>{const i=new En([t]);if(u0(r)){const a=tP(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new ti(e)}class Dn{constructor(e,t,r,i,a,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Dn(e,0,Ke.min(),Ke.min(),Ke.min(),Rr.empty(),0)}static newFoundDocument(e,t,r,i){return new Dn(e,1,t,Ke.min(),r,i,0)}static newNoDocument(e,t){return new Dn(e,2,t,Ke.min(),Ke.min(),Rr.empty(),0)}static newUnknownDocument(e,t){return new Dn(e,3,t,Ke.min(),Ke.min(),Rr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class vd{constructor(e,t){this.position=e,this.inclusive=t}}function DI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],o=n.position[i];if(a.field.isKeyField()?r=De.comparator(De.fromName(o.referenceValue),t.key):r=al(o,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function kI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ns(n.position[t],e.position[t]))return!1;return!0}class ep{constructor(e,t="asc"){this.field=e,this.dir=t}}function D7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class nP{}class Ct extends nP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new k7(e,t,r):t==="array-contains"?new P7(e,r):t==="in"?new lP(e,r):t==="not-in"?new O7(e,r):t==="array-contains-any"?new j7(e,r):new Ct(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new N7(e,r):new M7(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(al(t,this.value)):t!==null&&il(this.value)===il(t)&&this.matchesComparison(al(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $t extends nP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new $t(e,t)}matches(e){return yd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function yd(n){return n.op==="and"}function G1(n){return n.op==="or"}function Mw(n){return rP(n)&&yd(n)}function rP(n){for(const e of n.filters)if(e instanceof $t)return!1;return!0}function q1(n){if(n instanceof Ct)return n.field.canonicalString()+n.op.toString()+md(n.value);if(Mw(n))return n.filters.map((e=>q1(e))).join(",");{const e=n.filters.map((t=>q1(t))).join(",");return`${n.op}(${e})`}}function iP(n,e){return n instanceof Ct?(function(r,i){return i instanceof Ct&&r.op===i.op&&r.field.isEqual(i.field)&&ns(r.value,i.value)})(n,e):n instanceof $t?(function(r,i){return i instanceof $t&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&iP(o,i.filters[c])),!0):!1})(n,e):void Ve(19439)}function aP(n,e){const t=n.filters.concat(e);return $t.create(t,n.op)}function sP(n){return n instanceof Ct?(function(t){return`${t.field.canonicalString()} ${t.op} ${md(t.value)}`})(n):n instanceof $t?(function(t){return t.op.toString()+" {"+t.getFilters().map(sP).join(" ,")+"}"})(n):"Filter"}class k7 extends Ct{constructor(e,t,r){super(e,t,r),this.key=De.fromName(r.referenceValue)}matches(e){const t=De.comparator(e.key,this.key);return this.matchesComparison(t)}}class N7 extends Ct{constructor(e,t){super(e,"in",t),this.keys=oP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class M7 extends Ct{constructor(e,t){super(e,"not-in",t),this.keys=oP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function oP(n,e){return(e.arrayValue?.values||[]).map((t=>De.fromName(t.referenceValue)))}class P7 extends Ct{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jh(t)&&Qh(t.arrayValue,this.value)}}class lP extends Ct{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Qh(this.value.arrayValue,t)}}class O7 extends Ct{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qh(this.value.arrayValue,t)}}class j7 extends Ct{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Qh(this.value.arrayValue,r)))}}class V7{constructor(e,t=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function H1(n,e=null,t=[],r=[],i=null,a=null,o=null){return new V7(n,e,t,r,i,a,o)}function Cc(n){const e=ct(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>q1(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Rv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>md(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>md(r))).join(",")),e.Te=t}return e.Te}function Ip(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!D7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!iP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!kI(n.startAt,e.startAt)&&kI(n.endAt,e.endAt)}function B0(n){return De.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function U0(n,e){return n.filters.filter((t=>t instanceof Ct&&t.field.isEqual(e)))}function NI(n,e,t){let r=l0,i=!0;for(const a of U0(n,e)){let o=l0,c=!0;switch(a.op){case"<":case"<=":o=I7(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=l0}II({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];II({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function MI(n,e,t){let r=$o,i=!0;for(const a of U0(n,e)){let o=$o,c=!0;switch(a.op){case">=":case">":o=R7(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=$o}RI({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];RI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class zd{constructor(e,t=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function z7(n,e,t,r,i,a,o,c){return new zd(n,e,t,r,i,a,o,c)}function Rp(n){return new zd(n)}function PI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cP(n){return n.collectionGroup!==null}function Sh(n){const e=ct(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Yt(En.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new ep(a,r))})),t.has(En.keyField().canonicalString())||e.Ie.push(new ep(En.keyField(),r))}return e.Ie}function Fi(n){const e=ct(n);return e.Ee||(e.Ee=L7(e,Sh(n))),e.Ee}function L7(n,e){if(n.limitType==="F")return H1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new ep(i.field,a)}));const t=n.endAt?new vd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new vd(n.startAt.position,n.startAt.inclusive):null;return H1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function $1(n,e){const t=n.filters.concat([e]);return new zd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function F0(n,e,t){return new zd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ov(n,e){return Ip(Fi(n),Fi(e))&&n.limitType===e.limitType}function uP(n){return`${Cc(Fi(n))}|lt:${n.limitType}`}function Vu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>sP(i))).join(", ")}]`),Rv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>md(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>md(i))).join(",")),`Target(${r})`})(Fi(n))}; limitType=${n.limitType})`}function Dp(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):De.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of Sh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=DI(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,Sh(r),i)||r.endAt&&!(function(o,c,u){const d=DI(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,Sh(r),i))})(n,e)}function B7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function dP(n){return(e,t)=>{let r=!1;for(const i of Sh(n)){const a=U7(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function U7(n,e,t){const r=n.field.isKeyField()?De.comparator(e.key,t.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?al(u,d):Ve(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ve(19790,{direction:n.dir})}}class Ws{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ml(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return $M(this.inner)}size(){return this.innerSize}}const F7=new yn(De.comparator);function yi(){return F7}const fP=new yn(De.comparator);function oh(...n){let e=fP;for(const t of n)e=e.insert(t.key,t);return e}function hP(n){let e=fP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ha(){return Th()}function pP(){return Th()}function Th(){return new Ws((n=>n.toString()),((n,e)=>n.isEqual(e)))}const G7=new yn(De.comparator),q7=new Yt(De.comparator);function yt(...n){let e=q7;for(const t of n)e=e.add(t);return e}const H7=new Yt(ot);function $7(){return H7}function Pw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$h(e)?"-0":e}}function gP(n){return{integerValue:""+n}}function Y7(n,e){return JF(e)?gP(e):Pw(n,e)}class jv{constructor(){this._=void 0}}function K7(n,e,t){return n instanceof tp?(function(i,a){const o={fields:{[XM]:{stringValue:KM},[QM]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Dw(a)&&(a=Mv(a)),a&&(o.fields[WM]=a),{mapValue:o}})(t,e):n instanceof Ic?vP(n,e):n instanceof bd?yP(n,e):(function(i,a){const o=mP(i,a),c=OI(o)+OI(i.Ae);return F1(o)&&F1(i.Ae)?gP(c):Pw(i.serializer,c)})(n,e)}function X7(n,e,t){return n instanceof Ic?vP(n,e):n instanceof bd?yP(n,e):t}function mP(n,e){return n instanceof np?(function(r){return F1(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class tp extends jv{}class Ic extends jv{constructor(e){super(),this.elements=e}}function vP(n,e){const t=bP(e);for(const r of n.elements)t.some((i=>ns(i,r)))||t.push(r);return{arrayValue:{values:t}}}class bd extends jv{constructor(e){super(),this.elements=e}}function yP(n,e){let t=bP(e);for(const r of n.elements)t=t.filter((i=>!ns(i,r)));return{arrayValue:{values:t}}}class np extends jv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function OI(n){return mn(n.integerValue||n.doubleValue)}function bP(n){return Jh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class xP{constructor(e,t){this.field=e,this.transform=t}}function W7(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Ic&&i instanceof Ic||r instanceof bd&&i instanceof bd?ud(r.elements,i.elements,ns):r instanceof np&&i instanceof np?ns(r.Ae,i.Ae):r instanceof tp&&i instanceof tp})(n.transform,e.transform)}class Q7{constructor(e,t){this.version=e,this.transformResults=t}}class lr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new lr}static exists(e){return new lr(void 0,e)}static updateTime(e){return new lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function d0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Vv{}function _P(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new kp(n.key,lr.none()):new Ld(n.key,n.data,lr.none());{const t=n.data,r=Rr.empty();let i=new Yt(En.comparator);for(let a of e.fields)if(!i.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Qs(n.key,r,new ti(i.toArray()),lr.none())}}function Z7(n,e,t){n instanceof Ld?(function(i,a,o){const c=i.value.clone(),u=VI(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Qs?(function(i,a,o){if(!d0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=VI(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(wP(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Ah(n,e,t,r){return n instanceof Ld?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=a.value.clone(),h=zI(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Qs?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=zI(a.fieldTransforms,u,o),h=o.data;return h.setAll(wP(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,o,c){return d0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function J7(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=mP(r.transform,i||null);a!=null&&(t===null&&(t=Rr.empty()),t.set(r.field,a))}return t||null}function jI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ud(r,i,((a,o)=>W7(a,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ld extends Vv{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Qs extends Vv{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function wP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function VI(n,e,t){const r=new Map;Ue(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,X7(o,c,t[i]))}return r}function zI(n,e,t){const r=new Map;for(const i of n){const a=i.transform,o=t.data.field(i.field);r.set(i.field,K7(a,o,e))}return r}class kp extends Vv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class EP extends Vv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ow{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&Z7(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ah(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Ah(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=pP();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(i.key)?null:c;const u=_P(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Ke.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),yt())}isEqual(e){return this.batchId===e.batchId&&ud(this.mutations,e.mutations,((t,r)=>jI(t,r)))&&ud(this.baseMutations,e.baseMutations,((t,r)=>jI(t,r)))}}class jw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ue(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return G7})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new jw(e,t,r,i)}}class Vw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class eG{constructor(e,t){this.count=e,this.unchangedNames=t}}var Xn,kt;function tG(n){switch(n){case me.OK:return Ve(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Ve(15467,{code:n})}}function SP(n){if(n===void 0)return Fr("GRPC error has no .code"),me.UNKNOWN;switch(n){case Xn.OK:return me.OK;case Xn.CANCELLED:return me.CANCELLED;case Xn.UNKNOWN:return me.UNKNOWN;case Xn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case Xn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case Xn.INTERNAL:return me.INTERNAL;case Xn.UNAVAILABLE:return me.UNAVAILABLE;case Xn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case Xn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case Xn.NOT_FOUND:return me.NOT_FOUND;case Xn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case Xn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case Xn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case Xn.ABORTED:return me.ABORTED;case Xn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case Xn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case Xn.DATA_LOSS:return me.DATA_LOSS;default:return Ve(39323,{code:n})}}(kt=Xn||(Xn={}))[kt.OK=0]="OK",kt[kt.CANCELLED=1]="CANCELLED",kt[kt.UNKNOWN=2]="UNKNOWN",kt[kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kt[kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kt[kt.NOT_FOUND=5]="NOT_FOUND",kt[kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",kt[kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",kt[kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",kt[kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kt[kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kt[kt.ABORTED=10]="ABORTED",kt[kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",kt[kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",kt[kt.INTERNAL=13]="INTERNAL",kt[kt.UNAVAILABLE=14]="UNAVAILABLE",kt[kt.DATA_LOSS=15]="DATA_LOSS";function nG(){return new TextEncoder}const rG=new Jo([4294967295,4294967295],0);function LI(n){const e=nG().encode(n),t=new _M;return t.update(e),new Uint8Array(t.digest())}function BI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Jo([t,r],0),new Jo([i,a],0)]}class zw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new lh(`Invalid padding: ${t}`);if(r<0)throw new lh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new lh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new lh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Jo.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Jo.fromNumber(r)));return i.compare(rG)===1&&(i=new Jo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=LI(e),[r,i]=BI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new zw(a,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=LI(e),[r,i]=BI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class lh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class zv{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Np.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new zv(Ke.min(),i,new yn(ot),yi(),yt())}}class Np{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Np(r,t,yt(),yt(),yt())}}class f0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class TP{constructor(e,t){this.targetId=e,this.Ce=t}}class AP{constructor(e,t,r=Jn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class UI{constructor(){this.ve=0,this.Fe=FI(),this.Me=Jn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=yt(),t=yt(),r=yt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ve(38017,{changeType:a})}})),new Np(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=FI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ue(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class iG{constructor(e){this.Ge=e,this.ze=new Map,this.je=yi(),this.Je=Rm(),this.He=Rm(),this.Ye=new yn(ot)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(B0(a))if(r===0){const o=new De(a.path);this.et(t,o,Dn.newNoDocument(o,Ke.min()))}else Ue(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let o,c;try{o=Us(r).toUint8Array()}catch(u){if(u instanceof YM)return Tc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new zw(o,i,a)}catch(u){return Tc(u instanceof lh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&B0(c.target)){const u=new De(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Dn.newNoDocument(u,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let r=yt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new zv(e,t,this.Ye,this.je,r);return this.je=yi(),this.Je=Rm(),this.He=Rm(),this.Ye=new yn(ot),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new UI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Yt(ot),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Yt(ot),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Te("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new UI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Rm(){return new yn(De.comparator)}function FI(){return new yn(De.comparator)}const aG={asc:"ASCENDING",desc:"DESCENDING"},sG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oG={and:"AND",or:"OR"};class lG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Y1(n,e){return n.useProto3Json||Rv(e)?e:{value:e}}function xd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function cG(n,e){return xd(n,e.toTimestamp())}function Hr(n){return Ue(!!n,49232),Ke.fromTimestamp((function(t){const r=Bs(t);return new vt(r.seconds,r.nanos)})(n))}function Lw(n,e){return K1(n,e).canonicalString()}function K1(n,e){const t=(function(i){return new Lt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function IP(n){const e=Lt.fromString(n);return Ue(VP(e),10190,{key:e.toString()}),e}function G0(n,e){return Lw(n.databaseId,e.path)}function gc(n,e){const t=IP(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new De(kP(t))}function RP(n,e){return Lw(n.databaseId,e)}function DP(n){const e=IP(n);return e.length===4?Lt.emptyPath():kP(e)}function X1(n){return new Lt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function kP(n){return Ue(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function GI(n,e,t){return{name:G0(n,e),fields:t.value.mapValue.fields}}function uG(n,e,t){const r=gc(n,e.name),i=Hr(e.updateTime),a=e.createTime?Hr(e.createTime):Ke.min(),o=new Rr({mapValue:{fields:e.fields}}),c=Dn.newFoundDocument(r,i,a,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function dG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ve(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Ue(h===void 0||typeof h=="string",58123),Jn.fromBase64String(h||"")):(Ue(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Jn.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?me.UNKNOWN:SP(d.code);return new Ie(h,d.message||"")})(o);t=new AP(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=gc(n,r.document.name),a=Hr(r.document.updateTime),o=r.document.createTime?Hr(r.document.createTime):Ke.min(),c=new Rr({mapValue:{fields:r.document.fields}}),u=Dn.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new f0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=gc(n,r.document),a=r.readTime?Hr(r.readTime):Ke.min(),o=Dn.newNoDocument(i,a),c=r.removedTargetIds||[];t=new f0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=gc(n,r.document),a=r.removedTargetIds||[];t=new f0([],a,i,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new eG(i,a),c=r.targetId;t=new TP(c,o)}}return t}function q0(n,e){let t;if(e instanceof Ld)t={update:GI(n,e.key,e.value)};else if(e instanceof kp)t={delete:G0(n,e.key)};else if(e instanceof Qs)t={update:GI(n,e.key,e.data),updateMask:vG(e.fieldMask)};else{if(!(e instanceof EP))return Ve(16599,{Vt:e.type});t={verify:G0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof tp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ic)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof bd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof np)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Ve(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:cG(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ve(27497)})(n,e.precondition)),t}function W1(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?lr.updateTime(Hr(a.updateTime)):a.exists!==void 0?lr.exists(a.exists):lr.none()})(e.currentDocument):lr.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Ue(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new tp;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Ic(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new bd(h)}else"increment"in c?u=new np(o,c.increment):Ve(16584,{proto:c});const d=En.fromServerFormat(c.fieldPath);return new xP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=gc(n,e.update.name),a=new Rr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new ti(d.map((h=>En.fromServerFormat(h))))})(e.updateMask);return new Qs(i,a,o,t,r)}return new Ld(i,a,t,r)}if(e.delete){const i=gc(n,e.delete);return new kp(i,t)}if(e.verify){const i=gc(n,e.verify);return new EP(i,t)}return Ve(1463,{proto:e})}function fG(n,e){return n&&n.length>0?(Ue(e!==void 0,14353),n.map((t=>(function(i,a){let o=i.updateTime?Hr(i.updateTime):Hr(a);return o.isEqual(Ke.min())&&(o=Hr(a)),new Q7(o,i.transformResults||[])})(t,e)))):[]}function NP(n,e){return{documents:[RP(n,e.path)]}}function MP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=RP(n,i);const a=(function(d){if(d.length!==0)return jP($t.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:zu(m.field),direction:pG(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=Y1(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function PP(n){let e=DP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ue(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=OP(p);return m instanceof $t&&Mw(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new ep(Lu(_.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,Rv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new vd(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new vd(b,m)})(t.endAt)),z7(e,i,o,a,c,"F",u,d)}function hG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function OP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Lu(t.unaryFilter.field);return Ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Lu(t.unaryFilter.field);return Ct.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Lu(t.unaryFilter.field);return Ct.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Lu(t.unaryFilter.field);return Ct.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ct.create(Lu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return $t.create(t.compositeFilter.filters.map((r=>OP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(t.compositeFilter.op))})(n):Ve(30097,{filter:n})}function pG(n){return aG[n]}function gG(n){return sG[n]}function mG(n){return oG[n]}function zu(n){return{fieldPath:n.canonicalString()}}function Lu(n){return En.fromServerFormat(n.fieldPath)}function jP(n){return n instanceof Ct?(function(t){if(t.op==="=="){if(CI(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NAN"}};if(AI(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(CI(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NOT_NAN"}};if(AI(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zu(t.field),op:gG(t.op),value:t.value}}})(n):n instanceof $t?(function(t){const r=t.getFilters().map((i=>jP(i)));return r.length===1?r[0]:{compositeFilter:{op:mG(t.op),filters:r}}})(n):Ve(54877,{filter:n})}function vG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function VP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ds{constructor(e,t,r,i,a=Ke.min(),o=Ke.min(),c=Jn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class zP{constructor(e){this.yt=e}}function yG(n,e){let t;if(e.document)t=uG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=De.fromSegments(e.noDocument.path),i=Dc(e.noDocument.readTime);t=Dn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ve(56709);{const r=De.fromSegments(e.unknownDocument.path),i=Dc(e.unknownDocument.version);t=Dn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new vt(i[0],i[1]);return Ke.fromTimestamp(a)})(e.readTime)),t}function qI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:H0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:G0(a,o.key),fields:o.data.value.mapValue.fields,updateTime:xd(a,o.version.toTimestamp()),createTime:xd(a,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Rc(e.version)};else{if(!e.isUnknownDocument())return Ve(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Rc(e.version)}}return r}function H0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Rc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Dc(n){const e=new vt(n.seconds,n.nanoseconds);return Ke.fromTimestamp(e)}function ec(n,e){const t=(e.baseMutations||[]).map((a=>W1(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>W1(n.yt,a))),i=vt.fromMillis(e.localWriteTimeMs);return new Ow(e.batchId,i,t,r)}function ch(n){const e=Dc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Dc(n.lastLimboFreeSnapshotVersion):Ke.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const o=a.documents.length;return Ue(o===1,1966,{count:o}),Fi(Rp(DP(a.documents[0])))})(n.query):(function(a){return Fi(PP(a))})(n.query),new Ds(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Jn.fromBase64String(n.resumeToken))}function LP(n,e){const t=Rc(e.snapshotVersion),r=Rc(e.lastLimboFreeSnapshotVersion);let i;i=B0(e.target)?NP(n.yt,e.target):MP(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Cc(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function BP(n){const e=PP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?F0(e,e.limit,"L"):e}function Dx(n,e){return new Vw(e.largestBatchId,W1(n.yt,e.overlayMutation))}function HI(n,e){const t=e.path.lastSegment();return[n,Nr(e.path.popLast()),t]}function $I(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Rc(r.readTime),documentKey:Nr(r.documentKey.path),largestBatchId:r.largestBatchId}}class bG{getBundleMetadata(e,t){return YI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Dc(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return YI(e).put((function(i){return{bundleId:i.id,createTime:Rc(Hr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return KI(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:BP(a.bundledQuery),readTime:Dc(a.readTime)}})(r)}))}saveNamedQuery(e,t){return KI(e).put((function(i){return{name:i.name,readTime:Rc(Hr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function YI(n){return ur(n,Dv)}function KI(n){return ur(n,kv)}class Lv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Lv(e,r)}getOverlay(e,t){return Qf(e).get(HI(this.userId,t)).next((r=>r?Dx(this.serializer,r):null))}getOverlays(e,t){const r=Ha();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,o)=>{const c=new Vw(t,o);i.push(this.St(e,c))})),ae.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(Nr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Qf(e).Z(L1,c))})),ae.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Ha(),a=Nr(t),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Qf(e).J(L1,o).next((c=>{for(const u of c){const d=Dx(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=Ha();let o;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Qf(e).ee({index:UM,range:c},((u,d,h)=>{const p=Dx(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return Qf(e).put((function(i,a,o){const[c,u,d]=HI(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:q0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Qf(n){return ur(n,Nv)}class xG{bt(e){return ur(e,Iw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Jn.fromUint8Array(r):Jn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class tc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(mn(e.integerValue));else if("doubleValue"in e){const r=mn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),$h(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Bs(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Us(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?JM(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Pv(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ve(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=gd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(mn(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),De.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}tc.Kt=new tc;const ku=255;function _G(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function XI(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=_G(255&r[a]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class wG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=XI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=XI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(ku),this.sn(255)}_n(){this.an(ku),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===ku?(this.sn(ku),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===ku?(this.an(ku),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class EG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class SG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Zf{constructor(){this.cn=new wG,this.ln=new EG(this.cn),this.hn=new SG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class nc{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new nc(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:h0(this.En),directionalValue:h0(this.dn),orderedDocumentKey:h0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Mo(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=WI(n.En,e.En),t!==0?t:(t=WI(n.dn,e.dn),t!==0?t:De.comparator(n.In,e.In)))}function WI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function h0(n){return kN()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function QI(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class ZI{constructor(e){this.mn=new Yt(((t,r)=>En.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ue(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=j1(e);if(t!==void 0&&!this.wn(t))return!1;const r=Xl(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new Yt(En.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new a0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new a0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new a0(r.field,r.dir==="asc"?0:1)));return new O0(O0.UNKNOWN_ID,this.collectionId,t,Hh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function UP(n){if(Ue(n instanceof Ct||n instanceof $t,20012),n instanceof Ct){if(n instanceof lP){const t=n.value.arrayValue?.values?.map((r=>Ct.create(n.field,"==",r)))||[];return $t.create(t,"or")}return n}const e=n.filters.map((t=>UP(t)));return $t.create(e,n.op)}function TG(n){if(n.getFilters().length===0)return[];const e=J1(UP(n));return Ue(FP(e),7391),Q1(e)||Z1(e)?[e]:e.getFilters()}function Q1(n){return n instanceof Ct}function Z1(n){return n instanceof $t&&Mw(n)}function FP(n){return Q1(n)||Z1(n)||(function(t){if(t instanceof $t&&G1(t)){for(const r of t.getFilters())if(!Q1(r)&&!Z1(r))return!1;return!0}return!1})(n)}function J1(n){if(Ue(n instanceof Ct||n instanceof $t,34018),n instanceof Ct)return n;if(n.filters.length===1)return J1(n.filters[0]);const e=n.filters.map((r=>J1(r)));let t=$t.create(e,n.op);return t=$0(t),FP(t)?t:(Ue(t instanceof $t,64498),Ue(yd(t),40251),Ue(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Bw(r,i))))}function Bw(n,e){let t;return Ue(n instanceof Ct||n instanceof $t,38388),Ue(e instanceof Ct||e instanceof $t,25473),t=n instanceof Ct?e instanceof Ct?(function(i,a){return $t.create([i,a],"and")})(n,e):JI(n,e):e instanceof Ct?JI(e,n):(function(i,a){if(Ue(i.filters.length>0&&a.filters.length>0,48005),yd(i)&&yd(a))return aP(i,a.getFilters());const o=G1(i)?i:a,c=G1(i)?a:i,u=o.filters.map((d=>Bw(d,c)));return $t.create(u,"or")})(n,e),$0(t)}function JI(n,e){if(yd(e))return aP(e,n.getFilters());{const t=e.filters.map((r=>Bw(n,r)));return $t.create(t,"or")}}function $0(n){if(Ue(n instanceof Ct||n instanceof $t,11850),n instanceof Ct)return n;const e=n.getFilters();if(e.length===1)return $0(e[0]);if(rP(n))return n;const t=e.map((i=>$0(i))),r=[];return t.forEach((i=>{i instanceof Ct?r.push(i):i instanceof $t&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:$t.create(r,n.op)}class AG{constructor(){this.Cn=new Uw}addToCollectionParentIndex(e,t){return this.Cn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(bi.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(bi.min())}updateCollectionGroup(e,t,r){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class Uw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Yt(Lt.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Yt(Lt.comparator)).toArray()}}const eR="IndexedDbIndexManager",Dm=new Uint8Array(0);class CG{constructor(e,t){this.databaseId=t,this.vn=new Uw,this.Fn=new Ws((r=>Cc(r)),((r,i)=>Ip(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Nr(i)};return tR(e).put(a)}return ae.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[RM(t),""],!1,!0);return tR(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==t)break;r.push(qa(o.parent))}return r}))}addFieldIndex(e,t){const r=Jf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const o=Mu(e);return a.next((c=>{o.put($I(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=Jf(e),i=Mu(e),a=Nu(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Jf(e),r=Nu(e),i=Mu(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return ae.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new ZI(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=Nu(e);let i=!0;const a=new Map;return ae.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=yt();const c=[];return ae.forEach(a,((u,d)=>{Te(eR,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(u)} to execute ${Cc(t)}`);const h=(function(D,O){const M=j1(O);if(M===void 0)return null;for(const V of U0(D,M.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null})(d,u),p=(function(D,O){const M=new Map;for(const V of Xl(O))for(const A of U0(D,V.fieldPath))switch(A.op){case"==":case"in":M.set(V.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return M.set(V.fieldPath.canonicalString(),A.value),Array.from(M.values())}return null})(d,u),m=(function(D,O){const M=[];let V=!0;for(const A of Xl(O)){const I=A.kind===0?NI(D,A.fieldPath,D.startAt):MI(D,A.fieldPath,D.startAt);M.push(I.value),V&&(V=I.inclusive)}return new vd(M,V)})(d,u),b=(function(D,O){const M=[];let V=!0;for(const A of Xl(O)){const I=A.kind===0?MI(D,A.fieldPath,D.endAt):NI(D,A.fieldPath,D.endAt);M.push(I.value),V&&(V=I.inclusive)}return new vd(M,V)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),S=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,S);return ae.forEach(T,(C=>r.Y(C,t.limit).next((D=>{D.forEach((O=>{const M=De.fromSegments(O.documentKey);o.has(M)||(o=o.add(M),c.push(M))}))}))))})).next((()=>c))}return ae.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=TG($t.create(e.filters,"and")).map((r=>H1(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,o,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Dm,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((S=>this.kn(e,m,S,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new nc(e,De.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new nc(e,De.empty(),t,r);return i?a.An():a}xn(e,t){const r=new ZI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return ae.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new Yt(En.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Zf;for(const i of Xl(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);tc.Kt.Dt(a,o)}return r.un()}Ln(e){const t=new Zf;return tc.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Zf;return tc.Kt.Dt(Zh(this.databaseId,t),r.Pn((function(a){const o=Xl(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Zf);let a=0;for(const o of Xl(e)){const c=r[a++];for(const u of i)if(this.Un(t,o.fieldPath)&&Jh(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);tc.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Zf;u.seed(c.un()),tc.Kt.Dt(o,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof Ct&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Jf(e),i=Mu(e);return(t?r.J(z1,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const o=[];return ae.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new Hh(p.sequenceNumber,new bi(Dc(p.readTime),new De(qa(p.documentKey)),p.largestBatchId)):Hh.empty(),b=h.fields.map((([_,w])=>new a0(En.fromServerFormat(_),w)));return new O0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:ot(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Jf(e),a=Mu(e);return this.Gn(e).next((o=>i.J(z1,IDBKeyRange.bound(t,t)).next((c=>ae.forEach(c,(u=>a.put($I(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return ae.forEach(t,((i,a)=>{const o=r.get(i.collectionGroup);return(o?ae.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),ae.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?ae.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return Nu(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Nu(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Nu(e);let a=new Yt(Mo);return i.ee({index:BM,range:IDBKeyRange.only([r.indexId,this.uid,h0(this.$n(r,t))])},((o,c)=>{a=a.add(new nc(r.indexId,t,QI(c.arrayValue),QI(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new Yt(Mo);const i=this.Qn(t,e);if(i==null)return r;const a=j1(t);if(a!=null){const o=e.data.field(a.fieldPath);if(Jh(o))for(const c of o.arrayValue.values||[])r=r.add(new nc(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new nc(t.indexId,e.key,Dm,i));return r}Jn(e,t,r,i,a){Te(eR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Du(b),S=Du(_);for(;w||S;){let T=!1,C=!1;if(w&&S){const D=h(w,S);D<0?C=!0:D>0&&(T=!0)}else w!=null?C=!0:T=!0;T?(p(S),S=Du(_)):C?(m(w),w=Du(b)):(w=Du(b),S=Du(_))}})(i,a,Mo,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),ae.waitFor(o)}Gn(e){let t=1;return Mu(e).ee({index:LM,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>Mo(o,c))).filter(((o,c,u)=>!c||Mo(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=Mo(o,e),u=Mo(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Dm,De.empty()),u=i[o+1].Vn(this.uid,Dm,De.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(nR)}getMinOffset(e,t){return ae.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Ve(44426))))).next(nR)}}function tR(n){return ur(n,Xh)}function Nu(n){return ur(n,wh)}function Jf(n){return ur(n,Cw)}function Mu(n){return ur(n,_h)}function nR(n){Ue(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Sw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new bi(e.readTime,e.documentKey,t)}const rR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},GP=41943040;class Ir{static withCacheSize(e){return new Ir(e,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function qP(n,e,t){const r=n.store(aa),i=n.store(dd),a=[],o=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{Ue(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=jM(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return ae.waitFor(a).next((()=>d))}function Y0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ve(14731);e=n.noDocument}return JSON.stringify(e).length}Ir.DEFAULT_COLLECTION_PERCENTILE=10,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ir.DEFAULT=new Ir(GP,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ir.DISABLED=new Ir(-1,0,0);class Bv{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Ue(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Bv(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Po(e).ee({index:oc,range:r},((i,a,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=Bu(e),o=Po(e);return o.add({}).next((c=>{Ue(typeof c=="number",49019);const u=new Ow(c,t,r,i),d=(function(b,_,w){const S=w.baseMutations.map((C=>q0(b.yt,C))),T=w.mutations.map((C=>q0(b.yt,C)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:S,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new Yt(((m,b)=>ot(m.canonicalString(),b.canonicalString())));for(const m of i){const b=jM(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(b,n7))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),ae.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return Po(e).get(t).next((r=>r?(Ue(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ec(this.serializer,r)):null))}er(e,t){return this.Xn[t]?ae.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Po(e).ee({index:oc,range:i},((o,c,u)=>{c.userId===this.userId&&(Ue(c.batchId>=r,47524,{tr:r}),a=ec(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=hc;return Po(e).ee({index:oc,range:t,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,hc],[this.userId,Number.POSITIVE_INFINITY]);return Po(e).J(oc,t).next((r=>r.map((i=>ec(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=s0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Bu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=qa(h);if(d===this.userId&&t.path.isEqual(m))return Po(e).get(p).next((b=>{if(!b)throw Ve(61480,{nr:o,batchId:p});Ue(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(ec(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Yt(ot);const i=[];return t.forEach((a=>{const o=s0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=Bu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=qa(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),ae.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=s0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new Yt(ot);return Bu(e).ee({range:o},((u,d,h)=>{const[p,m,b]=u,_=qa(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(Po(e).get(a).next((o=>{if(o===null)throw Ve(35274,{batchId:a});Ue(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(ec(this.serializer,o))})))})),ae.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return qP(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ae.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ae.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Bu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=qa(a[1]);i.push(u)}else c.done()})).next((()=>{Ue(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return HP(e,this.userId,t)}_r(e){return $P(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:hc,lastStreamToken:""}))}}function HP(n,e,t){const r=s0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return Bu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function Po(n){return ur(n,aa)}function Bu(n){return ur(n,dd)}function $P(n){return ur(n,Yh)}class kc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new kc(0)}static cr(){return new kc(-1)}}class IG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new kc(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ke.fromTimestamp(new vt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Pu(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ue(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return Pu(e).ee(((o,c)=>{const u=ch(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>ae.waitFor(a))).next((()=>i))}forEachTarget(e,t){return Pu(e).ee(((r,i)=>{const a=ch(i);t(a)}))}lr(e){return iR(e).get(z0).next((t=>(Ue(t!==null,2888),t)))}hr(e,t){return iR(e).put(z0,t)}Pr(e,t){return Pu(e).put(LP(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Cc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Pu(e).ee({range:i,index:zM},((o,c,u)=>{const d=ch(c);Ip(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=Ho(e);return t.forEach((o=>{const c=Nr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),ae.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ho(e);return ae.forEach(t,(a=>{const o=Nr(a.path);return ae.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Ho(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ho(e);let a=yt();return i.ee({range:r,X:!0},((o,c,u)=>{const d=qa(o[1]),h=new De(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=Nr(t.path),i=IDBKeyRange.bound([r],[RM(r)],!1,!0);let a=0;return Ho(e).ee({index:Aw,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return Pu(e).get(t).next((r=>r?ch(r):null))}}function Pu(n){return ur(n,fd)}function iR(n){return ur(n,pc)}function Ho(n){return ur(n,hd)}const aR="LruGarbageCollector",RG=1048576;function sR([n,e],[t,r]){const i=ot(n,t);return i===0?ot(e,r):i}class DG{constructor(e){this.Ir=e,this.buffer=new Yt(sR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();sR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class YP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(aR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){gl(t)?Te(aR,"Ignoring IndexedDB error during garbage collection: ",t):await Lc(t)}await this.Vr(3e5)}))}}class kG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Bi.ce);const r=new DG(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(rR)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),ju()<=At.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function KP(n,e){return new kG(n,e)}class NG{constructor(e,t){this.db=e,this.garbageCollector=KP(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return km(e,r)}removeReference(e,t,r){return km(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return km(e,t)}br(e,t){return(function(i,a){let o=!1;return $P(i).te((c=>HP(i,c,a).next((u=>(u&&(o=!0),ae.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=t){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Ke.min()),Ho(e).delete((function(p){return[0,Nr(p.path)]})(o)))))}));i.push(u)}})).next((()=>ae.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return km(e,t)}Sr(e,t){const r=Ho(e);let i,a=Bi.ce;return r.ee({index:Aw},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==Bi.ce&&t(new De(qa(i)),a),a=d,i=u):a=Bi.ce})).next((()=>{a!==Bi.ce&&t(new De(qa(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function km(n,e){return Ho(n).put((function(r,i){return{targetId:0,path:Nr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class XP{constructor(){this.changes=new Ws((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Dn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ae.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Hl(e).put(r)}removeEntry(e,t,r){return Hl(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],H0(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Dn.newInvalidDocument(t);return Hl(e).ee({index:o0,range:IDBKeyRange.only(eh(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:Dn.newInvalidDocument(t)};return Hl(e).ee({index:o0,range:IDBKeyRange.only(eh(t))},((i,a)=>{r={document:this.Cr(t,a),size:Y0(a)}})).next((()=>r))}getEntries(e,t){let r=yi();return this.Fr(e,t,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=yi(),i=new yn(De.comparator);return this.Fr(e,t,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,Y0(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return ae.resolve();let i=new Yt(cR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(eh(i.first()),eh(i.last())),o=i.getIterator();let c=o.getNext();return Hl(e).ee({index:o0,range:a},((u,d,h)=>{const p=De.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&cR(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(eh(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const o=t.path,c=[o.popLast().toArray(),o.lastSegment(),H0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hl(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=yi();for(const p of d){const m=this.Cr(De.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Dp(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=yi();const o=lR(t,r),c=lR(t,bi.max());return Hl(e).ee({index:VM,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(De.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new PG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return oR(e).get(V1).next((t=>(Ue(!!t,20021),t)))}Dr(e,t){return oR(e).put(V1,t)}Cr(e,t){if(t){const r=yG(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ke.min())))return r}return Dn.newInvalidDocument(e)}}function WP(n){return new MG(n)}class PG extends XP{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ws((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Yt(((a,o)=>ot(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=qI(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=Y0(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=qI(this.Nr.serializer,o.convertToNoDocument(Ke.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),ae.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function oR(n){return ur(n,Kh)}function Hl(n){return ur(n,V0)}function eh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lR(n,e){const t=e.documentKey.path.toArray();return[n,H0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function cR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=ot(t[a],r[a]),i)return i;return i=ot(t.length,r.length),i||(i=ot(t[t.length-2],r[r.length-2]),i||ot(t[t.length-1],r[r.length-1]))}class OG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class QP{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Ah(r.mutation,i,ti.empty(),vt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,yt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=yt()){const i=Ha();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let o=oh();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Ha();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,yt())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let a=yi();const o=Th(),c=(function(){return Th()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Qs)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Ah(h.mutation,d,h.mutation.getFieldMask(),vt.now())):o.set(d.key,ti.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>c.set(d,new OG(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Th();let i=new yn(((o,c)=>o-c)),a=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||ti.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||yt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=pP();h.forEach((m=>{if(!a.has(m)){const b=_P(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return ae.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return De.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ae.resolve(Ha());let c=qh,u=a;return o.next((d=>ae.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?ae.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,yt()))).next((h=>({batchId:c,changes:hP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new De(t)).next((r=>{let i=oh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let o=oh();return this.indexManager.getCollectionParents(e,a).next((c=>ae.forEach(c,(u=>{const d=(function(p,m){return new zd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Dn.newInvalidDocument(h)))}));let c=oh();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Ah(h.mutation,d,ti.empty(),vt.now()),Dp(t,d)&&(c=c.insert(u,d))})),c}))}}class jG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Hr(i.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:BP(i.bundledQuery),readTime:Hr(i.readTime)}})(t)),ae.resolve()}}class VG{constructor(){this.overlays=new yn(De.comparator),this.qr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ha();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),ae.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),ae.resolve()}getOverlaysForCollection(e,t,r){const i=Ha(),a=t.length+1,o=new De(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new yn(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ha(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ha(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return ae.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Vw(t,r));let a=this.qr.get(t);a===void 0&&(a=yt(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class zG{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}class Fw{constructor(){this.Qr=new Yt(gr.$r),this.Ur=new Yt(gr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new gr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new gr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new De(new Lt([])),r=new gr(t,e),i=new gr(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new De(new Lt([])),r=new gr(t,e),i=new gr(t,e+1);let a=yt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new gr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class gr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return De.comparator(e.key,t.key)||ot(e.Yr,t.Yr)}static Kr(e,t){return ot(e.Yr,t.Yr)||De.comparator(e.key,t.key)}}class LG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Yt(gr.$r)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ow(a,t,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new gr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,t){return ae.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return ae.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?hc:this.tr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new gr(t,0),i=new gr(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),ae.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Yt(ot);return t.forEach((i=>{const a=new gr(i,0),o=new gr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),ae.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;De.isDocumentKey(a)||(a=a.child(""));const o=new gr(new De(a),0);let c=new Yt(ot);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),ae.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ue(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ae.forEach(t.mutations,(i=>{const a=new gr(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new gr(t,0),i=this.Zr.firstAfterOrEqual(r);return ae.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class BG{constructor(e){this.ri=e,this.docs=(function(){return new yn(De.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ae.resolve(r?r.document.mutableCopy():Dn.newInvalidDocument(t))}getEntries(e,t){let r=yi();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Dn.newInvalidDocument(i))})),ae.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=yi();const o=t.path,c=new De(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Sw(NM(h),r)<=0||(i.has(h.key)||Dp(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return ae.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Ve(9500)}ii(e,t){return ae.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new UG(this)}getSize(e){return ae.resolve(this.size)}}class UG extends XP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),ae.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class FG{constructor(e){this.persistence=e,this.si=new Ws((t=>Cc(t)),Ip),this.lastRemoteSnapshotVersion=Ke.min(),this.highestTargetId=0,this.oi=0,this._i=new Fw,this.targetCount=0,this.ai=kc.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),ae.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new kc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.Pr(t),ae.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),ae.waitFor(a).next((()=>i))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return ae.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),ae.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),ae.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return ae.resolve(r)}containsKey(e,t){return ae.resolve(this._i.containsKey(t))}}class Gw{constructor(e,t){this.ui={},this.overlays={},this.ci=new Bi(0),this.li=!1,this.li=!0,this.hi=new zG,this.referenceDelegate=e(this),this.Pi=new FG(this),this.indexManager=new AG,this.remoteDocumentCache=(function(i){return new BG(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new zP(t),this.Ii=new jG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new LG(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Te("MemoryPersistence","Starting transaction:",e);const i=new GG(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return ae.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class GG extends PM{constructor(e){super(),this.currentSequenceNumber=e}}class Uv{constructor(e){this.persistence=e,this.Ri=new Fw,this.Vi=null}static mi(e){return new Uv(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),ae.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,(r=>{const i=De.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Ke.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class K0{constructor(e,t){this.persistence=e,this.pi=new Ws((r=>Nr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=KP(this,t)}static mi(e,t){return new K0(e,t)}Ei(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return ae.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?ae.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,a.removeEntry(o,Ke.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=c0(e.data.value)),t}br(e,t,r){return ae.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return ae.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class qG{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Iv("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Cp)})(e),(function(u){u.createObjectStore(Yh,{keyPath:t7}),u.createObjectStore(aa,{keyPath:xI,autoIncrement:!0}).createIndex(oc,_I,{unique:!0}),u.createObjectStore(dd)})(e),uR(e),(function(u){u.createObjectStore(Wl)})(e));let o=ae.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(hd),u.deleteObjectStore(fd),u.deleteObjectStore(pc)})(e),uR(e)),o=o.next((()=>(function(u){const d=u.store(pc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ke.min().toTimestamp(),targetCount:0};return d.put(z0,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(aa).J().next((p=>{u.deleteObjectStore(aa),u.createObjectStore(aa,{keyPath:xI,autoIncrement:!0}).createIndex(oc,_I,{unique:!0});const m=d.store(aa),b=p.map((_=>m.put(_)));return ae.waitFor(b)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(pd,{keyPath:u7})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Kh)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Dv,{keyPath:d7})})(e),(function(u){u.createObjectStore(kv,{keyPath:f7})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(Nv,{keyPath:b7});d.createIndex(L1,x7,{unique:!1}),d.createIndex(UM,_7,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(V0,{keyPath:r7});d.createIndex(o0,i7),d.createIndex(VM,a7)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Wl)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Cw,{keyPath:h7,autoIncrement:!0}).createIndex(z1,p7,{unique:!1}),u.createObjectStore(_h,{keyPath:g7}).createIndex(LM,m7,{unique:!1}),u.createObjectStore(wh,{keyPath:v7}).createIndex(BM,y7,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(_h).clear()})).next((()=>{t.objectStore(wh).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Iw,{keyPath:w7})})(e)}))),r<18&&i>=18&&kN()&&(o=o.next((()=>{t.objectStore(_h).clear()})).next((()=>{t.objectStore(wh).clear()}))),o}wi(e){let t=0;return e.store(Wl).ee(((r,i)=>{t+=Y0(i)})).next((()=>{const r={byteSize:t};return e.store(Kh).put(V1,r)}))}yi(e){const t=e.store(Yh),r=e.store(aa);return t.J().next((i=>ae.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,hc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(oc,o).next((c=>ae.forEach(c,(u=>{Ue(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=ec(this.serializer,u);return qP(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(hd),r=e.store(Wl);return e.store(pc).get(z0).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new Lt(o),d=(function(p){return[0,Nr(p)]})(u);a.push(t.get(d).next((h=>h?ae.resolve():(p=>t.put({targetId:0,path:Nr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>ae.waitFor(a)))}))}bi(e,t){e.createObjectStore(Xh,{keyPath:c7});const r=t.store(Xh),i=new Uw,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:Nr(u)})}};return t.store(Wl).ee({X:!0},((o,c)=>{const u=new Lt(o);return a(u.popLast())})).next((()=>t.store(dd).ee({X:!0},(([o,c,u],d)=>{const h=qa(c);return a(h.popLast())}))))}Di(e){const t=e.store(fd);return t.ee(((r,i)=>{const a=ch(i),o=LP(this.serializer,a);return t.put(o)}))}Ci(e,t){const r=t.store(Wl),i=[];return r.ee(((a,o)=>{const c=t.store(V0),u=(function(p){return p.document?new De(Lt.fromString(p.document.name).popFirst(5)):p.noDocument?De.fromSegments(p.noDocument.path):p.unknownDocument?De.fromSegments(p.unknownDocument.path):Ve(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>ae.waitFor(i)))}Fi(e,t){const r=t.store(aa),i=WP(this.serializer),a=new Gw(Uv.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??yt();ec(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),ae.forEach(c,((u,d)=>{const h=new Er(d),p=Lv.wt(this.serializer,h),m=a.getIndexManager(h),b=Bv.wt(h,this.serializer,m,a.referenceDelegate);return new QP(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new B1(t,Bi.ce),u).next()}))}))}}function uR(n){n.createObjectStore(hd,{keyPath:o7}).createIndex(Aw,l7,{unique:!0}),n.createObjectStore(fd,{keyPath:"targetId"}).createIndex(zM,s7,{unique:!0}),n.createObjectStore(pc)}const Oo="IndexedDbPersistence",kx=18e5,Nx=5e3,Mx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",HG="main";class qw{constructor(e,t,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!qw.v())throw new Ie(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new NG(this,i),this.$i=t+HG,this.serializer=new zP(u),this.Ui=new el(this.$i,this.Ni,new qG(this.serializer)),this.hi=new xG,this.Pi=new IG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=WP(this.serializer),this.Ii=new bG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Fr(Oo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ie(me.FAILED_PRECONDITION,Mx);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Bi(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Nm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(gl(e))return Te(Oo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Te(Oo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return th(e).get(Ru).next((t=>ae.resolve(this.es(t))))}ts(e){return Nm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,kx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=ur(t,pd);return r.J().next((i=>{const a=this.ss(i,kx),o=i.filter((c=>a.indexOf(c)===-1));return ae.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ae.resolve(!0):th(e).get(Ru).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Nx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ie(me.FAILED_PRECONDITION,Mx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Nm(e).J().next((r=>this.ss(r,Nx).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Te(Oo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Cp,pd],(e=>{const t=new B1(e,Bi.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Nm(e).J().next((t=>this.ss(t,kx).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Bv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new CG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Lv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Te(Oo,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?T7:u===17?HM:u===16?S7:u===15?Rw:u===14?qM:u===13?GM:u===12?E7:u===11?FM:void Ve(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new B1(c,this.ci?this.ci.next():Bi.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Fr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ie(me.FAILED_PRECONDITION,MM);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return th(e).get(Ru).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Nx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ie(me.FAILED_PRECONDITION,Mx)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return th(e).put(Ru,t)}static v(){return el.v()}Zi(e){const t=th(e);return t.get(Ru).next((r=>this.es(r)?(Te(Oo,"Releasing primary lease."),t.delete(Ru)):ae.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Fr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;DN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Te(Oo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Fr(Oo,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Fr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function th(n){return ur(n,Cp)}function Nm(n){return ur(n,pd)}function $G(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Hw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=yt(),i=yt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Hw(e,t.fromCache,r,i)}}class YG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ZP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return DN()?8:OM(cr())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new YG;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(ju()<=At.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",Vu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(ju()<=At.DEBUG&&Te("QueryEngine","Query:",Vu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(ju()<=At.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",Vu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fi(t))):ae.resolve())}ys(e,t){if(PI(t))return ae.resolve(null);let r=Fi(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=F0(t,null,"F"),r=Fi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=yt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,o,u.readTime)?this.ys(e,F0(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return PI(t)||i.isEqual(Ke.min())?ae.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,r,i)?ae.resolve(null):(ju()<=At.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Vu(t)),this.vs(e,o,t,KF(i,qh)).next((c=>c)))}))}Ds(e,t){let r=new Yt(dP(e));return t.forEach(((i,a)=>{Dp(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return ju()<=At.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",Vu(t)),this.ps.getDocumentsMatchingQuery(e,t,bi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const $w="LocalStore",KG=3e8;class XG{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new yn(ot),this.xs=new Ws((a=>Cc(a)),Ip),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new QP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function JP(n,e,t,r){return new XG(n,e,t,r)}async function eO(n,e){const t=ct(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=yt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function WG(n,e){const t=ct(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=ae.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const S=d.docVersions.get(_);Ue(S!==null,48541),w.version.compareTo(S)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=yt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function tO(n){const e=ct(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function QG(n,e){const t=ct(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(Jn.EMPTY_BYTE_STRING,Ke.min()).withLastLimboFreeSnapshotVersion(Ke.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,S,T){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=KG?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=yi(),d=yt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(ZG(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Ke.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return ae.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function ZG(n,e,t){let r=yt(),i=yt();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let o=yi();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Ke.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Te($w,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function JG(n,e){const t=ct(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=hc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function eq(n,e){const t=ct(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,ae.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new Ds(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function e_(n,e,t){const r=ct(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!gl(o))throw o;Te($w,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function dR(n,e,t){const r=ct(n);let i=Ke.min(),a=yt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=ct(u),m=p.xs.get(h);return m!==void 0?ae.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Fi(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:Ke.min(),t?a:yt()))).next((c=>(tq(r,B7(e),c),{documents:c,Qs:a})))))}function tq(n,e,t){let r=n.Os.get(e)||Ke.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class fR{constructor(){this.activeTargetIds=$7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nO{constructor(){this.Mo=new fR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new fR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class nq{Oo(e){}shutdown(){}}const hR="ConnectivityMonitor";class pR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(hR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(hR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Mm=null;function t_(){return Mm===null?Mm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mm++,"0x"+Mm.toString(16)}const Px="RestConnection",rq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class iq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===L0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const o=t_(),c=this.zo(e,t.toUriEncodedString());Te(Px,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Od(d);return this.Jo(e,c,u,r,h).then((p=>(Te(Px,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Tc(Px,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,o){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=rq[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class aq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Cr="WebChannelConnection";class sq extends iq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const o=t_();return new Promise(((c,u)=>{const d=new wM;d.setWithCredentials(!0),d.listenOnce(EM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case i0.NO_ERROR:const p=d.getResponseJson();Te(Cr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case i0.TIMEOUT:Te(Cr,`RPC '${e}' ${o} timed out`),u(new Ie(me.DEADLINE_EXCEEDED,"Request time out"));break;case i0.HTTP_ERROR:const m=d.getStatus();if(Te(Cr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(C)>=0?C:me.UNKNOWN})(_.status);u(new Ie(w,_.message))}else u(new Ie(me.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Ie(me.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Te(Cr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Te(Cr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=t_(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=AM(),c=TM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Te(Cr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new aq({Yo:S=>{b?Te(Cr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Te(Cr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Te(Cr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),w=(S,T,C)=>{S.listen(T,(D=>{try{C(D)}catch(O){setTimeout((()=>{throw O}),0)}}))};return w(p,sh.EventType.OPEN,(()=>{b||(Te(Cr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,sh.EventType.CLOSE,(()=>{b||(b=!0,Te(Cr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,sh.EventType.ERROR,(S=>{b||(b=!0,Tc(Cr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),_.a_(new Ie(me.UNAVAILABLE,"The operation could not be completed")))})),w(p,sh.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];Ue(!!T,16349);const C=T,D=C?.error||C[0]?.error;if(D){Te(Cr,`RPC '${e}' stream ${i} received error:`,D);const O=D.status;let M=(function(I){const k=Xn[I];if(k!==void 0)return SP(k)})(O),V=D.message;M===void 0&&(M=me.INTERNAL,V="Unknown error status: "+O+" with message "+D.message),b=!0,_.a_(new Ie(M,V)),p.close()}else Te(Cr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,SM.STAT_EVENT,(S=>{S.stat===P1.PROXY?Te(Cr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===P1.NOPROXY&&Te(Cr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function oq(){return typeof window<"u"?window:null}function p0(){return typeof document<"u"?document:null}function Fv(n){return new lG(n,!0)}class rO{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const gR="PersistentStream";class iO{constructor(e,t,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new rO(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(Fr(t.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Ie(me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te(gR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Te(gR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lq extends iO{constructor(e,t,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=dG(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Ke.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Ke.min():o.readTime?Hr(o.readTime):Ke.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=X1(this.serializer),t.addTarget=(function(a,o){let c;const u=o.target;if(c=B0(u)?{documents:NP(a,u)}:{query:MP(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=CP(a,o.resumeToken);const d=Y1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ke.min())>0){c.readTime=xd(a,o.snapshotVersion.toTimestamp());const d=Y1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=hG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=X1(this.serializer),t.removeTarget=e,this.q_(t)}}class cq extends iO{constructor(e,t,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=fG(e.writeResults,e.commitTime),r=Hr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=X1(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>q0(this.serializer,r)))};this.q_(t)}}class uq{}class dq extends uq{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ie(me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,K1(t,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(me.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,K1(t,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ie(me.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class fq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Fr(t),this.aa=!1):Te("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Nc="RemoteStore";class hq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{Bc(this)&&(Te(Nc,"Restarting streams for network reachability change."),await(async function(u){const d=ct(u);d.Ea.add(4),await Mp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Gv(d)})(this))}))})),this.Ra=new fq(r,i)}}async function Gv(n){if(Bc(n))for(const e of n.da)await e(!0)}async function Mp(n){for(const e of n.da)await e(!1)}function aO(n,e){const t=ct(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ww(t)?Xw(t):Bd(t).O_()&&Kw(t,e))}function Yw(n,e){const t=ct(n),r=Bd(t);t.Ia.delete(e),r.O_()&&sO(t,e),t.Ia.size===0&&(r.O_()?r.L_():Bc(t)&&t.Ra.set("Unknown"))}function Kw(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ke.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Bd(n).Y_(e)}function sO(n,e){n.Va.Ue(e),Bd(n).Z_(e)}function Xw(n){n.Va=new iG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Bd(n).start(),n.Ra.ua()}function Ww(n){return Bc(n)&&!Bd(n).x_()&&n.Ia.size>0}function Bc(n){return ct(n).Ea.size===0}function oO(n){n.Va=void 0}async function pq(n){n.Ra.set("Online")}async function gq(n){n.Ia.forEach(((e,t)=>{Kw(n,e)}))}async function mq(n,e){oO(n),Ww(n)?(n.Ra.ha(e),Xw(n)):n.Ra.set("Unknown")}async function vq(n,e,t){if(n.Ra.set("Online"),e instanceof AP&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Te(Nc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await X0(n,r)}else if(e instanceof f0?n.Va.Ze(e):e instanceof TP?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ke.min()))try{const r=await tO(n.localStore);t.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Jn.EMPTY_BYTE_STRING,h.snapshotVersion)),sO(a,u);const p=new Ds(h.target,u,d,h.sequenceNumber);Kw(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Te(Nc,"Failed to raise snapshot:",r),await X0(n,r)}}async function X0(n,e,t){if(!gl(e))throw e;n.Ea.add(1),await Mp(n),n.Ra.set("Offline"),t||(t=()=>tO(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Te(Nc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Gv(n)}))}function lO(n,e){return e().catch((t=>X0(n,t,e)))}async function Pp(n){const e=ct(n),t=sl(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:hc;for(;yq(e);)try{const i=await JG(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,bq(e,i)}catch(i){await X0(e,i)}cO(e)&&uO(e)}function yq(n){return Bc(n)&&n.Ta.length<10}function bq(n,e){n.Ta.push(e);const t=sl(n);t.O_()&&t.X_&&t.ea(e.mutations)}function cO(n){return Bc(n)&&!sl(n).x_()&&n.Ta.length>0}function uO(n){sl(n).start()}async function xq(n){sl(n).ra()}async function _q(n){const e=sl(n);for(const t of n.Ta)e.ea(t.mutations)}async function wq(n,e,t){const r=n.Ta.shift(),i=jw.from(r,e,t);await lO(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Pp(n)}async function Eq(n,e){e&&sl(n).X_&&await(async function(r,i){if((function(o){return tG(o)&&o!==me.ABORTED})(i.code)){const a=r.Ta.shift();sl(r).B_(),await lO(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Pp(r)}})(n,e),cO(n)&&uO(n)}async function mR(n,e){const t=ct(n);t.asyncQueue.verifyOperationInProgress(),Te(Nc,"RemoteStore received new credentials");const r=Bc(t);t.Ea.add(3),await Mp(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Gv(t)}async function Sq(n,e){const t=ct(n);e?(t.Ea.delete(2),await Gv(t)):e||(t.Ea.add(2),await Mp(t),t.Ra.set("Unknown"))}function Bd(n){return n.ma||(n.ma=(function(t,r,i){const a=ct(t);return a.sa(),new lq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:pq.bind(null,n),t_:gq.bind(null,n),r_:mq.bind(null,n),H_:vq.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Ww(n)?Xw(n):n.Ra.set("Unknown")):(await n.ma.stop(),oO(n))}))),n.ma}function sl(n){return n.fa||(n.fa=(function(t,r,i){const a=ct(t);return a.sa(),new cq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:xq.bind(null,n),r_:Eq.bind(null,n),ta:_q.bind(null,n),na:wq.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Pp(n)):(await n.fa.stop(),n.Ta.length>0&&(Te(Nc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Qw{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Wa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const o=Date.now()+r,c=new Qw(e,t,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zw(n,e){if(Fr("AsyncQueue",`${e}: ${n}`),gl(n))return new Ie(me.UNAVAILABLE,`${e}: ${n}`);throw n}class id{static emptySet(e){return new id(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||De.comparator(t.key,r.key):(t,r)=>De.comparator(t.key,r.key),this.keyedMap=oh(),this.sortedSet=new yn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof id)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new id;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class vR{constructor(){this.ga=new yn(De.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class _d{constructor(e,t,r,i,a,o,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new _d(e,t,id.emptySet(t),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ov(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Tq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Aq{constructor(){this.queries=yR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=ct(t),a=i.queries;i.queries=yR(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Ie(me.ABORTED,"Firestore shutting down"))}}function yR(){return new Ws((n=>uP(n)),Ov)}async function Jw(n,e){const t=ct(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new Tq,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const c=Zw(o,`Initialization of query '${Vu(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&tE(t)}async function eE(n,e){const t=ct(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Cq(n,e){const t=ct(n);let r=!1;for(const i of e){const a=i.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&tE(t)}function Iq(n,e,t){const r=ct(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function tE(n){n.Ca.forEach((e=>{e.next()}))}var n_,bR;(bR=n_||(n_={})).Ma="default",bR.Cache="cache";class nE{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new _d(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=_d.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==n_.Cache}}class dO{constructor(e){this.key=e}}class fO{constructor(e){this.key=e}}class Rq{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=yt(),this.mutatedKeys=yt(),this.eu=dP(e),this.tu=new id(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new vR,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Dp(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,_){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:S})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new _d(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vR,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=yt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new fO(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new dO(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=yt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _d.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const rE="SyncEngine";class Dq{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class kq{constructor(e){this.key=e,this.hu=!1}}class Nq{constructor(e,t,r,i,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ws((c=>uP(c)),Ov),this.Iu=new Map,this.Eu=new Set,this.du=new yn(De.comparator),this.Au=new Map,this.Ru=new Fw,this.Vu={},this.mu=new Map,this.fu=kc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Mq(n,e,t=!0){const r=yO(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await hO(r,e,t,!0),i}async function Pq(n,e){const t=yO(n);await hO(t,e,!0,!1)}async function hO(n,e,t,r){const i=await eq(n.localStore,Fi(e)),a=i.targetId,o=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await Oq(n,e,a,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&aO(n.remoteStore,i),c}async function Oq(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,S,T,C){let D=S.view.ru(T);D.Cs&&(D=await dR(w.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,D))));const O=C&&C.targetChanges.get(S.targetId),M=C&&C.targetMismatches.get(S.targetId)!=null,V=S.view.applyChanges(D,w.isPrimaryClient,O,M);return _R(w,S.targetId,V.au),V.snapshot})(n,p,m,b);const a=await dR(n.localStore,e,!0),o=new Rq(e,a.Qs),c=o.ru(a.documents),u=Np.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(c,n.isPrimaryClient,u);_R(n,t,d.au);const h=new Dq(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function jq(n,e,t){const r=ct(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!Ov(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await e_(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Yw(r.remoteStore,i.targetId),r_(r,i.targetId)})).catch(Lc)):(r_(r,i.targetId),await e_(r.localStore,i.targetId,!0))}async function Vq(n,e){const t=ct(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Yw(t.remoteStore,r.targetId))}async function zq(n,e,t){const r=bO(n);try{const i=await(function(o,c){const u=ct(o),d=vt.now(),h=c.reduce(((b,_)=>b.add(_.key)),yt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=yi(),w=yt();return u.Ns.getEntries(b,h).next((S=>{_=S,_.forEach(((T,C)=>{C.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((S=>{p=S;const T=[];for(const C of c){const D=J7(C,p.get(C.key).overlayedDocument);D!=null&&T.push(new Qs(C.key,D,tP(D.value.mapValue),lr.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:hP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new yn(ot)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await Op(r,i.changes),await Pp(r.remoteStore)}catch(i){const a=Zw(i,"Failed to persist write");t.reject(a)}}async function pO(n,e){const t=ct(n);try{const r=await QG(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=t.Au.get(a);o&&(Ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ue(o.hu,14607):i.removedDocuments.size>0&&(Ue(o.hu,42227),o.hu=!1))})),await Op(t,r,e)}catch(r){await Lc(r)}}function xR(n,e,t){const r=ct(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=ct(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&tE(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Lq(n,e,t){const r=ct(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new yn(De.comparator);o=o.insert(a,Dn.newNoDocument(a,Ke.min()));const c=yt().add(a),u=new zv(Ke.min(),new Map,new yn(ot),o,c);await pO(r,u),r.du=r.du.remove(a),r.Au.delete(e),iE(r)}else await e_(r.localStore,e,!1).then((()=>r_(r,e,t))).catch(Lc)}async function Bq(n,e){const t=ct(n),r=e.batch.batchId;try{const i=await WG(t.localStore,e);mO(t,r,null),gO(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Op(t,i)}catch(i){await Lc(i)}}async function Uq(n,e,t){const r=ct(n);try{const i=await(function(o,c){const u=ct(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Ue(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);mO(r,e,t),gO(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Op(r,i)}catch(i){await Lc(i)}}function gO(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function mO(n,e,t){const r=ct(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function r_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||vO(n,r)}))}function vO(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Yw(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),iE(n))}function _R(n,e,t){for(const r of t)r instanceof dO?(n.Ru.addReference(r.key,e),Fq(n,r)):r instanceof fO?(Te(rE,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||vO(n,r.key)):Ve(19791,{wu:r})}function Fq(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Te(rE,"New document in limbo: "+t),n.Eu.add(r),iE(n))}function iE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new De(Lt.fromString(e)),r=n.fu.next();n.Au.set(r,new kq(t)),n.du=n.du.insert(t,r),aO(n.remoteStore,new Ds(Fi(Rp(t.path)),r,"TargetPurposeLimboResolution",Bi.ce))}}async function Op(n,e,t){const r=ct(n),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Hw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=ct(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>ae.forEach(d,(m=>ae.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>ae.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!gl(p))throw p;Te($w,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function Gq(n,e){const t=ct(n);if(!t.currentUser.isEqual(e)){Te(rE,"User change. New user:",e.toKey());const r=await eO(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Ie(me.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Op(t,r.Ls)}}function qq(n,e){const t=ct(n),r=t.Au.get(e);if(r&&r.hu)return yt().add(r.key);{let i=yt();const a=t.Iu.get(e);if(!a)return i;for(const o of a){const c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function yO(n){const e=ct(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=pO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qq.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Lq.bind(null,e),e.Pu.H_=Cq.bind(null,e.eventManager),e.Pu.yu=Iq.bind(null,e.eventManager),e}function bO(n){const e=ct(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Bq.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Uq.bind(null,e),e}class rp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fv(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return JP(this.persistence,new ZP,e.initialUser,this.serializer)}Cu(e){return new Gw(Uv.mi,this.serializer)}Du(e){return new nO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rp.provider={build:()=>new rp};class Hq extends rp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ue(this.persistence.referenceDelegate instanceof K0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new YP(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ir.withCacheSize(this.cacheSizeBytes):Ir.DEFAULT;return new Gw((r=>K0.mi(r,t)),this.serializer)}}class $q extends rp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await bO(this.xu.syncEngine),await Pp(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return JP(this.persistence,new ZP,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new YP(r,e.asyncQueue,t)}Mu(e,t){const r=new ZF(t,this.persistence);return new QF(e.asyncQueue,r)}Cu(e){const t=$G(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ir.withCacheSize(this.cacheSizeBytes):Ir.DEFAULT;return new qw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,oq(),p0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new nO}}class W0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>xR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Gq.bind(null,this.syncEngine),await Sq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Aq})()}createDatastore(e){const t=Fv(e.databaseInfo.databaseId),r=(function(a){return new sq(a)})(e.databaseInfo);return(function(a,o,c,u){return new dq(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,o,c){return new hq(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>xR(this.syncEngine,t,0)),(function(){return pR.v()?new pR:new nq})())}createSyncEngine(e,t){return(function(i,a,o,c,u,d,h){const p=new Nq(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=ct(t);Te(Nc,"RemoteStore shutting down."),r.Ea.add(5),await Mp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}W0.provider={build:()=>new W0};class aE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Fr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ol="FirestoreClient";class Yq{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Er.UNAUTHENTICATED,this.clientId=Ew.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Te(ol,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Te(ol,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Zw(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ox(n,e){n.asyncQueue.verifyOperationInProgress(),Te(ol,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await eO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function wR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Kq(n);Te(ol,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>mR(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>mR(e.remoteStore,i))),n._onlineComponents=e}async function Kq(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Te(ol,"Using user provided OfflineComponentProvider");try{await Ox(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===me.FAILED_PRECONDITION||i.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Tc("Error using user provided cache. Falling back to memory cache: "+t),await Ox(n,new rp)}}else Te(ol,"Using default OfflineComponentProvider"),await Ox(n,new Hq(void 0));return n._offlineComponents}async function xO(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Te(ol,"Using user provided OnlineComponentProvider"),await wR(n,n._uninitializedComponentsProvider._online)):(Te(ol,"Using default OnlineComponentProvider"),await wR(n,new W0))),n._onlineComponents}function Xq(n){return xO(n).then((e=>e.syncEngine))}async function Q0(n){const e=await xO(n),t=e.eventManager;return t.onListen=Mq.bind(null,e.syncEngine),t.onUnlisten=jq.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Pq.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Vq.bind(null,e.syncEngine),t}function Wq(n,e,t={}){const r=new Wa;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new aE({next:m=>{h.Nu(),o.enqueueAndForget((()=>eE(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Ie(me.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Ie(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new nE(Rp(c.path),h,{includeMetadataChanges:!0,qa:!0});return Jw(a,p)})(await Q0(n),n.asyncQueue,e,t,r))),r.promise}function Qq(n,e,t={}){const r=new Wa;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new aE({next:m=>{h.Nu(),o.enqueueAndForget((()=>eE(a,p))),m.fromCache&&u.source==="server"?d.reject(new Ie(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new nE(c,h,{includeMetadataChanges:!0,qa:!0});return Jw(a,p)})(await Q0(n),n.asyncQueue,e,t,r))),r.promise}function _O(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const ER=new Map;const wO="firestore.googleapis.com",SR=!0;class TR{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=wO,this.ssl=SR}else this.host=e.host,this.ssl=e.ssl??SR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=GP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RG)throw new Ie(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_O(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ie(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ie(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ie(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new TR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new TR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new VF;switch(r.type){case"firstParty":return new UF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ie(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=ER.get(t);r&&(Te("ComponentProvider","Removing Datastore"),ER.delete(t),r.terminate())})(this),Promise.resolve()}}function Zq(n,e,t,r={}){n=kr(n,qv);const i=Od(e),a=n._getSettings(),o={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(CN(`https://${c}`),IN("Firestore",!0)),a.host!==wO&&a.host!==c&&Tc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!rl(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=Er.MOCK_USER;else{d=H9(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ie(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Er(p)}n._authCredentials=new zF(new IM(d,h))}}class Zs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Zs(this.firestore,e,this._query)}}class Nn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nn(this.firestore,e,this._key)}toJSON(){return{type:Nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ap(t,Nn._jsonSchema))return new Nn(e,r||null,new De(Lt.fromString(t.referencePath)))}}Nn._jsonSchemaVersion="firestore/documentReference/1.0",Nn._jsonSchema={type:Zn("string",Nn._jsonSchemaVersion),referencePath:Zn("string")};class tl extends Zs{constructor(e,t,r){super(e,t,Rp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nn(this.firestore,null,new De(e))}withConverter(e){return new tl(this.firestore,e,this._path)}}function Vi(n,e,...t){if(n=dn(n),DM("collection","path",e),n instanceof qv){const r=Lt.fromString(e,...t);return gI(r),new tl(n,null,r)}{if(!(n instanceof Nn||n instanceof tl))throw new Ie(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Lt.fromString(e,...t));return gI(r),new tl(n.firestore,null,r)}}function Ut(n,e,...t){if(n=dn(n),arguments.length===1&&(e=Ew.newId()),DM("doc","path",e),n instanceof qv){const r=Lt.fromString(e,...t);return pI(r),new Nn(n,null,new De(r))}{if(!(n instanceof Nn||n instanceof tl))throw new Ie(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Lt.fromString(e,...t));return pI(r),new Nn(n.firestore,n instanceof tl?n.converter:null,new De(r))}}const AR="AsyncQueue";class CR{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new rO(this,"async_queue_retry"),this._c=()=>{const r=p0();r&&Te(AR,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=p0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=p0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Wa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!gl(e))throw e;Te(AR,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Fr("INTERNAL UNHANDLED ERROR: ",IR(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Qw.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Ve(47125,{Pc:IR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function IR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function RR(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class pa extends qv{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new CR,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new CR(e),this._firestoreClient=void 0,await e}}}function Jq(n,e){const t=typeof n=="object"?n:jN(),r=typeof n=="string"?n:L0,i=hw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=G9("firestore");a&&Zq(i,...a)}return i}function jp(n){if(n._terminated)throw new Ie(me.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||EO(n),n._firestoreClient}function EO(n){const e=n._freezeSettings(),t=(function(i,a,o,c){return new C7(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,_O(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Yq(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}function eH(n,e){Tc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return tH(n,W0.provider,{build:r=>new $q(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function tH(n,e,t){if((n=kr(n,pa))._firestoreClient||n._terminated)throw new Ie(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ie(me.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},EO(n)}class Li{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Li(Jn.fromBase64String(e))}catch(t){throw new Ie(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Li(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Li._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ap(e,Li._jsonSchema))return Li.fromBase64String(e.bytes)}}Li._jsonSchemaVersion="firestore/bytes/1.0",Li._jsonSchema={type:Zn("string",Li._jsonSchemaVersion),bytes:Zn("string")};class Vp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new En(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Hv{constructor(e){this._methodName=e}}class Qa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Qa._jsonSchemaVersion}}static fromJSON(e){if(Ap(e,Qa._jsonSchema))return new Qa(e.latitude,e.longitude)}}Qa._jsonSchemaVersion="firestore/geoPoint/1.0",Qa._jsonSchema={type:Zn("string",Qa._jsonSchemaVersion),latitude:Zn("number"),longitude:Zn("number")};class Za{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Za._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ap(e,Za._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Za(e.vectorValues);throw new Ie(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Za._jsonSchemaVersion="firestore/vectorValue/1.0",Za._jsonSchema={type:Zn("string",Za._jsonSchemaVersion),vectorValues:Zn("object")};const nH=/^__.*__$/;class rH{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Qs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ld(e,this.data,t,this.fieldTransforms)}}class SO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Qs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function TO(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:n})}}class $v{constructor(e,t,r,i,a,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new $v({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Z0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(TO(this.Ac)&&nH.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class iH{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Fv(e)}Cc(e,t,r,i=!1){return new $v({Ac:e,methodName:t,Dc:r,path:En.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zp(n){const e=n._freezeSettings(),t=Fv(n._databaseId);return new iH(n._databaseId,!!e.ignoreUndefinedProperties,t)}function sE(n,e,t,r,i,a={}){const o=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);lE("Data must be an object, but it was:",o,r);const c=IO(r,o);let u,d;if(a.merge)u=new ti(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=i_(e,p,t);if(!o.contains(m))throw new Ie(me.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);DO(h,m)||h.push(m)}u=new ti(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new rH(new Rr(c),u,d)}class Lp extends Hv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lp}}function aH(n,e,t){return new $v({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class oE extends Hv{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=aH(this,e,!0),r=this.vc.map((a=>Ud(a,t))),i=new Ic(r);return new xP(e.path,i)}isEqual(e){return e instanceof oE&&rl(this.vc,e.vc)}}function AO(n,e,t,r){const i=n.Cc(1,e,t);lE("Data must be an object, but it was:",i,r);const a=[],o=Rr.empty();ml(r,((u,d)=>{const h=cE(e,u,t);d=dn(d);const p=i.yc(h);if(d instanceof Lp)a.push(h);else{const m=Ud(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new ti(a);return new SO(o,c,i.fieldTransforms)}function CO(n,e,t,r,i,a){const o=n.Cc(1,e,t),c=[i_(e,r,t)],u=[i];if(a.length%2!=0)throw new Ie(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(i_(e,a[m])),u.push(a[m+1]);const d=[],h=Rr.empty();for(let m=c.length-1;m>=0;--m)if(!DO(d,c[m])){const b=c[m];let _=u[m];_=dn(_);const w=o.yc(b);if(_ instanceof Lp)d.push(b);else{const S=Ud(_,w);S!=null&&(d.push(b),h.set(b,S))}}const p=new ti(d);return new SO(h,p,o.fieldTransforms)}function sH(n,e,t,r=!1){return Ud(t,n.Cc(r?4:3,e))}function Ud(n,e){if(RO(n=dn(n)))return lE("Unsupported field value:",e,n),IO(n,e);if(n instanceof Hv)return(function(r,i){if(!TO(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=Ud(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=dn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Y7(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=vt.fromDate(r);return{timestampValue:xd(i.serializer,a)}}if(r instanceof vt){const a=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xd(i.serializer,a)}}if(r instanceof Qa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Li)return{bytesValue:CP(i.serializer,r._byteString)};if(r instanceof Nn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Lw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Za)return(function(o,c){return{mapValue:{fields:{[kw]:{stringValue:Nw},[gd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Pw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Cv(r)}`)})(n,e)}function IO(n,e){const t={};return $M(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ml(n,((r,i)=>{const a=Ud(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function RO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof vt||n instanceof Qa||n instanceof Li||n instanceof Nn||n instanceof Hv||n instanceof Za)}function lE(n,e,t){if(!RO(t)||!kM(t)){const r=Cv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function i_(n,e,t){if((e=dn(e))instanceof Vp)return e._internalPath;if(typeof e=="string")return cE(n,e);throw Z0("Field path arguments must be of type string or ",n,!1,void 0,t)}const oH=new RegExp("[~\\*/\\[\\]]");function cE(n,e,t){if(e.search(oH)>=0)throw Z0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vp(...e.split("."))._internalPath}catch{throw Z0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Z0(n,e,t,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Ie(me.INVALID_ARGUMENT,c+n+u)}function DO(n,e){return n.some((t=>t.isEqual(e)))}class kO{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lH extends kO{data(){return super.data()}}function Yv(n,e){return typeof e=="string"?cE(n,e):e instanceof Vp?e._internalPath:e._delegate._internalPath}function NO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class uE{}class dE extends uE{}function Fs(n,e,...t){let r=[];e instanceof uE&&r.push(e),r=r.concat(t),(function(a){const o=a.filter((u=>u instanceof fE)).length,c=a.filter((u=>u instanceof Kv)).length;if(o>1||o>0&&c>0)throw new Ie(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Kv extends dE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Kv(e,t,r)}_apply(e){const t=this._parse(e);return MO(e._query,t),new Zs(e.firestore,e.converter,$1(e._query,t))}_parse(e){const t=zp(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ie(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){NR(p,h);const _=[];for(const w of p)_.push(kR(u,a,w));m={arrayValue:{values:_}}}else m=kR(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||NR(p,h),m=sH(c,o,p,h==="in"||h==="not-in");return Ct.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function cH(n,e,t){const r=e,i=Yv("where",n);return Kv._create(i,r,t)}class fE extends uE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fE(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:$t.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)MO(o,u),o=$1(o,u)})(e._query,t),new Zs(e.firestore,e.converter,$1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hE extends dE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new hE(e,t)}_apply(e){const t=(function(i,a,o){if(i.startAt!==null)throw new Ie(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ie(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ep(a,o)})(e._query,this._field,this._direction);return new Zs(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new zd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function wd(n,e="asc"){const t=e,r=Yv("orderBy",n);return hE._create(r,t)}class pE extends dE{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new pE(e,t,r)}_apply(e){return new Zs(e.firestore,e.converter,F0(e._query,this._limit,this._limitType))}}function DR(n){return pE._create("limit",n,"F")}function kR(n,e,t){if(typeof(t=dn(t))=="string"){if(t==="")throw new Ie(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cP(e)&&t.indexOf("/")!==-1)throw new Ie(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Lt.fromString(t));if(!De.isDocumentKey(r))throw new Ie(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Zh(n,new De(r))}if(t instanceof Nn)return Zh(n,t._key);throw new Ie(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Cv(t)}.`)}function NR(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function MO(n,e){const t=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class uH{convertValue(e,t="none"){switch(il(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ml(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[gd].arrayValue?.values?.map((r=>mn(r.doubleValue)));return new Za(t)}convertGeoPoint(e){return new Qa(mn(e.latitude),mn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Mv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Wh(e));default:return null}}convertTimestamp(e){const t=Bs(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Lt.fromString(e);Ue(VP(r),9688,{name:e});const i=new Ac(r.get(1),r.get(3)),a=new De(r.popFirst(5));return i.isEqual(t)||Fr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function gE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class uh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mc extends kO{constructor(e,t,r,i,a,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new g0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Yv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=mc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}mc._jsonSchemaVersion="firestore/documentSnapshot/1.0",mc._jsonSchema={type:Zn("string",mc._jsonSchemaVersion),bundleSource:Zn("string","DocumentSnapshot"),bundleName:Zn("string"),bundle:Zn("string")};class g0 extends mc{data(e={}){return super.data(e)}}class vc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new uh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new g0(this._firestore,this._userDataWriter,r.key,r,new uh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new uh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new uh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:dH(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=vc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ew.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function dH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:n})}}function jx(n){n=kr(n,Nn);const e=kr(n.firestore,pa);return Wq(jp(e),n._key).then((t=>PO(e,n,t)))}vc._jsonSchemaVersion="firestore/querySnapshot/1.0",vc._jsonSchema={type:Zn("string",vc._jsonSchemaVersion),bundleSource:Zn("string","QuerySnapshot"),bundleName:Zn("string"),bundle:Zn("string")};class mE extends uH{constructor(e){super(),this.firestore=e}convertBytes(e){return new Li(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Nn(this.firestore,null,t)}}function Fa(n){n=kr(n,Zs);const e=kr(n.firestore,pa),t=jp(e),r=new mE(e);return NO(n._query),Qq(t,n._query).then((i=>new vc(e,r,n,i)))}function sa(n,e,t){n=kr(n,Nn);const r=kr(n.firestore,pa),i=gE(n.converter,e,t);return Up(r,[sE(zp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,lr.none())])}function Ba(n,e,t,...r){n=kr(n,Nn);const i=kr(n.firestore,pa),a=zp(i);let o;return o=typeof(e=dn(e))=="string"||e instanceof Vp?CO(a,"updateDoc",n._key,e,t,r):AO(a,"updateDoc",n._key,e),Up(i,[o.toMutation(n._key,lr.exists(!0))])}function Ga(n){return Up(kr(n.firestore,pa),[new kp(n._key,lr.none())])}function Xv(n,e){const t=kr(n.firestore,pa),r=Ut(n),i=gE(n.converter,e);return Up(t,[sE(zp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,lr.exists(!1))]).then((()=>r))}function Bp(n,...e){n=dn(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||RR(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(RR(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(n instanceof Nn)o=kr(n.firestore,pa),c=Rp(n._key.path),a={next:u=>{e[r]&&e[r](PO(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=kr(n,Zs);o=kr(u.firestore,pa),c=u._query;const d=new mE(o);a={next:h=>{e[r]&&e[r](new vc(o,d,u,h))},error:e[r+1],complete:e[r+2]},NO(n._query)}return(function(d,h,p,m){const b=new aE(m),_=new nE(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>Jw(await Q0(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>eE(await Q0(d),_)))}})(jp(o),c,i,a)}function Up(n,e){return(function(r,i){const a=new Wa;return r.asyncQueue.enqueueAndForget((async()=>zq(await Xq(r),i,a))),a.promise})(jp(n),e)}function PO(n,e,t){const r=t.docs.get(e._key),i=new mE(n);return new mc(n,i,e._key,r,new uh(t.hasPendingWrites,t.fromCache),e.converter)}class fH{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zp(e)}set(e,t,r){this._verifyNotCommitted();const i=Vx(e,this._firestore),a=gE(i.converter,t,r),o=sE(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,lr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Vx(e,this._firestore);let o;return o=typeof(t=dn(t))=="string"||t instanceof Vp?CO(this._dataReader,"WriteBatch.update",a._key,t,r,i):AO(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,lr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Vx(e,this._firestore);return this._mutations=this._mutations.concat(new kp(t._key,lr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Vx(n,e){if((n=dn(n)).firestore!==e)throw new Ie(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function MR(){return new Lp("deleteField")}function hH(...n){return new oE("arrayUnion",n)}function pH(n){return jp(n=kr(n,pa)),new fH(n,(e=>Up(n,e)))}(function(e,t=!0){(function(i){Vd=i})(jd),ld(new _c("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new pa(new LF(r.getProvider("auth-internal")),new FF(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ie(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ac(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Zo(uI,dI,e),Zo(uI,dI,"esm2020")})();const gH={apiKey:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:d7a8169fd53f437e42aba9"},OO=ON(gH),jo=MF(OO),mt=Jq(OO);eH(mt).catch(n=>{n.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",n)});const zx=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),ca=uw()(bN(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await m8(jo,e,t)).user;if(!i.emailVerified)return await J2(jo),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;const a=zx(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await g8(jo,e,t)).user;await y8(a,{displayName:r}),await Z2(a);const o=zx(a);return n({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await J2(jo),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await p8(jo,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=jo.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await Z2(e),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=ca.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},deleteAccount:async e=>{const t=jo.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=zc.credential(t.email,e);return await h8(t,r),await w8(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>ca.getState().isInitialized?()=>{}:(n({isInitialized:!1}),_8(jo,r=>{const i=Date.now(),a=ca.getState(),o=r?zx(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m?console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"):console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),gn=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:ca},Symbol.toStringTag,{value:"Module"})),jO=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],mH=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=jO.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},vE=n=>{const e=jO.map(i=>({...i,met:i.regex.test(n)})),t=mH(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},vH=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=vE(n);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},yH=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=vE(n);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(_L,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(wv,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},bH=()=>{const[n,e]=U.useState(""),[t,r]=U.useState(""),[i,a]=U.useState(""),[o,c]=U.useState(!1),[u,d]=U.useState(!1),[h,p]=U.useState(!1),[m,b]=U.useState(!1),{login:_,register:w,sendPasswordReset:S,isLoading:T,loginError:C,clearError:D}=ca(),O=vE(t),M=async A=>{if(A.preventDefault(),D(),n.trim()&&t.trim())if(u){if(!i.trim()||!O.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},V=async A=>{A.preventDefault(),n.trim()&&await S(n.trim())&&b(!0)};return U.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:V,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(E1,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(E1,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:n})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(od,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(od,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:M,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:t,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!O.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx(jL,{className:"h-5 w-5"}):v.jsx(zL,{className:"h-5 w-5"})})]}),u&&t&&v.jsx("div",{className:"mt-2",children:v.jsx(vH,{password:t})}),u&&t&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(yH,{password:t})})]}),C&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!O.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(E9,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},VO=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(!1),{currentUser:i,resendEmailVerification:a,logout:o,loginError:c}=ca();U.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]);const u=async()=>{e(!0),r(!1);const h=await a();e(!1),h&&(r(!0),setTimeout(()=>r(!1),3e3))},d=async()=>{await o()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(E1,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(w1,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),c&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:c}),t&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:u,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?v.jsxs(v.Fragment,{children:[v.jsx(Lh,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(Lh,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:d,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(od,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},zO=({message:n="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(Lh,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(_v,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),yE=U.createContext({});function Wv(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const bE=typeof window<"u",xE=bE?U.useLayoutEffect:U.useEffect,Qv=U.createContext(null);function _E(n,e){n.indexOf(e)===-1&&n.push(e)}function wE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Gs=(n,e,t)=>t>e?e:t<n?n:t;let EE=()=>{};const qs={},LO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function BO(n){return typeof n=="object"&&n!==null}const UO=n=>/^0[^.\s]+$/u.test(n);function SE(n){let e;return()=>(e===void 0&&(e=n()),e)}const Gi=n=>n,xH=(n,e)=>t=>e(n(t)),Fp=(...n)=>n.reduce(xH),ip=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class TE{constructor(){this.subscriptions=[]}add(e){return _E(this.subscriptions,e),()=>wE(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ja=n=>n*1e3,Ui=n=>n/1e3;function FO(n,e){return e?n*(1e3/e):0}const GO=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,_H=1e-7,wH=12;function EH(n,e,t,r,i){let a,o,c=0;do o=e+(t-e)/2,a=GO(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>_H&&++c<wH);return o}function Gp(n,e,t,r){if(n===e&&t===r)return Gi;const i=a=>EH(a,0,1,n,t);return a=>a===0||a===1?a:GO(i(a),e,r)}const qO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,HO=n=>e=>1-n(1-e),$O=Gp(.33,1.53,.69,.99),AE=HO($O),YO=qO(AE),KO=n=>(n*=2)<1?.5*AE(n):.5*(2-Math.pow(2,-10*(n-1))),CE=n=>1-Math.sin(Math.acos(n)),XO=HO(CE),WO=qO(CE),SH=Gp(.42,0,1,1),TH=Gp(0,0,.58,1),QO=Gp(.42,0,.58,1),AH=n=>Array.isArray(n)&&typeof n[0]!="number",ZO=n=>Array.isArray(n)&&typeof n[0]=="number",CH={linear:Gi,easeIn:SH,easeInOut:QO,easeOut:TH,circIn:CE,circInOut:WO,circOut:XO,backIn:AE,backInOut:YO,backOut:$O,anticipate:KO},IH=n=>typeof n=="string",PR=n=>{if(ZO(n)){EE(n.length===4);const[e,t,r,i]=n;return Gp(e,t,r,i)}else if(IH(n))return CH[n];return n},Pm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function RH(n,e){let t=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const DH=40;function JO(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=Pm.reduce((D,O)=>(D[O]=RH(a),D),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=o,w=()=>{const D=qs.useManualTiming?i.timestamp:performance.now();t=!1,qs.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(D-i.timestamp,DH),1)),i.timestamp=D,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},S=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:Pm.reduce((D,O)=>{const M=o[O];return D[O]=(V,A=!1,I=!1)=>(t||S(),M.schedule(V,A,I)),D},{}),cancel:D=>{for(let O=0;O<Pm.length;O++)o[Pm[O]].cancel(D)},state:i,steps:o}}const{schedule:vn,cancel:ll,state:wr,steps:Lx}=JO(typeof requestAnimationFrame<"u"?requestAnimationFrame:Gi,!0);let m0;function kH(){m0=void 0}const ni={now:()=>(m0===void 0&&ni.set(wr.isProcessing||qs.useManualTiming?wr.timestamp:performance.now()),m0),set:n=>{m0=n,queueMicrotask(kH)}},e4=n=>e=>typeof e=="string"&&e.startsWith(n),IE=e4("--"),NH=e4("var(--"),RE=n=>NH(n)?MH.test(n.split("/*")[0].trim()):!1,MH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Fd={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},ap={...Fd,transform:n=>Gs(0,1,n)},Om={...Fd,default:1},Ch=n=>Math.round(n*1e5)/1e5,DE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function PH(n){return n==null}const OH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,kE=(n,e)=>t=>!!(typeof t=="string"&&OH.test(t)&&t.startsWith(n)||e&&!PH(t)&&Object.prototype.hasOwnProperty.call(t,e)),t4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(DE);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},jH=n=>Gs(0,255,n),Bx={...Fd,transform:n=>Math.round(jH(n))},lc={test:kE("rgb","red"),parse:t4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+Bx.transform(n)+", "+Bx.transform(e)+", "+Bx.transform(t)+", "+Ch(ap.transform(r))+")"};function VH(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const a_={test:kE("#"),parse:VH,transform:lc.transform},qp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Lo=qp("deg"),es=qp("%"),tt=qp("px"),zH=qp("vh"),LH=qp("vw"),OR={...es,parse:n=>es.parse(n)/100,transform:n=>es.transform(n*100)},Gu={test:kE("hsl","hue"),parse:t4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+es.transform(Ch(e))+", "+es.transform(Ch(t))+", "+Ch(ap.transform(r))+")"},Wn={test:n=>lc.test(n)||a_.test(n)||Gu.test(n),parse:n=>lc.test(n)?lc.parse(n):Gu.test(n)?Gu.parse(n):a_.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?lc.transform(n):Gu.transform(n),getAnimatableNone:n=>{const e=Wn.parse(n);return e.alpha=0,Wn.transform(e)}},BH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function UH(n){return isNaN(n)&&typeof n=="string"&&(n.match(DE)?.length||0)+(n.match(BH)?.length||0)>0}const n4="number",r4="color",FH="var",GH="var(",jR="${}",qH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function sp(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(qH,u=>(Wn.test(u)?(r.color.push(a),i.push(r4),t.push(Wn.parse(u))):u.startsWith(GH)?(r.var.push(a),i.push(FH),t.push(u)):(r.number.push(a),i.push(n4),t.push(parseFloat(u))),++a,jR)).split(jR);return{values:t,split:c,indexes:r,types:i}}function i4(n){return sp(n).values}function a4(n){const{split:e,types:t}=sp(n),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=t[o];c===n4?a+=Ch(i[o]):c===r4?a+=Wn.transform(i[o]):a+=i[o]}return a}}const HH=n=>typeof n=="number"?0:Wn.test(n)?Wn.getAnimatableNone(n):n;function $H(n){const e=i4(n);return a4(n)(e.map(HH))}const cl={test:UH,parse:i4,createTransformer:a4,getAnimatableNone:$H};function Ux(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function YH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=Ux(u,c,n+1/3),a=Ux(u,c,n),o=Ux(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function J0(n,e){return t=>t>0?e:n}const Sn=(n,e,t)=>n+(e-n)*t,Fx=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},KH=[a_,lc,Gu],XH=n=>KH.find(e=>e.test(n));function VR(n){const e=XH(n);if(!e)return!1;let t=e.parse(n);return e===Gu&&(t=YH(t)),t}const zR=(n,e)=>{const t=VR(n),r=VR(e);if(!t||!r)return J0(n,e);const i={...t};return a=>(i.red=Fx(t.red,r.red,a),i.green=Fx(t.green,r.green,a),i.blue=Fx(t.blue,r.blue,a),i.alpha=Sn(t.alpha,r.alpha,a),lc.transform(i))},s_=new Set(["none","hidden"]);function WH(n,e){return s_.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function QH(n,e){return t=>Sn(n,e,t)}function NE(n){return typeof n=="number"?QH:typeof n=="string"?RE(n)?J0:Wn.test(n)?zR:e$:Array.isArray(n)?s4:typeof n=="object"?Wn.test(n)?zR:ZH:J0}function s4(n,e){const t=[...n],r=t.length,i=n.map((a,o)=>NE(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)t[o]=i[o](a);return t}}function ZH(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=NE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function JH(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=n.indexes[a][r[a]],c=n.values[o]??0;t[i]=c,r[a]++}return t}const e$=(n,e)=>{const t=cl.createTransformer(e),r=sp(n),i=sp(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?s_.has(n)&&!i.values.length||s_.has(e)&&!r.values.length?WH(n,e):Fp(s4(JH(r,i),i.values),t):J0(n,e)};function o4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Sn(n,e,t):NE(n)(n,e)}const t$=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>vn.update(e,t),stop:()=>ll(e),now:()=>wr.isProcessing?wr.timestamp:ni.now()}},l4=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},ev=2e4;function ME(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<ev;)e+=t,r=n.next(e);return e>=ev?1/0:e}function n$(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(ME(r),ev);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Ui(i)}}const r$=5;function c4(n,e,t){const r=Math.max(e-r$,0);return FO(t-n(r),e-r)}const Rn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Gx=.001;function i$({duration:n=Rn.duration,bounce:e=Rn.bounce,velocity:t=Rn.velocity,mass:r=Rn.mass}){let i,a,o=1-e;o=Gs(Rn.minDamping,Rn.maxDamping,o),n=Gs(Rn.minDuration,Rn.maxDuration,Ui(n)),o<1?(i=d=>{const h=d*o,p=h*n,m=h-t,b=o_(d,o),_=Math.exp(-p);return Gx-m/b*_},a=d=>{const p=d*o*n,m=p*t+t,b=Math.pow(o,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=o_(Math.pow(d,2),o);return(-i(d)+Gx>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-Gx+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=s$(i,a,c);if(n=Ja(n),isNaN(u))return{stiffness:Rn.stiffness,damping:Rn.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const a$=12;function s$(n,e,t){let r=t;for(let i=1;i<a$;i++)r=r-n(r)/e(r);return r}function o_(n,e){return n*Math.sqrt(1-e*e)}const o$=["duration","bounce"],l$=["stiffness","damping","mass"];function LR(n,e){return e.some(t=>n[t]!==void 0)}function c$(n){let e={velocity:Rn.velocity,stiffness:Rn.stiffness,damping:Rn.damping,mass:Rn.mass,isResolvedFromDuration:!1,...n};if(!LR(n,l$)&&LR(n,o$))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*Gs(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Rn.mass,stiffness:i,damping:a}}else{const t=i$(n);e={...e,...t,mass:Rn.mass},e.isResolvedFromDuration=!0}return e}function tv(n=Rn.visualDuration,e=Rn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=c$({...t,velocity:-Ui(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),S=o-a,T=Ui(Math.sqrt(u/h)),C=Math.abs(S)<5;r||(r=C?Rn.restSpeed.granular:Rn.restSpeed.default),i||(i=C?Rn.restDelta.granular:Rn.restDelta.default);let D;if(w<1){const M=o_(T,w);D=V=>{const A=Math.exp(-w*T*V);return o-A*((_+w*T*S)/M*Math.sin(M*V)+S*Math.cos(M*V))}}else if(w===1)D=M=>o-Math.exp(-T*M)*(S+(_+T*S)*M);else{const M=T*Math.sqrt(w*w-1);D=V=>{const A=Math.exp(-w*T*V),I=Math.min(M*V,300);return o-A*((_+w*T*S)*Math.sinh(I)+M*S*Math.cosh(I))/M}}const O={calculatedDuration:b&&p||null,next:M=>{const V=D(M);if(b)c.done=M>=p;else{let A=M===0?_:0;w<1&&(A=M===0?Ja(_):c4(D,M,V));const I=Math.abs(A)<=r,k=Math.abs(o-V)<=i;c.done=I&&k}return c.value=c.done?o:V,c},toString:()=>{const M=Math.min(ME(O),ev),V=l4(A=>O.next(M*A).value,M,30);return M+"ms "+V},toTransition:()=>{}};return O}tv.applyToOptions=n=>{const e=n$(n,100,tv);return n.ease=e.ease,n.duration=Ja(e.duration),n.type="keyframes",n};function l_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=I=>c!==void 0&&I<c||u!==void 0&&I>u,_=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let w=t*e;const S=p+w,T=o===void 0?S:o(S);T!==S&&(w=T-p);const C=I=>-w*Math.exp(-I/r),D=I=>T+C(I),O=I=>{const k=C(I),z=D(I);m.done=Math.abs(k)<=d,m.value=m.done?T:z};let M,V;const A=I=>{b(m.value)&&(M=I,V=tv({keyframes:[m.value,_(m.value)],velocity:c4(D,I,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:I=>{let k=!1;return!V&&M===void 0&&(k=!0,O(I),A(I)),M!==void 0&&I>=M?V.next(I-M):(!k&&O(I),m)}}}function u$(n,e,t){const r=[],i=t||qs.mix||o4,a=n.length-1;for(let o=0;o<a;o++){let c=i(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Gi:e;c=Fp(u,c)}r.push(c)}return r}function d$(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(EE(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=u$(e,r,i),u=c.length,d=h=>{if(o&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=ip(n[p],n[p+1],h);return c[p](m)};return t?h=>d(Gs(n[0],n[a-1],h)):d}function f$(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=ip(0,e,r);n.push(Sn(t,1,i))}}function h$(n){const e=[0];return f$(e,n.length-1),e}function p$(n,e){return n.map(t=>t*e)}function g$(n,e){return n.map(()=>e||QO).splice(0,n.length-1)}function Ih({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=AH(r)?r.map(PR):PR(r),a={done:!1,value:e[0]},o=p$(t&&t.length===e.length?t:h$(e),n),c=d$(o,e,{ease:Array.isArray(i)?i:g$(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const m$=n=>n!==null;function PE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(m$),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const v$={decay:l_,inertia:l_,tween:Ih,keyframes:Ih,spring:tv};function u4(n){typeof n.type=="string"&&(n.type=v$[n.type])}class OE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const y$=n=>n/100;class jE extends OE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==ni.now()&&this.tick(ni.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;u4(e);const{type:t=Ih,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=t||Ih;u!==Ih&&typeof c[0]!="number"&&(this.mixKeyframes=Fp(y$,o4(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=ME(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let D=this.currentTime,O=r;if(p){const I=Math.min(this.currentTime,i)/c;let k=Math.floor(I),z=I%1;!z&&I>=1&&(z=1),z===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(z=1-z,b&&(z-=b/c)):m==="mirror"&&(O=o)),D=Gs(0,1,z)*c}const M=C?{done:!1,value:h[0]}:O.next(D);a&&(M.value=a(M.value));let{done:V}=M;!C&&u!==null&&(V=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return A&&_!==l_&&(M.value=PE(h,this.options,S,this.speed)),w&&w(M.value),A&&this.finish(),M}then(e,t){return this.finished.then(e,t)}get duration(){return Ui(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ui(e)}get time(){return Ui(this.currentTime)}set time(e){e=Ja(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ni.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ui(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=t$,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ni.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function b$(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const cc=n=>n*180/Math.PI,c_=n=>{const e=cc(Math.atan2(n[1],n[0]));return u_(e)},x$={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:c_,rotateZ:c_,skewX:n=>cc(Math.atan(n[1])),skewY:n=>cc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},u_=n=>(n=n%360,n<0&&(n+=360),n),BR=c_,UR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),FR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),_$={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:UR,scaleY:FR,scale:n=>(UR(n)+FR(n))/2,rotateX:n=>u_(cc(Math.atan2(n[6],n[5]))),rotateY:n=>u_(cc(Math.atan2(-n[2],n[0]))),rotateZ:BR,rotate:BR,skewX:n=>cc(Math.atan(n[4])),skewY:n=>cc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function d_(n){return n.includes("scale")?1:0}function f_(n,e){if(!n||n==="none")return d_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=_$,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=x$,i=c}if(!i)return d_(e);const a=r[e],o=i[1].split(",").map(E$);return typeof a=="function"?a(o):o[a]}const w$=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return f_(t,e)};function E$(n){return parseFloat(n.trim())}const Gd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],qd=new Set(Gd),GR=n=>n===Fd||n===tt,S$=new Set(["x","y","z"]),T$=Gd.filter(n=>!S$.has(n));function A$(n){const e=[];return T$.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const yc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>f_(e,"x"),y:(n,{transform:e})=>f_(e,"y")};yc.translateX=yc.x;yc.translateY=yc.y;const bc=new Set;let h_=!1,p_=!1,g_=!1;function d4(){if(p_){const n=Array.from(bc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=A$(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}p_=!1,h_=!1,bc.forEach(n=>n.complete(g_)),bc.clear()}function f4(){bc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(p_=!0)})}function C$(){g_=!0,f4(),d4(),g_=!1}class VE{constructor(e,t,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(bc.add(this),h_||(h_=!0,vn.read(f4),vn.resolveKeyframes(d4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}b$(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),bc.delete(this)}cancel(){this.state==="scheduled"&&(bc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const I$=n=>n.startsWith("--");function R$(n,e,t){I$(e)?n.style.setProperty(e,t):n.style[e]=t}const D$=SE(()=>window.ScrollTimeline!==void 0),k$={};function N$(n,e){const t=SE(n);return()=>k$[e]??t()}const h4=N$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),dh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,qR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:dh([0,.65,.55,1]),circOut:dh([.55,0,1,.45]),backIn:dh([.31,.01,.66,-.59]),backOut:dh([.33,1.53,.69,.99])};function p4(n,e){if(n)return typeof n=="function"?h4()?l4(n,e):"ease-out":ZO(n)?dh(n):Array.isArray(n)?n.map(t=>p4(t,e)||qR.easeOut):qR[n]}function M$(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=p4(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function g4(n){return typeof n=="function"&&"applyToOptions"in n}function P$({type:n,...e}){return g4(n)&&h4()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class O$ extends OE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,EE(typeof e.type!="string");const d=P$(e);this.animation=M$(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=PE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):R$(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Ui(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ui(e)}get time(){return Ui(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ja(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&D$()?(this.animation.timeline=e,Gi):t(this)}}const m4={anticipate:KO,backInOut:YO,circInOut:WO};function j$(n){return n in m4}function V$(n){typeof n.ease=="string"&&j$(n.ease)&&(n.ease=m4[n.ease])}const HR=10;class z$ extends O${constructor(e){V$(e),u4(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new jE({...o,autoplay:!1}),u=Ja(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-HR).value,c.sample(u).value,HR),c.stop()}}const $R=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(cl.test(n)||n==="0")&&!n.startsWith("url("));function L$(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function B$(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],o=$R(i,e),c=$R(a,e);return!o||!c?!1:L$(n)||(t==="spring"||g4(t))&&r}function m_(n){n.duration=0,n.type="keyframes"}const U$=new Set(["opacity","clipPath","filter","transform"]),F$=SE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function G$(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return F$()&&t&&U$.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const q$=40;class H$ extends OE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ni.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||VE;this.keyframeResolver=new b(c,(_,w,S)=>this.onKeyframesResolved(_,w,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=ni.now(),B$(e,a,o,c)||((qs.instantAnimations||!u)&&h?.(PE(e,r,t)),e[0]=e[e.length-1],m_(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>q$?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&G$(m)?new z$({...m,element:m.motionValue.owner.current}):new jE(m);b.finished.then(()=>this.notifyFinished()).catch(Gi),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),C$()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const $$=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Y$(n){const e=$$.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function v4(n,e,t=1){const[r,i]=Y$(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return LO(o)?parseFloat(o):o}return RE(i)?v4(i,e,t+1):i}function zE(n,e){return n?.[e]??n?.default??n}const y4=new Set(["width","height","top","left","right","bottom",...Gd]),K$={test:n=>n==="auto",parse:n=>n},b4=n=>e=>e.test(n),x4=[Fd,tt,es,Lo,LH,zH,K$],YR=n=>x4.find(b4(n));function X$(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||UO(n):!0}const W$=new Set(["brightness","contrast","saturate","opacity"]);function Q$(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(DE)||[];if(!r)return n;const i=t.replace(r,"");let a=W$.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const Z$=/\b([a-z-]*)\(.*?\)/gu,v_={...cl,getAnimatableNone:n=>{const e=n.match(Z$);return e?e.map(Q$).join(" "):n}},KR={...Fd,transform:Math.round},J$={rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:Om,scaleX:Om,scaleY:Om,scaleZ:Om,skew:Lo,skewX:Lo,skewY:Lo,distance:tt,translateX:tt,translateY:tt,translateZ:tt,x:tt,y:tt,z:tt,perspective:tt,transformPerspective:tt,opacity:ap,originX:OR,originY:OR,originZ:tt},LE={borderWidth:tt,borderTopWidth:tt,borderRightWidth:tt,borderBottomWidth:tt,borderLeftWidth:tt,borderRadius:tt,radius:tt,borderTopLeftRadius:tt,borderTopRightRadius:tt,borderBottomRightRadius:tt,borderBottomLeftRadius:tt,width:tt,maxWidth:tt,height:tt,maxHeight:tt,top:tt,right:tt,bottom:tt,left:tt,padding:tt,paddingTop:tt,paddingRight:tt,paddingBottom:tt,paddingLeft:tt,margin:tt,marginTop:tt,marginRight:tt,marginBottom:tt,marginLeft:tt,backgroundPositionX:tt,backgroundPositionY:tt,...J$,zIndex:KR,fillOpacity:ap,strokeOpacity:ap,numOctaves:KR},eY={...LE,color:Wn,backgroundColor:Wn,outlineColor:Wn,fill:Wn,stroke:Wn,borderColor:Wn,borderTopColor:Wn,borderRightColor:Wn,borderBottomColor:Wn,borderLeftColor:Wn,filter:v_,WebkitFilter:v_},_4=n=>eY[n];function w4(n,e){let t=_4(n);return t!==v_&&(t=cl),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const tY=new Set(["auto","none","0"]);function nY(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!tY.has(a)&&sp(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=w4(t,i)}class rY extends VE{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),RE(d))){const h=v4(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!y4.has(r)||e.length!==2)return;const[i,a]=e,o=YR(i),c=YR(a);if(o!==c)if(GR(o)&&GR(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else yc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||X$(e[i]))&&r.push(i);r.length&&nY(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=yc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=yc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function iY(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const E4=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function S4(n){return BO(n)&&"offsetHeight"in n}const XR=30,aY=n=>!isNaN(parseFloat(n));class sY{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=ni.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ni.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=aY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new TE);const r=this.events[e].add(t);return e==="change"?()=>{r(),vn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ni.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>XR)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,XR);return FO(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ed(n,e){return new sY(n,e)}const{schedule:BE}=JO(queueMicrotask,!1),ia={x:!1,y:!1};function T4(){return ia.x||ia.y}function oY(n){return n==="x"||n==="y"?ia[n]?null:(ia[n]=!0,()=>{ia[n]=!1}):ia.x||ia.y?null:(ia.x=ia.y=!0,()=>{ia.x=ia.y=!1})}function A4(n,e){const t=iY(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function WR(n){return!(n.pointerType==="touch"||T4())}function lY(n,e,t={}){const[r,i,a]=A4(n,t),o=c=>{if(!WR(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{WR(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const C4=(n,e)=>e?n===e?!0:C4(n,e.parentElement):!1,UE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,cY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function uY(n){return cY.has(n.tagName)||n.tabIndex!==-1}const v0=new WeakSet;function QR(n){return e=>{e.key==="Enter"&&n(e)}}function qx(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const dY=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=QR(()=>{if(v0.has(t))return;qx(t,"down");const i=QR(()=>{qx(t,"up")}),a=()=>qx(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function ZR(n){return UE(n)&&!T4()}function fY(n,e,t={}){const[r,i,a]=A4(n,t),o=c=>{const u=c.currentTarget;if(!ZR(c))return;v0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),v0.has(u)&&v0.delete(u),ZR(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||C4(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),S4(c)&&(c.addEventListener("focus",d=>dY(d,i)),!uY(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function I4(n){return BO(n)&&"ownerSVGElement"in n}function hY(n){return I4(n)&&n.tagName==="svg"}const Dr=n=>!!(n&&n.getVelocity),pY=[...x4,Wn,cl],gY=n=>pY.find(b4(n)),FE=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function JR(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function mY(...n){return e=>{let t=!1;const r=n.map(i=>{const a=JR(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():JR(n[i],null)}}}}function vY(...n){return U.useCallback(mY(...n),n)}class yY extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=S4(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function bY({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),a=U.useRef(null),o=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=U.useContext(FE),u=vY(a,n?.ref);return U.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const S=r??document.head;return S.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(w)&&S.removeChild(w)}},[e]),v.jsx(yY,{isPresent:e,childRef:a,sizeRef:o,children:U.cloneElement(n,{ref:u})})}const xY=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=Wv(_Y),h=U.useId();let p=!0,m=U.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),U.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),U.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),o==="popLayout"&&(n=v.jsx(bY,{isPresent:t,anchorX:c,root:u,children:n})),v.jsx(Qv.Provider,{value:m,children:n})};function _Y(){return new Map}function R4(n=!0){const e=U.useContext(Qv);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=U.useId();U.useEffect(()=>{if(n)return i(a)},[n]);const o=U.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,o]:[!0]}const jm=n=>n.key||"";function eD(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const ri=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=R4(o),p=U.useMemo(()=>eD(n),[n]),m=o&&!d?[]:p.map(jm),b=U.useRef(!0),_=U.useRef(p),w=Wv(()=>new Map),[S,T]=U.useState(p),[C,D]=U.useState(p);xE(()=>{b.current=!1,_.current=p;for(let V=0;V<C.length;V++){const A=jm(C[V]);m.includes(A)?w.delete(A):w.get(A)!==!0&&w.set(A,!1)}},[C,m.length,m.join("-")]);const O=[];if(p!==S){let V=[...p];for(let A=0;A<C.length;A++){const I=C[A],k=jm(I);m.includes(k)||(V.splice(A,0,I),O.push(I))}return a==="wait"&&O.length&&(V=O),D(eD(V)),T(p),null}const{forceRender:M}=U.useContext(yE);return v.jsx(v.Fragment,{children:C.map(V=>{const A=jm(V),I=o&&!d?!1:p===C||m.includes(A),k=()=>{if(w.has(A))w.set(A,!0);else return;let z=!0;w.forEach(L=>{L||(z=!1)}),z&&(M?.(),D(_.current),o&&h?.(),r&&r())};return v.jsx(xY,{isPresent:I,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:I?void 0:k,anchorX:c,children:V},A)})})},D4=U.createContext({strict:!1}),tD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Sd={};for(const n in tD)Sd[n]={isEnabled:e=>tD[n].some(t=>!!e[t])};function wY(n){for(const e in n)Sd[e]={...Sd[e],...n[e]}}const EY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function nv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||EY.has(n)}let k4=n=>!nv(n);function SY(n){typeof n=="function"&&(k4=e=>e.startsWith("on")?!nv(e):n(e))}try{SY(require("@emotion/is-prop-valid").default)}catch{}function TY(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(k4(i)||t===!0&&nv(i)||!e&&!nv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const Zv=U.createContext({});function Jv(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function op(n){return typeof n=="string"||Array.isArray(n)}const GE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],qE=["initial",...GE];function ey(n){return Jv(n.animate)||qE.some(e=>op(n[e]))}function N4(n){return!!(ey(n)||n.variants)}function AY(n,e){if(ey(n)){const{initial:t,animate:r}=n;return{initial:t===!1||op(t)?t:void 0,animate:op(r)?r:void 0}}return n.inherit!==!1?e:{}}function CY(n){const{initial:e,animate:t}=AY(n,U.useContext(Zv));return U.useMemo(()=>({initial:e,animate:t}),[nD(e),nD(t)])}function nD(n){return Array.isArray(n)?n.join(" "):n}const lp={};function IY(n){for(const e in n)lp[e]=n[e],IE(e)&&(lp[e].isCSSVariable=!0)}function M4(n,{layout:e,layoutId:t}){return qd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!lp[n]||n==="opacity")}const RY={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},DY=Gd.length;function kY(n,e,t){let r="",i=!0;for(let a=0;a<DY;a++){const o=Gd[a],c=n[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=E4(c,LE[o]);if(!u){i=!1;const h=RY[o]||o;r+=`${h}(${d}) `}t&&(e[o]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function HE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let o=!1,c=!1;for(const u in e){const d=e[u];if(qd.has(u)){o=!0;continue}else if(IE(u)){i[u]=d;continue}else{const h=E4(d,LE[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||t?r.transform=kY(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const $E=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function P4(n,e,t){for(const r in e)!Dr(e[r])&&!M4(r,t)&&(n[r]=e[r])}function NY({transformTemplate:n},e){return U.useMemo(()=>{const t=$E();return HE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function MY(n,e){const t=n.style||{},r={};return P4(r,t,n),Object.assign(r,NY(n,e)),r}function PY(n,e){const t={},r=MY(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const OY={offset:"stroke-dashoffset",array:"stroke-dasharray"},jY={offset:"strokeDashoffset",array:"strokeDasharray"};function VY(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?OY:jY;n[a.offset]=tt.transform(-r);const o=tt.transform(e),c=tt.transform(t);n[a.array]=`${o} ${c}`}function O4(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(HE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&VY(p,i,a,o,!1)}const j4=()=>({...$E(),attrs:{}}),V4=n=>typeof n=="string"&&n.toLowerCase()==="svg";function zY(n,e,t,r){const i=U.useMemo(()=>{const a=j4();return O4(a,e,V4(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};P4(a,n.style,n),i.style={...a,...i.style}}return i}const LY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function YE(n){return typeof n!="string"||n.includes("-")?!1:!!(LY.indexOf(n)>-1||/[A-Z]/u.test(n))}function BY(n,e,t,{latestValues:r},i,a=!1){const c=(YE(n)?zY:PY)(e,r,i,n),u=TY(e,typeof n=="string",a),d=n!==U.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=U.useMemo(()=>Dr(h)?h.get():h,[h]);return U.createElement(n,{...d,children:p})}function rD(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function KE(n,e,t,r){if(typeof e=="function"){const[i,a]=rD(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=rD(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function y0(n){return Dr(n)?n.get():n}function UY({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:FY(t,r,i,n),renderState:e()}}function FY(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=y0(a[m]);let{initial:o,animate:c}=n;const u=ey(n),d=N4(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!Jv(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=KE(n,m[b]);if(_){const{transitionEnd:w,transition:S,...T}=_;for(const C in T){let D=T[C];if(Array.isArray(D)){const O=h?D.length-1:0;D=D[O]}D!==null&&(i[C]=D)}for(const C in w)i[C]=w[C]}}}return i}const z4=n=>(e,t)=>{const r=U.useContext(Zv),i=U.useContext(Qv),a=()=>UY(n,e,r,i);return t?a():Wv(a)};function XE(n,e,t){const{style:r}=n,i={};for(const a in r)(Dr(r[a])||e.style&&Dr(e.style[a])||M4(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const GY=z4({scrapeMotionValuesFromProps:XE,createRenderState:$E});function L4(n,e,t){const r=XE(n,e,t);for(const i in n)if(Dr(n[i])||Dr(e[i])){const a=Gd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const qY=z4({scrapeMotionValuesFromProps:L4,createRenderState:j4}),HY=Symbol.for("motionComponentSymbol");function qu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function $Y(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):qu(t)&&(t.current=r))},[e])}const WE=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),YY="framerAppearId",B4="data-"+WE(YY),U4=U.createContext({});function KY(n,e,t,r,i){const{visualElement:a}=U.useContext(Zv),o=U.useContext(D4),c=U.useContext(Qv),u=U.useContext(FE).reducedMotion,d=U.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=U.useContext(U4);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&XY(d.current,t,i,p);const m=U.useRef(!1);U.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[B4],_=U.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return xE(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),U.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function XY(n,e,t,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:F4(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&qu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function F4(n){if(n)return n.options.allowProjection!==!1?n.projection:F4(n.parent)}function Hx(n,{forwardMotionProps:e=!1}={},t,r){t&&wY(t);const i=YE(n)?qY:GY;function a(c,u){let d;const h={...U.useContext(FE),...c,layoutId:WY(c)},{isStatic:p}=h,m=CY(c),b=i(c,p);if(!p&&bE){QY();const _=ZY(h);d=_.MeasureLayout,m.visualElement=KY(n,b,h,r,_.ProjectionNode)}return v.jsxs(Zv.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,BY(n,c,$Y(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=U.forwardRef(a);return o[HY]=n,o}function WY({layoutId:n}){const e=U.useContext(yE).id;return e&&n!==void 0?e+"-"+n:n}function QY(n,e){U.useContext(D4).strict}function ZY(n){const{drag:e,layout:t}=Sd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function JY(n,e){if(typeof Proxy>"u")return Hx;const t=new Map,r=(a,o)=>Hx(a,o,n,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(t.has(o)||t.set(o,Hx(o,void 0,n,e)),t.get(o))})}function G4({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function eK({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function tK(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function $x(n){return n===void 0||n===1}function y_({scale:n,scaleX:e,scaleY:t}){return!$x(n)||!$x(e)||!$x(t)}function Ql(n){return y_(n)||q4(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function q4(n){return iD(n.x)||iD(n.y)}function iD(n){return n&&n!=="0%"}function rv(n,e,t){const r=n-t,i=e*r;return t+i}function aD(n,e,t,r,i){return i!==void 0&&(n=rv(n,i,r)),rv(n,t,r)+e}function b_(n,e=0,t=1,r,i){n.min=aD(n.min,e,t,r,i),n.max=aD(n.max,e,t,r,i)}function H4(n,{x:e,y:t}){b_(n.x,e.translate,e.scale,e.originPoint),b_(n.y,t.translate,t.scale,t.originPoint)}const sD=.999999999999,oD=1.0000000000001;function nK(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=t[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&$u(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,H4(n,o)),r&&Ql(a.latestValues)&&$u(n,a.latestValues))}e.x<oD&&e.x>sD&&(e.x=1),e.y<oD&&e.y>sD&&(e.y=1)}function Hu(n,e){n.min=n.min+e,n.max=n.max+e}function lD(n,e,t,r,i=.5){const a=Sn(n.min,n.max,i);b_(n,e,t,a,r)}function $u(n,e){lD(n.x,e.x,e.scaleX,e.scale,e.originX),lD(n.y,e.y,e.scaleY,e.scale,e.originY)}function $4(n,e){return G4(tK(n.getBoundingClientRect(),e))}function rK(n,e,t){const r=$4(n,t),{scroll:i}=e;return i&&(Hu(r.x,i.offset.x),Hu(r.y,i.offset.y)),r}const cD=()=>({translate:0,scale:1,origin:0,originPoint:0}),Yu=()=>({x:cD(),y:cD()}),uD=()=>({min:0,max:0}),zn=()=>({x:uD(),y:uD()}),x_={current:null},Y4={current:!1};function iK(){if(Y4.current=!0,!!bE)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>x_.current=n.matches;n.addEventListener("change",e),e()}else x_.current=!1}const aK=new WeakMap;function sK(n,e,t){for(const r in e){const i=e[r],a=t[r];if(Dr(i))n.addValue(r,i);else if(Dr(a))n.addValue(r,Ed(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,Ed(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const dD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class oK{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=VE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ni.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,vn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=ey(t),this.isVariantNode=N4(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&Dr(b)&&b.set(u[m])}}mount(e){this.current=e,aK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),Y4.current||iK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:x_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ll(this.notifyUpdate),ll(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=qd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&vn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Sd){const t=Sd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):zn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<dD.length;r++){const i=dD[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=sK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=Ed(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(LO(r)||UO(r))?r=parseFloat(r):!gY(r)&&cl.test(t)&&(r=w4(e,t)),this.setBaseTarget(e,Dr(r)?r.get():r)),Dr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=KE(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Dr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new TE),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){BE.render(this.render)}}class K4 extends oK{constructor(){super(...arguments),this.KeyframeResolver=rY}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Dr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function X4(n,{style:e,vars:t},r,i){const a=n.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in t)a.setProperty(o,t[o])}function lK(n){return window.getComputedStyle(n)}class cK extends K4{constructor(){super(...arguments),this.type="html",this.renderInstance=X4}readValueFromInstance(e,t){if(qd.has(t))return this.projection?.isProjecting?d_(t):w$(e,t);{const r=lK(e),i=(IE(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return $4(e,t)}build(e,t,r){HE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return XE(e,t,r)}}const W4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function uK(n,e,t,r){X4(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(W4.has(i)?i:WE(i),e.attrs[i])}class dK extends K4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=zn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(qd.has(t)){const r=_4(t);return r&&r.default||0}return t=W4.has(t)?t:WE(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return L4(e,t,r)}build(e,t,r){O4(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){uK(e,t,r,i)}mount(e){this.isSVGTag=V4(e.tagName),super.mount(e)}}const fK=(n,e)=>YE(n)?new dK(e):new cK(e,{allowProjection:n!==U.Fragment});function ad(n,e,t){const r=n.getProps();return KE(r,e,t!==void 0?t:r.custom,n)}const __=n=>Array.isArray(n);function hK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Ed(t))}function pK(n){return __(n)?n[n.length-1]||0:n}function QE(n,e){const t=ad(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const o in a){const c=pK(a[o]);hK(n,o,c)}}function gK(n){return!!(Dr(n)&&n.add)}function w_(n,e){const t=n.getValue("willChange");if(gK(t))return t.add(e);if(!t&&qs.WillChange){const r=new qs.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function Q4(n){return n.props[B4]}const mK=n=>n!==null;function vK(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(mK),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const yK={type:"spring",stiffness:500,damping:25,restSpeed:10},bK=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),xK={type:"keyframes",duration:.8},_K={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},wK=(n,{keyframes:e})=>e.length>2?xK:qd.has(n)?n.startsWith("scale")?bK(e[1]):yK:_K;function EK({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const ZE=(n,e,t,r={},i,a)=>o=>{const c=zE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Ja(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};EK(c)||Object.assign(h,wK(n,h)),h.duration&&(h.duration=Ja(h.duration)),h.repeatDelay&&(h.repeatDelay=Ja(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(m_(h),h.delay===0&&(p=!0)),(qs.instantAnimations||qs.skipAnimations)&&(p=!0,m_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=vK(h.keyframes,c);if(m!==void 0){vn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new jE(h):new H$(h)};function SK({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function Z4(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&SK(d,h))continue;const b={delay:t,...zE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=Q4(n);if(T){const C=window.MotionHandoffAnimation(T,h,vn);C!==null&&(b.startTime=C,w=!0)}}w_(n,h),p.start(ZE(h,p,m,n.shouldReduceMotion&&y4.has(h)?{type:!1}:b,n,w));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{vn.update(()=>{o&&QE(n,o)})}),u}function J4(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,c=(o-1)*r;return typeof t=="function"?t(a,o):i===1?a*r:c-a*r}function E_(n,e,t={}){const r=ad(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all(Z4(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return TK(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(t.delay)])}function TK(n,e,t=0,r=0,i=0,a=1,o){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push(E_(u,e,{...o,delay:t+(typeof r=="function"?0:r)+J4(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function e3(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>E_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=E_(n,e,t);else{const i=typeof e=="function"?ad(n,e,t.custom):e;r=Promise.all(Z4(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function t3(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const AK=qE.length;function n3(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?n3(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<AK;t++){const r=qE[t],i=n.props[r];(op(i)||i===!1)&&(e[r]=i)}return e}const CK=[...GE].reverse(),IK=GE.length;function RK(n){return e=>Promise.all(e.map(({animation:t,options:r})=>e3(n,t,r)))}function DK(n){let e=RK(n),t=fD(),r=!0;const i=u=>(d,h)=>{const p=ad(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function o(u){const{props:d}=n,h=n3(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let S=0;S<IK;S++){const T=CK[S],C=t[T],D=d[T]!==void 0?d[T]:h[T],O=op(D),M=T===u?C.isActive:null;M===!1&&(_=S);let V=D===h[T]&&D!==d[T]&&O;if(V&&r&&n.manuallyAnimateOnMount&&(V=!1),C.protectedKeys={...b},!C.isActive&&M===null||!D&&!C.prevProp||Jv(D)||typeof D=="boolean")continue;const A=kK(C.prevProp,D);let I=A||T===u&&C.isActive&&!V&&O||S>_&&O,k=!1;const z=Array.isArray(D)?D:[D];let L=z.reduce(i(T),{});M===!1&&(L={});const{prevResolvedValues:B={}}=C,P={...B,...L},J=W=>{I=!0,m.has(W)&&(k=!0,m.delete(W)),C.needsAnimating[W]=!0;const K=n.getValue(W);K&&(K.liveStyle=!1)};for(const W in P){const K=L[W],de=B[W];if(b.hasOwnProperty(W))continue;let te=!1;__(K)&&__(de)?te=!t3(K,de):te=K!==de,te?K!=null?J(W):m.add(W):K!==void 0&&m.has(W)?J(W):C.protectedKeys[W]=!0}C.prevProp=D,C.prevResolvedValues=L,C.isActive&&(b={...b,...L}),r&&n.blockInitialAnimation&&(I=!1);const Y=V&&A;I&&(!Y||k)&&p.push(...z.map(W=>{const K={type:T};if(typeof W=="string"&&r&&!Y&&n.manuallyAnimateOnMount&&n.parent){const{parent:de}=n,te=ad(de,W);if(de.enteringChildren&&te){const{delayChildren:G}=te.transition||{};K.delay=J4(de.enteringChildren,n,G)}}return{animation:W,options:K}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=ad(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const C=n.getBaseTarget(T),D=n.getValue(T);D&&(D.liveStyle=!0),S[T]=C??null}),p.push({animation:S})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=o(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=fD()}}}function kK(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!t3(e,n):!1}function $l(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function fD(){return{animate:$l(!0),whileInView:$l(),whileHover:$l(),whileTap:$l(),whileDrag:$l(),whileFocus:$l(),exit:$l()}}class vl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class NK extends vl{constructor(e){super(e),e.animationState||(e.animationState=DK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Jv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let MK=0;class PK extends vl{constructor(){super(...arguments),this.id=MK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const OK={animation:{Feature:NK},exit:{Feature:PK}};function cp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Hp(n){return{point:{x:n.pageX,y:n.pageY}}}const jK=n=>e=>UE(e)&&n(e,Hp(e));function Rh(n,e,t,r){return cp(n,e,jK(t),r)}const r3=1e-4,VK=1-r3,zK=1+r3,i3=.01,LK=0-i3,BK=0+i3;function Gr(n){return n.max-n.min}function UK(n,e,t){return Math.abs(n-e)<=t}function hD(n,e,t,r=.5){n.origin=r,n.originPoint=Sn(e.min,e.max,n.origin),n.scale=Gr(t)/Gr(e),n.translate=Sn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=VK&&n.scale<=zK||isNaN(n.scale))&&(n.scale=1),(n.translate>=LK&&n.translate<=BK||isNaN(n.translate))&&(n.translate=0)}function Dh(n,e,t,r){hD(n.x,e.x,t.x,r?r.originX:void 0),hD(n.y,e.y,t.y,r?r.originY:void 0)}function pD(n,e,t){n.min=t.min+e.min,n.max=n.min+Gr(e)}function FK(n,e,t){pD(n.x,e.x,t.x),pD(n.y,e.y,t.y)}function gD(n,e,t){n.min=e.min-t.min,n.max=n.min+Gr(e)}function kh(n,e,t){gD(n.x,e.x,t.x),gD(n.y,e.y,t.y)}function ji(n){return[n("x"),n("y")]}const a3=({current:n})=>n?n.ownerDocument.defaultView:null,mD=(n,e)=>Math.abs(n-e);function GK(n,e){const t=mD(n.x,e.x),r=mD(n.y,e.y);return Math.sqrt(t**2+r**2)}class s3{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Kx(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=GK(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:S}=wr;this.history.push({...w,timestamp:S});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Yx(b,this.transformPagePoint),vn.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Kx(m.type==="pointercancel"?this.lastMoveEventInfo:Yx(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!UE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=Hp(e),u=Yx(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=wr;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,Kx(u,this.history)),this.removeListeners=Fp(Rh(this.contextWindow,"pointermove",this.handlePointerMove),Rh(this.contextWindow,"pointerup",this.handlePointerUp),Rh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ll(this.updatePoint)}}function Yx(n,e){return e?{point:e(n.point)}:n}function vD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Kx({point:n},e){return{point:n,delta:vD(n,o3(e)),offset:vD(n,qK(e)),velocity:HK(e,.1)}}function qK(n){return n[0]}function o3(n){return n[n.length-1]}function HK(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=o3(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ja(e)));)t--;if(!r)return{x:0,y:0};const a=Ui(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function $K(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Sn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Sn(t,n,r.max):Math.min(n,t)),n}function yD(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function YK(n,{top:e,left:t,bottom:r,right:i}){return{x:yD(n.x,t,i),y:yD(n.y,e,r)}}function bD(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function KK(n,e){return{x:bD(n.x,e.x),y:bD(n.y,e.y)}}function XK(n,e){let t=.5;const r=Gr(n),i=Gr(e);return i>r?t=ip(e.min,e.max-r,n.min):r>i&&(t=ip(n.min,n.max-i,e.min)),Gs(0,1,t)}function WK(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const S_=.35;function QK(n=S_){return n===!1?n=0:n===!0&&(n=S_),{x:xD(n,"left","right"),y:xD(n,"top","bottom")}}function xD(n,e,t){return{min:_D(n,e),max:_D(n,t)}}function _D(n,e){return typeof n=="number"?n:n[e]||0}const ZK=new WeakMap;class JK{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=zn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Hp(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=oY(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ji(T=>{let C=this.getAxisMotionValue(T).get()||0;if(es.test(C)){const{projection:D}=this.visualElement;if(D&&D.layout){const O=D.layout.layoutBox[T];O&&(C=Gr(O)*(parseFloat(C)/100))}}this.originPoint[T]=C}),w&&vn.postRender(()=>w(p,m)),w_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=eX(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>ji(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new s3(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:a3(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&vn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Vm(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=$K(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&qu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=YK(r.layoutBox,e):this.constraints=!1,this.elastic=QK(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&ji(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=WK(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!qu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=rK(r,i.root,this.visualElement.getTransformPagePoint());let o=KK(i.layout.layoutBox,a);if(t){const c=t(eK(o));this.hasMutatedConstraints=!!c,c&&(o=G4(c))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=ji(h=>{if(!Vm(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return w_(this.visualElement,e),r.start(ZE(e,r,0,t,this.visualElement,!1))}stopAnimation(){ji(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ji(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ji(t=>{const{drag:r}=this.getProps();if(!Vm(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[t];a.set(e[t]-Sn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!qu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ji(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=XK({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ji(o=>{if(!Vm(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(Sn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;ZK.set(this.visualElement,this);const e=this.visualElement.current,t=Rh(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();qu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),vn.read(r);const o=cp(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(ji(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=S_,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Vm(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function eX(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class tX extends vl{constructor(e){super(e),this.removeGroupControls=Gi,this.removeListeners=Gi,this.controls=new JK(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Gi}unmount(){this.removeGroupControls(),this.removeListeners()}}const wD=n=>(e,t)=>{n&&vn.postRender(()=>n(e,t))};class nX extends vl{constructor(){super(...arguments),this.removePointerDownListener=Gi}onPointerDown(e){this.session=new s3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:a3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:wD(e),onStart:wD(t),onMove:r,onEnd:(a,o)=>{delete this.session,i&&vn.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Rh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const b0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ED(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const nh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(tt.test(n))n=parseFloat(n);else return n;const t=ED(n,e.target.x),r=ED(n,e.target.y);return`${t}% ${r}%`}},rX={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=cl.parse(n);if(i.length>5)return r;const a=cl.createTransformer(n),o=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=Sn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let Xx=!1;class iX extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;IY(aX),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),Xx&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),b0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,Xx=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||vn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),BE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;Xx=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function l3(n){const[e,t]=R4(),r=U.useContext(yE);return v.jsx(iX,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(U4),isPresent:e,safeToRemove:t})}const aX={borderRadius:{...nh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:nh,borderTopRightRadius:nh,borderBottomLeftRadius:nh,borderBottomRightRadius:nh,boxShadow:rX};function sX(n,e,t){const r=Dr(n)?n:Ed(n);return r.start(ZE("",r,e,t)),r.animation}const oX=(n,e)=>n.depth-e.depth;class lX{constructor(){this.children=[],this.isDirty=!1}add(e){_E(this.children,e),this.isDirty=!0}remove(e){wE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(oX),this.isDirty=!1,this.children.forEach(e)}}function cX(n,e){const t=ni.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(ll(r),n(a-e))};return vn.setup(r,!0),()=>ll(r)}const c3=["TopLeft","TopRight","BottomLeft","BottomRight"],uX=c3.length,SD=n=>typeof n=="string"?parseFloat(n):n,TD=n=>typeof n=="number"||tt.test(n);function dX(n,e,t,r,i,a){i?(n.opacity=Sn(0,t.opacity??1,fX(r)),n.opacityExit=Sn(e.opacity??1,0,hX(r))):a&&(n.opacity=Sn(e.opacity??1,t.opacity??1,r));for(let o=0;o<uX;o++){const c=`border${c3[o]}Radius`;let u=AD(e,c),d=AD(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||TD(u)===TD(d)?(n[c]=Math.max(Sn(SD(u),SD(d),r),0),(es.test(d)||es.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=Sn(e.rotate||0,t.rotate||0,r))}function AD(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const fX=u3(0,.5,XO),hX=u3(.5,.95,Gi);function u3(n,e,t){return r=>r<n?0:r>e?1:t(ip(n,e,r))}function CD(n,e){n.min=e.min,n.max=e.max}function Pi(n,e){CD(n.x,e.x),CD(n.y,e.y)}function ID(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function RD(n,e,t,r,i){return n-=e,n=rv(n,1/t,r),i!==void 0&&(n=rv(n,1/i,r)),n}function pX(n,e=0,t=1,r=.5,i,a=n,o=n){if(es.test(e)&&(e=parseFloat(e),e=Sn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=Sn(a.min,a.max,r);n===a&&(c-=e),n.min=RD(n.min,e,t,c,i),n.max=RD(n.max,e,t,c,i)}function DD(n,e,[t,r,i],a,o){pX(n,e[t],e[r],e[i],e.scale,a,o)}const gX=["x","scaleX","originX"],mX=["y","scaleY","originY"];function kD(n,e,t,r){DD(n.x,e,gX,t?t.x:void 0,r?r.x:void 0),DD(n.y,e,mX,t?t.y:void 0,r?r.y:void 0)}function ND(n){return n.translate===0&&n.scale===1}function d3(n){return ND(n.x)&&ND(n.y)}function MD(n,e){return n.min===e.min&&n.max===e.max}function vX(n,e){return MD(n.x,e.x)&&MD(n.y,e.y)}function PD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function f3(n,e){return PD(n.x,e.x)&&PD(n.y,e.y)}function OD(n){return Gr(n.x)/Gr(n.y)}function jD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class yX{constructor(){this.members=[]}add(e){_E(this.members,e),e.scheduleRender()}remove(e){if(wE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function bX(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Wx=["","X","Y","Z"],xX=1e3;let _X=0;function Qx(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function h3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=Q4(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",vn,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&h3(r)}function p3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=_X++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(SX),this.nodes.forEach(IX),this.nodes.forEach(RX),this.nodes.forEach(TX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new lX)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new TE),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=I4(o)&&!hY(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;vn.read(()=>{p=window.innerWidth}),n(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=cX(m,250),b0.hasAnimatedSinceResize&&(b0.hasAnimatedSinceResize=!1,this.nodes.forEach(LD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||PX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!f3(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const D={...zE(_,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D),this.setAnimationOrigin(h,C)}else p||LD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ll(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(DX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&h3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(VD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(zD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(CX),this.nodes.forEach(wX),this.nodes.forEach(EX)):this.nodes.forEach(zD),this.clearAllSnapshots();const c=ni.now();wr.delta=Gs(0,1e3/60,c-wr.timestamp),wr.timestamp=c,wr.isProcessing=!0,Lx.update.process(wr),Lx.preRender.process(wr),Lx.render.process(wr),wr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,BE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(AX),this.sharedNodes.forEach(kX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,vn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){vn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Gr(this.snapshot.measuredBox.x)&&!Gr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=zn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!d3(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Ql(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),OX(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return zn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(jX))){const{scroll:d}=this.root;d&&(Hu(c.x,d.offset.x),Hu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=zn();if(Pi(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Pi(c,o),Hu(c.x,h.offset.x),Hu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=zn();Pi(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&$u(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Ql(h.latestValues)&&$u(u,h.latestValues)}return Ql(this.latestValues)&&$u(u,this.latestValues),u}removeTransform(o){const c=zn();Pi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Ql(d.latestValues))continue;y_(d.latestValues)&&d.updateSnapshot();const h=zn(),p=d.measurePageBox();Pi(h,p),kD(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Ql(this.latestValues)&&kD(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==wr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=wr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),kh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Pi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=zn(),this.targetWithTransforms=zn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),FK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Pi(this.target,this.layout.layoutBox),H4(this.target,this.targetDelta)):Pi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),kh(this.relativeTargetOrigin,this.target,m.target),Pi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||y_(this.parent.latestValues)||q4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===wr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Pi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;nK(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=zn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ID(this.prevProjectionDelta.x,this.projectionDelta.x),ID(this.prevProjectionDelta.y,this.projectionDelta.y)),Dh(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!jD(this.projectionDelta.x,this.prevProjectionDelta.x)||!jD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Yu(),this.projectionDelta=Yu(),this.projectionDeltaWithTransform=Yu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=Yu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=zn(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,S=this.getStack(),T=!S||S.members.length<=1,C=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(MX));this.animationProgress=0;let D;this.mixTargetDelta=O=>{const M=O/1e3;BD(p.x,o.x,M),BD(p.y,o.y,M),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(kh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),NX(this.relativeTarget,this.relativeTargetOrigin,m,M),D&&vX(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=zn()),Pi(D,this.relativeTarget)),w&&(this.animationValues=h,dX(h,d,this.latestValues,M,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(ll(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=vn.update(()=>{b0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ed(0)),this.currentAnimation=sX(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&g3(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||zn();const p=Gr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=Gr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Pi(c,u),$u(c,h),Dh(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new yX),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&Qx("z",o,d,this.animationValues);for(let h=0;h<Wx.length;h++)Qx(`rotate${Wx[h]}`,o,d,this.animationValues),Qx(`skew${Wx[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=y0(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=y0(c?.pointerEvents)||""),this.hasProjected&&!Ql(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=bX(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in lp){if(h[_]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:T}=lp[_],C=p==="none"?h[_]:w(h[_],d);if(S){const D=S.length;for(let O=0;O<D;O++)o[S[O]]=C}else T?this.options.visualElement.renderState.vars[_]=C:o[_]=C}this.options.layoutId&&(o.pointerEvents=d===this?y0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(VD),this.root.sharedNodes.clear()}}}function wX(n){n.updateLayout()}function EX(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?ji(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Gr(p);p.min=t[h].min,p.max=p.min+m}):g3(i,e.layoutBox,t)&&ji(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Gr(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const o=Yu();Dh(o,t,e.layoutBox);const c=Yu();a?Dh(c,n.applyTransform(r,!0),e.measuredBox):Dh(c,t,e.layoutBox);const u=!d3(o);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=zn();kh(b,e.layoutBox,p.layoutBox);const _=zn();kh(_,t,m.layoutBox),f3(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function SX(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function TX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function AX(n){n.clearSnapshot()}function VD(n){n.clearMeasurements()}function zD(n){n.isLayoutDirty=!1}function CX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function LD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function IX(n){n.resolveTargetDelta()}function RX(n){n.calcProjection()}function DX(n){n.resetSkewAndRotation()}function kX(n){n.removeLeadSnapshot()}function BD(n,e,t){n.translate=Sn(e.translate,0,t),n.scale=Sn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function UD(n,e,t,r){n.min=Sn(e.min,t.min,r),n.max=Sn(e.max,t.max,r)}function NX(n,e,t,r){UD(n.x,e.x,t.x,r),UD(n.y,e.y,t.y,r)}function MX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const PX={duration:.45,ease:[.4,0,.1,1]},FD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),GD=FD("applewebkit/")&&!FD("chrome/")?Math.round:Gi;function qD(n){n.min=GD(n.min),n.max=GD(n.max)}function OX(n){qD(n.x),qD(n.y)}function g3(n,e,t){return n==="position"||n==="preserve-aspect"&&!UK(OD(e),OD(t),.2)}function jX(n){return n!==n.root&&n.scroll?.wasRoot}const VX=p3({attachResizeListener:(n,e)=>cp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Zx={current:void 0},m3=p3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Zx.current){const n=new VX({});n.mount(window),n.setOptions({layoutScroll:!0}),Zx.current=n}return Zx.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),zX={pan:{Feature:nX},drag:{Feature:tX,ProjectionNode:m3,MeasureLayout:l3}};function HD(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&vn.postRender(()=>a(e,Hp(e)))}class LX extends vl{mount(){const{current:e}=this.node;e&&(this.unmount=lY(e,(t,r)=>(HD(this.node,r,"Start"),i=>HD(this.node,i,"End"))))}unmount(){}}class BX extends vl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Fp(cp(this.node.current,"focus",()=>this.onFocus()),cp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function $D(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&vn.postRender(()=>a(e,Hp(e)))}class UX extends vl{mount(){const{current:e}=this.node;e&&(this.unmount=fY(e,(t,r)=>($D(this.node,r,"Start"),(i,{success:a})=>$D(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const T_=new WeakMap,Jx=new WeakMap,FX=n=>{const e=T_.get(n.target);e&&e(n)},GX=n=>{n.forEach(FX)};function qX({root:n,...e}){const t=n||document;Jx.has(t)||Jx.set(t,{});const r=Jx.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(GX,{root:n,...e})),r[i]}function HX(n,e,t){const r=qX(e);return T_.set(n,t),r.observe(n),()=>{T_.delete(n),r.unobserve(n)}}const $X={some:0,all:1};class YX extends vl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:$X[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return HX(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(KX(e,t))&&this.startObserver()}unmount(){}}function KX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const XX={inView:{Feature:YX},tap:{Feature:UX},focus:{Feature:BX},hover:{Feature:LX}},WX={layout:{ProjectionNode:m3,MeasureLayout:l3}},QX={...OK,...XX,...zX,...WX},er=JY(QX,fK);function ZX(n){n.values.forEach(e=>e.stop())}function A_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&QE(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{A_(a,e)})})}function JX(n,e){if(Array.isArray(e))return A_(n,e);if(typeof e=="string")return A_(n,[e]);QE(n,e)}function eW(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(e3(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{JX(r,t)})},stop(){n.forEach(t=>{ZX(t)})},mount(){return()=>{e.stop()}}};return e}function tW(){const n=Wv(eW);return xE(n.mount,[]),n}const nW=tW,yl=uw((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{n({isVisible:!1})}})),rW=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=yl(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(ri,{children:t&&v.jsx(er.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed top-4 left-4 right-4 z-[150] mt-[calc(env(safe-area-inset-top)+8px)]",children:v.jsxs("div",{className:`rounded-xl shadow-lg p-4 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-sm font-medium whitespace-pre-line pr-2",children:n})}),v.jsxs("div",{className:"flex items-center gap-2 ml-3 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg text-xs font-bold transition-colors",children:[v.jsx(b9,{size:14,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-1 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(wv,{size:16})})]})]})})})};class Ua extends U.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(ed,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(Lh,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(YL,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const iW=({onAddTransaction:n})=>{const e=Ys(),t=va(),[r,i]=U.useState(!1),a=U.useRef(null),o=d=>t.pathname===d;U.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(vL,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(T0,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(bL,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=o(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(_v,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(XL,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),n){n();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(mh,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(mN,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(u9,{className:"w-6 h-6"})})]})})};function aW(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function sW(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function Ps(n,e){return function(t){t&&(n[e]=t)}}function v3(n,e,t){return function(r){r&&(n[e][t]=r)}}function YD(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function oW(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var lW="function",cW="object",uW="string",dW="number",JE="undefined",y3=typeof window!==JE,fW=typeof document!==JE&&document,hW=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Qn=1e-7,zm={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function pW(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function iv(n,e,t,r){return(n*r+e*t)/(t+r)}function ty(n){return typeof n===JE}function ga(n){return n&&typeof n===cW}function tr(n){return Array.isArray(n)}function ii(n){return typeof n===uW}function Td(n){return typeof n===dW}function eS(n){return typeof n===lW}function gW(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function b3(n,e,t,r,i){var a=tS(n,e,t);return a?t:mW(n,e,t+1,r,i)}function tS(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function mW(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!tS(n,e,d))return{value:d};var p=d,m=ai(i,function(b){var _=b.open;return _===h});if(m&&(p=b3(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=t;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function nS(n,e){var t=ii(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,o=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?o:c,d=t.openCloseCharacters,h=d===void 0?hW:d,p=h.map(function(A){var I=A.open,k=A.close;return I===k?I:I+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(A){return A&&A!=="undefined"}),w=_.length,S=[],T=[];function C(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var D=function(A){var I=_[A].trim(),k=A,z=ai(h,function(P){var J=P.open;return J===I}),L=ai(h,function(P){var J=P.close;return J===I});if(z){if(k=b3(z,_,A,w,h),k!==-1&&u)return C()&&a||(S.push(_.slice(A,k+1).join("")),A=k,a)?(O=A,"break"):(O=A,"continue")}else if(L&&!tS(L,_,A)){var B=pW(h);return B.splice(h.indexOf(L),1),{value:nS(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:B})}}else if(gW(I,i)&&!o)return C(),a?(O=A,"break"):(O=A,"continue");k===-1&&(k=w-1),T.push(_.slice(A,k+1).join("")),A=k,O=A},O,M=0;M<w;++M){var V=D(M);if(M=O,typeof V=="object")return V.value;if(V==="break")break}return T.length&&S.push(T.join("")),S}function ul(n){return nS(n,"")}function uc(n){return nS(n,",")}function x3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function $p(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function vW(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function x0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function up(){return Date.now?Date.now():new Date().getTime()}function Hs(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function ai(n,e,t){var r=Hs(n,e);return r>-1?n[r]:t}var _3=(function(){var n=up(),e=y3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=up(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),yW=(function(){var n=y3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function $s(n){return Object.keys(n)}function bW(n){var e=$s(n);return e.map(function(t){return n[t]})}function Jt(n,e){var t=$p(n),r=t.value,i=t.unit;if(ga(e)){var a=e[i];if(a){if(eS(a))return a(r);if(zm[i])return zm[i](r,a)}}else if(i==="%")return r*e/100;return zm[i]?zm[i](r):r}function C_(n,e,t){return Math.max(e,Math.min(n,t))}function KD(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[lt(e[0],Qn),lt(e[0]/r,Qn)],[lt(e[1]*r,Qn),lt(e[1],Qn)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=lt(c,Qn);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function w3(n,e,t,r){if(!r)return n.map(function(b,_){return C_(b,e[_],t[_])});var i=n[0],a=n[1],o=r===!0?i/a:r,c=KD(n,e,!1,o),u=c[0],d=c[1],h=KD(n,t,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function xW(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function I_(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function Ln(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function _W(n){return[0,1].map(function(e){return I_(n.map(function(t){return t[e]}))})}function XD(n){var e=_W(n),t=Ln(e,n[0]),r=Ln(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function Os(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function lt(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function WD(n,e){return n.forEach(function(t,r){n[r]=lt(n[r],e)}),n}function wW(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function E3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function S3(n,e){n.indexOf(e)===-1&&n.push(e)}function sr(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function T3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function A3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function _r(n,e,t,r){n.addEventListener(e,t,r)}function ir(n,e,t,r){n.removeEventListener(e,t,r)}function Hd(n){return n?.ownerDocument||fW}function rS(n){return Hd(n).documentElement}function bl(n){return Hd(n).body}function nl(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function C3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function $d(n){return ga(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var EW=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,o=i.indexOf(t),c=o===-1?i.length:o;i[c]=t,a[c]=r},n})(),SW=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),TW=typeof Map=="function",AW=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function CW(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],o=i[1],c=new AW;t[a]=c,r[o]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=t[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var IW=(function(){function n(t,r,i,a,o,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=CW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function Yp(n,e,t){var r=TW?Map:t?SW:EW,i=t||function(C){return C},a=[],o=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],S=0,T=0;return u.forEach(function(C,D){h.set(C,D)}),d.forEach(function(C,D){p.set(C,D)}),u.forEach(function(C,D){var O=p.get(C);typeof O>"u"?(++T,o.push(D)):_[O]=T}),d.forEach(function(C,D){var O=h.get(C);typeof O>"u"?(a.push(D),++S):(c.push([O,D]),T=_[D]||0,m.push([O-T,D-S]),b.push(D===O),O!==D&&w.push([O,D]))}),o.reverse(),new IW(n,e,a,o,w,c,m,b)}var RW=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=Yp(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),R_=function(n,e){return R_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},R_(n,e)};function Kp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");R_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $a=function(){return $a=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$a.apply(this,arguments)};function I3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function QD(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function ZD(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function R3(n){var e=[];return n.forEach(function(t){e=e.concat(tr(t)?R3(t):t)}),e}function e1(n,e){if(!e)return n;for(var t in e)ty(n[t])&&(n[t]=e[t]);return n}function av(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function JD(n){var e=n.className,t=I3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function ek(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function ny(n){if(!n)return null;var e=n.b;return $d(e)?e:ny(n.c)}function D3(n){var e=n.parentNode;e&&e.removeChild(n)}function k3(n){n.forEach(function(e){e()})}function DW(){return this.constructor(this.props,this.context)}var iS=0,ry=(function(){function n(t,r,i,a,o,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,o){var c=this,u=c.d,d=bW(r).filter(function(_){return _.$_req}),h=R3(d.map(function(_){return _.$_subs})),p=ai(h,function(_){return _.d===u});if(c.b&&!ii(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var S=w.d;return _[0]?_[0].d===S&&_.push(w):S>u&&_.push(w),_},[]);return m.forEach(function(_){Xp(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return ii(i)||(c.ps=i.props,c.ref=i.ref),aS(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function N3(){return Object.__CROACT_CURRENT_INSTNACE__}function kW(){return iS}function NW(n){iS=n}function aS(n){return Object.__CROACT_CURRENT_INSTNACE__=n,iS=0,n}var sS=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=$a($a({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,o=Xp(a.c,[a],[a.o],i,a._cs,$a($a({},this.state),this.$_state),r);o&&(t&&i.push(t),k3(i),aS(null))},n})(),M3=(function(n){Kp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return av(this.props,r)||av(this.state,i)},e})(sS);function P3(n){var e=function(t){e.current=t};return e.current=n,e}function MW(n){return n._fr=!0,n}function PW(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new sS(e,t),a.constructor=n,n._fr?(r.fr=P3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=DW),a.$_p=r,a}var OW=(function(n){Kp(e,n);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,o,c,u,e1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(e1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=e1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=PW(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=$a($a({},i),b.$_cs);Xp(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(ry);function jW(n,e,t){var r=oS(JD(n),JD(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in o)t.setAttribute(u,o[u][1]);for(var d in a)t.removeAttribute(d)}function VW(n,e,t){var r=oS(n,e),i=r.added,a=r.removed;for(var o in a)t.e(o,!0);for(var c in i)t.e(c)}function oS(n,e){var t=$s(n),r=$s(e),i=Yp(t,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];o[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function zW(n,e,t){var r=t.style,i=oS(n,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=x0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=x0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=x0(u,"-");r.removeProperty(p)}}function LW(n){return n.replace(/^on/g,"").toLowerCase()}var BW=(function(n){Kp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,o=a._es,c=a.b,u=LW(r);i?(ir(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},_r(c,u,o[r]))},t.s=function(r){return av(this.ps,r)},t.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=ny(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Hd(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}Xp(c,c._ps,d.children,r,i);var w=c.b,S=ek(a),T=S[0],C=S[1],D=ek(d),O=D[0],M=D[1];return jW(T,O,w),VW(C,M,c),zW(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)ir(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||D3(a)},e})(ry);function dp(n){if(!n||$d(n))return n;var e=n.$_p._ps;return e.length?dp(e[0].b):null}function O3(n){if(n){if(n.b&&$d(n.b))return n;var e=n._ps;return e.length?O3(e[0]):null}}function ua(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=I3(i,["key","ref"]);return{type:n,key:a,ref:o,props:$a($a({},c),{children:E3(t).filter(function(u){return u!=null&&u!==!1})})}}var j3=(function(n){Kp(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(ry),UW=(function(n){Kp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,o=!a.b;if(o){var c=ny(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Hd(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},t.un=function(){D3(this.b)},e})(ry);function FW(n,e,t){var r=t.map(function(u){return ii(u)?null:u.key}),i=ZD(e.map(function(u){return u.k})),a=ZD(r),o=Yp(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=dp(p.b),b=dp(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,tk(t[u],r[u],u,n))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=ii(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,tk(h,r[d],d,n)),!0):(p.i=d,!1)});return QD(QD([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function GW(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=dp(t[i].b);if(a)return a}return null}function tk(n,e,t,r){var i=r.d+1;if(ii(n)||Td(n))return new UW("text_".concat(n),i,e,t,r,null,{});var a=n.type,o=typeof a=="string"?BW:OW;return new o(a,i,e,t,r,n.ref,n.props)}function Xp(n,e,t,r,i,a,o){var c=FW(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,o)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=O3(p);m&&(m._sel=!0)}),n._hyd=null;var h=ny(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=dp(m.b);if(b&&h!==b&&!b.parentNode){var _=GW(n,m);h.insertBefore(b,_)}}),d.length>0}function qW(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new j3(e));var a=[];return Xp(t,t._ps,n?[n]:[],a,r,void 0,void 0),k3(a),aS(null),i||(e.__CROACT__=t),t}function nk(n,e,t){return!t&&n&&(t=new j3(e.parentElement),t._hyd=[e],t._sel=!0),qW(n,e,t),t}function V3(n){var e=N3(),t=e._hs||(e._hs=[]),r=kW(),i=t[r];if(NW(r+1),i){if(!av(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function HW(n,e){var t=V3({func:n,deps:e});return t.value}function $W(n){return HW(function(){return P3(n)},[])}function z3(n,e,t){var r=N3(),i=V3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function YW(n,e,t){z3(function(){n?.(e())},t,!0)}function lS(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function L3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function B3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function cS(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function KW(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function XW(n,e){var t=cS("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function D_(n){return n.replace(/_/g,".")}function fh(n,e){var t=null,r="-1";return lS(n,function(i){var a=cS("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=XW(i.versionTest.toLowerCase(),e)||r),r=D_(r),!0)}),{preset:t,version:r}}function Lm(n,e){var t={brand:"",version:"-1"};return lS(n,function(r){var i=U3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function U3(n,e){return L3(n,function(t){var r=t.brand;return cS(""+e.test,r.toLowerCase())})}var F3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],G3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],k_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],q3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],H3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function $3(n){return!!fh(q3,n).preset}function WW(n){var e=B3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:$3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=fh(F3,e),o=a.preset,c=a.version,u=fh(H3,e),d=u.preset,h=u.version,p=fh(G3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=fh(k_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function QW(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Lm(q3,t).brand||$3(B3())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&lS(k_,function(m){return U3(t,m)});var u=Lm(G3,t);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Lm(k_,t);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=L3(H3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Lm(F3,t);o.name=p.brand||o.name,o.version=p.brand&&n?n.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=D_(c.version),o.version=D_(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function ZW(n){return KW()?QW():WW(n)}function JW(n,e,t,r,i,a){for(var o=0;o<i;++o){var c=t+o*i,u=r+o*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function eQ(n,e,t,r,i){for(var a=0;a<i;++a){var o=t+a*i,c=r+a*i,u=n[o],d=e[o];n[o]=n[c],n[c]=u,e[o]=e[c],e[c]=d}}function tQ(n,e,t,r,i){for(var a=0;a<r;++a){var o=t+a*r;n[o]/=i,e[o]/=i}}function Y3(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function rs(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=un(e),i=0;i<e;++i){var a=e*i+i;if(!lt(t[a],Qn)){for(var o=i+1;o<e;++o)if(t[e*i+o]){eQ(t,r,i,o,e);break}}if(!lt(t[a],Qn))return[];tQ(t,r,i,e,t[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=t[u];!lt(d,Qn)||i===o||JW(t,r,c,i,e,-d)}}return r}function nQ(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function K3(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function rQ(n,e){for(var t=un(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function Mc(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function ma(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=un(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*t+o]=n[a*e+o];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function sv(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=un(n);return e.forEach(function(i){r=en(r,i,n)}),r}function en(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var o=0;o<t;++o)for(var c=0;c<a;++c){r[c*t+o]=0;for(var u=0;u<i;++u)r[c*t+o]+=n[u*t+o]*e[c*i+u]}return r}function Nt(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function Ye(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function iQ(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function X3(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function Mr(n,e,t){t===void 0&&(t=e.length);var r=en(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function aQ(n,e){return en(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function sQ(n,e){return en(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function oQ(n,e){return en(n,Qp(e,4))}function Bm(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return en(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Wp(n,e){return Mr(Qp(e,3),Mc(n,3))}function t1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return en(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function rk(n,e){return en(n,e,4)}function Qp(n,e){var t=Math.cos(n),r=Math.sin(n),i=un(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function un(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function uS(n,e){for(var t=un(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function Pc(n,e){for(var t=un(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function dS(n,e,t,r,i,a,o,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],S=i[0],T=i[1],C=a[0],D=a[1],O=o[0],M=o[1],V=c[0],A=c[1],I=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-S*u,-T*u,-C*h,-D*h,-O*m,-M*m,-V*_,-A*_,-S*d,-T*d,-C*p,-D*p,-O*b,-M*b,-V*w,-A*w],k=rs(I,8);if(!k.length)return[];var z=en(k,[S,T,C,D,O,M,V,A],8);return z[8]=1,ma(nQ(z),3,4)}var Nh=function(){return Nh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Nh.apply(this,arguments)};function lQ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function fp(n,e){return e===void 0&&(e=0),Uu(Ad(n,e))}function cQ(n,e){var t=Mr(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function Uu(n){var e=lQ();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function Ad(n,e){e===void 0&&(e=0);var t=tr(n)?n:ul(n);return t.map(function(r){var i=x3(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=ga(e)?Nh(Nh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=uc(o).map(function(P,J){return J===0&&"x%"in h?h["%"]=e["x%"]:J===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],Jt(P,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],S=w===void 0?0:w;c=t1,d=[m,_,S]}else if(a==="translateY"){var T=ga(e)?Nh({"%":e["y%"]},e):{"%":e},_=Jt(o,T);c=t1,d=[0,_,0]}else if(a==="translateZ"){var S=parseFloat(o);c=t1,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var C=uc(o).map(function(P){return parseFloat(P)}),D=C[0],O=C[1],M=O===void 0?D:O,V=C[2],A=V===void 0?1:V;c=Bm,d=[D,M,A]}else if(a==="scaleX"){var D=parseFloat(o);c=Bm,d=[D,1,1]}else if(a==="scaleY"){var M=parseFloat(o);c=Bm,d=[1,M,1]}else if(a==="scaleZ"){var A=parseFloat(o);c=Bm,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var I=$p(o),k=I.unit,z=I.value,L=k==="rad"?z:z*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=oQ):a==="rotateX"?c=aQ:a==="rotateY"&&(c=sQ),d=L}else if(a==="matrix3d")c=rk,d=uc(o).map(function(P){return parseFloat(P)});else if(a==="matrix"){var B=uc(o).map(function(P){return parseFloat(P)});c=rk,d=[B[0],B[1],0,0,B[2],B[3],0,0,0,0,1,0,B[4],B[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var N_=function(n,e){return N_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},N_(n,e)};function uQ(n,e){N_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var W3=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),Q3=(function(n){uQ(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,W3)||this}return e})(RW);function dQ(n,e){return Yp(n,e,W3)}var M_=function(){return M_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},M_.apply(this,arguments)};function fQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var iy=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(ga(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(ga(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var o=Hs(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var o=!1;return r.eventType=t,r.stop=function(){o=!0},r.currentTarget=this,fQ(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!o},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var o=a[t];o.push(M_({listener:r},i))},n})();var P_=function(n,e){return P_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},P_(n,e)};function hQ(n,e){P_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ku=function(){return Ku=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Ku.apply(this,arguments)};function pQ(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function ik(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function Um(n){if(n){if(ii(n))return document.querySelector(n)}else return null;if(eS(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var gQ=(function(n){hQ(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=Um(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag(Ku(Ku({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],_=m[1]-o[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?pQ:o;return c({container:Um(a),direction:r})},t._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=up(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Um(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll(Ku(Ku({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?ik:i,o=Um(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=ik(window,this._onScroll):this._unregister=a(o,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(iy);function mQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function ei(n){return lt(n,Qn)}function vQ(n,e){return n.every(function(t,r){return ei(t-e[r])===0})}function yQ(n,e){return!ei(n[0]-e[0])&&!ei(n[1]-e[1])}function Z3(n){return n.length<3?0:Math.abs(xW(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function ak(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,o=Oc(n),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function Oc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function O_(n,e,t){var r=n[0],i=n[1],a=Oc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=ov(u[0],u[1]),h=j_(e),p=[];if(h.forEach(function(_){var w=ov(_[0],_[1]),S=_[0];if(vQ(d,w))p.push({pos:n,line:_,type:"line"});else{var T=J3(fS(d,w),[u,_]);T.forEach(function(C){_.some(function(D){return yQ(D,C)})?p.push({pos:C,line:_,type:"point"}):ei(S[1]-i)!==0&&p.push({pos:C,line:_,type:"intersection"})})}}),ai(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,S=_.type,T=_.line;if(!(w[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var C=ai(T,function(M){return M[1]!==i}),D=b[w[0]],O=C[1]>i?1:-1;D?D!==O&&++m:b[w[0]]=O}}}),m%2===1}function ov(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],o=i-t,c=a-r;Math.abs(o)<Qn&&(o=0),Math.abs(c)<Qn&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function fS(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],o=e[1],c=e[2],u=t===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,S=-(o*w+c)/a;h=[[S,w]]}else if(a===0){var w=-c/o,S=-(r*w+i)/t;h=[[S,w]]}else if(r===0){var S=-i/t,w=-(a*S+c)/o;h=[[S,w]]}else if(o===0){var S=-c/a,w=-(t*S+i)/r;h=[[S,w]]}else{var S=(r*c-o*i)/(o*t-r*a),w=-(t*S+i)/r;h=[[S,w]]}return h.map(function(T){return[T[0],T[1]]})}function J3(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],o=i[1];if(ei(a-n[1][0])){if(!ei(o-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(ei(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(ei(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=ei(m-_[0][0])&&0<=ei(_[0][1]-m)&&0<=ei(b-_[1][0])&&0<=ei(_[1][1]-b)})})),r.map(function(p){return[ei(p[0]),ei(p[1])]})}function j_(n){return mQ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function bQ(n,e){var t=n.slice(),r=e.slice();XD(t)===-1&&t.reverse(),XD(r)===-1&&r.reverse();var i=j_(t),a=j_(r),o=i.map(function(h){return ov(h[0],h[1])}),c=a.map(function(h){return ov(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var S=fS(h,_),T=J3(S,[m,a[w]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:w,pos:C,type:"intersection"}}))}),b.sort(function(_,w){return Os(m[0],_.pos)-Os(m[0],w.pos)}),u.push.apply(u,b),O_(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(O_(h[1],t)){var m=!1,b=Hs(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Hs(u,function(_){var w=_.index1,S=_.index2;return w===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function xQ(n,e){var t=bQ(n,e);return t.map(function(r){var i=r.pos;return i})}function _Q(n,e){var t=xQ(n,e);return Z3(t)}var V_=function(n,e){return V_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},V_(n,e)};function wQ(n,e){V_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Kn=function(){return Kn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Kn.apply(this,arguments)};function EQ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function n1(n){return EQ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function SQ(n){return n.touches&&n.touches.length>=2}function Fm(n){return n?n.touches?AQ(n.touches):[ej(n)]:[]}function TQ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function sk(n,e,t){var r=t.length,i=Mh(n,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=Mh(e,r),h=d.clientX,p=d.clientY,m=Mh(t,r),b=m.clientX,_=m.clientY,w=a-h,S=o-p,T=a-b,C=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:S,distX:T,distY:C}}function r1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function AQ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(ej(n[r]));return t}function ej(n){return{clientX:n.clientX,clientY:n.clientY}}function Mh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var i1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),n1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),n1(e)-n1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=sk(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],o=0;o<i;++o)a[o]=sk([e[o]],[t[o]],[r[o]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=Mh(e,this.length),i=Mh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),r1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),r1(e)/r1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),ok=["textarea","input"],CQ=(function(n){wQ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,S=w.container,T=w.pinchOutside,C=w.preventWheelClick,D=w.preventRightClick,O=w.preventDefault,M=w.checkInput,V=w.dragFocusedInput,A=w.preventClickEventOnDragStart,I=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,z=i._useTouch,L=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||D&&(m.which===3||m.button===2))return i.stop(),!1;if(L){var B=i._window.document.activeElement,P=m.target;if(P){var J=P.tagName.toLowerCase(),Y=ok.indexOf(J)>-1,H=P.isContentEditable;if(Y||H){if(M||!V&&B===P)return!1;if(B&&(B===P||H&&B.isContentEditable&&B.contains(P)))if(V)P.blur();else return!1}else if((O||m.type==="touchstart")&&B){var W=B.tagName.toLowerCase();(B.isContentEditable||ok.indexOf(W)>-1)&&B.blur()}(A||I||k)&&_r(i._window,"click",i._onClick,!0)}i.clientStores=[new i1(Fm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=up()-i.prevTime<200,i._isMouseEvent=TQ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var K=i._preventMouseEvent||i.emit("dragStart",Kn(Kn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));K===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&m.preventDefault()}if(!i.flag)return!1;var de=0;if(L?(i._attchDragEvent(),z&&T&&(de=setTimeout(function(){_r(S,"touchstart",i.onDragStart,{passive:!1})}))):z&&T&&ir(S,"touchstart",i.onDragStart),i.flag&&SQ(m)){if(clearTimeout(de),L&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Fm(m),S=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",Kn(Kn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,D=i.isDrag;(S||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&S&&!D&&i._allowClickEvent(),i._useTouch&&_&&ir(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var O=m?.touches?Fm(m):[],M=O.length;M===0||!i.options.keepDragging?i.flag=!1:i._addStore(new i1(O));var V=i._getPosition(),A=up(),I=!D&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=D||I?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",Kn({data:i.data,datas:i.data,isDouble:I,isDrag:D,isClick:!D,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},V)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){ir(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),o=a[0];i._window=C3(o)?o:nl(o),i.options=Kn({checkInput:!1,container:o&&!("document"in o)?nl(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){_r(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){_r(m,"mousedown",i.onDragStart),_r(m,"mousemove",i._passCallback)}),_r(u,"contextmenu",i._onContextMenu)),h&&_r(nl(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){_r(m,"touchstart",i.onDragStart,p),_r(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),Kn(Kn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),ir(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){ir(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){ir(a,"mousedown",t.onDragStart)}),ir(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){ir(a,"touchstart",t.onDragStart)}),ir(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new i1(Fm(t));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",Kn(Kn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Kn(Kn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Kn(Kn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),Kn(Kn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return Kn(Kn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(_r(r,"dragover",this.onDrag,i),_r(t,"dragend",this.onDragEnd)),this._useMouse&&(_r(r,"mousemove",this.onDrag),_r(t,"mouseup",this.onDragEnd)),this._useTouch&&(_r(r,"touchmove",this.onDrag,i),_r(t,"touchend",this.onDragEnd,i),_r(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&(ir(r,"dragover",this.onDrag),ir(t,"dragend",this.onDragEnd)),this._useMouse&&(ir(r,"mousemove",this.onDrag),ir(t,"mouseup",this.onDragEnd)),this._useTouch&&(ir(r,"touchstart",this.onDragStart),ir(r,"touchmove",this.onDrag),ir(t,"touchend",this.onDragEnd),ir(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(iy);function IQ(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var RQ=IQ;function DQ(n){return RQ(n).toString(36)}function kQ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function NQ(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?uc(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function MQ(n,e,t,r,i){var a=Hd(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",n),o.setAttribute("data-styled-count","1"),t.nonce&&o.setAttribute("nonce",t.nonce),o.innerHTML=NQ(n,e,t),(i||a.head||a.body).appendChild(o),o}function PQ(n){var e="rCS"+DQ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=kQ(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=MQ(e,n,r,t,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var z_=function(){return z_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},z_.apply(this,arguments)};function OQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function tj(n,e){var t=PQ(e),r=t.className;return MW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=OQ(i,["className","cspNonce"]),d=$W();return YW(a,function(){return d.current},[]),z3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),ua(n,z_({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var L_=function(n,e){return L_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},L_(n,e)};function Zp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");L_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Q=function(){return Q=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Q.apply(this,arguments)};function jQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function VQ(n,e,t,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function zQ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ne(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Ae(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Jp(n,e){return Q({events:[],props:[],name:n},e)}var LQ=["n","w","s","e"],hS=["n","w","s","e","nw","ne","sw","se"];function BQ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function UQ(n){var e=BQ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Yd=ZW(),nj=Yd.browser.webkit,rj=nj&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),ij=Yd.browser.name,aj=parseInt(Yd.browser.version,10),FQ=ij==="chrome",GQ=Yd.browser.chromium,qQ=parseInt(Yd.browser.chromiumVersion,10)||0,HQ=FQ&&aj>=109||GQ&&qQ>=109,$Q=ij==="firefox",YQ=parseInt(Yd.browser.webkitVersion,10)>=612||aj>=15,pS="moveable-",KQ=hS.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),XQ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(KQ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(UQ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(rj?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),WQ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],B_=1e-4,$r=1e-7,Gm=1e-9,U_=Math.pow(10,10),lk=-U_,QQ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},gS={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},sj={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},oj=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function eg(n,e,t,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return Q(Q({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var Cd=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),Q(Q({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function sd(n,e,t,r){var i=n.length===16,a=i?4:3,o=Fc(n,t,r,a),c=ne(o,4),u=ne(c[0],2),d=u[0],h=u[1],p=ne(c[1],2),m=p[0],b=p[1],_=ne(c[2],2),w=_[0],S=_[1],T=ne(c[3],2),C=T[0],D=T[1],O=ne(wn(n,e,a),2),M=O[0],V=O[1],A=Math.min(d,m,w,C),I=Math.min(h,b,S,D),k=Math.max(d,m,w,C),z=Math.max(h,b,S,D);d=d-A||0,m=m-A||0,w=w-A||0,C=C-A||0,h=h-I||0,b=b-I||0,S=S-I||0,D=D-I||0,M=M-A||0,V=V-I||0;var L=n[0],B=n[a+1],P=Ur(L*B);return{left:A,top:I,right:k,bottom:z,origin:[M,V],pos1:[d,h],pos2:[m,b],pos3:[w,S],pos4:[C,D],direction:P}}function lj(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=ne(Ye(Dd(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],S=ne(os({datas:i,distX:_,distY:w}),2),T=S[0],C=S[1];return[T,C]}function Uc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;t.is3d=o,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=rs(i,b),t.inverseBeforeMatrix=rs(a,b),t.absoluteOrigin=Mc(Nt([c,u],d),b),t.startDragBeforeDist=Mr(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=Mr(t.inverseMatrix,t.absoluteOrigin,b)}function ZQ(n){return sd(n.datas.beforeTransform,[50,50],100,100).direction}function ay(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=Hs(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):ai(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=SJ(o,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ae(Ae([],ne(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function sy(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function JQ(n){var e=n.datas,t=n.distX,r=n.distY,i=ne(uj({datas:e,distX:t,distY:r}),2),a=i[0],o=i[1],c=cj(e,rQ([a,o],4));return Mr(c,Mc([0,0,0],4),4)}function cj(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,o=n.afterTransform2,c=n.targetAllTransform,u=t?en(c,e,4):en(e,c,4),d=en(rs(t?a:r,4),u,4),h=en(d,rs(t?o:i,4),4);return h}function uj(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return Ye(Mr(i,Nt(c,[t,r]),u),o)}function os(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,o=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return Ye(Mr(e?a:o,Nt(h,[r,i]),p),e?u:d)}function eZ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,o=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=o?4:3;return Ye(Mr(a,Nt(c,[r,i]),d),u)}function tZ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(o,c){var u=$p(o),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function dj(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function nZ(n,e){return dj(e).map(function(t){return n[t]})}function a1(n,e){var t=(e+1)/2;return[iv(n[0][0],n[1][0],t,1-t),iv(n[0][1],n[1][1],t,1-t)]}function or(n,e){var t=a1([n[0],n[1]],e[0]),r=a1([n[2],n[3]],e[0]);return a1([t,r],e[1])}function rZ(n,e,t,r,i,a){var o=Fc(e,t,r,i),c=or(o,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function tg(n,e,t,r){return en(n,Oh(e,r,t),r)}function iZ(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,o=n.is3d,c=o?4:3,u;if(ii(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=ma(fp(t),4,c):u=ma(en(en(d,fp([t]),4),h,4),4,c)}else u=t;return tg(a,u,i,c)}function aZ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,o=n.targetAllTransform,c=i?4:3;return tg(r,en(o||a,uS(e,c),c),t,c)}function oy(n,e){var t=Kd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=tr(r)?r:ul(r),F_(n,e,i)},setTransformIndex:function(r){F_(n,e,r)}}}function ly(n,e,t){var r=Kd(e),i=r.startTransforms;F_(n,e,Hs(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function F_(n,e,t){var r=Kd(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var o=n.state,c=Ad([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function mS(n,e){var t=Kd(n);t.nextTransforms=ul(e)}function Kd(n){return n.originalDatas.beforeRenderable}function lv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function qm(n){return(lv(n)||[]).join(" ")}function Hm(n){return Kd(n).nextStyle}function fj(n,e,t,r,i){mS(i,e);var a=Br.drag(n,eg(i,n.state,t,r)),o=a?a.transform:e;return Q(Q({transform:e,drag:a},qr({transform:o},i)),{afterTransform:o})}function vS(n,e,t,r,i,a){var o=iZ(n.state,i,e,a),c=lZ(n,t,r,o);return c}function hj(n,e,t,r,i,a,o){var c=vS(n,e,t,i,a,o),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=Ye(r,c);return Ye(_,[m,b])}function sZ(n,e,t,r,i,a,o){var c=hj(n,e,t,r,i,a,o);return c}function oZ(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function lZ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],o/2*(1+e[1])+t[1]];return wn(r,d,u)}function cZ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return hj(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function uZ(n,e,t,r,i,a){var o=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=tZ(i,e,t,p,m,u),D=o?b:0,O=o?_:0,M=tg(d,S,C,T),V=rZ(r,M,e,t,T,w);return Ye(V,[D,O])}function dZ(n,e){return or(Yi(n.state),e)}function fZ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function hZ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function pZ(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function pj(n,e,t){for(var r=n,i=[],a=rS(n)||bl(n),o=!t&&n===e||n===a,c=o,u=!1,d=3,h,p,m,b=!1,_=pp(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var S=si(r),T=S("position"),C=zj(r),D=T==="fixed",O=pZ(S),M=iQ(dJ(C)),V=void 0,A=!1,I=!1,k=0,z=0,L=0,B=0,P={hasTransform:!1,fixedContainer:null};D&&(b=!0,P=mJ(r),_=P.fixedContainer);var J=M.length;!u&&(J===16||O.length)&&(u=!0,d=4,K_(i),m&&(m=ma(m,3,4))),u&&J===9&&(M=ma(M,3,4));var Y=gJ(r,n),H=Y.tagName,W=Y.hasOffset,K=Y.isSVG,de=Y.origin,te=Y.targetOrigin,G=Y.offset,$=ne(G,2),Z=$[0],ee=$[1];H==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:vJ(r,d)}),i.push({type:"offset",target:r,matrix:un(d)}));var le=parseFloat(S("zoom"))||1;if(D)V=P.fixedContainer,A=!0;else{var he=pp(r,e,!1,!0,S),se=he.offsetZoom;if(V=he.offsetParent,A=he.isEnd,I=he.isStatic,w*=se,(he.isCustomElement||se!==1)&&I)Z-=V.offsetLeft,ee-=V.offsetTop;else if($Q||HQ){var Se=he.parentSlotElement;if(Se){for(var Me=V,Ge=0,Ee=0;Me&&hZ(Me);)Ge+=Me.offsetLeft,Ee+=Me.offsetTop,Me=Me.offsetParent;Z-=Ge,ee-=Ee}}}if(nj&&!YQ&&W&&!K&&I&&(T==="relative"||T==="static")&&(Z-=V.offsetLeft,ee-=V.offsetTop,o=o||A),D)W&&P.hasTransform&&(L=V.clientLeft,B=V.clientTop);else if(W&&_!==V&&(k=V.clientLeft,z=V.clientTop),W&&V===a){var ke=Lj(r,!1);Z+=ke[0],ee+=ke[1]}if(i.push({type:"target",target:r,matrix:Oh(M,d,de)}),O.length&&(i.push({type:"offset",target:r,matrix:un(d)}),i.push({type:"target",target:r,matrix:Oh(fp(O),d,de)})),W){var ut=r===n,Le=ut?0:r.scrollLeft,Fe=ut?0:r.scrollTop;i.push({type:"offset",target:r,matrix:Pc([Z-Le+k-L,ee-Fe+z-B],d)})}else i.push({type:"offset",target:r,origin:de});if(le!==1&&i.push({type:"zoom",target:r,matrix:Oh(uS([le,le],d),d,[0,0])}),m||(m=M),h||(h=de),p||(p=te),c||D)break;r=V,o=A,(!t||r===a)&&(c=o)}return m||(m=un(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var rc=null,ic=null,Xu=null;function Id(n){n?(window.Map&&(rc=new Map,ic=new Map),Xu=[]):(rc=null,Xu=null,ic=null)}function gZ(n){var e=ic?.get(n);if(e)return e;var t=jh(n,!0);return ic&&ic.set(n,t),t}function mZ(n,e){if(Xu){var t=ai(Xu,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=pj(n,e,!0);return Xu&&Xu.push([[n,e],r]),r}function si(n){var e=rc?.get(n);if(!e){var t=nl(n).getComputedStyle(n);if(!rc)return function(a){return t[a]};e={style:t,cached:{}},rc.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function da(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},Q(Q({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function s1(n,e,t,r,i,a,o){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=da(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,S){var T=m[S],C=T.state,D=C.gestos,O=w;if(c)O=new Cd(o).dragStart(r,w),b.push(O);else{if(D[o]||(D[o]=h.childGestos[S]),!D[o])return;O=eg(w,C,r,d,a,o),b.push(O)}var M=e[t](T,Q(Q({},O),{parentFlag:!0}));return u&&(D[o]=null),M});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:b}}function js(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!t.match(/End$/g),c=da(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,Q(Q({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function cv(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,o=r.datas.startPositions||Yi(e.state),c=or(o,i),u=ne(Mr(Qp(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function gj(n,e,t,r){var i=n.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=jc(n.props,e).zoom,d=Ph(o/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=Ur(c);return t.map(function(_){var w=_.data,S=_.classNames,T=_.dir,C=gS[T];if(!C||!h[T])return null;m[T]=!0;var D=(lt(d,15)+b*sj[T]+720)%180,O={};return $s(w).forEach(function(M){O["data-".concat(M)]=w[M]}),r.createElement("div",Q({className:qe.apply(void 0,Ae(["control","direction",T,e],ne(S),!1)),"data-rotation":D,"data-direction":T},O,{key:"direction-".concat(T),style:hv.apply(void 0,Ae([o,u],ne(C.map(function(M){return a[M]})),!1))}))})}function mj(n,e,t,r){var i=jc(n.props,t),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?hS:o;return Ae(Ae([],ne(c?xj(n,r,t,u):[]),!1),ne(gj(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function hp(n,e,t,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=Ln(t,r),d=e?lt(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:qe.apply(void 0,Ae(["line","direction",e?"edge":"",e],ne(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:ph(t,r,i,u)})}function vj(n,e,t,r,i){var a=t===!0?LQ:t;return a.map(function(o,c){var u=ne(gS[o],2),d=u[0],h=u[1];if(h!=null)return hp(n,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function yj(n){return function(e,t){var r=jc(e.props,n).edge;return r&&(r===!0||r.length)?Ae(Ae([],ne(vj(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),ne(vZ(e,n,t)),!1):bj(e,n,t)}}function bj(n,e,t){return mj(n,hS,e,t)}function vZ(n,e,t){return mj(n,["nw","ne","sw","se"],e,t)}function xj(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=Ur(u),m=c/Math.PI*180;return(r||$s(d)).map(function(b){var _=gS[b];if(!_)return null;var w=(lt(m,15)+p*sj[b]+720)%180,S=["around-control"];return t&&S.push("direction",t),e.createElement("div",{className:qe.apply(void 0,Ae([],ne(S),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:hv.apply(void 0,Ae([c,h],ne(_.map(function(T){return o[T]})),!1))})})}function yS(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:ck(_,e,!0),horizontal:ck(_,t,!1)}}function cy(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",S=b.left,T=S===void 0?-1/0:S,C=b.top,D=C===void 0?-1/0:C,O=b.right,M=O===void 0?w?-1/0:1/0:O,V=b.bottom,A=V===void 0?w?-1/0:1/0:V;return w&&(M=a+p-d-M,A=i+m-h-A),{left:T+d-o,right:M+d-o,top:D+h-c,bottom:A+h-c}}function yZ(n,e,t){var r=cy(n),i=r.left,a=r.top,o=r.right,c=r.bottom,u=ne(t,2),d=u[0],h=u[1],p=ne(Ye(t,e),2),m=p[0],b=p[1];xe(m)<$r&&(m=0),xe(b)<$r&&(b=0);var _=b>0,w=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var C=b/m,D=t[1]-C*d,O=0,M=0,V=!1;w&&o<=d?(O=C*o+D,M=o,V=!0):!w&&d<=i&&(O=C*i+D,M=i,V=!0),V&&(O<a||O>c)&&(V=!1),V||(_&&c<=h?(O=c,M=(O-D)/C,V=!0):!_&&h<=a&&(O=a,M=(O-D)/C,V=!0)),V&&(S.isBound=!0,S.pos=M,S.offset=d-M,T.isBound=!0,T.pos=O,T.offset=h-O)}return{vertical:S,horizontal:T}}function ck(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ae([],ne(e),!1)),o=Math.max.apply(Math,Ae([],ne(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return xe(d.offset)-xe(u.offset)})}function uk(n,e,t){var r=t?n.map(function(i){return Wp(i,t)}):n;return r.some(function(i){return i[0]<e.left&&xe(i[0]-e.left)>.1||i[0]>e.right&&xe(i[0]-e.right)>.1||i[1]<e.top&&xe(i[1]-e.top)>.1||i[1]>e.bottom&&xe(i[1]-e.bottom)>.1})}function bZ(n,e,t){var r=$i(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return xe(a-n[t?0:1])-xe(o-n[t?0:1])}).map(function(a){return Ln([0,0],t?[a,e]:[e,a])})}function xZ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,o=cy(n),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!uk(t,w,0))return[];var S=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var C=ne(T,2),D=C[0],O=C[1];t.forEach(function(M){var V=Ln([0,0],M);S.push.apply(S,Ae([],ne(bZ(M,D,O).map(function(A){return a+A-V}).filter(function(A){return!uk(e,w,A)}).map(function(A){return lt(A*180/Math.PI,$r)})),!1))})}),S}var _Z=["left","right","center"],wZ=["top","bottom","middle"],dk={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},dl={start:"left",end:"right",center:"center"},fl={start:"top",end:"bottom",center:"middle"};function Wu(){return{left:!1,top:!1,right:!1,bottom:!1}}function Xd(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,o=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function bS(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function EZ(n,e){var t=bS(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function xS(n,e){var t=EZ(n,e),r=wZ.filter(function(a){return a in t}),i=_Z.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function SZ(n,e,t){var r=wn(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function TZ(n){var e=ne(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Qn&&(i=0),Math.abs(a)<Qn&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*t[0]-t[1]):(c=1,u=-t[1]):(o=-1,u=t[0]),[o,c,u].map(function(d){return lt(d,Qn)})}var _j="snapRotationThreshold",wj="snapRotationDegrees",Ej="snapHorizontalThreshold",Sj="snapVerticalThreshold";function uy(n,e,t,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=Ak(o,u[Ej],5),p=Ak(a,u[Sj],5);return Tj(n.state.guidelines,e,t,r,i,h,p,d)}function Tj(n,e,t,r,i,a,o,c){return{vertical:hk(n,"vertical",e,o*c[0],r),horizontal:hk(n,"horizontal",t,a*c[1],i)}}function AZ(n,e,t){var r=ne(t,2),i=r[0],a=r[1],o=ne(e,2),c=o[0],u=o[1],d=ne(Ye(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=pv(h),p=pv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var S=uy(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,C=S.horizontal;T.posInfos.filter(function(H){var W=H.pos;return b?W>=c:W<=c}),C.posInfos.filter(function(H){var W=H.pos;return m?W>=u:W<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var D=G_(T),O=D.isSnap,M=D.guideline,V=G_(C),A=V.isSnap,I=V.guideline,k=A?I.pos[1]:0,z=O?M.pos[0]:0;if(h===0)A&&(w.isSnap=!0,w.pos=I.pos[1],w.offset=a-w.pos);else if(p===0)O&&(_.isSnap=!0,_.pos=z,_.offset=i-z);else{var L=p/h,B=t[1]-L*i,P=0,J=0,Y=!1;O?(J=z,P=L*J+B,Y=!0):A&&(P=k,J=(P-B)/L,Y=!0),Y&&(_.isSnap=!0,_.pos=J,_.offset=i-J,w.isSnap=!0,w.pos=P,w.offset=a-P)}return{vertical:_,horizontal:w}}function Yo(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function fk(n,e,t,r){var i=xS(n.props.snapDirections,e),a=uy(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Yo(u)}),i.horizontalNames.map(function(u){return Yo(u)}),t,r),o=Yo(i.horizontalNames[a.horizontal.index]),c=Yo(i.verticalNames[a.vertical.index]);return{vertical:Q(Q({},a.vertical),{direction:c}),horizontal:Q(Q({},a.horizontal),{direction:o})}}function G_(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:o}}function hk(n,e,t,r,i){var a,o;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var S=w.pos,T=p-S[u];return{offset:T,dist:xe(T),guideline:w,direction:b}}).filter(function(w){var S=w.guideline,T=w.dist,C=S.type;return!(C!==e||T>r)}).sort(function(w,S){return w.dist-S.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function CZ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ae([],ne(nZ([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return or(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=uy(n,c,u,a.map(function(m){return Yo(m[0])}),a.map(function(m){return Yo(m[1])}),r,i),h=Yo(a.map(function(m){return m[0]})[d.vertical.index]),p=Yo(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:Q(Q({},d.vertical),{direction:h}),horizontal:Q(Q({},d.horizontal),{direction:p})}}function Aj(n,e){var t=xe(n.offset),r=xe(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<$r?1:r<$r?-1:t-r}function uv(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],o=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return Aj({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function IZ(n,e,t){var r=[];if(t)xe(e[0])!==1||xe(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=xe(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*n[0],-1]],[[e[0],0],[o*n[0],0]],[[e[0],1],[o*n[0],1]])})}else if(n[1]){var a=xe(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function Cj(n,e){var t=I_([e[0][0],e[1][0]]),r=I_([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function _S(n,e){var t=ne(e,2),r=t[0],i=t[1],a=i[0]-r[0],o=i[1]-r[1];xe(a)<$r&&(a=0),xe(o)<$r&&(o=0);var c,u;if(!a)c=r[0],u=n[0];else if(!o)c=r[1],u=n[1];else{var d=o/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function Ij(n,e,t,r){return r===void 0&&(r=$r),n.every(function(i){var a=_S(i,e),o=a<=0;return o===t||xe(a)<=r})}function pk(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function RZ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(Ij([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=Ko(t,o,b,i),T=Ko(t,o,w,i),C=Ko(t,o,m,a),D=Ko(t,o,_,a),O=S.isBound&&T.isBound,M=S.isBound||T.isBound,V=C.isBound&&D.isBound,A=C.isBound||D.isBound,I=Rd(S.offset,T.offset),k=Rd(C.offset,D.offset),z=[0,0],L=!1,B=!1;return xe(k)<xe(I)?(z=[I,0],L=M,B=O):(z=[0,k],L=A,B=V),{isAllBound:B,isVerticalBound:M,isHorizontalBound:A,isBound:L,offset:z}}function Ko(n,e,t,r,i,a){var o=ne(e,2),c=o[0],u=o[1],d=n[0],h=t[0],p=t[1],m=pv(p[1]-h[1]),b=pv(p[0]-h[0]),_=u,w=c,S=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var O=(h[1]-d[1])/S+d[0];return pk(O,h[0],p[0],r,i)}else{var C=h[1]-d[1],D=xe(C)<=(i||0);return{isBound:D,offset:D?C:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=S*(h[0]-d[0])+d[1];return pk(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],D=xe(C)<=(i||0);return{isBound:D,offset:D?C:0}}}return{isBound:!1,offset:0}}function Rj(n,e,t){return e.map(function(r){var i=RZ(n,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=os({datas:t,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function DZ(n,e,t){var r,i=wS(n,e,[0,0],!1).map(function(m){return Q(Q({},m),{multiple:m.multiple.map(function(b){return xe(b)*2})})}),a=Rj(n,i,t),o=uv(a,0),c=uv(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=ne(eZ({datas:t,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function kZ(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function wS(n,e,t,r){var i=n.state,a=i.allMatrix,o=i.is3d,c=Fc(a,100,100,o?4:3),u=or(c,[0,0]);return kZ(t,r).map(function(d){var h=ne(d,3),p=h[0],m=h[1],b=h[2],_=[or(c,m),or(c,b)],w=TZ(_),S=Cj(u,_),T=S.vertical,C=S.horizontal,D=_S(u,_)<=0;return{multiple:p,centerSign:D,verticalSign:T,horizontalSign:C,lineConstants:w,line:[or(e,m),or(e,b)]}})}function gk(n,e,t,r){var i=r?n.map(function(a){return Wp(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=_S(t,a)<=0;return!Ij(e,a,o)})}function NZ(n){var e=ne(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return xe(t[0]);if(!a)return xe(t[1]);var o=a/i;return xe((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function MZ(n){var e=ne(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var o=a/i,c=-o*t[0]+t[1];return[-c/(o+1/o),c/(o*o+1)]}function PZ(n,e,t,r,i){var a=n.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],S=or(t,[0,0]);if(!gk(t,w,S,0))return[];var T=[],C=w.map(function(D){return[$i(D),Ln([0,0],D)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(D){var O=Ln([0,0],MZ(D)),M=NZ(D);T.push.apply(T,Ae([],ne(C.filter(function(V){var A=ne(V,1),I=A[0];return I&&M<=I}).map(function(V){var A=ne(V,2),I=A[0],k=A[1],z=Math.acos(I?M/I:0),L=k+z,B=k-z;return[o+L-O,o+B-O]}).reduce(function(V,A){return V.push.apply(V,Ae([],ne(A),!1)),V},[]).filter(function(V){return!gk(e,w,S,V)}).map(function(V){return lt(V*180/Math.PI,$r)})),!1))}),T}function OZ(n){var e=n.props.innerBounds,t=Wu();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=or(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=wS(n,u,[0,0],!1),D=[],O=[];return C.forEach(function(M){var V=M.line,A=M.lineConstants,I=Cj(d,V),k=I.horizontal,z=I.vertical,L=Ko(V,A,w,z,1,!0),B=Ko(V,A,T,z,1,!0),P=Ko(V,A,_,k,1,!0),J=Ko(V,A,S,k,1,!0);L.isBound&&!t.top&&(D.push(p),t.top=!0),B.isBound&&!t.bottom&&(D.push(p+b),t.bottom=!0),P.isBound&&!t.left&&(O.push(h),t.left=!0),J.isBound&&!t.right&&(O.push(h+m),t.right=!0)}),{boundMap:t,horizontal:D,vertical:O}}function jZ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(xe(i)<Qn&&(i=0),xe(a)<Qn&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var o=a/i,c=n[1]-o*n[0];if(r){var u=o*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/o;return[d-e[0],t]}}function q_(n,e,t,r,i){var a=jZ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=Os(n,e),c=Os(a,n),u=Os(a,e),d=c>o||u>o,h=ne(os({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function dv(n,e){return n.isBound?n.offset:e.isSnap?G_(e).offset:0}function VZ(n,e,t,r,i){var a=ne(e,2),o=a[0],c=a[1],u=ne(t,2),d=u[0],h=u[1],p=ne(r,2),m=p[0],b=p[1],_=ne(i,2),w=_[0],S=_[1],T=-w,C=-S;if(n&&o&&c){T=0,C=0;var D=[];if(d&&h?D.push([0,S],[w,0]):d?D.push([w,0]):h?D.push([0,S]):m&&b?D.push([0,S],[w,0]):m?D.push([w,0]):b&&D.push([0,S]),D.length){D.sort(function(A,I){return $i(Ye([o,c],A))-$i(Ye([o,c],I))});var O=D[0];if(O[0]&&xe(o)>Qn)T=-O[0],C=c*xe(o+T)/xe(o)-c;else if(O[1]&&xe(c)>Qn){var M=c;C=-O[1],T=o*xe(c+C)/xe(M)-o}if(n&&h&&d)if(xe(T)>Qn&&xe(T)<xe(w)){var V=xe(w)/xe(T);T*=V,C*=V}else if(xe(C)>Qn&&xe(C)<xe(S)){var V=xe(S)/xe(C);T*=V,C*=V}else T=Rd(-w,T),C=Rd(-S,C)}}else T=o||d?-w:0,C=c||h?-S:0;return[T,C]}function zZ(n,e,t,r,i,a){if(!Xd(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=TS(a.absolutePoses,[e,t]),c=qi(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(J){return J[1]}),vertical:o.map(function(J){return J[0]})},b=bS(n.props.snapDirections),_=xS(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=dy(n,i,_,m),S=w.vertical,T=w.horizontal,C=DZ(n,o,a),D=C.vertical,O=C.horizontal,M=S.isSnap,V=T.isSnap,A=S.isBound||D.isBound,I=T.isBound||O.isBound,k=Rd(S.offset,D.offset),z=Rd(T.offset,O.offset),L=ne(VZ(r,[e,t],[A,I],[M,V],[k,z]),2),B=L[0],P=L[1];return[{isBound:A,isSnap:M,offset:B},{isBound:I,isSnap:V,offset:P}]}function dy(n,e,t,r){r===void 0&&(r=t);var i=yS(cy(n),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:uy(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=dv(a[0],u),p=dv(o[0],d),m=xe(h),b=xe(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function mk(n,e,t,r,i,a,o){o===void 0&&(o=[1,1]);var c=yS(e,t,r),u=c.horizontal,d=c.vertical,h=Tj(n,t,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=dv(u[0],p),_=dv(d[0],m),w=xe(b),S=xe(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:S,bounds:d,snap:m}}}function LZ(n,e,t,r){var i=Ln(n,e)/Math.PI*180,a=t.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function BZ(n,e,t,r,i,a){return t.map(function(o){var c=ne(o,2),u=c[0],d=c[1],h=or(e,u),p=or(e,d),m=r?UZ(n,h,p,i):dy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,S=b.isSnap,T=m.vertical,C=T.offset,D=T.isBound,O=T.isSnap,M=Ye(d,u);if(!C&&!_)return{isBound:D||w,isSnap:O||S,sign:M,offset:[0,0]};var V=LZ(h,p,m,r);if(!V)return{sign:M,isBound:!1,isSnap:!1,offset:[0,0]};var A=V==="vertical",I=[0,0];return!r&&xe(d[0])===1&&xe(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?I=os({datas:a,distX:-C,distY:-_}):I=q_(h,p,-(A?C:_),A,a).offset,I=I.map(function(k,z){return k*(M[z]?2/M[z]:0)}),{sign:M,isBound:A?D:w,isSnap:A?O:S,offset:I}})}function vk(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function UZ(n,e,t,r){var i=yZ(n,e,t),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:AZ(n,e,t),u=c.horizontal,d=c.vertical,h=vk(a,u),p=vk(o,d),m=xe(h),b=xe(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function FZ(n,e,t,r,i){var a=[-t[0],-t[1]],o=n.state,c=o.width,u=o.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,S=w===void 0?-1/0:w,T=d.right,C=T===void 0?1/0:T,D=d.bottom,O=D===void 0?1/0:D;m.forEach(function(M){var V=M[0]!==a[0],A=M[1]!==a[1],I=or(e,M),k=Ln(r,I)*360/Math.PI;if(A){var z=I.slice();(xe(k-360)<2||xe(k-180)<2)&&(z[1]=r[1]);var L=q_(r,z,(r[1]<I[1]?O:S)-I[1],!1,i),B=ne(L.offset,2),P=B[1],J=L.isOutside;isNaN(P)||(p=u+(J?1:-1)*xe(P))}if(V){var z=I.slice();(xe(k-90)<2||xe(k-270)<2)&&(z[0]=r[0]);var Y=q_(r,z,(r[0]<I[0]?C:_)-I[0],!0,i),H=ne(Y.offset,1),W=H[0],K=Y.isOutside;isNaN(W)||(h=c+(K?1:-1)*xe(W))}})}return{maxWidth:h,maxHeight:p}}var Br={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,o=n.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=$i(d),p=Ln(d,[0,0]);return[e.createElement("div",{className:qe("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],Uc(n,e),ly(n,e,"translate"),oJ(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=pt(n,e,Q({set:function(h){t.startValue=h}},oy(n,e))),d=r||Oe(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){ay(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,S=t.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=n.props,C=T.parentMoveable,D=d?0:T.throttleDrag||h||0,O=r?0:T.throttleDragRotate||0,M=0,V=!1,A=!1,I=!1,k=!1;if(!r&&O>0&&(p||m)){var z=T.startDragRotate||0,L=lt(z+Ln([0,0],[p,m])*180/Math.PI,O)-z,B=m*Math.abs(Math.cos((L-90)/180*Math.PI)),P=p*Math.abs(Math.cos(L/180*Math.PI)),J=$i([P,B]);M=L*Math.PI/180,p=J*Math.cos(M),m=J*Math.sin(M)}if(!a&&!r&&!i){var Y=ne(zZ(n,p,m,O,!c&&u||o,t),2),H=Y[0],W=Y[1];V=H.isSnap,A=H.isBound,I=W.isSnap,k=W.isBound;var K=H.offset,de=W.offset;p+=K,m+=de}var te=Nt(uj({datas:t,distX:p,distY:m}),S),G=Nt(JQ({datas:t,distX:p,distY:m}),S);WD(G,$r),WD(te,$r),O||(!V&&!A&&(G[0]=lt(G[0],D),te[0]=lt(te[0],D)),!I&&!k&&(G[1]=lt(G[1],D),te[1]=lt(te[1],D)));var $=Ye(te,S),Z=Ye(G,S),ee=Ye(Z,_),le=Ye($,w);t.prevDist=Z,t.prevBeforeDist=$,t.passDelta=ee,t.passDist=Z;var he=t.left+$[0],se=t.top+$[1],Se=t.right-$[0],Me=t.bottom-$[1],Ge=sy(t,"translate(".concat(G[0],"px, ").concat(G[1],"px)"),"translate(".concat(Z[0],"px, ").concat(Z[1],"px)"));if(mS(e,Ge),n.state.dragInfo.dist=r?[0,0]:Z,!(!r&&!C&&ee.every(function(Fe){return!Fe})&&le.some(function(Fe){return!Fe}))){var Ee=n.state,ke=Ee.width,ut=Ee.height,Le=pt(n,e,Q({transform:Ge,dist:Z,delta:ee,translate:G,beforeDist:$,beforeDelta:le,beforeTranslate:te,left:he,top:se,right:Se,bottom:Me,width:ke,height:ut,isPinch:a},qr({transform:Ge},e)));return!r&&Oe(n,"onDrag",Le),Le}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,Q(Q({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=xi(n,e,{});return!t&&Oe(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=s1(n,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=Q(Q({},c),{targets:n.props.targets,events:h}),m=Oe(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,Q(Q({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=s1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=Q({targets:n.props.targets,events:a},r);return Oe(n,"onDragGroup",o),o}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=s1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Oe(n,"onDragGroupEnd",xi(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-t.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-t.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function Dj(n,e){var t=or(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function GZ(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=wn(t,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function kj(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=oZ(e,i,a),u=wn(t,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var yk=IS("resizable"),H_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:yj("resizable"),dragControlCondition:yk,viewClassName:CS("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=qj(o,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||n.controlGesto,!i&&Uc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=ii(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function C(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Yi(n.state);function D(k){var z=Dj(u.startPositions,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function O(k){var z=kj(n.state,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function M(k){u.minSize=[Jt("".concat(k[0]),0)||0,Jt("".concat(k[1]),0)||0]}function V(k){var z=[k[0]||1/0,k[1]||1/0];(!Td(z[0])||isFinite(z[0]))&&(z[0]=Jt("".concat(z[0]),0)||1/0),(!Td(z[1])||isFinite(z[1]))&&(z[1]=Jt("".concat(z[1]),0)||1/0),u.maxSize=z}C(_/w),D(d||[-p[0],-p[1]]),u.setFixedDirection=D,u.setFixedPosition=O,u.setMin=M,u.setMax=V;var A=pt(n,e,{direction:p,startRatio:u.ratio,set:function(k){var z=ne(k,2),L=z[0],B=z[1];u.startWidth=L,u.startHeight=B},setMin:M,setMax:V,setRatio:C,setFixedDirection:D,setFixedPosition:O,setOrigin:function(k){u.transformOrigin=k},dragStart:Br.dragStart(n,new Cd().dragStart([0,0],e))}),I=h||Oe(n,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,I!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,S=r.startWidth,T=r.startHeight,C=r.prevWidth,D=r.prevHeight,O=r.minSize,M=r.maxSize,V=r.ratio,A=r.startOffsetWidth,I=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(b){var z=n.state.is3d,L=r.startOffsetMatrix,B=r.startTransformOrigin,P=z?4:3,J=fp(lv(e)),Y=Math.sqrt(J.length);P!==Y&&(J=ma(J,Y,P));var H=tg(L,J,B,P),W=Fc(H,A,I,P);r.startPositions=W,r.nextTargetMatrix=J,r.nextAllMatrix=H}var K=jc(n.props,"resizable"),de=K.resizeFormat,te=K.throttleResize,G=te===void 0?i?0:1:te,$=K.parentMoveable,Z=K.keepRatioFinally,ee=r.direction,le=ee,he=0,se=0;!ee[0]&&!ee[1]&&(le=[1,1]);var Se=V&&(o??K.keepRatio)||!1;function Me(){var rt=r.fixedDirection,bt=Wj(le,Se,r,e);he=bt.distWidth,se=bt.distHeight;var Ot=le[0]-rt[0]||Se?Math.max(A+he,$r):A,an=le[1]-rt[1]||Se?Math.max(I+se,$r):I;return Se&&A&&I&&(k?an=Ot/V:Ot=an*V),[Ot,an]}var Ge=ne(Me(),2),Ee=Ge[0],ke=Ge[1];m||(r.setFixedDirection(r.fixedDirection),Oe(n,"onBeforeResize",pt(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(rt){var bt;return r.setFixedDirection(rt),bt=ne(Me(),2),Ee=bt[0],ke=bt[1],[Ee,ke]},setFixedPosition:function(rt){var bt;return r.setFixedPosition(rt),bt=ne(Me(),2),Ee=bt[0],ke=bt[1],[Ee,ke]},boundingWidth:Ee,boundingHeight:ke,setSize:function(rt){var bt;bt=ne(rt,2),Ee=bt[0],ke=bt[1]}},!0)));var ut=c;c||(!i&&a?ut=dZ(n,[0,0]):ut=r.fixedPosition);var Le=[0,0];a||(Le=aJ(n,Ee,ke,ee,ut,!d&&h,r)),u&&(!u[0]&&(Le[0]=0),!u[1]&&(Le[1]=0));function Fe(){var rt;de&&(rt=ne(de([Ee,ke]),2),Ee=rt[0],ke=rt[1]),Ee=lt(Ee,G),ke=lt(ke,G)}if(Se){le[0]&&le[1]&&Le[0]&&Le[1]&&(xe(Le[0])>xe(Le[1])?Le[1]=0:Le[0]=0);var we=!Le[0]&&!Le[1];we&&Fe(),le[0]&&!le[1]||Le[0]&&!Le[1]||we&&k?(Ee+=Le[0],ke=Ee/V):(!le[0]&&le[1]||!Le[0]&&Le[1]||we&&!k)&&(ke+=Le[1],Ee=ke*V)}else Ee+=Le[0],ke+=Le[1],Ee=Math.max(0,Ee),ke=Math.max(0,ke);t=ne(w3([Ee,ke],O,M,Se?V:!1),2),Ee=t[0],ke=t[1],Fe(),Se&&(p||Z)&&(k?ke=Ee/V:Ee=ke*V),he=Ee-A,se=ke-I;var ze=[he-C,se-D];r.prevWidth=he,r.prevHeight=se;var st=uZ(n,Ee,ke,ut,w,r);if(!(!$&&ze.every(function(rt){return!rt})&&st.every(function(rt){return!rt}))){var Ne=Br.drag(n,eg(e,n.state,st,!!a,!1,"draggable")),Pe=Ne.transform,nt=S+he,Qe=T+se,Ft=pt(n,e,Q({width:nt,height:Qe,offsetWidth:Math.round(Ee),offsetHeight:Math.round(ke),startRatio:V,boundingWidth:Ee,boundingHeight:ke,direction:ee,dist:[he,se],delta:ze,isPinch:!!a,drag:Ne},$j({style:{width:"".concat(nt,"px"),height:"".concat(Qe,"px")},transform:Pe},Ne,e)));return!m&&Oe(n,"onResize",Ft),Ft}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,o=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=xe(p)>3,_=xe(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=xi(n,e,{});return!r&&Oe(n,"onResizeEnd",i),i}},dragGroupControlCondition:yk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,Q(Q({},e),{isGroup:!0}));if(!r)return!1;var i=da(n,"resizable",e),a=t.startOffsetWidth,o=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,S=w.minSize,T=w.startOffsetWidth,C=w.startOffsetHeight,D=a*(T?S[0]/T:0),O=o*(C?S[1]/C:0);b[0]=Math.max(b[0],D),b[1]=Math.max(b[1],O)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,S=w.maxSize,T=w.startOffsetWidth,C=w.startOffsetHeight,D=a*(T?S[0]/T:0),O=o*(C?S[1]/C:0);b[0]=Math.min(b[0],D),b[1]=Math.min(b[1],O)})}var d=js(n,this,"dragControlStart",e,function(b,_){return cv(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),cv(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=Q(Q({},r),{targets:n.props.targets,events:d.map(function(b){return Q(Q({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=Oe(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=jc(n.props,"resizable");hy(n,"onBeforeResize",function(b){Oe(n,"onBeforeResizeGroup",pt(n,e,Q(Q({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,Q(Q({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=t.fixedPosition,p=js(n,this,"dragControl",e,function(b,_){var w=ne(Mr(Qp(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),S=w[0],T=w[1];return Q(Q({},_),{parentDist:null,parentScale:d,dragClient:Nt(h,[S,T]),parentKeepRatio:u})}),m=Q({targets:r.targets,events:p},i);return Oe(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=js(n,this,"dragControlEnd",e),a=xi(n,e,{targets:n.props.targets,events:i});return Oe(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function o1(n,e,t,r,i){var a=n.props.groupable,o=n.state,c=o.is3d?4:3,u=e.origin,d=wn(n.state.rootMatrix,Ye([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=Nt([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=Ln(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Os(h,[t,r])}function _0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++o:a<n&&a<90&&n>270&&--o;var c=e*(o*360+n-r);return t.prevDeg=r+c,c}function l1(n,e,t,r){return _0(Ln(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function c1(n,e,t,r,i,a){var o=n.props.throttleRotate,c=o===void 0?0:o,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=iJ(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=lt(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function Nj(n,e,t){var r=ne(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(n==="none")return[];if(tr(n))return n.map(function(S){return Nj(S,[i,a,o,c],t)[0]});var u=ne((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=Fj(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function $_(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(sr(t,qe("rotation-control"))||n.props.rotateAroundControls&&sr(t,qe("around-control"))||sr(t,qe("control"))&&sr(t,qe("rotatable")))return!0;var r=n.props.rotationTarget;return r?RS(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var qZ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,HZ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[qZ],viewClassName:function(n){return n.isDragging("rotatable")?qe("view-rotation-dragging"):""},render:function(n,e){var t=jc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,o=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=Nj(i,h,p),b=[];if(m.forEach(function(T,C){var D=ne(T,2),O=D[0],M=D[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:qe("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(M,"rad)")}},e.createElement("div",{className:qe("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:qe("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=$s(u||{}),w={};_.forEach(function(T){u[T].forEach(function(C){w[C]=T})});var S=[];tr(o)&&(S=o.map(function(T){var C=w[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ae([],ne(gj(n,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ae([],ne(xj(n,e)),!1)),b},dragControlCondition:$_,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,S=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,D=p.offsetMatrix,O=p.targetMatrix,M=p.allMatrix,V=p.width,A=p.height;if(!h&&!m)return!1;var I=n.getRect();i.rect=I,i.transform=T,i.left=b,i.top=_;var k=function(le){var he=kj(n.state,le);i.fixedDirection=he.fixedDirection,i.fixedOffset=he.fixedOffset,i.fixedPosition=he.fixedPosition,G&&G.setFixedPosition(le)},z=function(le){var he=GZ(n.state,le);i.fixedDirection=he.fixedDirection,i.fixedOffset=he.fixedOffset,i.fixedPosition=he.fixedPosition,G&&G.setFixedDirection(le)},L=a,B=o;if(h||d||u){var P=c||0;i.beforeInfo={origin:I.beforeOrigin,prevDeg:P,defaultDeg:P,prevSnapDeg:0,startDist:0},i.afterInfo=Q(Q({},i.beforeInfo),{origin:I.origin}),i.absoluteInfo=Q(Q({},i.beforeInfo),{origin:I.origin,startValue:P})}else{var J=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(J){var Y=J.getAttribute("data-direction")||"",H=QQ[Y];if(H){i.isControl=!0,i.isAroundControl=sr(J,qe("around-control")),i.controlDirection=H;var W=J.getAttribute("data-resolve");W&&(i.resolveAble=W);var K=xJ(p.rootMatrix,p.renderPoses,C);t=ne(or(K,H),2),L=t[0],B=t[1]}}i.beforeInfo={origin:I.beforeOrigin},i.afterInfo={origin:I.origin},i.absoluteInfo={origin:I.origin,startValue:I.rotation};var de=k;k=function(le){var he=p.is3d?4:3,se=ne(Nt(K3(O,he),le),2),Se=se[0],Me=se[1],Ge=Mr(D,Mc([Se,Me],he)),Ee=Mr(M,Mc([le[0],le[1]],he));de(le);var ke=p.posDelta;i.beforeInfo.origin=Ye(Ge,ke),i.afterInfo.origin=Ye(Ee,ke),i.absoluteInfo.origin=Ye(Ee,ke),o1(n,i.beforeInfo,L,B,C),o1(n,i.afterInfo,L,B,C),o1(n,i.absoluteInfo,L,B,C)},z=function(le){var he=or([[0,0],[V,0],[0,A],[V,A]],le);k(he)}}i.startClientX=L,i.startClientY=B,i.direction=w,i.beforeDirection=S,i.startValue=0,i.datas={},ly(n,e,"rotate");var te=!1,G=!1;if(i.isControl&&i.resolveAble){var $=i.resolveAble;$==="resizable"&&(G=H_.dragControlStart(n,Q(Q({},new Cd("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}G||(te=Br.dragStart(n,new Cd().dragStart([0,0],e))),k(_J(n));var Z=pt(n,e,Q(Q({set:function(le){i.startValue=le*Math.PI/180},setFixedDirection:z,setFixedPosition:k},oy(n,e)),{dragStart:te,resizeStart:G})),ee=Oe(n,"onRotateStart",Z);return i.isRotate=ee!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?Z:!1},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,C=a.startValue,D=a.rect,O=a.startClientX,M=a.startClientY;if(T){ay(n,e,"rotate");var V=ZQ(e),A=b*V,I=n.props.parentMoveable,k=0,z,L,B=0,P,J,Y=0,H,W,K=180/Math.PI*C,de=S.startValue,te=!1,G=O+o,$=M+c;if(!d&&"parentDist"in e){var Z=e.parentDist;z=Z,P=Z,H=Z}else h||d?(z=_0(u,b,_),P=_0(u,A,w),H=_0(u,A,S)):(z=l1(G,$,b,_),P=l1(G,$,A,w),H=l1(G,$,A,S),te=!0);if(L=K+z,J=K+P,W=de+H,Oe(n,"onBeforeRotate",pt(n,e,{beforeRotation:L,rotation:J,absoluteRotation:W,setRotation:function(ut){P=ut-K,z=P,H=P}},!0)),t=ne(c1(n,D,_,z,K,te),3),k=t[0],z=t[1],L=t[2],r=ne(c1(n,D,w,P,K,te),3),B=r[0],P=r[1],J=r[2],i=ne(c1(n,D,S,H,de,te),3),Y=i[0],H=i[1],W=i[2],!(!Y&&!B&&!k&&!I&&!m)){var ee=sy(a,"rotate(".concat(J,"deg)"),"rotate(".concat(P,"deg)"));m&&(a.fixedPosition=vS(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var le=cZ(n,P,a),he=Ye(Nt(p||[0,0],le),a.prevInverseDist||[0,0]);a.prevInverseDist=le,a.requestValue=null;var se=fj(n,ee,he,h,e),Se=se,Me=Os([G,$],S.startAbsoluteOrigin)-S.startDist,Ge=void 0;if(a.resolveAble==="resizable"){var Ee=H_.dragControl(n,Q(Q({},eg(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:Me}));Ee&&(Ge=Ee,Se=$j(Se,Ee,e))}var ke=pt(n,e,Q(Q({delta:B,dist:P,rotate:J,rotation:J,beforeDist:z,beforeDelta:k,beforeRotate:L,beforeRotation:L,absoluteDist:H,absoluteDelta:Y,absoluteRotate:W,absoluteRotation:W,isPinch:!!h,resize:Ge},se),Se));return Oe(n,"onRotate",ke),ke}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=xi(n,e,{});return Oe(n,"onRotateEnd",r),r}},dragGroupControlCondition:$_,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=js(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,S=b.beforeOrigin,T=Nt(Ye([_,w],[i,a]),Ye(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,Q(Q({},m),{parentRotate:0})}),d=Q(Q({},c),{targets:n.props.targets,events:u}),h=Oe(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){hy(n,"onBeforeRotate",function(d){Oe(n,"onBeforeRotateGroup",pt(n,e,Q(Q({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=js(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=ne(h.datas.groupClient,2),b=m[0],_=m[1],w=ne(Wp(p,o*i),2),S=w[0],T=w[1],C=[S-b,T-_];return h.datas.groupClient=[S,T],Q(Q({},h),{parentRotate:a,groupDelta:C})});n.rotation=i*r.beforeRotation;var u=Q({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return Oe(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=js(n,this,"dragControlEnd",e),a=xi(n,e,{targets:n.props.targets,events:i});return Oe(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function $Z(n,e){var t,r=n.direction,i=n.classNames,a=n.size,o=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function ES(n,e){return $Z(Q(Q({},n),{classNames:Ae([qe("line","guideline",n.direction)],ne(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(lt(t,.1),"px")})}),e)}function bk(n,e,t,r,i,a,o,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,ES({key:"".concat(e,"TargetGuideline").concat(h),classNames:[qe("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function xk(n,e,t,r,i,a){var o=n.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?dl:fl,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,S=m.element,T=m.className,C=[-r[0]+_[0],-r[1]+_[1]];return ES({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[qe("bold"),T]:[qe("normal"),T],direction:e,posValue:C,sizeValue:w,zoom:c},a)})}function hh(n,e,t,r,i,a,o,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(M,V){return M}:_,S=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",D=Math.abs(i),O=b?parseFloat(D.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:qe("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(D,"px"),u)},ES({direction:e,classNames:[qe(t),o],size:"100%",posValue:[0,0],sizeValue:D,zoom:S},c),c.createElement("div",{className:qe("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},O>0?w(O,e):""))}function YZ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,o=i?dl:fl,c=t[o.start],u=t[o.end];return Yj(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var C=b.pos,D={element:S,rect:Q(Q({},T),(_={},_[o.end]=T[o.start],_))},O={element:S,rect:Q(Q({},T),(w={},w[o.start]=T[o.end],w))},M=[0,0],V=[0,0];M[i]=C[i],M[a]=C[a],V[i]=C[i],V[a]=C[a]+b.size,h.push({type:n,pos:M,size:0,elementRect:D,direction:"",elementDirection:"end"}),p.push({type:n,pos:V,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function KZ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=YZ(c,u,r,a),m=d?fl:dl,b=d?dl:fl,_=r[m.start],w=r[m.end];p.forEach(function(S){var T=S.total,C=S.start,D=S.end,O=S.inner,M=t[h]+T[0].pos[h]-r[b.start],V=r;C.forEach(function(A){var I=A.elementRect.rect,k=V[m.start]-I[m.end];if(k>0){var z=[0,0];z[d]=t[d]+V[m.start]-_-k,z[h]=M,o.push(hh(n,c,"dashed",o.length,k,z,A.className,i))}V=I}),V=r,D.forEach(function(A){var I=A.elementRect.rect,k=I[m.start]-V[m.end];if(k>0){var z=[0,0];z[d]=t[d]+V[m.end]-_,z[h]=M,o.push(hh(n,c,"dashed",o.length,k,z,A.className,i))}V=I}),O.forEach(function(A){var I=A.elementRect.rect,k=_-I[m.start],z=I[m.end]-w,L=[0,0],B=[0,0];L[d]=t[d]-k,L[h]=M,B[d]=t[d]+w-_,B[h]=M,o.push(hh(n,c,"dashed",o.length,k,L,A.className,i)),o.push(hh(n,c,"dashed",o.length,z,B,A.className,i))})})}),o}function XZ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?fl:dl,p=u?dl:fl,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(S){var T=S.gap,C=S.gapRects,D=Math.max.apply(Math,Ae([_],ne(C.map(function(V){var A=V.rect;return A[p.start]})),!1)),O=Math.min.apply(Math,Ae([w],ne(C.map(function(V){var A=V.rect;return A[p.end]})),!1)),M=(D+O)/2;D===O||M===(_+w)/2||C.forEach(function(V){var A=V.rect,I=V.className,k=[t[0],t[1]];if(A[h.end]<m)k[u]+=A[h.end]-m;else if(b<A[h.start])k[u]+=A[h.start]-m-T;else return;k[d]+=M-_,a.push(hh(n,u?"vertical":"horizontal","gap",a.length,T,k,I,i))})})}),a}function Y_(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,S=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,D=C===void 0?5:C,O=b.maxSnapElementGuidelineDistance,M=O===void 0?1/0:O,V=b.isDisplayGridGuidelines,A=qi(Yi(n.state)),I=A.top,k=A.left,z=A.bottom,L=A.right,B={top:I,left:k,bottom:z,right:L,center:(k+L)/2,middle:(I+z)/2},P=JZ(n),J=Ae([],ne(P),!1),Y=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(de){return de*D});w&&J.push.apply(J,Ae([],ne(WZ(n,B,Y)),!1));var H=Q({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(J.push.apply(J,Ae([],ne(ZZ(n,o?u:h,o?c:d,p,m,H,V)),!1)),a){var W=i.left,K=i.top;H.left+=W,H.top+=K,H.right+=W,H.bottom+=K}return J.push.apply(J,Ae([],ne(Pj(T||!1,S||!1,o?u:h,o?c:d,p,m,H)),!1)),J=J.filter(function(de){var te=de.element,G=de.elementRect,$=de.type;if(!te||!G)return!0;var Z=G.rect;return Mj(B,Z,$,M)}),J}function WZ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=n.state.elementRects,d=[];return[["vertical",dl,fl],["horizontal",fl,dl]].forEach(function(h){var p=ne(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],S=e[b.end],T=e[b.center],C=e[_.start],D=e[_.end],O={left:t[0],top:t[1]};function M(I){var k=I.rect,z=O[b.start];return k[b.end]<w+z?w-k[b.end]:S-z<k[b.start]?k[b.start]-S:-1}var V=u.filter(function(I){var k=I.rect;return k[_.start]>D||k[_.end]<C?!1:M(I)>0}).sort(function(I,k){return M(I)-M(k)}),A=[];V.forEach(function(I){V.forEach(function(k){if(I!==k){var z=I.rect,L=k.rect,B=z[_.start],P=z[_.end],J=L[_.start],Y=L[_.end];B>Y||J>P||A.push([I,k])}})}),A.forEach(function(I){var k=ne(I,2),z=k[0],L=k[1],B=z.rect,P=L.rect,J=B[b.start],Y=B[b.end],H=P[b.start],W=P[b.end],K=O[b.start],de=0,te=0,G=!1,$=!1,Z=!1;if(Y<=w&&S<=H){if($=!0,de=(H-Y-(S-w))/2,te=Y+de+(S-w)/2,xe(te-T)>K)return}else if(Y<H&&W<w+K){if(G=!0,de=H-Y,te=W+de,xe(te-w)>K)return}else if(Y<H&&S-K<J){if(Z=!0,de=H-Y,te=J-de,xe(te-S)>K)return}else return;de&&Mj(e,P,m,a)&&(de>c||d.push({type:m,pos:m==="vertical"?[te,0]:[0,te],element:L.element,size:0,className:L.className,isStart:G,isCenter:$,isEnd:Z,gap:de,hide:!0,gapRects:[z,L],direction:"",elementDirection:""}))})}),d}function QZ(n,e,t,r){var i,a,o=n.props,c=n.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=n.getRect(),T=S.children,C=b.direction;if(T){var D=C.map(function(M,V){var A=V===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},I=A.snapSize,k=A.posName,z=A.sizeName,L=A.clientOffset;if(!I)return{dir:M,multiple:1,snapSize:I,snapOffset:0};var B=S[z],P=S[k],J=E3(T.map(function(G){return[G[k]-P,G[z],B-G[z]-G[k]+P]})).filter(function(G){return G}).sort(function(G,$){return G-$}),Y=J[0],H=J.map(function(G){return lt(G/Y,.1)*I}),W=1,K=lt(B/Y,.1);for(W=1;W<=10&&!H.every(function(G){return G*W%1===0});++W);var de=(-M+1)/2,te=iv(P-L,P-L+B,de,1-de);return{multiple:K*W,dir:M,snapSize:I,snapOffset:Math.round(te/I)}}),O=D.map(function(M){return M.multiple||1});c.snapThresholdInfo.multiples=O,c.snapThresholdInfo.offset=D.map(function(M){return M.snapOffset}),D.forEach(function(M,V){M.snapSize})}}else c.snapThresholdInfo=null}function ZZ(n,e,t,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,S=[0,0];QZ(n,r,i,a);var T=u.snapThresholdInfo,C=h,D=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var O=function(V){b.push({type:"horizontal",pos:[_,lt(S[1]*D+V-i+w,.1)],className:qe("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},M=0;M<=t*2;M+=m)O(M);for(var M=-m;M>=-t;M-=m)O(M)}if(h){for(var O=function(A){b.push({type:"vertical",pos:[lt(S[0]*C+A-r+_,.1),w],className:qe("grid-guideline"),size:t,hide:!o,direction:"",grid:!0})},M=0;M<=e*2;M+=h)O(M);for(var M=-h;M>=-e;M-=h)O(M)}return b}function Mj(n,e,t,r){return t==="horizontal"?xe(n.right-e.left)<=r||xe(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?xe(n.bottom-e.top)<=r||xe(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function JZ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return ga(m)&&"element"in m?Q(Q({},m),{element:ts(m.element,!0)}):{element:ts(m,!0)}}).filter(function(m){return m.element}),o=dQ(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=ne(m,2),_=b[0],w=b[1];d[w]=i[_]}),eJ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=bS(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,S=m.left,T=S===void 0?h.left:S,C=m.right,D=C===void 0?h.right:C,O=m.bottom,M=O===void 0?h.bottom:O,V=m.center,A=V===void 0?h.center:V,I=m.middle,k=I===void 0?h.middle:I,z=m.className,L=m.rect,B=xS({top:w,right:D,left:T,bottom:M,center:A,middle:k},L),P=B.horizontal,J=B.vertical,Y=B.horizontalNames,H=B.verticalNames,W=L.top,K=L.left,de=L.right-K,te=L.bottom-W,G=[de,te];J.forEach(function($,Z){p.push({type:"vertical",element:b,pos:[lt($,.1),W],size:te,sizes:G,className:z,elementRect:m,elementDirection:dk[H[Z]]||H[Z],direction:""})}),P.forEach(function($,Z){p.push({type:"horizontal",element:b,pos:[K,lt($,.1)],size:de,sizes:G,className:z,elementRect:m,elementDirection:dk[Y[Z]]||Y[Z],direction:""})})}),p}function _k(n,e){return n?n.map(function(t){var r=ga(t)?t:{pos:t},i=r.pos;return Td(i)?r:Q(Q({},r),{pos:Jt(i,e)})}):[]}function Pj(n,e,t,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=t+p-u,b=r+h-d;return _k(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,lt(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),_k(e,m).forEach(function(_){c.push({type:"vertical",pos:[lt(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function eJ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=ne(SZ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),S=w.left-h-m,T=w.top-p-b,C=T+w.height,D=S+w.width,O=ne(Dd(a,[S,T],u),2),M=O[0],V=O[1],A=ne(Dd(a,[D,C],u),2),I=A[0],k=A[1];return Q(Q({},_),{rect:{left:M,right:I,top:V,bottom:k,center:(M+I)/2,middle:(V+k)/2}})})}function $m(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var o=ts(r,!0);if(o){var c=jh(o),u=Ck(e,[c.left-i.left,c.top-i.top]),d=Ck(e,[c.right-i.right,c.bottom-i.bottom]);a.left=lt(u[0],1e-5),a.top=lt(u[1],1e-5),a.right=lt(d[0],1e-5),a.bottom=lt(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=Y_(n),e.enableSnap=!0,!0}function Oj(n,e,t,r,i,a){var o=Fc(n,e,t,a?4:3),c=or(o,r);return TS(o,Ye(i,c))}function wk(n){return n?n/xe(n):0}function tJ(n,e,t,r,i,a){var o=a.fixedDirection,c=IZ(t,o,r),u=wS(n,e,t,r),d=Ae(Ae([],ne(BZ(n,e,c,r,i,a)),!1),ne(Rj(n,u,a)),!1),h=uv(d,0),p=uv(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function nJ(n,e,t,r,i,a,o,c,u){var d=or(e,o),h=dy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(lt(m,B_)||lt(p,B_)){var b=ne(os({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],S=Math.min(i||1/0,t+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[S-t,T-r]}return[0,0]}function jj(n,e,t,r,i,a,o,c){for(var u=Yi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=tJ(n,b,i,d,o,c),w=_.width,S=_.height,T=w.isBound,C=S.isBound,D=w.offset,O=S.offset;if(m===1&&(T||(D=0),C||(O=0)),m===0&&o&&!T&&!C)return[0,0];if(d){var M=xe(D)*(t?1/t:1),V=xe(O)*(r?1/r:1),A=T&&C?M<V:C||!T&&M<V;A?D=t*O/r:O=r*D/t}h+=D,p+=O}if(!d&&i[0]&&i[1]){var I=FZ(n,u,i,a,c),k=I.maxWidth,z=I.maxHeight,L=ne(nJ(n,e(h,p).map(function(J){return J.map(function(Y){return lt(Y,B_)})}),t+h,r+p,k,z,i,o,c),2),D=L[0],O=L[1];h+=D,p+=O}return[h,p]}function Ph(n){return n<0&&(n=n%360+360),n%=360,n}function rJ(n,e){e=Ph(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return xe(n-r)<xe(n-i)?r:i}function u1(n,e){n=Ph(n),e=Ph(e);var t=Ph(n-e);return Math.min(t,360-t)}function iJ(n,e,t,r){var i,a=n.props,o=(i=a[_j])!==null&&i!==void 0?i:5,c=a[wj];if(Xd(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(O){return Ye(O,m)}),w=_.map(function(O){return Wp(O,b)}),S=Ae(Ae([],ne(xZ(n,_,w,m,t)),!1),ne(PZ(n,_,w,m,t)),!1);S.sort(function(O,M){return xe(O-t)-xe(M-t)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:t}}if(c?.length&&o){var C=c.slice().sort(function(O,M){return u1(O,r)-u1(M,r)}),D=C[0];if(u1(D,r)<=o)return{isSnap:!0,dist:t+rJ(r,D)-r}}return{isSnap:!1,dist:t}}function aJ(n,e,t,r,i,a,o){if(!Xd(n,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return jj(n,function(m,b){return Oj(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,o)}function sJ(n,e,t,r,i){if(!Xd(n,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=jj(n,function(p,m){return Oj(aZ(i,Nt(e,[p/a,m/o])),a,o,u,c,d)},a,o,t,c,r,i);return[h[0]/a,h[1]/o]}function oJ(n,e){e.absolutePoses=Yi(n.state)}function Ek(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;ai(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return Q(Q({},r),{direction:i.direction})})}function Sk(n,e,t,r,i,a){var o=yS(cy(n,a),e,t),c=o.vertical,u=o.horizontal,d=Wu();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=OZ(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){Hs(r,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){Hs(i,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var lJ=IS("",["resizable","scalable"]),cJ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",_j,wj,Ej,Sj,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,o=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!Xd(n,""))return Zu(n,"boundMap",Wu(),function(ee){return JSON.stringify(ee)}),Zu(n,"innerBoundMap",Wu(),function(ee){return JSON.stringify(ee)}),[];t.guidelines=Y_(n);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Yi(n.state),S=[],T=[],C=[],D=[],O=[],M=qi(w),V=M.width,A=M.height,I=M.top,k=M.left,z=M.bottom,L=M.right,B={left:k,right:L,top:I,bottom:z,center:(k+L)/2,middle:(I+z)/2},P=_.length>0,J=P?qi(_):{};if(!d.request){if(d.direction&&O.push(CZ(n,w,d.direction,p,p)),d.snap){var Y=qi(w);d.center&&(Y.middle=(Y.top+Y.bottom)/2,Y.center=(Y.left+Y.right)/2),O.push(fk(n,Y,p,p))}P&&(d.center&&(J.middle=(J.top+J.bottom)/2,J.center=(J.left+J.right)/2),O.push(fk(n,J,p,p))),O.forEach(function(ee){var le=ee.vertical.posInfos,he=ee.horizontal.posInfos;S.push.apply(S,Ae([],ne(le.filter(function(se){var Se=se.guidelineInfos;return Se.some(function(Me){var Ge=Me.guideline;return!Ge.hide})}).map(function(se){return{type:"snap",pos:se.pos}})),!1)),T.push.apply(T,Ae([],ne(he.filter(function(se){var Se=se.guidelineInfos;return Se.some(function(Me){var Ge=Me.guideline;return!Ge.hide})}).map(function(se){return{type:"snap",pos:se.pos}})),!1)),C.push.apply(C,Ae([],ne(Ek(le)),!1)),D.push.apply(D,Ae([],ne(Ek(he)),!1))})}var H=Sk(n,[k,L],[I,z],S,T),W=H.boundMap,K=H.innerBoundMap;P&&Sk(n,[J.left,J.right],[J.top,J.bottom],S,T,d.externalBounds);var de=Ae(Ae([],ne(C),!1),ne(D),!1),te=de.filter(function(ee){return ee.element&&!ee.gapRects}),G=de.filter(function(ee){return ee.gapRects}).sort(function(ee,le){return ee.gap-le.gap});Oe(n,"onSnap",{guidelines:de.filter(function(ee){var le=ee.element;return!le}),elements:te,gaps:G},!0);var $=Zu(n,"boundMap",W,function(ee){return JSON.stringify(ee)},Wu()),Z=Zu(n,"innerBoundMap",K,function(ee){return JSON.stringify(ee)},Wu());return(W===$||K===Z)&&Oe(n,"onBound",{bounds:W,innerBounds:K},!0),Ae(Ae(Ae(Ae(Ae(Ae([],ne(KZ(n,te,[m,b],B,e)),!1),ne(XZ(n,G,[m,b],B,e)),!1),ne(xk(n,"horizontal",D,[i,r],B,e)),!1),ne(xk(n,"vertical",C,[i,r],B,e)),!1),ne(bk(n,"horizontal",T,m,r,V,0,e)),!1),ne(bk(n,"vertical",S,b,i,A,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},$m(n)},drag:function(n){var e=n.state;$m(n)||(e.guidelines=Y_(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(lJ(n,e)||$_(n,e))return!0;if(!e.isRequest&&e.inputEvent)return sr(e.inputEvent.target,qe("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,$m(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,$m(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function uJ(n,e){return[n[0]*e[0],n[1]*e[1]]}function qe(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return aW.apply(void 0,Ae([pS],ne(n),!1))}function Vj(n){n()}function dJ(n){return!n||n==="none"?[1,0,0,1,0,0]:ga(n)?n:fp(n)}function Oh(n,e,t){return sv(e,Pc(t,e),n,Pc(t.map(function(r){return-r}),e))}function fJ(n,e,t){if(e==="%"){var r=SS(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function hJ(n){var e=pJ(AS(n,":before"));return e.map(function(t,r){var i=$p(t),a=i.value,o=i.unit;return a*fJ(n,o,r===0)})}function fv(n){return n?n.split(" "):["0","0"]}function pJ(n){return fv(n.transformOrigin)}function zj(n){var e=si(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function pp(n,e,t,r,i){var a,o,c=rS(n)||bl(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",S=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(_=!0);var D=si(d),O=d.tagName.toLowerCase(),M=zj(d),V=D("willChange"),A=parseFloat(D("zoom"))||1;if(w=D("position"),r&&A!==1){S=A;break}if(!t&&r&&T!==1&&C&&C!=="absolute"||O==="svg"||O==="foreignobject"||w!=="static"||M&&M!=="none"||V==="transform")break;var I=(o=n?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;I&&(u=!0,h=k);var z=k;if(z&&z.nodeType===11){d=z.host,b=!0,w=si(d)("position");break}d=z,w="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function gJ(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,o=si(n),c=ty(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=rj?hJ(n):fv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=ne(yJ(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=fv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function Lj(n,e){var t=si(n),r=si(bl(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,o]}function K_(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=ma(t,3,4))})}function mJ(n){for(var e=n.parentElement,t=!1,r=bl(n);e;){var i=AS(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function fy(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat(X3(n,!e).join(","),")")}function SS(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function vJ(n,e){var t,r=SS(n),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);_[0]=C,_[1]=C,w[0]=(o-i)/2*S,w[1]=(c-a)/2*T}var D=uS(_,e);return t=ne(w,2),D[e*(e-1)]=t[0],D[e*(e-1)+1]=t[1],Oh(D,e,b)}function yJ(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=si(n),a=i("transform-box")==="fill-box",o=n.getBBox(),c=SS(n.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function wn(n,e,t){return Mr(n,Mc(e,t),t)}function Fc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return wn(n,i,r)})}function qi(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ae([],ne(e),!1)),i=Math.min.apply(Math,Ae([],ne(t),!1)),a=Math.max.apply(Math,Ae([],ne(e),!1)),o=Math.max.apply(Math,Ae([],ne(t),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function Tk(n,e,t,r){var i=Fc(n,e,t,r);return qi(i)}function bJ(n,e,t,r,i){var a,o=n.target,c=n.origin,u=e.matrix,d=Uj(o),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===bl(t)&&(b=Lj(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],S=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,C=_.height,D=sv(r,i,u),O=Tk(D,h,p,r),M=O.left,V=O.top,A=O.width,I=O.height,k=wn(D,c,r),z=Ye(k,[M,V]),L=[w+z[0]*T/A,S+z[1]*C/I],B=[0,0],P=0;++P<10;){var J=rs(i,r);a=ne(Ye(wn(J,L,r),wn(J,k,r)),2),B[0]=a[0],B[1]=a[1];var Y=sv(r,i,Pc(B,r),u),H=Tk(Y,h,p,r),W=H.left,K=H.top,de=W-w,te=K-S;if(xe(de)<2&&xe(te)<2)break;L[0]-=de,L[1]-=te}return B.map(function(G){return Math.round(G)})}function xJ(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return wn(n,u,i)}),o=t.left,c=t.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function $i(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Bj(n,e){return $i([e[0]-n[0],e[1]-n[1]])}function ph(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=Ln(n,e));var i=Bj(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function hv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,o=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function jc(n,e){var t=n[e];return ga(t)?Q(Q({},n),t):n}function Uj(n){var e=n&&!ty(n.offsetWidth),t=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,S=1/0,T=1/0,C=0,D=0,O=!1;if(n)if(!e&&n.ownerSVGElement){var M=n.getBBox();O=!0,t=M.width,r=M.height,o=t,c=r,u=t,d=r,i=t,a=r}else{var V=si(n),A=n.style,I=V("boxSizing")==="border-box",k=parseFloat(V("borderLeftWidth"))||0,z=parseFloat(V("borderRightWidth"))||0,L=parseFloat(V("borderTopWidth"))||0,B=parseFloat(V("borderBottomWidth"))||0,P=parseFloat(V("paddingLeft"))||0,J=parseFloat(V("paddingRight"))||0,Y=parseFloat(V("paddingTop"))||0,H=parseFloat(V("paddingBottom"))||0,W=P+J,K=Y+H,de=k+z,te=L+B,G=W+de,$=K+te,Z=V("position"),ee=0,le=0;if("clientLeft"in n){var he=null;if(Z==="absolute"){var se=pp(n,bl(n));he=se.offsetParent}else he=n.parentElement;if(he){var Se=si(he);ee=parseFloat(Se("width")),le=parseFloat(Se("height"))}}h=Math.max(W,Jt(V("minWidth"),ee)||0),p=Math.max(K,Jt(V("minHeight"),le)||0),_=Jt(V("maxWidth"),ee),w=Jt(V("maxHeight"),le),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),C=Jt(A.width,0)||0,D=Jt(A.height,0)||0,o=parseFloat(V("width"))||0,c=parseFloat(V("height"))||0,u=xe(o-C)<1?C_(h,C||o,_):o,d=xe(c-D)<1?C_(p,D||c,w):c,t=u,r=d,i=u,a=d,I?(S=_,T=w,m=h,b=p,u=t-G,d=r-$):(S=_+G,T=w+$,m=h+G,b=p+$,t=u+G,r=d+$),i=u+W,a=d+K}return{svg:O,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:D,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function Fj(n,e){return Ln(e>0?n[0]:n[1],e>0?n[1]:n[0])}function Ym(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function Gj(n,e){var t=n===bl(n)||n===rS(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=si(n)("overflow")!=="visible",Q(Q({},e),r)}function d1(n,e,t,r){var i=n.left,a=n.right,o=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return t&&r?Gj(t,h):h}function jh(n,e){var t=0,r=0,i=0,a=0;if(n){var o=n.getBoundingClientRect();t=o.left,r=o.top,i=o.width,a=o.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?Gj(n,c):c}function _J(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?DS(r,a,o):u}function qj(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=Hj(a,r)}return i}function Hj(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function TS(n,e){return[Nt(e,n[0]),Nt(e,n[1]),Nt(e,n[2]),Nt(e,n[3])]}function Yi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,o=n.pos4;return TS([r,i,a,o],[e,t])}function X_(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Qu(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&X_(n,e),r?.unset(),n[t]=null}function qr(n,e){if(e){var t=Kd(e);t.nextStyle=Q(Q({},t.nextStyle),n)}return{style:n,cssText:$s(n).map(function(r){return"".concat(x0(r,"-"),": ").concat(n[r],";")}).join("")}}function $j(n,e,t){var r=e.afterTransform||e.transform;return Q(Q({},qr(Q(Q(Q({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function pt(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=Q(Q({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function xi(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),Q(Q({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function hy(n,e,t){n._emitter.on(e,t)}function Oe(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function AS(n,e){return nl(n).getComputedStyle(n,e)}function Km(n,e,t){var r={},i={};return n.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function W_(n,e){return n===e||n==null&&e==null}function Ak(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!ty(i))return i}return n[t]}function Yj(n,e){var t=[],r=[];return n.forEach(function(i,a){var o=e(i,a,n),c=r.indexOf(o),u=t[c]||[];c===-1&&(r.push(o),t.push(u)),u.push(i)}),t}function wJ(n,e){var t=[],r={};return n.forEach(function(i,a){var o=e(i,a,n),c=r[o];c||(c=[],r[o]=c,t.push(c)),c.push(i)}),t}function Kj(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Rd(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return xe(r)-xe(t)}),n[0]}function Dd(n,e,t){return Mr(rs(n,t),Mc(e,t),t)}function EJ(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=ne(Dd(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function Oi(n,e,t,r){if(!t[0]&&!t[1])return e;var i=wn(n,[wk(t[0]||1),0],r),a=wn(n,[0,wk(t[1]||1)],r),o=wn(n,[t[0]/$i(i),t[1]/$i(a)],r);return Nt(e,o)}function oa(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function pv(n){return xe(n)<=$r?0:n}function CS(n){return function(e){if(!e.isDragging(n))return"";var t=fZ(e,n),r=t.deg;return r?qe("view-control-rotation".concat(r)):""}}function IS(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return sr(i,qe("direction"))&&(!n||sr(i,qe(n)))}}function SJ(n,e,t){var r,i=Ad(n,{"x%":function(M){return M/100*e.offsetWidth},"y%":function(M){return M/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),o=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:Ad([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],S=Uu(h),T=Uu(p),C=Uu(b),D=Uu(_),O=en(S,C,4);return{transforms:n,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:Uu(w),afterFunctionMatrix:C,afterFunctionMatrix2:D,allFunctionMatrix:O,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function TJ(n){return!n||!ga(n)||$d(n)?!1:tr(n)||"length"in n}function ts(n,e){return n?$d(n)?n:ii(n)?e?document.querySelector(n):n:eS(n)?n():C3(n)?n:"current"in n?n.current:n:null}function RS(n,e){if(!n)return[];var t=TJ(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return ii(i)&&e?Ae(Ae([],ne(r),!1),ne([].slice.call(document.querySelectorAll(i))),!1):(tr(i)?r.push(RS(i,e)):r.push(ts(i,e)),r)},[])}function AJ(n,e,t){var r=Ln(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function Ck(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=rs(t,i);return r||(a=ma(a,3,4)),a[12]=0,a[13]=0,a[14]=0,cQ(a,e)}function Xj(n,e,t,r,i){var a=ne(n,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=Ln([0,0],e),p=Ln([0,0],r),m=$i(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*o,w=r[1]*c,S=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;xe(S-T)<Math.PI/2||xe(S-T)>Math.PI/2*3||(T+=Math.PI),C=S-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var D=$i([_+e[0],w+e[1]])*Math.cos(C);u=D*Math.sin(T)-_,d=D*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function Wj(n,e,t,r){var i,a=t.ratio,o=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,S=t.fixedDirection,T=[0,1].map(function(A){return xe(n[A]-S[A])}),C=[0,1].map(function(A){var I=T[A];return I!==0&&(I=2/I),I});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(Td(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(b){var D=o*T[0],O=c*T[1],M=$i([D,O]);u=b/M*D*C[0],d=b/M*O*C[1]}else{var V=os({datas:t,distX:h,distY:p});V=C.map(function(A,I){return V[I]*A}),i=ne(Xj([o,c],V,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function Q_(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=ne(n.split(" "),2),r=t[0],i=t[1],a=Q_(r||""),o=Q_(i||""),c=Q(Q({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function DS(n,e,t){var r=Q_(n,!0),i=r.x,a=r.y;return[Jt(i,e)||0,Jt(a,t)||0]}function CJ(n,e,t){var r=n.map(function(a){return Ye(a,e)}),i=r.map(function(a){return Wp(a,t)});return{prev:r,next:i,result:i.map(function(a){return Nt(a,e)})}}function Qj(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=tr(t),o=tr(i);return a&&o?Qj(t,i):!a&&!o?t===i:!1})}function Zu(n,e,t,r,i){var a=n._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=t,t;return o===t||r(o)===r(t)?o:(a[e]=t,t)}function Ur(n){return n>=0?1:-1}function xe(n){return Math.abs(n)}function f1(n,e){return wW(n).map(function(t){return e(t)})}function Zj(n){return Td(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var IJ=Jp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=n.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=pt(n,e,{});r&&(m.targets=r);var b=Oe(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var S=Q(Q({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,S)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=pt(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");Oe(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,Q(Q({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=xi(n,e,{isDrag:r});a&&(u.targets=a),Oe(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,Q(Q({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,Q(Q({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,Q(Q({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,Q(Q({},e),{targets:n.props.targets}))}}),Ik=IS("scalable"),RJ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:yj("scalable"),dragControlCondition:Ik,viewClassName:CS("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=qj(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Uc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];ly(n,e,"scale"),t.isWidth=w;function S(V){t.ratio=V&&isFinite(V)?V:0}t.startPositions=Yi(n.state);function T(V){var A=Dj(t.startPositions,V);t.fixedDirection=A.fixedDirection,t.fixedPosition=A.fixedPosition,t.fixedOffset=A.fixedOffset}t.setFixedDirection=T,S(Os(m,b)/Os(b,_)),T([-o[0],-o[1]]);var C=function(V){t.minScaleSize=V},D=function(V){t.maxScaleSize=V};C([-1/0,-1/0]),D([1/0,1/0]);var O=pt(n,e,Q(Q({direction:o,set:function(V){t.startValue=V},setRatio:S,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:D},oy(n,e)),{dragStart:Br.dragStart(n,new Cd().dragStart([0,0],e))})),M=Oe(n,"onScaleStart",O);return t.startFixedDirection=t.fixedDirection,M!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:o}),t.isScale?O:!1},dragControl:function(n,e){ay(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,S=t.isWidth,T=t.ratio;if(!_)return!1;var C=n.props,D=C.throttleScale,O=C.parentMoveable,M=p;!p[0]&&!p[1]&&(M=[1,1]);var V=T&&(r??C.keepRatio)||!1,A=n.state,I=[w[0],w[1]];function k(){var Ee=Wj(M,V,t,e),ke=Ee.distWidth,ut=Ee.distHeight,Le=m?(m+ke)/m:1,Fe=b?(b+ut)/b:1;w[0]||(I[0]=ke/m),w[1]||(I[1]=ut/b);var we=(M[0]||V?Le:1)*I[0],ze=(M[1]||V?Fe:1)*I[1];return we===0&&(we=Ur(h[0])*Gm),ze===0&&(ze=Ur(h[1])*Gm),[we,ze]}var z=k();if(!a&&n.props.groupable){var L=A.snapRenderInfo||{},B=L.direction;tr(B)&&(B[0]||B[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}Oe(n,"onBeforeScale",pt(n,e,{scale:z,setFixedDirection:function(Ee){return t.setFixedDirection(Ee),z=k(),z},startFixedDirection:t.startFixedDirection,setScale:function(Ee){z=Ee}},!0));var P=[z[0]/I[0],z[1]/I[1]],J=o,Y=[0,0],H=Ur(P[0]*P[1]),W=!o&&!i&&a;if(W||d?J=vS(n,t.targetAllTransform,[0,0],[0,0],t):o||(J=t.fixedPosition),a||(Y=sJ(n,P,p,!u&&c,t)),V){M[0]&&M[1]&&Y[0]&&Y[1]&&(Math.abs(Y[0]*m)>Math.abs(Y[1]*b)?Y[1]=0:Y[0]=0);var K=!Y[0]&&!Y[1];if(K&&(S?P[0]=lt(P[0]*I[0],D)/I[0]:P[1]=lt(P[1]*I[1],D)/I[1]),M[0]&&!M[1]||Y[0]&&!Y[1]||K&&S){P[0]+=Y[0];var de=m*P[0]*I[0]/T;P[1]=Ur(H*P[0])*xe(de/b/I[1])}else if(!M[0]&&M[1]||!Y[0]&&Y[1]||K&&!S){P[1]+=Y[1];var te=b*P[1]*I[1]*T;P[0]=Ur(H*P[1])*xe(te/m/I[0])}}else P[0]+=Y[0],P[1]+=Y[1],Y[0]||(P[0]=lt(P[0]*I[0],D)/I[0]),Y[1]||(P[1]=lt(P[1]*I[1],D)/I[1]);P[0]===0&&(P[0]=Ur(h[0])*Gm),P[1]===0&&(P[1]=Ur(h[1])*Gm),z=uJ(P,[I[0],I[1]]);var G=[m,b],$=[m*z[0],b*z[1]];$=w3($,t.minScaleSize,t.maxScaleSize,V?T:!1),z=f1(2,function(Ee){return G[Ee]?$[Ee]/G[Ee]:$[Ee]}),P=f1(2,function(Ee){return z[Ee]/I[Ee]});var Z=f1(2,function(Ee){return h[Ee]?P[Ee]/h[Ee]:P[Ee]}),ee="scale(".concat(P.join(", "),")"),le="scale(".concat(z.join(", "),")"),he=sy(t,le,ee),se=!w[0]||!w[1],Se=sZ(n,se?le:ee,t.fixedDirection,J,t.fixedOffset,t,se),Me=W?Se:Ye(Se,t.prevInverseDist||[0,0]);if(t.prevDist=P,t.prevInverseDist=Se,z[0]===h[0]&&z[1]===h[1]&&Me.every(function(Ee){return!Ee})&&!O&&!W)return!1;var Ge=pt(n,e,Q({offsetWidth:m,offsetHeight:b,direction:p,scale:z,dist:P,delta:Z,isPinch:!!a},fj(n,he,Me,a,e)));return Oe(n,"onScale",Ge),Ge},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=xi(n,e,{});return Oe(n,"onScaleEnd",r),r},dragGroupControlCondition:Ik,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=da(n,"resizable",e);t.moveableScale=n.scale;var a=js(n,this,"dragControlStart",e,function(d,h){return cv(n,d,t,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),cv(n,h.moveable,t,i[p])})};t.setFixedDirection=o;var c=Q(Q({},r),{targets:n.props.targets,events:a,setFixedDirection:o}),u=Oe(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){hy(n,"onBeforeScale",function(h){Oe(n,"onBeforeScaleGroup",pt(n,e,Q(Q({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var o=n.props.keepRatio,c=t.fixedPosition,u=js(n,this,"dragControl",e,function(h,p){var m=ne(Mr(Qp(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return Q(Q({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:Nt(c,[b,_])})}),d=Q({targets:n.props.targets,events:u},r);return Oe(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=js(n,this,"dragControlEnd",e),a=xi(n,e,{targets:n.props.targets,events:i});return Oe(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function Vo(n,e){return n.map(function(t,r){return iv(t,e[r],1,2)})}function Rk(n,e,t){var r=Ln(n,e),i=Ln(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function DJ(n,e){var t=Rk(n[0],n[1],n[2]),r=Rk(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var kJ={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:CS("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,o=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=Vo(u,d),b=Vo(d,u),_=Vo(u,h),w=Vo(h,u),S=Vo(h,p),T=Vo(p,h),C=Vo(d,p),D=Vo(p,d);return Ae([e.createElement("div",{className:qe("line"),key:"middeLine1",style:ph(m,S,o)}),e.createElement("div",{className:qe("line"),key:"middeLine2",style:ph(b,T,o)}),e.createElement("div",{className:qe("line"),key:"middeLine3",style:ph(_,C,o)}),e.createElement("div",{className:qe("line"),key:"middeLine4",style:ph(w,D,o)})],ne(bj(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return sr(t,qe("direction"))&&sr(t,qe("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,o=Hj(a,t);if(!o||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:ma(p,3,4),t.targetInverseMatrix=Y3(rs(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return Ye(C,u)}),t.nextPoses=t.poses.map(function(C){var D=ne(C,2),O=D[0],M=D[1];return Mr(t.warpTargetMatrix,[O,M,0,1],4)}),t.startValue=un(4),t.prevMatrix=un(4),t.absolutePoses=Yi(c),t.posIndexes=dj(o),Uc(n,e),ly(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=pt(n,e,Q({set:function(C){t.startValue=C}},oy(n,e))),T=Oe(n,"onWarpStart",S);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(ay(n,e,"matrix3d"),Xd(n,"warpable")){var b=p.map(function(k){return m[k]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=dy(n,r,{horizontal:b.map(function(k){return k[1]+a}),vertical:b.map(function(k){return k[0]+i})}),w=_.horizontal,S=_.vertical;a-=w.offset,i-=S.offset}var T=os({datas:t,distX:i,distY:a},!0),C=t.nextPoses.slice();if(p.forEach(function(k){C[k]=Nt(C[k],T)}),!WQ.every(function(k){return DJ(k.map(function(z){return h[z]}),k.map(function(z){return C[z]}))}))return!1;var D=dS(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!D.length)return!1;var O=en(o,D,4),M=cj(t,O,!0),V=en(rs(c,4),M,4);t.prevMatrix=M;var A=en(d,M,4),I=sy(t,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(M.join(", "),")"));return mS(e,I),Oe(n,"onWarp",pt(n,e,Q({delta:V,matrix:A,dist:M,multiply:en,transform:I},qr({transform:I},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,Oe(n,"onWarpEnd",xi(n,e,{})),r):!1}},NJ=qe("area-pieces"),Xm=qe("area-piece"),Jj=qe("avoid"),MJ=qe("view-dragging");function h1(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;A3(e,Jj),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Dk(n){return n.createElement("div",{key:"area_pieces",className:NJ},n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}))}var eV={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,o=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?qe("area","pass"):qe("area");if(a)return[e.createElement("div",{key:"area",ref:Ps(n,"areaElement"),className:p}),Dk(e)];if(!r||!i)return[];var m=dS([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?fy(m,!0):"none";return[e.createElement("div",{key:"area",ref:Ps(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),Dk(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var o=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=qi(d),w=_.left,S=_.top,T=_.width,C=_.height,D=p?4:3,O=ne(Dd(h,[r-m,i-b],D),2),M=O[0],V=O[1];M-=w,V-=S;var A=[{left:w,top:S,width:T,height:V-10},{left:w,top:S,width:M-10,height:C},{left:w,top:S+V+10,width:T,height:C-V-10},{left:w+M+10,top:S,width:T-M-10,height:C}],I=[].slice.call(o.nextElementSibling.children);A.forEach(function(k,z){I[z].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),T3(o,Jj),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,h1(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||h1(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){h1(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&_3(function(){e.disableNativeEvent=!1})}},PJ=Jp("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,o=n.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,_=o.offsetWidth,w=o.offsetHeight,S;if(!a&&d&&i){var T=ne(DS(i,_,w),2),C=T[0],D=T[1],O=p?4:3,M=wn(h,[C,D],O);S=hv(u,r,Ye(M,[m,b]))}else S=hv(u,r,c);return[e.createElement("div",{className:qe("control","origin"),style:S,key:"beforeOrigin"})]}});function OJ(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var jJ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,o=new gQ,c=ts(i,!0);e.datas.dragScroll=o,n.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=pt(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),Oe(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),o.dragStart(e,Q({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?OJ:h,m=r.scrollOptions;return t.drag(e,Q({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,Q(Q({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,Q(Q({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,Q(Q({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,Q(Q({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,Q(Q({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,Q(Q({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,Q(Q({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},tV={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},VJ=Jp("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=Zj(t.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(S,T){var C=ne(S,2),D=C[0],O=C[1],M=_[D],V=_[O],A=d[D],I=d[O],k=dS([0,0],[100,0],[0,100],[100,100],M,V,A,I);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:qe("padding"),style:{transform:fy(k,!0)}})})}}),kk=["nw","ne","se","sw"];function Wm(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var zJ=[1,2,5,6],LJ=[0,3,4,7],ac=[1,-1,-1,1],sc=[1,1,-1,-1];function kS(n,e,t,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(oa(S,r,e)),S}else{var S=Math.max(0,b===1?w[0]-i:o-w[0]);return u.push(oa(S,t,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function nV(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function rV(n,e,t,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,S=_.length,T=S>0,C=ne(b,4),D=C[0],O=D===void 0?"0px":D,M=C[1],V=M===void 0?O:M,A=C[2],I=A===void 0?O:A,k=C[3],z=k===void 0?V:k,L=ne(_,4),B=L[0],P=B===void 0?O:B,J=L[1],Y=J===void 0?T?P:V:J,H=L[2],W=H===void 0?T?P:I:H,K=L[3],de=K===void 0?T?Y:z:K,te=[O,V,I,z].map(function(he){return Jt(he,e)}),G=[P,Y,W,de].map(function(he){return Jt(he,t)}),$=te.slice(),Z=G.slice();c=ne(Wm([$[0],$[1]],e),2),$[0]=c[0],$[1]=c[1],u=ne(Wm([$[3],$[2]],e),2),$[3]=u[0],$[2]=u[1],d=ne(Wm([Z[0],Z[3]],t),2),Z[0]=d[0],Z[3]=d[1],h=ne(Wm([Z[1],Z[2]],t),2),Z[1]=h[0],Z[2]=h[1];var ee=o?$:$.slice(0,Math.max(a[0],w)),le=o?Z:Z.slice(0,Math.max(a[1],S));return Ae(Ae([],ne(ee.map(function(he,se){var Se=kk[se];return{virtual:se>=w,horizontal:ac[se],vertical:0,pos:[r+he,i+(sc[se]===-1?t:0)],sub:!0,raw:te[se],direction:Se}})),!1),ne(le.map(function(he,se){var Se=kk[se];return{virtual:se>=S,horizontal:0,vertical:sc[se],pos:[r+(ac[se]===-1?e:0),i+he],sub:!0,raw:G[se],direction:Se}})),!1)}function BJ(n,e,t,r,i){i===void 0&&(i=e.length);var a=nV(n.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function UJ(n,e,t,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=nV(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=ac[r]===1?a-d:c-a,w=m[1];w<=r;++w){var S=sc[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:ac[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:ac[w],vertical:0,pos:[T,S]}),e.splice(t+w,0,[T,S]),w===0)break}else if(i>-1){var C=sc[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var D=[d+C,h];n.push({horizontal:ac[0],vertical:0,pos:D}),e.push(D)}for(var O=b[0],w=b[1];w<=i;++w){var T=ac[w]===1?d:c,S=0;if(i===w?S=o:w===0?S=h+C:sc[w]===1?S=e[t+O][1]:sc[w]===-1&&(S=u-(e[t+O][1]-h)),n.push({horizontal:0,vertical:sc[w],pos:[T,S]}),e.push([T,S]),w===0)break}}}function FJ(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var GJ=[[0,-1,"n"],[1,0,"e"]],qJ=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function NS(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(V){return"".concat(oa(V[0],a,r)," ").concat(oa(V[1],o,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(V){return"".concat(V,"px")});var S=[m,a-b,o-w,_].map(function(V,A){return oa(V,A%2?a:o,r)});if(t.length>8){var T=ne(Ye(t[4],t[0]),2),C=T[0],D=T[1];S.push.apply(S,Ae(["round"],ne(kS(d.slice(8).map(function(V,A){return Q(Q({},V),{pos:t[A]})}),r,C,D,_,m,b,w).styles),!1))}return S}else if(p||u==="ellipse"){var O=t[0],M=oa(xe(t[1][1]-O[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[M]:[oa(xe(t[2][0]-O[0]),a,r),M];return S.push("at",oa(O[0],a,r),oa(O[1],o,r)),S}}function gv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return qJ.map(function(o){var c=ne(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:xe(d),horizontal:xe(u),direction:h,pos:[p,m]}})}function iV(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[xe(e[1]-e[0]),xe(t[1]-t[0])]}function Nk(n,e,t,r,i){var a,o,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=si(n),S=w("clipPath");_=S!=="none"?S:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=x3(_),C=T.prefix,D=C===void 0?_:C,O=T.value,M=O===void 0?"":O,V=D==="circle",A=" ";if(D==="polygon"){var I=uc(M||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var k=I.map(function(nt){var Qe=ne(nt.split(" "),2),Ft=Qe[0],rt=Qe[1];return{vertical:1,horizontal:1,pos:[Jt(Ft,e),Jt(rt,t)]}}),z=Oc(k.map(function(nt){return nt.pos}));return{type:D,clipText:_,poses:k,splitter:A,left:z.minX,right:z.maxX,top:z.minY,bottom:z.maxY}}else if(V||D==="ellipse"){var L="",B="",P=0,J=0,I=ul(M);if(V){var Y="";a=ne(I,4),o=a[0],Y=o===void 0?"50%":o,c=a[2],L=c===void 0?"50%":c,u=a[3],B=u===void 0?"50%":u,P=Jt(Y,Math.sqrt((e*e+t*t)/2)),J=P}else{var H="",W="";d=ne(I,5),h=d[0],H=h===void 0?"50%":h,p=d[1],W=p===void 0?"50%":p,m=d[3],L=m===void 0?"50%":m,b=d[4],B=b===void 0?"50%":b,P=Jt(H,e),J=Jt(W,t)}var K=[Jt(L,e),Jt(B,t)],k=Ae([{vertical:1,horizontal:1,pos:K,direction:"nesw"}],ne(GJ.slice(0,V?1:2).map(function(Ft){return{vertical:xe(Ft[1]),horizontal:Ft[0],direction:Ft[2],sub:!0,pos:[K[0]+Ft[0]*P,K[1]+Ft[1]*J]}})),!1);return{type:D,clipText:_,radiusX:P,radiusY:J,left:K[0]-P,top:K[1]-J,right:K[0]+P,bottom:K[1]+J,poses:k,splitter:A}}else if(D==="inset"){var I=ul(M||"0 0 0 0"),de=I.indexOf("round"),te=(de>-1?I.slice(0,de):I).length,G=I.slice(te+1),$=ne(I.slice(0,te),4),Z=$[0],ee=$[1],le=ee===void 0?Z:ee,he=$[2],se=he===void 0?Z:he,Se=$[3],Me=Se===void 0?le:Se,Ge=ne([Z,se].map(function(Ft){return Jt(Ft,t)}),2),Ee=Ge[0],ke=Ge[1],ut=ne([Me,le].map(function(Ft){return Jt(Ft,e)}),2),Le=ut[0],Fe=ut[1],we=e-Fe,ze=t-ke,st=rV(G,we-Le,ze-Ee,Le,Ee),k=Ae(Ae([],ne(gv(Ee,we,ze,Le)),!1),ne(st),!1);return{type:"inset",clipText:_,poses:k,top:Ee,left:Le,right:we,bottom:ze,radius:G,splitter:A}}else if(D==="rect"){var I=uc(M||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));A=",";var Ne=ne(I.map(function(Ot){var an=$p(Ot).value;return an}),4),Pe=Ne[0],Fe=Ne[1],ke=Ne[2],Le=Ne[3],k=gv(Pe,Fe,ke,Le);return{type:"rect",clipText:_,poses:k,top:Pe,right:Fe,bottom:ke,left:Le,values:I,splitter:A}}}}}function HJ(n,e,t,r,i){var a=n[e],o=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(P){return P==="w"||P==="e"}),p=d.filter(function(P){return P==="n"||P==="s"}),m=h[0],b=p[0];u[e]=t;var _=ne(iV(n),2),w=_[0],S=_[1],T=w&&S?w/S:0;if(T&&i){var C=(e+4)%8,D=n[C].pos,O=[0,0];o.indexOf("w")>-1?O[0]=-1:o.indexOf("e")>-1&&(O[0]=1),o.indexOf("n")>-1?O[1]=-1:o.indexOf("s")>-1&&(O[1]=1);var M=Xj([w,S],t,T,O,!0),V=w+M[0],A=S+M[1],I=D[1],k=D[1],z=D[0],L=D[0];O[0]===-1?z=L-V:O[0]===1?L=z+V:(z=z-V/2,L=L+V/2),O[1]===-1?I=k-A:(O[1]===1||(I=k-A/2),k=I+A);var B=gv(I,L,k,z);n.forEach(function(P,J){u[J][0]=B[J].pos[0]-P.pos[0],u[J][1]=B[J].pos[1]-P.pos[1]})}else n.forEach(function(P,J){var Y=P.direction;Y&&(Y.indexOf(m)>-1&&(u[J][0]=t[0]),Y.indexOf(b)>-1&&(u[J][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else o&&!c?d.forEach(function(P){var J=P==="n"||P==="s";n.forEach(function(Y,H){var W=Y.direction,K=Y.horizontal,de=Y.vertical;!W||W.indexOf(P)===-1||(u[H]=[J||!K?0:t[0],!J||!de?0:t[1]])})}):u[e]=t;return u}function $J(n,e){var t=ne(lj(n,e),2),r=t[0],i=t[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=zJ.indexOf(c),_=LJ.indexOf(c),w=h.length;if(UJ(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var S=NS(n,o,m),T="".concat(d,"(").concat(S.join(p),")");Oe(n,"onClip",pt(n,e,Q({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},qr({clipPath:T},e))))}function YJ(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(BJ(c,d,i,8,h),h===c.length))return}else return;var p=NS(n,r,d),m="".concat(o,"(").concat(p.join(u),")");Oe(n,"onClip",pt(n,e,Q({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},qr({clipPath:m},e))))}var KJ={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,o=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,S=u.pos1,T=u.pos2,C=u.pos3,D=u.pos4,O=u.clipPathState,M=u.snapBoundInfos,V=u.rotation;if(!d||c)return[];var A=Nk(d,h,p,i||"inset",O||r);if(!A)return[];var I=b?4:3,k=A.type,z=A.poses,L=z.map(function(Fe){var we=wn(m,Fe.pos,I);return[we[0]-_,we[1]-w]}),B=[],P=[],J=k==="rect",Y=k==="inset",H=k==="polygon";if(J||Y||H){var W=Y?L.slice(0,8):L;P=W.map(function(Fe,we){var ze=we===0?W[W.length-1]:W[we-1],st=Ln(ze,Fe),Ne=Bj(ze,Fe);return e.createElement("div",{key:"clipLine".concat(we),className:qe("line","clip-line","snap-control"),"data-clip-index":we,style:{width:"".concat(Ne,"px"),transform:"translate(".concat(ze[0],"px, ").concat(ze[1],"px) rotate(").concat(st,"rad) scaleY(").concat(o,")")}})})}if(B=L.map(function(Fe,we){return e.createElement("div",{key:"clipControl".concat(we),className:qe("control","clip-control","snap-control"),"data-clip-index":we,style:{transform:"translate(".concat(Fe[0],"px, ").concat(Fe[1],"px) rotate(").concat(V,"rad) scale(").concat(o,")")}})}),Y&&B.push.apply(B,Ae([],ne(L.slice(8).map(function(Fe,we){return e.createElement("div",{key:"clipRadiusControl".concat(we),className:qe("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+we,style:{transform:"translate(".concat(Fe[0],"px, ").concat(Fe[1],"px) rotate(").concat(V,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var K=A.left,de=A.top,te=A.radiusX,G=A.radiusY,$=ne(Ye(wn(m,[K,de],I),wn(m,[0,0],I)),2),Z=$[0],ee=$[1],le="none";if(!a){for(var he=Math.max(10,te/5,G/5),se=[],Se=0;Se<=he;++Se){var Me=Math.PI*2/he*Se;se.push([te+(te-o)*Math.cos(Me),G+(G-o)*Math.sin(Me)])}se.push([te,-2]),se.push([-2,-2]),se.push([-2,G*2+2]),se.push([te*2+2,G*2+2]),se.push([te*2+2,-2]),se.push([te,-2]),le="polygon(".concat(se.map(function(Fe){return"".concat(Fe[0],"px ").concat(Fe[1],"px")}).join(", "),")")}B.push(e.createElement("div",{key:"clipEllipse",className:qe("clip-ellipse","snap-control"),style:{width:"".concat(te*2,"px"),height:"".concat(G*2,"px"),clipPath:le,transform:"translate(".concat(-_+Z,"px, ").concat(-w+ee,"px) ").concat(fy(m))}}))}if(a){var Ge=qi(Ae([S,T,C,D],ne(L),!1)),Ee=Ge.width,ke=Ge.height,ut=Ge.left,Le=Ge.top;if(H||J||Y){var se=Y?L.slice(0,8):L;B.push(e.createElement("div",{key:"clipArea",className:qe("clip-area","snap-control"),style:{width:"".concat(Ee,"px"),height:"".concat(ke,"px"),transform:"translate(".concat(ut,"px, ").concat(Le,"px)"),clipPath:"polygon(".concat(se.map(function(we){return"".concat(we[0]-ut,"px ").concat(we[1]-Le,"px")}).join(", "),")")}}))}}return M&&["vertical","horizontal"].forEach(function(Fe){var we=M[Fe],ze=Fe==="horizontal";we.isSnap&&P.push.apply(P,Ae([],ne(we.snap.posInfos.map(function(st,Ne){var Pe=st.pos,nt=Ye(wn(m,ze?[0,Pe]:[Pe,0],I),[_,w]),Qe=Ye(wn(m,ze?[h,Pe]:[Pe,p],I),[_,w]);return hp(e,"",nt,Qe,o,"clip".concat(Fe,"snap").concat(Ne),"guideline")})),!1)),we.isBound&&P.push.apply(P,Ae([],ne(we.bounds.map(function(st,Ne){var Pe=st.pos,nt=Ye(wn(m,ze?[0,Pe]:[Pe,0],I),[_,w]),Qe=Ye(wn(m,ze?[h,Pe]:[Pe,p],I),[_,w]);return hp(e,"",nt,Qe,o,"clip".concat(Fe,"bounds").concat(Ne),"guideline","bounds","bold")})),!1))}),Ae(Ae([],ne(B),!1),ne(P),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,Q(Q({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,o=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=Nk(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,S=Oe(n,"onClipStart",pt(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,Uc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=jc(n.props,"clippable"),w=_.keepRatio,S=0,T=0,C=o.draggable,D=os(e);c&&C?(t=ne(C.prevBeforeDist,2),S=t[0],T=t[1]):(r=ne(D,2),S=r[0],T=r[1]);var O=[S,T],M=n.state,V=M.width,A=M.height,I=!p&&!d&&!h,k=b.type,z=b.poses,L=b.splitter,B=z.map(function(Ce){return Ce.pos});I&&(S=-S,T=-T);var P=!d||z[m].direction==="nesw",J=k==="inset"||k==="rect",Y=z.map(function(){return[0,0]});if(d&&!P){var H=z[m],W=H.horizontal,K=H.vertical,de=[S*xe(W),T*xe(K)];Y=HJ(z,m,de,J,w)}else P&&(Y=B.map(function(){return[S,T]}));var te=B.map(function(Ce,Ze){return Nt(Ce,Y[Ze])}),G=Ae([],ne(te),!1);M.snapBoundInfos=null;var $=b.type==="circle",Z=b.type==="ellipse";if($||Z){var ee=qi(te),le=xe(ee.bottom-ee.top),he=xe(Z?ee.right-ee.left:le),se=te[0][1]+le,Se=te[0][0]-he,Me=te[0][0]+he;$&&(G.push([Me,ee.bottom]),Y.push([1,0])),G.push([ee.left,se]),Y.push([0,1]),G.push([Se,ee.bottom]),Y.push([1,0])}var Ge=Pj((_.clipHorizontalGuidelines||[]).map(function(Ce){return Jt("".concat(Ce),A)}),(_.clipVerticalGuidelines||[]).map(function(Ce){return Jt("".concat(Ce),V)}),V,A),Ee=[],ke=[];if($||Z)Ee=[G[4][0],G[2][0]],ke=[G[1][1],G[3][1]];else if(J){var ut=[G[0],G[2],G[4],G[6]],Le=[Y[0],Y[2],Y[4],Y[6]];Ee=ut.filter(function(Ce,Ze){return Le[Ze][0]}).map(function(Ce){return Ce[0]}),ke=ut.filter(function(Ce,Ze){return Le[Ze][1]}).map(function(Ce){return Ce[1]})}else Ee=G.filter(function(Ce,Ze){return Y[Ze][0]}).map(function(Ce){return Ce[0]}),ke=G.filter(function(Ce,Ze){return Y[Ze][1]}).map(function(Ce){return Ce[1]});var Fe=[0,0],we=mk(Ge,_.clipTargetBounds&&{left:0,top:0,right:V,bottom:A},Ee,ke,5,5),ze=we.horizontal,st=we.vertical,Ne=ze.offset,Pe=st.offset;if(ze.isBound&&(Fe[1]+=Ne),st.isBound&&(Fe[0]+=Pe),(Z||$)&&Y[0][0]===0&&Y[0][1]===0){var ee=qi(te),nt=ee.bottom-ee.top,Qe=Z?ee.right-ee.left:nt,Ft=st.isBound?xe(Pe):st.snapIndex===0?-Pe:Pe,rt=ze.isBound?xe(Ne):ze.snapIndex===0?-Ne:Ne;Qe-=Ft,nt-=rt,$&&(nt=Aj(st,ze)>0?nt:Qe,Qe=nt);var bt=G[0];G[1][1]=bt[1]-nt,G[2][0]=bt[0]+Qe,G[3][1]=bt[1]+nt,G[4][0]=bt[0]-Qe}else if(J&&w&&d){var Ot=ne(iV(z),2),an=Ot[0],Bn=Ot[1],Or=an&&Bn?an/Bn:0,ls=z[m],_i=ls.direction||"",Xi=G[1][1],se=G[5][1],Se=G[7][0],Me=G[3][0];xe(Ne)<=xe(Pe)?Ne=Ur(Ne)*xe(Pe)/Or:Pe=Ur(Pe)*xe(Ne)*Or,_i.indexOf("w")>-1?Se-=Pe:_i.indexOf("e")>-1?Me-=Pe:(Se+=Pe/2,Me-=Pe/2),_i.indexOf("n")>-1?Xi-=Ne:_i.indexOf("s")>-1?se-=Ne:(Xi+=Ne/2,se-=Ne/2);var jr=gv(Xi,Me,se,Se);G.forEach(function(Je,fn){var on;on=ne(jr[fn].pos,2),Je[0]=on[0],Je[1]=on[1]})}else G.forEach(function(Ce,Ze){var Dt=Y[Ze];Dt[0]&&(Ce[0]-=Pe),Dt[1]&&(Ce[1]-=Ne)});var An=NS(n,b,te),dr="".concat(k,"(").concat(An.join(L),")");if(M.clipPathState=dr,$||Z)Ee=[G[4][0],G[2][0]],ke=[G[1][1],G[3][1]];else if(J){var ut=[G[0],G[2],G[4],G[6]];Ee=ut.map(function(Ze){return Ze[0]}),ke=ut.map(function(Ze){return Ze[1]})}else Ee=G.map(function(Ce){return Ce[0]}),ke=G.map(function(Ce){return Ce[1]});if(M.snapBoundInfos=mk(Ge,_.clipTargetBounds&&{left:0,top:0,right:V,bottom:A},Ee,ke,1,1),C){var sn=M.is3d,Js=M.allMatrix,ya=sn?4:3,ba=Fe;c&&(ba=[O[0]+Fe[0]-D[0],O[1]+Fe[1]-D[1]]),C.deltaOffset=en(Js,[ba[0],ba[1],0,0],ya)}return Oe(n,"onClip",pt(n,e,Q({clipEventType:"changed",clipType:k,poses:te,clipStyle:dr,clipStyles:An,distX:S,distY:T},qr((i={},i[k==="rect"?"clip":"clipPath"]=dr,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(Oe(n,"onClipEnd",xi(n,e,{})),i&&(c?YJ(n,e):a&&$J(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},XJ={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":sr(e.inputEvent.target,qe("origin"))},dragControlStart:function(n,e){var t=e.datas;Uc(n,e);var r=pt(n,e,{dragStart:Br.dragStart(n,new Cd().dragStart([0,0],e))}),i=Oe(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=ne(os(e),2),o=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,S=b?4:3,T=[o,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var D=Nt(t.startOrigin,T),O=Nt(t.startTargetOrigin,T),M=Ye(T,t.prevOrigin),V=tg(p,m,D,S),A=n.getRect(),I=qi(Fc(V,d,h,S)),k=[A.left-I.left,A.top-I.top];t.prevOrigin=T;var z=[oa(O[0],d,w),oa(O[1],h,w)].join(" "),L=Br.drag(n,eg(e,n.state,k,!!r)),B=pt(n,e,Q(Q({width:d,height:h,origin:D,dist:T,delta:M,transformOrigin:z,drag:L},qr({transformOrigin:z,transform:L.transform},e)),{afterTransform:L.transform}));return Oe(n,"onDragOrigin",B),B},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(Oe(n,"onDragOriginEnd",xi(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function WJ(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!n[o].virtual)){var c=n[o];QJ(n,o),o<4?c.pos[0]=t:c.pos[1]=r}}function QJ(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function ZJ(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function Mk(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=ul(n),rV(a,e,t,0,0,r,i)}function Pk(n,e,t,r,i){var a=n.state,o=a.width,c=a.height,u=kS(i,n.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=FJ(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var S=pt(n,e,Q({horizontals:b,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:t},qr({borderRadius:w},e)));return Oe(n,"onRound",S),S}function Ok(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],o=n.getTargets()[0];o&&(a?.props.target===o?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=AS(o).borderRadius,r.borderRadius=i))}return i}var JJ={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?qe("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,o=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,S=p.zoom,T=p.roundPadding,C=T===void 0?0:T,D=p.isDisplayShadowRoundControls,O=p.groupable;if(!r)return null;var M=h||Ok(n),V=c?4:3,A=Mk(M,i,a,b,!0);if(!A)return null;var I=0,k=0,z=O?[0,0]:[u,d];return A.map(function(L,B){var P=L.horizontal,J=L.vertical,Y=L.direction||"",H=Ae([],ne(L.pos),!1);k+=Math.abs(P),I+=Math.abs(J),P&&Y.indexOf("n")>-1&&(H[1]-=C),J&&Y.indexOf("w")>-1&&(H[0]-=C),P&&Y.indexOf("s")>-1&&(H[1]+=C),J&&Y.indexOf("e")>-1&&(H[0]+=C);var W=Ye(wn(o,H,V),z),K=D&&D!=="horizontal",de=L.vertical?I<=w[1]&&(K||!L.virtual):k<=w[0]&&(D||!L.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(B),className:qe("control","border-radius",L.vertical?"vertical":"",L.virtual?"virtual":""),"data-radius-index":B,style:{display:de?"block":"none",transform:"translate(".concat(W[0],"px, ").concat(W[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=pt(n,e,{}),m=Oe(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Uc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,S=w===void 0?[0,0]:w,T=n.state,C=T.width,D=T.height;r.isRound=!0,r.prevDist=[0,0];var O=Ok(n),M=Mk(O||"",C,D,S,!0)||[];return r.controlPoses=M,T.borderRadiusState=kS(M,_,C,D).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=ne(os(e),2),o=a[0],c=a[1],u=[o,c],d=Ye(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],S=w.vertical,T=w.horizontal,C=r.map(function(O){var M=O.horizontal,V=O.vertical,A=[M*T*u[0],V*S*u[1]];if(M){if(p[0]===1)return A;if(p[0]<4&&M!==T)return A}else{if(p[1]===0)return A[1]=V*T*u[0]/b*_,A;if(S){if(p[1]===1)return A;if(p[1]<4&&V!==S)return A}}return[0,0]});C[i]=u;var D=r.map(function(O,M){return Q(Q({},O),{pos:Nt(O.pos,C[M])})});return i<4?D.slice(0,i+1).forEach(function(O){O.virtual=!1}):D.slice(4,i+1).forEach(function(O){O.virtual=!1}),t.prevDist=[o,c],Pk(n,e,u,d,D)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))ZJ(d,o);else if(c&&(m===!0||m==="line")){var b=ne(lj(n,e),2),_=b[0],w=b[1];WJ(d,u,_,w)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&Pk(n,e,[0,0],[0,0],d)}var S=xi(n,e,{});return Oe(n,"onRoundEnd",S),t.borderRadiusState="",S},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=da(n,"roundable",e),o=Q({targets:n.props.targets,events:a.map(function(c,u){return Q(Q({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return Oe(n,"onRoundGroupStart",o),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=da(n,"roundable",e),o=Q({targets:n.props.targets,events:a.map(function(c,u){return Q(Q(Q({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),qr({borderRadius:t.borderRadius},c))})},t);return Oe(n,"onRoundGroup",o),o},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=da(n,"roundable",e);hy(n,"onRound",function(c){var u=Q({targets:n.props.targets,events:i.map(function(d,h){return Q(Q(Q({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),qr({borderRadius:c.borderRadius},d))})},c);Oe(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var o=Q({targets:n.props.targets,events:i.map(function(c,u){var d;return Q(Q({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return Oe(n,"onRoundGroupEnd",o),o},unset:function(n){n.state.borderRadiusState=""}};function eee(n,e){var t=e?4:3,r=un(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var aV={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(X3(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=eee(c,r)?[]:ul(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return pt(n,e,{setTransform:function(t){e.datas.startTransforms=tr(t)?t:ul(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return pt(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),Oe(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),Oe(n,"onBeforeRender",pt(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),Oe(n,"onBeforeRenderEnd",pt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.setTransform(u,o),t.resetStyle(o),t.fillDragStartParams(u,o)});Oe(n,"onBeforeRenderGroupStart",pt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.resetStyle(o),t.fillDragParams(u,o)});Oe(n,"onBeforeRenderGroup",pt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),Oe(n,"onBeforeRenderGroupEnd",pt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},sV={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){Oe(n,"onRenderStart",pt(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){Oe(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){Oe(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){Oe(n,"onRenderGroupStart",pt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragParams(u,o)});Oe(n,"onRenderGroup",pt(n,e,Q(Q({isPinch:!!e.isPinch,targets:n.props.targets,transform:qm(e),transformObject:{}},qr(Hm(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragEndParams(u,o)});Oe(n,"onRenderGroupEnd",pt(n,e,Q({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:qm(e)},qr(Hm(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return Ad(lv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),pt(n,e,Q({isPinch:!!e.isPinch,transformObject:t,transform:qm(e)},qr(Hm(e))))},fillDragEndParams:function(n,e){var t={};return Ad(lv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),pt(n,e,Q({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:qm(e)},qr(Hm(e))))}};function Vh(n,e,t,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ae([],ne(e),!1);if(p){var _=a.requestAble;b.some(function(B){return B.name===_})||b.push.apply(b,Ae([],ne(n.props.ables.filter(function(B){return B.name===_})),!1))}if(!b.length||b.every(function(B){return B.dragRelation}))return!1;var w=a.inputEvent,S;u&&w&&(S=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,C=function(){var B;T=!0,(B=a.stop)===null||B===void 0||B.call(a)},D=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());D&&n.updateRect(i,!0,!1);var O=a.datas,M=m?"controlGesto":"targetGesto",V=n[M],A=function(B,P,J){if(!(P in B)||V!==n[M])return!1;var Y=B.name,H=O[Y]||(O[Y]={});if(c&&(H.isEventStart=!J||!B[J]||B[J](n,a)),!H.isEventStart)return!1;var W=B[P](n,Q(Q({},a),{stop:C,datas:H,originalDatas:O,inputTarget:S}));return n._emitter.off(),c&&W===!1&&(H.isEventStart=!1),W};D&&b.forEach(function(B){B.unset&&B.unset(n)}),A(aV,"drag".concat(r).concat(i));var I=0,k=0;t.forEach(function(B){if(T)return!1;var P="".concat(B).concat(r).concat(i),J="".concat(B).concat(r,"Condition");i===""&&!p&&EJ(n.state,a);var Y=b.filter(function(K){return K[P]});Y=Y.filter(function(K,de){return K.name&&Y.indexOf(K)===de});var H=Y.filter(function(K){return A(K,P,J)}),W=H.length;T&&++I,W&&++k,!T&&c&&Y.length&&!W&&(I+=Y.filter(function(K){var de=K.name,te=O[de];return te.isEventStart?K.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&A(sV,"drag".concat(r).concat(i));var z=V!==n[M]||I===t.length;if((u||T||z)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(B){B.state.gestos={}}),b.forEach(function(B){B.unset&&B.unset(n)})),c&&!z&&!p&&k&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||z)return!1;if(!c&&k&&!o||u){var L=n.props.flushSync||Vj;L(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&Vh(n,e,t,r,i+"After",a),!0}function MS(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,o=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||sr(a,"moveable-area")||sr(a,"moveable-padding")||sr(a,"moveable-edgeDraggable")}}function oV(n,e,t){var r=n.controlBox,i=[],a=n.props,o=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=MS(n);return cV(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function lV(n,e){var t=n.controlBox,r=[];r.push(t);var i=MS(n,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===t)return!0;var u=i(o,c);return!u};return cV(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function cV(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",o=n.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,_=b===void 0?!0:b,w=o.preventRightClick,S=w===void 0?!0:w,T=o.preventWheelClick,C=T===void 0?!0:T,D=o.dragContainer,O=ts(D,!0),M={preventDefault:_,preventRightClick:S,preventWheelClick:C,container:O||nl(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(I){return n.controlBox.contains(I.target)},checkInput:a?p:!1,dragFocusedInput:m},V=new CQ(e,M),A=r==="Control";return["drag","pinch"].forEach(function(I){["Start","","End"].forEach(function(k){V.on("".concat(I).concat(k),function(z){var L,B=z.eventType,P=I==="drag"&&z.isPinch;if(i[B]&&!i[B](z)){z.stop();return}if(!P){var J=I==="drag"?[I]:["drag",I],Y=Ae([],ne(n[t]),!1),H=Vh(n,Y,J,r,k,z);H?(n.props.stopPropagation||k==="Start"&&A)&&((L=z?.inputEvent)===null||L===void 0||L.stopPropagation()):z.stop()}})})}),V}var tee=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function nee(n,e,t,r){var i;t===void 0&&(t=e);var a=pj(n,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=mZ(p,t),w=_.matrixes,S=_.is3d,T=_.offsetContainer,C=_.zoom,D=r,O=4,M=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,V=u,A=un(O),I=un(O),k=un(O),z=un(O),L=o.length,B=w.map(function(de){return Q(Q({},de),{matrix:de.matrix?Ae([],ne(de.matrix),!1):void 0})}).reverse();o.reverse(),!c&&D&&(V=ma(V,3,4),K_(o)),!S&&D&&K_(B),B.forEach(function(de){I=en(I,de.matrix,O)});var P=t||bl(n),J=((i=B[0])===null||i===void 0?void 0:i.target)||pp(P,P,!0).offsetParent,Y=B.slice(1).reduce(function(de,te){return en(de,te.matrix,O)},un(O));o.forEach(function(de,te){if(L-2===te&&(k=A.slice()),L-1===te&&(z=A.slice()),!de.matrix){var G=o[te+1],$=bJ(de,G,J,O,en(Y,A,O));de.matrix=Pc($,O)}A=en(A,de.matrix,O)});var H=!M&&c;V||(V=un(H?4:3));var W=fy(M&&V.length===16?ma(V,4,3):V,H),K=I;return I=Y3(I,O,O),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:o,rootMatrix:I,originalRootMatrix:K,beforeMatrix:k,offsetMatrix:z,allMatrix:A,targetMatrix:V,targetTransform:W,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:D,offsetContainer:p,offsetRootContainer:T}}function ree(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,o=0,c={},u=Uj(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=nee(n,e,t,r),h=sd(d.allMatrix,d.transformOrigin,i,a);c=Q(Q({},d),h);var p=sd(d.allMatrix,[50,50],100,100);o=Fj([p.pos1,p.pos2],p.direction)}var m=4;return Q(Q(Q({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:un(m),rootMatrix:un(m),beforeMatrix:un(m),offsetMatrix:un(m),allMatrix:un(m),targetMatrix:un(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function Z_(n,e,t,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Ym(),d=Ym(),h=Ym(),p=Ym(),m=[0,0],b={},_=ree(e,t,i,!0);if(e){var w=si(e);a.forEach(function(B){b[B]=w(B)});var S=_.is3d?4:3,T=sd(_.offsetMatrix,Nt(_.transformOrigin,K3(_.targetMatrix,S)),_.width,_.height);o=T.direction,c=Nt(T.origin,[T.left-_.left,T.top-_.top]),p=jh(_.offsetRootContainer);var C=pp(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var D=sd(en(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),O=sd(_.originalRootMatrix,fv(si(C)("transformOrigin")).map(function(B){return parseFloat(B)}),C.offsetWidth,C.offsetHeight);if(u=d1(D,p),h=d1(O,p,C,!0),n){var M=D.left,V=D.top;d=d1({left:M,top:V,bottom:V,right:V},p)}}else{u=jh(e),h=gZ(C),n&&(d=jh(n));var A=h.left,I=h.top,k=h.clientLeft,z=h.clientTop,L=[u.left-A,u.top-I];m=Ye(Dd(_.rootMatrix,L,4),[k+_.left,z+_.top])}}return Q({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function jk(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=Oc([e,t,r,i]),o=[a.minX,a.minY],c=Ye(n.origin,o);return e=Ye(e,o),t=Ye(t,o),r=Ye(r,o),i=Ye(i,o),Q(Q({},n),{left:n.left,top:n.top,posDelta:o,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var kd=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=Q({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Z_(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new iy,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}yW(t._observerId),t._observerId=_3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,o=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=ne(i||[0,0],2),w=_[0],S=_[1],T=r.left,C=r.top,D=r.target,O=r.direction,M=r.hasFixed,V=r.offsetDelta,A=t.targets,I=this.isDragging(),k={};this.getEnabledAbles().forEach(function(Y){k["data-able-".concat(Y.name.toLowerCase())]=!0});var z=this._getAbleClassName(),L=A&&A.length&&(D||p)||o||!this._hasFirstTarget&&this.state.isPersisted,B=this.controlBox||this.props.firstRenderState||this.props.persistData,P=[T-w,C-S];!p&&t.useAccuratePosition&&(P[0]+=V[0],P[1]+=V[1]);var J={position:M?"fixed":"absolute",display:L?"block":"none",visibility:B?"visible":"hidden",transform:"translate3d(".concat(P[0],"px, ").concat(P[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(J["--moveable-line-padding"]=m),b&&(J["--moveable-control-padding"]=b),ua(h,Q({cspNonce:u,ref:Ps(this,"controlBox"),className:"".concat(qe("control-box",O===-1?"reverse":"",I?"dragging":"")," ").concat(z," ").concat(a)},k,{onClick:this._onPreventClick,style:J}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Qu(this,!1),Qu(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return ai(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(pS)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&MS(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if($d(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=Q({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,S=ak([a,o,u,c],d),T=_Q(S,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),C=Z3(S);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?O_([t,r],ak([o,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Id(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=Z_(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=jk(a.persistData);for(var _ in b)m[_]=b[_]}o&&Id(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!t)return!0;var c=o.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=Yi(this.state),i=ne(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=qi(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,S=[t.left,t.top],T=Nt(S,t.origin),C=Nt(S,t.beforeOrigin),D=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:D,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&X_(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&X_(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return AJ(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=ai(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ae([],ne(c[b]),!1),S={request:function(T){return Vh(a,w,["drag"],_,"",Q(Q({},p.request(T)),{requestAble:t,isRequest:!0}),m),S},requestEnd:function(){return Vh(a,w,["drag"],_,"End",Q(Q({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),S}};return Vh(a,w,["drag"],_,"Start",Q(Q({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,o=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,S=r.zoom||1;if(!i&&S<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=Zj(i||{}),C=T.left,D=T.top,O=T.bottom,M=T.right,V=u?4:3,A=[];w?A=o:this.controlBox&&r.groupable?A=a:A=Nt(a,[b,_]);var I=sv(V,Pc(A.map(function(J){return-J}),V),c,Pc(o,V)),k=Oi(I,d,[-C,-D],V),z=Oi(I,h,[M,-D],V),L=Oi(I,p,[-C,O],V),B=Oi(I,m,[M,O],V);t.renderPoses=[k,z,L,B],t.renderLines=[[k,z],[z,B],[B,L],[L,k]];{var P=S/2;t.renderLines=[[Oi(I,d,[-C-P,-D],V),Oi(I,h,[M+P,-D],V)],[Oi(I,h,[M,-D-P],V),Oi(I,m,[M,O+P],V)],[Oi(I,m,[M+P,O],V),Oi(I,p,[-C-P,O],V)],[Oi(I,p,[-C,O+P],V),Oi(I,d,[-C,-D-P],V)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!W_(c,r),h=d||!W_(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=tj(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=jk(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=Km(o,[c,u],a),p=Km(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:ua};return this.renderState={},wJ(Kj(Km(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(t,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ae(Ae([],ne(r),!1),ne(c),!1)},Ae([],ne(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Qu(this,!1),this.updateState({gestos:{}})),r||Qu(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=oV(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=lV(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=ts(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:ua};return u.renderLines.map(function(h,p){return hp(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=$s(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=Km(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new tee(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=ts(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=ts(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ae(Ae([],ne(this._getAbleViewClassNames()),!1),[this.isDragging()?MJ:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=Yj(t.filter(Boolean),function(d){return d}).map(function(d){var h=ne(d,1),p=h[0];return p}),a=this._viewClassNames,o=Yp(a,i),c=o.removed,u=o.added;c.forEach(function(d){A3(r,a[d])}),u.forEach(function(d){T3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat(qe("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,o=nl(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,o=a.target,c=nl(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=zQ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Vj,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(M3),PS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Zu(n,"parentPosition",[o,c],function(_){return _.join(",")}),b=Zu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ae(Ae([],ne(i.map(function(_,w){return e.createElement(kd,{key:"moveable"+w,ref:v3(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),ne(Kj(h.map(function(_,w){var S=_.pos1,T=_.pos2,C=_.pos3,D=_.pos4,O=[S,T,C,D];return[[0,1],[1,3],[3,2],[2,0]].map(function(M,V){var A=ne(M,2),I=A[0],k=A[1];return hp(e,"",Ye(O[I],m),Ye(O[k],m),d,"group-rect-".concat(w,"-").concat(V))})}))),!1)}},iee=Jp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),o=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||o)){var c=t.contains(i);Oe(n,"onClick",pt(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Hs(i,function(u){return u.contains(r)}),c=a>-1),Oe(n,"onClickGroup",pt(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Ou(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),Q(Q({},n),{datas:e})}var aee=Jp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?vj(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&sr(i,qe("direction"))&&sr(i,qe("edge"))&&sr(i,qe("edgeDraggable"))},dragStart:function(n,e){return Br.dragStart(n,Ou(e))},drag:function(n,e){return Br.drag(n,Ou(e))},dragEnd:function(n,e){return Br.dragEnd(n,Ou(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&sr(i,qe("direction"))&&sr(i,qe("line"))},dragGroupStart:function(n,e){return Br.dragGroupStart(n,Ou(e))},dragGroup:function(n,e){return Br.dragGroup(n,Ou(e))},dragGroupEnd:function(n,e){return Br.dragGroupEnd(n,Ou(e))},unset:function(n){return Br.unset(n)}}),uV={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},OS=[aV,tV,cJ,IJ,Br,aee,H_,RJ,kJ,HZ,jJ,VJ,PJ,XJ,KJ,JJ,PS,uV,iee,eV,sV],see=OS.reduce(function(n,e){return(e.events||[]).forEach(function(t){S3(n,t)}),n},[]),oee=OS.reduce(function(n,e){return(e.props||[]).forEach(function(t){S3(n,t)}),n},[]);function Vk(n,e){var t=ne(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Qm(n,e){var t=ne(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function zk(n,e){return Math.max.apply(Math,Ae([],ne(n.map(function(t){var r=ne(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function Lk(n,e){return Math.min.apply(Math,Ae([],ne(n.map(function(t){var r=ne(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function lee(n,e){var t,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=lt(e,$r);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[U_,lk],S=[[0,0],[0,0]],T=[U_,lk],C=[[0,0],[0,0]];n.forEach(function(Z){Z.forEach(function(ee){var le=Vk([-b,1,0],ee),he=Vk([-_,1,0],ee);w[0]>le&&(S[0]=ee,w[0]=le),w[1]<le&&(S[1]=ee,w[1]=le),T[0]>he&&(C[0]=ee,T[0]=he),T[1]<he&&(C[1]=ee,T[1]=he)})});var D=ne(S,2),O=D[0],M=D[1],V=ne(C,2),A=V[0],I=V[1],k=[-b,1,Qm([-b,1],O)],z=[-b,1,Qm([-b,1],M)],L=[-_,1,Qm([-_,1],A)],B=[-_,1,Qm([-_,1],I)];t=ne([[k,L],[k,B],[z,L],[z,B]].map(function(Z){var ee=ne(Z,2),le=ee[0],he=ee[1];return fS(le,he)[0]}),4),a=t[0],o=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var P=Lk(n,0),J=Lk(n,1),Y=zk(n,0),H=zk(n,1);if(a=[P,J],o=[Y,J],c=[P,H],u=[Y,H],d=Y-P,h=H-J,p%180){var W=[c,a,u,o];r=ne(W,4),a=r[0],o=r[1],c=r[2],u=r[3],d=H-J,h=Y-P}}if(p%360>180){var W=[u,c,o,a];i=ne(W,4),a=i[0],o=i[1],c=i[2],u=i[3]}var K=Oc([a,o,c,u]),de=K.minX,te=K.minY,G=K.maxX,$=K.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:de,minY:te,maxX:G,maxY:$,rotation:e}}function dV(n,e){var t=e.map(function(r){if(tr(r)){var i=dV(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=ai(n,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&tr(t[0])?t[0]:t}var cee=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new Q3,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Id(!0),this.moveables.forEach(function(Se){Se.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(Se){return{finded:!1,manager:Se}}),p=this.props.targetGroups||[],m=dV(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ae([],ne(h.filter(function(Se){var Me=Se.finded;return!Me}).map(function(Se){var Me=Se.manager;return Me})),!1));var _=[],w=!r||t!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function C(Se,Me,Ge){var Ee=Se.map(function(st){if(tr(st)){var Ne=C(st,Me),Pe=[Ne.pos1,Ne.pos2,Ne.pos3,Ne.pos4];return _.push(Ne),{poses:Pe,rotation:Ne.rotation}}else return{poses:Yi(st.state),rotation:st.getRotation()}}),ke=Ee.map(function(st){var Ne=st.rotation;return Ne}),ut=0,Le=ke[0],Fe=ke.every(function(st){return Math.abs(Le-st)<.1});w?ut=!b&&Fe?Le:S:ut=!b&&!Ge&&Fe?Le:Me;var we=Ee.map(function(st){var Ne=st.poses;return Ne}),ze=lee(we,ut);return ze}var D=C(m,this.rotation,!0);w&&(this.rotation=D.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var O=this.transformOrigin,M=this.rotation,V=this.scale,A=D.width,I=D.height,k=D.minX,z=D.minY,L=CJ([[0,0],[A,0],[0,I],[A,I]],DS(O,A,I),this.rotation/180*Math.PI),B=Oc(L.result),P=B.minX,J=B.minY,Y=" rotate(".concat(M,"deg)")+" scale(".concat(Ur(V[0]),", ").concat(Ur(V[1]),")"),H="translate(".concat(-P,"px, ").concat(-J,"px)").concat(Y);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(z,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(A,"px;height:").concat(I,"px;")+"transform: ".concat(H),o.width=A,o.height=I;var W=this.getContainer(),K=Z_(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||W,[]),de=[K.left,K.top],te=ne(Yi(K),4),G=te[0],$=te[1],Z=te[2],ee=te[3],le=Oc([G,$,Z,ee]),he=[le.minX,le.minY],se=Ur(V[0]*V[1]);K.pos1=Ye(G,he),K.pos2=Ye($,he),K.pos3=Ye(Z,he),K.pos4=Ye(ee,he),K.left=k-K.left+he[0],K.top=z-K.top+he[1],K.origin=Ye(Nt(de,K.origin),he),K.beforeOrigin=Ye(Nt(de,K.beforeOrigin),he),K.originalBeforeOrigin=Nt(de,K.originalBeforeOrigin),K.transformOrigin=Ye(Nt(de,K.transformOrigin),he),d.style.transform="translate(".concat(-P-he[0],"px, ").concat(-J-he[1],"px)")+Y,Id(),this.updateState(Q(Q({},K),{posDelta:he,direction:se,beforeDirection:se}),i)},e.prototype.getRect=function(){return Q(Q({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ae(Ae([],ne(r),!1),ne(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ae([],ne(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ae(Ae([],ne(this.props.ables),!1),[PS],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=ts(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Qu(this,!1),Qu(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=oV(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=lV(this,"GroupControl")));var m=!W_(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!Qj(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=Q(Q({},kd.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(kd),uee=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),ua(o,{cspNonce:a,ref:Ps(this,"controlBox"),className:qe("control-box")},u.map(function(m,b){var _,w,S=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return ua(kd,Q({key:"moveable"+b,ref:v3(t,"moveables",b)},i,S,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Id(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Id()},e.prototype.getRect=function(){return Q(Q({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,Q(Q({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=ai(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ae([],ne(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(kd);function fV(n,e){var t=[];return n.forEach(function(r){if(r){if(ii(r)){e[r]&&t.push.apply(t,Ae([],ne(e[r]),!1));return}tr(r)?t.push.apply(t,Ae([],ne(fV(r,e)),!1)):t.push(r)}}),t}function hV(n,e){var t=[];return n.forEach(function(r){if(r){if(ii(r)){e[r]&&t.push.apply(t,Ae([],ne(e[r]),!1));return}tr(r)?t.push(hV(r,e)):t.push(r)}}),t}function pV(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?tr(t)&&tr(i)?pV(t,i):!0:!1})}var dee=(function(n){Zp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new Q3,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){t[c]=!0})});var i=$s(t).join(`
`);this.defaultStyled=tj("div",sW(pS,XQ+i))},e.getTotalAbles=function(){return Ae([tV,PS,uV,eV],ne(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=jQ(i,["ables","props"]),u=ne(this._updateRefs(!0),2),d=u[0],h=u[1],p=fV(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ae(Ae([],ne(b),!1),ne(a||[]),!1),w=Q(Q(Q({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return ua(uee,Q({key:"individual-group",ref:Ps(this,"moveable")},w,{target:null,targets:p}));if(m){var D=hV(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var O=T.props.target;O&&p.indexOf(O)>-1&&(S=Q({},T.state))}return ua(cee,Q({key:"group",ref:Ps(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:D,firstRenderState:S}))}else{var M=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var V=T.moveables||[],A=ai(V,function(I){return I.props.target===M});A&&(S=Q({},A.state))}return ua(kd,Q({key:"single",ref:Ps(this,"moveable")},w,{target:M,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=RS(this.props.target||this.props.targets),a=typeof document<"u",o=pV(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(ii(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else tr(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&o]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=ne(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,VQ([oW(oj)],e.prototype,"moveable",void 0),e})(M3),fee=(function(n){Zp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=OS,e})(dee),J_=function(n,e){return J_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},J_(n,e)};function jS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");J_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var gp=function(){return gp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},gp.apply(this,arguments)};function hee(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var pee=(function(n){jS(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return ua(fee,gp({ref:Ps(this,"moveable")},this.state))},e})(sS),gee=oee,mee=oj,vee=see,yee=(function(n){jS(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=gp({},i),c={};vee.forEach(function(h){c[vW("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Hd(r).createElement("div"),r.appendChild(u)),a.containerProvider=nk(ua(pee,gp({ref:Ps(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return tr(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;nk(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=hee([YD(mee,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),YD(gee,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(iy),Bk=(function(n){jS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(yee),dc=(n=>(n.Mouse="mouse",n.Touch="touch",n.Pointer="pointer",n))(dc||{}),gh=(n=>(n.CancelledByMovement="cancelled-by-movement",n.CancelledByRelease="cancelled-by-release",n.CancelledOutsideElement="cancelled-outside-element",n))(gh||{});const bee=["mousedown","mousemove","mouseup","mouseleave","mouseout"],xee=["touchstart","touchmove","touchend","touchcancel"],_ee=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function wee(n){return typeof n=="object"&&n!==null&&"pageX"in n&&typeof n.pageX=="number"&&"pageY"in n&&typeof n.pageY=="number"}function Eee(n){var e;return bee.includes((e=n?.nativeEvent)==null?void 0:e.type)}function gV(n){var e;return xee.includes((e=n?.nativeEvent)==null?void 0:e.type)||"touches"in n}function See(n){const{nativeEvent:e}=n;return e?_ee.includes(e?.type)||"pointerId"in e:!1}function p1(n){return Eee(n)||gV(n)||See(n)}function Uk(n){var e;const t=gV(n)?(e=n?.touches)==null?void 0:e[0]:n;return wee(t)?{x:t.pageX,y:t.pageY}:null}function Tee(n){return{target:n.target,currentTarget:n.currentTarget,nativeEvent:n,persist:()=>{}}}function mV(n,{threshold:e=400,captureEvent:t=!1,detect:r=dc.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:o,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=U.useRef(!1),m=U.useRef(!1),b=U.useRef(),_=U.useRef(),w=U.useRef(n),S=U.useRef(null),T=U.useCallback(M=>V=>{m.current||p1(V)&&(o!==void 0&&!o(V)||(t&&V.persist(),c?.(V,{context:M}),S.current=Uk(V),m.current=!0,b.current=V.currentTarget,_.current=setTimeout(()=>{w.current&&(w.current(V,{context:M}),p.current=!0)},e)))},[t,o,c,e]),C=U.useCallback(M=>(V,A)=>{p1(V)&&m.current&&(S.current=null,t&&V.persist(),p.current?d?.(V,{context:M}):m.current&&h?.(V,{context:M,reason:A??gh.CancelledByRelease}),p.current=!1,m.current=!1,_.current!==void 0&&clearTimeout(_.current))},[t,d,h]),D=U.useCallback(M=>V=>{if(p1(V)&&(u?.(V,{context:M}),i!==!1&&S.current)){const A=Uk(V);if(A){const I=i===!0?25:i,k={x:Math.abs(A.x-S.current.x),y:Math.abs(A.y-S.current.y)};(k.x>I||k.y>I)&&C(M)(V,gh.CancelledByMovement)}}},[C,i,u]),O=U.useCallback(M=>{if(n===null)return{};switch(r){case dc.Mouse:{const V={onMouseDown:T(M),onMouseMove:D(M),onMouseUp:C(M)};return a&&(V.onMouseLeave=A=>{C(M)(A,gh.CancelledOutsideElement)}),V}case dc.Touch:return{onTouchStart:T(M),onTouchMove:D(M),onTouchEnd:C(M)};case dc.Pointer:{const V={onPointerDown:T(M),onPointerMove:D(M),onPointerUp:C(M)};return a&&(V.onPointerLeave=A=>C(M)(A,gh.CancelledOutsideElement)),V}}},[n,C,a,r,D,T]);return U.useEffect(()=>{function M(V){const A=Tee(V);C()(A)}return window.addEventListener("mouseup",M),window.addEventListener("touchend",M),window.addEventListener("pointerup",M),()=>{window.removeEventListener("mouseup",M),window.removeEventListener("touchend",M),window.removeEventListener("pointerup",M)}},[C]),U.useEffect(()=>()=>{_.current!==void 0&&clearTimeout(_.current)},[]),U.useEffect(()=>{w.current=n},[n]),O}const vV=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},yV=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,Zl=n=>yV(n).toISOString(),Aee=n=>{const e=yV(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},Cee=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},VS=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=Zl(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||Aee(r),description:e.description||"",merchant:e.merchant||void 0,type:Cee(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class fc{static instance;static getInstance(){return fc.instance||(fc.instance=new fc),fc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(t.allocations,t.incomeSources)},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=Ut(mt,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=pH(mt);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Vi(mt,"users",e,"envelopes"),a=(await Fa(t)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Vi(mt,"users",e,"transactions"),r=Fs(t,wd("date","desc")),a=(await Fa(r)).docs.map(o=>{const c={id:o.id,...o.data()};return VS(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Vi(mt,"users",e.userId,"envelopes"),r=Ut(t),i=vt.now(),a={...e,createdAt:i,lastUpdated:i};sa(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Zl(i),lastUpdated:Zl(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=Ut(mt,"users",e,"envelopes",t.id);sa(r,{...t,lastUpdated:vt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{const r=Ut(mt,"users",e,"envelopes",t),i=Fs(Vi(mt,"users",e,"transactions"),cH("envelopeId","==",t)),o=(await Fa(i)).docs.map(c=>Ga(c.ref));await Promise.all([Ga(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=Ut(mt,"users",e,"envelopes",i.id);return sa(a,{orderIndex:i.orderIndex,lastUpdated:vt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Vi(mt,"users",e.userId,"transactions"),r=Ut(t),i=vt.now(),o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};sa(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{console.log(" BudgetService.updateTransaction called for transaction:",t.id);const r=Object.fromEntries(Object.entries(t).filter(([a,o])=>o!==void 0)),i=Ut(mt,"users",e,"transactions",t.id);sa(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=Ut(mt,"users",e,"transactions",t);Ga(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=Ut(mt,"users",e.userId,"monthlyBudgets",e.month),r=vt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};Ba(t,{incomeSources:hH(a),updatedAt:r}).catch(c=>{c.code==="not-found"?sa(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Zl(r),updatedAt:Zl(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=Ut(mt,"users",e,"monthlyBudgets",r);jx(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:vt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});Ba(a,{incomeSources:d,updatedAt:vt.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=Ut(mt,"users",e,"monthlyBudgets",r);jx(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);Ba(i,{incomeSources:u,updatedAt:vt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=Ut(mt,"users",e.userId,"monthlyBudgets",e.month),r=vt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};Ba(t,i).catch(o=>{o.code==="not-found"?sa(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Zl(r),updatedAt:Zl(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=Ut(mt,"users",e,"monthlyBudgets",r),o={updatedAt:vt.now()};i.budgetedAmount!==void 0&&(o[`allocations.${t}`]=Number(i.budgetedAmount)),Ba(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=Ut(mt,"users",e,"monthlyBudgets",r);Ba(i,{[`allocations.${t}`]:MR(),updatedAt:vt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=Ut(mt,"users",e,"monthlyBudgets",t),i=await jx(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Vi(mt,"users",e,"envelopeAllocations"),o=await Fa(a),c=[],u=new Set;for(const b of o.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>Ga(Ut(mt,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Vi(mt,"users",e,"monthlyBudgets"),h=await Fa(d);for(const b of h.docs){const w=b.data().allocations||{},S={};let T=!1;Object.keys(w).forEach(C=>{i.has(C)||(S[`allocations.${C}`]=MR(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(S.updatedAt=vt.now(),await Ba(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>Ga(Ut(mt,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=Ut(mt,"users",e,"monthlyBudgets",t);return Bp(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,t){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),t&&Object.keys(t).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=t?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Vi(mt,"users",e,r),a=await Fa(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Ga(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const zS=fc.getInstance(),g1=n=>Vi(mt,"users",n,"transactions"),Iee={subscribeToTransactions:(n,e)=>{const t=Fs(g1(n),wd("date","desc"));return Bp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=Fs(g1(n),wd("date","desc")),r=(await Fa(e)).docs.map(i=>{const a={id:i.id,...i.data()};return VS(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await Xv(g1(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=Ut(mt,"users",n,"transactions",e);return await Ba(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=Ut(mt,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await Ga(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},m1=n=>Vi(mt,"users",n,"envelopes"),Ree={subscribeToEnvelopes:(n,e)=>{const t=Fs(m1(n),wd("orderIndex","asc"));return Bp(t,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=m1(n),i=(await Fa(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await Xv(m1(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=Ut(mt,"users",n,"envelopes",e.id);return await sa(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=Ut(mt,"users",n,"envelopes",e);return await Ba(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=Ut(mt,"users",n,"envelopes",e);await Ga(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},v1=n=>Vi(mt,"users",n,"distributionTemplates"),Dee={subscribeToDistributionTemplates:(n,e)=>{const t=Fs(v1(n),wd("lastUsed","desc"));return Bp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=Fs(v1(n),wd("lastUsed","desc"));return(await Fa(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await Xv(v1(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=Ut(mt,"users",n,"distributionTemplates",e.id);return await sa(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=Ut(mt,"users",n,"distributionTemplates",e);return await Ba(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=Ut(mt,"users",n,"distributionTemplates",e);await Ga(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},y1=n=>Vi(mt,"users",n,"appSettings"),bV={subscribeToAppSettings:(n,e)=>{const t=Fs(y1(n),DR(1));return Bp(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async n=>{const e=Fs(y1(n),DR(1)),t=await Fa(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await Xv(y1(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=Ut(mt,"users",n,"appSettings",e.id);return await sa(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=Ut(mt,"users",n,"appSettings",e);return await sa(r,t,{merge:!0})},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=Ut(mt,"users",n,"appSettings",e);await Ga(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},Fk=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:bV},Symbol.toStringTag,{value:"Module"})),kee=n=>VS(n),Nee=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig}),Gk=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=Ree.subscribeToEnvelopes(e,u=>{console.log(" Real-time sync: Envelopes updated",u.length);const d=u.map(Nee),h=n.getState(),p=new Set(h.envelopes.map(_=>_.id)),m=new Set(d.map(_=>_.id)),b=[...d.filter(_=>p.has(_.id)),...h.envelopes.filter(_=>!m.has(_.id))];n.setState({envelopes:b})}),i=Iee.subscribeToTransactions(e,u=>{console.log(" Real-time sync: Transactions updated",u.length);const d=u.map(kee),h=n.getState(),p=new Set(h.transactions.map(_=>`${_.id}-${_.month}`)),m=new Set(d.map(_=>`${_.id}-${_.month}`)),b=[...d.filter(_=>p.has(`${_.id}-${_.month}`)),...h.transactions.filter(_=>!m.has(`${_.id}-${_.month}`))];n.setState({transactions:b})}),a=Dee.subscribeToDistributionTemplates(e,u=>{console.log(" Real-time sync: Templates updated from Firebase",u.length)}),o=bV.subscribeToAppSettings(e,u=>{console.log(" Real-time sync: Settings updated",u?"found":"null");const d=n.getState();if(u){const h={...d.appSettings,...u,paymentSources:u.paymentSources??d.appSettings?.paymentSources??[]};n.setState({appSettings:h})}else console.log(" Firebase settings null, preserving local state")}),c=zS.subscribeToMonthlyBudget(e,t,u=>{console.log(` Real-time sync: Monthly budget updated (${u.incomeSources.length} sources, ${u.allocations.length} allocations)`);const d=n.getState();n.setState({incomeSources:{...d.incomeSources,[t]:u.incomeSources},allocations:{...d.allocations,[t]:u.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,templates:a,settings:o,monthlyBudget:c},console.log(" Real-time subscriptions active - cross-device sync enabled")},Mee=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),Gk(e,r())),t.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),Gk(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=zS.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},Pee=()=>ca.getState().currentUser?.id||"",Vn=fc.getInstance(),kn=uw()(M9(bN((n,e)=>({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:typeof localStorage<"u"?localStorage.getItem("onboardingCompleted")==="true":!1,isLoading:!1,error:null,setIsOnboardingActive:t=>{n({isOnboardingActive:t})},completeOnboarding:()=>{n({isOnboardingCompleted:!0,isOnboardingActive:!1}),localStorage.setItem("onboardingCompleted","true")},resetOnboarding:()=>{n({isOnboardingCompleted:!1,isOnboardingActive:!0}),localStorage.removeItem("onboardingCompleted")},clearMonthData:async t=>{try{n({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${t}`);const i=(await Zt(()=>Promise.resolve().then(()=>gn),[]).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await Zt(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-DYT7fKDo.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,t),await e().init(),console.log(` Cleared month data for ${t}`),n({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async t=>{try{const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await Vn.getMonthData(i.id,t),o=e();n({incomeSources:{...o.incomeSources,[t]:a.incomeSources},allocations:{...o.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${t} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,o,c]=await Promise.all([Vn.getEnvelopes(i.id),Vn.getTransactions(i.id),Vn.getMonthData(i.id,t.currentMonth)]);n({envelopes:a,transactions:o,incomeSources:{...t.incomeSources,[t.currentMonth]:c.incomeSources},allocations:{...t.allocations,[t.currentMonth]:c.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.incomeSources.length} income sources, ${c.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},o=await Vn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Vn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(o=>o.id===t.id?t:o),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Vn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(o=>o.id!==t),transactions:a.transactions.filter(o=>o.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){n({isLoading:!1});return}const u=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await Vn.reorderEnvelopes(u.id,o),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:o},u=await Vn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:o};await Vn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Vn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(o=>o.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await Vn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===t),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await Vn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await Vn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:t.paymentSources??r.appSettings?.paymentSources??[]};(t.userId||r.appSettings?.userId)&&(i.userId=t.userId??r.appSettings?.userId);const o=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(o){const{AppSettingsService:c}=await Zt(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Fk);return{AppSettingsService:u}},void 0);await c.updateAppSettings(o.id,i.id,i)}n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:o}=await Zt(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Fk);return{AppSettingsService:u}},void 0),c=await o.getAppSettings(i.id);if(c){n({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),n({appSettings:a}),console.log(" Initialized default app settings")}catch(t){console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await Vn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const o=await Vn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Vn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Vn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,o]=t.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`,h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...S}=_;await e().addIncomeSource(t,S)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>!e().envelopes.find(S=>S.id===_.envelopeId)?.isPiggybank);if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,S=_.piggybankConfig?.paused??!1;if(!S&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${S}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===t),u=c?.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await Vn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,o=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await Vn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await Zt(()=>Promise.resolve().then(()=>gn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await Vn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],incomeSources:{},allocations:{},isLoading:!1,error:null})}}),{name:"budget-storage"})));Mee({useBudgetStore:kn,useAuthStore:ca,getCurrentUserId:Pee});var Ju=9e15,xl=1e9,ew="0123456789abcdef",mv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",vv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",tw={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ju,maxE:Ju,crypto:!1},xV,ks,it=!0,py="[DecimalError] ",hl=py+"Invalid argument: ",_V=py+"Precision limit exceeded",wV=py+"crypto unavailable",EV="[object Decimal]",Pr=Math.floor,ar=Math.pow,Oee=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,jee=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Vee=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,SV=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fa=1e7,We=7,zee=9007199254740991,Lee=mv.length-1,nw=vv.length-1,_e={toStringTag:EV};_e.absoluteValue=_e.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),He(n)};_e.ceil=function(){return He(new this.constructor(this),this.e+1,2)};_e.clampedTo=_e.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(hl+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};_e.comparedTo=_e.cmp=function(n){var e,t,r,i,a=this,o=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};_e.cosine=_e.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+We,r.rounding=1,t=Bee(r,RV(r,t)),r.precision=n,r.rounding=e,He(ks==2||ks==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};_e.cubeRoot=_e.cbrt=function(){var n,e,t,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(it=!1,a=h.s*ar(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=Tr(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=ar(t,1/3),n=Pr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),o=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=rn(d.plus(h).times(c),d.plus(u),o+2,1),Tr(c.d).slice(0,o)===(t=Tr(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&(He(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(He(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return it=!0,He(r,n,p.rounding,e)};_e.decimalPlaces=_e.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-Pr(this.e/We))*We,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};_e.dividedBy=_e.div=function(n){return rn(this,new this.constructor(n))};_e.dividedToIntegerBy=_e.divToInt=function(n){var e=this,t=e.constructor;return He(rn(e,new t(n),0,1,1),t.precision,t.rounding)};_e.equals=_e.eq=function(n){return this.cmp(n)===0};_e.floor=function(){return He(new this.constructor(this),this.e+1,3)};_e.greaterThan=_e.gt=function(n){return this.cmp(n)>0};_e.greaterThanOrEqualTo=_e.gte=function(n){var e=this.cmp(n);return e==1||e===0};_e.hyperbolicCosine=_e.cosh=function(){var n,e,t,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/my(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=Nd(o,1,a.times(e),new o(1),!0);for(var u,d=n,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return He(a,o.precision=t,o.rounding=r,!0)};_e.hyperbolicSine=_e.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Nd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/my(5,n)),i=Nd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);n--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=t,He(i,e,t,!0)};_e.hyperbolicTangent=_e.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,rn(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};_e.inverseCosine=_e.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?Ya(e,r,i):new e(0):new e(NaN):n.isZero()?Ya(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};_e.inverseHyperbolicCosine=_e.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,it=!1,t=t.times(t).minus(1).sqrt().plus(t),it=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};_e.inverseHyperbolicSine=_e.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,it=!1,t=t.times(t).plus(1).sqrt().plus(t),it=!0,r.precision=n,r.rounding=e,t.ln())};_e.inverseHyperbolicTangent=_e.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?He(new a(i),n,e,!0):(a.precision=t=r-i.e,i=rn(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};_e.inverseSine=_e.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=Ya(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};_e.inverseTangent=_e.atan=function(){var n,e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=nw)return o=Ya(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=nw)return o=Ya(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/We+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(it=!1,e=Math.ceil(c/We),r=1,u=d.times(d),o=new h(d),i=d;n!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(n=e;o.d[n]===a.d[n]&&n--;);return t&&(o=o.times(2<<t-1)),it=!0,He(o,h.precision=p,h.rounding=m,!0)};_e.isFinite=function(){return!!this.d};_e.isInteger=_e.isInt=function(){return!!this.d&&Pr(this.e/We)>this.d.length-2};_e.isNaN=function(){return!this.s};_e.isNegative=_e.isNeg=function(){return this.s<0};_e.isPositive=_e.isPos=function(){return this.s>0};_e.isZero=function(){return!!this.d&&this.d[0]===0};_e.lessThan=_e.lt=function(n){return this.cmp(n)<0};_e.lessThanOrEqualTo=_e.lte=function(n){return this.cmp(n)<1};_e.logarithm=_e.log=function(n){var e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(it=!1,c=p+b,o=Xo(d,c),r=e?yv(h,c+10):Xo(n,c),u=rn(o,r,c,1),mp(u.d,i=p,m))do if(c+=10,o=Xo(d,c),r=e?yv(h,c+10):Xo(n,c),u=rn(o,r,c,1),!a){+Tr(u.d).slice(i+1,i+15)+1==1e14&&(u=He(u,p+1,0));break}while(mp(u.d,i+=10,m));return it=!0,He(u,p,m)};_e.minus=_e.sub=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return it?He(n,c,u):n}if(t=Pr(n.e/We),h=Pr(b.e/We),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,t=h,o=d.length),r=Math.max(Math.ceil(c/We),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=fa-1;--d[i],d[r]+=fa}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=gy(d,t),it?He(n,c,u):n):new _(u===3?-0:0)};_e.modulo=_e.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?He(new r(t),r.precision,r.rounding):(it=!1,r.modulo==9?(e=rn(t,n.abs(),0,3,1),e.s*=n.s):e=rn(t,n,0,r.modulo,1),e=e.times(n),it=!0,t.minus(e))};_e.naturalExponential=_e.exp=function(){return rw(this)};_e.naturalLogarithm=_e.ln=function(){return Xo(this)};_e.negated=_e.neg=function(){var n=new this.constructor(this);return n.s=-n.s,He(n)};_e.plus=_e.add=function(n){var e,t,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),it?He(n,c,u):n;if(a=Pr(p.e/We),r=Pr(n.e/We),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,o=h.length):(t=h,r=a,o=d.length),a=Math.ceil(c/We),o=a>o?a+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/fa|0,d[i]%=fa;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return n.d=d,n.e=gy(d,r),it?He(n,c,u):n};_e.precision=_e.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(hl+n);return t.d?(e=TV(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};_e.round=function(){var n=this,e=n.constructor;return He(new e(n),n.e+1,e.rounding)};_e.sine=_e.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+We,r.rounding=1,t=Fee(r,RV(r,t)),r.precision=n,r.rounding=e,He(ks>2?t.neg():t,n,e,!0)):new r(NaN)};_e.squareRoot=_e.sqrt=function(){var n,e,t,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(it=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=Tr(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=Pr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(rn(o,a,t+2,1)).times(.5),Tr(a.d).slice(0,t)===(e=Tr(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(He(a,u+1,0),a.times(a).eq(o))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(He(r,u+1,1),n=!r.times(r).eq(o));break}return it=!0,He(r,u,h.rounding,n)};_e.tangent=_e.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=rn(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,He(ks==2||ks==4?t.neg():t,n,e,!0)):new r(NaN)};_e.times=_e.mul=function(n){var e,t,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=Pr(h.e/We)+Pr(n.e/We),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%fa|0,e=c/fa|0;a[i]=(a[i]+e)%fa|0}for(;!a[--o];)a.pop();return e?++t:a.shift(),n.d=a,n.e=gy(a,t),it?He(n,p.precision,p.rounding):n};_e.toBinary=function(n,e){return LS(this,2,n,e)};_e.toDecimalPlaces=_e.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(oi(n,0,xl),e===void 0?e=r.rounding:oi(e,0,8),He(t,n+t.e+1,e))};_e.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=is(r,!0):(oi(n,0,xl),e===void 0?e=i.rounding:oi(e,0,8),r=He(new i(r),n+1,e),t=is(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};_e.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=is(i):(oi(n,0,xl),e===void 0?e=a.rounding:oi(e,0,8),r=He(new a(i),n+i.e+1,e),t=is(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};_e.toFraction=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=TV(_)-b.e-1,o=a%We,e.d[0]=ar(10,o<0?We+o:o),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(hl+c);n=c.gt(e)?a>0?e:d:c}for(it=!1,c=new w(Tr(_)),h=w.precision,w.precision=a=_.length*We*2;p=rn(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=rn(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=rn(d,r,a,1).minus(b).abs().cmp(rn(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,it=!0,m};_e.toHexadecimal=_e.toHex=function(n,e){return LS(this,16,n,e)};_e.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:oi(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(it=!1,t=rn(t,n,0,e,1).times(n),it=!0,He(t)):(n.s=t.s,t=n),t};_e.toNumber=function(){return+this};_e.toOctal=function(n,e){return LS(this,8,n,e)};_e.toPower=_e.pow=function(n){var e,t,r,i,a,o,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u(ar(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return He(c,r,a);if(e=Pr(n.e/We),e>=n.d.length-1&&(t=d<0?-d:d)<=zee)return i=AV(u,c,t,r),n.s<0?new u(1).div(i):He(i,r,a);if(o=c.s,o<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return t=ar(+c,d),e=t==0||!isFinite(t)?Pr(d*(Math.log("0."+Tr(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(it=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=rw(n.times(Xo(c,r+t)),r),i.d&&(i=He(i,r+5,1),mp(i.d,r,a)&&(e=r+10,i=He(rw(n.times(Xo(c,e+t)),e),e+5,1),+Tr(i.d).slice(r+1,r+15)+1==1e14&&(i=He(i,r+1,0)))),i.s=o,it=!0,u.rounding=a,He(i,r,a))};_e.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=is(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(oi(n,1,xl),e===void 0?e=i.rounding:oi(e,0,8),r=He(new i(r),n,e),t=is(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};_e.toSignificantDigits=_e.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(oi(n,1,xl),e===void 0?e=r.rounding:oi(e,0,8)),He(new r(t),n,e)};_e.toString=function(){var n=this,e=n.constructor,t=is(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};_e.truncated=_e.trunc=function(){return He(new this.constructor(this),this.e+1,1)};_e.valueOf=_e.toJSON=function(){var n=this,e=n.constructor,t=is(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function Tr(n){var e,t,r,i=n.length-1,a="",o=n[0];if(i>0){for(a+=o,e=1;e<i;e++)r=n[e]+"",t=We-r.length,t&&(a+=Bo(t)),a+=r;o=n[e],r=o+"",t=We-r.length,t&&(a+=Bo(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function oi(n,e,t){if(n!==~~n||n<e||n>t)throw Error(hl+n)}function mp(n,e,t,r){var i,a,o,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=We,i=0):(i=Math.ceil((e+1)/We),e%=We),a=ar(10,We-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):o=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==ar(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||t<4)&&c==9999||!r&&t>3&&c==4999):o=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==ar(10,e-3)-1,o}function w0(n,e,t){for(var r,i=[0],a,o=0,c=n.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=ew.indexOf(n.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function Bee(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/my(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=Nd(n,1,e.times(i),new n(1));for(var a=t;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=t,e}var rn=(function(){function n(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,_,w,S,T,C,D,O,M,V,A,I,k,z,L,B,P=r.constructor,J=r.s==i.s?1:-1,Y=r.d,H=i.d;if(!Y||!Y[0]||!H||!H[0])return new P(!r.s||!i.s||(Y?H&&Y[0]==H[0]:!H)?NaN:Y&&Y[0]==0||!H?J*0:J/0);for(u?(b=1,h=r.e-i.e):(u=fa,b=We,h=Pr(r.e/b)-Pr(i.e/b)),L=H.length,k=Y.length,T=new P(J),C=T.d=[],p=0;H[p]==(Y[p]||0);p++);if(H[p]>(Y[p]||0)&&h--,a==null?(V=a=P.precision,o=P.rounding):c?V=a+(r.e-i.e)+1:V=a,V<0)C.push(1),_=!0;else{if(V=V/b+2|0,p=0,L==1){for(m=0,H=H[0],V++;(p<k||m)&&V--;p++)A=m*u+(Y[p]||0),C[p]=A/H|0,m=A%H|0;_=m||p<k}else{for(m=u/(H[0]+1)|0,m>1&&(H=n(H,m,u),Y=n(Y,m,u),L=H.length,k=Y.length),I=L,D=Y.slice(0,L),O=D.length;O<L;)D[O++]=0;B=H.slice(),B.unshift(0),z=H[0],H[1]>=u/2&&++z;do m=0,d=e(H,D,L,O),d<0?(M=D[0],L!=O&&(M=M*u+(D[1]||0)),m=M/z|0,m>1?(m>=u&&(m=u-1),w=n(H,m,u),S=w.length,O=D.length,d=e(w,D,S,O),d==1&&(m--,t(w,L<S?B:H,S,u))):(m==0&&(d=m=1),w=H.slice()),S=w.length,S<O&&w.unshift(0),t(D,w,O,u),d==-1&&(O=D.length,d=e(H,D,L,O),d<1&&(m++,t(D,L<O?B:H,O,u))),O=D.length):d===0&&(m++,D=[0]),C[p++]=m,d&&D[0]?D[O++]=Y[I]||0:(D=[Y[I]],O=1);while((I++<k||D[0]!==void 0)&&V--);_=D[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,xV=_;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,He(T,c?a+T.e+1:a,o,_)}return T}})();function He(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=We,o=e,h=p[m=0],u=h/ar(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/We),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=We,o=a-We+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=We,o=a-We+i,u=o<0?0:h/ar(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%ar(10,i-o-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?o>0?h/ar(10,i-o):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=ar(10,(We-e%We)%We),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=ar(10,We-a),p[m]=o>0?(h/ar(10,i-o)%ar(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(n.e++,p[0]==fa&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=fa)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return it&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function is(n,e,t){if(!n.isFinite())return IV(n);var r,i=n.e,a=Tr(n.d),o=a.length;return e?(t&&(r=t-o)>0?a=a.charAt(0)+"."+a.slice(1)+Bo(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+Bo(-i-1)+a,t&&(r=t-o)>0&&(a+=Bo(r))):i>=o?(a+=Bo(i+1-o),t&&(r=t-i-1)>0&&(a=a+"."+Bo(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(a+="."),a+=Bo(r))),a}function gy(n,e){var t=n[0];for(e*=We;t>=10;t/=10)e++;return e}function yv(n,e,t){if(e>Lee)throw it=!0,t&&(n.precision=t),Error(_V);return He(new n(mv),e,1,!0)}function Ya(n,e,t){if(e>nw)throw Error(_V);return He(new n(vv),e,t,!0)}function TV(n){var e=n.length-1,t=e*We+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Bo(n){for(var e="";n--;)e+="0";return e}function AV(n,e,t,r){var i,a=new n(1),o=Math.ceil(r/We+4);for(it=!1;;){if(t%2&&(a=a.times(e),Hk(a.d,o)&&(i=!0)),t=Pr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),Hk(e.d,o)}return it=!0,a}function qk(n){return n.d[n.d.length-1]&1}function CV(n,e,t){for(var r,i,a=new n(e[0]),o=0;++o<e.length;){if(i=new n(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function rw(n,e){var t,r,i,a,o,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(it=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log(ar(2,p))/Math.LN10*2+5|0,u+=r,t=a=o=new m(1),m.precision=u;;){if(a=He(a.times(n),u,1),t=t.times(++h),c=o.plus(rn(a,t,u,1)),Tr(c.d).slice(0,u)===Tr(o.d).slice(0,u)){for(i=p;i--;)o=He(o.times(o),u,1);if(e==null)if(d<3&&mp(o.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return He(o,m.precision=_,b,it=!0);else return m.precision=_,o}o=c}}function Xo(n,e){var t,r,i,a,o,c,u,d,h,p,m,b=1,_=10,w=n,S=w.d,T=w.constructor,C=T.rounding,D=T.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(e==null?(it=!1,h=D):h=e,T.precision=h+=_,t=Tr(S),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=Tr(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=yv(T,h+2,D).times(a+""),w=Xo(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=D,e==null?He(w,D,C,it=!0):w;for(p=w,u=o=w=rn(w.minus(1),w.plus(1),h,1),m=He(w.times(w),h,1),i=3;;){if(o=He(o.times(m),h,1),d=u.plus(rn(o,new T(i),h,1)),Tr(d.d).slice(0,h)===Tr(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(yv(T,h+2,D).times(a+""))),u=rn(u,new T(b),h,1),e==null)if(mp(u.d,h-_,C,c))T.precision=h+=_,d=o=w=rn(p.minus(1),p.plus(1),h,1),m=He(w.times(w),h,1),i=c=1;else return He(u,T.precision=D,C,it=!0);else return T.precision=D,u;u=d,i+=2}}function IV(n){return String(n.s*n.s/0)}function E0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%We,t<0&&(r+=We),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=We;r<i;)n.d.push(+e.slice(r,r+=We));e=e.slice(r),r=We-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),it&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function Uee(n,e){var t,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),SV.test(e))return E0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(jee.test(e))t=16,e=e.toLowerCase();else if(Oee.test(e))t=2;else if(Vee.test(e))t=8;else throw Error(hl+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=n.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=AV(r,new r(t),a,a*2)),d=w0(e,t,fa),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=gy(d,h),n.d=d,it=!1,o&&(n=rn(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?ar(2,u):Md.pow(2,u))),it=!0,n)}function Fee(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:Nd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/my(5,t)),e=Nd(n,2,e,e);for(var i,a=new n(5),o=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function Nd(n,e,t,r,i){var a,o,c,u,d=n.precision,h=Math.ceil(d/We);for(it=!1,u=t.times(t),c=new n(r);;){if(o=rn(c.times(u),new n(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=rn(o.times(u),new n(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return it=!0,o.d.length=h+1,o}function my(n,e){for(var t=n;--e;)t*=n;return t}function RV(n,e){var t,r=e.s<0,i=Ya(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return ks=r?4:1,e;if(t=e.divToInt(i),t.isZero())ks=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return ks=qk(t)?r?2:3:r?4:1,e;ks=qk(t)?r?1:4:r?3:2}return e.minus(i).abs()}function LS(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?(oi(t,1,xl),r===void 0?r=b.rounding:oi(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=IV(n);else{for(h=is(n),o=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=w0(is(m),10,i),m.e=m.d.length),p=w0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(n=new b(n),n.d=p,n.e=a,n=rn(n,m,t,r,0,i),p=n.d,a=n.e,d=xV),o=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(n.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=ew.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=w0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=ew.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function Hk(n,e){if(n.length>e)return n.length=e,!0}function Gee(n){return new this(n).abs()}function qee(n){return new this(n).acos()}function Hee(n){return new this(n).acosh()}function $ee(n,e){return new this(n).plus(e)}function Yee(n){return new this(n).asin()}function Kee(n){return new this(n).asinh()}function Xee(n){return new this(n).atan()}function Wee(n){return new this(n).atanh()}function Qee(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=Ya(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?Ya(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=Ya(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(rn(n,e,a,1)),e=Ya(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(rn(n,e,a,1)),t}function Zee(n){return new this(n).cbrt()}function Jee(n){return He(n=new this(n),n.e+1,2)}function ete(n,e,t){return new this(n).clamp(e,t)}function tte(n){if(!n||typeof n!="object")throw Error(py+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,xl,"rounding",0,8,"toExpNeg",-Ju,0,"toExpPos",0,Ju,"maxE",0,Ju,"minE",-Ju,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=tw[t]),(r=n[t])!==void 0)if(Pr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(hl+t+": "+r);if(t="crypto",i&&(this[t]=tw[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(wV);else this[t]=!1;else throw Error(hl+t+": "+r);return this}function nte(n){return new this(n).cos()}function rte(n){return new this(n).cosh()}function DV(n){var e,t,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,$k(a)){d.s=a.s,it?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;it?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return E0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),SV.test(a)?E0(d,a):Uee(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,E0(d,a.toString());throw Error(hl+a)}if(i.prototype=_e,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=tte,i.clone=DV,i.isDecimal=$k,i.abs=Gee,i.acos=qee,i.acosh=Hee,i.add=$ee,i.asin=Yee,i.asinh=Kee,i.atan=Xee,i.atanh=Wee,i.atan2=Qee,i.cbrt=Zee,i.ceil=Jee,i.clamp=ete,i.cos=nte,i.cosh=rte,i.div=ite,i.exp=ate,i.floor=ste,i.hypot=ote,i.ln=lte,i.log=cte,i.log10=dte,i.log2=ute,i.max=fte,i.min=hte,i.mod=pte,i.mul=gte,i.pow=mte,i.random=vte,i.round=yte,i.sign=bte,i.sin=xte,i.sinh=_te,i.sqrt=wte,i.sub=Ete,i.sum=Ste,i.tan=Tte,i.tanh=Ate,i.trunc=Cte,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function ite(n,e){return new this(n).div(e)}function ate(n){return new this(n).exp()}function ste(n){return He(n=new this(n),n.e+1,3)}function ote(){var n,e,t=new this(0);for(it=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return it=!0,new this(1/0);t=e}return it=!0,t.sqrt()}function $k(n){return n instanceof Md||n&&n.toStringTag===EV||!1}function lte(n){return new this(n).ln()}function cte(n,e){return new this(n).log(e)}function ute(n){return new this(n).log(2)}function dte(n){return new this(n).log(10)}function fte(){return CV(this,arguments,-1)}function hte(){return CV(this,arguments,1)}function pte(n,e){return new this(n).mod(e)}function gte(n,e){return new this(n).mul(e)}function mte(n,e){return new this(n).pow(e)}function vte(n){var e,t,r,i,a=0,o=new this(1),c=[];if(n===void 0?n=this.precision:oi(n,1,xl),r=Math.ceil(n/We),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(wV);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=We,r&&n&&(i=ar(10,We-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=We)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<We&&(t-=We-r)}return o.e=t,o.d=c,o}function yte(n){return He(n=new this(n),n.e+1,this.rounding)}function bte(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function xte(n){return new this(n).sin()}function _te(n){return new this(n).sinh()}function wte(n){return new this(n).sqrt()}function Ete(n,e){return new this(n).sub(e)}function Ste(){var n=0,e=arguments,t=new this(e[n]);for(it=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return it=!0,He(t,this.precision,this.rounding)}function Tte(n){return new this(n).tan()}function Ate(n){return new this(n).tanh()}function Cte(n){return He(n=new this(n),n.e+1,1)}_e[Symbol.for("nodejs.util.inspect.custom")]=_e.toString;_e[Symbol.toStringTag]="Decimal";var Md=_e.constructor=DV(tw);mv=new Md(mv);vv=new Md(vv);const Ite=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},Rte=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=kn(),{currentUser:o}=ca(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=kn(),{showToast:_}=yl(),[w,S]=U.useState(!1),T=U.useRef(null),[C,D]=U.useState(!1),O=!C||r||b,[M,V]=U.useState([]),A=U.useRef([]),[I,k]=U.useState([]),z=U.useRef([]),L=U.useCallback(Z=>{if(n.find(he=>he.id===Z)?.isPiggybank){const he=kn.getState().getEnvelopeBalance(Z);return new Md(he)}const le=kn.getState().getEnvelopeBalance(Z,c);return new Md(le)},[n,c]);U.useEffect(()=>{const Z=n.filter(ee=>{if(!ee.isPiggybank||!ee.isActive)return!1;if(ee.createdAt)try{const le=Ite(ee.createdAt);if(!le)return console.error(` Invalid creation date for piggybank ${ee.name}:`,ee.createdAt),!1;const he=`${le.getFullYear()}-${String(le.getMonth()+1).padStart(2,"0")}`;return c>=he}catch(le){return console.error(` Error processing piggybank ${ee.name}:`,le,{createdAt:ee.createdAt,typeofCreatedAt:typeof ee.createdAt}),!1}return!0}).sort((ee,le)=>{const he=ee.orderIndex??0,se=le.orderIndex??0;return he-se});k(Z),z.current=Z},[n,c]);const B=I,P=M;U.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),t(),D(!0),()=>{T.current&&clearTimeout(T.current)}),[]),U.useEffect(()=>{C&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[C,r,b]),U.useEffect(()=>{const Z=n.filter(ee=>{if(ee.isPiggybank||ee.isActive===!1)return!1;const he=(d[c]||[]).some(Se=>Se.envelopeId===ee.id),se=e.some(Se=>Se.envelopeId===ee.id&&(Se.month===c||Se.date.startsWith(c)));return he||se}).sort((ee,le)=>{const he=ee.orderIndex??0,se=le.orderIndex??0;return he-se});V(Z),A.current=Z},[n,d,c,e]);const J=(u[c]||[]).reduce((Z,ee)=>Z+ee.amount,0),Y=(d[c]||[]).filter(Z=>P.some(ee=>ee.id===Z.envelopeId)||B.some(ee=>ee.id===Z.envelopeId)).reduce((Z,ee)=>Z+ee.budgetedAmount,0),H=J-Y,W=U.useCallback(async Z=>{if(!Z.length)return;const ee=Z.map(le=>le.id);try{await a(ee)}catch(le){console.error("Failed to persist envelope order:",le),_("Failed to save envelope order","error")}},[a,_]),K=U.useCallback(async Z=>{await W(Z)},[W]),de=U.useCallback(Z=>{h(c,Z.id).catch(console.error),_(`Deleted "${Z.name}"`,"neutral")},[h,c,_]),te=U.useCallback(async Z=>{try{const ee=Z||c;console.log(" Copying to month:",ee),await m(ee),_("Previous month budget copied","success")}catch(ee){console.error("Error copying previous month:",ee),_("Failed to copy previous month","error")}},[m,_,c]),G=U.useCallback(async()=>{if(!o||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await kn.getState().clearMonthData(c),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(Z){console.error("Error clearing month data:",Z),_("Failed to clear month data","error")}},[o,c,_]),$=U.useCallback(async(Z,ee)=>{try{await p(Z,ee),setTimeout(()=>{const le=kn.getState(),he=le.currentMonth,se=le.incomeSources[he]||[],Se=le.allocations[he]||[],Me=se.reduce((Ee,ke)=>Ee+ke.amount,0),Ge=Se.reduce((Ee,ke)=>Ee+ke.budgetedAmount,0);Me-Ge<-.01&&_(`You can't spend more than you make.
You're not in Congress!`,"error")},100)}catch(le){console.error("Failed to set allocation:",le),_("Failed to update budget","error")}},[p,_]);return{visibleEnvelopes:P,piggybanks:B,incomeSources:u,availableToBudget:H,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:O,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:L,fetchData:t,reorderEnvelopes:K,deleteIncomeSource:de,clearMonthData:G,copyFromPreviousMonth:te,setEnvelopeAllocation:$,localOrderRef:A,setLocalEnvelopes:V,localPiggybankOrderRef:z,setLocalPiggybanks:k}},Dte=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(_)<=.01,C=_<-.01,D=w>0?S/w*100:0;let O="text-gray-900 dark:text-white",M="bg-green-500",V="Left to Budget",A=w>0?Math.min(D,100):0,I=!0;return w===0?(V="Add income to start budgeting",A=0,I=!1,O="text-gray-500 dark:text-zinc-500"):T?(O="text-green-600 dark:text-emerald-400",M="bg-green-500",V="Perfect! Every dollar has a job ",A=100,I=!1):C&&(O="text-red-600 dark:text-red-400",M="bg-red-500",V="You're not in Congress! Try again.",A=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${O}`,children:V}),I&&v.jsxs("span",{className:`text-sm font-bold truncate ${O}`,children:[C?"-":"","$",Math.abs(_).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${M}`,style:{width:`${A}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(EL,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(Cs,{size:20})})]}),t&&v.jsx("div",{className:"px-1",children:h()})]})},vy=({children:n,onDelete:e,threshold:t=-100})=>{const r=nW(),[i,a]=U.useState(!1),o=U.useRef(0),c=()=>{a(!0),o.current=Date.now()},u=async(d,h)=>{const p=h.offset.x,m=h.velocity.x;if(setTimeout(()=>a(!1),100),p<t||p<-50&&m<-500){const b=e();b===!1?r.start({x:0}):b instanceof Promise&&b.then(_=>{_===!1&&r.start({x:0})})}else r.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(S1,{className:"text-white w-6 h-6"})}),v.jsx(er.div,{drag:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:c,onDragEnd:u,animate:r,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${i?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:i?"none":"auto"},children:n})]})},kte=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=kn(),{showToast:c}=yl(),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(!1);U.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(er.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(er.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const S=w.target.value.replace(/\D/g,"");if(!S){p("");return}const C=(parseInt(S,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},Nte=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),o=i(n);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(gL,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(Bh,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},Mte=({currentMonth:n,onComplete:e})=>{const[t,r]=U.useState(0),a=(b=>{const[_,w]=b.split("-");return new Date(parseInt(_),parseInt(w)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(n),o=[{icon:Bh,title:"Welcome to House Budget!",description:`Let's set up your budget for ${a}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["House Budget helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:T2,title:"Step 1: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(za,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(za,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(za,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(mh,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:_v,title:"Step 2: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are categories for your expenses. Common examples:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(za,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," - Food and household items"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(za,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," - Housing costs"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(za,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Transportation"})," - Gas, car payment, transit"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(za,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Entertainment"})," - Fun money"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Scroll down to "Spending Envelopes"'}),' and tap "Create New Envelope" to add your categories.']})})]}),color:"purple"},{icon:T0,title:"Step 3: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4",children:[v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Available to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]})]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:xc,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(h9,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(T2,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(T0,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:za,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of House Budget:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Create spending envelopes"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Allocate until Available to Budget = $0"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Track spending and adjust as needed"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green"}],c=o[t],u=c.icon,d=t===o.length-1,h=t===0,m={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[c.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(ri,{mode:"wait",children:v.jsxs(er.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsxs("div",{className:"p-6 pb-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsx("div",{className:`${m.bg} p-3 rounded-xl`,children:v.jsx(u,{className:`w-8 h-8 ${m.text}`})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["Step ",t+1," of ",o.length]})]}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:c.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:c.description})]}),v.jsx("div",{className:"px-6 pb-6",children:c.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:o.map((b,_)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${_===t?`w-8 ${m.button}`:_<t?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},_))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!h&&v.jsxs("button",{onClick:()=>r(b=>b-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(od,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{d?e():r(b=>b+1)},className:`${h?"flex-1":"flex-[2]"} py-3 px-4 ${m.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2`,children:d?v.jsxs(v.Fragment,{children:[v.jsx(Bh,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(hL,{className:"w-5 h-5"})]})})]})]},t)})})})},Pte=({isOpen:n,onClose:e,onSave:t,existingPiggybank:r})=>{const[i,a]=U.useState(""),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState("#3B82F6"),[m,b]=U.useState("piggy-bank"),[_,w]=U.useState(!1),[S,T]=U.useState(!1);U.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),w(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),w(!1))},[r,n]);const C=async O=>{if(O.preventDefault(),!(!i.trim()||!u)){T(!0);try{const M={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:_}};o&&parseFloat(o)>0&&(M.piggybankConfig.targetAmount=parseFloat(o)),r&&(M.id=r.id,M.currentBalance=r.currentBalance,M.lastUpdated=new Date().toISOString(),M.isActive=r.isActive,M.orderIndex=r.orderIndex,M.userId=r.userId),await t(M),e()}catch(M){console.error("Error saving piggybank:",M),alert("Failed to save piggybank")}finally{T(!1)}}},D=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(er.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(er.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(xc,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(wv,{size:24})})]}),v.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:O=>a(O.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:O=>{const M=O.target.value.replace(/\D/g,"");if(!M){d("");return}const A=(parseInt(M,10)/100).toFixed(2);d(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:O=>{const M=O.target.value.replace(/\D/g,"");if(!M){c("");return}const A=(parseInt(M,10)/100).toFixed(2);c(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:_,onChange:O=>w(O.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:D.map(O=>v.jsx("button",{type:"button",onClick:()=>p(O.value),className:`w-full aspect-square rounded-lg transition-all ${h===O.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:O.value},title:O.label},O.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:S,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||S,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!S?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:S?"Saving...":r?"Update":"Create"})]})]})]})]})})},Ote=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onLongPressTrigger:c})=>{const u=kn(se=>se.updatePiggybankContribution),d=kn(se=>se.updateEnvelope),h=yl(se=>se.showToast),[p,m]=U.useState(!1),b=mV(se=>{vV(),c(se,n.id)},{threshold:500,cancelOnMovement:25,detect:dc.Touch}),_=se=>{se.stopPropagation(),m(!0)},w=async se=>{try{const Se={...n,...se,id:n.id,userId:n.userId,currentBalance:n.currentBalance,lastUpdated:new Date().toISOString(),isActive:n.isActive,orderIndex:n.orderIndex};await d(Se),h("Piggybank updated successfully","success"),m(!1)}catch(Se){console.error("Failed to update piggybank:",Se),h("Failed to update piggybank","error")}},S=n.piggybankConfig?.targetAmount,T=n.piggybankConfig?.monthlyContribution??0,C=n.piggybankConfig?.color||"#3B82F6",D=n.piggybankConfig?.paused||!1,O=typeof e=="number"?e:e.toNumber(),M=(se,Se=1)=>{const Me=se.replace("#",""),Ge=parseInt(Me,16),Ee=Ge>>16&255,ke=Ge>>8&255,ut=Ge&255;return`rgba(${Ee}, ${ke}, ${ut}, ${Se})`},V=`linear-gradient(135deg, ${M(C,.14)} 0%, ${M(C,.05)} 100%)`,A=M(C,.4),[I,k]=U.useState(!1),[z,L]=U.useState(T?T.toFixed(2):"0.00"),[B,P]=U.useState(!1),J=U.useRef(null),Y=U.useRef(null),[H,W]=U.useState(!1),K=S&&S>0?Math.min(O/S*100,100):0,de=S&&O>=S;U.useEffect(()=>{a&&a!==n.id&&W(!1)},[a,n.id]),U.useEffect(()=>{a===n.id&&(W(!0),o&&o(n.id))},[a,n.id,o]),U.useEffect(()=>{if(!a&&H){const se=setTimeout(()=>{W(!1)},300);return()=>clearTimeout(se)}},[a,H]),U.useEffect(()=>{I||L(T?T.toFixed(2):"0.00")},[T,I]),U.useEffect(()=>{I&&J.current&&(J.current.focus(),J.current.select())},[I]);const te=se=>{se.stopPropagation(),("touches"in se||se.type.startsWith("touch"))&&se.preventDefault(),!B&&(L(T?T.toFixed(2):"0.00"),k(!0))},G=()=>{k(!1),L(T?T.toFixed(2):"0.00")},$=async()=>{if(!I||B)return;const se=parseFloat(z);if(Number.isNaN(se)||se<0){h("Enter a valid contribution amount","error");return}if(se===T){k(!1);return}P(!0);try{await u(n.id,se),h("Monthly contribution updated","success"),L(se.toFixed(2)),k(!1)}catch(Se){console.error("Failed to update piggybank contribution",Se),h("Failed to update contribution","error")}finally{P(!1)}},Z=se=>{se.key==="Enter"?(se.preventDefault(),$()):se.key==="Escape"&&(se.preventDefault(),G())},ee=se=>{if(H||i){se.preventDefault(),se.stopPropagation();return}if(I){se.preventDefault(),se.stopPropagation();return}t(n.id)},le=a===n.id,he=v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:se=>c(se,n.id),children:v.jsx(vN,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-start justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${C}20`},children:v.jsx(xc,{size:20,style:{color:C}})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),de&&v.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:" Goal Reached!"})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:"text-right",children:[v.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",O.toFixed(2)]}),S&&v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["of $",S.toFixed(2)]})]}),v.jsx("button",{onClick:_,className:"p-1.5 rounded-lg text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",title:"Edit piggybank",children:v.jsx(mN,{size:16})})]})]}),S&&S>0&&v.jsxs("div",{className:"mb-3",children:[v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800 rounded-full h-2 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${K}%`,backgroundColor:C}})}),v.jsxs("div",{className:"flex justify-between items-center mt-1",children:[v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:[K.toFixed(0),"% complete"]}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["$",(S-O).toFixed(2)," to go"]}),v.jsx("span",{className:"ml-2 px-2 py-0.5 text-[11px] font-semibold rounded-full uppercase tracking-wide",style:{backgroundColor:M(C,.15),color:C},children:"Piggybank"})]})]}),v.jsx("div",{className:"mt-2",children:D?v.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[v.jsx(r9,{size:14,className:"text-orange-500"}),v.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"Paused"})]}):v.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[v.jsx(T0,{size:14,style:{color:C}}),I?v.jsxs("form",{onSubmit:se=>{se.preventDefault(),$()},className:"flex items-center gap-2",onClick:se=>se.stopPropagation(),children:[v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{ref:J,type:"number",min:"0",step:"0.01",value:z,onChange:se=>L(se.target.value),onBlur:$,onKeyDown:Z,disabled:B,autoFocus:!0,className:"w-28 pl-6 pr-3 py-1.5 rounded-lg border border-gray-300 dark:border-zinc-600 bg-white dark:bg-zinc-900 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),B&&v.jsx(QL,{size:16,className:"animate-spin text-gray-400"})]}):v.jsxs("div",{onClick:te,onTouchEnd:te,className:"font-medium text-gray-900 dark:text-white hover:underline cursor-pointer",children:["$",T.toFixed(2),"/month"]})]})})]})]});return v.jsxs(v.Fragment,{children:[v.jsx(Pte,{isOpen:p,onClose:()=>m(!1),onSave:w,existingPiggybank:n}),v.jsx(er.div,{...b(),layout:!le,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:se=>{r&&r(se),Y.current=se},onClick:ee,style:{background:V,borderColor:A,boxShadow:le?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:le?50:1,scale:le?1.02:1},className:"rounded-xl p-4 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:he})]})},rh=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},Yk=12,Kk=(n,e,t)=>Math.min(Math.max(n,e),t),jte=({env:n,budgetedAmount:e,remainingBalance:t,editingEnvelopeId:r,setEditingEnvelopeId:i,editingAmount:a,setEditingAmount:o,handleBudgetSave:c,navigate:u,inputRef:d,transactions:h,currentMonth:p,setMoveableRef:m,isReorderingActive:b,activelyDraggingId:_,onItemDragStart:w,onLongPressTrigger:S})=>{const T=!!n.isPiggybank,C=n.piggybankConfig?.color||"#3B82F6",D=T?`linear-gradient(135deg, ${rh(C,.18)} 0%, ${rh(C,.08)} 100%)`:void 0,O=T?rh(C,.5):void 0,M=U.useRef(null),[V,A]=U.useState(!1),I=mV(K=>{vV(),S(K,n.id)},{threshold:500,cancelOnMovement:25,detect:dc.Touch}),k=h.filter(K=>K.envelopeId===n.id&&K.month===p),z=k.filter(K=>K.type==="Expense"),L=k.filter(K=>K.type==="Income"),B=z.reduce((K,de)=>K+(de.amount||0),0),P=L.reduce((K,de)=>K+(de.amount||0),0),J=Math.max(0,B/P*100),Y=K=>{if(V||b){K.preventDefault(),K.stopPropagation();return}if(r===n.id){K.preventDefault(),K.stopPropagation();return}const de=K.target;if(de.closest(".js-budget-target")||de.tagName==="INPUT"){K.preventDefault(),K.stopPropagation();return}u(`/envelope/${n.id}`)};U.useEffect(()=>{_&&_!==n.id&&A(!1)},[_,n.id]),U.useEffect(()=>{_===n.id&&(A(!0),w(n.id))},[_,n.id,w]),U.useEffect(()=>{if(!_&&V){const K=setTimeout(()=>{A(!1)},300);return()=>clearTimeout(K)}},[_,V]);const H=v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:K=>S(K,n.id),children:v.jsx(vN,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[T&&v.jsx("span",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{borderColor:rh(C,.4),backgroundColor:rh(C,.15),color:C},children:v.jsx(xc,{size:16})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),T&&v.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:C},children:"Piggybank"})]})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"flex items-center gap-x-4",onPointerDown:K=>K.stopPropagation(),children:r===n.id?v.jsxs("div",{className:"flex items-center gap-x-1",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsx("form",{onSubmit:K=>{K.preventDefault(),c()},children:v.jsx("input",{ref:d,type:"number",value:a,onChange:K=>o(K.target.value),onBlur:c,className:"w-24 px-2 py-1 text-sm border rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white",step:"0.01",autoFocus:!0})})]}):v.jsxs("div",{onTouchEnd:K=>{K.preventDefault(),K.stopPropagation(),i(n.id),o(e.toString())},onClick:()=>{i(n.id),o(e.toString())},className:"flex items-center gap-x-1 hover:bg-gray-200 dark:hover:bg-zinc-700 px-3 py-2 rounded transition-colors cursor-pointer js-budget-target",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",e.toFixed(2)]})]})}),v.jsxs("div",{className:"text-right",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 block",children:"Remaining"}),v.jsxs("span",{className:`font-bold ${(typeof t=="number"?t:t.toNumber())<0||100-J<=5?"text-red-500":J>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]})]})]}),e>0&&v.jsx("div",{className:"mt-3",onClick:K=>K.stopPropagation(),children:v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-zinc-400 mb-1",children:[v.jsx("span",{children:"Budget Used"}),v.jsxs("span",{children:[J.toFixed(0),"%"]})]}),v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700 rounded-full h-2 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-J<=5?"bg-red-500":J>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-J,2)}%`}})})]})})]})]}),W=_===n.id;return v.jsx(er.div,{...I(),layout:!W,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":n.id,ref:K=>{m(n.id)(K),M.current=K},onClick:Y,style:{boxShadow:W?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:D,borderColor:O,cursor:W?"grabbing":"pointer",zIndex:W?50:1,scale:W?1.02:1},className:`p-4 rounded-xl active:scale-[0.99] transition-all select-none border group ${T?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:H})},Vte=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,reorderEnvelopes:p,deleteIncomeSource:m,copyFromPreviousMonth:b,setEnvelopeAllocation:_,localOrderRef:w,setLocalEnvelopes:S,localPiggybankOrderRef:T,setLocalPiggybanks:C}=Rte(),{setMonth:D,setIsOnboardingActive:O,isOnboardingCompleted:M,completeOnboarding:V,isOnboardingActive:A}=kn(),{showToast:I}=yl(),k=Ys(),[z,L]=U.useState(!1),[B,P]=U.useState("add"),[J,Y]=U.useState(null),[H,W]=U.useState(!1),[K,de]=U.useState(!1),[te,G]=U.useState(A),$=U.useRef(null);U.useEffect(()=>(O(te),()=>O(!1)),[te,O]);const[Z,ee]=U.useState(null),[le,he]=U.useState(""),se=U.useRef(null);U.useEffect(()=>{if(!u&&!c){const Ce=setTimeout(()=>{if(te)return;if(M){G(!1);const Je=(t[i]||[]).length===0&&(a[i]||[]).length===0,fn=Object.keys(t).some(on=>(t[on]||[]).length>0)||Object.keys(a).some(on=>(a[on]||[]).length>0);de(!!(Je&&fn));return}const Ze=(t[i]||[]).length===0&&(a[i]||[]).length===0,Dt=Object.keys(t).some(Je=>(t[Je]||[]).length>0)||Object.keys(a).some(Je=>(a[Je]||[]).length>0);Ze?Dt?(de(!0),G(!1)):(G(!0),de(!1)):(de(!1),G(!1))},500);return()=>clearTimeout(Ce)}},[u,c,i,t,a,M]),U.useEffect(()=>{Z&&se.current&&se.current.select()},[Z]);const Se=U.useCallback(Ce=>Ze=>{Ze?Ge.current[Ce]=Ze:delete Ge.current[Ce]},[]),Me=U.useCallback(Ce=>Ze=>{Ze?Fe.current[Ce]=Ze:delete Fe.current[Ce]},[]),Ge=U.useRef({}),Ee=U.useRef({}),[ke,ut]=U.useState(null),Le=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),Fe=U.useRef({}),we=U.useRef({}),ze=U.useRef(null),[st,Ne]=U.useState(null),Pe=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),[nt,Qe]=U.useState(!1),Ft=U.useRef(null),rt=U.useRef(!1),bt=U.useRef(nt);U.useEffect(()=>{bt.current=nt},[nt]);const Ot=U.useCallback(()=>Qe(!0),[]),an=U.useCallback(()=>{Qe(!1),rt.current=!1,w.current.length&&p(w.current)},[p]),Bn=U.useCallback(Ce=>{},[]),Or=U.useCallback(Ce=>{bt.current||Z!==Ce&&k(`/envelope/${Ce}`)},[Z,k]),ls=U.useCallback((Ce,Ze)=>{const Dt=Ee.current[Ze]||we.current[Ze];if(Dt){rt.current=!0;const Je=Ce.nativeEvent||Ce;Dt.dragStart(Je)}},[]),_i=U.useCallback(()=>Qe(!0),[]),Xi=U.useCallback(()=>{Qe(!1),rt.current=!1,T.current.length&&p(T.current)},[p]);U.useEffect(()=>{const Ce=()=>{Object.values(we.current).forEach(Je=>Je?.destroy()),we.current={}};if(!e.length)return;const Ze=()=>{e.forEach(Je=>{const fn=Fe.current[Je.id];if(!fn)return;const on=we.current[Je.id];if(on){on.target=fn;return}const Vr=new Bk(ze.current,{target:fn,draggable:!0,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!1,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Vr.on("dragStart",Et=>{if(!rt.current){Et.stop();return}const It=Et.inputEvent.target;if(It.closest(".js-budget-target")||It.tagName==="INPUT"){I("Lock envelope order to edit budget","neutral"),Et.stop();return}const bn=T.current.findIndex(tn=>tn.id===Je.id),jt=Et.target,xt=jt.getBoundingClientRect().height+Yk;Ne(Je.id),Pe.current={activeId:Je.id,startIndex:bn,currentIndex:bn,itemHeight:xt},jt&&(jt.style.transition="none",jt.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",jt.style.zIndex="20"),_i()});let Un=null;Vr.on("drag",Et=>{const It=Et.target;Un!==null&&cancelAnimationFrame(Un),Un=requestAnimationFrame(()=>{const bn=Pe.current;if(bn.activeId!==Je.id)return;const jt=Et.beforeTranslate[1];It.style.transform=`translateY(${jt}px)`,It.style.transition="none";const{itemHeight:xn,startIndex:xt}=bn;if(!xn)return;const tn=Math.round(jt/xn),_n=Kk(xt+tn,0,T.current.length-1);_n!==bn.currentIndex&&(bn.currentIndex=_n,T.current.forEach((xa,Mn)=>{if(xa.id===Je.id)return;const nr=Fe.current[xa.id];if(!nr)return;let Bt=0;xt<_n?Mn>xt&&Mn<=_n&&(Bt=-xn):xt>_n&&Mn>=_n&&Mn<xt&&(Bt=xn),nr.style.transform=Bt?`translateY(${Bt}px)`:"",nr.style.transition="transform 0.2s ease"})),Un=null})}),Vr.on("dragEnd",Et=>{Un!==null&&(cancelAnimationFrame(Un),Un=null);const It=Et.target,bn=Pe.current,{startIndex:jt,currentIndex:xn}=bn;if(It.style.transform="",It.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",It.style.boxShadow="",T.current.forEach(xt=>{if(xt.id===Je.id)return;const tn=Fe.current[xt.id];tn&&(tn.style.transform="",tn.style.transition="")}),jt!==xn){const xt=[...T.current],[tn]=xt.splice(jt,1);xt.splice(xn,0,tn),T.current=xt,C(xt)}setTimeout(()=>{It.style.zIndex="",It.style.transition="",Ne(null)},300),Pe.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},Xi()}),Vr.on("click",Et=>{const It=Et.inputEvent.target;It.closest(".js-budget-target")||It.tagName==="INPUT"||It.tagName==="BUTTON"||Or(Je.id)}),we.current[Je.id]=Vr})},Dt=window.setTimeout(Ze,80);return()=>{clearTimeout(Dt),Ce()}},[e,_i,Xi,Or]),U.useEffect(()=>{const Ce=()=>{Object.values(Ee.current).forEach(Je=>Je?.destroy()),Ee.current={}};if(!n.length)return;const Ze=()=>{n.forEach(Je=>{const fn=Ge.current[Je.id];if(!fn)return;const on=Ee.current[Je.id];if(on){on.target=fn;return}const Vr=new Bk(Ft.current,{target:fn,draggable:!0,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!1,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Vr.on("dragStart",Et=>{if(!rt.current){Et.stop();return}const It=Et.inputEvent.target;if(It.closest(".js-budget-target")||It.tagName==="INPUT"){Et.stop();return}const bn=w.current.findIndex(tn=>tn.id===Je.id),jt=Et.target,xt=jt.getBoundingClientRect().height+Yk;ut(Je.id),Le.current={activeId:Je.id,startIndex:bn,currentIndex:bn,itemHeight:xt},jt&&(jt.style.transition="none",jt.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",jt.style.zIndex="20"),Ot()});let Un=null;Vr.on("drag",Et=>{const It=Et.target;Un!==null&&cancelAnimationFrame(Un),Un=requestAnimationFrame(()=>{const bn=Le.current;if(bn.activeId!==Je.id)return;const jt=Et.beforeTranslate[1];It.style.transform=`translateY(${jt}px)`,It.style.transition="none";const{itemHeight:xn,startIndex:xt}=bn;if(!xn)return;const tn=Math.round(jt/xn),_n=Kk(xt+tn,0,w.current.length-1);_n!==bn.currentIndex&&(bn.currentIndex=_n,w.current.forEach((xa,Mn)=>{if(xa.id===Je.id)return;const nr=Ge.current[xa.id];if(!nr)return;let Bt=0;xt<_n?Mn>xt&&Mn<=_n&&(Bt=-xn):xt>_n&&Mn>=_n&&Mn<xt&&(Bt=xn),nr.style.transform=Bt?`translateY(${Bt}px)`:"",nr.style.transition="transform 0.2s ease"})),Un=null})}),Vr.on("dragEnd",Et=>{Un!==null&&(cancelAnimationFrame(Un),Un=null);const It=Et.target,bn=Le.current,{startIndex:jt,currentIndex:xn}=bn;if(It.style.transform="",It.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",It.style.boxShadow="",w.current.forEach(xt=>{if(xt.id===Je.id)return;const tn=Ge.current[xt.id];tn&&(tn.style.transform="",tn.style.transition="")}),jt!==xn){const xt=[...w.current],[tn]=xt.splice(jt,1);xt.splice(xn,0,tn),w.current=xt,S(xt)}setTimeout(()=>{It.style.zIndex="",It.style.transition="",ut(null)},300),Le.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},an()}),Vr.on("click",()=>{const Et=window.event?.target;Et&&(Et.closest(".js-budget-target")||Et.tagName==="INPUT")||Or(Je.id)}),Ee.current[Je.id]=Vr})},Dt=window.setTimeout(Ze,80);return()=>{clearTimeout(Dt),Ce()}},[n,Ot,an,Or]);const jr=async()=>{if(Z)try{const Ce=parseFloat(le)||0;await _(Z,Ce)}catch(Ce){console.error("Failed to save budget amount:",Ce)}finally{ee(null),he("")}},An=()=>{P("add"),Y(null),L(!0)},dr=Ce=>{$.current&&clearTimeout($.current),!H&&(P("edit"),Y(Ce),L(!0))},sn=Ce=>{$.current&&clearTimeout($.current),W(!0),m(Ce),setTimeout(()=>W(!1),500)},Js=()=>{L(!1),Y(null)},ya=async()=>{de(!1),await b(i)},ba=()=>{V(),G(!1)};return u?v.jsx(zO,{message:d?"Still loading... This is normal on slow connections":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .moveable-control { display: none !important; }
        .moveable-origin { display: none !important; }
        .moveable-line { display: none !important; }
      `}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!te&&v.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(Dte,{currentMonth:i,onMonthChange:Ce=>{de(!1),D(Ce)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((Ce,Ze)=>Ce+Ze.amount,0),totalAllocated:(a[i]||[]).filter(Ce=>n.some(Ze=>Ze.id===Ce.envelopeId)||e.some(Ze=>Ze.id===Ce.envelopeId)).reduce((Ce,Ze)=>Ce+Ze.budgetedAmount,0)}})}),v.jsxs("div",{className:`pt-[calc(${te?"0rem":"7.5rem"}+env(safe-area-inset-top))] pb-[calc(8rem+env(safe-area-inset-bottom))] p-4 max-w-4xl mx-auto space-y-4`,children:[te?v.jsx(Mte,{currentMonth:i,onComplete:ba}):K?v.jsx(Nte,{currentMonth:i,onCopy:ya}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:An,className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:v.jsx(mh,{size:20})})]}),(t[i]||[]).length===0?v.jsx("div",{className:"text-center py-6",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm",children:"No income sources yet. Add your monthly income."})}):v.jsx("div",{className:"space-y-3",children:v.jsx(ri,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(Ce=>v.jsx(er.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(vy,{onDelete:()=>sn(Ce),children:v.jsxs("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>dr(Ce),children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Ce.name}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Monthly income"})]}),v.jsxs("p",{className:"font-semibold text-green-600 dark:text-emerald-400",children:["$",Ce.amount.toFixed(2)]})]})})},Ce.id))})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Spending Envelopes"}),v.jsx("button",{onClick:()=>k("/add-envelope"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Envelope",children:v.jsx(mh,{size:20})})]}),n.length===0?v.jsxs("div",{className:"text-center py-6",children:[v.jsx(_v,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:n.length===0?"No envelopes added to this month. Copy from previous month or add new ones.":"No envelopes yet. Create one to get started."}),v.jsx("button",{onClick:()=>k("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]}):v.jsx("div",{ref:Ft,children:v.jsx(ri,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:n.map(Ce=>{const Dt=(a[i]||[]).find(fn=>fn.envelopeId===Ce.id)?.budgetedAmount||0,Je=h(Ce.id);return v.jsx(jte,{env:Ce,budgetedAmount:Dt,remainingBalance:Je,editingEnvelopeId:Z,setEditingEnvelopeId:ee,editingAmount:le,setEditingAmount:he,handleBudgetSave:jr,navigate:k,inputRef:se,transactions:o,currentMonth:i,setMoveableRef:Se,isReorderingActive:nt,activelyDraggingId:ke,onItemDragStart:Bn,onLongPressTrigger:ls},Ce.id)})})})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[v.jsx(xc,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Piggybanks"]}),v.jsx("button",{onClick:()=>k("/add-envelope?type=piggybank"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Piggybank",children:v.jsx(mh,{size:20})})]}),e.length>0?v.jsx("div",{ref:ze,className:"relative",children:v.jsx(ri,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:e.map(Ce=>v.jsx(Ote,{piggybank:Ce,balance:h(Ce.id),onNavigate:Ze=>k(`/envelope/${Ze}`),setMoveableRef:Me(Ce.id),isReorderingActive:nt,activelyDraggingId:st,onItemDragStart:()=>{},onLongPressTrigger:ls},Ce.id))})})}):v.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-zinc-400",children:[v.jsx(xc,{size:48,className:"mx-auto mb-3 opacity-30"}),v.jsx("p",{className:"text-sm",children:"No piggybanks yet"}),v.jsx("p",{className:"text-xs mt-1",children:"Click the + button above to create your first piggybank"})]})]})]}),v.jsx(kte,{isVisible:z,onClose:Js,mode:B,initialIncomeSource:J})]})]})]})},zte=[],kV=({selectedCard:n,onCardSelect:e,initialCards:t=zte,disabled:r=!1,isUserSelected:i=!1})=>{const a=kn(L=>L.appSettings),o=kn(L=>L.updateAppSettings),[c,u]=U.useState(t.length>0?t[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=U.useState(!1),[p,m]=U.useState(!1),[b,_]=U.useState(t),[w,S]=U.useState(null),[T,C]=U.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"});U.useEffect(()=>{a?.paymentSources&&(_(a.paymentSources),a.paymentSources.length>0&&!n&&u(a.paymentSources[0]))},[a,n]);const D=n||c;U.useEffect(()=>{!n&&e&&b.length>0&&e(b[0])},[n,e,b]);const O=L=>{r||(L.id==="add-new"?m(!0):(u(L),e?.(L),h(!1)))},M=()=>{r||h(!d)},V=L=>{r||S(L)},A=async()=>{if(w&&!r){const L=b.filter(B=>B.id!==w.id);if(_(L),D?.id===w.id){const B=L.length>0?L[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(B),e?.(B)}S(null),h(!1);try{await o({paymentSources:L})}catch(B){console.error("Failed to delete card from app settings:",B),_(b),alert("Failed to delete card. Please try again.");return}}},I=()=>{S(null)},k=async()=>{if(r)return;if(T.last4.length!==4||!/^\d{4}$/.test(T.last4)){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a card name");return}const L={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:T.last4,color:T.color},B=[...b,L];_(B),u(L),e?.(L),m(!1),h(!1);try{await o({paymentSources:B})}catch(P){console.error("Failed to save card to app settings:",P),_(b),u(D),alert("Failed to save card. Please try again.");return}C({name:"",network:"Visa",last4:"",color:"#3b82f6"})},z=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:M,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:D.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:D.network}),v.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",D.last4]})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:D.name}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(...",D.last4,")"]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsx("div",{className:"card-stack-dropdown",children:v.jsx("div",{className:"card-stack",children:v.jsx(ri,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((L,B)=>{const P=D.id===L.id,J=L.id==="add-new";return v.jsx(er.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(vy,{onDelete:()=>!J&&!r&&V(L),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${P?"selected":""} ${J?"add-new-card":""}`,onClick:()=>O(L),style:{backgroundColor:J?"#f3f4f6":L.color,color:J?"#374151":L.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-B},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:J?"":L.network}),P&&!J&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:L.name}),v.jsx("div",{className:"card-number",children:J?"":` ${L.last4}`})]}),J&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},L.id)})})})})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),v.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Name"}),v.jsx("input",{type:"text",value:T.name,onChange:L=>C({...T,name:L.target.value}),placeholder:"e.g., My Chase Card",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),v.jsxs("select",{value:T.network,onChange:L=>C({...T,network:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:L=>C({...T,last4:L.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:z.map(L=>v.jsx("button",{onClick:()=>C({...T,color:L}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===L?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:L}},L))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",T.last4||"0000"]})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:k,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add Card"})]})]})]})}),w&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:w.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:A,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},NV=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=kn(),[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState(""),[w,S]=U.useState(new Date().toISOString().split("T")[0]),[T,C]=U.useState(null);U.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),C(i.paymentMethod||null);try{const A=new Date(i.date);isNaN(A.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(A.toISOString().split("T")[0])}catch(A){console.error("Error parsing transaction date:",A),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),S(new Date().toISOString().split("T")[0])},[n,t,i]);const D=async A=>{A.preventDefault();const I=parseFloat(d);if(isNaN(I)||I<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:I,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),z=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(z!==u){const L=`This transaction date (${z}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(L))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},O=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},M=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",V=t==="add"?"text-green-500":"text-red-500";return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(er.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(er.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:M}),v.jsx("button",{onClick:D,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0,children:"Save"})]}),v.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${V}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:A=>{const I=A.target.value.replace(/\D/g,"");if(!I){h("");return}const z=(parseInt(I,10)/100).toFixed(2);h(z)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${V} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(kV,{selectedCard:T,onCardSelect:C}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:A=>_(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(w);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(ed,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:w,onChange:A=>{console.log("Date changed to:",A.target.value),S(A.target.value)},required:!0,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),t==="edit"&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:O,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(yN,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},Lte=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=kn(),[a,o]=U.useState(""),[c,u]=U.useState(""),[d,h]=U.useState(""),[p,m]=U.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==t.id);U.useEffect(()=>{if(!n)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[n]);const _=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(S=>S.id===a);return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(er.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(er.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>v.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const D=(parseInt(T,10)/100).toFixed(2);u(D)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},Bte=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},Ute=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},MV=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:Bte(n.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",Ute(n.amount)]}),t?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?v.jsx(za,{className:"text-green-500",size:20}):v.jsx(S2,{className:"text-gray-400",size:20})}):v.jsx("span",{children:n.reconciled?v.jsx(za,{className:"text-green-500",size:20}):v.jsx(S2,{className:"text-gray-400",size:20})})]})]})},Fte=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Gte=()=>{const{id:n}=oz(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p}=kn(),{showToast:m}=yl(),b=Ys(),_=va(),[w,S]=U.useState(!1),[T,C]=U.useState(!1),[D,O]=U.useState(!1),[M,V]=U.useState(null);U.useEffect(()=>{e.length===0&&r()},[]);const A=e.find(B=>B.id===n);if(!A)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(A.isPiggybank){const B=t.filter(P=>P.envelopeId===A.id);console.log(" Piggybank:",A.name),console.log(" Created at:",A.createdAt),console.log(" Transactions:",B.map(P=>({date:P.date,description:P.description,amount:P.amount})))}const I=t.filter(B=>B.envelopeId===A.id).filter(B=>{if(A.isPiggybank){if((B.description==="Monthly Allocation"||B.description==="Piggybank Contribution")&&B.isAutomatic||!A.createdAt)return!0;const P=new Date(A.createdAt);return new Date(B.date)>=P}return B.month===p||!B.month}).sort((B,P)=>new Date(P.date).getTime()-new Date(B.date).getTime()),k=()=>{_.state?.fromGlobalFAB?b("/"):b(-1)},z=()=>{n&&(a(n),b(-1))},L=B=>{const P={...B,reconciled:!B.reconciled};c(P)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{const B=prompt("Rename envelope:",A.name);B&&B.trim()&&n&&o(n,B)},className:"text-blue-600 dark:text-blue-400 font-medium",children:"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:A.name}),v.jsx("button",{onClick:k,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsx("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const B=A.isPiggybank?h(A.id):h(A.id,p);return console.log(`Debug: Envelope ${A.name} Balance:`,B),v.jsx("span",{className:`text-xl font-bold ${B<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:Fte(B)})})()]})}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>S(!0),children:[v.jsx(IL,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>C(!0),children:[v.jsx(AL,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>O(!0),children:[v.jsx(dL,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:I.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(ri,{initial:!1,mode:"popLayout",children:I.map(B=>v.jsx(er.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(vy,{onDelete:()=>{if(!B.id)return;const P={...B};u(B.id),m("Transaction deleted","neutral",()=>d(P))},children:v.jsx(MV,{transaction:B,onReconcile:()=>L(B),onEdit:()=>V(B)})})},B.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const B=A.isPiggybank?`Are you sure you want to delete "${A.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${A.name}" from ${p}? This will delete all transactions for this month only.`;confirm(B)&&z()},children:[v.jsx(yN,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(NV,{isVisible:w||T||!!M,onClose:()=>{S(!1),C(!1),V(null)},mode:w?"add":T?"spend":"edit",currentEnvelope:A,initialTransaction:M}),v.jsx(Lte,{isVisible:D,onClose:()=>O(!1),sourceEnvelope:A})]})},qte=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=U.useState(""),[b,_]=U.useState("confirm"),w=C=>{const[D,O]=C.split("-");return new Date(parseInt(D),parseInt(O)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},S=()=>{b==="confirm"?_("type"):b==="type"&&p==="START FRESH"&&t()},T=()=>{_("confirm"),m(""),e()};return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(er.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(er.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",w(r)]}),v.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:b==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"You can undo this action within 30 seconds if you change your mind."})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-sm text-gray-900 dark:text-white mb-4",children:["Type ",v.jsx("strong",{children:"START FRESH"})," to confirm:"]}),v.jsx("input",{type:"text",value:p,onChange:C=>m(C.target.value),placeholder:"START FRESH",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent dark:bg-zinc-800 dark:text-white text-center font-mono text-lg",autoFocus:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500 text-center",children:"This action cannot be undone after 30 seconds"})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:T,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:S,disabled:h||b==="type"&&p!=="START FRESH",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":b==="confirm"?"Continue":"Start Fresh"})]})]})]})})},Hte=()=>{const n=Ys(),e=U.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:_,resetOnboarding:w}=kn(),{deleteAccount:S,currentUser:T,logout:C}=ca(),[D,O]=U.useState(null),[M,V]=U.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[A,I]=U.useState(!1),[k,z]=U.useState(""),[L,B]=U.useState(!1),[P,J]=U.useState(!1),[Y,H]=U.useState(null),[W,K]=U.useState(!1),[de,te]=U.useState(!1),G=978307200,$=c?.theme??"system";U.useEffect(()=>{c||d().catch(we=>{console.error("Failed to initialize app settings:",we)})},[d,c]);const Z=(we,ze)=>{O({type:we,text:ze}),setTimeout(()=>O(null),3500)},ee=U.useMemo(()=>{const we=t.length,ze=r.length,st=m?p[m]||[]:[],Ne=Object.values(h).reduce((bt,Ot)=>bt+Ot.length,0),Pe=st.length,nt=t.reduce((bt,Ot)=>{const an=o(Ot.id);return bt+(typeof an=="number"?an:0)},0),Qe=0,Ft=r.reduce((bt,Ot)=>{let an=0;if(typeof Ot.date=="string"){const Bn=Date.parse(Ot.date);an=Number.isNaN(Bn)?0:Bn}else typeof Ot.date=="number"&&(an=Ot.date<2e9?(Ot.date+G)*1e3:Ot.date);return Math.max(bt,an)},0),rt=Qe||Ft?new Date(Math.max(Qe,Ft)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:we,transactionCount:ze,incomeSourceCount:Ne,allocationCount:Pe,totalBalance:nt,lastUpdated:rt}},[t,r,h,p,m]),le=()=>{try{console.log(" Creating backup...");const we={appVersion:"1.5.10",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(nt=>({...nt,currentBalance:(()=>{const Qe=o(nt.id);return typeof Qe=="number"?Qe:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},ze=new Blob([JSON.stringify(we,null,2)],{type:"application/json"}),st=URL.createObjectURL(ze),Ne=document.createElement("a");Ne.href=st,Ne.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne),URL.revokeObjectURL(st);const Pe=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",Pe),V(Pe),H({success:!0,message:"Backup downloaded successfully."})}catch(we){console.error(we),H({success:!1,message:"Failed to create backup file.",onRetry:le})}},he=()=>{J(!0),H(null);try{const we=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],ze=r.map(Qe=>{const Ft=t.find(Or=>Or.id===Qe.envelopeId)?.name||"Unknown",rt=(Qe.merchant||"").replace(/"/g,'""'),bt=(Qe.description||"").replace(/"/g,'""');let Ot="";Qe.paymentMethod&&(Ot=`${Qe.paymentMethod.name} (...${Qe.paymentMethod.last4})`);const an=Ot.replace(/"/g,'""');let Bn="Invalid Date";if(Qe.date){if(typeof Qe.date=="string")Bn=Qe.date.split("T")[0];else if(typeof Qe.date=="number"){const Or=Qe.date<2e9?(Qe.date+G)*1e3:Qe.date;Bn=new Date(Or).toISOString().split("T")[0]}}return[Bn,`"${rt}"`,`"${an}"`,`"${bt}"`,Qe.amount.toFixed(2),Qe.type,`"${Ft}"`,Qe.reconciled?"Yes":"No"].join(",")}),st=[we.join(","),...ze].join(`
`),Ne=new Blob([st],{type:"text/csv;charset=utf-8;"}),Pe=URL.createObjectURL(Ne),nt=document.createElement("a");nt.href=Pe,nt.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),URL.revokeObjectURL(Pe),H({success:!0,message:"Transactions CSV exported successfully."})}catch(we){console.error(we),H({success:!1,message:"Failed to export CSV. Please try again.",onRetry:he})}finally{J(!1)}},se=()=>{e.current?.click()},Se=we=>{const ze=we.target.files?.[0];if(!ze)return;const st=new FileReader;st.onload=async Ne=>{try{const Pe=JSON.parse(Ne.target?.result),nt=await a(Pe);if(!nt.success){Z("error",nt.message);return}if(Pe.appSettings?.theme)try{await u({theme:Pe.appSettings.theme})}catch(Qe){console.error("Failed to update imported settings:",Qe)}Z("success",`Loaded ${Pe.envelopes?.length??0} envelopes, ${Pe.transactions?.length??0} transactions.`)}catch(Pe){console.error(Pe),Z("error","Invalid backup file. Please verify the JSON.")}},st.readAsText(ze),we.target.value=""},Me=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),Z("success","All data has been permanently deleted."),n("/")}catch(we){console.error("Reset failed:",we),Z("error","Failed to delete all data. Some data may remain.")}},Ge=async()=>{if(!k.trim()){Z("error","Please enter your password to confirm account deletion.");return}I(!0);try{await i(),await S(k)?Z("success","Your account has been permanently deleted."):Z("error","Failed to delete account. Please try again.")}catch(we){console.error("Account deletion failed:",we),Z("error","Failed to delete account. Please try again.")}finally{I(!1),B(!1),z("")}},Ee=async()=>{if(!T){Z("error","You must be logged in to clean up data.");return}K(!0);try{const we=await zS.cleanupOrphanedData(T.id),ze=we.orphanedAllocationsDeleted+we.orphanedTransactionsDeleted;ze>0?Z("success",`Cleaned ${ze} orphaned items: ${we.orphanedAllocationsDeleted} allocations and ${we.orphanedTransactionsDeleted} transactions.`):Z("success","No orphaned data found. Your database is already clean!")}catch(we){console.error("Cleanup failed:",we),Z("error","Failed to clean up orphaned data. Please try again.")}finally{K(!1)}},ke=()=>{te(!0)},ut=async()=>{te(!1),await b(m),Z("success","Month data has been reset.")},Le=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{_(),C(),n("/")}catch(we){console.error("Logout failed:",we)}},Fe=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[D&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${D.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[D.type==="success"?v.jsx(w1,{size:18}):v.jsx(S1,{size:18}),D.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:Fe}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:Le,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(e9,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(A2,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ee.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ee.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ee.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ee.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[$==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),$==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),$==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:$})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(we=>v.jsx("button",{onClick:async()=>{try{await u({theme:we.value})}catch(ze){console.error("Failed to update theme setting:",ze)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${$===we.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:we.label},we.value))})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{w(),n("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Bh,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:le,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(A2,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",M]})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:se,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(_9,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsx("div",{className:"p-4",children:v.jsxs("button",{onClick:he,disabled:P,className:"w-full flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed rounded-xl border border-gray-100 dark:border-zinc-800 px-4 py-3 bg-white dark:bg-zinc-900",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[P?v.jsx(C2,{className:"text-blue-500 animate-spin",size:20}):v.jsx(BL,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:P?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]})}),v.jsx("input",{type:"file",ref:e,onChange:Se,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:ke,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Lh,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ee,disabled:W,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[W?v.jsx(C2,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(Bh,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:W?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Me,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(S1,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>B(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(ed,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(Cs,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.5.10"," (PWA)"]}),"        "]}),Y&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Y.success?v.jsx(w1,{className:"text-green-500",size:24}):v.jsx(ed,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:Y.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:Y.message}),v.jsxs("div",{className:"flex gap-2",children:[Y.onRetry&&v.jsx("button",{onClick:()=>{H(null),Y.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>H(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(qte,{isVisible:de,onClose:()=>te(!1),onConfirm:ut,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((we,ze)=>we+ze.amount,0),allocationCount:(p[m]||[]).filter(we=>t.some(ze=>ze.id===we.envelopeId)).length,totalAllocated:(p[m]||[]).filter(we=>t.some(ze=>ze.id===we.envelopeId)).reduce((we,ze)=>we+ze.budgetedAmount,0),transactionCount:r.filter(we=>we.month===m).length,totalTransactionAmount:r.filter(we=>we.month===m).reduce((we,ze)=>we+ze.amount,0)}),L&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(ed,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:k,onChange:we=>z(we.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{B(!1),z("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:Ge,disabled:A||!k.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?"Deleting...":"Delete Account"})]})]})})]})]})},$te=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t}=kn(),{showToast:r}=yl(),i=Ys(),[a]=Zz(),[o,c]=U.useState(""),u=a.get("type")==="piggybank",[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState("#3B82F6"),[w,S]=U.useState(!1),T=async C=>{if(C.preventDefault(),!o.trim()||w)return;S(!0);const D=kn.getState().envelopes,M=(D.length>0?Math.max(...D.map(k=>k.orderIndex??0)):-1)+1,V=u?new Date(`${t}-01T00:00:00`):new Date,A={name:o,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:V.toISOString(),isActive:!0,orderIndex:M};if(u){A.isPiggybank=!0;const k={monthlyContribution:parseFloat(p||"0"),color:b,icon:"piggy-bank"};d&&parseFloat(d)>0&&(k.targetAmount=parseFloat(d)),A.piggybankConfig=k}n(A).then(k=>{if(k){const z=u?parseFloat(p||"0"):0;e(k,z).catch(L=>console.error("Failed to create allocation:",L)),setTimeout(()=>{i("/")},50)}}).catch(k=>{console.error("Failed to create envelope:",k),r(k.message||"Failed to create envelope","error"),S(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>i("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(od,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:u?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:u?v.jsx(xc,{size:40}):v.jsx(FL,{size:40})})}),v.jsxs("form",{onSubmit:T,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:u?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:o,onChange:C=>c(C.target.value),placeholder:u?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),u&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:p,onChange:C=>m(C.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:u})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:d,onChange:C=>h(C.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(C=>v.jsx("button",{type:"button",onClick:()=>_(C.value),className:`w-full aspect-square rounded-lg transition-all ${b===C.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:C.value},title:C.label},C.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>i("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!o.trim()||u&&!p||w,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${o.trim()&&(!u||p)&&!w?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:w?"Creating...":u?"Create Piggybank":"Create Envelope"})]})]})]})})]})},Yte=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=U.useState([]),[a,o]=U.useState({}),[c,u]=U.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(S=>S!==_):[...w,_])},h=(_,w)=>{o(S=>({...S,[_]:w}))};U.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),U.useEffect(()=>{const _=Object.values(a).reduce((w,S)=>w+(S||0),0);u(e-_),t(a)},[a,e,t]),U.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return v.jsxs("div",{className:"space-y-3",children:[r.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&v.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},PV=({onClose:n,onSaved:e})=>{const t=Ys(),{envelopes:r,addTransaction:i,currentMonth:a}=kn(),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(()=>{const Y=new Date;return new Date(Y.getTime()-Y.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[_,w]=U.useState("expense"),[S,T]=U.useState({}),[C,D]=U.useState(null),[O,M]=U.useState(!1),V=()=>{if(n){n();return}t(-1)},A=Y=>{D(Y),C&&M(!0)},I=Object.keys(S).length>0,k=Object.values(S).reduce((Y,H)=>Y+(H||0),0),z=Math.abs(k-parseFloat(o||"0"))<.01,L=o&&parseFloat(o)>0&&I&&z,B=async Y=>{if(Y.preventDefault(),!L)return;const[H,W,K]=m.split("-").map(Number),de=new Date(H,W-1,K,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",de.toISOString());try{const[te,G]=m.split("-").map(Number),$=`${te}-${G.toString().padStart(2,"0")}`;if($!==a){const ee=`This transaction date (${$}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(ee))return}const Z=Object.entries(S).filter(([ee,le])=>le>0);Promise.all(Z.map(([ee,le])=>i({amount:le,description:h,merchant:u||void 0,date:de.toISOString(),envelopeId:ee,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:C||void 0}).catch(he=>console.error("Failed to create transaction:",he)))).catch(ee=>console.error("Failed to create transactions:",ee)),e&&e(),n?n():t("/")}catch(te){console.error("Error saving transaction:",te),alert("Failed to save transaction: "+(te instanceof Error?te.message:"Unknown error"))}},P=[...r].filter(Y=>Y.isActive!==!1).sort((Y,H)=>{const W=Y.orderIndex??0,K=H.orderIndex??0;return W!==K?W-K:Y.name.localeCompare(H.name)}),J=_==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:V,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:B,disabled:!L,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:B,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${J}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:o,onChange:Y=>{const H=Y.target.value.replace(/\D/g,"");if(!H){c("");return}const K=(parseInt(H,10)/100).toFixed(2);c(K)},onKeyDown:Y=>{(Y.key==="e"||Y.key==="E"||Y.key==="+"||Y.key==="-")&&Y.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${J} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:u,onChange:Y=>d(Y.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(kV,{selectedCard:C,onCardSelect:A,isUserSelected:O}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:h,onChange:Y=>p(Y.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[Y,H]=m.split("-").map(Number);return`${Y}-${H.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(ed,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:m,onChange:Y=>b(Y.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(Yte,{envelopes:P,transactionAmount:parseFloat(o)||0,onSplitChange:T})})]})})]})},Kte=()=>{const n=Ys(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o,appSettings:c}=kn(),{showToast:u}=yl(),[d,h]=U.useState(!1),[p,m]=U.useState(""),[b,_]=U.useState("all"),[w,S]=U.useState("All"),[T,C]=U.useState(!1),[D,O]=U.useState("all"),[M,V]=U.useState(!1),[A,I]=U.useState("all"),[k,z]=U.useState(!1),[L,B]=U.useState(()=>{const te=new Date;return te.setMonth(te.getMonth()-1),te.toISOString().split("T")[0]}),[P,J]=U.useState(()=>new Date().toISOString().split("T")[0]),[Y,H]=U.useState(null),W=U.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:M,currentMonth:o,transactionMonths:e.map($=>({id:$.id,month:$.month,date:$.date,description:$.description}))});let te=e;return M||(te=e.filter($=>$.month===o||!$.month),console.log(" After month filter:",{remaining:te.length,currentMonth:o,filteredTransactions:te.map($=>({id:$.id,description:$.description,month:$.month,matchesCurrentMonth:$.month===o}))})),te.map($=>{if(!$)return null;let Z=$.date;if(typeof $.date=="number"){const le=($.date+978307200)*1e3;Z=new Date(le).toISOString()}else if(!$.date||typeof $.date!="string")return null;return{...$,date:Z}}).filter(Boolean).filter($=>{if(p){const ee=p.toLowerCase(),le=t.find(Se=>Se.id===$.envelopeId)?.name.toLowerCase()||"",he=$.amount.toFixed(2);if(!($.description.toLowerCase().includes(ee)||le.includes(ee)||he.includes(ee)))return!1}if(b!=="all"&&$.envelopeId!==b||w!=="All"&&$.type!==w||A!=="all"&&(!$.paymentMethod||$.paymentMethod.id!==A)||!$.date||typeof $.date!="string")return!1;const Z=$.date.split("T")[0];return!(k&&(Z<L||Z>P)||D!=="all"&&new Date(Z).getMonth()!==parseInt(D)||T&&!$.reconciled)}).sort(($,Z)=>new Date(Z.date).getTime()-new Date($.date).getTime())},[e,t,p,b,w,A,L,P,T,M,o,k]);console.log(" Final filtered transactions:",{count:W.length,transactions:W.map(te=>({id:te.id,description:te.description,amount:te.amount,date:te.date,month:te.month,type:te.type}))});const K=Y?t.find(te=>te.id===Y.envelopeId):null,de=te=>{const G={...te,reconciled:!te.reconciled};r(G)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(od,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(qL,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>V(!M),className:`text-sm px-3 py-1 rounded-md ${M?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:M?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(l9,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:te=>m(te.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(wv,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:A,onChange:te=>I(te.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(te=>v.jsx("option",{value:te.id,children:te.name},te.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:te=>_(te.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),t.sort((te,G)=>te.name.localeCompare(G.name)).map(te=>v.jsx("option",{value:te.id,children:te.name},te.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(te=>v.jsx("button",{onClick:()=>S(te),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${w===te?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:te},te))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:D,onChange:te=>O(te.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(te,G)=>G).map(te=>v.jsx("option",{value:te,children:new Date(2022,te).toLocaleString("default",{month:"long"})},te))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>z(!k),className:`w-9 h-5 rounded-full transition-colors relative ${k?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${k?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${k?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:L,onChange:te=>B(te.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:P,onChange:te=>J(te.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>C(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>V(!M),className:`w-11 h-6 rounded-full transition-colors relative ${M?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${M?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:W.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(ri,{initial:!1,mode:"popLayout",children:W.map(te=>{const G=t.find($=>$.id===te.envelopeId);return v.jsx(er.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(vy,{onDelete:()=>{if(!te.id)return;const $={...te};i(te.id),u("Transaction deleted","neutral",()=>a($))},children:v.jsx(MV,{transaction:te,envelopeName:G?.name||"Unknown Envelope",onReconcile:()=>de(te),onEdit:()=>{G?H(te):alert("Cannot edit: Envelope deleted.")}})})},te.id)})})})}),v.jsx(NV,{isVisible:!!Y&&!!K,onClose:()=>H(null),mode:"edit",currentEnvelope:K||{},initialTransaction:Y})]})},Yl=({children:n})=>v.jsx(er.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),Xte=()=>{const n=va();return v.jsx(ri,{mode:"wait",children:v.jsxs(wz,{location:n,children:[v.jsx(zo,{path:"/",element:v.jsx(Yl,{children:v.jsx(Ua,{children:v.jsx(Vte,{})})})}),v.jsx(zo,{path:"/envelope/:id",element:v.jsx(Yl,{children:v.jsx(Ua,{children:v.jsx(Gte,{})})})}),v.jsx(zo,{path:"/add-envelope",element:v.jsx(Yl,{children:v.jsx(Ua,{children:v.jsx($te,{})})})}),v.jsx(zo,{path:"/add-transaction",element:v.jsx(Yl,{children:v.jsx(Ua,{children:v.jsx(PV,{})})})}),v.jsx(zo,{path:"/transactions",element:v.jsx(Yl,{children:v.jsx(Ua,{children:v.jsx(Kte,{})})})}),v.jsx(zo,{path:"/settings",element:v.jsx(Yl,{children:v.jsx(Ua,{children:v.jsx(Hte,{})})})}),v.jsx(zo,{path:"/verify-email",element:v.jsx(Yl,{children:v.jsx(Ua,{children:v.jsx(VO,{})})})})]},n.pathname)})};function Wte(){const[n,e]=U.useState(!0),[t,r]=U.useState(!1),{appSettings:i,isOnboardingActive:a}=kn(),{isAuthenticated:o,isInitialized:c,initializeAuth:u,lastAuthTime:d,offlineGracePeriod:h,currentUser:p}=ca();if(U.useEffect(()=>{const _=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(_)},[]),U.useEffect(()=>u(),[u]),U.useEffect(()=>{const _=document.documentElement,w=window.matchMedia("(prefers-color-scheme: dark)"),S=()=>{const T=i?.theme??"system",C=w.matches;T==="dark"||T==="system"&&C?_.classList.add("dark"):_.classList.remove("dark")};if(S(),i?.theme==="system")return w.addEventListener("change",S),()=>w.removeEventListener("change",S)},[i]),n||!c)return v.jsx(zO,{message:"Initializing Personal Budget..."});if(!o)return p?v.jsx(Ua,{children:v.jsx(VO,{})}):v.jsx(Ua,{children:v.jsx(bH,{})});const b=typeof navigator<"u"&&!navigator.onLine&&o&&d&&Date.now()-d<h;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Ua,{children:[b&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((h-(Date.now()-d))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(Yz,{children:[v.jsx(Xte,{}),t&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(PV,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!a&&v.jsx(iW,{onAddTransaction:()=>r(!0)})]}),v.jsx(rW,{})]})]})}S6({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});_6.createRoot(document.getElementById("root")).render(v.jsx(U.StrictMode,{children:v.jsx(Wte,{})}));export{vt as T,mt as a,hH as b,MR as c,Ut as d,Vi as e,Fa as f,jx as g,Ga as h,Bp as o,Fs as q,sa as s,Zl as t,Ba as u,cH as w};
