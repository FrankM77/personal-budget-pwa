(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function vz(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var yx={exports:{}},Hf={};var f2;function yz(){if(f2)return Hf;f2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Hf.Fragment=e,Hf.jsx=t,Hf.jsxs=t,Hf}var h2;function bz(){return h2||(h2=1,yx.exports=yz()),yx.exports}var v=bz(),bx={exports:{}},ot={};var p2;function xz(){if(p2)return ot;p2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(G,Y,re){this.props=G,this.context=Y,this.refs=S,this.updater=re||_}T.prototype.isReactComponent={},T.prototype.setState=function(G,Y){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,Y,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function C(){}C.prototype=T.prototype;function R(G,Y,re){this.props=G,this.context=Y,this.refs=S,this.updater=re||_}var O=R.prototype=new C;O.constructor=R,w(O,T.prototype),O.isPureReactComponent=!0;var P=Array.isArray;function M(){}var A={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(G,Y,re){var Z=re.ref;return{$$typeof:n,type:G,key:Y,ref:Z!==void 0?Z:null,props:re}}function z(G,Y){return k(G.type,Y,G.props)}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function B(G){var Y={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(re){return Y[re]})}var j=/\/+/g;function X(G,Y){return typeof G=="object"&&G!==null&&G.key!=null?B(""+G.key):Y.toString(36)}function H(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(M,M):(G.status="pending",G.then(function(Y){G.status==="pending"&&(G.status="fulfilled",G.value=Y)},function(Y){G.status==="pending"&&(G.status="rejected",G.reason=Y)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function $(G,Y,re,Z,le){var fe=typeof G;(fe==="undefined"||fe==="boolean")&&(G=null);var xe=!1;if(G===null)xe=!0;else switch(fe){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(G.$$typeof){case n:case e:xe=!0;break;case h:return xe=G._init,$(xe(G._payload),Y,re,Z,le)}}if(xe)return le=le(G),xe=Z===""?"."+X(G,0):Z,P(le)?(re="",xe!=null&&(re=xe.replace(j,"$&/")+"/"),$(le,Y,re,"",function(Ge){return Ge})):le!=null&&(V(le)&&(le=z(le,re+(le.key==null||G&&G.key===le.key?"":(""+le.key).replace(j,"$&/")+"/")+xe)),Y.push(le)),1;xe=0;var ve=Z===""?".":Z+":";if(P(G))for(var Ce=0;Ce<G.length;Ce++)Z=G[Ce],fe=ve+X(Z,Ce),xe+=$(Z,Y,re,fe,le);else if(Ce=b(G),typeof Ce=="function")for(G=Ce.call(G),Ce=0;!(Z=G.next()).done;)Z=Z.value,fe=ve+X(Z,Ce++),xe+=$(Z,Y,re,fe,le);else if(fe==="object"){if(typeof G.then=="function")return $(H(G),Y,re,Z,le);throw Y=String(G),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return xe}function W(G,Y,re){if(G==null)return G;var Z=[],le=0;return $(G,Z,"","",function(fe){return Y.call(re,fe,le++)}),Z}function ee(G){if(G._status===-1){var Y=G._result;Y=Y(),Y.then(function(re){(G._status===0||G._status===-1)&&(G._status=1,G._result=re)},function(re){(G._status===0||G._status===-1)&&(G._status=2,G._result=re)}),G._status===-1&&(G._status=0,G._result=Y)}if(G._status===1)return G._result.default;throw G._result}var he=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},K={map:W,forEach:function(G,Y,re){W(G,function(){Y.apply(this,arguments)},re)},count:function(G){var Y=0;return W(G,function(){Y++}),Y},toArray:function(G){return W(G,function(Y){return Y})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return ot.Activity=p,ot.Children=K,ot.Component=T,ot.Fragment=t,ot.Profiler=i,ot.PureComponent=R,ot.StrictMode=r,ot.Suspense=u,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ot.__COMPILER_RUNTIME={__proto__:null,c:function(G){return A.H.useMemoCache(G)}},ot.cache=function(G){return function(){return G.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(G,Y,re){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var Z=w({},G.props),le=G.key;if(Y!=null)for(fe in Y.key!==void 0&&(le=""+Y.key),Y)!I.call(Y,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&Y.ref===void 0||(Z[fe]=Y[fe]);var fe=arguments.length-2;if(fe===1)Z.children=re;else if(1<fe){for(var xe=Array(fe),ve=0;ve<fe;ve++)xe[ve]=arguments[ve+2];Z.children=xe}return k(G.type,le,Z)},ot.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},ot.createElement=function(G,Y,re){var Z,le={},fe=null;if(Y!=null)for(Z in Y.key!==void 0&&(fe=""+Y.key),Y)I.call(Y,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(le[Z]=Y[Z]);var xe=arguments.length-2;if(xe===1)le.children=re;else if(1<xe){for(var ve=Array(xe),Ce=0;Ce<xe;Ce++)ve[Ce]=arguments[Ce+2];le.children=ve}if(G&&G.defaultProps)for(Z in xe=G.defaultProps,xe)le[Z]===void 0&&(le[Z]=xe[Z]);return k(G,fe,le)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(G){return{$$typeof:c,render:G}},ot.isValidElement=V,ot.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:ee}},ot.memo=function(G,Y){return{$$typeof:d,type:G,compare:Y===void 0?null:Y}},ot.startTransition=function(G){var Y=A.T,re={};A.T=re;try{var Z=G(),le=A.S;le!==null&&le(re,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(M,he)}catch(fe){he(fe)}finally{Y!==null&&re.types!==null&&(Y.types=re.types),A.T=Y}},ot.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ot.use=function(G){return A.H.use(G)},ot.useActionState=function(G,Y,re){return A.H.useActionState(G,Y,re)},ot.useCallback=function(G,Y){return A.H.useCallback(G,Y)},ot.useContext=function(G){return A.H.useContext(G)},ot.useDebugValue=function(){},ot.useDeferredValue=function(G,Y){return A.H.useDeferredValue(G,Y)},ot.useEffect=function(G,Y){return A.H.useEffect(G,Y)},ot.useEffectEvent=function(G){return A.H.useEffectEvent(G)},ot.useId=function(){return A.H.useId()},ot.useImperativeHandle=function(G,Y,re){return A.H.useImperativeHandle(G,Y,re)},ot.useInsertionEffect=function(G,Y){return A.H.useInsertionEffect(G,Y)},ot.useLayoutEffect=function(G,Y){return A.H.useLayoutEffect(G,Y)},ot.useMemo=function(G,Y){return A.H.useMemo(G,Y)},ot.useOptimistic=function(G,Y){return A.H.useOptimistic(G,Y)},ot.useReducer=function(G,Y,re){return A.H.useReducer(G,Y,re)},ot.useRef=function(G){return A.H.useRef(G)},ot.useState=function(G){return A.H.useState(G)},ot.useSyncExternalStore=function(G,Y,re){return A.H.useSyncExternalStore(G,Y,re)},ot.useTransition=function(){return A.H.useTransition()},ot.version="19.2.0",ot}var g2;function uw(){return g2||(g2=1,bx.exports=xz()),bx.exports}var U=uw();const nh=vz(U);var xx={exports:{}},Yf={},_x={exports:{}},wx={};var m2;function _z(){return m2||(m2=1,(function(n){function e($,W){var ee=$.length;$.push(W);e:for(;0<ee;){var he=ee-1>>>1,K=$[he];if(0<i(K,W))$[he]=W,$[ee]=K,ee=he;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var W=$[0],ee=$.pop();if(ee!==W){$[0]=ee;e:for(var he=0,K=$.length,G=K>>>1;he<G;){var Y=2*(he+1)-1,re=$[Y],Z=Y+1,le=$[Z];if(0>i(re,ee))Z<K&&0>i(le,re)?($[he]=le,$[Z]=ee,he=Z):($[he]=re,$[Y]=ee,he=Y);else if(Z<K&&0>i(le,ee))$[he]=le,$[Z]=ee,he=Z;else break e}}return W}function i($,W){var ee=$.sortIndex-W.sortIndex;return ee!==0?ee:$.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function O($){for(var W=t(d);W!==null;){if(W.callback===null)r(d);else if(W.startTime<=$)r(d),W.sortIndex=W.expirationTime,e(u,W);else break;W=t(d)}}function P($){if(w=!1,O($),!_)if(t(u)!==null)_=!0,M||(M=!0,B());else{var W=t(d);W!==null&&H(P,W.startTime-$)}}var M=!1,A=-1,I=5,k=-1;function z(){return S?!0:!(n.unstable_now()-k<I)}function V(){if(S=!1,M){var $=n.unstable_now();k=$;var W=!0;try{e:{_=!1,w&&(w=!1,C(A),A=-1),b=!0;var ee=m;try{t:{for(O($),p=t(u);p!==null&&!(p.expirationTime>$&&z());){var he=p.callback;if(typeof he=="function"){p.callback=null,m=p.priorityLevel;var K=he(p.expirationTime<=$);if($=n.unstable_now(),typeof K=="function"){p.callback=K,O($),W=!0;break t}p===t(u)&&r(u),O($)}else r(u);p=t(u)}if(p!==null)W=!0;else{var G=t(d);G!==null&&H(P,G.startTime-$),W=!1}}break e}finally{p=null,m=ee,b=!1}W=void 0}}finally{W?B():M=!1}}}var B;if(typeof R=="function")B=function(){R(V)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,X=j.port2;j.port1.onmessage=V,B=function(){X.postMessage(null)}}else B=function(){T(V,0)};function H($,W){A=T(function(){$(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function($){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var ee=m;m=W;try{return $()}finally{m=ee}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function($,W){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ee=m;m=$;try{return W()}finally{m=ee}},n.unstable_scheduleCallback=function($,W,ee){var he=n.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?he+ee:he):ee=he,$){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ee+K,$={id:h++,callback:W,priorityLevel:$,startTime:ee,expirationTime:K,sortIndex:-1},ee>he?($.sortIndex=ee,e(d,$),t(u)===null&&$===t(d)&&(w?(C(A),A=-1):w=!0,H(P,ee-he))):($.sortIndex=K,e(u,$),_||b||(_=!0,M||(M=!0,B()))),$},n.unstable_shouldYield=z,n.unstable_wrapCallback=function($){var W=m;return function(){var ee=m;m=W;try{return $.apply(this,arguments)}finally{m=ee}}}})(wx)),wx}var v2;function wz(){return v2||(v2=1,_x.exports=_z()),_x.exports}var Ex={exports:{}},fr={};var y2;function Ez(){if(y2)return fr;y2=1;var n=uw();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,fr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},fr.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},fr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},fr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},fr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},fr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},fr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},fr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},fr.requestFormReset=function(u){r.d.r(u)},fr.unstable_batchedUpdates=function(u,d){return u(d)},fr.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},fr.useFormStatus=function(){return o.H.useHostTransitionStatus()},fr.version="19.2.0",fr}var b2;function Sz(){if(b2)return Ex.exports;b2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ex.exports=Ez(),Ex.exports}var x2;function Tz(){if(x2)return Yf;x2=1;var n=wz(),e=uw(),t=Sz();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var E=x.alternate;if(E===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===f)return u(x),s;if(E===g)return u(x),l;E=E.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=E;else{for(var N=!1,F=x.child;F;){if(F===f){N=!0,f=x,g=E;break}if(F===g){N=!0,g=x,f=E;break}F=F.sibling}if(!N){for(F=E.child;F;){if(F===f){N=!0,f=E,g=x;break}if(F===g){N=!0,g=E,f=x;break}F=F.sibling}if(!N)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),R=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function X(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case P:return"Suspense";case M:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case R:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case O:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:X(s.type)||"Memo";case I:l=s._payload,s=s._init;try{return X(s(l))}catch{}}return null}var H=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},he=[],K=-1;function G(s){return{current:s}}function Y(s){0>K||(s.current=he[K],he[K]=null,K--)}function re(s,l){K++,he[K]=s.current,s.current=l}var Z=G(null),le=G(null),fe=G(null),xe=G(null);function ve(s,l){switch(re(fe,l),re(le,s),re(Z,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?OC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=OC(l),s=jC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(Z),re(Z,s)}function Ce(){Y(Z),Y(le),Y(fe)}function Ge(s){s.memoizedState!==null&&re(xe,s);var l=Z.current,f=jC(l,s.type);l!==f&&(re(le,s),re(Z,f))}function ae(s){le.current===s&&(Y(Z),Y(le)),xe.current===s&&(Y(xe),Ff._currentValue=ee)}var Te,Pe;function Oe(s){if(Te===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Te=l&&l[1]||"",Pe=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Te+s+Pe}var qe=!1;function Ue(s,l){if(!s||qe)return"";qe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(ge){var de=ge}Reflect.construct(s,[],_e)}else{try{_e.call()}catch(ge){de=ge}s.call(_e.prototype)}}else{try{throw Error()}catch(ge){de=ge}(_e=s())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(ge){if(ge&&de&&typeof ge.stack=="string")return[ge.stack,de.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=g.DetermineComponentFrameRoot(),N=E[0],F=E[1];if(N&&F){var Q=N.split(`
`),ue=F.split(`
`);for(x=g=0;g<Q.length&&!Q[g].includes("DetermineComponentFrameRoot");)g++;for(;x<ue.length&&!ue[x].includes("DetermineComponentFrameRoot");)x++;if(g===Q.length||x===ue.length)for(g=Q.length-1,x=ue.length-1;1<=g&&0<=x&&Q[g]!==ue[x];)x--;for(;1<=g&&0<=x;g--,x--)if(Q[g]!==ue[x]){if(g!==1||x!==1)do if(g--,x--,0>x||Q[g]!==ue[x]){var ye=`
`+Q[g].replace(" at new "," at ");return s.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",s.displayName)),ye}while(1<=g&&0<=x);break}}}finally{qe=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Oe(f):""}function Se(s,l){switch(s.tag){case 26:case 27:case 5:return Oe(s.type);case 16:return Oe("Lazy");case 13:return s.child!==l&&l!==null?Oe("Suspense Fallback"):Oe("Suspense");case 19:return Oe("SuspenseList");case 0:case 15:return Ue(s.type,!1);case 11:return Ue(s.type.render,!1);case 1:return Ue(s.type,!0);case 31:return Oe("Activity");default:return""}}function ze(s){try{var l="",f=null;do l+=Se(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Ne=Object.prototype.hasOwnProperty,Le=n.unstable_scheduleCallback,lt=n.unstable_cancelCallback,Ct=n.unstable_shouldYield,et=n.unstable_requestPaint,ft=n.unstable_now,kt=n.unstable_getCurrentPriorityLevel,pn=n.unstable_ImmediatePriority,Ut=n.unstable_UserBlockingPriority,Cn=n.unstable_NormalPriority,Hr=n.unstable_LowPriority,fa=n.unstable_IdlePriority,Ja=n.log,Gs=n.unstable_setDisableYieldValue,Yr=null,In=null;function dr(s){if(typeof Ja=="function"&&Gs(s),In&&typeof In.setStrictMode=="function")try{In.setStrictMode(Yr,s)}catch{}}var on=Math.clz32?Math.clz32:$s,Lc=Math.log,qs=Math.LN2;function $s(s){return s>>>=0,s===0?32:31-(Lc(s)/qs|0)|0}var mt=256,ln=262144,cn=4194304;function Kr(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ui(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,E=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var F=g&134217727;return F!==0?(g=F&~E,g!==0?x=Kr(g):(N&=F,N!==0?x=Kr(N):f||(f=F&~s,f!==0&&(x=Kr(f))))):(F=g&~E,F!==0?x=Kr(F):N!==0?x=Kr(N):f||(f=g&~s,f!==0&&(x=Kr(f)))),x===0?0:l!==0&&l!==x&&(l&E)===0&&(E=x&-x,f=l&-l,E>=f||E===32&&(f&4194048)!==0)?l:x}function _r(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function wy(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tg(){var s=cn;return cn<<=1,(cn&62914560)===0&&(cn=4194304),s}function ha(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function hl(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ey(s,l,f,g,x,E){var N=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var F=s.entanglements,Q=s.expirationTimes,ue=s.hiddenUpdates;for(f=N&~f;0<f;){var ye=31-on(f),_e=1<<ye;F[ye]=0,Q[ye]=-1;var de=ue[ye];if(de!==null)for(ue[ye]=null,ye=0;ye<de.length;ye++){var ge=de[ye];ge!==null&&(ge.lane&=-536870913)}f&=~_e}g!==0&&pl(s,g,0),E!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=E&~(N&~l))}function pl(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-on(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function Hd(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-on(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function Yd(s,l){var f=l&-l;return f=(f&42)!==0?1:gl(f),(f&(s.suspendedLanes|l))!==0?0:f}function gl(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function es(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ng(){var s=W.p;return s!==0?s:(s=window.event,s===void 0?32:a2(s.type))}function Vi(s,l){var f=W.p;try{return W.p=s,l()}finally{W.p=f}}var zi=Math.random().toString(36).slice(2),Rn="__reactFiber$"+zi,Qn="__reactProps$"+zi,pa="__reactContainer$"+zi,Bc="__reactEvents$"+zi,Sy="__reactListeners$"+zi,rg="__reactHandles$"+zi,ig="__reactResources$"+zi,ga="__reactMarker$"+zi;function Uc(s){delete s[Rn],delete s[Qn],delete s[Bc],delete s[Sy],delete s[rg]}function ma(s){var l=s[Rn];if(l)return l;for(var f=s.parentNode;f;){if(l=f[pa]||f[Rn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=GC(s);s!==null;){if(f=s[Rn])return f;s=GC(s)}return l}s=f,f=s.parentNode}return null}function di(s){if(s=s[Rn]||s[pa]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function Xr(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function va(s){var l=s[ig];return l||(l=s[ig]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Dn(s){s[ga]=!0}var Kd=new Set,Xd={};function ya(s,l){ba(s,l),ba(s+"Capture",l)}function ba(s,l){for(Xd[s]=l,s=0;s<l.length;s++)Kd.add(l[s])}var Wd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qd={},Zd={};function ag(s){return Ne.call(Zd,s)?!0:Ne.call(Qd,s)?!1:Wd.test(s)?Zd[s]=!0:(Qd[s]=!0,!1)}function Fc(s,l,f){if(ag(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function Wr(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function kn(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function Zn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Hs(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Jd(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,E=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(N){f=""+N,E.call(this,N)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(N){f=""+N},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Ot(s){if(!s._valueTracker){var l=Hs(s)?"checked":"value";s._valueTracker=Jd(s,l,""+s[l])}}function ml(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=Hs(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function xa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var vl=/[\n"\\]/g;function Nr(s){return s.replace(vl,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Gc(s,l,f,g,x,E,N,F){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),l!=null?N==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Zn(l)):s.value!==""+Zn(l)&&(s.value=""+Zn(l)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),l!=null?ef(s,N,Zn(l)):f!=null?ef(s,N,Zn(f)):g!=null&&s.removeAttribute("value"),x==null&&E!=null&&(s.defaultChecked=!!E),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+Zn(F):s.removeAttribute("name")}function sg(s,l,f,g,x,E,N,F){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){Ot(s);return}f=f!=null?""+Zn(f):"",l=l!=null?""+Zn(l):f,F||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=F?s.checked:!!g,s.defaultChecked=!!g,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),Ot(s)}function ef(s,l,f){l==="number"&&xa(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function Ys(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+Zn(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function og(s,l,f){if(l!=null&&(l=""+Zn(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+Zn(f):""}function Ks(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(H(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=Zn(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Ot(s)}function Mr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var lg=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||lg.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function nf(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&tf(s,x,g)}else for(var E in l)l.hasOwnProperty(E)&&tf(s,E,l[E])}function qc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $c(s){return Xs.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Li(){}var rf=null;function fi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ws=null,_a=null;function yl(s){var l=di(s);if(l&&(s=l.stateNode)){var f=s[Qn]||null;e:switch(s=l.stateNode,l.type){case"input":if(Gc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Nr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[Qn]||null;if(!x)throw Error(r(90));Gc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&ml(g)}break e;case"textarea":og(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&Ys(s,!!f.multiple,l,!1)}}}var Hc=!1;function Qs(s,l,f){if(Hc)return s(l,f);Hc=!0;try{var g=s(l);return g}finally{if(Hc=!1,(Ws!==null||_a!==null)&&(nm(),Ws&&(l=Ws,s=_a,_a=Ws=null,yl(l),s)))for(l=0;l<s.length;l++)yl(s[l])}}function Bi(s,l){var f=s.stateNode;if(f===null)return null;var g=f[Qn]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bl=!1;if(hi)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){bl=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch{bl=!1}var wa=null,af=null,xl=null;function sf(){if(xl)return xl;var s,l=af,f=l.length,g,x="value"in wa?wa.value:wa.textContent,E=x.length;for(s=0;s<f&&l[s]===x[s];s++);var N=f-s;for(g=1;g<=N&&l[f-g]===x[E-g];g++);return xl=x.slice(s,1<g?1-g:void 0)}function _l(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function ts(){return!0}function Ui(){return!1}function tr(s){function l(f,g,x,E,N){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=E,this.target=N,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(f=s[F],this[F]=f?f(E):E[F]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?ts:Ui,this.isPropagationStopped=Ui,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ts)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ts)},persist:function(){},isPersistent:ts}),l}var ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ea=tr(ns),Zs=p({},ns,{view:0,detail:0}),of=tr(Zs),Js,Yc,Sa,Kc=p({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Sa&&(Sa&&s.type==="mousemove"?(Js=s.screenX-Sa.screenX,Yc=s.screenY-Sa.screenY):Yc=Js=0,Sa=s),Js)},movementY:function(s){return"movementY"in s?s.movementY:Yc}}),lf=tr(Kc),wl=p({},Kc,{dataTransfer:0}),ug=tr(wl),dg=p({},Zs,{relatedTarget:0}),El=tr(dg),cf=p({},ns,{animationName:0,elapsedTime:0,pseudoElement:0}),fg=tr(cf),Xc=p({},ns,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),hg=tr(Xc),pg=p({},ns,{data:0}),Ta=tr(pg),gg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=vg[s])?!!l[s]:!1}function eo(){return yg}var wr=p({},Zs,{key:function(s){if(s.key){var l=gg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=_l(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?mg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eo,charCode:function(s){return s.type==="keypress"?_l(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?_l(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),bg=tr(wr),xg=p({},Kc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rs=tr(xg),y=p({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eo}),D=tr(y),L=p({},ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=tr(L),oe=p({},Kc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=tr(oe),De=p({},ns,{newState:0,oldState:0}),ct=tr(De),_n=[9,13,27,32],Nt=hi&&"CompositionEvent"in window,en=null;hi&&"documentMode"in document&&(en=document.documentMode);var pi=hi&&"TextEvent"in window&&!en,Aa=hi&&(!Nt||en&&8<en&&11>=en),Fi=" ",Gi=!1;function Sl(s,l){switch(s){case"keyup":return _n.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Qc=!1;function U5(s,l){switch(s){case"compositionend":return Wc(l);case"keypress":return l.which!==32?null:(Gi=!0,Fi);case"textInput":return s=l.data,s===Fi&&Gi?null:s;default:return null}}function F5(s,l){if(Qc)return s==="compositionend"||!Nt&&Sl(s,l)?(s=sf(),xl=af=wa=null,Qc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Aa&&l.locale!=="ko"?null:l.data;default:return null}}var G5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!G5[s.type]:l==="textarea"}function YS(s,l,f,g){Ws?_a?_a.push(g):_a=[g]:Ws=g,l=cm(l,"onChange"),0<l.length&&(f=new Ea("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var uf=null,df=null;function q5(s){RC(s,0)}function _g(s){var l=Xr(s);if(ml(l))return s}function KS(s,l){if(s==="change")return l}var XS=!1;if(hi){var Ty;if(hi){var Ay="oninput"in document;if(!Ay){var WS=document.createElement("div");WS.setAttribute("oninput","return;"),Ay=typeof WS.oninput=="function"}Ty=Ay}else Ty=!1;XS=Ty&&(!document.documentMode||9<document.documentMode)}function QS(){uf&&(uf.detachEvent("onpropertychange",ZS),df=uf=null)}function ZS(s){if(s.propertyName==="value"&&_g(df)){var l=[];YS(l,df,s,fi(s)),Qs(q5,l)}}function $5(s,l,f){s==="focusin"?(QS(),uf=l,df=f,uf.attachEvent("onpropertychange",ZS)):s==="focusout"&&QS()}function H5(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return _g(df)}function Y5(s,l){if(s==="click")return _g(l)}function K5(s,l){if(s==="input"||s==="change")return _g(l)}function X5(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Qr=typeof Object.is=="function"?Object.is:X5;function ff(s,l){if(Qr(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!Ne.call(l,x)||!Qr(s[x],l[x]))return!1}return!0}function JS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function eT(s,l){var f=JS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=JS(f)}}function tT(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?tT(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function nT(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=xa(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=xa(s.document)}return l}function Cy(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var W5=hi&&"documentMode"in document&&11>=document.documentMode,Zc=null,Iy=null,hf=null,Ry=!1;function rT(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Ry||Zc==null||Zc!==xa(g)||(g=Zc,"selectionStart"in g&&Cy(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),hf&&ff(hf,g)||(hf=g,g=cm(Iy,"onSelect"),0<g.length&&(l=new Ea("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=Zc)))}function Tl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var Jc={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionrun:Tl("Transition","TransitionRun"),transitionstart:Tl("Transition","TransitionStart"),transitioncancel:Tl("Transition","TransitionCancel"),transitionend:Tl("Transition","TransitionEnd")},Dy={},iT={};hi&&(iT=document.createElement("div").style,"AnimationEvent"in window||(delete Jc.animationend.animation,delete Jc.animationiteration.animation,delete Jc.animationstart.animation),"TransitionEvent"in window||delete Jc.transitionend.transition);function Al(s){if(Dy[s])return Dy[s];if(!Jc[s])return s;var l=Jc[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in iT)return Dy[s]=l[f];return s}var aT=Al("animationend"),sT=Al("animationiteration"),oT=Al("animationstart"),Q5=Al("transitionrun"),Z5=Al("transitionstart"),J5=Al("transitioncancel"),lT=Al("transitionend"),cT=new Map,ky="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ky.push("scrollEnd");function qi(s,l){cT.set(s,l),ya(l,[s])}var wg=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},gi=[],eu=0,Ny=0;function Eg(){for(var s=eu,l=Ny=eu=0;l<s;){var f=gi[l];gi[l++]=null;var g=gi[l];gi[l++]=null;var x=gi[l];gi[l++]=null;var E=gi[l];if(gi[l++]=null,g!==null&&x!==null){var N=g.pending;N===null?x.next=x:(x.next=N.next,N.next=x),g.pending=x}E!==0&&uT(f,x,E)}}function Sg(s,l,f,g){gi[eu++]=s,gi[eu++]=l,gi[eu++]=f,gi[eu++]=g,Ny|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function My(s,l,f,g){return Sg(s,l,f,g),Tg(s)}function Cl(s,l){return Sg(s,null,null,l),Tg(s)}function uT(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,E=s.return;E!==null;)E.childLanes|=f,g=E.alternate,g!==null&&(g.childLanes|=f),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(x=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,x&&l!==null&&(x=31-on(f),s=E.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),E):null}function Tg(s){if(50<Of)throw Of=0,Fb=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var tu={};function eV(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zr(s,l,f,g){return new eV(s,l,f,g)}function Py(s){return s=s.prototype,!(!s||!s.isReactComponent)}function is(s,l){var f=s.alternate;return f===null?(f=Zr(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function dT(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Ag(s,l,f,g,x,E){var N=0;if(g=s,typeof s=="function")Py(s)&&(N=1);else if(typeof s=="string")N=az(s,f,Z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=Zr(31,f,l,x),s.elementType=k,s.lanes=E,s;case w:return Il(f.children,x,E,l);case S:N=8,x|=24;break;case T:return s=Zr(12,f,l,x|2),s.elementType=T,s.lanes=E,s;case P:return s=Zr(13,f,l,x),s.elementType=P,s.lanes=E,s;case M:return s=Zr(19,f,l,x),s.elementType=M,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case R:N=10;break e;case C:N=9;break e;case O:N=11;break e;case A:N=14;break e;case I:N=16,g=null;break e}N=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=Zr(N,f,l,x),l.elementType=s,l.type=g,l.lanes=E,l}function Il(s,l,f,g){return s=Zr(7,s,g,l),s.lanes=f,s}function Oy(s,l,f){return s=Zr(6,s,null,l),s.lanes=f,s}function fT(s){var l=Zr(18,null,null,0);return l.stateNode=s,l}function jy(s,l,f){return l=Zr(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var hT=new WeakMap;function mi(s,l){if(typeof s=="object"&&s!==null){var f=hT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:ze(l)},hT.set(s,l),l)}return{value:s,source:l,stack:ze(l)}}var nu=[],ru=0,Cg=null,pf=0,vi=[],yi=0,to=null,Ca=1,Ia="";function as(s,l){nu[ru++]=pf,nu[ru++]=Cg,Cg=s,pf=l}function pT(s,l,f){vi[yi++]=Ca,vi[yi++]=Ia,vi[yi++]=to,to=s;var g=Ca;s=Ia;var x=32-on(g)-1;g&=~(1<<x),f+=1;var E=32-on(l)+x;if(30<E){var N=x-x%5;E=(g&(1<<N)-1).toString(32),g>>=N,x-=N,Ca=1<<32-on(l)+x|f<<x|g,Ia=E+s}else Ca=1<<E|f<<x|g,Ia=s}function Vy(s){s.return!==null&&(as(s,1),pT(s,1,0))}function zy(s){for(;s===Cg;)Cg=nu[--ru],nu[ru]=null,pf=nu[--ru],nu[ru]=null;for(;s===to;)to=vi[--yi],vi[yi]=null,Ia=vi[--yi],vi[yi]=null,Ca=vi[--yi],vi[yi]=null}function gT(s,l){vi[yi++]=Ca,vi[yi++]=Ia,vi[yi++]=to,Ca=l.id,Ia=l.overflow,to=s}var nr=null,Qt=null,Et=!1,no=null,bi=!1,Ly=Error(r(519));function ro(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gf(mi(l,s)),Ly}function mT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[Rn]=s,l[Qn]=g,f){case"dialog":yt("cancel",l),yt("close",l);break;case"iframe":case"object":case"embed":yt("load",l);break;case"video":case"audio":for(f=0;f<Vf.length;f++)yt(Vf[f],l);break;case"source":yt("error",l);break;case"img":case"image":case"link":yt("error",l),yt("load",l);break;case"details":yt("toggle",l);break;case"input":yt("invalid",l),sg(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":yt("invalid",l);break;case"textarea":yt("invalid",l),Ks(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||MC(l.textContent,f)?(g.popover!=null&&(yt("beforetoggle",l),yt("toggle",l)),g.onScroll!=null&&yt("scroll",l),g.onScrollEnd!=null&&yt("scrollend",l),g.onClick!=null&&(l.onclick=Li),l=!0):l=!1,l||ro(s,!0)}function vT(s){for(nr=s.return;nr;)switch(nr.tag){case 5:case 31:case 13:bi=!1;return;case 27:case 3:bi=!0;return;default:nr=nr.return}}function iu(s){if(s!==nr)return!1;if(!Et)return vT(s),Et=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||rx(s.type,s.memoizedProps)),f=!f),f&&Qt&&ro(s),vT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Qt=FC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Qt=FC(s)}else l===27?(l=Qt,yo(s.type)?(s=lx,lx=null,Qt=s):Qt=l):Qt=nr?_i(s.stateNode.nextSibling):null;return!0}function Rl(){Qt=nr=null,Et=!1}function By(){var s=no;return s!==null&&(Vr===null?Vr=s:Vr.push.apply(Vr,s),no=null),s}function gf(s){no===null?no=[s]:no.push(s)}var Uy=G(null),Dl=null,ss=null;function io(s,l,f){re(Uy,l._currentValue),l._currentValue=f}function os(s){s._currentValue=Uy.current,Y(Uy)}function Fy(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Gy(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var E=x.dependencies;if(E!==null){var N=x.child;E=E.firstContext;e:for(;E!==null;){var F=E;E=x;for(var Q=0;Q<l.length;Q++)if(F.context===l[Q]){E.lanes|=f,F=E.alternate,F!==null&&(F.lanes|=f),Fy(E.return,f,s),g||(N=null);break e}E=F.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(r(341));N.lanes|=f,E=N.alternate,E!==null&&(E.lanes|=f),Fy(N,f,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function au(s,l,f,g){s=null;for(var x=l,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var F=x.type;Qr(x.pendingProps.value,N.value)||(s!==null?s.push(F):s=[F])}}else if(x===xe.current){if(N=x.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Ff):s=[Ff])}x=x.return}s!==null&&Gy(l,s,f,g),l.flags|=262144}function Ig(s){for(s=s.firstContext;s!==null;){if(!Qr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function kl(s){Dl=s,ss=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function rr(s){return yT(Dl,s)}function Rg(s,l){return Dl===null&&kl(s),yT(s,l)}function yT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},ss===null){if(s===null)throw Error(r(308));ss=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ss=ss.next=l;return f}var tV=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},nV=n.unstable_scheduleCallback,rV=n.unstable_NormalPriority,Nn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qy(){return{controller:new tV,data:new Map,refCount:0}}function mf(s){s.refCount--,s.refCount===0&&nV(rV,function(){s.controller.abort()})}var vf=null,$y=0,su=0,ou=null;function iV(s,l){if(vf===null){var f=vf=[];$y=0,su=Kb(),ou={status:"pending",value:void 0,then:function(g){f.push(g)}}}return $y++,l.then(bT,bT),l}function bT(){if(--$y===0&&vf!==null){ou!==null&&(ou.status="fulfilled");var s=vf;vf=null,su=0,ou=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function aV(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var xT=$.S;$.S=function(s,l){rC=ft(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&iV(s,l),xT!==null&&xT(s,l)};var Nl=G(null);function Hy(){var s=Nl.current;return s!==null?s:Kt.pooledCache}function Dg(s,l){l===null?re(Nl,Nl.current):re(Nl,l.pool)}function _T(){var s=Hy();return s===null?null:{parent:Nn._currentValue,pool:s}}var lu=Error(r(460)),Yy=Error(r(474)),kg=Error(r(542)),Ng={then:function(){}};function wT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ET(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Li,Li),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,TT(s),s;default:if(typeof l.status=="string")l.then(Li,Li);else{if(s=Kt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,TT(s),s}throw Pl=l,lu}}function Ml(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Pl=f,lu):f}}var Pl=null;function ST(){if(Pl===null)throw Error(r(459));var s=Pl;return Pl=null,s}function TT(s){if(s===lu||s===kg)throw Error(r(483))}var cu=null,yf=0;function Mg(s){var l=yf;return yf+=1,cu===null&&(cu=[]),ET(cu,s,l)}function bf(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Pg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function AT(s){function l(ie,ne){if(s){var ce=ie.deletions;ce===null?(ie.deletions=[ne],ie.flags|=16):ce.push(ne)}}function f(ie,ne){if(!s)return null;for(;ne!==null;)l(ie,ne),ne=ne.sibling;return null}function g(ie){for(var ne=new Map;ie!==null;)ie.key!==null?ne.set(ie.key,ie):ne.set(ie.index,ie),ie=ie.sibling;return ne}function x(ie,ne){return ie=is(ie,ne),ie.index=0,ie.sibling=null,ie}function E(ie,ne,ce){return ie.index=ce,s?(ce=ie.alternate,ce!==null?(ce=ce.index,ce<ne?(ie.flags|=67108866,ne):ce):(ie.flags|=67108866,ne)):(ie.flags|=1048576,ne)}function N(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function F(ie,ne,ce,be){return ne===null||ne.tag!==6?(ne=Oy(ce,ie.mode,be),ne.return=ie,ne):(ne=x(ne,ce),ne.return=ie,ne)}function Q(ie,ne,ce,be){var Ye=ce.type;return Ye===w?ye(ie,ne,ce.props.children,be,ce.key):ne!==null&&(ne.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&Ml(Ye)===ne.type)?(ne=x(ne,ce.props),bf(ne,ce),ne.return=ie,ne):(ne=Ag(ce.type,ce.key,ce.props,null,ie.mode,be),bf(ne,ce),ne.return=ie,ne)}function ue(ie,ne,ce,be){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ce.containerInfo||ne.stateNode.implementation!==ce.implementation?(ne=jy(ce,ie.mode,be),ne.return=ie,ne):(ne=x(ne,ce.children||[]),ne.return=ie,ne)}function ye(ie,ne,ce,be,Ye){return ne===null||ne.tag!==7?(ne=Il(ce,ie.mode,be,Ye),ne.return=ie,ne):(ne=x(ne,ce),ne.return=ie,ne)}function _e(ie,ne,ce){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=Oy(""+ne,ie.mode,ce),ne.return=ie,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:return ce=Ag(ne.type,ne.key,ne.props,null,ie.mode,ce),bf(ce,ne),ce.return=ie,ce;case _:return ne=jy(ne,ie.mode,ce),ne.return=ie,ne;case I:return ne=Ml(ne),_e(ie,ne,ce)}if(H(ne)||B(ne))return ne=Il(ne,ie.mode,ce,null),ne.return=ie,ne;if(typeof ne.then=="function")return _e(ie,Mg(ne),ce);if(ne.$$typeof===R)return _e(ie,Rg(ie,ne),ce);Pg(ie,ne)}return null}function de(ie,ne,ce,be){var Ye=ne!==null?ne.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Ye!==null?null:F(ie,ne,""+ce,be);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:return ce.key===Ye?Q(ie,ne,ce,be):null;case _:return ce.key===Ye?ue(ie,ne,ce,be):null;case I:return ce=Ml(ce),de(ie,ne,ce,be)}if(H(ce)||B(ce))return Ye!==null?null:ye(ie,ne,ce,be,null);if(typeof ce.then=="function")return de(ie,ne,Mg(ce),be);if(ce.$$typeof===R)return de(ie,ne,Rg(ie,ce),be);Pg(ie,ce)}return null}function ge(ie,ne,ce,be,Ye){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return ie=ie.get(ce)||null,F(ne,ie,""+be,Ye);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case b:return ie=ie.get(be.key===null?ce:be.key)||null,Q(ne,ie,be,Ye);case _:return ie=ie.get(be.key===null?ce:be.key)||null,ue(ne,ie,be,Ye);case I:return be=Ml(be),ge(ie,ne,ce,be,Ye)}if(H(be)||B(be))return ie=ie.get(ce)||null,ye(ne,ie,be,Ye,null);if(typeof be.then=="function")return ge(ie,ne,ce,Mg(be),Ye);if(be.$$typeof===R)return ge(ie,ne,ce,Rg(ne,be),Ye);Pg(ne,be)}return null}function je(ie,ne,ce,be){for(var Ye=null,Rt=null,Be=ne,ht=ne=0,xt=null;Be!==null&&ht<ce.length;ht++){Be.index>ht?(xt=Be,Be=null):xt=Be.sibling;var Dt=de(ie,Be,ce[ht],be);if(Dt===null){Be===null&&(Be=xt);break}s&&Be&&Dt.alternate===null&&l(ie,Be),ne=E(Dt,ne,ht),Rt===null?Ye=Dt:Rt.sibling=Dt,Rt=Dt,Be=xt}if(ht===ce.length)return f(ie,Be),Et&&as(ie,ht),Ye;if(Be===null){for(;ht<ce.length;ht++)Be=_e(ie,ce[ht],be),Be!==null&&(ne=E(Be,ne,ht),Rt===null?Ye=Be:Rt.sibling=Be,Rt=Be);return Et&&as(ie,ht),Ye}for(Be=g(Be);ht<ce.length;ht++)xt=ge(Be,ie,ht,ce[ht],be),xt!==null&&(s&&xt.alternate!==null&&Be.delete(xt.key===null?ht:xt.key),ne=E(xt,ne,ht),Rt===null?Ye=xt:Rt.sibling=xt,Rt=xt);return s&&Be.forEach(function(Eo){return l(ie,Eo)}),Et&&as(ie,ht),Ye}function Qe(ie,ne,ce,be){if(ce==null)throw Error(r(151));for(var Ye=null,Rt=null,Be=ne,ht=ne=0,xt=null,Dt=ce.next();Be!==null&&!Dt.done;ht++,Dt=ce.next()){Be.index>ht?(xt=Be,Be=null):xt=Be.sibling;var Eo=de(ie,Be,Dt.value,be);if(Eo===null){Be===null&&(Be=xt);break}s&&Be&&Eo.alternate===null&&l(ie,Be),ne=E(Eo,ne,ht),Rt===null?Ye=Eo:Rt.sibling=Eo,Rt=Eo,Be=xt}if(Dt.done)return f(ie,Be),Et&&as(ie,ht),Ye;if(Be===null){for(;!Dt.done;ht++,Dt=ce.next())Dt=_e(ie,Dt.value,be),Dt!==null&&(ne=E(Dt,ne,ht),Rt===null?Ye=Dt:Rt.sibling=Dt,Rt=Dt);return Et&&as(ie,ht),Ye}for(Be=g(Be);!Dt.done;ht++,Dt=ce.next())Dt=ge(Be,ie,ht,Dt.value,be),Dt!==null&&(s&&Dt.alternate!==null&&Be.delete(Dt.key===null?ht:Dt.key),ne=E(Dt,ne,ht),Rt===null?Ye=Dt:Rt.sibling=Dt,Rt=Dt);return s&&Be.forEach(function(mz){return l(ie,mz)}),Et&&as(ie,ht),Ye}function $t(ie,ne,ce,be){if(typeof ce=="object"&&ce!==null&&ce.type===w&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:e:{for(var Ye=ce.key;ne!==null;){if(ne.key===Ye){if(Ye=ce.type,Ye===w){if(ne.tag===7){f(ie,ne.sibling),be=x(ne,ce.props.children),be.return=ie,ie=be;break e}}else if(ne.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&Ml(Ye)===ne.type){f(ie,ne.sibling),be=x(ne,ce.props),bf(be,ce),be.return=ie,ie=be;break e}f(ie,ne);break}else l(ie,ne);ne=ne.sibling}ce.type===w?(be=Il(ce.props.children,ie.mode,be,ce.key),be.return=ie,ie=be):(be=Ag(ce.type,ce.key,ce.props,null,ie.mode,be),bf(be,ce),be.return=ie,ie=be)}return N(ie);case _:e:{for(Ye=ce.key;ne!==null;){if(ne.key===Ye)if(ne.tag===4&&ne.stateNode.containerInfo===ce.containerInfo&&ne.stateNode.implementation===ce.implementation){f(ie,ne.sibling),be=x(ne,ce.children||[]),be.return=ie,ie=be;break e}else{f(ie,ne);break}else l(ie,ne);ne=ne.sibling}be=jy(ce,ie.mode,be),be.return=ie,ie=be}return N(ie);case I:return ce=Ml(ce),$t(ie,ne,ce,be)}if(H(ce))return je(ie,ne,ce,be);if(B(ce)){if(Ye=B(ce),typeof Ye!="function")throw Error(r(150));return ce=Ye.call(ce),Qe(ie,ne,ce,be)}if(typeof ce.then=="function")return $t(ie,ne,Mg(ce),be);if(ce.$$typeof===R)return $t(ie,ne,Rg(ie,ce),be);Pg(ie,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ne!==null&&ne.tag===6?(f(ie,ne.sibling),be=x(ne,ce),be.return=ie,ie=be):(f(ie,ne),be=Oy(ce,ie.mode,be),be.return=ie,ie=be),N(ie)):f(ie,ne)}return function(ie,ne,ce,be){try{yf=0;var Ye=$t(ie,ne,ce,be);return cu=null,Ye}catch(Be){if(Be===lu||Be===kg)throw Be;var Rt=Zr(29,Be,null,ie.mode);return Rt.lanes=be,Rt.return=ie,Rt}finally{}}}var Ol=AT(!0),CT=AT(!1),ao=!1;function Ky(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function so(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function oo(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Mt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=Tg(s),uT(s,null,f),l}return Sg(s,g,l,f),Tg(s)}function xf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Hd(s,f)}}function Wy(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var N={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?x=E=N:E=E.next=N,f=f.next}while(f!==null);E===null?x=E=l:E=E.next=l}else x=E=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Qy=!1;function _f(){if(Qy){var s=ou;if(s!==null)throw s}}function wf(s,l,f,g){Qy=!1;var x=s.updateQueue;ao=!1;var E=x.firstBaseUpdate,N=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var Q=F,ue=Q.next;Q.next=null,N===null?E=ue:N.next=ue,N=Q;var ye=s.alternate;ye!==null&&(ye=ye.updateQueue,F=ye.lastBaseUpdate,F!==N&&(F===null?ye.firstBaseUpdate=ue:F.next=ue,ye.lastBaseUpdate=Q))}if(E!==null){var _e=x.baseState;N=0,ye=ue=Q=null,F=E;do{var de=F.lane&-536870913,ge=de!==F.lane;if(ge?(bt&de)===de:(g&de)===de){de!==0&&de===su&&(Qy=!0),ye!==null&&(ye=ye.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var je=s,Qe=F;de=l;var $t=f;switch(Qe.tag){case 1:if(je=Qe.payload,typeof je=="function"){_e=je.call($t,_e,de);break e}_e=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Qe.payload,de=typeof je=="function"?je.call($t,_e,de):je,de==null)break e;_e=p({},_e,de);break e;case 2:ao=!0}}de=F.callback,de!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[de]:ge.push(de))}else ge={lane:de,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ye===null?(ue=ye=ge,Q=_e):ye=ye.next=ge,N|=de;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;ge=F,F=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);ye===null&&(Q=_e),x.baseState=Q,x.firstBaseUpdate=ue,x.lastBaseUpdate=ye,E===null&&(x.shared.lanes=0),ho|=N,s.lanes=N,s.memoizedState=_e}}function IT(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function RT(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)IT(f[s],l)}var uu=G(null),Og=G(0);function DT(s,l){s=ms,re(Og,s),re(uu,l),ms=s|l.baseLanes}function Zy(){re(Og,ms),re(uu,uu.current)}function Jy(){ms=Og.current,Y(uu),Y(Og)}var Jr=G(null),xi=null;function lo(s){var l=s.alternate;re(wn,wn.current&1),re(Jr,s),xi===null&&(l===null||uu.current!==null||l.memoizedState!==null)&&(xi=s)}function eb(s){re(wn,wn.current),re(Jr,s),xi===null&&(xi=s)}function kT(s){s.tag===22?(re(wn,wn.current),re(Jr,s),xi===null&&(xi=s)):co()}function co(){re(wn,wn.current),re(Jr,Jr.current)}function ei(s){Y(Jr),xi===s&&(xi=null),Y(wn)}var wn=G(0);function jg(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||sx(f)||ox(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ls=0,ut=null,Gt=null,Mn=null,Vg=!1,du=!1,jl=!1,zg=0,Ef=0,fu=null,sV=0;function gn(){throw Error(r(321))}function tb(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Qr(s[f],l[f]))return!1;return!0}function nb(s,l,f,g,x,E){return ls=E,ut=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,$.H=s===null||s.memoizedState===null?pA:vb,jl=!1,E=f(g,x),jl=!1,du&&(E=MT(l,f,g,x)),NT(s),E}function NT(s){$.H=Af;var l=Gt!==null&&Gt.next!==null;if(ls=0,Mn=Gt=ut=null,Vg=!1,Ef=0,fu=null,l)throw Error(r(300));s===null||Pn||(s=s.dependencies,s!==null&&Ig(s)&&(Pn=!0))}function MT(s,l,f,g){ut=s;var x=0;do{if(du&&(fu=null),Ef=0,du=!1,25<=x)throw Error(r(301));if(x+=1,Mn=Gt=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}$.H=gA,E=l(f,g)}while(du);return E}function oV(){var s=$.H,l=s.useState()[0];return l=typeof l.then=="function"?Sf(l):l,s=s.useState()[0],(Gt!==null?Gt.memoizedState:null)!==s&&(ut.flags|=1024),l}function rb(){var s=zg!==0;return zg=0,s}function ib(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function ab(s){if(Vg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Vg=!1}ls=0,Mn=Gt=ut=null,du=!1,Ef=zg=0,fu=null}function Er(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?ut.memoizedState=Mn=s:Mn=Mn.next=s,Mn}function En(){if(Gt===null){var s=ut.alternate;s=s!==null?s.memoizedState:null}else s=Gt.next;var l=Mn===null?ut.memoizedState:Mn.next;if(l!==null)Mn=l,Gt=s;else{if(s===null)throw ut.alternate===null?Error(r(467)):Error(r(310));Gt=s,s={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Mn===null?ut.memoizedState=Mn=s:Mn=Mn.next=s}return Mn}function Lg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sf(s){var l=Ef;return Ef+=1,fu===null&&(fu=[]),s=ET(fu,s,l),l=ut,(Mn===null?l.memoizedState:Mn.next)===null&&(l=l.alternate,$.H=l===null||l.memoizedState===null?pA:vb),s}function Bg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Sf(s);if(s.$$typeof===R)return rr(s)}throw Error(r(438,String(s)))}function sb(s){var l=null,f=ut.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=ut.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Lg(),ut.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=z;return l.index++,f}function cs(s,l){return typeof l=="function"?l(s):l}function Ug(s){var l=En();return ob(l,Gt,s)}function ob(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,E=g.pending;if(E!==null){if(x!==null){var N=x.next;x.next=E.next,E.next=N}l.baseQueue=x=E,g.pending=null}if(E=s.baseState,x===null)s.memoizedState=E;else{l=x.next;var F=N=null,Q=null,ue=l,ye=!1;do{var _e=ue.lane&-536870913;if(_e!==ue.lane?(bt&_e)===_e:(ls&_e)===_e){var de=ue.revertLane;if(de===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),_e===su&&(ye=!0);else if((ls&de)===de){ue=ue.next,de===su&&(ye=!0);continue}else _e={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Q===null?(F=Q=_e,N=E):Q=Q.next=_e,ut.lanes|=de,ho|=de;_e=ue.action,jl&&f(E,_e),E=ue.hasEagerState?ue.eagerState:f(E,_e)}else de={lane:_e,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Q===null?(F=Q=de,N=E):Q=Q.next=de,ut.lanes|=_e,ho|=_e;ue=ue.next}while(ue!==null&&ue!==l);if(Q===null?N=E:Q.next=F,!Qr(E,s.memoizedState)&&(Pn=!0,ye&&(f=ou,f!==null)))throw f;s.memoizedState=E,s.baseState=N,s.baseQueue=Q,g.lastRenderedState=E}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function lb(s){var l=En(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,E=l.memoizedState;if(x!==null){f.pending=null;var N=x=x.next;do E=s(E,N.action),N=N.next;while(N!==x);Qr(E,l.memoizedState)||(Pn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,g]}function PT(s,l,f){var g=ut,x=En(),E=Et;if(E){if(f===void 0)throw Error(r(407));f=f()}else f=l();var N=!Qr((Gt||x).memoizedState,f);if(N&&(x.memoizedState=f,Pn=!0),x=x.queue,db(VT.bind(null,g,x,s),[s]),x.getSnapshot!==l||N||Mn!==null&&Mn.memoizedState.tag&1){if(g.flags|=2048,hu(9,{destroy:void 0},jT.bind(null,g,x,f,l),null),Kt===null)throw Error(r(349));E||(ls&127)!==0||OT(g,l,f)}return f}function OT(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=ut.updateQueue,l===null?(l=Lg(),ut.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function jT(s,l,f,g){l.value=f,l.getSnapshot=g,zT(l)&&LT(s)}function VT(s,l,f){return f(function(){zT(l)&&LT(s)})}function zT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Qr(s,f)}catch{return!0}}function LT(s){var l=Cl(s,2);l!==null&&zr(l,s,2)}function cb(s){var l=Er();if(typeof s=="function"){var f=s;if(s=f(),jl){dr(!0);try{f()}finally{dr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:s},l}function BT(s,l,f,g){return s.baseState=f,ob(s,Gt,typeof g=="function"?g:cs)}function lV(s,l,f,g,x){if(qg(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){E.listeners.push(N)}};$.T!==null?f(!0):E.isTransition=!1,g(E),f=l.pending,f===null?(E.next=l.pending=E,UT(l,E)):(E.next=f.next,l.pending=f.next=E)}}function UT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var E=$.T,N={};$.T=N;try{var F=f(x,g),Q=$.S;Q!==null&&Q(N,F),FT(s,l,F)}catch(ue){ub(s,l,ue)}finally{E!==null&&N.types!==null&&(E.types=N.types),$.T=E}}else try{E=f(x,g),FT(s,l,E)}catch(ue){ub(s,l,ue)}}function FT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){GT(s,l,g)},function(g){return ub(s,l,g)}):GT(s,l,f)}function GT(s,l,f){l.status="fulfilled",l.value=f,qT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,UT(s,f)))}function ub(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,qT(l),l=l.next;while(l!==g)}s.action=null}function qT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function $T(s,l){return l}function HT(s,l){if(Et){var f=Kt.formState;if(f!==null){e:{var g=ut;if(Et){if(Qt){t:{for(var x=Qt,E=bi;x.nodeType!==8;){if(!E){x=null;break t}if(x=_i(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){Qt=_i(x.nextSibling),g=x.data==="F!";break e}}ro(g)}g=!1}g&&(l=f[0])}}return f=Er(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$T,lastRenderedState:l},f.queue=g,f=dA.bind(null,ut,g),g.dispatch=f,g=cb(!1),E=mb.bind(null,ut,!1,g.queue),g=Er(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=lV.bind(null,ut,x,E,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function YT(s){var l=En();return KT(l,Gt,s)}function KT(s,l,f){if(l=ob(s,l,$T)[0],s=Ug(cs)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Sf(l)}catch(N){throw N===lu?kg:N}else g=l;l=En();var x=l.queue,E=x.dispatch;return f!==l.memoizedState&&(ut.flags|=2048,hu(9,{destroy:void 0},cV.bind(null,x,f),null)),[g,E,s]}function cV(s,l){s.action=l}function XT(s){var l=En(),f=Gt;if(f!==null)return KT(l,f,s);En(),l=l.memoizedState,f=En();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function hu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=ut.updateQueue,l===null&&(l=Lg(),ut.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function WT(){return En().memoizedState}function Fg(s,l,f,g){var x=Er();ut.flags|=s,x.memoizedState=hu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Gg(s,l,f,g){var x=En();g=g===void 0?null:g;var E=x.memoizedState.inst;Gt!==null&&g!==null&&tb(g,Gt.memoizedState.deps)?x.memoizedState=hu(l,E,f,g):(ut.flags|=s,x.memoizedState=hu(1|l,E,f,g))}function QT(s,l){Fg(8390656,8,s,l)}function db(s,l){Gg(2048,8,s,l)}function uV(s){ut.flags|=4;var l=ut.updateQueue;if(l===null)l=Lg(),ut.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function ZT(s){var l=En().memoizedState;return uV({ref:l,nextImpl:s}),function(){if((Mt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function JT(s,l){return Gg(4,2,s,l)}function eA(s,l){return Gg(4,4,s,l)}function tA(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function nA(s,l,f){f=f!=null?f.concat([s]):null,Gg(4,4,tA.bind(null,l,s),f)}function fb(){}function rA(s,l){var f=En();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&tb(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function iA(s,l){var f=En();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&tb(l,g[1]))return g[0];if(g=s(),jl){dr(!0);try{s()}finally{dr(!1)}}return f.memoizedState=[g,l],g}function hb(s,l,f){return f===void 0||(ls&1073741824)!==0&&(bt&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=aC(),ut.lanes|=s,ho|=s,f)}function aA(s,l,f,g){return Qr(f,l)?f:uu.current!==null?(s=hb(s,f,g),Qr(s,l)||(Pn=!0),s):(ls&42)===0||(ls&1073741824)!==0&&(bt&261930)===0?(Pn=!0,s.memoizedState=f):(s=aC(),ut.lanes|=s,ho|=s,l)}function sA(s,l,f,g,x){var E=W.p;W.p=E!==0&&8>E?E:8;var N=$.T,F={};$.T=F,mb(s,!1,l,f);try{var Q=x(),ue=$.S;if(ue!==null&&ue(F,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ye=aV(Q,g);Tf(s,l,ye,ri(s))}else Tf(s,l,g,ri(s))}catch(_e){Tf(s,l,{then:function(){},status:"rejected",reason:_e},ri())}finally{W.p=E,N!==null&&F.types!==null&&(N.types=F.types),$.T=N}}function dV(){}function pb(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=oA(s).queue;sA(s,x,l,ee,f===null?dV:function(){return lA(s),f(g)})}function oA(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:ee},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:cs,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function lA(s){var l=oA(s);l.next===null&&(l=s.alternate.memoizedState),Tf(s,l.next.queue,{},ri())}function gb(){return rr(Ff)}function cA(){return En().memoizedState}function uA(){return En().memoizedState}function fV(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=ri();s=so(f);var g=oo(l,s,f);g!==null&&(zr(g,l,f),xf(g,l,f)),l={cache:qy()},s.payload=l;return}l=l.return}}function hV(s,l,f){var g=ri();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},qg(s)?fA(l,f):(f=My(s,l,f,g),f!==null&&(zr(f,s,g),hA(f,l,g)))}function dA(s,l,f){var g=ri();Tf(s,l,f,g)}function Tf(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(qg(s))fA(l,x);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var N=l.lastRenderedState,F=E(N,f);if(x.hasEagerState=!0,x.eagerState=F,Qr(F,N))return Sg(s,l,x,0),Kt===null&&Eg(),!1}catch{}finally{}if(f=My(s,l,x,g),f!==null)return zr(f,s,g),hA(f,l,g),!0}return!1}function mb(s,l,f,g){if(g={lane:2,revertLane:Kb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},qg(s)){if(l)throw Error(r(479))}else l=My(s,f,g,2),l!==null&&zr(l,s,2)}function qg(s){var l=s.alternate;return s===ut||l!==null&&l===ut}function fA(s,l){du=Vg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function hA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Hd(s,f)}}var Af={readContext:rr,use:Bg,useCallback:gn,useContext:gn,useEffect:gn,useImperativeHandle:gn,useLayoutEffect:gn,useInsertionEffect:gn,useMemo:gn,useReducer:gn,useRef:gn,useState:gn,useDebugValue:gn,useDeferredValue:gn,useTransition:gn,useSyncExternalStore:gn,useId:gn,useHostTransitionStatus:gn,useFormState:gn,useActionState:gn,useOptimistic:gn,useMemoCache:gn,useCacheRefresh:gn};Af.useEffectEvent=gn;var pA={readContext:rr,use:Bg,useCallback:function(s,l){return Er().memoizedState=[s,l===void 0?null:l],s},useContext:rr,useEffect:QT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Fg(4194308,4,tA.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Fg(4194308,4,s,l)},useInsertionEffect:function(s,l){Fg(4,2,s,l)},useMemo:function(s,l){var f=Er();l=l===void 0?null:l;var g=s();if(jl){dr(!0);try{s()}finally{dr(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Er();if(f!==void 0){var x=f(l);if(jl){dr(!0);try{f(l)}finally{dr(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=hV.bind(null,ut,s),[g.memoizedState,s]},useRef:function(s){var l=Er();return s={current:s},l.memoizedState=s},useState:function(s){s=cb(s);var l=s.queue,f=dA.bind(null,ut,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:fb,useDeferredValue:function(s,l){var f=Er();return hb(f,s,l)},useTransition:function(){var s=cb(!1);return s=sA.bind(null,ut,s.queue,!0,!1),Er().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=ut,x=Er();if(Et){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Kt===null)throw Error(r(349));(bt&127)!==0||OT(g,l,f)}x.memoizedState=f;var E={value:f,getSnapshot:l};return x.queue=E,QT(VT.bind(null,g,E,s),[s]),g.flags|=2048,hu(9,{destroy:void 0},jT.bind(null,g,E,f,l),null),f},useId:function(){var s=Er(),l=Kt.identifierPrefix;if(Et){var f=Ia,g=Ca;f=(g&~(1<<32-on(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=zg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=sV++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:gb,useFormState:HT,useActionState:HT,useOptimistic:function(s){var l=Er();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=mb.bind(null,ut,!0,f),f.dispatch=l,[s,l]},useMemoCache:sb,useCacheRefresh:function(){return Er().memoizedState=fV.bind(null,ut)},useEffectEvent:function(s){var l=Er(),f={impl:s};return l.memoizedState=f,function(){if((Mt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},vb={readContext:rr,use:Bg,useCallback:rA,useContext:rr,useEffect:db,useImperativeHandle:nA,useInsertionEffect:JT,useLayoutEffect:eA,useMemo:iA,useReducer:Ug,useRef:WT,useState:function(){return Ug(cs)},useDebugValue:fb,useDeferredValue:function(s,l){var f=En();return aA(f,Gt.memoizedState,s,l)},useTransition:function(){var s=Ug(cs)[0],l=En().memoizedState;return[typeof s=="boolean"?s:Sf(s),l]},useSyncExternalStore:PT,useId:cA,useHostTransitionStatus:gb,useFormState:YT,useActionState:YT,useOptimistic:function(s,l){var f=En();return BT(f,Gt,s,l)},useMemoCache:sb,useCacheRefresh:uA};vb.useEffectEvent=ZT;var gA={readContext:rr,use:Bg,useCallback:rA,useContext:rr,useEffect:db,useImperativeHandle:nA,useInsertionEffect:JT,useLayoutEffect:eA,useMemo:iA,useReducer:lb,useRef:WT,useState:function(){return lb(cs)},useDebugValue:fb,useDeferredValue:function(s,l){var f=En();return Gt===null?hb(f,s,l):aA(f,Gt.memoizedState,s,l)},useTransition:function(){var s=lb(cs)[0],l=En().memoizedState;return[typeof s=="boolean"?s:Sf(s),l]},useSyncExternalStore:PT,useId:cA,useHostTransitionStatus:gb,useFormState:XT,useActionState:XT,useOptimistic:function(s,l){var f=En();return Gt!==null?BT(f,Gt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:sb,useCacheRefresh:uA};gA.useEffectEvent=ZT;function yb(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var bb={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=ri(),x=so(g);x.payload=l,f!=null&&(x.callback=f),l=oo(s,x,g),l!==null&&(zr(l,s,g),xf(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=ri(),x=so(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=oo(s,x,g),l!==null&&(zr(l,s,g),xf(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=ri(),g=so(f);g.tag=2,l!=null&&(g.callback=l),l=oo(s,g,f),l!==null&&(zr(l,s,f),xf(l,s,f))}};function mA(s,l,f,g,x,E,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,N):l.prototype&&l.prototype.isPureReactComponent?!ff(f,g)||!ff(x,E):!0}function vA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&bb.enqueueReplaceState(l,l.state,null)}function Vl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function yA(s){wg(s)}function bA(s){console.error(s)}function xA(s){wg(s)}function $g(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function _A(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function xb(s,l,f){return f=so(f),f.tag=3,f.payload={element:null},f.callback=function(){$g(s,l)},f}function wA(s){return s=so(s),s.tag=3,s}function EA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var E=g.value;s.payload=function(){return x(E)},s.callback=function(){_A(l,f,g)}}var N=f.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){_A(l,f,g),typeof x!="function"&&(po===null?po=new Set([this]):po.add(this));var F=g.stack;this.componentDidCatch(g.value,{componentStack:F!==null?F:""})})}function pV(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&au(l,f,x,!0),f=Jr.current,f!==null){switch(f.tag){case 31:case 13:return xi===null?rm():f.alternate===null&&mn===0&&(mn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Ng?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),$b(s,g,x)),!1;case 22:return f.flags|=65536,g===Ng?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),$b(s,g,x)),!1}throw Error(r(435,f.tag))}return $b(s,g,x),rm(),!1}if(Et)return l=Jr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Ly&&(s=Error(r(422),{cause:g}),gf(mi(s,f)))):(g!==Ly&&(l=Error(r(423),{cause:g}),gf(mi(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=mi(g,f),x=xb(s.stateNode,g,x),Wy(s,x),mn!==4&&(mn=2)),!1;var E=Error(r(520),{cause:g});if(E=mi(E,f),Pf===null?Pf=[E]:Pf.push(E),mn!==4&&(mn=2),l===null)return!0;g=mi(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=xb(f.stateNode,g,s),Wy(f,s),!1;case 1:if(l=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(po===null||!po.has(E))))return f.flags|=65536,x&=-x,f.lanes|=x,x=wA(x),EA(x,s,f,g),Wy(f,x),!1}f=f.return}while(f!==null);return!1}var _b=Error(r(461)),Pn=!1;function ir(s,l,f,g){l.child=s===null?CT(l,null,f,g):Ol(l,s.child,f,g)}function SA(s,l,f,g,x){f=f.render;var E=l.ref;if("ref"in g){var N={};for(var F in g)F!=="ref"&&(N[F]=g[F])}else N=g;return kl(l),g=nb(s,l,f,N,E,x),F=rb(),s!==null&&!Pn?(ib(s,l,x),us(s,l,x)):(Et&&F&&Vy(l),l.flags|=1,ir(s,l,g,x),l.child)}function TA(s,l,f,g,x){if(s===null){var E=f.type;return typeof E=="function"&&!Py(E)&&E.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=E,AA(s,l,E,g,x)):(s=Ag(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!Rb(s,x)){var N=E.memoizedProps;if(f=f.compare,f=f!==null?f:ff,f(N,g)&&s.ref===l.ref)return us(s,l,x)}return l.flags|=1,s=is(E,g),s.ref=l.ref,s.return=l,l.child=s}function AA(s,l,f,g,x){if(s!==null){var E=s.memoizedProps;if(ff(E,g)&&s.ref===l.ref)if(Pn=!1,l.pendingProps=g=E,Rb(s,x))(s.flags&131072)!==0&&(Pn=!0);else return l.lanes=s.lanes,us(s,l,x)}return wb(s,l,f,g,x)}function CA(s,l,f,g){var x=g.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~E}else g=0,l.child=null;return IA(s,l,E,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Dg(l,E!==null?E.cachePool:null),E!==null?DT(l,E):Zy(),kT(l);else return g=l.lanes=536870912,IA(s,l,E!==null?E.baseLanes|f:f,f,g)}else E!==null?(Dg(l,E.cachePool),DT(l,E),co(),l.memoizedState=null):(s!==null&&Dg(l,null),Zy(),co());return ir(s,l,x,f),l.child}function Cf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function IA(s,l,f,g,x){var E=Hy();return E=E===null?null:{parent:Nn._currentValue,pool:E},l.memoizedState={baseLanes:f,cachePool:E},s!==null&&Dg(l,null),Zy(),kT(l),s!==null&&au(s,l,g,!0),l.childLanes=x,null}function Hg(s,l){return l=Kg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function RA(s,l,f){return Ol(l,s.child,null,f),s=Hg(l,l.pendingProps),s.flags|=2,ei(l),l.memoizedState=null,s}function gV(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Et){if(g.mode==="hidden")return s=Hg(l,g),l.lanes=536870912,Cf(null,s);if(eb(l),(s=Qt)?(s=UC(s,bi),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:to!==null?{id:Ca,overflow:Ia}:null,retryLane:536870912,hydrationErrors:null},f=fT(s),f.return=l,l.child=f,nr=l,Qt=null)):s=null,s===null)throw ro(l);return l.lanes=536870912,null}return Hg(l,g)}var E=s.memoizedState;if(E!==null){var N=E.dehydrated;if(eb(l),x)if(l.flags&256)l.flags&=-257,l=RA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Pn||au(s,l,f,!1),x=(f&s.childLanes)!==0,Pn||x){if(g=Kt,g!==null&&(N=Yd(g,f),N!==0&&N!==E.retryLane))throw E.retryLane=N,Cl(s,N),zr(g,s,N),_b;rm(),l=RA(s,l,f)}else s=E.treeContext,Qt=_i(N.nextSibling),nr=l,Et=!0,no=null,bi=!1,s!==null&&gT(l,s),l=Hg(l,g),l.flags|=4096;return l}return s=is(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Yg(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function wb(s,l,f,g,x){return kl(l),f=nb(s,l,f,g,void 0,x),g=rb(),s!==null&&!Pn?(ib(s,l,x),us(s,l,x)):(Et&&g&&Vy(l),l.flags|=1,ir(s,l,f,x),l.child)}function DA(s,l,f,g,x,E){return kl(l),l.updateQueue=null,f=MT(l,g,f,x),NT(s),g=rb(),s!==null&&!Pn?(ib(s,l,E),us(s,l,E)):(Et&&g&&Vy(l),l.flags|=1,ir(s,l,f,E),l.child)}function kA(s,l,f,g,x){if(kl(l),l.stateNode===null){var E=tu,N=f.contextType;typeof N=="object"&&N!==null&&(E=rr(N)),E=new f(g,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=bb,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=g,E.state=l.memoizedState,E.refs={},Ky(l),N=f.contextType,E.context=typeof N=="object"&&N!==null?rr(N):tu,E.state=l.memoizedState,N=f.getDerivedStateFromProps,typeof N=="function"&&(yb(l,f,N,g),E.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(N=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),N!==E.state&&bb.enqueueReplaceState(E,E.state,null),wf(l,g,E,x),_f(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){E=l.stateNode;var F=l.memoizedProps,Q=Vl(f,F);E.props=Q;var ue=E.context,ye=f.contextType;N=tu,typeof ye=="object"&&ye!==null&&(N=rr(ye));var _e=f.getDerivedStateFromProps;ye=typeof _e=="function"||typeof E.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,ye||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F||ue!==N)&&vA(l,E,g,N),ao=!1;var de=l.memoizedState;E.state=de,wf(l,g,E,x),_f(),ue=l.memoizedState,F||de!==ue||ao?(typeof _e=="function"&&(yb(l,f,_e,g),ue=l.memoizedState),(Q=ao||mA(l,f,Q,g,de,ue,N))?(ye||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ue),E.props=g,E.state=ue,E.context=N,g=Q):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{E=l.stateNode,Xy(s,l),N=l.memoizedProps,ye=Vl(f,N),E.props=ye,_e=l.pendingProps,de=E.context,ue=f.contextType,Q=tu,typeof ue=="object"&&ue!==null&&(Q=rr(ue)),F=f.getDerivedStateFromProps,(ue=typeof F=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(N!==_e||de!==Q)&&vA(l,E,g,Q),ao=!1,de=l.memoizedState,E.state=de,wf(l,g,E,x),_f();var ge=l.memoizedState;N!==_e||de!==ge||ao||s!==null&&s.dependencies!==null&&Ig(s.dependencies)?(typeof F=="function"&&(yb(l,f,F,g),ge=l.memoizedState),(ye=ao||mA(l,f,ye,g,de,ge,Q)||s!==null&&s.dependencies!==null&&Ig(s.dependencies))?(ue||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(g,ge,Q),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(g,ge,Q)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ge),E.props=g,E.state=ge,E.context=Q,g=ye):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=1024),g=!1)}return E=g,Yg(s,l),g=(l.flags&128)!==0,E||g?(E=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&g?(l.child=Ol(l,s.child,null,x),l.child=Ol(l,null,f,x)):ir(s,l,f,x),l.memoizedState=E.state,s=l.child):s=us(s,l,x),s}function NA(s,l,f,g){return Rl(),l.flags|=256,ir(s,l,f,g),l.child}var Eb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Sb(s){return{baseLanes:s,cachePool:_T()}}function Tb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=ni),s}function MA(s,l,f){var g=l.pendingProps,x=!1,E=(l.flags&128)!==0,N;if((N=E)||(N=s!==null&&s.memoizedState===null?!1:(wn.current&2)!==0),N&&(x=!0,l.flags&=-129),N=(l.flags&32)!==0,l.flags&=-33,s===null){if(Et){if(x?lo(l):co(),(s=Qt)?(s=UC(s,bi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:to!==null?{id:Ca,overflow:Ia}:null,retryLane:536870912,hydrationErrors:null},f=fT(s),f.return=l,l.child=f,nr=l,Qt=null)):s=null,s===null)throw ro(l);return ox(s)?l.lanes=32:l.lanes=536870912,null}var F=g.children;return g=g.fallback,x?(co(),x=l.mode,F=Kg({mode:"hidden",children:F},x),g=Il(g,x,f,null),F.return=l,g.return=l,F.sibling=g,l.child=F,g=l.child,g.memoizedState=Sb(f),g.childLanes=Tb(s,N,f),l.memoizedState=Eb,Cf(null,g)):(lo(l),Ab(l,F))}var Q=s.memoizedState;if(Q!==null&&(F=Q.dehydrated,F!==null)){if(E)l.flags&256?(lo(l),l.flags&=-257,l=Cb(s,l,f)):l.memoizedState!==null?(co(),l.child=s.child,l.flags|=128,l=null):(co(),F=g.fallback,x=l.mode,g=Kg({mode:"visible",children:g.children},x),F=Il(F,x,f,null),F.flags|=2,g.return=l,F.return=l,g.sibling=F,l.child=g,Ol(l,s.child,null,f),g=l.child,g.memoizedState=Sb(f),g.childLanes=Tb(s,N,f),l.memoizedState=Eb,l=Cf(null,g));else if(lo(l),ox(F)){if(N=F.nextSibling&&F.nextSibling.dataset,N)var ue=N.dgst;N=ue,g=Error(r(419)),g.stack="",g.digest=N,gf({value:g,source:null,stack:null}),l=Cb(s,l,f)}else if(Pn||au(s,l,f,!1),N=(f&s.childLanes)!==0,Pn||N){if(N=Kt,N!==null&&(g=Yd(N,f),g!==0&&g!==Q.retryLane))throw Q.retryLane=g,Cl(s,g),zr(N,s,g),_b;sx(F)||rm(),l=Cb(s,l,f)}else sx(F)?(l.flags|=192,l.child=s.child,l=null):(s=Q.treeContext,Qt=_i(F.nextSibling),nr=l,Et=!0,no=null,bi=!1,s!==null&&gT(l,s),l=Ab(l,g.children),l.flags|=4096);return l}return x?(co(),F=g.fallback,x=l.mode,Q=s.child,ue=Q.sibling,g=is(Q,{mode:"hidden",children:g.children}),g.subtreeFlags=Q.subtreeFlags&65011712,ue!==null?F=is(ue,F):(F=Il(F,x,f,null),F.flags|=2),F.return=l,g.return=l,g.sibling=F,l.child=g,Cf(null,g),g=l.child,F=s.child.memoizedState,F===null?F=Sb(f):(x=F.cachePool,x!==null?(Q=Nn._currentValue,x=x.parent!==Q?{parent:Q,pool:Q}:x):x=_T(),F={baseLanes:F.baseLanes|f,cachePool:x}),g.memoizedState=F,g.childLanes=Tb(s,N,f),l.memoizedState=Eb,Cf(s.child,g)):(lo(l),f=s.child,s=f.sibling,f=is(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(N=l.deletions,N===null?(l.deletions=[s],l.flags|=16):N.push(s)),l.child=f,l.memoizedState=null,f)}function Ab(s,l){return l=Kg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Kg(s,l){return s=Zr(22,s,null,l),s.lanes=0,s}function Cb(s,l,f){return Ol(l,s.child,null,f),s=Ab(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function PA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Fy(s.return,l,f)}function Ib(s,l,f,g,x,E){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:E}:(N.isBackwards=l,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=f,N.tailMode=x,N.treeForkCount=E)}function OA(s,l,f){var g=l.pendingProps,x=g.revealOrder,E=g.tail;g=g.children;var N=wn.current,F=(N&2)!==0;if(F?(N=N&1|2,l.flags|=128):N&=1,re(wn,N),ir(s,l,g,f),g=Et?pf:0,!F&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&PA(s,f,l);else if(s.tag===19)PA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&jg(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),Ib(l,!1,x,f,E,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&jg(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}Ib(l,!0,f,null,E,g);break;case"together":Ib(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function us(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),ho|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(au(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=is(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=is(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function Rb(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Ig(s)))}function mV(s,l,f){switch(l.tag){case 3:ve(l,l.stateNode.containerInfo),io(l,Nn,s.memoizedState.cache),Rl();break;case 27:case 5:Ge(l);break;case 4:ve(l,l.stateNode.containerInfo);break;case 10:io(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,eb(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(lo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?MA(s,l,f):(lo(l),s=us(s,l,f),s!==null?s.sibling:null);lo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(au(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return OA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),re(wn,wn.current),g)break;return null;case 22:return l.lanes=0,CA(s,l,f,l.pendingProps);case 24:io(l,Nn,s.memoizedState.cache)}return us(s,l,f)}function jA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Pn=!0;else{if(!Rb(s,f)&&(l.flags&128)===0)return Pn=!1,mV(s,l,f);Pn=(s.flags&131072)!==0}else Pn=!1,Et&&(l.flags&1048576)!==0&&pT(l,pf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=Ml(l.elementType),l.type=s,typeof s=="function")Py(s)?(g=Vl(s,g),l.tag=1,l=kA(null,l,s,g,f)):(l.tag=0,l=wb(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===O){l.tag=11,l=SA(null,l,s,g,f);break e}else if(x===A){l.tag=14,l=TA(null,l,s,g,f);break e}}throw l=X(s)||s,Error(r(306,l,""))}}return l;case 0:return wb(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Vl(g,l.pendingProps),kA(s,l,g,x,f);case 3:e:{if(ve(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var E=l.memoizedState;x=E.element,Xy(s,l),wf(l,g,null,f);var N=l.memoizedState;if(g=N.cache,io(l,Nn,g),g!==E.cache&&Gy(l,[Nn],f,!0),_f(),g=N.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:N.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=NA(s,l,g,f);break e}else if(g!==x){x=mi(Error(r(424)),l),gf(x),l=NA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Qt=_i(s.firstChild),nr=l,Et=!0,no=null,bi=!0,f=CT(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Rl(),g===x){l=us(s,l,f);break e}ir(s,l,g,f)}l=l.child}return l;case 26:return Yg(s,l),s===null?(f=YC(l.type,null,l.pendingProps,null))?l.memoizedState=f:Et||(f=l.type,s=l.pendingProps,g=um(fe.current).createElement(f),g[Rn]=l,g[Qn]=s,ar(g,f,s),Dn(g),l.stateNode=g):l.memoizedState=YC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Ge(l),s===null&&Et&&(g=l.stateNode=qC(l.type,l.pendingProps,fe.current),nr=l,bi=!0,x=Qt,yo(l.type)?(lx=x,Qt=_i(g.firstChild)):Qt=x),ir(s,l,l.pendingProps.children,f),Yg(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Et&&((x=g=Qt)&&(g=HV(g,l.type,l.pendingProps,bi),g!==null?(l.stateNode=g,nr=l,Qt=_i(g.firstChild),bi=!1,x=!0):x=!1),x||ro(l)),Ge(l),x=l.type,E=l.pendingProps,N=s!==null?s.memoizedProps:null,g=E.children,rx(x,E)?g=null:N!==null&&rx(x,N)&&(l.flags|=32),l.memoizedState!==null&&(x=nb(s,l,oV,null,null,f),Ff._currentValue=x),Yg(s,l),ir(s,l,g,f),l.child;case 6:return s===null&&Et&&((s=f=Qt)&&(f=YV(f,l.pendingProps,bi),f!==null?(l.stateNode=f,nr=l,Qt=null,s=!0):s=!1),s||ro(l)),null;case 13:return MA(s,l,f);case 4:return ve(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Ol(l,null,g,f):ir(s,l,g,f),l.child;case 11:return SA(s,l,l.type,l.pendingProps,f);case 7:return ir(s,l,l.pendingProps,f),l.child;case 8:return ir(s,l,l.pendingProps.children,f),l.child;case 12:return ir(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,io(l,l.type,g.value),ir(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,kl(l),x=rr(x),g=g(x),l.flags|=1,ir(s,l,g,f),l.child;case 14:return TA(s,l,l.type,l.pendingProps,f);case 15:return AA(s,l,l.type,l.pendingProps,f);case 19:return OA(s,l,f);case 31:return gV(s,l,f);case 22:return CA(s,l,f,l.pendingProps);case 24:return kl(l),g=rr(Nn),s===null?(x=Hy(),x===null&&(x=Kt,E=qy(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=f),x=E),l.memoizedState={parent:g,cache:x},Ky(l),io(l,Nn,x)):((s.lanes&f)!==0&&(Xy(s,l),wf(l,null,null,f),_f()),x=s.memoizedState,E=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),io(l,Nn,g)):(g=E.cache,io(l,Nn,g),g!==x.cache&&Gy(l,[Nn],f,!0))),ir(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function ds(s){s.flags|=4}function Db(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(cC())s.flags|=8192;else throw Pl=Ng,Yy}else s.flags&=-16777217}function VA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!ZC(l))if(cC())s.flags|=8192;else throw Pl=Ng,Yy}function Xg(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?tg():536870912,s.lanes|=l,vu|=l)}function If(s,l){if(!Et)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function Zt(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function vV(s,l,f){var g=l.pendingProps;switch(zy(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(l),null;case 1:return Zt(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),os(Nn),Ce(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(iu(l)?ds(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,By())),Zt(l),null;case 26:var x=l.type,E=l.memoizedState;return s===null?(ds(l),E!==null?(Zt(l),VA(l,E)):(Zt(l),Db(l,x,null,g,f))):E?E!==s.memoizedState?(ds(l),Zt(l),VA(l,E)):(Zt(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&ds(l),Zt(l),Db(l,x,s,g,f)),null;case 27:if(ae(l),f=fe.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&ds(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Zt(l),null}s=Z.current,iu(l)?mT(l):(s=qC(x,g,f),l.stateNode=s,ds(l))}return Zt(l),null;case 5:if(ae(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&ds(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Zt(l),null}if(E=Z.current,iu(l))mT(l);else{var N=um(fe.current);switch(E){case 1:E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=N.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof g.is=="string"?N.createElement("select",{is:g.is}):N.createElement("select"),g.multiple?E.multiple=!0:g.size&&(E.size=g.size);break;default:E=typeof g.is=="string"?N.createElement(x,{is:g.is}):N.createElement(x)}}E[Rn]=l,E[Qn]=g;e:for(N=l.child;N!==null;){if(N.tag===5||N.tag===6)E.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===l)break e;for(;N.sibling===null;){if(N.return===null||N.return===l)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}l.stateNode=E;e:switch(ar(E,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&ds(l)}}return Zt(l),Db(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&ds(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=fe.current,iu(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=nr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[Rn]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||MC(s.nodeValue,f)),s||ro(l,!0)}else s=um(s).createTextNode(g),s[Rn]=l,l.stateNode=s}return Zt(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=iu(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Rn]=l}else Rl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Zt(l),s=!1}else f=By(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(ei(l),l):(ei(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Zt(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=iu(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Rn]=l}else Rl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Zt(l),x=!1}else x=By(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(ei(l),l):(ei(l),null)}return ei(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Xg(l,l.updateQueue),Zt(l),null);case 4:return Ce(),s===null&&Zb(l.stateNode.containerInfo),Zt(l),null;case 10:return os(l.type),Zt(l),null;case 19:if(Y(wn),g=l.memoizedState,g===null)return Zt(l),null;if(x=(l.flags&128)!==0,E=g.rendering,E===null)if(x)If(g,!1);else{if(mn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=jg(s),E!==null){for(l.flags|=128,If(g,!1),s=E.updateQueue,l.updateQueue=s,Xg(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)dT(f,s),f=f.sibling;return re(wn,wn.current&1|2),Et&&as(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&ft()>em&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304)}else{if(!x)if(s=jg(E),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Xg(l,s),If(g,!0),g.tail===null&&g.tailMode==="hidden"&&!E.alternate&&!Et)return Zt(l),null}else 2*ft()-g.renderingStartTime>em&&f!==536870912&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304);g.isBackwards?(E.sibling=l.child,l.child=E):(s=g.last,s!==null?s.sibling=E:l.child=E,g.last=E)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=ft(),s.sibling=null,f=wn.current,re(wn,x?f&1|2:f&1),Et&&as(l,g.treeForkCount),s):(Zt(l),null);case 22:case 23:return ei(l),Jy(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(Zt(l),l.subtreeFlags&6&&(l.flags|=8192)):Zt(l),f=l.updateQueue,f!==null&&Xg(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&Y(Nl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),os(Nn),Zt(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function yV(s,l){switch(zy(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return os(Nn),Ce(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return ae(l),null;case 31:if(l.memoizedState!==null){if(ei(l),l.alternate===null)throw Error(r(340));Rl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(ei(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Rl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Y(wn),null;case 4:return Ce(),null;case 10:return os(l.type),null;case 22:case 23:return ei(l),Jy(),s!==null&&Y(Nl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return os(Nn),null;case 25:return null;default:return null}}function zA(s,l){switch(zy(l),l.tag){case 3:os(Nn),Ce();break;case 26:case 27:case 5:ae(l);break;case 4:Ce();break;case 31:l.memoizedState!==null&&ei(l);break;case 13:ei(l);break;case 19:Y(wn);break;case 10:os(l.type);break;case 22:case 23:ei(l),Jy(),s!==null&&Y(Nl);break;case 24:os(Nn)}}function Rf(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var E=f.create,N=f.inst;g=E(),N.destroy=g}f=f.next}while(f!==x)}}catch(F){Vt(l,l.return,F)}}function uo(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var E=x.next;g=E;do{if((g.tag&s)===s){var N=g.inst,F=N.destroy;if(F!==void 0){N.destroy=void 0,x=l;var Q=f,ue=F;try{ue()}catch(ye){Vt(x,Q,ye)}}}g=g.next}while(g!==E)}}catch(ye){Vt(l,l.return,ye)}}function LA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{RT(l,f)}catch(g){Vt(s,s.return,g)}}}function BA(s,l,f){f.props=Vl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){Vt(s,l,g)}}function Df(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){Vt(s,l,x)}}function Ra(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){Vt(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Vt(s,l,x)}else f.current=null}function UA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){Vt(s,s.return,x)}}function kb(s,l,f){try{var g=s.stateNode;BV(g,s.type,f,l),g[Qn]=l}catch(x){Vt(s,s.return,x)}}function FA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&yo(s.type)||s.tag===4}function Nb(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||FA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&yo(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Mb(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Li));else if(g!==4&&(g===27&&yo(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(Mb(s,l,f),s=s.sibling;s!==null;)Mb(s,l,f),s=s.sibling}function Wg(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&yo(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Wg(s,l,f),s=s.sibling;s!==null;)Wg(s,l,f),s=s.sibling}function GA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);ar(l,g,f),l[Rn]=s,l[Qn]=f}catch(E){Vt(s,s.return,E)}}var fs=!1,On=!1,Pb=!1,qA=typeof WeakSet=="function"?WeakSet:Set,Jn=null;function bV(s,l){if(s=s.containerInfo,tx=vm,s=nT(s),Cy(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var N=0,F=-1,Q=-1,ue=0,ye=0,_e=s,de=null;t:for(;;){for(var ge;_e!==f||x!==0&&_e.nodeType!==3||(F=N+x),_e!==E||g!==0&&_e.nodeType!==3||(Q=N+g),_e.nodeType===3&&(N+=_e.nodeValue.length),(ge=_e.firstChild)!==null;)de=_e,_e=ge;for(;;){if(_e===s)break t;if(de===f&&++ue===x&&(F=N),de===E&&++ye===g&&(Q=N),(ge=_e.nextSibling)!==null)break;_e=de,de=_e.parentNode}_e=ge}f=F===-1||Q===-1?null:{start:F,end:Q}}else f=null}f=f||{start:0,end:0}}else f=null;for(nx={focusedElem:s,selectionRange:f},vm=!1,Jn=l;Jn!==null;)if(l=Jn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Jn=s;else for(;Jn!==null;){switch(l=Jn,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,f=l,x=E.memoizedProps,E=E.memoizedState,g=f.stateNode;try{var je=Vl(f.type,x);s=g.getSnapshotBeforeUpdate(je,E),g.__reactInternalSnapshotBeforeUpdate=s}catch(Qe){Vt(f,f.return,Qe)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)ax(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ax(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,Jn=s;break}Jn=l.return}}function $A(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:ps(s,f),g&4&&Rf(5,f);break;case 1:if(ps(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(N){Vt(f,f.return,N)}else{var x=Vl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Vt(f,f.return,N)}}g&64&&LA(f),g&512&&Df(f,f.return);break;case 3:if(ps(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{RT(s,l)}catch(N){Vt(f,f.return,N)}}break;case 27:l===null&&g&4&&GA(f);case 26:case 5:ps(s,f),l===null&&g&4&&UA(f),g&512&&Df(f,f.return);break;case 12:ps(s,f);break;case 31:ps(s,f),g&4&&KA(s,f);break;case 13:ps(s,f),g&4&&XA(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=IV.bind(null,f),KV(s,f))));break;case 22:if(g=f.memoizedState!==null||fs,!g){l=l!==null&&l.memoizedState!==null||On,x=fs;var E=On;fs=g,(On=l)&&!E?gs(s,f,(f.subtreeFlags&8772)!==0):ps(s,f),fs=x,On=E}break;case 30:break;default:ps(s,f)}}function HA(s){var l=s.alternate;l!==null&&(s.alternate=null,HA(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Uc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var tn=null,Pr=!1;function hs(s,l,f){for(f=f.child;f!==null;)YA(s,l,f),f=f.sibling}function YA(s,l,f){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(Yr,f)}catch{}switch(f.tag){case 26:On||Ra(f,l),hs(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:On||Ra(f,l);var g=tn,x=Pr;yo(f.type)&&(tn=f.stateNode,Pr=!1),hs(s,l,f),Lf(f.stateNode),tn=g,Pr=x;break;case 5:On||Ra(f,l);case 6:if(g=tn,x=Pr,tn=null,hs(s,l,f),tn=g,Pr=x,tn!==null)if(Pr)try{(tn.nodeType===9?tn.body:tn.nodeName==="HTML"?tn.ownerDocument.body:tn).removeChild(f.stateNode)}catch(E){Vt(f,l,E)}else try{tn.removeChild(f.stateNode)}catch(E){Vt(f,l,E)}break;case 18:tn!==null&&(Pr?(s=tn,LC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Tu(s)):LC(tn,f.stateNode));break;case 4:g=tn,x=Pr,tn=f.stateNode.containerInfo,Pr=!0,hs(s,l,f),tn=g,Pr=x;break;case 0:case 11:case 14:case 15:uo(2,f,l),On||uo(4,f,l),hs(s,l,f);break;case 1:On||(Ra(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&BA(f,l,g)),hs(s,l,f);break;case 21:hs(s,l,f);break;case 22:On=(g=On)||f.memoizedState!==null,hs(s,l,f),On=g;break;default:hs(s,l,f)}}function KA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Tu(s)}catch(f){Vt(l,l.return,f)}}}function XA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Tu(s)}catch(f){Vt(l,l.return,f)}}function xV(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new qA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new qA),l;default:throw Error(r(435,s.tag))}}function Qg(s,l){var f=xV(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=RV.bind(null,s,g);g.then(x,x)}})}function Or(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],E=s,N=l,F=N;e:for(;F!==null;){switch(F.tag){case 27:if(yo(F.type)){tn=F.stateNode,Pr=!1;break e}break;case 5:tn=F.stateNode,Pr=!1;break e;case 3:case 4:tn=F.stateNode.containerInfo,Pr=!0;break e}F=F.return}if(tn===null)throw Error(r(160));YA(E,N,x),tn=null,Pr=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)WA(l,s),l=l.sibling}var $i=null;function WA(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Or(l,s),jr(s),g&4&&(uo(3,s,s.return),Rf(3,s),uo(5,s,s.return));break;case 1:Or(l,s),jr(s),g&512&&(On||f===null||Ra(f,f.return)),g&64&&fs&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=$i;if(Or(l,s),jr(s),g&512&&(On||f===null||Ra(f,f.return)),g&4){var E=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":E=x.getElementsByTagName("title")[0],(!E||E[ga]||E[Rn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(g),x.head.insertBefore(E,x.querySelector("head > title"))),ar(E,g,f),E[Rn]=s,Dn(E),g=E;break e;case"link":var N=WC("link","href",x).get(g+(f.href||""));if(N){for(var F=0;F<N.length;F++)if(E=N[F],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){N.splice(F,1);break t}}E=x.createElement(g),ar(E,g,f),x.head.appendChild(E);break;case"meta":if(N=WC("meta","content",x).get(g+(f.content||""))){for(F=0;F<N.length;F++)if(E=N[F],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){N.splice(F,1);break t}}E=x.createElement(g),ar(E,g,f),x.head.appendChild(E);break;default:throw Error(r(468,g))}E[Rn]=s,Dn(E),g=E}s.stateNode=g}else QC(x,s.type,s.stateNode);else s.stateNode=XC(x,g,s.memoizedProps);else E!==g?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,g===null?QC(x,s.type,s.stateNode):XC(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&kb(s,s.memoizedProps,f.memoizedProps)}break;case 27:Or(l,s),jr(s),g&512&&(On||f===null||Ra(f,f.return)),f!==null&&g&4&&kb(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Or(l,s),jr(s),g&512&&(On||f===null||Ra(f,f.return)),s.flags&32){x=s.stateNode;try{Mr(x,"")}catch(je){Vt(s,s.return,je)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,kb(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Pb=!0);break;case 6:if(Or(l,s),jr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(je){Vt(s,s.return,je)}}break;case 3:if(hm=null,x=$i,$i=dm(l.containerInfo),Or(l,s),$i=x,jr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Tu(l.containerInfo)}catch(je){Vt(s,s.return,je)}Pb&&(Pb=!1,QA(s));break;case 4:g=$i,$i=dm(s.stateNode.containerInfo),Or(l,s),jr(s),$i=g;break;case 12:Or(l,s),jr(s);break;case 31:Or(l,s),jr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Qg(s,g)));break;case 13:Or(l,s),jr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Jg=ft()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Qg(s,g)));break;case 22:x=s.memoizedState!==null;var Q=f!==null&&f.memoizedState!==null,ue=fs,ye=On;if(fs=ue||x,On=ye||Q,Or(l,s),On=ye,fs=ue,jr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||Q||fs||On||zl(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){Q=f=l;try{if(E=Q.stateNode,x)N=E.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{F=Q.stateNode;var _e=Q.memoizedProps.style,de=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;F.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(je){Vt(Q,Q.return,je)}}}else if(l.tag===6){if(f===null){Q=l;try{Q.stateNode.nodeValue=x?"":Q.memoizedProps}catch(je){Vt(Q,Q.return,je)}}}else if(l.tag===18){if(f===null){Q=l;try{var ge=Q.stateNode;x?BC(ge,!0):BC(Q.stateNode,!1)}catch(je){Vt(Q,Q.return,je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Qg(s,f))));break;case 19:Or(l,s),jr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Qg(s,g)));break;case 30:break;case 21:break;default:Or(l,s),jr(s)}}function jr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(FA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,E=Nb(s);Wg(s,E,x);break;case 5:var N=f.stateNode;f.flags&32&&(Mr(N,""),f.flags&=-33);var F=Nb(s);Wg(s,F,N);break;case 3:case 4:var Q=f.stateNode.containerInfo,ue=Nb(s);Mb(s,ue,Q);break;default:throw Error(r(161))}}catch(ye){Vt(s,s.return,ye)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function QA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;QA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function ps(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)$A(s,l.alternate,l),l=l.sibling}function zl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:uo(4,l,l.return),zl(l);break;case 1:Ra(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&BA(l,l.return,f),zl(l);break;case 27:Lf(l.stateNode);case 26:case 5:Ra(l,l.return),zl(l);break;case 22:l.memoizedState===null&&zl(l);break;case 30:zl(l);break;default:zl(l)}s=s.sibling}}function gs(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,E=l,N=E.flags;switch(E.tag){case 0:case 11:case 15:gs(x,E,f),Rf(4,E);break;case 1:if(gs(x,E,f),g=E,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ue){Vt(g,g.return,ue)}if(g=E,x=g.updateQueue,x!==null){var F=g.stateNode;try{var Q=x.shared.hiddenCallbacks;if(Q!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Q.length;x++)IT(Q[x],F)}catch(ue){Vt(g,g.return,ue)}}f&&N&64&&LA(E),Df(E,E.return);break;case 27:GA(E);case 26:case 5:gs(x,E,f),f&&g===null&&N&4&&UA(E),Df(E,E.return);break;case 12:gs(x,E,f);break;case 31:gs(x,E,f),f&&N&4&&KA(x,E);break;case 13:gs(x,E,f),f&&N&4&&XA(x,E);break;case 22:E.memoizedState===null&&gs(x,E,f),Df(E,E.return);break;case 30:break;default:gs(x,E,f)}l=l.sibling}}function Ob(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&mf(f))}function jb(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s))}function Hi(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)ZA(s,l,f,g),l=l.sibling}function ZA(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:Hi(s,l,f,g),x&2048&&Rf(9,l);break;case 1:Hi(s,l,f,g);break;case 3:Hi(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s)));break;case 12:if(x&2048){Hi(s,l,f,g),s=l.stateNode;try{var E=l.memoizedProps,N=E.id,F=E.onPostCommit;typeof F=="function"&&F(N,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Q){Vt(l,l.return,Q)}}else Hi(s,l,f,g);break;case 31:Hi(s,l,f,g);break;case 13:Hi(s,l,f,g);break;case 23:break;case 22:E=l.stateNode,N=l.alternate,l.memoizedState!==null?E._visibility&2?Hi(s,l,f,g):kf(s,l):E._visibility&2?Hi(s,l,f,g):(E._visibility|=2,pu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Ob(N,l);break;case 24:Hi(s,l,f,g),x&2048&&jb(l.alternate,l);break;default:Hi(s,l,f,g)}}function pu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,N=l,F=f,Q=g,ue=N.flags;switch(N.tag){case 0:case 11:case 15:pu(E,N,F,Q,x),Rf(8,N);break;case 23:break;case 22:var ye=N.stateNode;N.memoizedState!==null?ye._visibility&2?pu(E,N,F,Q,x):kf(E,N):(ye._visibility|=2,pu(E,N,F,Q,x)),x&&ue&2048&&Ob(N.alternate,N);break;case 24:pu(E,N,F,Q,x),x&&ue&2048&&jb(N.alternate,N);break;default:pu(E,N,F,Q,x)}l=l.sibling}}function kf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:kf(f,g),x&2048&&Ob(g.alternate,g);break;case 24:kf(f,g),x&2048&&jb(g.alternate,g);break;default:kf(f,g)}l=l.sibling}}var Nf=8192;function gu(s,l,f){if(s.subtreeFlags&Nf)for(s=s.child;s!==null;)JA(s,l,f),s=s.sibling}function JA(s,l,f){switch(s.tag){case 26:gu(s,l,f),s.flags&Nf&&s.memoizedState!==null&&sz(f,$i,s.memoizedState,s.memoizedProps);break;case 5:gu(s,l,f);break;case 3:case 4:var g=$i;$i=dm(s.stateNode.containerInfo),gu(s,l,f),$i=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Nf,Nf=16777216,gu(s,l,f),Nf=g):gu(s,l,f));break;default:gu(s,l,f)}}function eC(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Mf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];Jn=g,nC(g,s)}eC(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)tC(s),s=s.sibling}function tC(s){switch(s.tag){case 0:case 11:case 15:Mf(s),s.flags&2048&&uo(9,s,s.return);break;case 3:Mf(s);break;case 12:Mf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Zg(s)):Mf(s);break;default:Mf(s)}}function Zg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];Jn=g,nC(g,s)}eC(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:uo(8,l,l.return),Zg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Zg(l));break;default:Zg(l)}s=s.sibling}}function nC(s,l){for(;Jn!==null;){var f=Jn;switch(f.tag){case 0:case 11:case 15:uo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:mf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,Jn=g;else e:for(f=s;Jn!==null;){g=Jn;var x=g.sibling,E=g.return;if(HA(g),g===f){Jn=null;break e}if(x!==null){x.return=E,Jn=x;break e}Jn=E}}}var _V={getCacheForType:function(s){var l=rr(Nn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return rr(Nn).controller.signal}},wV=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Kt=null,vt=null,bt=0,jt=0,ti=null,fo=!1,mu=!1,Vb=!1,ms=0,mn=0,ho=0,Ll=0,zb=0,ni=0,vu=0,Pf=null,Vr=null,Lb=!1,Jg=0,rC=0,em=1/0,tm=null,po=null,Gn=0,go=null,yu=null,vs=0,Bb=0,Ub=null,iC=null,Of=0,Fb=null;function ri(){return(Mt&2)!==0&&bt!==0?bt&-bt:$.T!==null?Kb():ng()}function aC(){if(ni===0)if((bt&536870912)===0||Et){var s=ln;ln<<=1,(ln&3932160)===0&&(ln=262144),ni=s}else ni=536870912;return s=Jr.current,s!==null&&(s.flags|=32),ni}function zr(s,l,f){(s===Kt&&(jt===2||jt===9)||s.cancelPendingCommit!==null)&&(bu(s,0),mo(s,bt,ni,!1)),hl(s,f),((Mt&2)===0||s!==Kt)&&(s===Kt&&((Mt&2)===0&&(Ll|=f),mn===4&&mo(s,bt,ni,!1)),Da(s))}function sC(s,l,f){if((Mt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||_r(s,l),x=g?TV(s,l):qb(s,l,!0),E=g;do{if(x===0){mu&&!g&&mo(s,l,0,!1);break}else{if(f=s.current.alternate,E&&!EV(f)){x=qb(s,l,!1),E=!1;continue}if(x===2){if(E=l,s.errorRecoveryDisabledLanes&E)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){l=N;e:{var F=s;x=Pf;var Q=F.current.memoizedState.isDehydrated;if(Q&&(bu(F,N).flags|=256),N=qb(F,N,!1),N!==2){if(Vb&&!Q){F.errorRecoveryDisabledLanes|=E,Ll|=E,x=4;break e}E=Vr,Vr=x,E!==null&&(Vr===null?Vr=E:Vr.push.apply(Vr,E))}x=N}if(E=!1,x!==2)continue}}if(x===1){bu(s,0),mo(s,l,0,!0);break}e:{switch(g=s,E=x,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:mo(g,l,ni,!fo);break e;case 2:Vr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Jg+300-ft(),10<x)){if(mo(g,l,ni,!fo),ui(g,0,!0)!==0)break e;vs=l,g.timeoutHandle=VC(oC.bind(null,g,f,Vr,tm,Lb,l,ni,Ll,vu,fo,E,"Throttled",-0,0),x);break e}oC(g,f,Vr,tm,Lb,l,ni,Ll,vu,fo,E,null,-0,0)}}break}while(!0);Da(s)}function oC(s,l,f,g,x,E,N,F,Q,ue,ye,_e,de,ge){if(s.timeoutHandle=-1,_e=l.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Li},JA(l,E,_e);var je=(E&62914560)===E?Jg-ft():(E&4194048)===E?rC-ft():0;if(je=oz(_e,je),je!==null){vs=E,s.cancelPendingCommit=je(gC.bind(null,s,l,E,f,g,x,N,F,Q,ye,_e,null,de,ge)),mo(s,E,N,!ue);return}}gC(s,l,E,f,g,x,N,F,Q)}function EV(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],E=x.getSnapshot;x=x.value;try{if(!Qr(E(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function mo(s,l,f,g){l&=~zb,l&=~Ll,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var E=31-on(x),N=1<<E;g[E]=-1,x&=~N}f!==0&&pl(s,f,l)}function nm(){return(Mt&6)===0?(jf(0),!1):!0}function Gb(){if(vt!==null){if(jt===0)var s=vt.return;else s=vt,ss=Dl=null,ab(s),cu=null,yf=0,s=vt;for(;s!==null;)zA(s.alternate,s),s=s.return;vt=null}}function bu(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,GV(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),vs=0,Gb(),Kt=s,vt=f=is(s.current,null),bt=l,jt=0,ti=null,fo=!1,mu=_r(s,l),Vb=!1,vu=ni=zb=Ll=ho=mn=0,Vr=Pf=null,Lb=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-on(g),E=1<<x;l|=s[x],g&=~E}return ms=l,Eg(),f}function lC(s,l){ut=null,$.H=Af,l===lu||l===kg?(l=ST(),jt=3):l===Yy?(l=ST(),jt=4):jt=l===_b?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,ti=l,vt===null&&(mn=1,$g(s,mi(l,s.current)))}function cC(){var s=Jr.current;return s===null?!0:(bt&4194048)===bt?xi===null:(bt&62914560)===bt||(bt&536870912)!==0?s===xi:!1}function uC(){var s=$.H;return $.H=Af,s===null?Af:s}function dC(){var s=$.A;return $.A=_V,s}function rm(){mn=4,fo||(bt&4194048)!==bt&&Jr.current!==null||(mu=!0),(ho&134217727)===0&&(Ll&134217727)===0||Kt===null||mo(Kt,bt,ni,!1)}function qb(s,l,f){var g=Mt;Mt|=2;var x=uC(),E=dC();(Kt!==s||bt!==l)&&(tm=null,bu(s,l)),l=!1;var N=mn;e:do try{if(jt!==0&&vt!==null){var F=vt,Q=ti;switch(jt){case 8:Gb(),N=6;break e;case 3:case 2:case 9:case 6:Jr.current===null&&(l=!0);var ue=jt;if(jt=0,ti=null,xu(s,F,Q,ue),f&&mu){N=0;break e}break;default:ue=jt,jt=0,ti=null,xu(s,F,Q,ue)}}SV(),N=mn;break}catch(ye){lC(s,ye)}while(!0);return l&&s.shellSuspendCounter++,ss=Dl=null,Mt=g,$.H=x,$.A=E,vt===null&&(Kt=null,bt=0,Eg()),N}function SV(){for(;vt!==null;)fC(vt)}function TV(s,l){var f=Mt;Mt|=2;var g=uC(),x=dC();Kt!==s||bt!==l?(tm=null,em=ft()+500,bu(s,l)):mu=_r(s,l);e:do try{if(jt!==0&&vt!==null){l=vt;var E=ti;t:switch(jt){case 1:jt=0,ti=null,xu(s,l,E,1);break;case 2:case 9:if(wT(E)){jt=0,ti=null,hC(l);break}l=function(){jt!==2&&jt!==9||Kt!==s||(jt=7),Da(s)},E.then(l,l);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:wT(E)?(jt=0,ti=null,hC(l)):(jt=0,ti=null,xu(s,l,E,7));break;case 5:var N=null;switch(vt.tag){case 26:N=vt.memoizedState;case 5:case 27:var F=vt;if(N?ZC(N):F.stateNode.complete){jt=0,ti=null;var Q=F.sibling;if(Q!==null)vt=Q;else{var ue=F.return;ue!==null?(vt=ue,im(ue)):vt=null}break t}}jt=0,ti=null,xu(s,l,E,5);break;case 6:jt=0,ti=null,xu(s,l,E,6);break;case 8:Gb(),mn=6;break e;default:throw Error(r(462))}}AV();break}catch(ye){lC(s,ye)}while(!0);return ss=Dl=null,$.H=g,$.A=x,Mt=f,vt!==null?0:(Kt=null,bt=0,Eg(),mn)}function AV(){for(;vt!==null&&!Ct();)fC(vt)}function fC(s){var l=jA(s.alternate,s,ms);s.memoizedProps=s.pendingProps,l===null?im(s):vt=l}function hC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=DA(f,l,l.pendingProps,l.type,void 0,bt);break;case 11:l=DA(f,l,l.pendingProps,l.type.render,l.ref,bt);break;case 5:ab(l);default:zA(f,l),l=vt=dT(l,ms),l=jA(f,l,ms)}s.memoizedProps=s.pendingProps,l===null?im(s):vt=l}function xu(s,l,f,g){ss=Dl=null,ab(l),cu=null,yf=0;var x=l.return;try{if(pV(s,x,l,f,bt)){mn=1,$g(s,mi(f,s.current)),vt=null;return}}catch(E){if(x!==null)throw vt=x,E;mn=1,$g(s,mi(f,s.current)),vt=null;return}l.flags&32768?(Et||g===1?s=!0:mu||(bt&536870912)!==0?s=!1:(fo=s=!0,(g===2||g===9||g===3||g===6)&&(g=Jr.current,g!==null&&g.tag===13&&(g.flags|=16384))),pC(l,s)):im(l)}function im(s){var l=s;do{if((l.flags&32768)!==0){pC(l,fo);return}s=l.return;var f=vV(l.alternate,l,ms);if(f!==null){vt=f;return}if(l=l.sibling,l!==null){vt=l;return}vt=l=s}while(l!==null);mn===0&&(mn=5)}function pC(s,l){do{var f=yV(s.alternate,s);if(f!==null){f.flags&=32767,vt=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){vt=s;return}vt=s=f}while(s!==null);mn=6,vt=null}function gC(s,l,f,g,x,E,N,F,Q){s.cancelPendingCommit=null;do am();while(Gn!==0);if((Mt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Ny,Ey(s,f,E,N,F,Q),s===Kt&&(vt=Kt=null,bt=0),yu=l,go=s,vs=f,Bb=E,Ub=x,iC=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,DV(Cn,function(){return xC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=$.T,$.T=null,x=W.p,W.p=2,N=Mt,Mt|=4;try{bV(s,l,f)}finally{Mt=N,W.p=x,$.T=g}}Gn=1,mC(),vC(),yC()}}function mC(){if(Gn===1){Gn=0;var s=go,l=yu,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=$.T,$.T=null;var g=W.p;W.p=2;var x=Mt;Mt|=4;try{WA(l,s);var E=nx,N=nT(s.containerInfo),F=E.focusedElem,Q=E.selectionRange;if(N!==F&&F&&F.ownerDocument&&tT(F.ownerDocument.documentElement,F)){if(Q!==null&&Cy(F)){var ue=Q.start,ye=Q.end;if(ye===void 0&&(ye=ue),"selectionStart"in F)F.selectionStart=ue,F.selectionEnd=Math.min(ye,F.value.length);else{var _e=F.ownerDocument||document,de=_e&&_e.defaultView||window;if(de.getSelection){var ge=de.getSelection(),je=F.textContent.length,Qe=Math.min(Q.start,je),$t=Q.end===void 0?Qe:Math.min(Q.end,je);!ge.extend&&Qe>$t&&(N=$t,$t=Qe,Qe=N);var ie=eT(F,Qe),ne=eT(F,$t);if(ie&&ne&&(ge.rangeCount!==1||ge.anchorNode!==ie.node||ge.anchorOffset!==ie.offset||ge.focusNode!==ne.node||ge.focusOffset!==ne.offset)){var ce=_e.createRange();ce.setStart(ie.node,ie.offset),ge.removeAllRanges(),Qe>$t?(ge.addRange(ce),ge.extend(ne.node,ne.offset)):(ce.setEnd(ne.node,ne.offset),ge.addRange(ce))}}}}for(_e=[],ge=F;ge=ge.parentNode;)ge.nodeType===1&&_e.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<_e.length;F++){var be=_e[F];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}vm=!!tx,nx=tx=null}finally{Mt=x,W.p=g,$.T=f}}s.current=l,Gn=2}}function vC(){if(Gn===2){Gn=0;var s=go,l=yu,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=$.T,$.T=null;var g=W.p;W.p=2;var x=Mt;Mt|=4;try{$A(s,l.alternate,l)}finally{Mt=x,W.p=g,$.T=f}}Gn=3}}function yC(){if(Gn===4||Gn===3){Gn=0,et();var s=go,l=yu,f=vs,g=iC;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Gn=5:(Gn=0,yu=go=null,bC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(po=null),es(f),l=l.stateNode,In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(Yr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=$.T,x=W.p,W.p=2,$.T=null;try{for(var E=s.onRecoverableError,N=0;N<g.length;N++){var F=g[N];E(F.value,{componentStack:F.stack})}}finally{$.T=l,W.p=x}}(vs&3)!==0&&am(),Da(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Fb?Of++:(Of=0,Fb=s):Of=0,jf(0)}}function bC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,mf(l)))}function am(){return mC(),vC(),yC(),xC()}function xC(){if(Gn!==5)return!1;var s=go,l=Bb;Bb=0;var f=es(vs),g=$.T,x=W.p;try{W.p=32>f?32:f,$.T=null,f=Ub,Ub=null;var E=go,N=vs;if(Gn=0,yu=go=null,vs=0,(Mt&6)!==0)throw Error(r(331));var F=Mt;if(Mt|=4,tC(E.current),ZA(E,E.current,N,f),Mt=F,jf(0,!1),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(Yr,E)}catch{}return!0}finally{W.p=x,$.T=g,bC(s,l)}}function _C(s,l,f){l=mi(f,l),l=xb(s.stateNode,l,2),s=oo(s,l,2),s!==null&&(hl(s,2),Da(s))}function Vt(s,l,f){if(s.tag===3)_C(s,s,f);else for(;l!==null;){if(l.tag===3){_C(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(po===null||!po.has(g))){s=mi(f,s),f=wA(2),g=oo(l,f,2),g!==null&&(EA(f,g,l,s),hl(g,2),Da(g));break}}l=l.return}}function $b(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new wV;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Vb=!0,x.add(f),s=CV.bind(null,s,l,f),l.then(s,s))}function CV(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Kt===s&&(bt&f)===f&&(mn===4||mn===3&&(bt&62914560)===bt&&300>ft()-Jg?(Mt&2)===0&&bu(s,0):zb|=f,vu===bt&&(vu=0)),Da(s)}function wC(s,l){l===0&&(l=tg()),s=Cl(s,l),s!==null&&(hl(s,l),Da(s))}function IV(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),wC(s,f)}function RV(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),wC(s,f)}function DV(s,l){return Le(s,l)}var sm=null,_u=null,Hb=!1,om=!1,Yb=!1,vo=0;function Da(s){s!==_u&&s.next===null&&(_u===null?sm=_u=s:_u=_u.next=s),om=!0,Hb||(Hb=!0,NV())}function jf(s,l){if(!Yb&&om){Yb=!0;do for(var f=!1,g=sm;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var E=0;else{var N=g.suspendedLanes,F=g.pingedLanes;E=(1<<31-on(42|s)+1)-1,E&=x&~(N&~F),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,AC(g,E))}else E=bt,E=ui(g,g===Kt?E:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(E&3)===0||_r(g,E)||(f=!0,AC(g,E));g=g.next}while(f);Yb=!1}}function kV(){EC()}function EC(){om=Hb=!1;var s=0;vo!==0&&FV()&&(s=vo);for(var l=ft(),f=null,g=sm;g!==null;){var x=g.next,E=SC(g,l);E===0?(g.next=null,f===null?sm=x:f.next=x,x===null&&(_u=f)):(f=g,(s!==0||(E&3)!==0)&&(om=!0)),g=x}Gn!==0&&Gn!==5||jf(s),vo!==0&&(vo=0)}function SC(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var N=31-on(E),F=1<<N,Q=x[N];Q===-1?((F&f)===0||(F&g)!==0)&&(x[N]=wy(F,l)):Q<=l&&(s.expiredLanes|=F),E&=~F}if(l=Kt,f=bt,f=ui(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(jt===2||jt===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&lt(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||_r(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&lt(g),es(f)){case 2:case 8:f=Ut;break;case 32:f=Cn;break;case 268435456:f=fa;break;default:f=Cn}return g=TC.bind(null,s),f=Le(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&lt(g),s.callbackPriority=2,s.callbackNode=null,2}function TC(s,l){if(Gn!==0&&Gn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(am()&&s.callbackNode!==f)return null;var g=bt;return g=ui(s,s===Kt?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(sC(s,g,l),SC(s,ft()),s.callbackNode!=null&&s.callbackNode===f?TC.bind(null,s):null)}function AC(s,l){if(am())return null;sC(s,l,!0)}function NV(){qV(function(){(Mt&6)!==0?Le(pn,kV):EC()})}function Kb(){if(vo===0){var s=su;s===0&&(s=mt,mt<<=1,(mt&261888)===0&&(mt=256)),vo=s}return vo}function CC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$c(""+s)}function IC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function MV(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var E=CC((x[Qn]||null).action),N=g.submitter;N&&(l=(l=N[Qn]||null)?CC(l.formAction):N.getAttribute("formAction"),l!==null&&(E=l,N=null));var F=new Ea("action","action",null,g,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(vo!==0){var Q=N?IC(x,N):new FormData(x);pb(f,{pending:!0,data:Q,method:x.method,action:E},null,Q)}}else typeof E=="function"&&(F.preventDefault(),Q=N?IC(x,N):new FormData(x),pb(f,{pending:!0,data:Q,method:x.method,action:E},E,Q))},currentTarget:x}]})}}for(var Xb=0;Xb<ky.length;Xb++){var Wb=ky[Xb],PV=Wb.toLowerCase(),OV=Wb[0].toUpperCase()+Wb.slice(1);qi(PV,"on"+OV)}qi(aT,"onAnimationEnd"),qi(sT,"onAnimationIteration"),qi(oT,"onAnimationStart"),qi("dblclick","onDoubleClick"),qi("focusin","onFocus"),qi("focusout","onBlur"),qi(Q5,"onTransitionRun"),qi(Z5,"onTransitionStart"),qi(J5,"onTransitionCancel"),qi(lT,"onTransitionEnd"),ba("onMouseEnter",["mouseout","mouseover"]),ba("onMouseLeave",["mouseout","mouseover"]),ba("onPointerEnter",["pointerout","pointerover"]),ba("onPointerLeave",["pointerout","pointerover"]),ya("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ya("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ya("onBeforeInput",["compositionend","keypress","textInput","paste"]),ya("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ya("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ya("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jV=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vf));function RC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var N=g.length-1;0<=N;N--){var F=g[N],Q=F.instance,ue=F.currentTarget;if(F=F.listener,Q!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ue;try{E(x)}catch(ye){wg(ye)}x.currentTarget=null,E=Q}else for(N=0;N<g.length;N++){if(F=g[N],Q=F.instance,ue=F.currentTarget,F=F.listener,Q!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ue;try{E(x)}catch(ye){wg(ye)}x.currentTarget=null,E=Q}}}}function yt(s,l){var f=l[Bc];f===void 0&&(f=l[Bc]=new Set);var g=s+"__bubble";f.has(g)||(DC(l,s,2,!1),f.add(g))}function Qb(s,l,f){var g=0;l&&(g|=4),DC(f,s,g,l)}var lm="_reactListening"+Math.random().toString(36).slice(2);function Zb(s){if(!s[lm]){s[lm]=!0,Kd.forEach(function(f){f!=="selectionchange"&&(jV.has(f)||Qb(f,!1,s),Qb(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[lm]||(l[lm]=!0,Qb("selectionchange",!1,l))}}function DC(s,l,f,g){switch(a2(l)){case 2:var x=uz;break;case 8:x=dz;break;default:x=hx}f=x.bind(null,l,f,s),x=void 0,!bl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Jb(s,l,f,g,x){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var F=g.stateNode.containerInfo;if(F===x)break;if(N===4)for(N=g.return;N!==null;){var Q=N.tag;if((Q===3||Q===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;F!==null;){if(N=ma(F),N===null)return;if(Q=N.tag,Q===5||Q===6||Q===26||Q===27){g=E=N;continue e}F=F.parentNode}}g=g.return}Qs(function(){var ue=E,ye=fi(f),_e=[];e:{var de=cT.get(s);if(de!==void 0){var ge=Ea,je=s;switch(s){case"keypress":if(_l(f)===0)break e;case"keydown":case"keyup":ge=bg;break;case"focusin":je="focus",ge=El;break;case"focusout":je="blur",ge=El;break;case"beforeblur":case"afterblur":ge=El;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=lf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=ug;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=D;break;case aT:case sT:case oT:ge=fg;break;case lT:ge=q;break;case"scroll":case"scrollend":ge=of;break;case"wheel":ge=pe;break;case"copy":case"cut":case"paste":ge=hg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=rs;break;case"toggle":case"beforetoggle":ge=ct}var Qe=(l&4)!==0,$t=!Qe&&(s==="scroll"||s==="scrollend"),ie=Qe?de!==null?de+"Capture":null:de;Qe=[];for(var ne=ue,ce;ne!==null;){var be=ne;if(ce=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ce===null||ie===null||(be=Bi(ne,ie),be!=null&&Qe.push(zf(ne,be,ce))),$t)break;ne=ne.return}0<Qe.length&&(de=new ge(de,je,null,f,ye),_e.push({event:de,listeners:Qe}))}}if((l&7)===0){e:{if(de=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",de&&f!==rf&&(je=f.relatedTarget||f.fromElement)&&(ma(je)||je[pa]))break e;if((ge||de)&&(de=ye.window===ye?ye:(de=ye.ownerDocument)?de.defaultView||de.parentWindow:window,ge?(je=f.relatedTarget||f.toElement,ge=ue,je=je?ma(je):null,je!==null&&($t=a(je),Qe=je.tag,je!==$t||Qe!==5&&Qe!==27&&Qe!==6)&&(je=null)):(ge=null,je=ue),ge!==je)){if(Qe=lf,be="onMouseLeave",ie="onMouseEnter",ne="mouse",(s==="pointerout"||s==="pointerover")&&(Qe=rs,be="onPointerLeave",ie="onPointerEnter",ne="pointer"),$t=ge==null?de:Xr(ge),ce=je==null?de:Xr(je),de=new Qe(be,ne+"leave",ge,f,ye),de.target=$t,de.relatedTarget=ce,be=null,ma(ye)===ue&&(Qe=new Qe(ie,ne+"enter",je,f,ye),Qe.target=ce,Qe.relatedTarget=$t,be=Qe),$t=be,ge&&je)t:{for(Qe=VV,ie=ge,ne=je,ce=0,be=ie;be;be=Qe(be))ce++;be=0;for(var Ye=ne;Ye;Ye=Qe(Ye))be++;for(;0<ce-be;)ie=Qe(ie),ce--;for(;0<be-ce;)ne=Qe(ne),be--;for(;ce--;){if(ie===ne||ne!==null&&ie===ne.alternate){Qe=ie;break t}ie=Qe(ie),ne=Qe(ne)}Qe=null}else Qe=null;ge!==null&&kC(_e,de,ge,Qe,!1),je!==null&&$t!==null&&kC(_e,$t,je,Qe,!0)}}e:{if(de=ue?Xr(ue):window,ge=de.nodeName&&de.nodeName.toLowerCase(),ge==="select"||ge==="input"&&de.type==="file")var Rt=KS;else if(HS(de))if(XS)Rt=K5;else{Rt=H5;var Be=$5}else ge=de.nodeName,!ge||ge.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ue&&qc(ue.elementType)&&(Rt=KS):Rt=Y5;if(Rt&&(Rt=Rt(s,ue))){YS(_e,Rt,f,ye);break e}Be&&Be(s,de,ue),s==="focusout"&&ue&&de.type==="number"&&ue.memoizedProps.value!=null&&ef(de,"number",de.value)}switch(Be=ue?Xr(ue):window,s){case"focusin":(HS(Be)||Be.contentEditable==="true")&&(Zc=Be,Iy=ue,hf=null);break;case"focusout":hf=Iy=Zc=null;break;case"mousedown":Ry=!0;break;case"contextmenu":case"mouseup":case"dragend":Ry=!1,rT(_e,f,ye);break;case"selectionchange":if(W5)break;case"keydown":case"keyup":rT(_e,f,ye)}var ht;if(Nt)e:{switch(s){case"compositionstart":var xt="onCompositionStart";break e;case"compositionend":xt="onCompositionEnd";break e;case"compositionupdate":xt="onCompositionUpdate";break e}xt=void 0}else Qc?Sl(s,f)&&(xt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(xt="onCompositionStart");xt&&(Aa&&f.locale!=="ko"&&(Qc||xt!=="onCompositionStart"?xt==="onCompositionEnd"&&Qc&&(ht=sf()):(wa=ye,af="value"in wa?wa.value:wa.textContent,Qc=!0)),Be=cm(ue,xt),0<Be.length&&(xt=new Ta(xt,s,null,f,ye),_e.push({event:xt,listeners:Be}),ht?xt.data=ht:(ht=Wc(f),ht!==null&&(xt.data=ht)))),(ht=pi?U5(s,f):F5(s,f))&&(xt=cm(ue,"onBeforeInput"),0<xt.length&&(Be=new Ta("onBeforeInput","beforeinput",null,f,ye),_e.push({event:Be,listeners:xt}),Be.data=ht)),MV(_e,s,ue,f,ye)}RC(_e,l)})}function zf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function cm(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=Bi(s,f),x!=null&&g.unshift(zf(s,x,E)),x=Bi(s,l),x!=null&&g.push(zf(s,x,E))),s.tag===3)return g;s=s.return}return[]}function VV(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function kC(s,l,f,g,x){for(var E=l._reactName,N=[];f!==null&&f!==g;){var F=f,Q=F.alternate,ue=F.stateNode;if(F=F.tag,Q!==null&&Q===g)break;F!==5&&F!==26&&F!==27||ue===null||(Q=ue,x?(ue=Bi(f,E),ue!=null&&N.unshift(zf(f,ue,Q))):x||(ue=Bi(f,E),ue!=null&&N.push(zf(f,ue,Q)))),f=f.return}N.length!==0&&s.push({event:l,listeners:N})}var zV=/\r\n?/g,LV=/\u0000|\uFFFD/g;function NC(s){return(typeof s=="string"?s:""+s).replace(zV,`
`).replace(LV,"")}function MC(s,l){return l=NC(l),NC(s)===l}function qt(s,l,f,g,x,E){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Mr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Mr(s,""+g);break;case"className":Wr(s,"class",g);break;case"tabIndex":Wr(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Wr(s,f,g);break;case"style":nf(s,g,E);break;case"data":if(l!=="object"){Wr(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(l!=="input"&&qt(s,l,"name",x.name,x,null),qt(s,l,"formEncType",x.formEncType,x,null),qt(s,l,"formMethod",x.formMethod,x,null),qt(s,l,"formTarget",x.formTarget,x,null)):(qt(s,l,"encType",x.encType,x,null),qt(s,l,"method",x.method,x,null),qt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=Li);break;case"onScroll":g!=null&&yt("scroll",s);break;case"onScrollEnd":g!=null&&yt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=$c(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":yt("beforetoggle",s),yt("toggle",s),Fc(s,"popover",g);break;case"xlinkActuate":kn(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":kn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":kn(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":kn(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":kn(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":kn(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":kn(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":kn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":kn(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Fc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=cg.get(f)||f,Fc(s,f,g))}}function ex(s,l,f,g,x,E){switch(f){case"style":nf(s,g,E);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Mr(s,g):(typeof g=="number"||typeof g=="bigint")&&Mr(s,""+g);break;case"onScroll":g!=null&&yt("scroll",s);break;case"onScrollEnd":g!=null&&yt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Li);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),E=s[Qn]||null,E=E!=null?E[f]:null,typeof E=="function"&&s.removeEventListener(l,E,x),typeof g=="function")){typeof E!="function"&&E!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):Fc(s,f,g)}}}function ar(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",s),yt("load",s);var g=!1,x=!1,E;for(E in f)if(f.hasOwnProperty(E)){var N=f[E];if(N!=null)switch(E){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,E,N,f,null)}}x&&qt(s,l,"srcSet",f.srcSet,f,null),g&&qt(s,l,"src",f.src,f,null);return;case"input":yt("invalid",s);var F=E=N=x=null,Q=null,ue=null;for(g in f)if(f.hasOwnProperty(g)){var ye=f[g];if(ye!=null)switch(g){case"name":x=ye;break;case"type":N=ye;break;case"checked":Q=ye;break;case"defaultChecked":ue=ye;break;case"value":E=ye;break;case"defaultValue":F=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(r(137,l));break;default:qt(s,l,g,ye,f,null)}}sg(s,E,F,Q,ue,N,x,!1);return;case"select":yt("invalid",s),g=N=E=null;for(x in f)if(f.hasOwnProperty(x)&&(F=f[x],F!=null))switch(x){case"value":E=F;break;case"defaultValue":N=F;break;case"multiple":g=F;default:qt(s,l,x,F,f,null)}l=E,f=N,s.multiple=!!g,l!=null?Ys(s,!!g,l,!1):f!=null&&Ys(s,!!g,f,!0);return;case"textarea":yt("invalid",s),E=x=g=null;for(N in f)if(f.hasOwnProperty(N)&&(F=f[N],F!=null))switch(N){case"value":g=F;break;case"defaultValue":x=F;break;case"children":E=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(91));break;default:qt(s,l,N,F,f,null)}Ks(s,g,x,E);return;case"option":for(Q in f)if(f.hasOwnProperty(Q)&&(g=f[Q],g!=null))switch(Q){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:qt(s,l,Q,g,f,null)}return;case"dialog":yt("beforetoggle",s),yt("toggle",s),yt("cancel",s),yt("close",s);break;case"iframe":case"object":yt("load",s);break;case"video":case"audio":for(g=0;g<Vf.length;g++)yt(Vf[g],s);break;case"image":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"embed":case"source":case"link":yt("error",s),yt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in f)if(f.hasOwnProperty(ue)&&(g=f[ue],g!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:qt(s,l,ue,g,f,null)}return;default:if(qc(l)){for(ye in f)f.hasOwnProperty(ye)&&(g=f[ye],g!==void 0&&ex(s,l,ye,g,f,void 0));return}}for(F in f)f.hasOwnProperty(F)&&(g=f[F],g!=null&&qt(s,l,F,g,f,null))}function BV(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,N=null,F=null,Q=null,ue=null,ye=null;for(ge in f){var _e=f[ge];if(f.hasOwnProperty(ge)&&_e!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":Q=_e;default:g.hasOwnProperty(ge)||qt(s,l,ge,null,g,_e)}}for(var de in g){var ge=g[de];if(_e=f[de],g.hasOwnProperty(de)&&(ge!=null||_e!=null))switch(de){case"type":E=ge;break;case"name":x=ge;break;case"checked":ue=ge;break;case"defaultChecked":ye=ge;break;case"value":N=ge;break;case"defaultValue":F=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,l));break;default:ge!==_e&&qt(s,l,de,ge,g,_e)}}Gc(s,N,F,Q,ue,ye,E,x);return;case"select":ge=N=F=de=null;for(E in f)if(Q=f[E],f.hasOwnProperty(E)&&Q!=null)switch(E){case"value":break;case"multiple":ge=Q;default:g.hasOwnProperty(E)||qt(s,l,E,null,g,Q)}for(x in g)if(E=g[x],Q=f[x],g.hasOwnProperty(x)&&(E!=null||Q!=null))switch(x){case"value":de=E;break;case"defaultValue":F=E;break;case"multiple":N=E;default:E!==Q&&qt(s,l,x,E,g,Q)}l=F,f=N,g=ge,de!=null?Ys(s,!!f,de,!1):!!g!=!!f&&(l!=null?Ys(s,!!f,l,!0):Ys(s,!!f,f?[]:"",!1));return;case"textarea":ge=de=null;for(F in f)if(x=f[F],f.hasOwnProperty(F)&&x!=null&&!g.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:qt(s,l,F,null,g,x)}for(N in g)if(x=g[N],E=f[N],g.hasOwnProperty(N)&&(x!=null||E!=null))switch(N){case"value":de=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==E&&qt(s,l,N,x,g,E)}og(s,de,ge);return;case"option":for(var je in f)if(de=f[je],f.hasOwnProperty(je)&&de!=null&&!g.hasOwnProperty(je))switch(je){case"selected":s.selected=!1;break;default:qt(s,l,je,null,g,de)}for(Q in g)if(de=g[Q],ge=f[Q],g.hasOwnProperty(Q)&&de!==ge&&(de!=null||ge!=null))switch(Q){case"selected":s.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:qt(s,l,Q,de,g,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in f)de=f[Qe],f.hasOwnProperty(Qe)&&de!=null&&!g.hasOwnProperty(Qe)&&qt(s,l,Qe,null,g,de);for(ue in g)if(de=g[ue],ge=f[ue],g.hasOwnProperty(ue)&&de!==ge&&(de!=null||ge!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,l));break;default:qt(s,l,ue,de,g,ge)}return;default:if(qc(l)){for(var $t in f)de=f[$t],f.hasOwnProperty($t)&&de!==void 0&&!g.hasOwnProperty($t)&&ex(s,l,$t,void 0,g,de);for(ye in g)de=g[ye],ge=f[ye],!g.hasOwnProperty(ye)||de===ge||de===void 0&&ge===void 0||ex(s,l,ye,de,g,ge);return}}for(var ie in f)de=f[ie],f.hasOwnProperty(ie)&&de!=null&&!g.hasOwnProperty(ie)&&qt(s,l,ie,null,g,de);for(_e in g)de=g[_e],ge=f[_e],!g.hasOwnProperty(_e)||de===ge||de==null&&ge==null||qt(s,l,_e,de,g,ge)}function PC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function UV(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],E=x.transferSize,N=x.initiatorType,F=x.duration;if(E&&F&&PC(N)){for(N=0,F=x.responseEnd,g+=1;g<f.length;g++){var Q=f[g],ue=Q.startTime;if(ue>F)break;var ye=Q.transferSize,_e=Q.initiatorType;ye&&PC(_e)&&(Q=Q.responseEnd,N+=ye*(Q<F?1:(F-ue)/(Q-ue)))}if(--g,l+=8*(E+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var tx=null,nx=null;function um(s){return s.nodeType===9?s:s.ownerDocument}function OC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function rx(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var ix=null;function FV(){var s=window.event;return s&&s.type==="popstate"?s===ix?!1:(ix=s,!0):(ix=null,!1)}var VC=typeof setTimeout=="function"?setTimeout:void 0,GV=typeof clearTimeout=="function"?clearTimeout:void 0,zC=typeof Promise=="function"?Promise:void 0,qV=typeof queueMicrotask=="function"?queueMicrotask:typeof zC<"u"?function(s){return zC.resolve(null).then(s).catch($V)}:VC;function $V(s){setTimeout(function(){throw s})}function yo(s){return s==="head"}function LC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Tu(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Lf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Lf(f);for(var E=f.firstChild;E;){var N=E.nextSibling,F=E.nodeName;E[ga]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=N}}else f==="body"&&Lf(s.ownerDocument.body);f=x}while(f);Tu(l)}function BC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function ax(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":ax(f),Uc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function HV(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[ga])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=_i(s.nextSibling),s===null)break}return null}function YV(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=_i(s.nextSibling),s===null))return null;return s}function UC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=_i(s.nextSibling),s===null))return null;return s}function sx(s){return s.data==="$?"||s.data==="$~"}function ox(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function KV(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function _i(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var lx=null;function FC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return _i(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function GC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function qC(s,l,f){switch(l=um(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Lf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Uc(s)}var wi=new Map,$C=new Set;function dm(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ys=W.d;W.d={f:XV,r:WV,D:QV,C:ZV,L:JV,m:ez,X:nz,S:tz,M:rz};function XV(){var s=ys.f(),l=nm();return s||l}function WV(s){var l=di(s);l!==null&&l.tag===5&&l.type==="form"?lA(l):ys.r(s)}var wu=typeof document>"u"?null:document;function HC(s,l,f){var g=wu;if(g&&typeof l=="string"&&l){var x=Nr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),$C.has(x)||($C.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),ar(l,"link",s),Dn(l),g.head.appendChild(l)))}}function QV(s){ys.D(s),HC("dns-prefetch",s,null)}function ZV(s,l){ys.C(s,l),HC("preconnect",s,l)}function JV(s,l,f){ys.L(s,l,f);var g=wu;if(g&&s&&l){var x='link[rel="preload"][as="'+Nr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Nr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Nr(f.imageSizes)+'"]')):x+='[href="'+Nr(s)+'"]';var E=x;switch(l){case"style":E=Eu(s);break;case"script":E=Su(s)}wi.has(E)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),wi.set(E,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Bf(E))||l==="script"&&g.querySelector(Uf(E))||(l=g.createElement("link"),ar(l,"link",s),Dn(l),g.head.appendChild(l)))}}function ez(s,l){ys.m(s,l);var f=wu;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Nr(g)+'"][href="'+Nr(s)+'"]',E=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Su(s)}if(!wi.has(E)&&(s=p({rel:"modulepreload",href:s},l),wi.set(E,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Uf(E)))return}g=f.createElement("link"),ar(g,"link",s),Dn(g),f.head.appendChild(g)}}}function tz(s,l,f){ys.S(s,l,f);var g=wu;if(g&&s){var x=va(g).hoistableStyles,E=Eu(s);l=l||"default";var N=x.get(E);if(!N){var F={loading:0,preload:null};if(N=g.querySelector(Bf(E)))F.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=wi.get(E))&&cx(s,f);var Q=N=g.createElement("link");Dn(Q),ar(Q,"link",s),Q._p=new Promise(function(ue,ye){Q.onload=ue,Q.onerror=ye}),Q.addEventListener("load",function(){F.loading|=1}),Q.addEventListener("error",function(){F.loading|=2}),F.loading|=4,fm(N,l,g)}N={type:"stylesheet",instance:N,count:1,state:F},x.set(E,N)}}}function nz(s,l){ys.X(s,l);var f=wu;if(f&&s){var g=va(f).hoistableScripts,x=Su(s),E=g.get(x);E||(E=f.querySelector(Uf(x)),E||(s=p({src:s,async:!0},l),(l=wi.get(x))&&ux(s,l),E=f.createElement("script"),Dn(E),ar(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function rz(s,l){ys.M(s,l);var f=wu;if(f&&s){var g=va(f).hoistableScripts,x=Su(s),E=g.get(x);E||(E=f.querySelector(Uf(x)),E||(s=p({src:s,async:!0,type:"module"},l),(l=wi.get(x))&&ux(s,l),E=f.createElement("script"),Dn(E),ar(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function YC(s,l,f,g){var x=(x=fe.current)?dm(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Eu(f.href),f=va(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Eu(f.href);var E=va(x).hoistableStyles,N=E.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,N),(E=x.querySelector(Bf(s)))&&!E._p&&(N.instance=E,N.state.loading=5),wi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},wi.set(s,f),E||iz(x,s,f,N.state))),l&&g===null)throw Error(r(528,""));return N}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Su(f),f=va(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Eu(s){return'href="'+Nr(s)+'"'}function Bf(s){return'link[rel="stylesheet"]['+s+"]"}function KC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function iz(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),ar(l,"link",f),Dn(l),s.head.appendChild(l))}function Su(s){return'[src="'+Nr(s)+'"]'}function Uf(s){return"script[async]"+s}function XC(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Nr(f.href)+'"]');if(g)return l.instance=g,Dn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),Dn(g),ar(g,"style",x),fm(g,f.precedence,s),l.instance=g;case"stylesheet":x=Eu(f.href);var E=s.querySelector(Bf(x));if(E)return l.state.loading|=4,l.instance=E,Dn(E),E;g=KC(f),(x=wi.get(x))&&cx(g,x),E=(s.ownerDocument||s).createElement("link"),Dn(E);var N=E;return N._p=new Promise(function(F,Q){N.onload=F,N.onerror=Q}),ar(E,"link",g),l.state.loading|=4,fm(E,f.precedence,s),l.instance=E;case"script":return E=Su(f.src),(x=s.querySelector(Uf(E)))?(l.instance=x,Dn(x),x):(g=f,(x=wi.get(E))&&(g=p({},f),ux(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),Dn(x),ar(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,fm(g,f.precedence,s));return l.instance}function fm(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,E=x,N=0;N<g.length;N++){var F=g[N];if(F.dataset.precedence===l)E=F;else if(E!==x)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function cx(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function ux(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var hm=null;function WC(s,l,f){if(hm===null){var g=new Map,x=hm=new Map;x.set(f,g)}else x=hm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var E=f[x];if(!(E[ga]||E[Rn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var N=E.getAttribute(l)||"";N=s+N;var F=g.get(N);F?F.push(E):g.set(N,[E])}}return g}function QC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function az(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function ZC(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function sz(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Eu(g.href),E=l.querySelector(Bf(x));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=pm.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=E,Dn(E);return}E=l.ownerDocument||l,g=KC(g),(x=wi.get(x))&&cx(g,x),E=E.createElement("link"),Dn(E);var N=E;N._p=new Promise(function(F,Q){N.onload=F,N.onerror=Q}),ar(E,"link",g),f.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=pm.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var dx=0;function oz(s,l){return s.stylesheets&&s.count===0&&mm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&mm(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&dx===0&&(dx=62500*UV());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&mm(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>dx?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function pm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)mm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var gm=null;function mm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,gm=new Map,l.forEach(lz,s),gm=null,pm.call(s))}function lz(s,l){if(!(l.state.loading&4)){var f=gm.get(s);if(f)var g=f.get(null);else{f=new Map,gm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var N=x[E];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(f.set(N.dataset.precedence,N),g=N)}g&&f.set(null,g)}x=l.instance,N=x.getAttribute("data-precedence"),E=f.get(N)||g,E===g&&f.set(null,x),f.set(N,x),this.count++,g=pm.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),E?E.parentNode.insertBefore(x,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var Ff={$$typeof:R,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function cz(s,l,f,g,x,E,N,F,Q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ha(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ha(0),this.hiddenUpdates=ha(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function JC(s,l,f,g,x,E,N,F,Q,ue,ye,_e){return s=new cz(s,l,f,N,Q,ue,ye,_e,F),l=1,E===!0&&(l|=24),E=Zr(3,null,null,l),s.current=E,E.stateNode=s,l=qy(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:g,isDehydrated:f,cache:l},Ky(E),s}function e2(s){return s?(s=tu,s):tu}function t2(s,l,f,g,x,E){x=e2(x),g.context===null?g.context=x:g.pendingContext=x,g=so(l),g.payload={element:f},E=E===void 0?null:E,E!==null&&(g.callback=E),f=oo(s,g,l),f!==null&&(zr(f,s,l),xf(f,s,l))}function n2(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function fx(s,l){n2(s,l),(s=s.alternate)&&n2(s,l)}function r2(s){if(s.tag===13||s.tag===31){var l=Cl(s,67108864);l!==null&&zr(l,s,67108864),fx(s,67108864)}}function i2(s){if(s.tag===13||s.tag===31){var l=ri();l=gl(l);var f=Cl(s,l);f!==null&&zr(f,s,l),fx(s,l)}}var vm=!0;function uz(s,l,f,g){var x=$.T;$.T=null;var E=W.p;try{W.p=2,hx(s,l,f,g)}finally{W.p=E,$.T=x}}function dz(s,l,f,g){var x=$.T;$.T=null;var E=W.p;try{W.p=8,hx(s,l,f,g)}finally{W.p=E,$.T=x}}function hx(s,l,f,g){if(vm){var x=px(g);if(x===null)Jb(s,l,g,ym,f),s2(s,g);else if(hz(x,s,l,f,g))g.stopPropagation();else if(s2(s,g),l&4&&-1<fz.indexOf(s)){for(;x!==null;){var E=di(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var N=Kr(E.pendingLanes);if(N!==0){var F=E;for(F.pendingLanes|=2,F.entangledLanes|=2;N;){var Q=1<<31-on(N);F.entanglements[1]|=Q,N&=~Q}Da(E),(Mt&6)===0&&(em=ft()+500,jf(0))}}break;case 31:case 13:F=Cl(E,2),F!==null&&zr(F,E,2),nm(),fx(E,2)}if(E=px(g),E===null&&Jb(s,l,g,ym,f),E===x)break;x=E}x!==null&&g.stopPropagation()}else Jb(s,l,g,null,f)}}function px(s){return s=fi(s),gx(s)}var ym=null;function gx(s){if(ym=null,s=ma(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return ym=s,null}function a2(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kt()){case pn:return 2;case Ut:return 8;case Cn:case Hr:return 32;case fa:return 268435456;default:return 32}default:return 32}}var mx=!1,bo=null,xo=null,_o=null,Gf=new Map,qf=new Map,wo=[],fz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function s2(s,l){switch(s){case"focusin":case"focusout":bo=null;break;case"dragenter":case"dragleave":xo=null;break;case"mouseover":case"mouseout":_o=null;break;case"pointerover":case"pointerout":Gf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":qf.delete(l.pointerId)}}function $f(s,l,f,g,x,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:E,targetContainers:[x]},l!==null&&(l=di(l),l!==null&&r2(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function hz(s,l,f,g,x){switch(l){case"focusin":return bo=$f(bo,s,l,f,g,x),!0;case"dragenter":return xo=$f(xo,s,l,f,g,x),!0;case"mouseover":return _o=$f(_o,s,l,f,g,x),!0;case"pointerover":var E=x.pointerId;return Gf.set(E,$f(Gf.get(E)||null,s,l,f,g,x)),!0;case"gotpointercapture":return E=x.pointerId,qf.set(E,$f(qf.get(E)||null,s,l,f,g,x)),!0}return!1}function o2(s){var l=ma(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Vi(s.priority,function(){i2(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Vi(s.priority,function(){i2(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function bm(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=px(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);rf=g,f.target.dispatchEvent(g),rf=null}else return l=di(f),l!==null&&r2(l),s.blockedOn=f,!1;l.shift()}return!0}function l2(s,l,f){bm(s)&&f.delete(l)}function pz(){mx=!1,bo!==null&&bm(bo)&&(bo=null),xo!==null&&bm(xo)&&(xo=null),_o!==null&&bm(_o)&&(_o=null),Gf.forEach(l2),qf.forEach(l2)}function xm(s,l){s.blockedOn===l&&(s.blockedOn=null,mx||(mx=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,pz)))}var _m=null;function c2(s){_m!==s&&(_m=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){_m===s&&(_m=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(gx(g||f)===null)continue;break}var E=di(f);E!==null&&(s.splice(l,3),l-=3,pb(E,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Tu(s){function l(Q){return xm(Q,s)}bo!==null&&xm(bo,s),xo!==null&&xm(xo,s),_o!==null&&xm(_o,s),Gf.forEach(l),qf.forEach(l);for(var f=0;f<wo.length;f++){var g=wo[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<wo.length&&(f=wo[0],f.blockedOn===null);)o2(f),f.blockedOn===null&&wo.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],E=f[g+1],N=x[Qn]||null;if(typeof E=="function")N||c2(f);else if(N){var F=null;if(E&&E.hasAttribute("formAction")){if(x=E,N=E[Qn]||null)F=N.formAction;else if(gx(x)!==null)continue}else F=N.action;typeof F=="function"?f[g+1]=F:(f.splice(g,3),g-=3),c2(f)}}}function u2(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function vx(s){this._internalRoot=s}wm.prototype.render=vx.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=ri();t2(f,g,s,l,null,null)},wm.prototype.unmount=vx.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;t2(s.current,2,null,s,null,null),nm(),l[pa]=null}};function wm(s){this._internalRoot=s}wm.prototype.unstable_scheduleHydration=function(s){if(s){var l=ng();s={blockedOn:null,target:s,priority:l};for(var f=0;f<wo.length&&l!==0&&l<wo[f].priority;f++);wo.splice(f,0,s),f===0&&o2(s)}};var d2=e.version;if(d2!=="19.2.0")throw Error(r(527,d2,"19.2.0"));W.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var gz={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Em.isDisabled&&Em.supportsFiber)try{Yr=Em.inject(gz),In=Em}catch{}}return Yf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=yA,E=bA,N=xA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=JC(s,1,!1,null,null,f,g,null,x,E,N,u2),s[pa]=l.current,Zb(s),new vx(l)},Yf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",E=yA,N=bA,F=xA,Q=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(N=f.onCaughtError),f.onRecoverableError!==void 0&&(F=f.onRecoverableError),f.formState!==void 0&&(Q=f.formState)),l=JC(s,1,!0,l,f??null,g,x,Q,E,N,F,u2),l.context=e2(null),f=l.current,g=ri(),g=gl(g),x=so(g),x.callback=null,oo(f,x,g),f=g,l.current.lanes=f,hl(l,f),Da(l),s[pa]=l.current,Zb(s),new wm(l)},Yf.version="19.2.0",Yf}var _2;function Az(){if(_2)return xx.exports;_2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xx.exports=Tz(),xx.exports}var Cz=Az();const Iz="modulepreload",Rz=function(n){return"/personal-budget-pwa/"+n},w2={},At=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(t.map(d=>{if(d=Rz(d),d in w2)return;w2[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Iz,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,_)=>{m.addEventListener("load",b),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function Dz(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await At(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}const kz=()=>{};var E2={};const nN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Nz=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},rN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(nN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Nz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new Mz;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Mz extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Pz=function(n){const e=nN(n);return rN.encodeByteArray(e,!0)},A0=function(n){return Pz(n).replace(/\./g,"")},iN=function(n){try{return rN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function aN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Oz=()=>aN().__FIREBASE_DEFAULTS__,jz=()=>{if(typeof process>"u"||typeof E2>"u")return;const n=E2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Vz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&iN(n[1]);return e&&JSON.parse(e)},Ev=()=>{try{return kz()||Oz()||jz()||Vz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},sN=n=>Ev()?.emulatorHosts?.[n],zz=n=>{const e=sN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},oN=()=>Ev()?.config,lN=n=>Ev()?.[`_${n}`];class Lz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Rd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cN(n){return(await fetch(n,{credentials:"include"})).ok}function Bz(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[A0(JSON.stringify(t)),A0(JSON.stringify(o)),""].join(".")}const gh={};function Uz(){const n={prod:[],emulator:[]};for(const e of Object.keys(gh))gh[e]?n.emulator.push(e):n.prod.push(e);return n}function Fz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let S2=!1;function uN(n,e){if(typeof window>"u"||typeof document>"u"||!Rd(window.location.host)||gh[n]===e||gh[n]||S2)return;gh[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=Uz().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{S2=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=Fz(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),S=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const R=m.element;c(R),h(S,w);const O=d();u(C,T),R.append(C,_,S,O),document.body.appendChild(R)}a?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xn())}function dN(){const n=Ev()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $z(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Hz(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Yz(){const n=Xn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function fN(){return!dN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function hN(){return!dN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function pN(){try{return typeof indexedDB=="object"}catch{return!1}}function Kz(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const Xz="FirebaseError";class Ls extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Xz,Object.setPrototypeOf(this,Ls.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gp.prototype.create)}}class gp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?Wz(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ls(i,c,r)}}function Wz(n,e){return n.replace(Qz,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Qz=/\{\$([^}]+)}/g;function Zz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Xo(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],o=e[i];if(T2(a)&&T2(o)){if(!Xo(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function T2(n){return n!==null&&typeof n=="object"}function mp(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function rh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ih(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Jz(n,e){const t=new e6(n,e);return t.subscribe.bind(t)}class e6{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");t6(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Sx),i.error===void 0&&(i.error=Sx),i.complete===void 0&&(i.complete=Sx);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function t6(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Sx(){}function Wt(n){return n&&n._delegate?n._delegate:n}let gc=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Gl="[DEFAULT]";let n6=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Lz;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(i6(e))try{this.getOrInitializeService({instanceIdentifier:Gl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Gl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Gl){return this.instances.has(e)}getOptions(e=Gl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:r6(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Gl){return this.component?this.component.multipleInstances?e:Gl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function r6(n){return n===Gl?void 0:n}function i6(n){return n.instantiationMode==="EAGER"}class a6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new n6(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var _t;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_t||(_t={}));const s6={debug:_t.DEBUG,verbose:_t.VERBOSE,info:_t.INFO,warn:_t.WARN,error:_t.ERROR,silent:_t.SILENT},o6=_t.INFO,l6={[_t.DEBUG]:"log",[_t.VERBOSE]:"log",[_t.INFO]:"info",[_t.WARN]:"warn",[_t.ERROR]:"error"},c6=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=l6[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dw{constructor(e){this.name=e,this._logLevel=o6,this._logHandler=c6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?s6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_t.DEBUG,...e),this._logHandler(this,_t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_t.VERBOSE,...e),this._logHandler(this,_t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_t.INFO,...e),this._logHandler(this,_t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_t.WARN,...e),this._logHandler(this,_t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_t.ERROR,...e),this._logHandler(this,_t.ERROR,...e)}}const u6=(n,e)=>e.some(t=>n instanceof t);let A2,C2;function d6(){return A2||(A2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function f6(){return C2||(C2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gN=new WeakMap,A1=new WeakMap,mN=new WeakMap,Tx=new WeakMap,fw=new WeakMap;function h6(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",o)},a=()=>{t(Fo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&gN.set(t,n)}).catch(()=>{}),fw.set(e,n),e}function p6(n){if(A1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",o),n.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",o),n.addEventListener("abort",o)});A1.set(n,e)}let C1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return A1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||mN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function g6(n){C1=n(C1)}function m6(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ax(this),e,...t);return mN.set(r,e.sort?e.sort():[e]),Fo(r)}:f6().includes(n)?function(...e){return n.apply(Ax(this),e),Fo(gN.get(this))}:function(...e){return Fo(n.apply(Ax(this),e))}}function v6(n){return typeof n=="function"?m6(n):(n instanceof IDBTransaction&&p6(n),u6(n,d6())?new Proxy(n,C1):n)}function Fo(n){if(n instanceof IDBRequest)return h6(n);if(Tx.has(n))return Tx.get(n);const e=v6(n);return e!==n&&(Tx.set(n,e),fw.set(e,n)),e}const Ax=n=>fw.get(n);function y6(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(n,e),c=Fo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Fo(o.result),u.oldVersion,u.newVersion,Fo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const b6=["get","getKey","getAll","getAllKeys","count"],x6=["put","add","delete","clear"],Cx=new Map;function I2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Cx.get(e))return Cx.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=x6.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||b6.includes(t)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return Cx.set(e,a),a}g6(n=>({...n,get:(e,t,r)=>I2(e,t)||n.get(e,t,r),has:(e,t)=>!!I2(e,t)||n.has(e,t)}));class _6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(w6(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function w6(n){return n.getComponent()?.type==="VERSION"}const I1="@firebase/app",R2="0.14.6";const Ds=new dw("@firebase/app"),E6="@firebase/app-compat",S6="@firebase/analytics-compat",T6="@firebase/analytics",A6="@firebase/app-check-compat",C6="@firebase/app-check",I6="@firebase/auth",R6="@firebase/auth-compat",D6="@firebase/database",k6="@firebase/data-connect",N6="@firebase/database-compat",M6="@firebase/functions",P6="@firebase/functions-compat",O6="@firebase/installations",j6="@firebase/installations-compat",V6="@firebase/messaging",z6="@firebase/messaging-compat",L6="@firebase/performance",B6="@firebase/performance-compat",U6="@firebase/remote-config",F6="@firebase/remote-config-compat",G6="@firebase/storage",q6="@firebase/storage-compat",$6="@firebase/firestore",H6="@firebase/ai",Y6="@firebase/firestore-compat",K6="firebase",X6="12.6.0";const R1="[DEFAULT]",W6={[I1]:"fire-core",[E6]:"fire-core-compat",[T6]:"fire-analytics",[S6]:"fire-analytics-compat",[C6]:"fire-app-check",[A6]:"fire-app-check-compat",[I6]:"fire-auth",[R6]:"fire-auth-compat",[D6]:"fire-rtdb",[k6]:"fire-data-connect",[N6]:"fire-rtdb-compat",[M6]:"fire-fn",[P6]:"fire-fn-compat",[O6]:"fire-iid",[j6]:"fire-iid-compat",[V6]:"fire-fcm",[z6]:"fire-fcm-compat",[L6]:"fire-perf",[B6]:"fire-perf-compat",[U6]:"fire-rc",[F6]:"fire-rc-compat",[G6]:"fire-gcs",[q6]:"fire-gcs-compat",[$6]:"fire-fst",[Y6]:"fire-fst-compat",[H6]:"fire-vertex","fire-js":"fire-js",[K6]:"fire-js-all"};const C0=new Map,Q6=new Map,D1=new Map;function D2(n,e){try{n.container.addComponent(e)}catch(t){Ds.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function id(n){const e=n.name;if(D1.has(e))return Ds.debug(`There were multiple attempts to register component ${e}.`),!1;D1.set(e,n);for(const t of C0.values())D2(t,n);for(const t of Q6.values())D2(t,n);return!0}function hw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ai(n){return n==null?!1:n.settings!==void 0}const Z6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Go=new gp("app","Firebase",Z6);class J6{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new gc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Go.create("app-deleted",{appName:this._name})}}const Dd=X6;function vN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:R1,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Go.create("bad-app-name",{appName:String(i)});if(t||(t=oN()),!t)throw Go.create("no-options");const a=C0.get(i);if(a){if(Xo(t,a.options)&&Xo(r,a.config))return a;throw Go.create("duplicate-app",{appName:i})}const o=new a6(i);for(const u of D1.values())o.addComponent(u);const c=new J6(t,r,o);return C0.set(i,c),c}function yN(n=R1){const e=C0.get(n);if(!e&&n===R1&&oN())return vN();if(!e)throw Go.create("no-app",{appName:n});return e}function qo(n,e,t){let r=W6[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ds.warn(o.join(" "));return}id(new gc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const eL="firebase-heartbeat-database",tL=1,jh="firebase-heartbeat-store";let Ix=null;function bN(){return Ix||(Ix=y6(eL,tL,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(jh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Go.create("idb-open",{originalErrorMessage:n.message})})),Ix}async function nL(n){try{const t=(await bN()).transaction(jh),r=await t.objectStore(jh).get(xN(n));return await t.done,r}catch(e){if(e instanceof Ls)Ds.warn(e.message);else{const t=Go.create("idb-get",{originalErrorMessage:e?.message});Ds.warn(t.message)}}}async function k2(n,e){try{const r=(await bN()).transaction(jh,"readwrite");await r.objectStore(jh).put(e,xN(n)),await r.done}catch(t){if(t instanceof Ls)Ds.warn(t.message);else{const r=Go.create("idb-set",{originalErrorMessage:t?.message});Ds.warn(r.message)}}}function xN(n){return`${n.name}!${n.options.appId}`}const rL=1024,iL=30;class aL{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oL(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=N2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>iL){const i=lL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ds.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=N2(),{heartbeatsToSend:t,unsentEntries:r}=sL(this._heartbeatsCache.heartbeats),i=A0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ds.warn(e),""}}}function N2(){return new Date().toISOString().substring(0,10)}function sL(n,e=rL){const t=[];let r=n.slice();for(const i of n){const a=t.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),M2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),M2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class oL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pN()?Kz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nL(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return k2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return k2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function M2(n){return A0(JSON.stringify({version:2,heartbeats:n})).length}function lL(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function cL(n){id(new gc("platform-logger",e=>new _6(e),"PRIVATE")),id(new gc("heartbeat",e=>new aL(e),"PRIVATE")),qo(I1,R2,n),qo(I1,R2,"esm2020"),qo("fire-js","")}cL("");function _N(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uL=_N,wN=new gp("auth","Firebase",_N());const I0=new dw("@firebase/auth");function dL(n,...e){I0.logLevel<=_t.WARN&&I0.warn(`Auth (${Dd}): ${n}`,...e)}function Jm(n,...e){I0.logLevel<=_t.ERROR&&I0.error(`Auth (${Dd}): ${n}`,...e)}function aa(n,...e){throw pw(n,...e)}function za(n,...e){return pw(n,...e)}function EN(n,e,t){const r={...uL(),[e]:t};return new gp("auth","Firebase",r).create(e,{appName:n.name})}function Ts(n){return EN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return wN.create(n,...e)}function We(n,e,...t){if(!n)throw pw(e,...t)}function _s(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Jm(e),new Error(e)}function ks(n,e){n||_s(e)}function k1(){return typeof self<"u"&&self.location?.href||""}function fL(){return P2()==="http:"||P2()==="https:"}function P2(){return typeof self<"u"&&self.location?.protocol||null}function hL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fL()||$z()||"connection"in navigator)?navigator.onLine:!0}function pL(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class vp{constructor(e,t){this.shortDelay=e,this.longDelay=t,ks(t>e,"Short delay should be less than long delay!"),this.isMobile=Gz()||Hz()}get(){return hL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function gw(n,e){ks(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class SN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_s("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_s("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_s("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const mL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],vL=new vp(3e4,6e4);function Xa(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ua(n,e,t,r,i={}){return TN(n,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=mp({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return qz()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Rd(n.emulatorConfig.host)&&(d.credentials="include"),SN.fetch()(await AN(n,n.config.apiHost,t,c),d)})}async function TN(n,e,t){n._canInitEmulator=!1;const r={...gL,...e};try{const i=new bL(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Sm(n,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sm(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Sm(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Sm(n,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw EN(n,h,d);aa(n,h)}}catch(i){if(i instanceof Ls)throw i;aa(n,"network-request-failed",{message:String(i)})}}async function yp(n,e,t,r,i={}){const a=await ua(n,e,t,r,i);return"mfaPendingCredential"in a&&aa(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function AN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,o=a.config.emulator?gw(n.config,i):`${n.config.apiScheme}://${i}`;return mL.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function yL(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(za(this.auth,"network-request-failed")),vL.get())})}}function Sm(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=za(n,e,r);return i.customData._tokenResponse=t,i}function O2(n){return n!==void 0&&n.enterprise!==void 0}class xL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return yL(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function _L(n,e){return ua(n,"GET","/v2/recaptchaConfig",Xa(n,e))}async function wL(n,e){return ua(n,"POST","/v1/accounts:delete",e)}async function R0(n,e){return ua(n,"POST","/v1/accounts:lookup",e)}function mh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function EL(n,e=!1){const t=Wt(n),r=await t.getIdToken(e),i=mw(r);We(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:mh(Rx(i.auth_time)),issuedAtTime:mh(Rx(i.iat)),expirationTime:mh(Rx(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Rx(n){return Number(n)*1e3}function mw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Jm("JWT malformed, contained fewer than 3 sections"),null;try{const i=iN(t);return i?JSON.parse(i):(Jm("Failed to decode base64 JWT payload"),null)}catch(i){return Jm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function j2(n){const e=mw(n);return We(e,"internal-error"),We(typeof e.exp<"u","internal-error"),We(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ad(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ls&&SL(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function SL({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class TL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class N1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mh(this.lastLoginAt),this.creationTime=mh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function D0(n){const e=n.auth,t=await n.getIdToken(),r=await ad(n,R0(e,{idToken:t}));We(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?CN(i.providerUserInfo):[],o=CL(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new N1(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function AL(n){const e=Wt(n);await D0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function CL(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function CN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function IL(n,e){const t=await TN(n,{},async()=>{const r=mp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,o=await AN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Rd(n.emulatorConfig.host)&&(u.credentials="include"),SN.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function RL(n,e){return ua(n,"POST","/v2/accounts:revokeToken",Xa(n,e))}class Qu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){We(e.idToken,"internal-error"),We(typeof e.idToken<"u","internal-error"),We(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):j2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){We(e.length!==0,"internal-error");const t=j2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(We(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await IL(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,o=new Qu;return r&&(We(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(We(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(We(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qu,this.toJSON())}_performRefresh(){return _s("not implemented")}}function So(n,e){We(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ea{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new TL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new N1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ad(this,this.stsTokenManager.getToken(this.auth,e));return We(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return EL(this,e)}reload(){return AL(this)}_assign(e){this!==e&&(We(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ea({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){We(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await D0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ai(this.auth.app))return Promise.reject(Ts(this.auth));const e=await this.getIdToken();return await ad(this,wL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;We(p&&w,e,"internal-error");const S=Qu.fromJSON(this.name,w);We(typeof p=="string",e,"internal-error"),So(r,e.name),So(i,e.name),We(typeof m=="boolean",e,"internal-error"),We(typeof b=="boolean",e,"internal-error"),So(a,e.name),So(o,e.name),So(c,e.name),So(u,e.name),So(d,e.name),So(h,e.name);const T=new ea({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Qu;i.updateFromServerResponse(t);const a=new ea({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await D0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];We(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?CN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new Qu;c.updateFromIdToken(r);const u=new ea({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new N1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const V2=new Map;function ws(n){ks(n instanceof Function,"Expected a class definition");let e=V2.get(n);return e?(ks(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,V2.set(n,e),e)}class IN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}IN.type="NONE";const z2=IN;function e0(n,e,t){return`firebase:${n}:${e}:${t}`}class Zu{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=e0(this.userKey,i.apiKey,a),this.fullPersistenceKey=e0("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await R0(this.auth,{idToken:e}).catch(()=>{});return t?ea._fromGetAccountInfoResponse(this.auth,t,e):null}return ea._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Zu(ws(z2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||ws(z2);const o=e0(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await R0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await ea._fromGetAccountInfoResponse(e,m,h)}else p=ea._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Zu(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new Zu(a,e,r))}}function L2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(NN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(RN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(PN(e))return"Blackberry";if(ON(e))return"Webos";if(DN(e))return"Safari";if((e.includes("chrome/")||kN(e))&&!e.includes("edge/"))return"Chrome";if(MN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function RN(n=Xn()){return/firefox\//i.test(n)}function DN(n=Xn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kN(n=Xn()){return/crios\//i.test(n)}function NN(n=Xn()){return/iemobile/i.test(n)}function MN(n=Xn()){return/android/i.test(n)}function PN(n=Xn()){return/blackberry/i.test(n)}function ON(n=Xn()){return/webos/i.test(n)}function vw(n=Xn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function DL(n=Xn()){return vw(n)&&!!window.navigator?.standalone}function kL(){return Yz()&&document.documentMode===10}function jN(n=Xn()){return vw(n)||MN(n)||ON(n)||PN(n)||/windows phone/i.test(n)||NN(n)}function VN(n,e=[]){let t;switch(n){case"Browser":t=L2(Xn());break;case"Worker":t=`${L2(Xn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dd}/${r}`}class NL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function ML(n,e={}){return ua(n,"GET","/v2/passwordPolicy",Xa(n,e))}const PL=6;class OL{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??PL,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class jL{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new B2(this),this.idTokenSubscription=new B2(this),this.beforeStateQueue=new NL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ws(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Zu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await R0(this,{idToken:e}),r=await ea._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ai(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return We(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await D0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=pL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ai(this.app))return Promise.reject(Ts(this));const t=e?Wt(e):null;return t&&We(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&We(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ai(this.app)?Promise.reject(Ts(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ai(this.app)?Promise.reject(Ts(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ws(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ML(this),t=new OL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new gp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await RL(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ws(e)||this._popupRedirectResolver;We(t,this,"argument-error"),this.redirectPersistenceManager=await Zu.create(this,[ws(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(We(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return We(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ai(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&dL(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ol(n){return Wt(n)}class B2{constructor(e){this.auth=e,this.observer=null,this.addObserver=Jz(t=>this.observer=t)}get next(){return We(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Sv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VL(n){Sv=n}function zN(n){return Sv.loadJS(n)}function zL(){return Sv.recaptchaEnterpriseScript}function LL(){return Sv.gapiScript}function BL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class UL{constructor(){this.enterprise=new FL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class FL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const GL="recaptcha-enterprise",LN="NO_RECAPTCHA";class qL{constructor(e){this.type=GL,this.auth=ol(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{_L(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new xL(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;O2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(LN)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new UL().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!t&&O2(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=zL();u.length!==0&&(u+=c),zN(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function U2(n,e,t,r=!1,i=!1){const a=new qL(n);let o;if(i)o=LN;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function k0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await U2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await U2(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}function $L(n,e){const t=hw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(Xo(a,e??{}))return i;aa(i,"already-initialized")}return t.initialize({options:e})}function HL(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ws);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function YL(n,e,t){const r=ol(n);We(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=BN(e),{host:o,port:c}=KL(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){We(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),We(Xo(d,r.config.emulator)&&Xo(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Rd(o)?(cN(`${a}//${o}${u}`),uN("Auth",!0)):XL()}function BN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function KL(n){const e=BN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:F2(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:F2(o)}}}function F2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function XL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class yw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _s("not implemented")}_getIdTokenResponse(e){return _s("not implemented")}_linkToIdToken(e,t){return _s("not implemented")}_getReauthenticationResolver(e){return _s("not implemented")}}async function WL(n,e){return ua(n,"POST","/v1/accounts:signUp",e)}async function QL(n,e){return ua(n,"POST","/v1/accounts:update",Xa(n,e))}async function ZL(n,e){return yp(n,"POST","/v1/accounts:signInWithPassword",Xa(n,e))}async function UN(n,e){return ua(n,"POST","/v1/accounts:sendOobCode",Xa(n,e))}async function JL(n,e){return UN(n,e)}async function e9(n,e){return UN(n,e)}async function t9(n,e){return yp(n,"POST","/v1/accounts:signInWithEmailLink",Xa(n,e))}async function n9(n,e){return yp(n,"POST","/v1/accounts:signInWithEmailLink",Xa(n,e))}class Vh extends yw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Vh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Vh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,t,"signInWithPassword",ZL);case"emailLink":return t9(e,{email:this._email,oobCode:this._password});default:aa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,r,"signUpPassword",WL);case"emailLink":return n9(e,{idToken:t,email:this._email,oobCode:this._password});default:aa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ju(n,e){return yp(n,"POST","/v1/accounts:signInWithIdp",Xa(n,e))}const r9="http://localhost";class mc extends yw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new mc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):aa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const o=new mc(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ju(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ju(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ju(e,t)}buildRequest(){const e={requestUri:r9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=mp(t)}return e}}function i9(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function a9(n){const e=rh(ih(n)).link,t=e?rh(ih(e)).deep_link_id:null,r=rh(ih(n)).deep_link_id;return(r?rh(ih(r)).link:null)||r||t||e||n}class bw{constructor(e){const t=rh(ih(e)),r=t.apiKey??null,i=t.oobCode??null,a=i9(t.mode??null);We(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=a9(e);try{return new bw(t)}catch{return null}}}class Nc{constructor(){this.providerId=Nc.PROVIDER_ID}static credential(e,t){return Vh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=bw.parseLink(t);return We(r,"argument-error"),Vh._fromEmailAndCode(e,r.code,r.tenantId)}}Nc.PROVIDER_ID="password";Nc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Nc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class FN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bp extends FN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class No extends bp{constructor(){super("facebook.com")}static credential(e){return mc._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return No.credential(e.oauthAccessToken)}catch{return null}}}No.FACEBOOK_SIGN_IN_METHOD="facebook.com";No.PROVIDER_ID="facebook.com";class Mo extends bp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return mc._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Mo.credential(t,r)}catch{return null}}}Mo.GOOGLE_SIGN_IN_METHOD="google.com";Mo.PROVIDER_ID="google.com";class Po extends bp{constructor(){super("github.com")}static credential(e){return mc._fromParams({providerId:Po.PROVIDER_ID,signInMethod:Po.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Po.credentialFromTaggedObject(e)}static credentialFromError(e){return Po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Po.credential(e.oauthAccessToken)}catch{return null}}}Po.GITHUB_SIGN_IN_METHOD="github.com";Po.PROVIDER_ID="github.com";class Oo extends bp{constructor(){super("twitter.com")}static credential(e,t){return mc._fromParams({providerId:Oo.PROVIDER_ID,signInMethod:Oo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Oo.credentialFromTaggedObject(e)}static credentialFromError(e){return Oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Oo.credential(t,r)}catch{return null}}}Oo.TWITTER_SIGN_IN_METHOD="twitter.com";Oo.PROVIDER_ID="twitter.com";async function s9(n,e){return yp(n,"POST","/v1/accounts:signUp",Xa(n,e))}class vc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await ea._fromIdTokenResponse(e,r,i),o=G2(r);return new vc({user:a,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=G2(r);return new vc({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function G2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class N0 extends Ls{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,N0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new N0(e,t,r,i)}}function GN(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?N0._fromErrorAndOperation(n,a,e,r):a})}async function o9(n,e,t=!1){const r=await ad(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return vc._forOperation(n,"link",r)}async function qN(n,e,t=!1){const{auth:r}=n;if(Ai(r.app))return Promise.reject(Ts(r));const i="reauthenticate";try{const a=await ad(n,GN(r,i,e,n),t);We(a.idToken,r,"internal-error");const o=mw(a.idToken);We(o,r,"internal-error");const{sub:c}=o;return We(n.uid===c,r,"user-mismatch"),vc._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&aa(r,"user-mismatch"),a}}async function $N(n,e,t=!1){if(Ai(n.app))return Promise.reject(Ts(n));const r="signIn",i=await GN(n,r,e),a=await vc._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function l9(n,e){return $N(ol(n),e)}async function c9(n,e){return qN(Wt(n),e)}function u9(n,e,t){We(t.url?.length>0,n,"invalid-continue-uri"),We(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),We(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(We(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(We(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function HN(n){const e=ol(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function d9(n,e,t){const r=ol(n);await k0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",e9)}async function f9(n,e){await QL(Wt(n),{oobCode:e})}async function h9(n,e,t){if(Ai(n.app))return Promise.reject(Ts(n));const r=ol(n),o=await k0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",s9).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&HN(n),u}),c=await vc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function p9(n,e,t){return Ai(n.app)?Promise.reject(Ts(n)):l9(Wt(n),Nc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&HN(n),r})}async function q2(n,e){const t=Wt(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&u9(t.auth,i,e);const{email:a}=await JL(t.auth,i);a!==n.email&&await n.reload()}async function g9(n,e){return ua(n,"POST","/v1/accounts:update",e)}async function m9(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Wt(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await ad(r,g9(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function v9(n,e,t,r){return Wt(n).onIdTokenChanged(e,t,r)}function y9(n,e,t){return Wt(n).beforeAuthStateChanged(e,t)}function b9(n,e,t,r){return Wt(n).onAuthStateChanged(e,t,r)}function $2(n){return Wt(n).signOut()}async function x9(n){return Wt(n).delete()}const M0="__sak";class YN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(M0,"1"),this.storage.removeItem(M0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const _9=1e3,w9=10;class KN extends YN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);kL()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,w9):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},_9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}KN.type="LOCAL";const E9=KN;class XN extends YN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}XN.type="SESSION";const WN=XN;function S9(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Tv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Tv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(t.origin,a)),u=await S9(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tv.receivers=[];function xw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class T9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=xw("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function La(){return window}function A9(n){La().location.href=n}function QN(){return typeof La().WorkerGlobalScope<"u"&&typeof La().importScripts=="function"}async function C9(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function I9(){return navigator?.serviceWorker?.controller||null}function R9(){return QN()?self:null}const ZN="firebaseLocalStorageDb",D9=1,P0="firebaseLocalStorage",JN="fbase_key";class xp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Av(n,e){return n.transaction([P0],e?"readwrite":"readonly").objectStore(P0)}function k9(){const n=indexedDB.deleteDatabase(ZN);return new xp(n).toPromise()}function M1(){const n=indexedDB.open(ZN,D9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(P0,{keyPath:JN})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(P0)?e(r):(r.close(),await k9(),e(await M1()))})})}async function H2(n,e,t){const r=Av(n,!0).put({[JN]:e,value:t});return new xp(r).toPromise()}async function N9(n,e){const t=Av(n,!1).get(e),r=await new xp(t).toPromise();return r===void 0?null:r.value}function Y2(n,e){const t=Av(n,!0).delete(e);return new xp(t).toPromise()}const M9=800,P9=3;class eM{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await M1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>P9)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return QN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tv._getInstance(R9()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await C9(),!this.activeServiceWorker)return;this.sender=new T9(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||I9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await M1();return await H2(e,M0,"1"),await Y2(e,M0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>H2(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>N9(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Y2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Av(i,!1).getAll();return new xp(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),M9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eM.type="LOCAL";const O9=eM;new vp(3e4,6e4);function j9(n,e){return e?ws(e):(We(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class _w extends yw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ju(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ju(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ju(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function V9(n){return $N(n.auth,new _w(n),n.bypassAuthState)}function z9(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),qN(t,new _w(n),n.bypassAuthState)}async function L9(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),o9(t,new _w(n),n.bypassAuthState)}class tM{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return V9;case"linkViaPopup":case"linkViaRedirect":return L9;case"reauthViaPopup":case"reauthViaRedirect":return z9;default:aa(this.auth,"internal-error")}}resolve(e){ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const B9=new vp(2e3,1e4);class Lu extends tM{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Lu.currentPopupAction&&Lu.currentPopupAction.cancel(),Lu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return We(e,this.auth,"internal-error"),e}async onExecution(){ks(this.filter.length===1,"Popup operations only handle one event");const e=xw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(za(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(za(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(za(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,B9.get())};e()}}Lu.currentPopupAction=null;const U9="pendingRedirect",t0=new Map;class F9 extends tM{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=t0.get(this.auth._key());if(!e){try{const r=await G9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}t0.set(this.auth._key(),e)}return this.bypassAuthState||t0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function G9(n,e){const t=H9(e),r=$9(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function q9(n,e){t0.set(n._key(),e)}function $9(n){return ws(n._redirectPersistence)}function H9(n){return e0(U9,n.config.apiKey,n.name)}async function Y9(n,e,t=!1){if(Ai(n.app))return Promise.reject(Ts(n));const r=ol(n),i=j9(r,e),o=await new F9(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const K9=600*1e3;class X9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!W9(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!nM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(za(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=K9&&this.cachedEventUids.clear(),this.cachedEventUids.has(K2(e))}saveEventToCache(e){this.cachedEventUids.add(K2(e)),this.lastProcessedEventTime=Date.now()}}function K2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function nM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function W9(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nM(n);default:return!1}}async function Q9(n,e={}){return ua(n,"GET","/v1/projects",e)}const Z9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,J9=/^https?/;async function eB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Q9(n);for(const t of e)try{if(tB(t))return}catch{}aa(n,"unauthorized-domain")}function tB(n){const e=k1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!J9.test(t))return!1;if(Z9.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const nB=new vp(3e4,6e4);function X2(){const n=La().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function rB(n){return new Promise((e,t)=>{function r(){X2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{X2(),t(za(n,"network-request-failed"))},timeout:nB.get()})}if(La().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(La().gapi?.load)r();else{const i=BL("iframefcb");return La()[i]=()=>{gapi.load?r():t(za(n,"network-request-failed"))},zN(`${LL()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw n0=null,e})}let n0=null;function iB(n){return n0=n0||rB(n),n0}const aB=new vp(5e3,15e3),sB="__/auth/iframe",oB="emulator/auth/iframe",lB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uB(n){const e=n.config;We(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?gw(e,oB):`https://${n.config.authDomain}/${sB}`,r={apiKey:e.apiKey,appName:n.name,v:Dd},i=cB.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${mp(r).slice(1)}`}async function dB(n){const e=await iB(n),t=La().gapi;return We(t,n,"internal-error"),e.open({where:document.body,url:uB(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lB,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=za(n,"network-request-failed"),c=La().setTimeout(()=>{a(o)},aB.get());function u(){La().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const fB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hB=500,pB=600,gB="_blank",mB="http://localhost";class W2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function vB(n,e,t,r=hB,i=pB){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...fB,width:r.toString(),height:i.toString(),top:a,left:o},d=Xn().toLowerCase();t&&(c=kN(d)?gB:t),RN(d)&&(e=e||mB,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(DL(d)&&c!=="_self")return yB(e||"",c),new W2(null);const p=window.open(e||"",c,h);We(p,n,"popup-blocked");try{p.focus()}catch{}return new W2(p)}function yB(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const bB="__/auth/handler",xB="emulator/auth/handler",_B=encodeURIComponent("fac");async function Q2(n,e,t,r,i,a){We(n.config.authDomain,n,"auth-domain-config-required"),We(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Dd,eventId:i};if(e instanceof FN){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Zz(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof bp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${_B}=${encodeURIComponent(u)}`:"";return`${wB(n)}?${mp(c).slice(1)}${d}`}function wB({config:n}){return n.emulator?gw(n,xB):`https://${n.authDomain}/${bB}`}const Dx="webStorageSupport";class EB{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WN,this._completeRedirectFn=Y9,this._overrideRedirectResult=q9}async _openPopup(e,t,r,i){ks(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await Q2(e,t,r,k1(),i);return vB(e,a,xw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await Q2(e,t,r,k1(),i);return A9(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(ks(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await dB(e),r=new X9(e);return t.register("authEvent",i=>(We(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Dx,{type:Dx},i=>{const a=i?.[0]?.[Dx];a!==void 0&&t(!!a),aa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=eB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jN()||DN()||vw()}}const SB=EB;var Z2="@firebase/auth",J2="1.11.1";class TB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){We(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function AB(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function CB(n){id(new gc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;We(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VN(n)},d=new jL(r,i,a,u);return HL(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),id(new gc("auth-internal",e=>{const t=ol(e.getProvider("auth").getImmediate());return(r=>new TB(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),qo(Z2,J2,AB(n)),qo(Z2,J2,"esm2020")}const IB=300,RB=lN("authIdTokenMaxAge")||IB;let eI=null;const DB=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>RB)return;const i=t?.token;eI!==i&&(eI=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function kB(n=yN()){const e=hw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=$L(n,{popupRedirectResolver:SB,persistence:[O9,E9,WN]}),r=lN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=DB(a.toString());y9(t,o,()=>o(t.currentUser)),v9(t,c=>o(c))}}const i=sN("auth");return i&&YL(t,`http://${i}`),t}function NB(){return document.getElementsByTagName("head")?.[0]??document}VL({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=za("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",NB().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});CB("Browser");var tI="popstate";function MB(n={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Mc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),P1("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:zh(a))}function r(i,a){Mi(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return OB(e,t,r,n)}function hn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Mi(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function PB(){return Math.random().toString(36).substring(2,10)}function nI(n,e){return{usr:n.state,key:n.key,idx:e}}function P1(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Mc(e):e,state:t,key:e&&e.key||r||PB()}}function zh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Mc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function OB(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:w.location,delta:T})}function m(S,T){c="PUSH";let C=P1(w.location,S,T);t&&t(C,S),d=h()+1;let R=nI(C,d),O=w.createHref(C);try{o.pushState(R,"",O)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(O)}a&&u&&u({action:c,location:w.location,delta:1})}function b(S,T){c="REPLACE";let C=P1(w.location,S,T);t&&t(C,S),d=h();let R=nI(C,d),O=w.createHref(C);o.replaceState(R,"",O),a&&u&&u({action:c,location:w.location,delta:0})}function _(S){return jB(S)}let w={get action(){return c},get location(){return n(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(tI,p),u=S,()=>{i.removeEventListener(tI,p),u=null}},createHref(S){return e(i,S)},createURL:_,encodeLocation(S){let T=_(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return w}function jB(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),hn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:zh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function rM(n,e,t="/"){return VB(n,e,t,!1)}function VB(n,e,t,r){let i=typeof e=="string"?Mc(e):e,a=Ns(i.pathname||"/",t);if(a==null)return null;let o=iM(n);zB(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=XB(a);c=YB(o[u],d,r)}return c}function iM(n,e=[],t=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;hn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=As([r,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(hn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),iM(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:$B(p,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of aM(o.path))a(o,c,!0,u)}),e}function aM(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=aM(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function zB(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:HB(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var LB=/^:[\w-]+$/,BB=3,UB=2,FB=1,GB=10,qB=-2,rI=n=>n==="*";function $B(n,e){let t=n.split("/"),r=t.length;return t.some(rI)&&(r+=qB),e&&(r+=UB),t.filter(i=>!rI(i)).reduce((i,a)=>i+(LB.test(a)?BB:a===""?FB:GB),r)}function HB(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function YB(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=O0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=O0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:As([a,p.pathname]),pathnameBase:JB(As([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=As([a,p.pathnameBase]))}return o}function O0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=KB(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function KB(n,e=!1,t=!0){Mi(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function XB(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mi(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Ns(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var WB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function QB(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Mc(n):n,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=iI(t.substring(1),"/"):a=iI(t,e)):a=e,{pathname:a,search:e8(r),hash:t8(i)}}function iI(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function kx(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZB(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function sM(n){let e=ZB(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function oM(n,e,t,r=!1){let i;typeof n=="string"?i=Mc(n):(i={...n},hn(!i.pathname||!i.pathname.includes("?"),kx("?","pathname","search",i)),hn(!i.pathname||!i.pathname.includes("#"),kx("#","pathname","hash",i)),hn(!i.search||!i.search.includes("#"),kx("#","search","hash",i)));let a=n===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=QB(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var As=n=>n.join("/").replace(/\/\/+/g,"/"),JB=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),e8=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,t8=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,n8=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function r8(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function i8(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var lM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function cM(n,e){let t=n;if(typeof t!="string"||!WB.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(lM)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=Ns(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:i=!0}catch{Mi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var uM=["POST","PUT","PATCH","DELETE"];new Set(uM);var a8=["GET",...uM];new Set(a8);var kd=U.createContext(null);kd.displayName="DataRouter";var Cv=U.createContext(null);Cv.displayName="DataRouterState";var s8=U.createContext(!1),dM=U.createContext({isTransitioning:!1});dM.displayName="ViewTransition";var o8=U.createContext(new Map);o8.displayName="Fetchers";var l8=U.createContext(null);l8.displayName="Await";var ji=U.createContext(null);ji.displayName="Navigation";var _p=U.createContext(null);_p.displayName="Location";var Wa=U.createContext({outlet:null,matches:[],isDataRoute:!1});Wa.displayName="Route";var ww=U.createContext(null);ww.displayName="RouteError";var fM="REACT_ROUTER_ERROR",c8="REDIRECT",u8="ROUTE_ERROR_RESPONSE";function d8(n){if(n.startsWith(`${fM}:${c8}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function f8(n){if(n.startsWith(`${fM}:${u8}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new n8(e.status,e.statusText,e.data)}catch{}}function h8(n,{relative:e}={}){hn(wp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(ji),{hash:i,pathname:a,search:o}=Ep(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:As([t,a])),r.createHref({pathname:c,search:o,hash:i})}function wp(){return U.useContext(_p)!=null}function da(){return hn(wp(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(_p).location}var hM="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pM(n){U.useContext(ji).static||U.useLayoutEffect(n)}function Qa(){let{isDataRoute:n}=U.useContext(Wa);return n?C8():p8()}function p8(){hn(wp(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(kd),{basename:e,navigator:t}=U.useContext(ji),{matches:r}=U.useContext(Wa),{pathname:i}=da(),a=JSON.stringify(sM(r)),o=U.useRef(!1);return pM(()=>{o.current=!0}),U.useCallback((u,d={})=>{if(Mi(o.current,hM),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=oM(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:As([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}U.createContext(null);function g8(){let{matches:n}=U.useContext(Wa),e=n[n.length-1];return e?e.params:{}}function Ep(n,{relative:e}={}){let{matches:t}=U.useContext(Wa),{pathname:r}=da(),i=JSON.stringify(sM(t));return U.useMemo(()=>oM(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function m8(n,e){return gM(n,e)}function gM(n,e,t,r,i){hn(wp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(ji),{matches:o}=U.useContext(Wa),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";vM(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=da(),b;if(e){let C=typeof e=="string"?Mc(e):e;hn(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=rM(n,{pathname:w});Mi(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Mi(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=_8(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:As([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:As([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,t,r,i);return e&&T?U.createElement(_p.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function v8(){let n=A8(),e=r8(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,o)}var y8=U.createElement(v8,null),mM=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=f8(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(Wa.Provider,{value:this.props.routeContext},U.createElement(ww.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(b8,{error:n},e):e}};mM.contextType=s8;var Nx=new WeakMap;function b8({children:n,error:e}){let{basename:t}=U.useContext(ji);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=d8(e.digest);if(r){let i=Nx.get(e);if(i)throw i;let a=cM(r.location,t);if(lM&&!Nx.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw Nx.set(e,o),o}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function x8({routeContext:n,match:e,children:t}){let r=U.useContext(kd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Wa.Provider,{value:n},t)}function _8(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);hn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:i8(t.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,S=null;t&&(b=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||y8,c&&(u<0&&m===0?(vM("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):u===m&&(_=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let R;return b?R=w:_?R=S:p.route.Component?R=U.createElement(p.route.Component,null):p.route.element?R=p.route.element:R=h,U.createElement(x8,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:R})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?U.createElement(mM,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function Ew(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function w8(n){let e=U.useContext(kd);return hn(e,Ew(n)),e}function E8(n){let e=U.useContext(Cv);return hn(e,Ew(n)),e}function S8(n){let e=U.useContext(Wa);return hn(e,Ew(n)),e}function Sw(n){let e=S8(n),t=e.matches[e.matches.length-1];return hn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function T8(){return Sw("useRouteId")}function A8(){let n=U.useContext(ww),e=E8("useRouteError"),t=Sw("useRouteError");return n!==void 0?n:e.errors?.[t]}function C8(){let{router:n}=w8("useNavigate"),e=Sw("useNavigate"),t=U.useRef(!1);return pM(()=>{t.current=!0}),U.useCallback(async(i,a={})=>{Mi(t.current,hM),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var aI={};function vM(n,e,t){!e&&!aI[n]&&(aI[n]=!0,Mi(!1,t))}U.memo(I8);function I8({routes:n,future:e,state:t,onError:r}){return gM(n,void 0,t,r,e)}function bs(n){hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function R8({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){hn(!wp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof t=="string"&&(t=Mc(t));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=t,_=U.useMemo(()=>{let w=Ns(d,c);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Mi(_!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement(ji.Provider,{value:u},U.createElement(_p.Provider,{children:e,value:_}))}function D8({children:n,location:e}){return m8(O1(n),e)}function O1(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let a=[...e,i];if(r.type===U.Fragment){t.push.apply(t,O1(r.props.children,a));return}hn(r.type===bs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=O1(r.props.children,a)),t.push(o)}),t}var r0="get",i0="application/x-www-form-urlencoded";function Iv(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function k8(n){return Iv(n)&&n.tagName.toLowerCase()==="button"}function N8(n){return Iv(n)&&n.tagName.toLowerCase()==="form"}function M8(n){return Iv(n)&&n.tagName.toLowerCase()==="input"}function P8(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function O8(n,e){return n.button===0&&(!e||e==="_self")&&!P8(n)}function j1(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function j8(n,e){let t=j1(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var Tm=null;function V8(){if(Tm===null)try{new FormData(document.createElement("form"),0),Tm=!1}catch{Tm=!0}return Tm}var z8=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Mx(n){return n!=null&&!z8.has(n)?(Mi(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${i0}"`),null):n}function L8(n,e){let t,r,i,a,o;if(N8(n)){let c=n.getAttribute("action");r=c?Ns(c,e):null,t=n.getAttribute("method")||r0,i=Mx(n.getAttribute("enctype"))||i0,a=new FormData(n)}else if(k8(n)||M8(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?Ns(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||r0,i=Mx(n.getAttribute("formenctype"))||Mx(c.getAttribute("enctype"))||i0,a=new FormData(c,n),!V8()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(Iv(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=r0,r=null,i=i0,o=n}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Tw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function B8(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Ns(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function U8(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function F8(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function G8(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await U8(a,t);return o.links?o.links():[]}return[]}));return Y8(r.flat(1).filter(F8).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function sI(n,e,t,r,i,a){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function q8(n,e,{includeHydrateFallback:t}={}){return $8(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function $8(n){return[...new Set(n)]}function H8(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function Y8(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(H8(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function yM(){let n=U.useContext(kd);return Tw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function K8(){let n=U.useContext(Cv);return Tw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Aw=U.createContext(void 0);Aw.displayName="FrameworkContext";function bM(){let n=U.useContext(Aw);return Tw(n,"You must render this element inside a <HydratedRouter> element"),n}function X8(n,e){let t=U.useContext(Aw),[r,i]=U.useState(!1),[a,o]=U.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let w=T=>{T.forEach(C=>{o(C.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),U.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Kf(c,b),onBlur:Kf(u,_),onMouseEnter:Kf(d,b),onMouseLeave:Kf(h,_),onTouchStart:Kf(p,b)}]:[!1,m,{}]}function Kf(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function W8({page:n,...e}){let{router:t}=yM(),r=U.useMemo(()=>rM(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(Z8,{page:n,matches:r,...e}):null}function Q8(n){let{manifest:e,routeModules:t}=bM(),[r,i]=U.useState([]);return U.useEffect(()=>{let a=!1;return G8(n,e,t).then(o=>{a||i(o)}),()=>{a=!0}},[n,e,t]),r}function Z8({page:n,matches:e,...t}){let r=da(),{future:i,manifest:a,routeModules:o}=bM(),{basename:c}=yM(),{loaderData:u,matches:d}=K8(),h=U.useMemo(()=>sI(n,e,d,a,r,"data"),[n,e,d,a,r]),p=U.useMemo(()=>sI(n,e,d,a,r,"assets"),[n,e,d,a,r]),m=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,S=!1;if(e.forEach(C=>{let R=a.routes[C.route.id];!R||!R.hasLoader||(!h.some(O=>O.route.id===C.route.id)&&C.route.id in u&&o[C.route.id]?.shouldRevalidate||R.hasClientLoader?S=!0:w.add(C.route.id))}),w.size===0)return[];let T=B8(n,c,i.unstable_trailingSlashAwareDataRequests,"data");return S&&w.size>0&&T.searchParams.set("_routes",e.filter(C=>w.has(C.route.id)).map(C=>C.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,n,o]),b=U.useMemo(()=>q8(p,a),[p,a]),_=Q8(p);return U.createElement(U.Fragment,null,m.map(w=>U.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>U.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),_.map(({key:w,link:S})=>U.createElement("link",{key:w,nonce:t.nonce,...S,crossOrigin:S.crossOrigin??t.crossOrigin})))}function J8(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var eU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{eU&&(window.__reactRouterVersion="7.13.0")}catch{}function tU({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=MB({window:r,v5Compat:!0}));let a=i.current,[o,c]=U.useState({action:a.action,location:a.location}),u=U.useCallback(d=>{t===!1?c(d):U.startTransition(()=>c(d))},[t]);return U.useLayoutEffect(()=>a.listen(u),[a,u]),U.createElement(R8,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var xM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_M=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_){let{basename:w,unstable_useTransitions:S}=U.useContext(ji),T=typeof d=="string"&&xM.test(d),C=cM(d,w);d=C.to;let R=h8(d,{relative:i}),[O,P,M]=X8(r,b),A=aU(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:S});function I(z){e&&e(z),z.defaultPrevented||A(z)}let k=U.createElement("a",{...b,...M,href:C.absoluteURL||R,onClick:C.isExternal||a?e:I,ref:J8(_,P),target:u,"data-discover":!T&&t==="render"?"true":void 0});return O&&!T?U.createElement(U.Fragment,null,k,U.createElement(W8,{page:R})):k});_M.displayName="Link";var nU=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=Ep(o,{relative:d.relative}),m=da(),b=U.useContext(Cv),{navigator:_,basename:w}=U.useContext(ji),S=b!=null&&dU(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,C=m.pathname,R=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(C=C.toLowerCase(),R=R?R.toLowerCase():null,T=T.toLowerCase()),R&&w&&(R=Ns(R,w)||R);const O=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let P=C===T||!i&&C.startsWith(T)&&C.charAt(O)==="/",M=R!=null&&(R===T||!i&&R.startsWith(T)&&R.charAt(T.length)==="/"),A={isActive:P,isPending:M,isTransitioning:S},I=P?e:void 0,k;typeof r=="function"?k=r(A):k=[r,P?"active":null,M?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let z=typeof a=="function"?a(A):a;return U.createElement(_M,{...d,"aria-current":I,className:k,ref:h,style:z,to:o,viewTransition:c},typeof u=="function"?u(A):u)});nU.displayName="NavLink";var rU=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:o=r0,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_)=>{let{unstable_useTransitions:w}=U.useContext(ji),S=cU(),T=uU(c,{relative:d}),C=o.toLowerCase()==="get"?"get":"post",R=typeof c=="string"&&xM.test(c),O=P=>{if(u&&u(P),P.defaultPrevented)return;P.preventDefault();let M=P.nativeEvent.submitter,A=M?.getAttribute("formmethod")||o,I=()=>S(M||P.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});w&&t!==!1?U.startTransition(()=>I()):I()};return U.createElement("form",{ref:_,method:C,action:T,onSubmit:r?u:O,...b,"data-discover":!R&&n==="render"?"true":void 0})});rU.displayName="Form";function iU(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wM(n){let e=U.useContext(kd);return hn(e,iU(n)),e}function aU(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=Qa(),h=da(),p=Ep(n,{relative:a});return U.useCallback(m=>{if(O8(m,e)){m.preventDefault();let b=t!==void 0?t:zh(h)===zh(p),_=()=>d(n,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?U.startTransition(()=>_()):_()}},[h,d,p,t,r,e,n,i,a,o,c,u])}function sU(n){Mi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(j1(n)),t=U.useRef(!1),r=da(),i=U.useMemo(()=>j8(r.search,t.current?null:e.current),[r.search]),a=Qa(),o=U.useCallback((c,u)=>{const d=j1(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var oU=0,lU=()=>`__${String(++oU)}__`;function cU(){let{router:n}=wM("useSubmit"),{basename:e}=U.useContext(ji),t=T8(),r=n.fetch,i=n.navigate;return U.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=L8(a,e);if(o.navigate===!1){let m=o.fetcherKey||lU();await r(m,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,t])}function uU(n,{relative:e}={}){let{basename:t}=U.useContext(ji),r=U.useContext(Wa);hn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...Ep(n||".",{relative:e})},o=da();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:As([t,a.pathname])),zh(a)}function dU(n,{relative:e}={}){let t=U.useContext(dM);hn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=wM("useViewTransitionState"),i=Ep(n,{relative:e});if(!t.isTransitioning)return!1;let a=Ns(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Ns(t.nextLocation.pathname,r)||t.nextLocation.pathname;return O0(i.pathname,o)!=null||O0(i.pathname,a)!=null}const fU=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),hU=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),oI=n=>{const e=hU(n);return e.charAt(0).toUpperCase()+e.slice(1)},EM=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),pU=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var gU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mU=U.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>U.createElement("svg",{ref:u,...gU,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:EM("lucide",i),...!a&&!pU(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>U.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Je=(n,e)=>{const t=U.forwardRef(({className:r,...i},a)=>U.createElement(mU,{ref:a,iconNode:e,className:EM(`lucide-${fU(oI(n))}`,`lucide-${n}`,r),...i}));return t.displayName=oI(n),t};const vU=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],yU=Je("arrow-down",vU);const bU=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],yc=Je("arrow-left",bU);const xU=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],_U=Je("arrow-right-left",xU);const wU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],EU=Je("arrow-right",wU);const SU=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],TU=Je("arrow-up",SU);const AU=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],CU=Je("calendar",AU);const IU=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],RU=Je("chart-column",IU);const DU=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],kU=Je("chart-pie",DU);const NU=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],MU=Je("check",NU);const PU=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],OU=Je("chevron-left",PU);const jU=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ka=Je("chevron-right",jU);const VU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],zU=Je("circle-arrow-down",VU);const LU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],BU=Je("circle-arrow-up",LU);const UU=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],V1=Je("circle-check-big",UU);const FU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],xs=Je("circle-check",FU);const GU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],lI=Je("circle",GU);const qU=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],cI=Je("dollar-sign",qU);const $U=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],uI=Je("download",$U);const HU=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],YU=Je("ellipsis",HU);const KU=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],XU=Je("eye-off",KU);const WU=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],QU=Je("eye",WU);const ZU=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],JU=Je("file-text",ZU);const eF=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],tF=Je("folder",eF);const nF=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],rF=Je("funnel",nF);const iF=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],SM=Je("grip-vertical",iF);const aF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],sF=Je("house",aF);const oF=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],lF=Je("list",oF);const cF=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],dI=Je("loader",cF);const uF=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],dF=Je("log-out",uF);const fF=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],z1=Je("mail",fF);const hF=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],pF=Je("pause",hF);const gF=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],mF=Je("pen",gF);const vF=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],Sp=Je("piggy-bank",vF);const yF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Tp=Je("plus",yF);const bF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Lh=Je("refresh-cw",bF);const xF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],_F=Je("rotate-ccw",xF);const wF=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],EF=Je("search",wF);const SF=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],TF=Je("settings",SF);const AF=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Bh=Je("sparkles",AF);const CF=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],IF=Je("tags",CF);const RF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],DF=Je("target",RF);const kF=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],j0=Je("trash-2",kF);const NF=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],TM=Je("trash",NF);const MF=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],V0=Je("trending-up",MF);const PF=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ed=Je("triangle-alert",PF);const OF=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],jF=Je("undo-2",OF);const VF=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],zF=Je("upload",VF);const LF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],BF=Je("user-plus",LF);const UF=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Rv=Je("wallet",UF);const FF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Dv=Je("x",FF),fI=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},GF=(n=>n?fI(n):fI),qF=n=>n;function $F(n,e=qF){const t=nh.useSyncExternalStore(n.subscribe,nh.useCallback(()=>e(n.getState()),[n,e]),nh.useCallback(()=>e(n.getInitialState()),[n,e]));return nh.useDebugValue(t),t}const hI=n=>{const e=GF(n),t=r=>$F(e,r);return Object.assign(t,e),t},Cw=(n=>n?hI(n):hI),pI={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",VITE_FIREBASE_APP_ID:"1:137454342284:web:0ae73943f9058a4342aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-VMP5DF6273",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},Uh=new Map,Am=n=>{const e=Uh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},HF=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=Uh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return Uh.set(t.name,i),{type:"tracked",store:n,...i}},YF=(n,e)=>{if(e===void 0)return;const t=Uh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&Uh.delete(n))},KF=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},XF=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(pI?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=HF(c,d,u);let m=!0;i.setState=((w,S,T)=>{const C=t(w,S);if(!m)return C;const R=T===void 0?{type:o||KF(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(R,r()),C):(h?.send({...R,type:`${c}/${R.type}`},{...Am(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),YF(u.name,c)}};const b=(...w)=>{const S=m;m=!1,t(...w),m=S},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,S])=>[w,w===p.store?_:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const S=i.dispatch;i.dispatch=(...T)=>{(pI?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),S(...T)}}return h.subscribe(w=>{var S;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Px(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(Am(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Am(u.name));case"ROLLBACK":return Px(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Am(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Px(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,C=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},WF=XF,Px=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function QF(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const L1=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return L1(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return L1(r)(t)}}}},ZF=(n,e)=>(t,r,i)=>{let a={storage:QF(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,S)=>(p(w,S),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,S;if(!d)return;o=!1,c.forEach(C=>{var R;return C((R=r())!=null?R:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(w=r())!=null?w:m))||void 0;return L1(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const R=a.migrate(C.state,C.version);return R instanceof Promise?R.then(O=>[!0,O]):[!0,R]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var R;const[O,P]=C;if(b=a.merge(P,(R=r())!=null?R:m),t(b,!0),O)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},AM=ZF;var JF="firebase",e7="12.6.0";qo(JF,e7,"app");var gI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $o,CM;(function(){var n;function e(A,I){function k(){}k.prototype=I.prototype,A.F=I.prototype,A.prototype=new k,A.prototype.constructor=A,A.D=function(z,V,B){for(var j=Array(arguments.length-2),X=2;X<arguments.length;X++)j[X-2]=arguments[X];return I.prototype[V].apply(z,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,I,k){k||(k=0);const z=Array(16);if(typeof I=="string")for(var V=0;V<16;++V)z[V]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(V=0;V<16;++V)z[V]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=A.g[0],k=A.g[1],V=A.g[2];let B=A.g[3],j;j=I+(B^k&(V^B))+z[0]+3614090360&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[1]+3905402710&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[2]+606105819&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[3]+3250441966&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(B^k&(V^B))+z[4]+4118548399&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[5]+1200080426&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[6]+2821735955&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[7]+4249261313&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(B^k&(V^B))+z[8]+1770035416&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[9]+2336552879&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[10]+4294925233&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[11]+2304563134&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(B^k&(V^B))+z[12]+1804603682&4294967295,I=k+(j<<7&4294967295|j>>>25),j=B+(V^I&(k^V))+z[13]+4254626195&4294967295,B=I+(j<<12&4294967295|j>>>20),j=V+(k^B&(I^k))+z[14]+2792965006&4294967295,V=B+(j<<17&4294967295|j>>>15),j=k+(I^V&(B^I))+z[15]+1236535329&4294967295,k=V+(j<<22&4294967295|j>>>10),j=I+(V^B&(k^V))+z[1]+4129170786&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[6]+3225465664&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[11]+643717713&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[0]+3921069994&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(V^B&(k^V))+z[5]+3593408605&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[10]+38016083&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[15]+3634488961&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[4]+3889429448&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(V^B&(k^V))+z[9]+568446438&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[14]+3275163606&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[3]+4107603335&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[8]+1163531501&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(V^B&(k^V))+z[13]+2850285829&4294967295,I=k+(j<<5&4294967295|j>>>27),j=B+(k^V&(I^k))+z[2]+4243563512&4294967295,B=I+(j<<9&4294967295|j>>>23),j=V+(I^k&(B^I))+z[7]+1735328473&4294967295,V=B+(j<<14&4294967295|j>>>18),j=k+(B^I&(V^B))+z[12]+2368359562&4294967295,k=V+(j<<20&4294967295|j>>>12),j=I+(k^V^B)+z[5]+4294588738&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[8]+2272392833&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[11]+1839030562&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[14]+4259657740&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(k^V^B)+z[1]+2763975236&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[4]+1272893353&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[7]+4139469664&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[10]+3200236656&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(k^V^B)+z[13]+681279174&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[0]+3936430074&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[3]+3572445317&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[6]+76029189&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(k^V^B)+z[9]+3654602809&4294967295,I=k+(j<<4&4294967295|j>>>28),j=B+(I^k^V)+z[12]+3873151461&4294967295,B=I+(j<<11&4294967295|j>>>21),j=V+(B^I^k)+z[15]+530742520&4294967295,V=B+(j<<16&4294967295|j>>>16),j=k+(V^B^I)+z[2]+3299628645&4294967295,k=V+(j<<23&4294967295|j>>>9),j=I+(V^(k|~B))+z[0]+4096336452&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[7]+1126891415&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[14]+2878612391&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[5]+4237533241&4294967295,k=V+(j<<21&4294967295|j>>>11),j=I+(V^(k|~B))+z[12]+1700485571&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[3]+2399980690&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[10]+4293915773&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[1]+2240044497&4294967295,k=V+(j<<21&4294967295|j>>>11),j=I+(V^(k|~B))+z[8]+1873313359&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[15]+4264355552&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[6]+2734768916&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[13]+1309151649&4294967295,k=V+(j<<21&4294967295|j>>>11),j=I+(V^(k|~B))+z[4]+4149444226&4294967295,I=k+(j<<6&4294967295|j>>>26),j=B+(k^(I|~V))+z[11]+3174756917&4294967295,B=I+(j<<10&4294967295|j>>>22),j=V+(I^(B|~k))+z[2]+718787259&4294967295,V=B+(j<<15&4294967295|j>>>17),j=k+(B^(V|~I))+z[9]+3951481745&4294967295,A.g[0]=A.g[0]+I&4294967295,A.g[1]=A.g[1]+(V+(j<<21&4294967295|j>>>11))&4294967295,A.g[2]=A.g[2]+V&4294967295,A.g[3]=A.g[3]+B&4294967295}r.prototype.v=function(A,I){I===void 0&&(I=A.length);const k=I-this.blockSize,z=this.C;let V=this.h,B=0;for(;B<I;){if(V==0)for(;B<=k;)i(this,A,B),B+=this.blockSize;if(typeof A=="string"){for(;B<I;)if(z[V++]=A.charCodeAt(B++),V==this.blockSize){i(this,z),V=0;break}}else for(;B<I;)if(z[V++]=A[B++],V==this.blockSize){i(this,z),V=0;break}}this.h=V,this.o+=I},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var I=1;I<A.length-8;++I)A[I]=0;I=this.o*8;for(var k=A.length-8;k<A.length;++k)A[k]=I&255,I/=256;for(this.v(A),A=Array(16),I=0,k=0;k<4;++k)for(let z=0;z<32;z+=8)A[I++]=this.g[k]>>>z&255;return A};function a(A,I){var k=c;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=I(A)}function o(A,I){this.h=I;const k=[];let z=!0;for(let V=A.length-1;V>=0;V--){const B=A[V]|0;z&&B==I||(k[V]=B,z=!1)}this.g=k}var c={};function u(A){return-128<=A&&A<128?a(A,function(I){return new o([I|0],I<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return S(d(-A));const I=[];let k=1;for(let z=0;A>=k;z++)I[z]=A/k|0,k*=4294967296;return new o(I,0)}function h(A,I){if(A.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(A.charAt(0)=="-")return S(h(A.substring(1),I));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(I,8));let z=p;for(let B=0;B<A.length;B+=8){var V=Math.min(8,A.length-B);const j=parseInt(A.substring(B,B+V),I);V<8?(V=d(Math.pow(I,V)),z=z.j(V).add(d(j))):(z=z.j(k),z=z.add(d(j)))}return z}var p=u(0),m=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(w(this))return-S(this).m();let A=0,I=1;for(let k=0;k<this.g.length;k++){const z=this.i(k);A+=(z>=0?z:4294967296+z)*I,I*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(_(this))return"0";if(w(this))return"-"+S(this).toString(A);const I=d(Math.pow(A,6));var k=this;let z="";for(;;){const V=O(k,I).g;k=T(k,V.j(I));let B=((k.g.length>0?k.g[0]:k.h)>>>0).toString(A);if(k=V,_(k))return B+z;for(;B.length<6;)B="0"+B;z=B+z}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function _(A){if(A.h!=0)return!1;for(let I=0;I<A.g.length;I++)if(A.g[I]!=0)return!1;return!0}function w(A){return A.h==-1}n.l=function(A){return A=T(this,A),w(A)?-1:_(A)?0:1};function S(A){const I=A.g.length,k=[];for(let z=0;z<I;z++)k[z]=~A.g[z];return new o(k,~A.h).add(m)}n.abs=function(){return w(this)?S(this):this},n.add=function(A){const I=Math.max(this.g.length,A.g.length),k=[];let z=0;for(let V=0;V<=I;V++){let B=z+(this.i(V)&65535)+(A.i(V)&65535),j=(B>>>16)+(this.i(V)>>>16)+(A.i(V)>>>16);z=j>>>16,B&=65535,j&=65535,k[V]=j<<16|B}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(A,I){return A.add(S(I))}n.j=function(A){if(_(this)||_(A))return p;if(w(this))return w(A)?S(this).j(S(A)):S(S(this).j(A));if(w(A))return S(this.j(S(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const I=this.g.length+A.g.length,k=[];for(var z=0;z<2*I;z++)k[z]=0;for(z=0;z<this.g.length;z++)for(let V=0;V<A.g.length;V++){const B=this.i(z)>>>16,j=this.i(z)&65535,X=A.i(V)>>>16,H=A.i(V)&65535;k[2*z+2*V]+=j*H,C(k,2*z+2*V),k[2*z+2*V+1]+=B*H,C(k,2*z+2*V+1),k[2*z+2*V+1]+=j*X,C(k,2*z+2*V+1),k[2*z+2*V+2]+=B*X,C(k,2*z+2*V+2)}for(A=0;A<I;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=I;A<2*I;A++)k[A]=0;return new o(k,0)};function C(A,I){for(;(A[I]&65535)!=A[I];)A[I+1]+=A[I]>>>16,A[I]&=65535,I++}function R(A,I){this.g=A,this.h=I}function O(A,I){if(_(I))throw Error("division by zero");if(_(A))return new R(p,p);if(w(A))return I=O(S(A),I),new R(S(I.g),S(I.h));if(w(I))return I=O(A,S(I)),new R(S(I.g),I.h);if(A.g.length>30){if(w(A)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var k=m,z=I;z.l(A)<=0;)k=P(k),z=P(z);var V=M(k,1),B=M(z,1);for(z=M(z,2),k=M(k,2);!_(z);){var j=B.add(z);j.l(A)<=0&&(V=V.add(k),B=j),z=M(z,1),k=M(k,1)}return I=T(A,V.j(I)),new R(V,I)}for(V=p;A.l(I)>=0;){for(k=Math.max(1,Math.floor(A.m()/I.m())),z=Math.ceil(Math.log(k)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),B=d(k),j=B.j(I);w(j)||j.l(A)>0;)k-=z,B=d(k),j=B.j(I);_(B)&&(B=m),V=V.add(B),A=T(A,j)}return new R(V,A)}n.B=function(A){return O(this,A).h},n.and=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)&A.i(z);return new o(k,this.h&A.h)},n.or=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)|A.i(z);return new o(k,this.h|A.h)},n.xor=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)^A.i(z);return new o(k,this.h^A.h)};function P(A){const I=A.g.length+1,k=[];for(let z=0;z<I;z++)k[z]=A.i(z)<<1|A.i(z-1)>>>31;return new o(k,A.h)}function M(A,I){const k=I>>5;I%=32;const z=A.g.length-k,V=[];for(let B=0;B<z;B++)V[B]=I>0?A.i(B+k)>>>I|A.i(B+k+1)<<32-I:A.i(B+k);return new o(V,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,CM=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,$o=o}).apply(typeof gI<"u"?gI:typeof self<"u"?self:typeof window<"u"?window:{});var Cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var IM,ah,RM,a0,B1,DM,kM,NM;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cm=="object"&&Cm];for(var D=0;D<y.length;++D){var L=y[D];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var r=t(this);function i(y,D){if(D)e:{var L=r;y=y.split(".");for(var q=0;q<y.length-1;q++){var oe=y[q];if(!(oe in L))break e;L=L[oe]}y=y[y.length-1],q=L[y],D=D(q),D!=q&&D!=null&&e(L,y,{configurable:!0,writable:!0,value:D})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(D){var L=[],q;for(q in D)Object.prototype.hasOwnProperty.call(D,q)&&L.push([q,D[q]]);return L}});var a=a||{},o=this||self;function c(y){var D=typeof y;return D=="object"&&y!=null||D=="function"}function u(y,D,L){return y.call.apply(y.bind,arguments)}function d(y,D,L){return d=u,d.apply(null,arguments)}function h(y,D){var L=Array.prototype.slice.call(arguments,1);return function(){var q=L.slice();return q.push.apply(q,arguments),y.apply(this,q)}}function p(y,D){function L(){}L.prototype=D.prototype,y.Z=D.prototype,y.prototype=new L,y.prototype.constructor=y,y.Ob=function(q,oe,pe){for(var De=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)De[ct-2]=arguments[ct];return D.prototype[oe].apply(q,De)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const D=y.length;if(D>0){const L=Array(D);for(let q=0;q<D;q++)L[q]=y[q];return L}return[]}function _(y,D){for(let q=1;q<arguments.length;q++){const oe=arguments[q];var L=typeof oe;if(L=L!="object"?L:oe?Array.isArray(oe)?"array":L:"null",L=="array"||L=="object"&&typeof oe.length=="number"){L=y.length||0;const pe=oe.length||0;y.length=L+pe;for(let De=0;De<pe;De++)y[L+De]=oe[De]}else y.push(oe)}}class w{constructor(D,L){this.i=D,this.j=L,this.h=0,this.g=null}get(){let D;return this.h>0?(this.h--,D=this.g,this.g=D.next,D.next=null):D=this.i(),D}}function S(y){o.setTimeout(()=>{throw y},0)}function T(){var y=A;let D=null;return y.g&&(D=y.g,y.g=y.g.next,y.g||(y.h=null),D.next=null),D}class C{constructor(){this.h=this.g=null}add(D,L){const q=R.get();q.set(D,L),this.h?this.h.next=q:this.g=q,this.h=q}}var R=new w(()=>new O,y=>y.reset());class O{constructor(){this.next=this.g=this.h=null}set(D,L){this.h=D,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let P,M=!1,A=new C,I=()=>{const y=Promise.resolve(void 0);P=()=>{y.then(k)}};function k(){for(var y;y=T();){try{y.h.call(y.g)}catch(L){S(L)}var D=R;D.j(y),D.h<100&&(D.h++,y.next=D.g,D.g=y)}M=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(y,D){this.type=y,this.g=this.target=D,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,D=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const L=()=>{};o.addEventListener("test",L,D),o.removeEventListener("test",L,D)}catch{}return y})();function j(y){return/^[\s\xa0]*$/.test(y)}function X(y,D){V.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,D)}p(X,V),X.prototype.init=function(y,D){const L=this.type=y.type,q=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=D,D=y.relatedTarget,D||(L=="mouseover"?D=y.fromElement:L=="mouseout"&&(D=y.toElement)),this.relatedTarget=D,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&X.Z.h.call(this)},X.prototype.h=function(){X.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var H="closure_listenable_"+(Math.random()*1e6|0),$=0;function W(y,D,L,q,oe){this.listener=y,this.proxy=null,this.src=D,this.type=L,this.capture=!!q,this.ha=oe,this.key=++$,this.da=this.fa=!1}function ee(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function he(y,D,L){for(const q in y)D.call(L,y[q],q,y)}function K(y,D){for(const L in y)D.call(void 0,y[L],L,y)}function G(y){const D={};for(const L in y)D[L]=y[L];return D}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function re(y,D){let L,q;for(let oe=1;oe<arguments.length;oe++){q=arguments[oe];for(L in q)y[L]=q[L];for(let pe=0;pe<Y.length;pe++)L=Y[pe],Object.prototype.hasOwnProperty.call(q,L)&&(y[L]=q[L])}}function Z(y){this.src=y,this.g={},this.h=0}Z.prototype.add=function(y,D,L,q,oe){const pe=y.toString();y=this.g[pe],y||(y=this.g[pe]=[],this.h++);const De=fe(y,D,q,oe);return De>-1?(D=y[De],L||(D.fa=!1)):(D=new W(D,this.src,pe,!!q,oe),D.fa=L,y.push(D)),D};function le(y,D){const L=D.type;if(L in y.g){var q=y.g[L],oe=Array.prototype.indexOf.call(q,D,void 0),pe;(pe=oe>=0)&&Array.prototype.splice.call(q,oe,1),pe&&(ee(D),y.g[L].length==0&&(delete y.g[L],y.h--))}}function fe(y,D,L,q){for(let oe=0;oe<y.length;++oe){const pe=y[oe];if(!pe.da&&pe.listener==D&&pe.capture==!!L&&pe.ha==q)return oe}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),ve={};function Ce(y,D,L,q,oe){if(Array.isArray(D)){for(let pe=0;pe<D.length;pe++)Ce(y,D[pe],L,q,oe);return null}return L=ze(L),y&&y[H]?y.J(D,L,c(q)?!!q.capture:!1,oe):Ge(y,D,L,!1,q,oe)}function Ge(y,D,L,q,oe,pe){if(!D)throw Error("Invalid event type");const De=c(oe)?!!oe.capture:!!oe;let ct=Ue(y);if(ct||(y[xe]=ct=new Z(y)),L=ct.add(D,L,q,De,pe),L.proxy)return L;if(q=ae(),L.proxy=q,q.src=y,q.listener=L,y.addEventListener)B||(oe=De),oe===void 0&&(oe=!1),y.addEventListener(D.toString(),q,oe);else if(y.attachEvent)y.attachEvent(Oe(D.toString()),q);else if(y.addListener&&y.removeListener)y.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return L}function ae(){function y(L){return D.call(y.src,y.listener,L)}const D=qe;return y}function Te(y,D,L,q,oe){if(Array.isArray(D))for(var pe=0;pe<D.length;pe++)Te(y,D[pe],L,q,oe);else q=c(q)?!!q.capture:!!q,L=ze(L),y&&y[H]?(y=y.i,pe=String(D).toString(),pe in y.g&&(D=y.g[pe],L=fe(D,L,q,oe),L>-1&&(ee(D[L]),Array.prototype.splice.call(D,L,1),D.length==0&&(delete y.g[pe],y.h--)))):y&&(y=Ue(y))&&(D=y.g[D.toString()],y=-1,D&&(y=fe(D,L,q,oe)),(L=y>-1?D[y]:null)&&Pe(L))}function Pe(y){if(typeof y!="number"&&y&&!y.da){var D=y.src;if(D&&D[H])le(D.i,y);else{var L=y.type,q=y.proxy;D.removeEventListener?D.removeEventListener(L,q,y.capture):D.detachEvent?D.detachEvent(Oe(L),q):D.addListener&&D.removeListener&&D.removeListener(q),(L=Ue(D))?(le(L,y),L.h==0&&(L.src=null,D[xe]=null)):ee(y)}}}function Oe(y){return y in ve?ve[y]:ve[y]="on"+y}function qe(y,D){if(y.da)y=!0;else{D=new X(D,this);const L=y.listener,q=y.ha||y.src;y.fa&&Pe(y),y=L.call(q,D)}return y}function Ue(y){return y=y[xe],y instanceof Z?y:null}var Se="__closure_events_fn_"+(Math.random()*1e9>>>0);function ze(y){return typeof y=="function"?y:(y[Se]||(y[Se]=function(D){return y.handleEvent(D)}),y[Se])}function Ne(){z.call(this),this.i=new Z(this),this.M=this,this.G=null}p(Ne,z),Ne.prototype[H]=!0,Ne.prototype.removeEventListener=function(y,D,L,q){Te(this,y,D,L,q)};function Le(y,D){var L,q=y.G;if(q)for(L=[];q;q=q.G)L.push(q);if(y=y.M,q=D.type||D,typeof D=="string")D=new V(D,y);else if(D instanceof V)D.target=D.target||y;else{var oe=D;D=new V(q,y),re(D,oe)}oe=!0;let pe,De;if(L)for(De=L.length-1;De>=0;De--)pe=D.g=L[De],oe=lt(pe,q,!0,D)&&oe;if(pe=D.g=y,oe=lt(pe,q,!0,D)&&oe,oe=lt(pe,q,!1,D)&&oe,L)for(De=0;De<L.length;De++)pe=D.g=L[De],oe=lt(pe,q,!1,D)&&oe}Ne.prototype.N=function(){if(Ne.Z.N.call(this),this.i){var y=this.i;for(const D in y.g){const L=y.g[D];for(let q=0;q<L.length;q++)ee(L[q]);delete y.g[D],y.h--}}this.G=null},Ne.prototype.J=function(y,D,L,q){return this.i.add(String(y),D,!1,L,q)},Ne.prototype.K=function(y,D,L,q){return this.i.add(String(y),D,!0,L,q)};function lt(y,D,L,q){if(D=y.i.g[String(D)],!D)return!0;D=D.concat();let oe=!0;for(let pe=0;pe<D.length;++pe){const De=D[pe];if(De&&!De.da&&De.capture==L){const ct=De.listener,_n=De.ha||De.src;De.fa&&le(y.i,De),oe=ct.call(_n,q)!==!1&&oe}}return oe&&!q.defaultPrevented}function Ct(y,D){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(D)>2147483647?-1:o.setTimeout(y,D||0)}function et(y){y.g=Ct(()=>{y.g=null,y.i&&(y.i=!1,et(y))},y.l);const D=y.h;y.h=null,y.m.apply(null,D)}class ft extends z{constructor(D,L){super(),this.m=D,this.l=L,this.h=null,this.i=!1,this.g=null}j(D){this.h=arguments,this.g?this.i=!0:et(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kt(y){z.call(this),this.h=y,this.g={}}p(kt,z);var pn=[];function Ut(y){he(y.g,function(D,L){this.g.hasOwnProperty(L)&&Pe(D)},y),y.g={}}kt.prototype.N=function(){kt.Z.N.call(this),Ut(this)},kt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cn=o.JSON.stringify,Hr=o.JSON.parse,fa=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Ja(){}function Gs(){}var Yr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function In(){V.call(this,"d")}p(In,V);function dr(){V.call(this,"c")}p(dr,V);var on={},Lc=null;function qs(){return Lc=Lc||new Ne}on.Ia="serverreachability";function $s(y){V.call(this,on.Ia,y)}p($s,V);function mt(y){const D=qs();Le(D,new $s(D))}on.STAT_EVENT="statevent";function ln(y,D){V.call(this,on.STAT_EVENT,y),this.stat=D}p(ln,V);function cn(y){const D=qs();Le(D,new ln(D,y))}on.Ja="timingevent";function Kr(y,D){V.call(this,on.Ja,y),this.size=D}p(Kr,V);function ui(y,D){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},D)}function _r(){this.g=!0}_r.prototype.ua=function(){this.g=!1};function wy(y,D,L,q,oe,pe){y.info(function(){if(y.g)if(pe){var De="",ct=pe.split("&");for(let Nt=0;Nt<ct.length;Nt++){var _n=ct[Nt].split("=");if(_n.length>1){const en=_n[0];_n=_n[1];const pi=en.split("_");De=pi.length>=2&&pi[1]=="type"?De+(en+"="+_n+"&"):De+(en+"=redacted&")}}}else De=null;else De=pe;return"XMLHTTP REQ ("+q+") [attempt "+oe+"]: "+D+`
`+L+`
`+De})}function tg(y,D,L,q,oe,pe,De){y.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+oe+"]: "+D+`
`+L+`
`+pe+" "+De})}function ha(y,D,L,q){y.info(function(){return"XMLHTTP TEXT ("+D+"): "+Ey(y,L)+(q?" "+q:"")})}function hl(y,D){y.info(function(){return"TIMEOUT: "+D})}_r.prototype.info=function(){};function Ey(y,D){if(!y.g)return D;if(!D)return null;try{const pe=JSON.parse(D);if(pe){for(y=0;y<pe.length;y++)if(Array.isArray(pe[y])){var L=pe[y];if(!(L.length<2)){var q=L[1];if(Array.isArray(q)&&!(q.length<1)){var oe=q[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(let De=1;De<q.length;De++)q[De]=""}}}}return Cn(pe)}catch{return D}}var pl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Hd={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Yd;function gl(){}p(gl,Ja),gl.prototype.g=function(){return new XMLHttpRequest},Yd=new gl;function es(y){return encodeURIComponent(String(y))}function ng(y){var D=1;y=y.split(":");const L=[];for(;D>0&&y.length;)L.push(y.shift()),D--;return y.length&&L.push(y.join(":")),L}function Vi(y,D,L,q){this.j=y,this.i=D,this.l=L,this.S=q||1,this.V=new kt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zi}function zi(){this.i=null,this.g="",this.h=!1}var Rn={},Qn={};function pa(y,D,L){y.M=1,y.A=ml(kn(D)),y.u=L,y.R=!0,Bc(y,null)}function Bc(y,D){y.F=Date.now(),ga(y),y.B=kn(y.A);var L=y.B,q=y.S;Array.isArray(q)||(q=[String(q)]),qc(L.i,"t",q),y.C=0,L=y.j.L,y.h=new zi,y.g=vg(y.j,L?D:null,!y.u),y.P>0&&(y.O=new ft(d(y.Y,y,y.g),y.P)),D=y.V,L=y.g,q=y.ba;var oe="readystatechange";Array.isArray(oe)||(oe&&(pn[0]=oe.toString()),oe=pn);for(let pe=0;pe<oe.length;pe++){const De=Ce(L,oe[pe],q||D.handleEvent,!1,D.h||D);if(!De)break;D.g[De.key]=De}D=y.J?G(y.J):{},y.u?(y.v||(y.v="POST"),D["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,D)):(y.v="GET",y.g.ea(y.B,y.v,null,D)),mt(),wy(y.i,y.v,y.B,y.l,y.S,y.u)}Vi.prototype.ba=function(y){y=y.target;const D=this.O;D&&Ui(y)==3?D.j():this.Y(y)},Vi.prototype.Y=function(y){try{if(y==this.g)e:{const ct=Ui(this.g),_n=this.g.ya(),Nt=this.g.ca();if(!(ct<3)&&(ct!=3||this.g&&(this.h.h||this.g.la()||tr(this.g)))){this.K||ct!=4||_n==7||(_n==8||Nt<=0?mt(3):mt(2)),ma(this);var D=this.g.ca();this.X=D;var L=Sy(this);if(this.o=D==200,tg(this.i,this.v,this.B,this.l,this.S,ct,D),this.o){if(this.U&&!this.L){t:{if(this.g){var q,oe=this.g;if((q=oe.g?oe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(q)){var pe=q;break t}}pe=null}if(y=pe)ha(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,va(this,y);else{this.o=!1,this.m=3,cn(12),Xr(this),di(this);break e}}if(this.R){y=!0;let en;for(;!this.K&&this.C<L.length;)if(en=ig(this,L),en==Qn){ct==4&&(this.m=4,cn(14),y=!1),ha(this.i,this.l,null,"[Incomplete Response]");break}else if(en==Rn){this.m=4,cn(15),ha(this.i,this.l,L,"[Invalid Chunk]"),y=!1;break}else ha(this.i,this.l,en,null),va(this,en);if(rg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ct!=4||L.length!=0||this.h.h||(this.m=1,cn(16),y=!1),this.o=this.o&&y,!y)ha(this.i,this.l,L,"[Invalid Chunked Response]"),Xr(this),di(this);else if(L.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),cf(De),De.P=!0,cn(11))}}else ha(this.i,this.l,L,null),va(this,L);ct==4&&Xr(this),this.o&&!this.K&&(ct==4?hg(this.j,this):(this.o=!1,ga(this)))}else ns(this.g),D==400&&L.indexOf("Unknown SID")>0?(this.m=3,cn(12)):(this.m=0,cn(13)),Xr(this),di(this)}}}catch{}finally{}};function Sy(y){if(!rg(y))return y.g.la();const D=tr(y.g);if(D==="")return"";let L="";const q=D.length,oe=Ui(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return Xr(y),di(y),"";y.h.i=new o.TextDecoder}for(let pe=0;pe<q;pe++)y.h.h=!0,L+=y.h.i.decode(D[pe],{stream:!(oe&&pe==q-1)});return D.length=0,y.h.g+=L,y.C=0,y.h.g}function rg(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function ig(y,D){var L=y.C,q=D.indexOf(`
`,L);return q==-1?Qn:(L=Number(D.substring(L,q)),isNaN(L)?Rn:(q+=1,q+L>D.length?Qn:(D=D.slice(q,q+L),y.C=q+L,D)))}Vi.prototype.cancel=function(){this.K=!0,Xr(this)};function ga(y){y.T=Date.now()+y.H,Uc(y,y.H)}function Uc(y,D){if(y.D!=null)throw Error("WatchDog timer not null");y.D=ui(d(y.aa,y),D)}function ma(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Vi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(hl(this.i,this.B),this.M!=2&&(mt(),cn(17)),Xr(this),this.m=2,di(this)):Uc(this,this.T-y)};function di(y){y.j.I==0||y.K||hg(y.j,y)}function Xr(y){ma(y);var D=y.O;D&&typeof D.dispose=="function"&&D.dispose(),y.O=null,Ut(y.V),y.g&&(D=y.g,y.g=null,D.abort(),D.dispose())}function va(y,D){try{var L=y.j;if(L.I!=0&&(L.g==y||ba(L.h,y))){if(!y.L&&ba(L.h,y)&&L.I==3){try{var q=L.Ba.g.parse(D)}catch{q=null}if(Array.isArray(q)&&q.length==3){var oe=q;if(oe[0]==0){e:if(!L.v){if(L.g)if(L.g.F+3e3<y.F)Xc(L),Js(L);else break e;El(L),cn(18)}}else L.xa=oe[1],0<L.xa-L.K&&oe[2]<37500&&L.F&&L.A==0&&!L.C&&(L.C=ui(d(L.Va,L),6e3));ya(L.h)<=1&&L.ta&&(L.ta=void 0)}else Ta(L,11)}else if((y.L||L.g==y)&&Xc(L),!j(D))for(oe=L.Ba.g.parse(D),D=0;D<oe.length;D++){let Nt=oe[D];const en=Nt[0];if(!(en<=L.K))if(L.K=en,Nt=Nt[1],L.I==2)if(Nt[0]=="c"){L.M=Nt[1],L.ba=Nt[2];const pi=Nt[3];pi!=null&&(L.ka=pi,L.j.info("VER="+L.ka));const Aa=Nt[4];Aa!=null&&(L.za=Aa,L.j.info("SVER="+L.za));const Fi=Nt[5];Fi!=null&&typeof Fi=="number"&&Fi>0&&(q=1.5*Fi,L.O=q,L.j.info("backChannelRequestTimeoutMs_="+q)),q=L;const Gi=y.g;if(Gi){const Sl=Gi.g?Gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sl){var pe=q.h;pe.g||Sl.indexOf("spdy")==-1&&Sl.indexOf("quic")==-1&&Sl.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Wd(pe,pe.h),pe.h=null))}if(q.G){const Wc=Gi.g?Gi.g.getResponseHeader("X-HTTP-Session-Id"):null;Wc&&(q.wa=Wc,Ot(q.J,q.G,Wc))}}L.I=3,L.l&&L.l.ra(),L.aa&&(L.T=Date.now()-y.F,L.j.info("Handshake RTT: "+L.T+"ms")),q=L;var De=y;if(q.na=mg(q,q.L?q.ba:null,q.W),De.L){Qd(q.h,De);var ct=De,_n=q.O;_n&&(ct.H=_n),ct.D&&(ma(ct),ga(ct)),q.g=De}else dg(q);L.i.length>0&&Sa(L)}else Nt[0]!="stop"&&Nt[0]!="close"||Ta(L,7);else L.I==3&&(Nt[0]=="stop"||Nt[0]=="close"?Nt[0]=="stop"?Ta(L,7):of(L):Nt[0]!="noop"&&L.l&&L.l.qa(Nt),L.A=0)}}mt(4)}catch{}}var Dn=class{constructor(y,D){this.g=y,this.map=D}};function Kd(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xd(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ya(y){return y.h?1:y.g?y.g.size:0}function ba(y,D){return y.h?y.h==D:y.g?y.g.has(D):!1}function Wd(y,D){y.g?y.g.add(D):y.h=D}function Qd(y,D){y.h&&y.h==D?y.h=null:y.g&&y.g.has(D)&&y.g.delete(D)}Kd.prototype.cancel=function(){if(this.i=Zd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Zd(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let D=y.i;for(const L of y.g.values())D=D.concat(L.G);return D}return b(y.i)}var ag=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fc(y,D){if(y){y=y.split("&");for(let L=0;L<y.length;L++){const q=y[L].indexOf("=");let oe,pe=null;q>=0?(oe=y[L].substring(0,q),pe=y[L].substring(q+1)):oe=y[L],D(oe,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function Wr(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let D;y instanceof Wr?(this.l=y.l,Zn(this,y.j),this.o=y.o,this.g=y.g,Hs(this,y.u),this.h=y.h,Jd(this,cg(y.i)),this.m=y.m):y&&(D=String(y).match(ag))?(this.l=!1,Zn(this,D[1]||"",!0),this.o=xa(D[2]||""),this.g=xa(D[3]||"",!0),Hs(this,D[4]),this.h=xa(D[5]||"",!0),Jd(this,D[6]||"",!0),this.m=xa(D[7]||"")):(this.l=!1,this.i=new Ks(null,this.l))}Wr.prototype.toString=function(){const y=[];var D=this.j;D&&y.push(vl(D,Gc,!0),":");var L=this.g;return(L||D=="file")&&(y.push("//"),(D=this.o)&&y.push(vl(D,Gc,!0),"@"),y.push(es(L).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.u,L!=null&&y.push(":",String(L))),(L=this.h)&&(this.g&&L.charAt(0)!="/"&&y.push("/"),y.push(vl(L,L.charAt(0)=="/"?ef:sg,!0))),(L=this.i.toString())&&y.push("?",L),(L=this.m)&&y.push("#",vl(L,og)),y.join("")},Wr.prototype.resolve=function(y){const D=kn(this);let L=!!y.j;L?Zn(D,y.j):L=!!y.o,L?D.o=y.o:L=!!y.g,L?D.g=y.g:L=y.u!=null;var q=y.h;if(L)Hs(D,y.u);else if(L=!!y.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var oe=D.h.lastIndexOf("/");oe!=-1&&(q=D.h.slice(0,oe+1)+q)}if(oe=q,oe==".."||oe==".")q="";else if(oe.indexOf("./")!=-1||oe.indexOf("/.")!=-1){q=oe.lastIndexOf("/",0)==0,oe=oe.split("/");const pe=[];for(let De=0;De<oe.length;){const ct=oe[De++];ct=="."?q&&De==oe.length&&pe.push(""):ct==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),q&&De==oe.length&&pe.push("")):(pe.push(ct),q=!0)}q=pe.join("/")}else q=oe}return L?D.h=q:L=y.i.toString()!=="",L?Jd(D,cg(y.i)):L=!!y.m,L&&(D.m=y.m),D};function kn(y){return new Wr(y)}function Zn(y,D,L){y.j=L?xa(D,!0):D,y.j&&(y.j=y.j.replace(/:$/,""))}function Hs(y,D){if(D){if(D=Number(D),isNaN(D)||D<0)throw Error("Bad port number "+D);y.u=D}else y.u=null}function Jd(y,D,L){D instanceof Ks?(y.i=D,$c(y.i,y.l)):(L||(D=vl(D,Ys)),y.i=new Ks(D,y.l))}function Ot(y,D,L){y.i.set(D,L)}function ml(y){return Ot(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function xa(y,D){return y?D?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function vl(y,D,L){return typeof y=="string"?(y=encodeURI(y).replace(D,Nr),L&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Nr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Gc=/[#\/\?@]/g,sg=/[#\?:]/g,ef=/[#\?]/g,Ys=/[#\?@]/g,og=/#/g;function Ks(y,D){this.h=this.g=null,this.i=y||null,this.j=!!D}function Mr(y){y.g||(y.g=new Map,y.h=0,y.i&&Fc(y.i,function(D,L){y.add(decodeURIComponent(D.replace(/\+/g," ")),L)}))}n=Ks.prototype,n.add=function(y,D){Mr(this),this.i=null,y=Xs(this,y);let L=this.g.get(y);return L||this.g.set(y,L=[]),L.push(D),this.h+=1,this};function lg(y,D){Mr(y),D=Xs(y,D),y.g.has(D)&&(y.i=null,y.h-=y.g.get(D).length,y.g.delete(D))}function tf(y,D){return Mr(y),D=Xs(y,D),y.g.has(D)}n.forEach=function(y,D){Mr(this),this.g.forEach(function(L,q){L.forEach(function(oe){y.call(D,oe,q,this)},this)},this)};function nf(y,D){Mr(y);let L=[];if(typeof D=="string")tf(y,D)&&(L=L.concat(y.g.get(Xs(y,D))));else for(y=Array.from(y.g.values()),D=0;D<y.length;D++)L=L.concat(y[D]);return L}n.set=function(y,D){return Mr(this),this.i=null,y=Xs(this,y),tf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[D]),this.h+=1,this},n.get=function(y,D){return y?(y=nf(this,y),y.length>0?String(y[0]):D):D};function qc(y,D,L){lg(y,D),L.length>0&&(y.i=null,y.g.set(Xs(y,D),b(L)),y.h+=L.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],D=Array.from(this.g.keys());for(let q=0;q<D.length;q++){var L=D[q];const oe=es(L);L=nf(this,L);for(let pe=0;pe<L.length;pe++){let De=oe;L[pe]!==""&&(De+="="+es(L[pe])),y.push(De)}}return this.i=y.join("&")};function cg(y){const D=new Ks;return D.i=y.i,y.g&&(D.g=new Map(y.g),D.h=y.h),D}function Xs(y,D){return D=String(D),y.j&&(D=D.toLowerCase()),D}function $c(y,D){D&&!y.j&&(Mr(y),y.i=null,y.g.forEach(function(L,q){const oe=q.toLowerCase();q!=oe&&(lg(this,q),qc(this,oe,L))},y)),y.j=D}function Li(y,D){const L=new _r;if(o.Image){const q=new Image;q.onload=h(fi,L,"TestLoadImage: loaded",!0,D,q),q.onerror=h(fi,L,"TestLoadImage: error",!1,D,q),q.onabort=h(fi,L,"TestLoadImage: abort",!1,D,q),q.ontimeout=h(fi,L,"TestLoadImage: timeout",!1,D,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=y}else D(!1)}function rf(y,D){const L=new _r,q=new AbortController,oe=setTimeout(()=>{q.abort(),fi(L,"TestPingServer: timeout",!1,D)},1e4);fetch(y,{signal:q.signal}).then(pe=>{clearTimeout(oe),pe.ok?fi(L,"TestPingServer: ok",!0,D):fi(L,"TestPingServer: server error",!1,D)}).catch(()=>{clearTimeout(oe),fi(L,"TestPingServer: error",!1,D)})}function fi(y,D,L,q,oe){try{oe&&(oe.onload=null,oe.onerror=null,oe.onabort=null,oe.ontimeout=null),q(L)}catch{}}function Ws(){this.g=new fa}function _a(y){this.i=y.Sb||null,this.h=y.ab||!1}p(_a,Ja),_a.prototype.g=function(){return new yl(this.i,this.h)};function yl(y,D){Ne.call(this),this.H=y,this.o=D,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(yl,Ne),n=yl.prototype,n.open=function(y,D){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=D,this.readyState=1,Bi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const D={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(D.body=y),(this.H||o).fetch(new Request(this.D,D)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Qs(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Bi(this)),this.g&&(this.readyState=3,Bi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Hc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Hc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var D=y.value?y.value:new Uint8Array(0);(D=this.B.decode(D,{stream:!y.done}))&&(this.response=this.responseText+=D)}y.done?Qs(this):Bi(this),this.readyState==3&&Hc(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Qs(this))},n.Na=function(y){this.g&&(this.response=y,Qs(this))},n.ga=function(){this.g&&Qs(this)};function Qs(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Bi(y)}n.setRequestHeader=function(y,D){this.A.append(y,D)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],D=this.h.entries();for(var L=D.next();!L.done;)L=L.value,y.push(L[0]+": "+L[1]),L=D.next();return y.join(`\r
`)};function Bi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(yl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function hi(y){let D="";return he(y,function(L,q){D+=q,D+=":",D+=L,D+=`\r
`}),D}function bl(y,D,L){e:{for(q in L){var q=!1;break e}q=!0}q||(L=hi(L),typeof y=="string"?L!=null&&es(L):Ot(y,D,L))}function Ft(y){Ne.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ft,Ne);var wa=/^https?$/i,af=["POST","PUT"];n=Ft.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,D,L,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);D=D?D.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Yd.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(D,String(y),!0),this.B=!1}catch(pe){xl(this,pe);return}if(y=L||"",L=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var oe in q)L.set(oe,q[oe]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const pe of q.keys())L.set(pe,q.get(pe));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(L.keys()).find(pe=>pe.toLowerCase()=="content-type"),oe=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(af,D,void 0)>=0)||q||oe||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,De]of L)this.g.setRequestHeader(pe,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(pe){xl(this,pe)}};function xl(y,D){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=D,y.o=5,sf(y),ts(y)}function sf(y){y.A||(y.A=!0,Le(y,"complete"),Le(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Le(this,"complete"),Le(this,"abort"),ts(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ts(this,!0)),Ft.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?_l(this):this.Xa())},n.Xa=function(){_l(this)};function _l(y){if(y.h&&typeof a<"u"){if(y.v&&Ui(y)==4)setTimeout(y.Ca.bind(y),0);else if(Le(y,"readystatechange"),Ui(y)==4){y.h=!1;try{const pe=y.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var D=!0;break e;default:D=!1}var L;if(!(L=D)){var q;if(q=pe===0){let De=String(y.D).match(ag)[1]||null;!De&&o.self&&o.self.location&&(De=o.self.location.protocol.slice(0,-1)),q=!wa.test(De?De.toLowerCase():"")}L=q}if(L)Le(y,"complete"),Le(y,"success");else{y.o=6;try{var oe=Ui(y)>2?y.g.statusText:""}catch{oe=""}y.l=oe+" ["+y.ca()+"]",sf(y)}}finally{ts(y)}}}}function ts(y,D){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const L=y.g;y.g=null,D||Le(y,"ready");try{L.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ui(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Ui(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var D=this.g.responseText;return y&&D.indexOf(y)==0&&(D=D.substring(y.length)),Hr(D)}};function tr(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function ns(y){const D={};y=(y.g&&Ui(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<y.length;q++){if(j(y[q]))continue;var L=ng(y[q]);const oe=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const pe=D[oe]||[];D[oe]=pe,pe.push(L)}K(D,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ea(y,D,L){return L&&L.internalChannelParams&&L.internalChannelParams[y]||D}function Zs(y){this.za=0,this.i=[],this.j=new _r,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ea("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ea("baseRetryDelayMs",5e3,y),this.Za=Ea("retryDelaySeedMs",1e4,y),this.Ta=Ea("forwardChannelMaxRetries",2,y),this.va=Ea("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Kd(y&&y.concurrentRequestLimit),this.Ba=new Ws,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Zs.prototype,n.ka=8,n.I=1,n.connect=function(y,D,L,q){cn(0),this.W=y,this.H=D||{},L&&q!==void 0&&(this.H.OSID=L,this.H.OAID=q),this.F=this.X,this.J=mg(this,null,this.W),Sa(this)};function of(y){if(Yc(y),y.I==3){var D=y.V++,L=kn(y.J);if(Ot(L,"SID",y.M),Ot(L,"RID",D),Ot(L,"TYPE","terminate"),wl(y,L),D=new Vi(y,y.j,D),D.M=2,D.A=ml(kn(L)),L=!1,o.navigator&&o.navigator.sendBeacon)try{L=o.navigator.sendBeacon(D.A.toString(),"")}catch{}!L&&o.Image&&(new Image().src=D.A,L=!0),L||(D.g=vg(D.j,null),D.g.ea(D.A)),D.F=Date.now(),ga(D)}gg(y)}function Js(y){y.g&&(cf(y),y.g.cancel(),y.g=null)}function Yc(y){Js(y),y.v&&(o.clearTimeout(y.v),y.v=null),Xc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function Sa(y){if(!Xd(y.h)&&!y.m){y.m=!0;var D=y.Ea;P||I(),M||(P(),M=!0),A.add(D,y),y.D=0}}function Kc(y,D){return ya(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=D.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=ui(d(y.Ea,y,D),pg(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const oe=new Vi(this,this.j,y);let pe=this.o;if(this.U&&(pe?(pe=G(pe),re(pe,this.U)):pe=this.U),this.u!==null||this.R||(oe.J=pe,pe=null),this.S)e:{for(var D=0,L=0;L<this.i.length;L++){t:{var q=this.i[L];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(D+=q,D>4096){D=L;break e}if(D===4096||L===this.i.length-1){D=L+1;break e}}D=1e3}else D=1e3;D=ug(this,oe,D),L=kn(this.J),Ot(L,"RID",y),Ot(L,"CVER",22),this.G&&Ot(L,"X-HTTP-Session-Id",this.G),wl(this,L),pe&&(this.R?D="headers="+es(hi(pe))+"&"+D:this.u&&bl(L,this.u,pe)),Wd(this.h,oe),this.Ra&&Ot(L,"TYPE","init"),this.S?(Ot(L,"$req",D),Ot(L,"SID","null"),oe.U=!0,pa(oe,L,null)):pa(oe,L,D),this.I=2}}else this.I==3&&(y?lf(this,y):this.i.length==0||Xd(this.h)||lf(this))};function lf(y,D){var L;D?L=D.l:L=y.V++;const q=kn(y.J);Ot(q,"SID",y.M),Ot(q,"RID",L),Ot(q,"AID",y.K),wl(y,q),y.u&&y.o&&bl(q,y.u,y.o),L=new Vi(y,y.j,L,y.D+1),y.u===null&&(L.J=y.o),D&&(y.i=D.G.concat(y.i)),D=ug(y,L,1e3),L.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Wd(y.h,L),pa(L,q,D)}function wl(y,D){y.H&&he(y.H,function(L,q){Ot(D,q,L)}),y.l&&he({},function(L,q){Ot(D,q,L)})}function ug(y,D,L){L=Math.min(y.i.length,L);const q=y.l?d(y.l.Ka,y.l,y):null;e:{var oe=y.i;let ct=-1;for(;;){const _n=["count="+L];ct==-1?L>0?(ct=oe[0].g,_n.push("ofs="+ct)):ct=0:_n.push("ofs="+ct);let Nt=!0;for(let en=0;en<L;en++){var pe=oe[en].g;const pi=oe[en].map;if(pe-=ct,pe<0)ct=Math.max(0,oe[en].g-100),Nt=!1;else try{pe="req"+pe+"_"||"";try{var De=pi instanceof Map?pi:Object.entries(pi);for(const[Aa,Fi]of De){let Gi=Fi;c(Fi)&&(Gi=Cn(Fi)),_n.push(pe+Aa+"="+encodeURIComponent(Gi))}}catch(Aa){throw _n.push(pe+"type="+encodeURIComponent("_badmap")),Aa}}catch{q&&q(pi)}}if(Nt){De=_n.join("&");break e}}De=void 0}return y=y.i.splice(0,L),D.G=y,De}function dg(y){if(!y.g&&!y.v){y.Y=1;var D=y.Da;P||I(),M||(P(),M=!0),A.add(D,y),y.A=0}}function El(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=ui(d(y.Da,y),pg(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,fg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=ui(d(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,cn(10),Js(this),fg(this))};function cf(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function fg(y){y.g=new Vi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var D=kn(y.na);Ot(D,"RID","rpc"),Ot(D,"SID",y.M),Ot(D,"AID",y.K),Ot(D,"CI",y.F?"0":"1"),!y.F&&y.ia&&Ot(D,"TO",y.ia),Ot(D,"TYPE","xmlhttp"),wl(y,D),y.u&&y.o&&bl(D,y.u,y.o),y.O&&(y.g.H=y.O);var L=y.g;y=y.ba,L.M=1,L.A=ml(kn(D)),L.u=null,L.R=!0,Bc(L,y)}n.Va=function(){this.C!=null&&(this.C=null,Js(this),El(this),cn(19))};function Xc(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function hg(y,D){var L=null;if(y.g==D){Xc(y),cf(y),y.g=null;var q=2}else if(ba(y.h,D))L=D.G,Qd(y.h,D),q=1;else return;if(y.I!=0){if(D.o)if(q==1){L=D.u?D.u.length:0,D=Date.now()-D.F;var oe=y.D;q=qs(),Le(q,new Kr(q,L)),Sa(y)}else dg(y);else if(oe=D.m,oe==3||oe==0&&D.X>0||!(q==1&&Kc(y,D)||q==2&&El(y)))switch(L&&L.length>0&&(D=y.h,D.i=D.i.concat(L)),oe){case 1:Ta(y,5);break;case 4:Ta(y,10);break;case 3:Ta(y,6);break;default:Ta(y,2)}}}function pg(y,D){let L=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(L*=2),L*D}function Ta(y,D){if(y.j.info("Error code "+D),D==2){var L=d(y.bb,y),q=y.Ua;const oe=!q;q=new Wr(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Zn(q,"https"),ml(q),oe?Li(q.toString(),L):rf(q.toString(),L)}else cn(2);y.I=0,y.l&&y.l.pa(D),gg(y),Yc(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),cn(2)):(this.j.info("Failed to ping google.com"),cn(1))};function gg(y){if(y.I=0,y.ja=[],y.l){const D=Zd(y.h);(D.length!=0||y.i.length!=0)&&(_(y.ja,D),_(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function mg(y,D,L){var q=L instanceof Wr?kn(L):new Wr(L);if(q.g!="")D&&(q.g=D+"."+q.g),Hs(q,q.u);else{var oe=o.location;q=oe.protocol,D=D?D+"."+oe.hostname:oe.hostname,oe=+oe.port;const pe=new Wr(null);q&&Zn(pe,q),D&&(pe.g=D),oe&&Hs(pe,oe),L&&(pe.h=L),q=pe}return L=y.G,D=y.wa,L&&D&&Ot(q,L,D),Ot(q,"VER",y.ka),wl(y,q),q}function vg(y,D,L){if(D&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return D=y.Aa&&!y.ma?new Ft(new _a({ab:L})):new Ft(y.ma),D.Fa(y.L),D}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function yg(){}n=yg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function eo(){}eo.prototype.g=function(y,D){return new wr(y,D)};function wr(y,D){Ne.call(this),this.g=new Zs(D),this.l=y,this.h=D&&D.messageUrlParams||null,y=D&&D.messageHeaders||null,D&&D.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=D&&D.initMessageHeaders||null,D&&D.messageContentType&&(y?y["X-WebChannel-Content-Type"]=D.messageContentType:y={"X-WebChannel-Content-Type":D.messageContentType}),D&&D.sa&&(y?y["X-WebChannel-Client-Profile"]=D.sa:y={"X-WebChannel-Client-Profile":D.sa}),this.g.U=y,(y=D&&D.Qb)&&!j(y)&&(this.g.u=y),this.A=D&&D.supportsCrossDomainXhr||!1,this.v=D&&D.sendRawJson||!1,(D=D&&D.httpSessionIdParam)&&!j(D)&&(this.g.G=D,y=this.h,y!==null&&D in y&&(y=this.h,D in y&&delete y[D])),this.j=new rs(this)}p(wr,Ne),wr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wr.prototype.close=function(){of(this.g)},wr.prototype.o=function(y){var D=this.g;if(typeof y=="string"){var L={};L.__data__=y,y=L}else this.v&&(L={},L.__data__=Cn(y),y=L);D.i.push(new Dn(D.Ya++,y)),D.I==3&&Sa(D)},wr.prototype.N=function(){this.g.l=null,delete this.j,of(this.g),delete this.g,wr.Z.N.call(this)};function bg(y){In.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var D=y.__sm__;if(D){e:{for(const L in D){y=L;break e}y=void 0}(this.i=y)&&(y=this.i,D=D!==null&&y in D?D[y]:void 0),this.data=D}else this.data=y}p(bg,In);function xg(){dr.call(this),this.status=1}p(xg,dr);function rs(y){this.g=y}p(rs,yg),rs.prototype.ra=function(){Le(this.g,"a")},rs.prototype.qa=function(y){Le(this.g,new bg(y))},rs.prototype.pa=function(y){Le(this.g,new xg)},rs.prototype.oa=function(){Le(this.g,"b")},eo.prototype.createWebChannel=eo.prototype.g,wr.prototype.send=wr.prototype.o,wr.prototype.open=wr.prototype.m,wr.prototype.close=wr.prototype.close,NM=function(){return new eo},kM=function(){return qs()},DM=on,B1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},pl.NO_ERROR=0,pl.TIMEOUT=8,pl.HTTP_ERROR=6,a0=pl,Hd.COMPLETE="complete",RM=Hd,Gs.EventType=Yr,Yr.OPEN="a",Yr.CLOSE="b",Yr.ERROR="c",Yr.MESSAGE="d",Ne.prototype.listen=Ne.prototype.J,ah=Gs,Ft.prototype.listenOnce=Ft.prototype.K,Ft.prototype.getLastError=Ft.prototype.Ha,Ft.prototype.getLastErrorCode=Ft.prototype.ya,Ft.prototype.getStatus=Ft.prototype.ca,Ft.prototype.getResponseJson=Ft.prototype.La,Ft.prototype.getResponseText=Ft.prototype.la,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Fa,IM=Ft}).apply(typeof Cm<"u"?Cm:typeof self<"u"?self:typeof window<"u"?window:{});const mI="@firebase/firestore",vI="4.9.2";class lr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lr.UNAUTHENTICATED=new lr(null),lr.GOOGLE_CREDENTIALS=new lr("google-credentials-uid"),lr.FIRST_PARTY=new lr("first-party-uid"),lr.MOCK_USER=new lr("mock-user");let Nd="12.3.0";const bc=new dw("@firebase/firestore");function Mu(){return bc.logLevel}function Ae(n,...e){if(bc.logLevel<=_t.DEBUG){const t=e.map(Iw);bc.debug(`Firestore (${Nd}): ${n}`,...t)}}function Cr(n,...e){if(bc.logLevel<=_t.ERROR){const t=e.map(Iw);bc.error(`Firestore (${Nd}): ${n}`,...t)}}function xc(n,...e){if(bc.logLevel<=_t.WARN){const t=e.map(Iw);bc.warn(`Firestore (${Nd}): ${n}`,...t)}}function Iw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ve(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,MM(n,r,t)}function MM(n,e,t){let r=`FIRESTORE (${Nd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Cr(r),new Error(r)}function Fe(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||MM(e,i,r)}function st(n,e){return n}const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Ls{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ba{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class PM{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class t7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(lr.UNAUTHENTICATED)))}shutdown(){}}class n7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class r7{constructor(e){this.t=e,this.currentUser=lr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Fe(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new Ba;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ba,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ba)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string",31837,{l:r}),new PM(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string",2055,{h:e}),new lr(e)}}class i7{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=lr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class a7{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new i7(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(lr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class yI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class s7{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ai(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Fe(this.o===void 0,3512);const r=a=>{a.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Ae("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new yI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Fe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new yI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function o7(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Rw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=o7(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function it(n,e){return n<e?-1:n>e?1:0}function U1(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Ox(i)===Ox(a)?it(i,a):Ox(i)?1:-1}return it(n.length,e.length)}const l7=55296,c7=57343;function Ox(n){const e=n.charCodeAt(0);return e>=l7&&e<=c7}function sd(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function OM(n){return n+"\0"}const bI="__name__";class Na{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ve(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ve(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Na.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Na?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=Na.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return it(e.length,t.length)}static compareSegments(e,t){const r=Na.isNumericId(e),i=Na.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Na.extractNumericId(e).compare(Na.extractNumericId(t)):U1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $o.fromString(e.substring(4,e.length-2))}}class Pt extends Na{construct(e,t,r){return new Pt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Pt(t)}static emptyPath(){return new Pt([])}}const u7=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dn extends Na{construct(e,t,r){return new dn(e,t,r)}static isValidIdentifier(e){return u7.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bI}static keyField(){return new dn([bI])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Re(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Re(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Re(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Re(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dn(t)}static emptyPath(){return new dn([])}}class ke{constructor(e){this.path=e}static fromPath(e){return new ke(Pt.fromString(e))}static fromName(e){return new ke(Pt.fromString(e).popFirst(5))}static empty(){return new ke(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ke(new Pt(e.slice()))}}function jM(n,e,t){if(!t)throw new Re(me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function d7(n,e,t,r){if(e===!0&&r===!0)throw new Re(me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function xI(n){if(!ke.isDocumentKey(n))throw new Re(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function _I(n){if(ke.isDocumentKey(n))throw new Re(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function VM(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function kv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ve(12329,{type:typeof n})}function vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=kv(n);throw new Re(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Bn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ap(n,e){if(!VM(n))throw new Re(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Re(me.INVALID_ARGUMENT,t);return!0}const wI=-62135596800,EI=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*EI);return new pt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<wI)throw new Re(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/EI}_compareTo(e){return this.seconds===e.seconds?it(this.nanoseconds,e.nanoseconds):it(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ap(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:Bn("string",pt._jsonSchemaVersion),seconds:Bn("number"),nanoseconds:Bn("number")};class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new pt(0,0))}static max(){return new Xe(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Fh=-1;class z0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function F1(n){return n.fields.find((e=>e.kind===2))}function ql(n){return n.fields.filter((e=>e.kind!==2))}z0.UNKNOWN_ID=-1;class s0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gh(0,oi.min())}}function f7(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Xe.fromTimestamp(r===1e9?new pt(t+1,0):new pt(t,r));return new oi(i,ke.empty(),e)}function zM(n){return new oi(n.readTime,n.key,Fh)}class oi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new oi(Xe.min(),ke.empty(),Fh)}static max(){return new oi(Xe.max(),ke.empty(),Fh)}}function Dw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ke.comparator(n.documentKey,e.documentKey),t!==0?t:it(n.largestBatchId,e.largestBatchId))}const LM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Pc(n){if(n.code!==me.FAILED_PRECONDITION||n.message!==LM)throw n;Ae("LocalStore","Unexpectedly lost primary lease")}class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new se(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof se?t:se.resolve(t)}catch(t){return se.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):se.reject(t)}static resolve(e){return new se(((t,r)=>{t(e)}))}static reject(e){return new se(((t,r)=>{r(e)}))}static waitFor(e){return new se(((t,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&t()}),(u=>r(u)))})),o=!0,a===i&&t()}))}static or(e){let t=se.resolve(!1);for(const r of e)t=t.next((i=>i?se.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new se(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new se(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const ii="SimpleDb";class Nv{static open(e,t,r,i){try{return new Nv(t,e.transaction(i,r))}catch(a){throw new vh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ba,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new vh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=kw(r.target.error);this.S.reject(new vh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ae(ii,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new p7(t)}}class Ho{static delete(e){return Ae(ii,"Removing database:",e),Kl(aN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!pN())return!1;if(Ho.F())return!0;const e=Xn(),t=Ho.M(e),r=0<t&&t<10,i=UM(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Ho.M(Xn())===12.2&&Cr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ae(ii,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;t(o)},i.onblocked=()=>{r(new vh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new Re(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Re(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new vh(e,o))},i.onupgradeneeded=a=>{Ae(ii,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Ae(ii,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Nv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),se.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Ae(ii,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function UM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class h7{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Kl(this.U.delete())}}class vh extends Re{constructor(e,t){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ll(n){return n.name==="IndexedDbTransactionError"}class p7{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ae(ii,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ae(ii,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Kl(r)}add(e){return Ae(ii,"ADD",this.store.name,e,e),Kl(this.store.add(e))}get(e){return Kl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ae(ii,"GET",this.store.name,e,t),t)))}delete(e){return Ae(ii,"DELETE",this.store.name,e),Kl(this.store.delete(e))}count(){return Ae(ii,"COUNT",this.store.name),Kl(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new se(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new se(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){Ae(ii,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new se(((r,i)=>{t.onerror=a=>{const o=kw(a.target.error);i(o)},t.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){const r=[];return new se(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new h7(c),d=t(c.primaryKey,c.value,u);if(d instanceof se){const h=d.catch((p=>(u.done(),se.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>se.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Kl(n){return new se(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=kw(r.target.error);t(i)}}))}let SI=!1;function kw(n){const e=Ho.M(Xn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return SI||(SI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const yh="IndexBackfiller";class g7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ae(yh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ae(yh,`Documents written: ${t}`)}catch(t){ll(t)?Ae(yh,"Ignoring IndexedDB error during index backfill: ",t):await Pc(t)}await this.re(6e4)}))}}class m7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return se.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Ae(yh,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Ae(yh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const o=zM(a);Dw(o,r)>0&&(r=o)})),new oi(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ii{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ii.ce=-1;const lc=-1;function Mv(n){return n==null}function qh(n){return n===0&&1/n==-1/0}function v7(n){return typeof n=="number"&&Number.isInteger(n)&&!qh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const L0="";function yr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=TI(e)),e=y7(n.get(t),e);return TI(e)}function y7(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case L0:t+="";break;default:t+=a}}return t}function TI(n){return n+L0+""}function Pa(n){const e=n.length;if(Fe(e>=2,64408,{path:n}),e===2)return Fe(n.charAt(0)===L0&&n.charAt(1)==="",56145,{path:n}),Pt.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const o=n.indexOf(L0,a);switch((o<0||o>t)&&Ve(50515,{path:n}),n.charAt(o+1)){case"":const c=n.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,o),i+="\0";break;case"":i+=n.substring(a,o+1);break;default:Ve(61167,{path:n})}a=o+2}return new Pt(r)}const $l="remoteDocuments",Cp="owner",Au="owner",$h="mutationQueues",b7="userId",Wi="mutations",AI="batchId",nc="userMutationsIndex",CI=["userId","batchId"];function o0(n,e){return[n,yr(e)]}function FM(n,e,t){return[n,yr(e),t]}const x7={},od="documentMutations",B0="remoteDocumentsV14",_7=["prefixPath","collectionGroup","readTime","documentId"],l0="documentKeyIndex",w7=["prefixPath","collectionGroup","documentId"],GM="collectionGroupIndex",E7=["collectionGroup","readTime","prefixPath","documentId"],Hh="remoteDocumentGlobal",G1="remoteDocumentGlobalKey",ld="targets",qM="queryTargetsIndex",S7=["canonicalId","targetId"],cd="targetDocuments",T7=["targetId","path"],Nw="documentTargetsIndex",A7=["path","targetId"],U0="targetGlobalKey",cc="targetGlobal",Yh="collectionParents",C7=["collectionId","parent"],ud="clientMetadata",I7="clientId",Pv="bundles",R7="bundleId",Ov="namedQueries",D7="name",Mw="indexConfiguration",k7="indexId",q1="collectionGroupIndex",N7="collectionGroup",bh="indexState",M7=["indexId","uid"],$M="sequenceNumberIndex",P7=["uid","sequenceNumber"],xh="indexEntries",O7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],HM="documentKeyIndex",j7=["indexId","uid","orderedDocumentKey"],jv="documentOverlays",V7=["userId","collectionPath","documentId"],$1="collectionPathOverlayIndex",z7=["userId","collectionPath","largestBatchId"],YM="collectionGroupOverlayIndex",L7=["userId","collectionGroup","largestBatchId"],Pw="globals",B7="name",KM=[$h,Wi,od,$l,ld,Cp,cc,cd,ud,Hh,Yh,Pv,Ov],U7=[...KM,jv],XM=[$h,Wi,od,B0,ld,Cp,cc,cd,ud,Hh,Yh,Pv,Ov,jv],WM=XM,Ow=[...WM,Mw,bh,xh],F7=Ow,QM=[...Ow,Pw],G7=QM;class H1 extends BM{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Wn(n,e){const t=st(n);return Ho.O(t.le,e)}function II(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function cl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ZM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class sn{constructor(e,t){this.comparator=e,this.root=t||cr.EMPTY}insert(e,t){return new sn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new sn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Im(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Im(this.root,e,this.comparator,!1)}getReverseIterator(){return new Im(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Im(this.root,e,this.comparator,!0)}}class Im{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??cr.RED,this.left=i??cr.EMPTY,this.right=a??cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new cr(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return cr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1;cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bt{constructor(e){this.comparator=e,this.data=new sn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new RI(this.data.getIterator())}getIteratorFrom(e){return new RI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Bt(this.comparator);return t.data=e,t}}class RI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cu(n){return n.hasNext()?n.getNext():void 0}class Br{constructor(e){this.fields=e,e.sort(dn.comparator)}static empty(){return new Br([])}unionWith(e){let t=new Bt(dn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Br(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class JM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Un{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new JM("Invalid base64 string: "+a):a}})(e);return new Un(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Un(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return it(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Un.EMPTY_BYTE_STRING=new Un("");const q7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ms(n){if(Fe(!!n,39018),typeof n=="string"){let e=0;const t=q7.exec(n);if(Fe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nn(n.seconds),nanos:nn(n.nanos)}}function nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ps(n){return typeof n=="string"?Un.fromBase64String(n):Un.fromUint8Array(n)}const eP="server_timestamp",tP="__type__",nP="__previous_value__",rP="__local_write_time__";function jw(n){return(n?.mapValue?.fields||{})[tP]?.stringValue===eP}function Vv(n){const e=n.mapValue.fields[nP];return jw(e)?Vv(e):e}function Kh(n){const e=Ms(n.mapValue.fields[rP].timestampValue);return new pt(e.seconds,e.nanos)}class $7{constructor(e,t,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const F0="(default)";class _c{constructor(e,t){this.projectId=e,this.database=t||F0}static empty(){return new _c("","")}get isDefaultDatabase(){return this.database===F0}isEqual(e){return e instanceof _c&&e.projectId===this.projectId&&e.database===this.database}}const Vw="__type__",iP="__max__",Vo={mapValue:{fields:{__type__:{stringValue:iP}}}},zw="__vector__",dd="value",c0={nullValue:"NULL_VALUE"};function Wo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jw(n)?4:aP(n)?9007199254740991:zv(n)?10:11:Ve(28295,{value:n})}function Ha(n,e){if(n===e)return!0;const t=Wo(n);if(t!==Wo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kh(n).isEqual(Kh(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Ms(i.timestampValue),c=Ms(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return Ps(i.bytesValue).isEqual(Ps(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return nn(i.geoPointValue.latitude)===nn(a.geoPointValue.latitude)&&nn(i.geoPointValue.longitude)===nn(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return nn(i.integerValue)===nn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=nn(i.doubleValue),c=nn(a.doubleValue);return o===c?qh(o)===qh(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return sd(n.arrayValue.values||[],e.arrayValue.values||[],Ha);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(II(o)!==II(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Ha(o[u],c[u])))return!1;return!0})(n,e);default:return Ve(52216,{left:n})}}function Xh(n,e){return(n.values||[]).find((t=>Ha(t,e)))!==void 0}function Qo(n,e){if(n===e)return 0;const t=Wo(n),r=Wo(e);if(t!==r)return it(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return it(n.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=nn(a.integerValue||a.doubleValue),u=nn(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return DI(n.timestampValue,e.timestampValue);case 4:return DI(Kh(n),Kh(e));case 5:return U1(n.stringValue,e.stringValue);case 6:return(function(a,o){const c=Ps(a),u=Ps(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=it(c[d],u[d]);if(h!==0)return h}return it(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=it(nn(a.latitude),nn(o.latitude));return c!==0?c:it(nn(a.longitude),nn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return kI(n.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[dd]?.arrayValue,h=u[dd]?.arrayValue,p=it(d?.values?.length||0,h?.values?.length||0);return p!==0?p:kI(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,o){if(a===Vo.mapValue&&o===Vo.mapValue)return 0;if(a===Vo.mapValue)return 1;if(o===Vo.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=U1(u[p],h[p]);if(m!==0)return m;const b=Qo(c[u[p]],d[h[p]]);if(b!==0)return b}return it(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Ve(23264,{he:t})}}function DI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return it(n,e);const t=Ms(n),r=Ms(e),i=it(t.seconds,r.seconds);return i!==0?i:it(t.nanos,r.nanos)}function kI(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=Qo(t[i],r[i]);if(a)return a}return it(t.length,r.length)}function fd(n){return Y1(n)}function Y1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Ms(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ps(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ke.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=Y1(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${Y1(t.fields[o])}`;return i+"}"})(n.mapValue):Ve(61005,{value:n})}function u0(n){switch(Wo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Vv(n);return e?16+u0(e):16;case 5:return 2*n.stringValue.length;case 6:return Ps(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+u0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return cl(r.fields,((a,o)=>{i+=a.length+u0(o)})),i})(n.mapValue);default:throw Ve(13486,{value:n})}}function Wh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function K1(n){return!!n&&"integerValue"in n}function Qh(n){return!!n&&"arrayValue"in n}function NI(n){return!!n&&"nullValue"in n}function MI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function d0(n){return!!n&&"mapValue"in n}function zv(n){return(n?.mapValue?.fields||{})[Vw]?.stringValue===zw}function _h(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return cl(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=_h(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_h(n.arrayValue.values[t]);return e}return{...n}}function aP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===iP}const sP={mapValue:{fields:{[Vw]:{stringValue:zw},[dd]:{arrayValue:{}}}}};function H7(n){return"nullValue"in n?c0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Wh(_c.empty(),ke.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?zv(n)?sP:{mapValue:{}}:Ve(35942,{value:n})}function Y7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Wh(_c.empty(),ke.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?sP:"mapValue"in n?zv(n)?{mapValue:{}}:Vo:Ve(61959,{value:n})}function PI(n,e){const t=Qo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function OI(n,e){const t=Qo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class gr{constructor(e){this.value=e}static empty(){return new gr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!d0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_h(t)}setAll(e){let t=dn.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=_h(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());d0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ha(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];d0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){cl(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new gr(_h(this.value))}}function oP(n){const e=[];return cl(n.fields,((t,r)=>{const i=new dn([t]);if(d0(r)){const a=oP(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new Br(e)}class yn{constructor(e,t,r,i,a,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new yn(e,0,Xe.min(),Xe.min(),Xe.min(),gr.empty(),0)}static newFoundDocument(e,t,r,i){return new yn(e,1,t,Xe.min(),r,i,0)}static newNoDocument(e,t){return new yn(e,2,t,Xe.min(),Xe.min(),gr.empty(),0)}static newUnknownDocument(e,t){return new yn(e,3,t,Xe.min(),Xe.min(),gr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class hd{constructor(e,t){this.position=e,this.inclusive=t}}function jI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],o=n.position[i];if(a.field.isKeyField()?r=ke.comparator(ke.fromName(o.referenceValue),t.key):r=Qo(o,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function VI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ha(n.position[t],e.position[t]))return!1;return!0}class Zh{constructor(e,t="asc"){this.field=e,this.dir=t}}function K7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class lP{}class wt extends lP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new X7(e,t,r):t==="array-contains"?new Z7(e,r):t==="in"?new pP(e,r):t==="not-in"?new J7(e,r):t==="array-contains-any"?new eG(e,r):new wt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new W7(e,r):new Q7(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Qo(t,this.value)):t!==null&&Wo(this.value)===Wo(t)&&this.matchesComparison(Qo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lt extends lP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Lt(e,t)}matches(e){return pd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pd(n){return n.op==="and"}function X1(n){return n.op==="or"}function Lw(n){return cP(n)&&pd(n)}function cP(n){for(const e of n.filters)if(e instanceof Lt)return!1;return!0}function W1(n){if(n instanceof wt)return n.field.canonicalString()+n.op.toString()+fd(n.value);if(Lw(n))return n.filters.map((e=>W1(e))).join(",");{const e=n.filters.map((t=>W1(t))).join(",");return`${n.op}(${e})`}}function uP(n,e){return n instanceof wt?(function(r,i){return i instanceof wt&&r.op===i.op&&r.field.isEqual(i.field)&&Ha(r.value,i.value)})(n,e):n instanceof Lt?(function(r,i){return i instanceof Lt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&uP(o,i.filters[c])),!0):!1})(n,e):void Ve(19439)}function dP(n,e){const t=n.filters.concat(e);return Lt.create(t,n.op)}function fP(n){return n instanceof wt?(function(t){return`${t.field.canonicalString()} ${t.op} ${fd(t.value)}`})(n):n instanceof Lt?(function(t){return t.op.toString()+" {"+t.getFilters().map(fP).join(" ,")+"}"})(n):"Filter"}class X7 extends wt{constructor(e,t,r){super(e,t,r),this.key=ke.fromName(r.referenceValue)}matches(e){const t=ke.comparator(e.key,this.key);return this.matchesComparison(t)}}class W7 extends wt{constructor(e,t){super(e,"in",t),this.keys=hP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Q7 extends wt{constructor(e,t){super(e,"not-in",t),this.keys=hP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function hP(n,e){return(e.arrayValue?.values||[]).map((t=>ke.fromName(t.referenceValue)))}class Z7 extends wt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qh(t)&&Xh(t.arrayValue,this.value)}}class pP extends wt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xh(this.value.arrayValue,t)}}class J7 extends wt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xh(this.value.arrayValue,t)}}class eG extends wt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Xh(this.value.arrayValue,r)))}}class tG{constructor(e,t=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function Q1(n,e=null,t=[],r=[],i=null,a=null,o=null){return new tG(n,e,t,r,i,a,o)}function wc(n){const e=st(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>W1(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Mv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>fd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>fd(r))).join(",")),e.Te=t}return e.Te}function Ip(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!K7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!uP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!VI(n.startAt,e.startAt)&&VI(n.endAt,e.endAt)}function G0(n){return ke.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function q0(n,e){return n.filters.filter((t=>t instanceof wt&&t.field.isEqual(e)))}function zI(n,e,t){let r=c0,i=!0;for(const a of q0(n,e)){let o=c0,c=!0;switch(a.op){case"<":case"<=":o=H7(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=c0}PI({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];PI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function LI(n,e,t){let r=Vo,i=!0;for(const a of q0(n,e)){let o=Vo,c=!0;switch(a.op){case">=":case">":o=Y7(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=Vo}OI({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];OI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class Md{constructor(e,t=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nG(n,e,t,r,i,a,o,c){return new Md(n,e,t,r,i,a,o,c)}function Rp(n){return new Md(n)}function BI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function gP(n){return n.collectionGroup!==null}function wh(n){const e=st(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Bt(dn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Zh(a,r))})),t.has(dn.keyField().canonicalString())||e.Ie.push(new Zh(dn.keyField(),r))}return e.Ie}function Di(n){const e=st(n);return e.Ee||(e.Ee=rG(e,wh(n))),e.Ee}function rG(n,e){if(n.limitType==="F")return Q1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Zh(i.field,a)}));const t=n.endAt?new hd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new hd(n.startAt.position,n.startAt.inclusive):null;return Q1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Z1(n,e){const t=n.filters.concat([e]);return new Md(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function $0(n,e,t){return new Md(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Lv(n,e){return Ip(Di(n),Di(e))&&n.limitType===e.limitType}function mP(n){return`${wc(Di(n))}|lt:${n.limitType}`}function Pu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>fP(i))).join(", ")}]`),Mv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>fd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>fd(i))).join(",")),`Target(${r})`})(Di(n))}; limitType=${n.limitType})`}function Dp(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ke.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of wh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=jI(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,wh(r),i)||r.endAt&&!(function(o,c,u){const d=jI(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,wh(r),i))})(n,e)}function iG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vP(n){return(e,t)=>{let r=!1;for(const i of wh(n)){const a=aG(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function aG(n,e,t){const r=n.field.isKeyField()?ke.comparator(e.key,t.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?Qo(u,d):Ve(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ve(19790,{direction:n.dir})}}class Bs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){cl(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return ZM(this.inner)}size(){return this.innerSize}}const sG=new sn(ke.comparator);function si(){return sG}const yP=new sn(ke.comparator);function sh(...n){let e=yP;for(const t of n)e=e.insert(t.key,t);return e}function bP(n){let e=yP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Oa(){return Eh()}function xP(){return Eh()}function Eh(){return new Bs((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oG=new sn(ke.comparator),lG=new Bt(ke.comparator);function gt(...n){let e=lG;for(const t of n)e=e.add(t);return e}const cG=new Bt(it);function uG(){return cG}function Bw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function _P(n){return{integerValue:""+n}}function dG(n,e){return v7(e)?_P(e):Bw(n,e)}class Bv{constructor(){this._=void 0}}function fG(n,e,t){return n instanceof Jh?(function(i,a){const o={fields:{[tP]:{stringValue:eP},[rP]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&jw(a)&&(a=Vv(a)),a&&(o.fields[nP]=a),{mapValue:o}})(t,e):n instanceof Ec?EP(n,e):n instanceof gd?SP(n,e):(function(i,a){const o=wP(i,a),c=UI(o)+UI(i.Ae);return K1(o)&&K1(i.Ae)?_P(c):Bw(i.serializer,c)})(n,e)}function hG(n,e,t){return n instanceof Ec?EP(n,e):n instanceof gd?SP(n,e):t}function wP(n,e){return n instanceof ep?(function(r){return K1(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Jh extends Bv{}class Ec extends Bv{constructor(e){super(),this.elements=e}}function EP(n,e){const t=TP(e);for(const r of n.elements)t.some((i=>Ha(i,r)))||t.push(r);return{arrayValue:{values:t}}}class gd extends Bv{constructor(e){super(),this.elements=e}}function SP(n,e){let t=TP(e);for(const r of n.elements)t=t.filter((i=>!Ha(i,r)));return{arrayValue:{values:t}}}class ep extends Bv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function UI(n){return nn(n.integerValue||n.doubleValue)}function TP(n){return Qh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class AP{constructor(e,t){this.field=e,this.transform=t}}function pG(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Ec&&i instanceof Ec||r instanceof gd&&i instanceof gd?sd(r.elements,i.elements,Ha):r instanceof ep&&i instanceof ep?Ha(r.Ae,i.Ae):r instanceof Jh&&i instanceof Jh})(n.transform,e.transform)}class gG{constructor(e,t){this.version=e,this.transformResults=t}}class Kn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kn}static exists(e){return new Kn(void 0,e)}static updateTime(e){return new Kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function f0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Uv{}function CP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new kp(n.key,Kn.none()):new Pd(n.key,n.data,Kn.none());{const t=n.data,r=gr.empty();let i=new Bt(dn.comparator);for(let a of e.fields)if(!i.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Us(n.key,r,new Br(i.toArray()),Kn.none())}}function mG(n,e,t){n instanceof Pd?(function(i,a,o){const c=i.value.clone(),u=GI(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Us?(function(i,a,o){if(!f0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=GI(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(IP(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Sh(n,e,t,r){return n instanceof Pd?(function(a,o,c,u){if(!f0(a.precondition,o))return c;const d=a.value.clone(),h=qI(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Us?(function(a,o,c,u){if(!f0(a.precondition,o))return c;const d=qI(a.fieldTransforms,u,o),h=o.data;return h.setAll(IP(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,o,c){return f0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function vG(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=wP(r.transform,i||null);a!=null&&(t===null&&(t=gr.empty()),t.set(r.field,a))}return t||null}function FI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&sd(r,i,((a,o)=>pG(a,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Pd extends Uv{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Us extends Uv{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function IP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function GI(n,e,t){const r=new Map;Fe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,hG(o,c,t[i]))}return r}function qI(n,e,t){const r=new Map;for(const i of n){const a=i.transform,o=t.data.field(i.field);r.set(i.field,fG(a,o,e))}return r}class kp extends Uv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class RP extends Uv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Uw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&mG(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Sh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Sh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=xP();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(i.key)?null:c;const u=CP(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),gt())}isEqual(e){return this.batchId===e.batchId&&sd(this.mutations,e.mutations,((t,r)=>FI(t,r)))&&sd(this.baseMutations,e.baseMutations,((t,r)=>FI(t,r)))}}class Fw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Fe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return oG})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Fw(e,t,r,i)}}class Gw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class yG{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vn,Tt;function bG(n){switch(n){case me.OK:return Ve(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Ve(15467,{code:n})}}function DP(n){if(n===void 0)return Cr("GRPC error has no .code"),me.UNKNOWN;switch(n){case Vn.OK:return me.OK;case Vn.CANCELLED:return me.CANCELLED;case Vn.UNKNOWN:return me.UNKNOWN;case Vn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case Vn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case Vn.INTERNAL:return me.INTERNAL;case Vn.UNAVAILABLE:return me.UNAVAILABLE;case Vn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case Vn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case Vn.NOT_FOUND:return me.NOT_FOUND;case Vn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case Vn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case Vn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case Vn.ABORTED:return me.ABORTED;case Vn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case Vn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case Vn.DATA_LOSS:return me.DATA_LOSS;default:return Ve(39323,{code:n})}}(Tt=Vn||(Vn={}))[Tt.OK=0]="OK",Tt[Tt.CANCELLED=1]="CANCELLED",Tt[Tt.UNKNOWN=2]="UNKNOWN",Tt[Tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tt[Tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tt[Tt.NOT_FOUND=5]="NOT_FOUND",Tt[Tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tt[Tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tt[Tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tt[Tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tt[Tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tt[Tt.ABORTED=10]="ABORTED",Tt[Tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tt[Tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tt[Tt.INTERNAL=13]="INTERNAL",Tt[Tt.UNAVAILABLE=14]="UNAVAILABLE",Tt[Tt.DATA_LOSS=15]="DATA_LOSS";function xG(){return new TextEncoder}const _G=new $o([4294967295,4294967295],0);function $I(n){const e=xG().encode(n),t=new CM;return t.update(e),new Uint8Array(t.digest())}function HI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new $o([t,r],0),new $o([i,a],0)]}class qw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new oh(`Invalid padding: ${t}`);if(r<0)throw new oh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new oh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new oh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=$o.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply($o.fromNumber(r)));return i.compare(_G)===1&&(i=new $o([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=$I(e),[r,i]=HI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new qw(a,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=$I(e),[r,i]=HI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class oh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Fv{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Np.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Fv(Xe.min(),i,new sn(it),si(),gt())}}class Np{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Np(r,t,gt(),gt(),gt())}}class h0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class kP{constructor(e,t){this.targetId=e,this.Ce=t}}class NP{constructor(e,t,r=Un.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class YI{constructor(){this.ve=0,this.Fe=KI(),this.Me=Un.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gt(),t=gt(),r=gt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ve(38017,{changeType:a})}})),new Np(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=KI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Fe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wG{constructor(e){this.Ge=e,this.ze=new Map,this.je=si(),this.Je=Rm(),this.He=Rm(),this.Ye=new sn(it)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(G0(a))if(r===0){const o=new ke(a.path);this.et(t,o,yn.newNoDocument(o,Xe.min()))}else Fe(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let o,c;try{o=Ps(r).toUint8Array()}catch(u){if(u instanceof JM)return xc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new qw(o,i,a)}catch(u){return xc(u instanceof oh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&G0(c.target)){const u=new ke(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,yn.newNoDocument(u,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let r=gt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new Fv(e,t,this.Ye,this.je,r);return this.je=si(),this.Je=Rm(),this.He=Rm(),this.Ye=new sn(it),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new YI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Bt(it),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Bt(it),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new YI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Rm(){return new sn(ke.comparator)}function KI(){return new sn(ke.comparator)}const EG={asc:"ASCENDING",desc:"DESCENDING"},SG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TG={and:"AND",or:"OR"};class AG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function J1(n,e){return n.useProto3Json||Mv(e)?e:{value:e}}function md(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function MP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function CG(n,e){return md(n,e.toTimestamp())}function Dr(n){return Fe(!!n,49232),Xe.fromTimestamp((function(t){const r=Ms(t);return new pt(r.seconds,r.nanos)})(n))}function $w(n,e){return e_(n,e).canonicalString()}function e_(n,e){const t=(function(i){return new Pt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function PP(n){const e=Pt.fromString(n);return Fe(GP(e),10190,{key:e.toString()}),e}function H0(n,e){return $w(n.databaseId,e.path)}function uc(n,e){const t=PP(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ke(VP(t))}function OP(n,e){return $w(n.databaseId,e)}function jP(n){const e=PP(n);return e.length===4?Pt.emptyPath():VP(e)}function t_(n){return new Pt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function VP(n){return Fe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function XI(n,e,t){return{name:H0(n,e),fields:t.value.mapValue.fields}}function IG(n,e,t){const r=uc(n,e.name),i=Dr(e.updateTime),a=e.createTime?Dr(e.createTime):Xe.min(),o=new gr({mapValue:{fields:e.fields}}),c=yn.newFoundDocument(r,i,a,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function RG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ve(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Fe(h===void 0||typeof h=="string",58123),Un.fromBase64String(h||"")):(Fe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Un.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?me.UNKNOWN:DP(d.code);return new Re(h,d.message||"")})(o);t=new NP(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=uc(n,r.document.name),a=Dr(r.document.updateTime),o=r.document.createTime?Dr(r.document.createTime):Xe.min(),c=new gr({mapValue:{fields:r.document.fields}}),u=yn.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new h0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=uc(n,r.document),a=r.readTime?Dr(r.readTime):Xe.min(),o=yn.newNoDocument(i,a),c=r.removedTargetIds||[];t=new h0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=uc(n,r.document),a=r.removedTargetIds||[];t=new h0([],a,i,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new yG(i,a),c=r.targetId;t=new kP(c,o)}}return t}function Y0(n,e){let t;if(e instanceof Pd)t={update:XI(n,e.key,e.value)};else if(e instanceof kp)t={delete:H0(n,e.key)};else if(e instanceof Us)t={update:XI(n,e.key,e.data),updateMask:OG(e.fieldMask)};else{if(!(e instanceof RP))return Ve(16599,{Vt:e.type});t={verify:H0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof Jh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ec)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof gd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ep)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Ve(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:CG(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ve(27497)})(n,e.precondition)),t}function n_(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Kn.updateTime(Dr(a.updateTime)):a.exists!==void 0?Kn.exists(a.exists):Kn.none()})(e.currentDocument):Kn.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Fe(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new Jh;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Ec(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new gd(h)}else"increment"in c?u=new ep(o,c.increment):Ve(16584,{proto:c});const d=dn.fromServerFormat(c.fieldPath);return new AP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=uc(n,e.update.name),a=new gr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new Br(d.map((h=>dn.fromServerFormat(h))))})(e.updateMask);return new Us(i,a,o,t,r)}return new Pd(i,a,t,r)}if(e.delete){const i=uc(n,e.delete);return new kp(i,t)}if(e.verify){const i=uc(n,e.verify);return new RP(i,t)}return Ve(1463,{proto:e})}function DG(n,e){return n&&n.length>0?(Fe(e!==void 0,14353),n.map((t=>(function(i,a){let o=i.updateTime?Dr(i.updateTime):Dr(a);return o.isEqual(Xe.min())&&(o=Dr(a)),new gG(o,i.transformResults||[])})(t,e)))):[]}function zP(n,e){return{documents:[OP(n,e.path)]}}function LP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=OP(n,i);const a=(function(d){if(d.length!==0)return FP(Lt.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:Ou(m.field),direction:NG(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=J1(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function BP(n){let e=jP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Fe(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=UP(p);return m instanceof Lt&&Lw(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new Zh(ju(_.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,Mv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new hd(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new hd(b,m)})(t.endAt)),nG(e,i,o,a,c,"F",u,d)}function kG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function UP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ju(t.unaryFilter.field);return wt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ju(t.unaryFilter.field);return wt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ju(t.unaryFilter.field);return wt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ju(t.unaryFilter.field);return wt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(n):n.fieldFilter!==void 0?(function(t){return wt.create(ju(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Lt.create(t.compositeFilter.filters.map((r=>UP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(t.compositeFilter.op))})(n):Ve(30097,{filter:n})}function NG(n){return EG[n]}function MG(n){return SG[n]}function PG(n){return TG[n]}function Ou(n){return{fieldPath:n.canonicalString()}}function ju(n){return dn.fromServerFormat(n.fieldPath)}function FP(n){return n instanceof wt?(function(t){if(t.op==="=="){if(MI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NAN"}};if(NI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(MI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NOT_NAN"}};if(NI(t.value))return{unaryFilter:{field:Ou(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ou(t.field),op:MG(t.op),value:t.value}}})(n):n instanceof Lt?(function(t){const r=t.getFilters().map((i=>FP(i)));return r.length===1?r[0]:{compositeFilter:{op:PG(t.op),filters:r}}})(n):Ve(54877,{filter:n})}function OG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function GP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Es{constructor(e,t,r,i,a=Xe.min(),o=Xe.min(),c=Un.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Es(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class qP{constructor(e){this.yt=e}}function jG(n,e){let t;if(e.document)t=IG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ke.fromSegments(e.noDocument.path),i=Tc(e.noDocument.readTime);t=yn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ve(56709);{const r=ke.fromSegments(e.unknownDocument.path),i=Tc(e.unknownDocument.version);t=yn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new pt(i[0],i[1]);return Xe.fromTimestamp(a)})(e.readTime)),t}function WI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:K0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:H0(a,o.key),fields:o.data.value.mapValue.fields,updateTime:md(a,o.version.toTimestamp()),createTime:md(a,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Sc(e.version)};else{if(!e.isUnknownDocument())return Ve(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Sc(e.version)}}return r}function K0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Sc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Tc(n){const e=new pt(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function Xl(n,e){const t=(e.baseMutations||[]).map((a=>n_(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>n_(n.yt,a))),i=pt.fromMillis(e.localWriteTimeMs);return new Uw(e.batchId,i,t,r)}function lh(n){const e=Tc(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Tc(n.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const o=a.documents.length;return Fe(o===1,1966,{count:o}),Di(Rp(jP(a.documents[0])))})(n.query):(function(a){return Di(BP(a))})(n.query),new Es(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Un.fromBase64String(n.resumeToken))}function $P(n,e){const t=Sc(e.snapshotVersion),r=Sc(e.lastLimboFreeSnapshotVersion);let i;i=G0(e.target)?zP(n.yt,e.target):LP(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:wc(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function HP(n){const e=BP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?$0(e,e.limit,"L"):e}function jx(n,e){return new Gw(e.largestBatchId,n_(n.yt,e.overlayMutation))}function QI(n,e){const t=e.path.lastSegment();return[n,yr(e.path.popLast()),t]}function ZI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Sc(r.readTime),documentKey:yr(r.documentKey.path),largestBatchId:r.largestBatchId}}class VG{getBundleMetadata(e,t){return JI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Tc(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return JI(e).put((function(i){return{bundleId:i.id,createTime:Sc(Dr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return eR(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:HP(a.bundledQuery),readTime:Tc(a.readTime)}})(r)}))}saveNamedQuery(e,t){return eR(e).put((function(i){return{name:i.name,readTime:Sc(Dr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function JI(n){return Wn(n,Pv)}function eR(n){return Wn(n,Ov)}class Gv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Gv(e,r)}getOverlay(e,t){return Xf(e).get(QI(this.userId,t)).next((r=>r?jx(this.serializer,r):null))}getOverlays(e,t){const r=Oa();return se.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,o)=>{const c=new Gw(t,o);i.push(this.St(e,c))})),se.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(yr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Xf(e).Z($1,c))})),se.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Oa(),a=yr(t),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Xf(e).J($1,o).next((c=>{for(const u of c){const d=jx(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=Oa();let o;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xf(e).ee({index:YM,range:c},((u,d,h)=>{const p=jx(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return Xf(e).put((function(i,a,o){const[c,u,d]=QI(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Y0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Xf(n){return Wn(n,jv)}class zG{bt(e){return Wn(e,Pw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Un.fromUint8Array(r):Un.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Wl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(nn(e.integerValue));else if("doubleValue"in e){const r=nn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),qh(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ms(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ps(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?aP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):zv(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ve(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=dd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(nn(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),ke.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Wl.Kt=new Wl;const Iu=255;function LG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function tR(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=LG(255&r[a]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class BG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=tR(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=tR(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Iu),this.sn(255)}_n(){this.an(Iu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Iu?(this.sn(Iu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Iu?(this.an(Iu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class UG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class FG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Wf{constructor(){this.cn=new BG,this.ln=new UG(this.cn),this.hn=new FG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ql{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Ql(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:p0(this.En),directionalValue:p0(this.dn),orderedDocumentKey:p0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function To(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=nR(n.En,e.En),t!==0?t:(t=nR(n.dn,e.dn),t!==0?t:ke.comparator(n.In,e.In)))}function nR(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function p0(n){return hN()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function rR(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class iR{constructor(e){this.mn=new Bt(((t,r)=>dn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Fe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=F1(e);if(t!==void 0&&!this.wn(t))return!1;const r=ql(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new Bt(dn.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new s0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new s0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new s0(r.field,r.dir==="asc"?0:1)));return new z0(z0.UNKNOWN_ID,this.collectionId,t,Gh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function YP(n){if(Fe(n instanceof wt||n instanceof Lt,20012),n instanceof wt){if(n instanceof pP){const t=n.value.arrayValue?.values?.map((r=>wt.create(n.field,"==",r)))||[];return Lt.create(t,"or")}return n}const e=n.filters.map((t=>YP(t)));return Lt.create(e,n.op)}function GG(n){if(n.getFilters().length===0)return[];const e=a_(YP(n));return Fe(KP(e),7391),r_(e)||i_(e)?[e]:e.getFilters()}function r_(n){return n instanceof wt}function i_(n){return n instanceof Lt&&Lw(n)}function KP(n){return r_(n)||i_(n)||(function(t){if(t instanceof Lt&&X1(t)){for(const r of t.getFilters())if(!r_(r)&&!i_(r))return!1;return!0}return!1})(n)}function a_(n){if(Fe(n instanceof wt||n instanceof Lt,34018),n instanceof wt)return n;if(n.filters.length===1)return a_(n.filters[0]);const e=n.filters.map((r=>a_(r)));let t=Lt.create(e,n.op);return t=X0(t),KP(t)?t:(Fe(t instanceof Lt,64498),Fe(pd(t),40251),Fe(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Hw(r,i))))}function Hw(n,e){let t;return Fe(n instanceof wt||n instanceof Lt,38388),Fe(e instanceof wt||e instanceof Lt,25473),t=n instanceof wt?e instanceof wt?(function(i,a){return Lt.create([i,a],"and")})(n,e):aR(n,e):e instanceof wt?aR(e,n):(function(i,a){if(Fe(i.filters.length>0&&a.filters.length>0,48005),pd(i)&&pd(a))return dP(i,a.getFilters());const o=X1(i)?i:a,c=X1(i)?a:i,u=o.filters.map((d=>Hw(d,c)));return Lt.create(u,"or")})(n,e),X0(t)}function aR(n,e){if(pd(e))return dP(e,n.getFilters());{const t=e.filters.map((r=>Hw(n,r)));return Lt.create(t,"or")}}function X0(n){if(Fe(n instanceof wt||n instanceof Lt,11850),n instanceof wt)return n;const e=n.getFilters();if(e.length===1)return X0(e[0]);if(cP(n))return n;const t=e.map((i=>X0(i))),r=[];return t.forEach((i=>{i instanceof wt?r.push(i):i instanceof Lt&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Lt.create(r,n.op)}class qG{constructor(){this.Cn=new Yw}addToCollectionParentIndex(e,t){return this.Cn.add(t),se.resolve()}getCollectionParents(e,t){return se.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return se.resolve()}deleteFieldIndex(e,t){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,t){return se.resolve()}getDocumentsMatchingTarget(e,t){return se.resolve(null)}getIndexType(e,t){return se.resolve(0)}getFieldIndexes(e,t){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,t){return se.resolve(oi.min())}getMinOffsetFromCollectionGroup(e,t){return se.resolve(oi.min())}updateCollectionGroup(e,t,r){return se.resolve()}updateIndexEntries(e,t){return se.resolve()}}class Yw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Bt(Pt.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Bt(Pt.comparator)).toArray()}}const sR="IndexedDbIndexManager",Dm=new Uint8Array(0);class $G{constructor(e,t){this.databaseId=t,this.vn=new Yw,this.Fn=new Bs((r=>wc(r)),((r,i)=>Ip(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:yr(i)};return oR(e).put(a)}return se.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[OM(t),""],!1,!0);return oR(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==t)break;r.push(Pa(o.parent))}return r}))}addFieldIndex(e,t){const r=Qf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const o=Du(e);return a.next((c=>{o.put(ZI(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=Qf(e),i=Du(e),a=Ru(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Qf(e),r=Ru(e),i=Du(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return se.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new iR(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=Ru(e);let i=!0;const a=new Map;return se.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=gt();const c=[];return se.forEach(a,((u,d)=>{Ae(sR,`Using index ${(function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map((O=>`${O.fieldPath}:${O.kind}`)).join(",")}`})(u)} to execute ${wc(t)}`);const h=(function(R,O){const P=F1(O);if(P===void 0)return null;for(const M of q0(R,P.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null})(d,u),p=(function(R,O){const P=new Map;for(const M of ql(O))for(const A of q0(R,M.fieldPath))switch(A.op){case"==":case"in":P.set(M.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return P.set(M.fieldPath.canonicalString(),A.value),Array.from(P.values())}return null})(d,u),m=(function(R,O){const P=[];let M=!0;for(const A of ql(O)){const I=A.kind===0?zI(R,A.fieldPath,R.startAt):LI(R,A.fieldPath,R.startAt);P.push(I.value),M&&(M=I.inclusive)}return new hd(P,M)})(d,u),b=(function(R,O){const P=[];let M=!0;for(const A of ql(O)){const I=A.kind===0?LI(R,A.fieldPath,R.endAt):zI(R,A.fieldPath,R.endAt);P.push(I.value),M&&(M=I.inclusive)}return new hd(P,M)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),S=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,S);return se.forEach(T,(C=>r.Y(C,t.limit).next((R=>{R.forEach((O=>{const P=ke.fromSegments(O.documentKey);o.has(P)||(o=o.add(P),c.push(P))}))}))))})).next((()=>c))}return se.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=GG(Lt.create(e.filters,"and")).map((r=>Q1(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,o,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Dm,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((S=>this.kn(e,m,S,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new Ql(e,ke.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new Ql(e,ke.empty(),t,r);return i?a.An():a}xn(e,t){const r=new iR(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return se.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new Bt(dn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Wf;for(const i of ql(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);Wl.Kt.Dt(a,o)}return r.un()}Ln(e){const t=new Wf;return Wl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Wf;return Wl.Kt.Dt(Wh(this.databaseId,t),r.Pn((function(a){const o=ql(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Wf);let a=0;for(const o of ql(e)){const c=r[a++];for(const u of i)if(this.Un(t,o.fieldPath)&&Qh(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);Wl.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Wf;u.seed(c.un()),Wl.Kt.Dt(o,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof wt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Qf(e),i=Du(e);return(t?r.J(q1,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const o=[];return se.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new Gh(p.sequenceNumber,new oi(Tc(p.readTime),new ke(Pa(p.documentKey)),p.largestBatchId)):Gh.empty(),b=h.fields.map((([_,w])=>new s0(dn.fromServerFormat(_),w)));return new z0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:it(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Qf(e),a=Du(e);return this.Gn(e).next((o=>i.J(q1,IDBKeyRange.bound(t,t)).next((c=>se.forEach(c,(u=>a.put(ZI(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return se.forEach(t,((i,a)=>{const o=r.get(i.collectionGroup);return(o?se.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),se.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?se.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return Ru(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Ru(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Ru(e);let a=new Bt(To);return i.ee({index:HM,range:IDBKeyRange.only([r.indexId,this.uid,p0(this.$n(r,t))])},((o,c)=>{a=a.add(new Ql(r.indexId,t,rR(c.arrayValue),rR(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new Bt(To);const i=this.Qn(t,e);if(i==null)return r;const a=F1(t);if(a!=null){const o=e.data.field(a.fieldPath);if(Qh(o))for(const c of o.arrayValue.values||[])r=r.add(new Ql(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new Ql(t.indexId,e.key,Dm,i));return r}Jn(e,t,r,i,a){Ae(sR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Cu(b),S=Cu(_);for(;w||S;){let T=!1,C=!1;if(w&&S){const R=h(w,S);R<0?C=!0:R>0&&(T=!0)}else w!=null?C=!0:T=!0;T?(p(S),S=Cu(_)):C?(m(w),w=Cu(b)):(w=Cu(b),S=Cu(_))}})(i,a,To,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),se.waitFor(o)}Gn(e){let t=1;return Du(e).ee({index:$M,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>To(o,c))).filter(((o,c,u)=>!c||To(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=To(o,e),u=To(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Dm,ke.empty()),u=i[o+1].Vn(this.uid,Dm,ke.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return To(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(lR)}getMinOffset(e,t){return se.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Ve(44426))))).next(lR)}}function oR(n){return Wn(n,Yh)}function Ru(n){return Wn(n,xh)}function Qf(n){return Wn(n,Mw)}function Du(n){return Wn(n,bh)}function lR(n){Fe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Dw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new oi(e.readTime,e.documentKey,t)}const cR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},XP=41943040;class pr{static withCacheSize(e){return new pr(e,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function WP(n,e,t){const r=n.store(Wi),i=n.store(od),a=[],o=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{Fe(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=FM(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return se.waitFor(a).next((()=>d))}function W0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ve(14731);e=n.noDocument}return JSON.stringify(e).length}pr.DEFAULT_COLLECTION_PERCENTILE=10,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pr.DEFAULT=new pr(XP,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pr.DISABLED=new pr(-1,0,0);class qv{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Fe(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new qv(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ao(e).ee({index:nc,range:r},((i,a,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=Vu(e),o=Ao(e);return o.add({}).next((c=>{Fe(typeof c=="number",49019);const u=new Uw(c,t,r,i),d=(function(b,_,w){const S=w.baseMutations.map((C=>Y0(b.yt,C))),T=w.mutations.map((C=>Y0(b.yt,C)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:S,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new Bt(((m,b)=>it(m.canonicalString(),b.canonicalString())));for(const m of i){const b=FM(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(b,x7))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),se.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return Ao(e).get(t).next((r=>r?(Fe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Xl(this.serializer,r)):null))}er(e,t){return this.Xn[t]?se.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Ao(e).ee({index:nc,range:i},((o,c,u)=>{c.userId===this.userId&&(Fe(c.batchId>=r,47524,{tr:r}),a=Xl(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=lc;return Ao(e).ee({index:nc,range:t,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,lc],[this.userId,Number.POSITIVE_INFINITY]);return Ao(e).J(nc,t).next((r=>r.map((i=>Xl(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=o0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Vu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=Pa(h);if(d===this.userId&&t.path.isEqual(m))return Ao(e).get(p).next((b=>{if(!b)throw Ve(61480,{nr:o,batchId:p});Fe(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(Xl(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Bt(it);const i=[];return t.forEach((a=>{const o=o0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=Vu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=Pa(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),se.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=o0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new Bt(it);return Vu(e).ee({range:o},((u,d,h)=>{const[p,m,b]=u,_=Pa(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(Ao(e).get(a).next((o=>{if(o===null)throw Ve(35274,{batchId:a});Fe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(Xl(this.serializer,o))})))})),se.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return WP(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),se.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return se.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Vu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=Pa(a[1]);i.push(u)}else c.done()})).next((()=>{Fe(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return QP(e,this.userId,t)}_r(e){return ZP(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:lc,lastStreamToken:""}))}}function QP(n,e,t){const r=o0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return Vu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function Ao(n){return Wn(n,Wi)}function Vu(n){return Wn(n,od)}function ZP(n){return Wn(n,$h)}class Ac{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ac(0)}static cr(){return new Ac(-1)}}class HG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Ac(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Xe.fromTimestamp(new pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ku(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Fe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return ku(e).ee(((o,c)=>{const u=lh(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>se.waitFor(a))).next((()=>i))}forEachTarget(e,t){return ku(e).ee(((r,i)=>{const a=lh(i);t(a)}))}lr(e){return uR(e).get(U0).next((t=>(Fe(t!==null,2888),t)))}hr(e,t){return uR(e).put(U0,t)}Pr(e,t){return ku(e).put($P(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=wc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return ku(e).ee({range:i,index:qM},((o,c,u)=>{const d=lh(c);Ip(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=jo(e);return t.forEach((o=>{const c=yr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),se.waitFor(i)}removeMatchingKeys(e,t,r){const i=jo(e);return se.forEach(t,(a=>{const o=yr(a.path);return se.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=jo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=jo(e);let a=gt();return i.ee({range:r,X:!0},((o,c,u)=>{const d=Pa(o[1]),h=new ke(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=yr(t.path),i=IDBKeyRange.bound([r],[OM(r)],!1,!0);let a=0;return jo(e).ee({index:Nw,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return ku(e).get(t).next((r=>r?lh(r):null))}}function ku(n){return Wn(n,ld)}function uR(n){return Wn(n,cc)}function jo(n){return Wn(n,cd)}const dR="LruGarbageCollector",YG=1048576;function fR([n,e],[t,r]){const i=it(n,t);return i===0?it(e,r):i}class KG{constructor(e){this.Ir=e,this.buffer=new Bt(fR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();fR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class JP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(dR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ll(t)?Ae(dR,"Ignoring IndexedDB error during garbage collection: ",t):await Pc(t)}await this.Vr(3e5)}))}}class XG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return se.resolve(Ii.ce);const r=new KG(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(cR)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Mu()<=_t.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function eO(n,e){return new XG(n,e)}class WG{constructor(e,t){this.db=e,this.garbageCollector=eO(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return km(e,r)}removeReference(e,t,r){return km(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return km(e,t)}br(e,t){return(function(i,a){let o=!1;return ZP(i).te((c=>QP(i,c,a).next((u=>(u&&(o=!0),se.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=t){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Xe.min()),jo(e).delete((function(p){return[0,yr(p.path)]})(o)))))}));i.push(u)}})).next((()=>se.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return km(e,t)}Sr(e,t){const r=jo(e);let i,a=Ii.ce;return r.ee({index:Nw},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==Ii.ce&&t(new ke(Pa(i)),a),a=d,i=u):a=Ii.ce})).next((()=>{a!==Ii.ce&&t(new ke(Pa(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function km(n,e){return jo(n).put((function(r,i){return{targetId:0,path:yr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class tO{constructor(){this.changes=new Bs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?se.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class QG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Bl(e).put(r)}removeEntry(e,t,r){return Bl(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],K0(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=yn.newInvalidDocument(t);return Bl(e).ee({index:l0,range:IDBKeyRange.only(Zf(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:yn.newInvalidDocument(t)};return Bl(e).ee({index:l0,range:IDBKeyRange.only(Zf(t))},((i,a)=>{r={document:this.Cr(t,a),size:W0(a)}})).next((()=>r))}getEntries(e,t){let r=si();return this.Fr(e,t,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=si(),i=new sn(ke.comparator);return this.Fr(e,t,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,W0(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return se.resolve();let i=new Bt(gR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(Zf(i.first()),Zf(i.last())),o=i.getIterator();let c=o.getNext();return Bl(e).ee({index:l0,range:a},((u,d,h)=>{const p=ke.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&gR(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(Zf(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const o=t.path,c=[o.popLast().toArray(),o.lastSegment(),K0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Bl(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=si();for(const p of d){const m=this.Cr(ke.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Dp(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=si();const o=pR(t,r),c=pR(t,oi.max());return Bl(e).ee({index:GM,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(ke.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new ZG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return hR(e).get(G1).next((t=>(Fe(!!t,20021),t)))}Dr(e,t){return hR(e).put(G1,t)}Cr(e,t){if(t){const r=jG(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return yn.newInvalidDocument(e)}}function nO(n){return new QG(n)}class ZG extends tO{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Bs((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Bt(((a,o)=>it(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=WI(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=W0(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=WI(this.Nr.serializer,o.convertToNoDocument(Xe.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),se.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function hR(n){return Wn(n,Hh)}function Bl(n){return Wn(n,B0)}function Zf(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pR(n,e){const t=e.documentKey.path.toArray();return[n,K0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function gR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=it(t[a],r[a]),i)return i;return i=it(t.length,r.length),i||(i=it(t[t.length-2],r[r.length-2]),i||it(t[t.length-1],r[r.length-1]))}class JG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class rO{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Sh(r.mutation,i,Br.empty(),pt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,gt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=gt()){const i=Oa();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let o=sh();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Oa();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,gt())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let a=si();const o=Eh(),c=(function(){return Eh()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Us)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Sh(h.mutation,d,h.mutation.getFieldMask(),pt.now())):o.set(d.key,Br.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>c.set(d,new JG(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Eh();let i=new sn(((o,c)=>o-c)),a=gt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||Br.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||gt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=xP();h.forEach((m=>{if(!a.has(m)){const b=CP(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return se.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return ke.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):se.resolve(Oa());let c=Fh,u=a;return o.next((d=>se.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?se.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,gt()))).next((h=>({batchId:c,changes:bP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ke(t)).next((r=>{let i=sh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let o=sh();return this.indexManager.getCollectionParents(e,a).next((c=>se.forEach(c,(u=>{const d=(function(p,m){return new Md(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,yn.newInvalidDocument(h)))}));let c=sh();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Sh(h.mutation,d,Br.empty(),pt.now()),Dp(t,d)&&(c=c.insert(u,d))})),c}))}}class eq{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return se.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Dr(i.createTime)}})(t)),se.resolve()}getNamedQuery(e,t){return se.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:HP(i.bundledQuery),readTime:Dr(i.readTime)}})(t)),se.resolve()}}class tq{constructor(){this.overlays=new sn(ke.comparator),this.qr=new Map}getOverlay(e,t){return se.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Oa();return se.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),se.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),se.resolve()}getOverlaysForCollection(e,t,r){const i=Oa(),a=t.length+1,o=new ke(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return se.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new sn(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Oa(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Oa(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return se.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Gw(t,r));let a=this.qr.get(t);a===void 0&&(a=gt(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class nq{constructor(){this.sessionToken=Un.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,se.resolve()}}class Kw{constructor(){this.Qr=new Bt(er.$r),this.Ur=new Bt(er.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new er(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new er(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ke(new Pt([])),r=new er(t,e),i=new er(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ke(new Pt([])),r=new er(t,e),i=new er(t,e+1);let a=gt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new er(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class er{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ke.comparator(e.key,t.key)||it(e.Yr,t.Yr)}static Kr(e,t){return it(e.Yr,t.Yr)||ke.comparator(e.key,t.key)}}class rq{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Bt(er.$r)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Uw(a,t,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new er(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return se.resolve(o)}lookupMutationBatch(e,t){return se.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return se.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?lc:this.tr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new er(t,0),i=new er(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),se.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Bt(it);return t.forEach((i=>{const a=new er(i,0),o=new er(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),se.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;ke.isDocumentKey(a)||(a=a.child(""));const o=new er(new ke(a),0);let c=new Bt(it);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),se.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Fe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return se.forEach(t.mutations,(i=>{const a=new er(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new er(t,0),i=this.Zr.firstAfterOrEqual(r);return se.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class iq{constructor(e){this.ri=e,this.docs=(function(){return new sn(ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return se.resolve(r?r.document.mutableCopy():yn.newInvalidDocument(t))}getEntries(e,t){let r=si();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():yn.newInvalidDocument(i))})),se.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=si();const o=t.path,c=new ke(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Dw(zM(h),r)<=0||(i.has(h.key)||Dp(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return se.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Ve(9500)}ii(e,t){return se.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new aq(this)}getSize(e){return se.resolve(this.size)}}class aq extends tO{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),se.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class sq{constructor(e){this.persistence=e,this.si=new Bs((t=>wc(t)),Ip),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.oi=0,this._i=new Kw,this.targetCount=0,this.ai=Ac.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),se.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ac(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,se.resolve()}updateTargetData(e,t){return this.Pr(t),se.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),se.waitFor(a).next((()=>i))}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return se.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),se.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),se.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),se.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return se.resolve(r)}containsKey(e,t){return se.resolve(this._i.containsKey(t))}}class Xw{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ii(0),this.li=!1,this.li=!0,this.hi=new nq,this.referenceDelegate=e(this),this.Pi=new sq(this),this.indexManager=new qG,this.remoteDocumentCache=(function(i){return new iq(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new qP(t),this.Ii=new eq(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tq,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new rq(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae("MemoryPersistence","Starting transaction:",e);const i=new oq(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return se.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class oq extends BM{constructor(e){super(),this.currentSequenceNumber=e}}class $v{constructor(e){this.persistence=e,this.Ri=new Kw,this.Vi=null}static mi(e){return new $v(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),se.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),se.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),se.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.fi,(r=>{const i=ke.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return se.or([()=>se.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Q0{constructor(e,t){this.persistence=e,this.pi=new Bs((r=>yr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=eO(this,t)}static mi(e,t){return new Q0(e,t)}Ei(){}di(e){return se.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return se.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?se.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,a.removeEntry(o,Xe.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),se.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),se.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=u0(e.data.value)),t}br(e,t,r){return se.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return se.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class lq{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Nv("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Cp)})(e),(function(u){u.createObjectStore($h,{keyPath:b7}),u.createObjectStore(Wi,{keyPath:AI,autoIncrement:!0}).createIndex(nc,CI,{unique:!0}),u.createObjectStore(od)})(e),mR(e),(function(u){u.createObjectStore($l)})(e));let o=se.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(cd),u.deleteObjectStore(ld),u.deleteObjectStore(cc)})(e),mR(e)),o=o.next((()=>(function(u){const d=u.store(cc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return d.put(U0,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(Wi).J().next((p=>{u.deleteObjectStore(Wi),u.createObjectStore(Wi,{keyPath:AI,autoIncrement:!0}).createIndex(nc,CI,{unique:!0});const m=d.store(Wi),b=p.map((_=>m.put(_)));return se.waitFor(b)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(ud,{keyPath:I7})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Hh)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Pv,{keyPath:R7})})(e),(function(u){u.createObjectStore(Ov,{keyPath:D7})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(jv,{keyPath:V7});d.createIndex($1,z7,{unique:!1}),d.createIndex(YM,L7,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(B0,{keyPath:_7});d.createIndex(l0,w7),d.createIndex(GM,E7)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore($l)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Mw,{keyPath:k7,autoIncrement:!0}).createIndex(q1,N7,{unique:!1}),u.createObjectStore(bh,{keyPath:M7}).createIndex($M,P7,{unique:!1}),u.createObjectStore(xh,{keyPath:O7}).createIndex(HM,j7,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(bh).clear()})).next((()=>{t.objectStore(xh).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Pw,{keyPath:B7})})(e)}))),r<18&&i>=18&&hN()&&(o=o.next((()=>{t.objectStore(bh).clear()})).next((()=>{t.objectStore(xh).clear()}))),o}wi(e){let t=0;return e.store($l).ee(((r,i)=>{t+=W0(i)})).next((()=>{const r={byteSize:t};return e.store(Hh).put(G1,r)}))}yi(e){const t=e.store($h),r=e.store(Wi);return t.J().next((i=>se.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,lc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(nc,o).next((c=>se.forEach(c,(u=>{Fe(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=Xl(this.serializer,u);return WP(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(cd),r=e.store($l);return e.store(cc).get(U0).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new Pt(o),d=(function(p){return[0,yr(p)]})(u);a.push(t.get(d).next((h=>h?se.resolve():(p=>t.put({targetId:0,path:yr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>se.waitFor(a)))}))}bi(e,t){e.createObjectStore(Yh,{keyPath:C7});const r=t.store(Yh),i=new Yw,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:yr(u)})}};return t.store($l).ee({X:!0},((o,c)=>{const u=new Pt(o);return a(u.popLast())})).next((()=>t.store(od).ee({X:!0},(([o,c,u],d)=>{const h=Pa(c);return a(h.popLast())}))))}Di(e){const t=e.store(ld);return t.ee(((r,i)=>{const a=lh(i),o=$P(this.serializer,a);return t.put(o)}))}Ci(e,t){const r=t.store($l),i=[];return r.ee(((a,o)=>{const c=t.store(B0),u=(function(p){return p.document?new ke(Pt.fromString(p.document.name).popFirst(5)):p.noDocument?ke.fromSegments(p.noDocument.path):p.unknownDocument?ke.fromSegments(p.unknownDocument.path):Ve(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>se.waitFor(i)))}Fi(e,t){const r=t.store(Wi),i=nO(this.serializer),a=new Xw($v.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??gt();Xl(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),se.forEach(c,((u,d)=>{const h=new lr(d),p=Gv.wt(this.serializer,h),m=a.getIndexManager(h),b=qv.wt(h,this.serializer,m,a.referenceDelegate);return new rO(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new H1(t,Ii.ce),u).next()}))}))}}function mR(n){n.createObjectStore(cd,{keyPath:T7}).createIndex(Nw,A7,{unique:!0}),n.createObjectStore(ld,{keyPath:"targetId"}).createIndex(qM,S7,{unique:!0}),n.createObjectStore(cc)}const Co="IndexedDbPersistence",Vx=18e5,zx=5e3,Lx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",cq="main";class Ww{constructor(e,t,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Ww.v())throw new Re(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new WG(this,i),this.$i=t+cq,this.serializer=new qP(u),this.Ui=new Ho(this.$i,this.Ni,new lq(this.serializer)),this.hi=new zG,this.Pi=new HG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=nO(this.serializer),this.Ii=new VG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Cr(Co,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Re(me.FAILED_PRECONDITION,Lx);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ii(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Nm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(ll(e))return Ae(Co,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ae(Co,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Jf(e).get(Au).next((t=>se.resolve(this.es(t))))}ts(e){return Nm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Vx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Wn(t,ud);return r.J().next((i=>{const a=this.ss(i,Vx),o=i.filter((c=>a.indexOf(c)===-1));return se.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?se.resolve(!0):Jf(e).get(Au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,zx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Re(me.FAILED_PRECONDITION,Lx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Nm(e).J().next((r=>this.ss(r,zx).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ae(Co,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Cp,ud],(e=>{const t=new H1(e,Ii.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Nm(e).J().next((t=>this.ss(t,Vx).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return qv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new $G(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Gv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae(Co,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?G7:u===17?QM:u===16?F7:u===15?Ow:u===14?WM:u===13?XM:u===12?U7:u===11?KM:void Ve(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new H1(c,this.ci?this.ci.next():Ii.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Cr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Re(me.FAILED_PRECONDITION,LM);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return Jf(e).get(Au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,zx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Re(me.FAILED_PRECONDITION,Lx)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Jf(e).put(Au,t)}static v(){return Ho.v()}Zi(e){const t=Jf(e);return t.get(Au).next((r=>this.es(r)?(Ae(Co,"Releasing primary lease."),t.delete(Au)):se.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Cr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;fN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ae(Co,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Cr(Co,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Cr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Jf(n){return Wn(n,Cp)}function Nm(n){return Wn(n,ud)}function uq(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Qw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=gt(),i=gt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Qw(e,t.fromCache,r,i)}}class dq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class iO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return fN()?8:UM(Xn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new dq;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Mu()<=_t.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Pu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),se.resolve()):(Mu()<=_t.DEBUG&&Ae("QueryEngine","Query:",Pu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Mu()<=_t.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Pu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Di(t))):se.resolve())}ys(e,t){if(BI(t))return se.resolve(null);let r=Di(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=$0(t,null,"F"),r=Di(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=gt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,o,u.readTime)?this.ys(e,$0(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return BI(t)||i.isEqual(Xe.min())?se.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,r,i)?se.resolve(null):(Mu()<=_t.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pu(t)),this.vs(e,o,t,f7(i,Fh)).next((c=>c)))}))}Ds(e,t){let r=new Bt(vP(e));return t.forEach(((i,a)=>{Dp(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return Mu()<=_t.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Pu(t)),this.ps.getDocumentsMatchingQuery(e,t,oi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const Zw="LocalStore",fq=3e8;class hq{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new sn(it),this.xs=new Bs((a=>wc(a)),Ip),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function aO(n,e,t,r){return new hq(n,e,t,r)}async function sO(n,e){const t=st(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=gt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function pq(n,e){const t=st(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=se.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const S=d.docVersions.get(_);Fe(S!==null,48541),w.version.compareTo(S)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=gt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function oO(n){const e=st(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function gq(n,e){const t=st(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(Un.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,S,T){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=fq?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=si(),d=gt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(mq(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Xe.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return se.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function mq(n,e,t){let r=gt(),i=gt();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let o=si();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Xe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ae(Zw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function vq(n,e){const t=st(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=lc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function yq(n,e){const t=st(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,se.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new Es(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function s_(n,e,t){const r=st(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ll(o))throw o;Ae(Zw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function vR(n,e,t){const r=st(n);let i=Xe.min(),a=gt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=st(u),m=p.xs.get(h);return m!==void 0?se.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Di(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:Xe.min(),t?a:gt()))).next((c=>(bq(r,iG(e),c),{documents:c,Qs:a})))))}function bq(n,e,t){let r=n.Os.get(e)||Xe.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class yR{constructor(){this.activeTargetIds=uG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lO{constructor(){this.Mo=new yR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class xq{Oo(e){}shutdown(){}}const bR="ConnectivityMonitor";class xR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(bR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(bR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Mm=null;function o_(){return Mm===null?Mm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mm++,"0x"+Mm.toString(16)}const Bx="RestConnection",_q={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===F0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const o=o_(),c=this.zo(e,t.toUriEncodedString());Ae(Bx,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Rd(d);return this.Jo(e,c,u,r,h).then((p=>(Ae(Bx,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw xc(Bx,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,o){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=_q[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class Eq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const hr="WebChannelConnection";class Sq extends wq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const o=o_();return new Promise(((c,u)=>{const d=new IM;d.setWithCredentials(!0),d.listenOnce(RM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case a0.NO_ERROR:const p=d.getResponseJson();Ae(hr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case a0.TIMEOUT:Ae(hr,`RPC '${e}' ${o} timed out`),u(new Re(me.DEADLINE_EXCEEDED,"Request time out"));break;case a0.HTTP_ERROR:const m=d.getStatus();if(Ae(hr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(C)>=0?C:me.UNKNOWN})(_.status);u(new Re(w,_.message))}else u(new Re(me.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Re(me.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ae(hr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Ae(hr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=o_(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=NM(),c=kM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Ae(hr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new Eq({Yo:S=>{b?Ae(hr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Ae(hr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Ae(hr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),w=(S,T,C)=>{S.listen(T,(R=>{try{C(R)}catch(O){setTimeout((()=>{throw O}),0)}}))};return w(p,ah.EventType.OPEN,(()=>{b||(Ae(hr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,ah.EventType.CLOSE,(()=>{b||(b=!0,Ae(hr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,ah.EventType.ERROR,(S=>{b||(b=!0,xc(hr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),_.a_(new Re(me.UNAVAILABLE,"The operation could not be completed")))})),w(p,ah.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];Fe(!!T,16349);const C=T,R=C?.error||C[0]?.error;if(R){Ae(hr,`RPC '${e}' stream ${i} received error:`,R);const O=R.status;let P=(function(I){const k=Vn[I];if(k!==void 0)return DP(k)})(O),M=R.message;P===void 0&&(P=me.INTERNAL,M="Unknown error status: "+O+" with message "+R.message),b=!0,_.a_(new Re(P,M)),p.close()}else Ae(hr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,DM.STAT_EVENT,(S=>{S.stat===B1.PROXY?Ae(hr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===B1.NOPROXY&&Ae(hr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Tq(){return typeof window<"u"?window:null}function g0(){return typeof document<"u"?document:null}function Hv(n){return new AG(n,!0)}class cO{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ae("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const _R="PersistentStream";class uO{constructor(e,t,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new cO(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(Cr(t.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Re(me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(_R,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ae(_R,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Aq extends uO{constructor(e,t,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=RG(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Xe.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Xe.min():o.readTime?Dr(o.readTime):Xe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=t_(this.serializer),t.addTarget=(function(a,o){let c;const u=o.target;if(c=G0(u)?{documents:zP(a,u)}:{query:LP(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=MP(a,o.resumeToken);const d=J1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Xe.min())>0){c.readTime=md(a,o.snapshotVersion.toTimestamp());const d=J1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=kG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=t_(this.serializer),t.removeTarget=e,this.q_(t)}}class Cq extends uO{constructor(e,t,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Fe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Fe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Fe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=DG(e.writeResults,e.commitTime),r=Dr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=t_(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Y0(this.serializer,r)))};this.q_(t)}}class Iq{}class Rq extends Iq{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Re(me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,e_(t,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(me.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,e_(t,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Re(me.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Dq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Cr(t),this.aa=!1):Ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Cc="RemoteStore";class kq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{Oc(this)&&(Ae(Cc,"Restarting streams for network reachability change."),await(async function(u){const d=st(u);d.Ea.add(4),await Mp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Yv(d)})(this))}))})),this.Ra=new Dq(r,i)}}async function Yv(n){if(Oc(n))for(const e of n.da)await e(!0)}async function Mp(n){for(const e of n.da)await e(!1)}function dO(n,e){const t=st(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),nE(t)?tE(t):Od(t).O_()&&eE(t,e))}function Jw(n,e){const t=st(n),r=Od(t);t.Ia.delete(e),r.O_()&&fO(t,e),t.Ia.size===0&&(r.O_()?r.L_():Oc(t)&&t.Ra.set("Unknown"))}function eE(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Od(n).Y_(e)}function fO(n,e){n.Va.Ue(e),Od(n).Z_(e)}function tE(n){n.Va=new wG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Od(n).start(),n.Ra.ua()}function nE(n){return Oc(n)&&!Od(n).x_()&&n.Ia.size>0}function Oc(n){return st(n).Ea.size===0}function hO(n){n.Va=void 0}async function Nq(n){n.Ra.set("Online")}async function Mq(n){n.Ia.forEach(((e,t)=>{eE(n,e)}))}async function Pq(n,e){hO(n),nE(n)?(n.Ra.ha(e),tE(n)):n.Ra.set("Unknown")}async function Oq(n,e,t){if(n.Ra.set("Online"),e instanceof NP&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Ae(Cc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Z0(n,r)}else if(e instanceof h0?n.Va.Ze(e):e instanceof kP?n.Va.st(e):n.Va.tt(e),!t.isEqual(Xe.min()))try{const r=await oO(n.localStore);t.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Un.EMPTY_BYTE_STRING,h.snapshotVersion)),fO(a,u);const p=new Es(h.target,u,d,h.sequenceNumber);eE(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Ae(Cc,"Failed to raise snapshot:",r),await Z0(n,r)}}async function Z0(n,e,t){if(!ll(e))throw e;n.Ea.add(1),await Mp(n),n.Ra.set("Offline"),t||(t=()=>oO(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ae(Cc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Yv(n)}))}function pO(n,e){return e().catch((t=>Z0(n,t,e)))}async function Pp(n){const e=st(n),t=Zo(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:lc;for(;jq(e);)try{const i=await vq(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Vq(e,i)}catch(i){await Z0(e,i)}gO(e)&&mO(e)}function jq(n){return Oc(n)&&n.Ta.length<10}function Vq(n,e){n.Ta.push(e);const t=Zo(n);t.O_()&&t.X_&&t.ea(e.mutations)}function gO(n){return Oc(n)&&!Zo(n).x_()&&n.Ta.length>0}function mO(n){Zo(n).start()}async function zq(n){Zo(n).ra()}async function Lq(n){const e=Zo(n);for(const t of n.Ta)e.ea(t.mutations)}async function Bq(n,e,t){const r=n.Ta.shift(),i=Fw.from(r,e,t);await pO(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Pp(n)}async function Uq(n,e){e&&Zo(n).X_&&await(async function(r,i){if((function(o){return bG(o)&&o!==me.ABORTED})(i.code)){const a=r.Ta.shift();Zo(r).B_(),await pO(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Pp(r)}})(n,e),gO(n)&&mO(n)}async function wR(n,e){const t=st(n);t.asyncQueue.verifyOperationInProgress(),Ae(Cc,"RemoteStore received new credentials");const r=Oc(t);t.Ea.add(3),await Mp(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Yv(t)}async function Fq(n,e){const t=st(n);e?(t.Ea.delete(2),await Yv(t)):e||(t.Ea.add(2),await Mp(t),t.Ra.set("Unknown"))}function Od(n){return n.ma||(n.ma=(function(t,r,i){const a=st(t);return a.sa(),new Aq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:Nq.bind(null,n),t_:Mq.bind(null,n),r_:Pq.bind(null,n),H_:Oq.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),nE(n)?tE(n):n.Ra.set("Unknown")):(await n.ma.stop(),hO(n))}))),n.ma}function Zo(n){return n.fa||(n.fa=(function(t,r,i){const a=st(t);return a.sa(),new Cq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:zq.bind(null,n),r_:Uq.bind(null,n),ta:Lq.bind(null,n),na:Bq.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Pp(n)):(await n.fa.stop(),n.Ta.length>0&&(Ae(Cc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class rE{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Ba,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const o=Date.now()+r,c=new rE(e,t,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function iE(n,e){if(Cr("AsyncQueue",`${e}: ${n}`),ll(n))return new Re(me.UNAVAILABLE,`${e}: ${n}`);throw n}class td{static emptySet(e){return new td(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ke.comparator(t.key,r.key):(t,r)=>ke.comparator(t.key,r.key),this.keyedMap=sh(),this.sortedSet=new sn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof td)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new td;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class ER{constructor(){this.ga=new sn(ke.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class vd{constructor(e,t,r,i,a,o,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new vd(e,t,td.emptySet(t),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Gq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class qq{constructor(){this.queries=SR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=st(t),a=i.queries;i.queries=SR(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Re(me.ABORTED,"Firestore shutting down"))}}function SR(){return new Bs((n=>mP(n)),Lv)}async function aE(n,e){const t=st(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new Gq,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const c=iE(o,`Initialization of query '${Pu(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&oE(t)}async function sE(n,e){const t=st(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function $q(n,e){const t=st(n);let r=!1;for(const i of e){const a=i.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&oE(t)}function Hq(n,e,t){const r=st(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function oE(n){n.Ca.forEach((e=>{e.next()}))}var l_,TR;(TR=l_||(l_={})).Ma="default",TR.Cache="cache";class lE{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new vd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=vd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==l_.Cache}}class vO{constructor(e){this.key=e}}class yO{constructor(e){this.key=e}}class Yq{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=gt(),this.mutatedKeys=gt(),this.eu=vP(e),this.tu=new td(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new ER,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Dp(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,_){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:S})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new vd(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ER,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=gt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new yO(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new vO(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=gt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return vd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const cE="SyncEngine";class Kq{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Xq{constructor(e){this.key=e,this.hu=!1}}class Wq{constructor(e,t,r,i,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Bs((c=>mP(c)),Lv),this.Iu=new Map,this.Eu=new Set,this.du=new sn(ke.comparator),this.Au=new Map,this.Ru=new Kw,this.Vu={},this.mu=new Map,this.fu=Ac.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Qq(n,e,t=!0){const r=SO(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await bO(r,e,t,!0),i}async function Zq(n,e){const t=SO(n);await bO(t,e,!0,!1)}async function bO(n,e,t,r){const i=await yq(n.localStore,Di(e)),a=i.targetId,o=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await Jq(n,e,a,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&dO(n.remoteStore,i),c}async function Jq(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,S,T,C){let R=S.view.ru(T);R.Cs&&(R=await vR(w.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,R))));const O=C&&C.targetChanges.get(S.targetId),P=C&&C.targetMismatches.get(S.targetId)!=null,M=S.view.applyChanges(R,w.isPrimaryClient,O,P);return CR(w,S.targetId,M.au),M.snapshot})(n,p,m,b);const a=await vR(n.localStore,e,!0),o=new Yq(e,a.Qs),c=o.ru(a.documents),u=Np.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(c,n.isPrimaryClient,u);CR(n,t,d.au);const h=new Kq(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function e$(n,e,t){const r=st(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!Lv(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await s_(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Jw(r.remoteStore,i.targetId),c_(r,i.targetId)})).catch(Pc)):(c_(r,i.targetId),await s_(r.localStore,i.targetId,!0))}async function t$(n,e){const t=st(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Jw(t.remoteStore,r.targetId))}async function n$(n,e,t){const r=TO(n);try{const i=await(function(o,c){const u=st(o),d=pt.now(),h=c.reduce(((b,_)=>b.add(_.key)),gt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=si(),w=gt();return u.Ns.getEntries(b,h).next((S=>{_=S,_.forEach(((T,C)=>{C.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((S=>{p=S;const T=[];for(const C of c){const R=vG(C,p.get(C.key).overlayedDocument);R!=null&&T.push(new Us(C.key,R,oP(R.value.mapValue),Kn.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:bP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new sn(it)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await Op(r,i.changes),await Pp(r.remoteStore)}catch(i){const a=iE(i,"Failed to persist write");t.reject(a)}}async function xO(n,e){const t=st(n);try{const r=await gq(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=t.Au.get(a);o&&(Fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Fe(o.hu,14607):i.removedDocuments.size>0&&(Fe(o.hu,42227),o.hu=!1))})),await Op(t,r,e)}catch(r){await Pc(r)}}function AR(n,e,t){const r=st(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=st(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&oE(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function r$(n,e,t){const r=st(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new sn(ke.comparator);o=o.insert(a,yn.newNoDocument(a,Xe.min()));const c=gt().add(a),u=new Fv(Xe.min(),new Map,new sn(it),o,c);await xO(r,u),r.du=r.du.remove(a),r.Au.delete(e),uE(r)}else await s_(r.localStore,e,!1).then((()=>c_(r,e,t))).catch(Pc)}async function i$(n,e){const t=st(n),r=e.batch.batchId;try{const i=await pq(t.localStore,e);wO(t,r,null),_O(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Op(t,i)}catch(i){await Pc(i)}}async function a$(n,e,t){const r=st(n);try{const i=await(function(o,c){const u=st(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Fe(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);wO(r,e,t),_O(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Op(r,i)}catch(i){await Pc(i)}}function _O(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function wO(n,e,t){const r=st(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function c_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||EO(n,r)}))}function EO(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Jw(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),uE(n))}function CR(n,e,t){for(const r of t)r instanceof vO?(n.Ru.addReference(r.key,e),s$(n,r)):r instanceof yO?(Ae(cE,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||EO(n,r.key)):Ve(19791,{wu:r})}function s$(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ae(cE,"New document in limbo: "+t),n.Eu.add(r),uE(n))}function uE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ke(Pt.fromString(e)),r=n.fu.next();n.Au.set(r,new Xq(t)),n.du=n.du.insert(t,r),dO(n.remoteStore,new Es(Di(Rp(t.path)),r,"TargetPurposeLimboResolution",Ii.ce))}}async function Op(n,e,t){const r=st(n),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Qw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=st(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>se.forEach(d,(m=>se.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>se.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!ll(p))throw p;Ae(Zw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function o$(n,e){const t=st(n);if(!t.currentUser.isEqual(e)){Ae(cE,"User change. New user:",e.toKey());const r=await sO(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Re(me.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Op(t,r.Ls)}}function l$(n,e){const t=st(n),r=t.Au.get(e);if(r&&r.hu)return gt().add(r.key);{let i=gt();const a=t.Iu.get(e);if(!a)return i;for(const o of a){const c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function SO(n){const e=st(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=xO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=l$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r$.bind(null,e),e.Pu.H_=$q.bind(null,e.eventManager),e.Pu.yu=Hq.bind(null,e.eventManager),e}function TO(n){const e=st(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=a$.bind(null,e),e}class tp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hv(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return aO(this.persistence,new iO,e.initialUser,this.serializer)}Cu(e){return new Xw($v.mi,this.serializer)}Du(e){return new lO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tp.provider={build:()=>new tp};class c$ extends tp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Fe(this.persistence.referenceDelegate instanceof Q0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new JP(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?pr.withCacheSize(this.cacheSizeBytes):pr.DEFAULT;return new Xw((r=>Q0.mi(r,t)),this.serializer)}}class u$ extends tp{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await TO(this.xu.syncEngine),await Pp(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return aO(this.persistence,new iO,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new JP(r,e.asyncQueue,t)}Mu(e,t){const r=new m7(t,this.persistence);return new g7(e.asyncQueue,r)}Cu(e){const t=uq(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?pr.withCacheSize(this.cacheSizeBytes):pr.DEFAULT;return new Ww(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Tq(),g0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new lO}}class J0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>AR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=o$.bind(null,this.syncEngine),await Fq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new qq})()}createDatastore(e){const t=Hv(e.databaseInfo.databaseId),r=(function(a){return new Sq(a)})(e.databaseInfo);return(function(a,o,c,u){return new Rq(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,o,c){return new kq(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>AR(this.syncEngine,t,0)),(function(){return xR.v()?new xR:new xq})())}createSyncEngine(e,t){return(function(i,a,o,c,u,d,h){const p=new Wq(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=st(t);Ae(Cc,"RemoteStore shutting down."),r.Ea.add(5),await Mp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}J0.provider={build:()=>new J0};class dE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Cr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Jo="FirestoreClient";class d${constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=lr.UNAUTHENTICATED,this.clientId=Rw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Ae(Jo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Ae(Jo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ba;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=iE(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ux(n,e){n.asyncQueue.verifyOperationInProgress(),Ae(Jo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await sO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function IR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await f$(n);Ae(Jo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>wR(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>wR(e.remoteStore,i))),n._onlineComponents=e}async function f$(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ae(Jo,"Using user provided OfflineComponentProvider");try{await Ux(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===me.FAILED_PRECONDITION||i.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;xc("Error using user provided cache. Falling back to memory cache: "+t),await Ux(n,new tp)}}else Ae(Jo,"Using default OfflineComponentProvider"),await Ux(n,new c$(void 0));return n._offlineComponents}async function AO(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ae(Jo,"Using user provided OnlineComponentProvider"),await IR(n,n._uninitializedComponentsProvider._online)):(Ae(Jo,"Using default OnlineComponentProvider"),await IR(n,new J0))),n._onlineComponents}function h$(n){return AO(n).then((e=>e.syncEngine))}async function ev(n){const e=await AO(n),t=e.eventManager;return t.onListen=Qq.bind(null,e.syncEngine),t.onUnlisten=e$.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Zq.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=t$.bind(null,e.syncEngine),t}function p$(n,e,t={}){const r=new Ba;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new dE({next:m=>{h.Nu(),o.enqueueAndForget((()=>sE(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Re(me.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Re(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new lE(Rp(c.path),h,{includeMetadataChanges:!0,qa:!0});return aE(a,p)})(await ev(n),n.asyncQueue,e,t,r))),r.promise}function g$(n,e,t={}){const r=new Ba;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new dE({next:m=>{h.Nu(),o.enqueueAndForget((()=>sE(a,p))),m.fromCache&&u.source==="server"?d.reject(new Re(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new lE(c,h,{includeMetadataChanges:!0,qa:!0});return aE(a,p)})(await ev(n),n.asyncQueue,e,t,r))),r.promise}function CO(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const RR=new Map;const IO="firestore.googleapis.com",DR=!0;class kR{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Re(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=IO,this.ssl=DR}else this.host=e.host,this.ssl=e.ssl??DR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=XP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YG)throw new Re(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}d7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CO(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Re(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Re(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Re(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new t7;switch(r.type){case"firstParty":return new a7(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Re(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=RR.get(t);r&&(Ae("ComponentProvider","Removing Datastore"),RR.delete(t),r.terminate())})(this),Promise.resolve()}}function m$(n,e,t,r={}){n=vr(n,Kv);const i=Rd(e),a=n._getSettings(),o={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(cN(`https://${c}`),uN("Firestore",!0)),a.host!==IO&&a.host!==c&&xc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!Xo(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=lr.MOCK_USER;else{d=Bz(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Re(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new lr(p)}n._authCredentials=new n7(new PM(d,h))}}class Fs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Fs(this.firestore,e,this._query)}}class bn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bn(this.firestore,e,this._key)}toJSON(){return{type:bn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ap(t,bn._jsonSchema))return new bn(e,r||null,new ke(Pt.fromString(t.referencePath)))}}bn._jsonSchemaVersion="firestore/documentReference/1.0",bn._jsonSchema={type:Bn("string",bn._jsonSchemaVersion),referencePath:Bn("string")};class Yo extends Fs{constructor(e,t,r){super(e,t,Rp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new ke(e))}withConverter(e){return new Yo(this.firestore,e,this._path)}}function Sr(n,e,...t){if(n=Wt(n),jM("collection","path",e),n instanceof Kv){const r=Pt.fromString(e,...t);return _I(r),new Yo(n,null,r)}{if(!(n instanceof bn||n instanceof Yo))throw new Re(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pt.fromString(e,...t));return _I(r),new Yo(n.firestore,null,r)}}function St(n,e,...t){if(n=Wt(n),arguments.length===1&&(e=Rw.newId()),jM("doc","path",e),n instanceof Kv){const r=Pt.fromString(e,...t);return xI(r),new bn(n,null,new ke(r))}{if(!(n instanceof bn||n instanceof Yo))throw new Re(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Pt.fromString(e,...t));return xI(r),new bn(n.firestore,n instanceof Yo?n.converter:null,new ke(r))}}const NR="AsyncQueue";class MR{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new cO(this,"async_queue_retry"),this._c=()=>{const r=g0();r&&Ae(NR,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=g0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=g0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ba;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ll(e))throw e;Ae(NR,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Cr("INTERNAL UNHANDLED ERROR: ",PR(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=rE.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Ve(47125,{Pc:PR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function PR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function OR(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class sa extends Kv{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new MR,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new MR(e),this._firestoreClient=void 0,await e}}}function v$(n,e){const t=typeof n=="object"?n:yN(),r=typeof n=="string"?n:F0,i=hw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=zz("firestore");a&&m$(i,...a)}return i}function jp(n){if(n._terminated)throw new Re(me.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||RO(n),n._firestoreClient}function RO(n){const e=n._freezeSettings(),t=(function(i,a,o,c){return new $7(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,CO(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new d$(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}function y$(n,e){xc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return b$(n,J0.provider,{build:r=>new u$(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function b$(n,e,t){if((n=vr(n,sa))._firestoreClient||n._terminated)throw new Re(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Re(me.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},RO(n)}class Ci{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ci(Un.fromBase64String(e))}catch(t){throw new Re(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ci(Un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ci._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ap(e,Ci._jsonSchema))return Ci.fromBase64String(e.bytes)}}Ci._jsonSchemaVersion="firestore/bytes/1.0",Ci._jsonSchema={type:Bn("string",Ci._jsonSchemaVersion),bytes:Bn("string")};class Vp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Re(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xv{constructor(e){this._methodName=e}}class Ua{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return it(this._lat,e._lat)||it(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ua._jsonSchemaVersion}}static fromJSON(e){if(Ap(e,Ua._jsonSchema))return new Ua(e.latitude,e.longitude)}}Ua._jsonSchemaVersion="firestore/geoPoint/1.0",Ua._jsonSchema={type:Bn("string",Ua._jsonSchemaVersion),latitude:Bn("number"),longitude:Bn("number")};class Fa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Fa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ap(e,Fa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Fa(e.vectorValues);throw new Re(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fa._jsonSchemaVersion="firestore/vectorValue/1.0",Fa._jsonSchema={type:Bn("string",Fa._jsonSchemaVersion),vectorValues:Bn("object")};const x$=/^__.*__$/;class _${constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Us(e,this.data,this.fieldMask,t,this.fieldTransforms):new Pd(e,this.data,t,this.fieldTransforms)}}class DO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Us(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function kO(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:n})}}class Wv{constructor(e,t,r,i,a,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Wv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return tv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(kO(this.Ac)&&x$.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class w${constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Hv(e)}Cc(e,t,r,i=!1){return new Wv({Ac:e,methodName:t,Dc:r,path:dn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zp(n){const e=n._freezeSettings(),t=Hv(n._databaseId);return new w$(n._databaseId,!!e.ignoreUndefinedProperties,t)}function fE(n,e,t,r,i,a={}){const o=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);pE("Data must be an object, but it was:",o,r);const c=PO(r,o);let u,d;if(a.merge)u=new Br(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=u_(e,p,t);if(!o.contains(m))throw new Re(me.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);jO(h,m)||h.push(m)}u=new Br(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new _$(new gr(c),u,d)}class Lp extends Xv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lp}}function E$(n,e,t){return new Wv({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class hE extends Xv{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=E$(this,e,!0),r=this.vc.map((a=>jd(a,t))),i=new Ec(r);return new AP(e.path,i)}isEqual(e){return e instanceof hE&&Xo(this.vc,e.vc)}}function NO(n,e,t,r){const i=n.Cc(1,e,t);pE("Data must be an object, but it was:",i,r);const a=[],o=gr.empty();cl(r,((u,d)=>{const h=gE(e,u,t);d=Wt(d);const p=i.yc(h);if(d instanceof Lp)a.push(h);else{const m=jd(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new Br(a);return new DO(o,c,i.fieldTransforms)}function MO(n,e,t,r,i,a){const o=n.Cc(1,e,t),c=[u_(e,r,t)],u=[i];if(a.length%2!=0)throw new Re(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(u_(e,a[m])),u.push(a[m+1]);const d=[],h=gr.empty();for(let m=c.length-1;m>=0;--m)if(!jO(d,c[m])){const b=c[m];let _=u[m];_=Wt(_);const w=o.yc(b);if(_ instanceof Lp)d.push(b);else{const S=jd(_,w);S!=null&&(d.push(b),h.set(b,S))}}const p=new Br(d);return new DO(h,p,o.fieldTransforms)}function S$(n,e,t,r=!1){return jd(t,n.Cc(r?4:3,e))}function jd(n,e){if(OO(n=Wt(n)))return pE("Unsupported field value:",e,n),PO(n,e);if(n instanceof Xv)return(function(r,i){if(!kO(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=jd(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=Wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return dG(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=pt.fromDate(r);return{timestampValue:md(i.serializer,a)}}if(r instanceof pt){const a=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:md(i.serializer,a)}}if(r instanceof Ua)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ci)return{bytesValue:MP(i.serializer,r._byteString)};if(r instanceof bn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:$w(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Fa)return(function(o,c){return{mapValue:{fields:{[Vw]:{stringValue:zw},[dd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Bw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${kv(r)}`)})(n,e)}function PO(n,e){const t={};return ZM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cl(n,((r,i)=>{const a=jd(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function OO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pt||n instanceof Ua||n instanceof Ci||n instanceof bn||n instanceof Xv||n instanceof Fa)}function pE(n,e,t){if(!OO(t)||!VM(t)){const r=kv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function u_(n,e,t){if((e=Wt(e))instanceof Vp)return e._internalPath;if(typeof e=="string")return gE(n,e);throw tv("Field path arguments must be of type string or ",n,!1,void 0,t)}const T$=new RegExp("[~\\*/\\[\\]]");function gE(n,e,t){if(e.search(T$)>=0)throw tv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vp(...e.split("."))._internalPath}catch{throw tv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function tv(n,e,t,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Re(me.INVALID_ARGUMENT,c+n+u)}function jO(n,e){return n.some((t=>t.isEqual(e)))}class VO{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new A$(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Qv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class A$ extends VO{data(){return super.data()}}function Qv(n,e){return typeof e=="string"?gE(n,e):e instanceof Vp?e._internalPath:e._delegate._internalPath}function zO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Re(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mE{}class vE extends mE{}function oa(n,e,...t){let r=[];e instanceof mE&&r.push(e),r=r.concat(t),(function(a){const o=a.filter((u=>u instanceof yE)).length,c=a.filter((u=>u instanceof Zv)).length;if(o>1||o>0&&c>0)throw new Re(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Zv extends vE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Zv(e,t,r)}_apply(e){const t=this._parse(e);return LO(e._query,t),new Fs(e.firestore,e.converter,Z1(e._query,t))}_parse(e){const t=zp(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Re(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){zR(p,h);const _=[];for(const w of p)_.push(VR(u,a,w));m={arrayValue:{values:_}}}else m=VR(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||zR(p,h),m=S$(c,o,p,h==="in"||h==="not-in");return wt.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function C$(n,e,t){const r=e,i=Qv("where",n);return Zv._create(i,r,t)}class yE extends mE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new yE(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Lt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)LO(o,u),o=Z1(o,u)})(e._query,t),new Fs(e.firestore,e.converter,Z1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class bE extends vE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new bE(e,t)}_apply(e){const t=(function(i,a,o){if(i.startAt!==null)throw new Re(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Re(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zh(a,o)})(e._query,this._field,this._direction);return new Fs(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new Md(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function el(n,e="asc"){const t=e,r=Qv("orderBy",n);return bE._create(r,t)}class xE extends vE{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new xE(e,t,r)}_apply(e){return new Fs(e.firestore,e.converter,$0(e._query,this._limit,this._limitType))}}function jR(n){return xE._create("limit",n,"F")}function VR(n,e,t){if(typeof(t=Wt(t))=="string"){if(t==="")throw new Re(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gP(e)&&t.indexOf("/")!==-1)throw new Re(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Pt.fromString(t));if(!ke.isDocumentKey(r))throw new Re(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wh(n,new ke(r))}if(t instanceof bn)return Wh(n,t._key);throw new Re(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${kv(t)}.`)}function zR(n,e){if(!Array.isArray(n)||n.length===0)throw new Re(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function LO(n,e){const t=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Re(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class I${convertValue(e,t="none"){switch(Wo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ps(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return cl(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[dd].arrayValue?.values?.map((r=>nn(r.doubleValue)));return new Fa(t)}convertGeoPoint(e){return new Ua(nn(e.latitude),nn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Vv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Kh(e));default:return null}}convertTimestamp(e){const t=Ms(e);return new pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Pt.fromString(e);Fe(GP(r),9688,{name:e});const i=new _c(r.get(1),r.get(3)),a=new ke(r.popFirst(5));return i.isEqual(t)||Cr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function _E(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class ch{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dc extends VO{constructor(e,t,r,i,a,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new m0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Qv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=dc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}dc._jsonSchemaVersion="firestore/documentSnapshot/1.0",dc._jsonSchema={type:Bn("string",dc._jsonSchemaVersion),bundleSource:Bn("string","DocumentSnapshot"),bundleName:Bn("string"),bundle:Bn("string")};class m0 extends dc{data(e={}){return super.data(e)}}class fc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ch(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new m0(this._firestore,this._userDataWriter,r.key,r,new ch(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new m0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ch(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new m0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ch(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:R$(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Rw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function R$(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:n})}}function Fx(n){n=vr(n,bn);const e=vr(n.firestore,sa);return p$(jp(e),n._key).then((t=>BO(e,n,t)))}fc._jsonSchemaVersion="firestore/querySnapshot/1.0",fc._jsonSchema={type:Bn("string",fc._jsonSchemaVersion),bundleSource:Bn("string","QuerySnapshot"),bundleName:Bn("string"),bundle:Bn("string")};class wE extends I${constructor(e){super(),this.firestore=e}convertBytes(e){return new Ci(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,t)}}function Zi(n){n=vr(n,Fs);const e=vr(n.firestore,sa),t=jp(e),r=new wE(e);return zO(n._query),g$(t,n._query).then((i=>new fc(e,r,n,i)))}function ai(n,e,t){n=vr(n,bn);const r=vr(n.firestore,sa),i=_E(n.converter,e,t);return Bp(r,[fE(zp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Kn.none())])}function Ma(n,e,t,...r){n=vr(n,bn);const i=vr(n.firestore,sa),a=zp(i);let o;return o=typeof(e=Wt(e))=="string"||e instanceof Vp?MO(a,"updateDoc",n._key,e,t,r):NO(a,"updateDoc",n._key,e),Bp(i,[o.toMutation(n._key,Kn.exists(!0))])}function Ji(n){return Bp(vr(n.firestore,sa),[new kp(n._key,Kn.none())])}function Jv(n,e){const t=vr(n.firestore,sa),r=St(n),i=_E(n.converter,e);return Bp(t,[fE(zp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Kn.exists(!1))]).then((()=>r))}function Vd(n,...e){n=Wt(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||OR(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(OR(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(n instanceof bn)o=vr(n.firestore,sa),c=Rp(n._key.path),a={next:u=>{e[r]&&e[r](BO(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=vr(n,Fs);o=vr(u.firestore,sa),c=u._query;const d=new wE(o);a={next:h=>{e[r]&&e[r](new fc(o,d,u,h))},error:e[r+1],complete:e[r+2]},zO(n._query)}return(function(d,h,p,m){const b=new dE(m),_=new lE(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>aE(await ev(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>sE(await ev(d),_)))}})(jp(o),c,i,a)}function Bp(n,e){return(function(r,i){const a=new Ba;return r.asyncQueue.enqueueAndForget((async()=>n$(await h$(r),i,a))),a.promise})(jp(n),e)}function BO(n,e,t){const r=t.docs.get(e._key),i=new wE(n);return new dc(n,i,e._key,r,new ch(t.hasPendingWrites,t.fromCache),e.converter)}class D${constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zp(e)}set(e,t,r){this._verifyNotCommitted();const i=Gx(e,this._firestore),a=_E(i.converter,t,r),o=fE(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Kn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Gx(e,this._firestore);let o;return o=typeof(t=Wt(t))=="string"||t instanceof Vp?MO(this._dataReader,"WriteBatch.update",a._key,t,r,i):NO(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,Kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Gx(e,this._firestore);return this._mutations=this._mutations.concat(new kp(t._key,Kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Re(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Gx(n,e){if((n=Wt(n)).firestore!==e)throw new Re(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function LR(){return new Lp("deleteField")}function k$(...n){return new hE("arrayUnion",n)}function UO(n){return jp(n=vr(n,sa)),new D$(n,(e=>Bp(n,e)))}(function(e,t=!0){(function(i){Nd=i})(Dd),id(new gc("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new sa(new r7(r.getProvider("auth-internal")),new s7(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Re(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _c(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),qo(mI,vI,e),qo(mI,vI,"esm2020")})();const N$={apiKey:"AIzaSyCRHcpbVGQrEZUVdO_Ucn4ZarwwPsrON40",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:0ae73943f9058a4342aba9",measurementId:"G-VMP5DF6273"},FO=vN(N$),Yi=kB(FO),tt=v$(FO);y$(tt).catch(n=>{n.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",n)});const BR=()=>({url:window.location.origin+"/personal-budget-pwa/",handleCodeInApp:!1}),Pm=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),ta=Cw()(AM(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await p9(Yi,e,t)).user;if(console.log(` Checking email verification for: ${i.email}`),console.log(" emailVerified status:",i.emailVerified),console.log(" Firebase user object:",{uid:i.uid,email:i.email,emailVerified:i.emailVerified,metadata:i.metadata}),!i.emailVerified)return console.log(` BLOCKING LOGIN: Email not verified for ${i.email}`),await $2(Yi),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;console.log(` EMAIL VERIFIED: Allowing login for ${i.email}`);const a=Pm(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await h9(Yi,e,t)).user;await m9(a,{displayName:r}),await q2(a,BR());const o=Pm(a);return n({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await $2(Yi),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await d9(Yi,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=Yi.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await q2(e,BR()),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=ta.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},checkVerificationStatus:async()=>{const e=Yi.currentUser;if(!e)return!1;try{await e.reload();const t=Yi.currentUser;if(t?.emailVerified){const r=Pm(t);return n({currentUser:r,isAuthenticated:!0,lastAuthTime:Date.now()}),console.log(` Email verified for: ${t.email}`),!0}return!1}catch(t){return console.error("Error checking verification status:",t),!1}},deleteAccount:async e=>{const t=Yi.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=Nc.credential(t.email,e);return await c9(t,r),await x9(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>ta.getState().isInitialized?()=>{}:(n({isInitialized:!1}),b9(Yi,async r=>{const i=Date.now(),a=ta.getState(),o=r?Pm(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;if(n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m)if(console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"),console.log(" Onboarding check:",{isVerified:h,shouldGrantOfflineAccess:d,willCheckOnboarding:h&&!d}),h&&!d){console.log(" Loading budgetStore to check onboarding...");const b=await At(()=>Promise.resolve().then(()=>Jee),[]).then(_=>_.useBudgetStore.getState());console.log(" Calling budgetStore.checkAndStartOnboarding()..."),b.checkAndStartOnboarding()}else console.log(" Skipping onboarding check (not verified or offline grace period)");else console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),zt=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:ta},Symbol.toStringTag,{value:"Module"})),GO=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],M$=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=GO.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},EE=n=>{const e=GO.map(i=>({...i,met:i.regex.test(n)})),t=M$(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},P$=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=EE(n);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},O$=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=EE(n);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(MU,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(Dv,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},j$=()=>{const[n,e]=U.useState(""),[t,r]=U.useState(""),[i,a]=U.useState(""),[o,c]=U.useState(!1),[u,d]=U.useState(!1),[h,p]=U.useState(!1),[m,b]=U.useState(!1),{login:_,register:w,sendPasswordReset:S,isLoading:T,loginError:C,clearError:R}=ta(),O=EE(t),P=async A=>{if(A.preventDefault(),R(),n.trim()&&t.trim())if(u){if(!i.trim()||!O.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},M=async A=>{A.preventDefault(),n.trim()&&await S(n.trim())&&b(!0)};return U.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:M,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(z1,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(z1,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:n})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(yc,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(yc,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:P,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:t,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!O.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx(XU,{className:"h-5 w-5"}):v.jsx(QU,{className:"h-5 w-5"})})]}),u&&t&&v.jsx("div",{className:"mt-2",children:v.jsx(P$,{password:t})}),u&&t&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(O$,{password:t})})]}),C&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!O.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(BF,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},qO=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(!1),{currentUser:i,resendEmailVerification:a,checkVerificationStatus:o,logout:c,loginError:u}=ta();U.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]),U.useEffect(()=>{const p=()=>{console.log("Window focused, checking verification status..."),o()};return window.addEventListener("focus",p),()=>window.removeEventListener("focus",p)},[o]);const d=async()=>{e(!0),r(!1);const p=await a();e(!1),p&&(r(!0),setTimeout(()=>r(!1),3e3))},h=async()=>{await c()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(z1,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(V1,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),u&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:u}),t&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:d,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?v.jsxs(v.Fragment,{children:[v.jsx(Lh,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(Lh,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:h,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(yc,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},$O=({message:n="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(Lh,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(Rv,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),SE=U.createContext({});function ey(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const TE=typeof window<"u",AE=TE?U.useLayoutEffect:U.useEffect,ty=U.createContext(null);function CE(n,e){n.indexOf(e)===-1&&n.push(e)}function IE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Os=(n,e,t)=>t>e?e:t<n?n:t;let RE=()=>{};const js={},HO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function YO(n){return typeof n=="object"&&n!==null}const KO=n=>/^0[^.\s]+$/u.test(n);function DE(n){let e;return()=>(e===void 0&&(e=n()),e)}const ki=n=>n,V$=(n,e)=>t=>e(n(t)),Up=(...n)=>n.reduce(V$),np=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class kE{constructor(){this.subscriptions=[]}add(e){return CE(this.subscriptions,e),()=>IE(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ga=n=>n*1e3,Ri=n=>n/1e3;function XO(n,e){return e?n*(1e3/e):0}const WO=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,z$=1e-7,L$=12;function B$(n,e,t,r,i){let a,o,c=0;do o=e+(t-e)/2,a=WO(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>z$&&++c<L$);return o}function Fp(n,e,t,r){if(n===e&&t===r)return ki;const i=a=>B$(a,0,1,n,t);return a=>a===0||a===1?a:WO(i(a),e,r)}const QO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,ZO=n=>e=>1-n(1-e),JO=Fp(.33,1.53,.69,.99),NE=ZO(JO),e4=QO(NE),t4=n=>(n*=2)<1?.5*NE(n):.5*(2-Math.pow(2,-10*(n-1))),ME=n=>1-Math.sin(Math.acos(n)),n4=ZO(ME),r4=QO(ME),U$=Fp(.42,0,1,1),F$=Fp(0,0,.58,1),i4=Fp(.42,0,.58,1),G$=n=>Array.isArray(n)&&typeof n[0]!="number",a4=n=>Array.isArray(n)&&typeof n[0]=="number",q$={linear:ki,easeIn:U$,easeInOut:i4,easeOut:F$,circIn:ME,circInOut:r4,circOut:n4,backIn:NE,backInOut:e4,backOut:JO,anticipate:t4},$$=n=>typeof n=="string",UR=n=>{if(a4(n)){RE(n.length===4);const[e,t,r,i]=n;return Fp(e,t,r,i)}else if($$(n))return q$[n];return n},Om=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function H$(n,e){let t=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const Y$=40;function s4(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=Om.reduce((R,O)=>(R[O]=H$(a),R),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=o,w=()=>{const R=js.useManualTiming?i.timestamp:performance.now();t=!1,js.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(R-i.timestamp,Y$),1)),i.timestamp=R,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},S=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:Om.reduce((R,O)=>{const P=o[O];return R[O]=(M,A=!1,I=!1)=>(t||S(),P.schedule(M,A,I)),R},{}),cancel:R=>{for(let O=0;O<Om.length;O++)o[Om[O]].cancel(R)},state:i,steps:o}}const{schedule:an,cancel:tl,state:or,steps:qx}=s4(typeof requestAnimationFrame<"u"?requestAnimationFrame:ki,!0);let v0;function K$(){v0=void 0}const Ur={now:()=>(v0===void 0&&Ur.set(or.isProcessing||js.useManualTiming?or.timestamp:performance.now()),v0),set:n=>{v0=n,queueMicrotask(K$)}},o4=n=>e=>typeof e=="string"&&e.startsWith(n),PE=o4("--"),X$=o4("var(--"),OE=n=>X$(n)?W$.test(n.split("/*")[0].trim()):!1,W$=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,zd={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},rp={...zd,transform:n=>Os(0,1,n)},jm={...zd,default:1},Th=n=>Math.round(n*1e5)/1e5,jE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Q$(n){return n==null}const Z$=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,VE=(n,e)=>t=>!!(typeof t=="string"&&Z$.test(t)&&t.startsWith(n)||e&&!Q$(t)&&Object.prototype.hasOwnProperty.call(t,e)),l4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(jE);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},J$=n=>Os(0,255,n),$x={...zd,transform:n=>Math.round(J$(n))},rc={test:VE("rgb","red"),parse:l4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+$x.transform(n)+", "+$x.transform(e)+", "+$x.transform(t)+", "+Th(rp.transform(r))+")"};function eH(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const d_={test:VE("#"),parse:eH,transform:rc.transform},Gp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Do=Gp("deg"),qa=Gp("%"),nt=Gp("px"),tH=Gp("vh"),nH=Gp("vw"),FR={...qa,parse:n=>qa.parse(n)/100,transform:n=>qa.transform(n*100)},Bu={test:VE("hsl","hue"),parse:l4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+qa.transform(Th(e))+", "+qa.transform(Th(t))+", "+Th(rp.transform(r))+")"},zn={test:n=>rc.test(n)||d_.test(n)||Bu.test(n),parse:n=>rc.test(n)?rc.parse(n):Bu.test(n)?Bu.parse(n):d_.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?rc.transform(n):Bu.transform(n),getAnimatableNone:n=>{const e=zn.parse(n);return e.alpha=0,zn.transform(e)}},rH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function iH(n){return isNaN(n)&&typeof n=="string"&&(n.match(jE)?.length||0)+(n.match(rH)?.length||0)>0}const c4="number",u4="color",aH="var",sH="var(",GR="${}",oH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ip(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(oH,u=>(zn.test(u)?(r.color.push(a),i.push(u4),t.push(zn.parse(u))):u.startsWith(sH)?(r.var.push(a),i.push(aH),t.push(u)):(r.number.push(a),i.push(c4),t.push(parseFloat(u))),++a,GR)).split(GR);return{values:t,split:c,indexes:r,types:i}}function d4(n){return ip(n).values}function f4(n){const{split:e,types:t}=ip(n),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=t[o];c===c4?a+=Th(i[o]):c===u4?a+=zn.transform(i[o]):a+=i[o]}return a}}const lH=n=>typeof n=="number"?0:zn.test(n)?zn.getAnimatableNone(n):n;function cH(n){const e=d4(n);return f4(n)(e.map(lH))}const nl={test:iH,parse:d4,createTransformer:f4,getAnimatableNone:cH};function Hx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function uH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=Hx(u,c,n+1/3),a=Hx(u,c,n),o=Hx(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function nv(n,e){return t=>t>0?e:n}const fn=(n,e,t)=>n+(e-n)*t,Yx=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},dH=[d_,rc,Bu],fH=n=>dH.find(e=>e.test(n));function qR(n){const e=fH(n);if(!e)return!1;let t=e.parse(n);return e===Bu&&(t=uH(t)),t}const $R=(n,e)=>{const t=qR(n),r=qR(e);if(!t||!r)return nv(n,e);const i={...t};return a=>(i.red=Yx(t.red,r.red,a),i.green=Yx(t.green,r.green,a),i.blue=Yx(t.blue,r.blue,a),i.alpha=fn(t.alpha,r.alpha,a),rc.transform(i))},f_=new Set(["none","hidden"]);function hH(n,e){return f_.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function pH(n,e){return t=>fn(n,e,t)}function zE(n){return typeof n=="number"?pH:typeof n=="string"?OE(n)?nv:zn.test(n)?$R:vH:Array.isArray(n)?h4:typeof n=="object"?zn.test(n)?$R:gH:nv}function h4(n,e){const t=[...n],r=t.length,i=n.map((a,o)=>zE(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)t[o]=i[o](a);return t}}function gH(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=zE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function mH(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=n.indexes[a][r[a]],c=n.values[o]??0;t[i]=c,r[a]++}return t}const vH=(n,e)=>{const t=nl.createTransformer(e),r=ip(n),i=ip(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?f_.has(n)&&!i.values.length||f_.has(e)&&!r.values.length?hH(n,e):Up(h4(mH(r,i),i.values),t):nv(n,e)};function p4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?fn(n,e,t):zE(n)(n,e)}const yH=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>an.update(e,t),stop:()=>tl(e),now:()=>or.isProcessing?or.timestamp:Ur.now()}},g4=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},rv=2e4;function LE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<rv;)e+=t,r=n.next(e);return e>=rv?1/0:e}function bH(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(LE(r),rv);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Ri(i)}}const xH=5;function m4(n,e,t){const r=Math.max(e-xH,0);return XO(t-n(r),e-r)}const vn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Kx=.001;function _H({duration:n=vn.duration,bounce:e=vn.bounce,velocity:t=vn.velocity,mass:r=vn.mass}){let i,a,o=1-e;o=Os(vn.minDamping,vn.maxDamping,o),n=Os(vn.minDuration,vn.maxDuration,Ri(n)),o<1?(i=d=>{const h=d*o,p=h*n,m=h-t,b=h_(d,o),_=Math.exp(-p);return Kx-m/b*_},a=d=>{const p=d*o*n,m=p*t+t,b=Math.pow(o,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=h_(Math.pow(d,2),o);return(-i(d)+Kx>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-Kx+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=EH(i,a,c);if(n=Ga(n),isNaN(u))return{stiffness:vn.stiffness,damping:vn.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const wH=12;function EH(n,e,t){let r=t;for(let i=1;i<wH;i++)r=r-n(r)/e(r);return r}function h_(n,e){return n*Math.sqrt(1-e*e)}const SH=["duration","bounce"],TH=["stiffness","damping","mass"];function HR(n,e){return e.some(t=>n[t]!==void 0)}function AH(n){let e={velocity:vn.velocity,stiffness:vn.stiffness,damping:vn.damping,mass:vn.mass,isResolvedFromDuration:!1,...n};if(!HR(n,TH)&&HR(n,SH))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*Os(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:vn.mass,stiffness:i,damping:a}}else{const t=_H(n);e={...e,...t,mass:vn.mass},e.isResolvedFromDuration=!0}return e}function iv(n=vn.visualDuration,e=vn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=AH({...t,velocity:-Ri(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),S=o-a,T=Ri(Math.sqrt(u/h)),C=Math.abs(S)<5;r||(r=C?vn.restSpeed.granular:vn.restSpeed.default),i||(i=C?vn.restDelta.granular:vn.restDelta.default);let R;if(w<1){const P=h_(T,w);R=M=>{const A=Math.exp(-w*T*M);return o-A*((_+w*T*S)/P*Math.sin(P*M)+S*Math.cos(P*M))}}else if(w===1)R=P=>o-Math.exp(-T*P)*(S+(_+T*S)*P);else{const P=T*Math.sqrt(w*w-1);R=M=>{const A=Math.exp(-w*T*M),I=Math.min(P*M,300);return o-A*((_+w*T*S)*Math.sinh(I)+P*S*Math.cosh(I))/P}}const O={calculatedDuration:b&&p||null,next:P=>{const M=R(P);if(b)c.done=P>=p;else{let A=P===0?_:0;w<1&&(A=P===0?Ga(_):m4(R,P,M));const I=Math.abs(A)<=r,k=Math.abs(o-M)<=i;c.done=I&&k}return c.value=c.done?o:M,c},toString:()=>{const P=Math.min(LE(O),rv),M=g4(A=>O.next(P*A).value,P,30);return P+"ms "+M},toTransition:()=>{}};return O}iv.applyToOptions=n=>{const e=bH(n,100,iv);return n.ease=e.ease,n.duration=Ga(e.duration),n.type="keyframes",n};function p_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=I=>c!==void 0&&I<c||u!==void 0&&I>u,_=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let w=t*e;const S=p+w,T=o===void 0?S:o(S);T!==S&&(w=T-p);const C=I=>-w*Math.exp(-I/r),R=I=>T+C(I),O=I=>{const k=C(I),z=R(I);m.done=Math.abs(k)<=d,m.value=m.done?T:z};let P,M;const A=I=>{b(m.value)&&(P=I,M=iv({keyframes:[m.value,_(m.value)],velocity:m4(R,I,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:I=>{let k=!1;return!M&&P===void 0&&(k=!0,O(I),A(I)),P!==void 0&&I>=P?M.next(I-P):(!k&&O(I),m)}}}function CH(n,e,t){const r=[],i=t||js.mix||p4,a=n.length-1;for(let o=0;o<a;o++){let c=i(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||ki:e;c=Up(u,c)}r.push(c)}return r}function IH(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(RE(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=CH(e,r,i),u=c.length,d=h=>{if(o&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=np(n[p],n[p+1],h);return c[p](m)};return t?h=>d(Os(n[0],n[a-1],h)):d}function RH(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=np(0,e,r);n.push(fn(t,1,i))}}function DH(n){const e=[0];return RH(e,n.length-1),e}function kH(n,e){return n.map(t=>t*e)}function NH(n,e){return n.map(()=>e||i4).splice(0,n.length-1)}function Ah({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=G$(r)?r.map(UR):UR(r),a={done:!1,value:e[0]},o=kH(t&&t.length===e.length?t:DH(e),n),c=IH(o,e,{ease:Array.isArray(i)?i:NH(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const MH=n=>n!==null;function BE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(MH),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const PH={decay:p_,inertia:p_,tween:Ah,keyframes:Ah,spring:iv};function v4(n){typeof n.type=="string"&&(n.type=PH[n.type])}class UE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const OH=n=>n/100;class FE extends UE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==Ur.now()&&this.tick(Ur.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;v4(e);const{type:t=Ah,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=t||Ah;u!==Ah&&typeof c[0]!="number"&&(this.mixKeyframes=Up(OH,p4(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=LE(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let R=this.currentTime,O=r;if(p){const I=Math.min(this.currentTime,i)/c;let k=Math.floor(I),z=I%1;!z&&I>=1&&(z=1),z===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(z=1-z,b&&(z-=b/c)):m==="mirror"&&(O=o)),R=Os(0,1,z)*c}const P=C?{done:!1,value:h[0]}:O.next(R);a&&(P.value=a(P.value));let{done:M}=P;!C&&u!==null&&(M=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return A&&_!==p_&&(P.value=BE(h,this.options,S,this.speed)),w&&w(P.value),A&&this.finish(),P}then(e,t){return this.finished.then(e,t)}get duration(){return Ri(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ri(e)}get time(){return Ri(this.currentTime)}set time(e){e=Ga(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ur.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ri(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=yH,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ur.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function jH(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const ic=n=>n*180/Math.PI,g_=n=>{const e=ic(Math.atan2(n[1],n[0]));return m_(e)},VH={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:g_,rotateZ:g_,skewX:n=>ic(Math.atan(n[1])),skewY:n=>ic(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},m_=n=>(n=n%360,n<0&&(n+=360),n),YR=g_,KR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),XR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),zH={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:KR,scaleY:XR,scale:n=>(KR(n)+XR(n))/2,rotateX:n=>m_(ic(Math.atan2(n[6],n[5]))),rotateY:n=>m_(ic(Math.atan2(-n[2],n[0]))),rotateZ:YR,rotate:YR,skewX:n=>ic(Math.atan(n[4])),skewY:n=>ic(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function v_(n){return n.includes("scale")?1:0}function y_(n,e){if(!n||n==="none")return v_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=zH,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=VH,i=c}if(!i)return v_(e);const a=r[e],o=i[1].split(",").map(BH);return typeof a=="function"?a(o):o[a]}const LH=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return y_(t,e)};function BH(n){return parseFloat(n.trim())}const Ld=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bd=new Set(Ld),WR=n=>n===zd||n===nt,UH=new Set(["x","y","z"]),FH=Ld.filter(n=>!UH.has(n));function GH(n){const e=[];return FH.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const hc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>y_(e,"x"),y:(n,{transform:e})=>y_(e,"y")};hc.translateX=hc.x;hc.translateY=hc.y;const pc=new Set;let b_=!1,x_=!1,__=!1;function y4(){if(x_){const n=Array.from(pc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=GH(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}x_=!1,b_=!1,pc.forEach(n=>n.complete(__)),pc.clear()}function b4(){pc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(x_=!0)})}function qH(){__=!0,b4(),y4(),__=!1}class GE{constructor(e,t,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(pc.add(this),b_||(b_=!0,an.read(b4),an.resolveKeyframes(y4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}jH(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),pc.delete(this)}cancel(){this.state==="scheduled"&&(pc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const $H=n=>n.startsWith("--");function HH(n,e,t){$H(e)?n.style.setProperty(e,t):n.style[e]=t}const YH=DE(()=>window.ScrollTimeline!==void 0),KH={};function XH(n,e){const t=DE(n);return()=>KH[e]??t()}const x4=XH(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),uh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,QR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:uh([0,.65,.55,1]),circOut:uh([.55,0,1,.45]),backIn:uh([.31,.01,.66,-.59]),backOut:uh([.33,1.53,.69,.99])};function _4(n,e){if(n)return typeof n=="function"?x4()?g4(n,e):"ease-out":a4(n)?uh(n):Array.isArray(n)?n.map(t=>_4(t,e)||QR.easeOut):QR[n]}function WH(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=_4(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function w4(n){return typeof n=="function"&&"applyToOptions"in n}function QH({type:n,...e}){return w4(n)&&x4()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class ZH extends UE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,RE(typeof e.type!="string");const d=QH(e);this.animation=WH(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=BE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):HH(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Ri(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ri(e)}get time(){return Ri(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ga(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&YH()?(this.animation.timeline=e,ki):t(this)}}const E4={anticipate:t4,backInOut:e4,circInOut:r4};function JH(n){return n in E4}function eY(n){typeof n.ease=="string"&&JH(n.ease)&&(n.ease=E4[n.ease])}const ZR=10;class tY extends ZH{constructor(e){eY(e),v4(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new FE({...o,autoplay:!1}),u=Ga(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-ZR).value,c.sample(u).value,ZR),c.stop()}}const JR=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(nl.test(n)||n==="0")&&!n.startsWith("url("));function nY(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function rY(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],o=JR(i,e),c=JR(a,e);return!o||!c?!1:nY(n)||(t==="spring"||w4(t))&&r}function w_(n){n.duration=0,n.type="keyframes"}const iY=new Set(["opacity","clipPath","filter","transform"]),aY=DE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function sY(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return aY()&&t&&iY.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const oY=40;class lY extends UE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Ur.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||GE;this.keyframeResolver=new b(c,(_,w,S)=>this.onKeyframesResolved(_,w,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=Ur.now(),rY(e,a,o,c)||((js.instantAnimations||!u)&&h?.(BE(e,r,t)),e[0]=e[e.length-1],w_(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>oY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&sY(m)?new tY({...m,element:m.motionValue.owner.current}):new FE(m);b.finished.then(()=>this.notifyFinished()).catch(ki),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),qH()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const cY=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function uY(n){const e=cY.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function S4(n,e,t=1){const[r,i]=uY(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return HO(o)?parseFloat(o):o}return OE(i)?S4(i,e,t+1):i}function qE(n,e){return n?.[e]??n?.default??n}const T4=new Set(["width","height","top","left","right","bottom",...Ld]),dY={test:n=>n==="auto",parse:n=>n},A4=n=>e=>e.test(n),C4=[zd,nt,qa,Do,nH,tH,dY],eD=n=>C4.find(A4(n));function fY(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||KO(n):!0}const hY=new Set(["brightness","contrast","saturate","opacity"]);function pY(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(jE)||[];if(!r)return n;const i=t.replace(r,"");let a=hY.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const gY=/\b([a-z-]*)\(.*?\)/gu,E_={...nl,getAnimatableNone:n=>{const e=n.match(gY);return e?e.map(pY).join(" "):n}},tD={...zd,transform:Math.round},mY={rotate:Do,rotateX:Do,rotateY:Do,rotateZ:Do,scale:jm,scaleX:jm,scaleY:jm,scaleZ:jm,skew:Do,skewX:Do,skewY:Do,distance:nt,translateX:nt,translateY:nt,translateZ:nt,x:nt,y:nt,z:nt,perspective:nt,transformPerspective:nt,opacity:rp,originX:FR,originY:FR,originZ:nt},$E={borderWidth:nt,borderTopWidth:nt,borderRightWidth:nt,borderBottomWidth:nt,borderLeftWidth:nt,borderRadius:nt,radius:nt,borderTopLeftRadius:nt,borderTopRightRadius:nt,borderBottomRightRadius:nt,borderBottomLeftRadius:nt,width:nt,maxWidth:nt,height:nt,maxHeight:nt,top:nt,right:nt,bottom:nt,left:nt,padding:nt,paddingTop:nt,paddingRight:nt,paddingBottom:nt,paddingLeft:nt,margin:nt,marginTop:nt,marginRight:nt,marginBottom:nt,marginLeft:nt,backgroundPositionX:nt,backgroundPositionY:nt,...mY,zIndex:tD,fillOpacity:rp,strokeOpacity:rp,numOctaves:tD},vY={...$E,color:zn,backgroundColor:zn,outlineColor:zn,fill:zn,stroke:zn,borderColor:zn,borderTopColor:zn,borderRightColor:zn,borderBottomColor:zn,borderLeftColor:zn,filter:E_,WebkitFilter:E_},I4=n=>vY[n];function R4(n,e){let t=I4(n);return t!==E_&&(t=nl),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const yY=new Set(["auto","none","0"]);function bY(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!yY.has(a)&&ip(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=R4(t,i)}class xY extends GE{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),OE(d))){const h=S4(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!T4.has(r)||e.length!==2)return;const[i,a]=e,o=eD(i),c=eD(a);if(o!==c)if(WR(o)&&WR(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else hc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||fY(e[i]))&&r.push(i);r.length&&bY(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=hc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function _Y(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const D4=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function k4(n){return YO(n)&&"offsetHeight"in n}const nD=30,wY=n=>!isNaN(parseFloat(n));class EY{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=Ur.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ur.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=wY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new kE);const r=this.events[e].add(t);return e==="change"?()=>{r(),an.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ur.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>nD)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,nD);return XO(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function yd(n,e){return new EY(n,e)}const{schedule:HE}=s4(queueMicrotask,!1),Ki={x:!1,y:!1};function N4(){return Ki.x||Ki.y}function SY(n){return n==="x"||n==="y"?Ki[n]?null:(Ki[n]=!0,()=>{Ki[n]=!1}):Ki.x||Ki.y?null:(Ki.x=Ki.y=!0,()=>{Ki.x=Ki.y=!1})}function M4(n,e){const t=_Y(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function rD(n){return!(n.pointerType==="touch"||N4())}function TY(n,e,t={}){const[r,i,a]=M4(n,t),o=c=>{if(!rD(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{rD(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const P4=(n,e)=>e?n===e?!0:P4(n,e.parentElement):!1,YE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,AY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function CY(n){return AY.has(n.tagName)||n.tabIndex!==-1}const y0=new WeakSet;function iD(n){return e=>{e.key==="Enter"&&n(e)}}function Xx(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const IY=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=iD(()=>{if(y0.has(t))return;Xx(t,"down");const i=iD(()=>{Xx(t,"up")}),a=()=>Xx(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function aD(n){return YE(n)&&!N4()}function RY(n,e,t={}){const[r,i,a]=M4(n,t),o=c=>{const u=c.currentTarget;if(!aD(c))return;y0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),y0.has(u)&&y0.delete(u),aD(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||P4(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),k4(c)&&(c.addEventListener("focus",d=>IY(d,i)),!CY(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function O4(n){return YO(n)&&"ownerSVGElement"in n}function DY(n){return O4(n)&&n.tagName==="svg"}const mr=n=>!!(n&&n.getVelocity),kY=[...C4,zn,nl],NY=n=>kY.find(A4(n)),KE=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function sD(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function MY(...n){return e=>{let t=!1;const r=n.map(i=>{const a=sD(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():sD(n[i],null)}}}}function PY(...n){return U.useCallback(MY(...n),n)}class OY extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=k4(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function jY({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),a=U.useRef(null),o=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=U.useContext(KE),u=PY(a,n?.ref);return U.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const S=r??document.head;return S.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(w)&&S.removeChild(w)}},[e]),v.jsx(OY,{isPresent:e,childRef:a,sizeRef:o,children:U.cloneElement(n,{ref:u})})}const VY=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=ey(zY),h=U.useId();let p=!0,m=U.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),U.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),U.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),o==="popLayout"&&(n=v.jsx(jY,{isPresent:t,anchorX:c,root:u,children:n})),v.jsx(ty.Provider,{value:m,children:n})};function zY(){return new Map}function j4(n=!0){const e=U.useContext(ty);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=U.useId();U.useEffect(()=>{if(n)return i(a)},[n]);const o=U.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,o]:[!0]}const Vm=n=>n.key||"";function oD(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const ci=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=j4(o),p=U.useMemo(()=>oD(n),[n]),m=o&&!d?[]:p.map(Vm),b=U.useRef(!0),_=U.useRef(p),w=ey(()=>new Map),[S,T]=U.useState(p),[C,R]=U.useState(p);AE(()=>{b.current=!1,_.current=p;for(let M=0;M<C.length;M++){const A=Vm(C[M]);m.includes(A)?w.delete(A):w.get(A)!==!0&&w.set(A,!1)}},[C,m.length,m.join("-")]);const O=[];if(p!==S){let M=[...p];for(let A=0;A<C.length;A++){const I=C[A],k=Vm(I);m.includes(k)||(M.splice(A,0,I),O.push(I))}return a==="wait"&&O.length&&(M=O),R(oD(M)),T(p),null}const{forceRender:P}=U.useContext(SE);return v.jsx(v.Fragment,{children:C.map(M=>{const A=Vm(M),I=o&&!d?!1:p===C||m.includes(A),k=()=>{if(w.has(A))w.set(A,!0);else return;let z=!0;w.forEach(V=>{V||(z=!1)}),z&&(P?.(),R(_.current),o&&h?.(),r&&r())};return v.jsx(VY,{isPresent:I,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:I?void 0:k,anchorX:c,children:M},A)})})},V4=U.createContext({strict:!1}),lD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},bd={};for(const n in lD)bd[n]={isEnabled:e=>lD[n].some(t=>!!e[t])};function LY(n){for(const e in n)bd[e]={...bd[e],...n[e]}}const BY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function av(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||BY.has(n)}let z4=n=>!av(n);function UY(n){typeof n=="function"&&(z4=e=>e.startsWith("on")?!av(e):n(e))}try{UY(require("@emotion/is-prop-valid").default)}catch{}function FY(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(z4(i)||t===!0&&av(i)||!e&&!av(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const ny=U.createContext({});function ry(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function ap(n){return typeof n=="string"||Array.isArray(n)}const XE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],WE=["initial",...XE];function iy(n){return ry(n.animate)||WE.some(e=>ap(n[e]))}function L4(n){return!!(iy(n)||n.variants)}function GY(n,e){if(iy(n)){const{initial:t,animate:r}=n;return{initial:t===!1||ap(t)?t:void 0,animate:ap(r)?r:void 0}}return n.inherit!==!1?e:{}}function qY(n){const{initial:e,animate:t}=GY(n,U.useContext(ny));return U.useMemo(()=>({initial:e,animate:t}),[cD(e),cD(t)])}function cD(n){return Array.isArray(n)?n.join(" "):n}const sp={};function $Y(n){for(const e in n)sp[e]=n[e],PE(e)&&(sp[e].isCSSVariable=!0)}function B4(n,{layout:e,layoutId:t}){return Bd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!sp[n]||n==="opacity")}const HY={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},YY=Ld.length;function KY(n,e,t){let r="",i=!0;for(let a=0;a<YY;a++){const o=Ld[a],c=n[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=D4(c,$E[o]);if(!u){i=!1;const h=HY[o]||o;r+=`${h}(${d}) `}t&&(e[o]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function QE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let o=!1,c=!1;for(const u in e){const d=e[u];if(Bd.has(u)){o=!0;continue}else if(PE(u)){i[u]=d;continue}else{const h=D4(d,$E[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||t?r.transform=KY(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const ZE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function U4(n,e,t){for(const r in e)!mr(e[r])&&!B4(r,t)&&(n[r]=e[r])}function XY({transformTemplate:n},e){return U.useMemo(()=>{const t=ZE();return QE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function WY(n,e){const t=n.style||{},r={};return U4(r,t,n),Object.assign(r,XY(n,e)),r}function QY(n,e){const t={},r=WY(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const ZY={offset:"stroke-dashoffset",array:"stroke-dasharray"},JY={offset:"strokeDashoffset",array:"strokeDasharray"};function eK(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?ZY:JY;n[a.offset]=nt.transform(-r);const o=nt.transform(e),c=nt.transform(t);n[a.array]=`${o} ${c}`}function F4(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(QE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&eK(p,i,a,o,!1)}const G4=()=>({...ZE(),attrs:{}}),q4=n=>typeof n=="string"&&n.toLowerCase()==="svg";function tK(n,e,t,r){const i=U.useMemo(()=>{const a=G4();return F4(a,e,q4(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};U4(a,n.style,n),i.style={...a,...i.style}}return i}const nK=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function JE(n){return typeof n!="string"||n.includes("-")?!1:!!(nK.indexOf(n)>-1||/[A-Z]/u.test(n))}function rK(n,e,t,{latestValues:r},i,a=!1){const c=(JE(n)?tK:QY)(e,r,i,n),u=FY(e,typeof n=="string",a),d=n!==U.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=U.useMemo(()=>mr(h)?h.get():h,[h]);return U.createElement(n,{...d,children:p})}function uD(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function eS(n,e,t,r){if(typeof e=="function"){const[i,a]=uD(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=uD(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function b0(n){return mr(n)?n.get():n}function iK({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:aK(t,r,i,n),renderState:e()}}function aK(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=b0(a[m]);let{initial:o,animate:c}=n;const u=iy(n),d=L4(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!ry(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=eS(n,m[b]);if(_){const{transitionEnd:w,transition:S,...T}=_;for(const C in T){let R=T[C];if(Array.isArray(R)){const O=h?R.length-1:0;R=R[O]}R!==null&&(i[C]=R)}for(const C in w)i[C]=w[C]}}}return i}const $4=n=>(e,t)=>{const r=U.useContext(ny),i=U.useContext(ty),a=()=>iK(n,e,r,i);return t?a():ey(a)};function tS(n,e,t){const{style:r}=n,i={};for(const a in r)(mr(r[a])||e.style&&mr(e.style[a])||B4(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const sK=$4({scrapeMotionValuesFromProps:tS,createRenderState:ZE});function H4(n,e,t){const r=tS(n,e,t);for(const i in n)if(mr(n[i])||mr(e[i])){const a=Ld.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const oK=$4({scrapeMotionValuesFromProps:H4,createRenderState:G4}),lK=Symbol.for("motionComponentSymbol");function Uu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function cK(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Uu(t)&&(t.current=r))},[e])}const nS=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),uK="framerAppearId",Y4="data-"+nS(uK),K4=U.createContext({});function dK(n,e,t,r,i){const{visualElement:a}=U.useContext(ny),o=U.useContext(V4),c=U.useContext(ty),u=U.useContext(KE).reducedMotion,d=U.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=U.useContext(K4);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&fK(d.current,t,i,p);const m=U.useRef(!1);U.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[Y4],_=U.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return AE(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),U.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function fK(n,e,t,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:X4(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&Uu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function X4(n){if(n)return n.options.allowProjection!==!1?n.projection:X4(n.parent)}function Wx(n,{forwardMotionProps:e=!1}={},t,r){t&&LY(t);const i=JE(n)?oK:sK;function a(c,u){let d;const h={...U.useContext(KE),...c,layoutId:hK(c)},{isStatic:p}=h,m=qY(c),b=i(c,p);if(!p&&TE){pK();const _=gK(h);d=_.MeasureLayout,m.visualElement=dK(n,b,h,r,_.ProjectionNode)}return v.jsxs(ny.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,rK(n,c,cK(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=U.forwardRef(a);return o[lK]=n,o}function hK({layoutId:n}){const e=U.useContext(SE).id;return e&&n!==void 0?e+"-"+n:n}function pK(n,e){U.useContext(V4).strict}function gK(n){const{drag:e,layout:t}=bd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function mK(n,e){if(typeof Proxy>"u")return Wx;const t=new Map,r=(a,o)=>Wx(a,o,n,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(t.has(o)||t.set(o,Wx(o,void 0,n,e)),t.get(o))})}function W4({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function vK({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function yK(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function Qx(n){return n===void 0||n===1}function S_({scale:n,scaleX:e,scaleY:t}){return!Qx(n)||!Qx(e)||!Qx(t)}function Hl(n){return S_(n)||Q4(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function Q4(n){return dD(n.x)||dD(n.y)}function dD(n){return n&&n!=="0%"}function sv(n,e,t){const r=n-t,i=e*r;return t+i}function fD(n,e,t,r,i){return i!==void 0&&(n=sv(n,i,r)),sv(n,t,r)+e}function T_(n,e=0,t=1,r,i){n.min=fD(n.min,e,t,r,i),n.max=fD(n.max,e,t,r,i)}function Z4(n,{x:e,y:t}){T_(n.x,e.translate,e.scale,e.originPoint),T_(n.y,t.translate,t.scale,t.originPoint)}const hD=.999999999999,pD=1.0000000000001;function bK(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=t[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Gu(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Z4(n,o)),r&&Hl(a.latestValues)&&Gu(n,a.latestValues))}e.x<pD&&e.x>hD&&(e.x=1),e.y<pD&&e.y>hD&&(e.y=1)}function Fu(n,e){n.min=n.min+e,n.max=n.max+e}function gD(n,e,t,r,i=.5){const a=fn(n.min,n.max,i);T_(n,e,t,a,r)}function Gu(n,e){gD(n.x,e.x,e.scaleX,e.scale,e.originX),gD(n.y,e.y,e.scaleY,e.scale,e.originY)}function J4(n,e){return W4(yK(n.getBoundingClientRect(),e))}function xK(n,e,t){const r=J4(n,t),{scroll:i}=e;return i&&(Fu(r.x,i.offset.x),Fu(r.y,i.offset.y)),r}const mD=()=>({translate:0,scale:1,origin:0,originPoint:0}),qu=()=>({x:mD(),y:mD()}),vD=()=>({min:0,max:0}),Tn=()=>({x:vD(),y:vD()}),A_={current:null},e3={current:!1};function _K(){if(e3.current=!0,!!TE)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>A_.current=n.matches;n.addEventListener("change",e),e()}else A_.current=!1}const wK=new WeakMap;function EK(n,e,t){for(const r in e){const i=e[r],a=t[r];if(mr(i))n.addValue(r,i);else if(mr(a))n.addValue(r,yd(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,yd(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const yD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class SK{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=GE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Ur.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,an.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=iy(t),this.isVariantNode=L4(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&mr(b)&&b.set(u[m])}}mount(e){this.current=e,wK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),e3.current||_K(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:A_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),tl(this.notifyUpdate),tl(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Bd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&an.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in bd){const t=bd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<yD.length;r++){const i=yD[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=EK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=yd(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(HO(r)||KO(r))?r=parseFloat(r):!NY(r)&&nl.test(t)&&(r=R4(e,t)),this.setBaseTarget(e,mr(r)?r.get():r)),mr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=eS(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!mr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new kE),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){HE.render(this.render)}}class t3 extends SK{constructor(){super(...arguments),this.KeyframeResolver=xY}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;mr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function n3(n,{style:e,vars:t},r,i){const a=n.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in t)a.setProperty(o,t[o])}function TK(n){return window.getComputedStyle(n)}class AK extends t3{constructor(){super(...arguments),this.type="html",this.renderInstance=n3}readValueFromInstance(e,t){if(Bd.has(t))return this.projection?.isProjecting?v_(t):LH(e,t);{const r=TK(e),i=(PE(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return J4(e,t)}build(e,t,r){QE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return tS(e,t,r)}}const r3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function CK(n,e,t,r){n3(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(r3.has(i)?i:nS(i),e.attrs[i])}class IK extends t3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Tn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Bd.has(t)){const r=I4(t);return r&&r.default||0}return t=r3.has(t)?t:nS(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return H4(e,t,r)}build(e,t,r){F4(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){CK(e,t,r,i)}mount(e){this.isSVGTag=q4(e.tagName),super.mount(e)}}const RK=(n,e)=>JE(n)?new IK(e):new AK(e,{allowProjection:n!==U.Fragment});function nd(n,e,t){const r=n.getProps();return eS(r,e,t!==void 0?t:r.custom,n)}const C_=n=>Array.isArray(n);function DK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,yd(t))}function kK(n){return C_(n)?n[n.length-1]||0:n}function rS(n,e){const t=nd(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const o in a){const c=kK(a[o]);DK(n,o,c)}}function NK(n){return!!(mr(n)&&n.add)}function I_(n,e){const t=n.getValue("willChange");if(NK(t))return t.add(e);if(!t&&js.WillChange){const r=new js.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function i3(n){return n.props[Y4]}const MK=n=>n!==null;function PK(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(MK),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const OK={type:"spring",stiffness:500,damping:25,restSpeed:10},jK=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),VK={type:"keyframes",duration:.8},zK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},LK=(n,{keyframes:e})=>e.length>2?VK:Bd.has(n)?n.startsWith("scale")?jK(e[1]):OK:zK;function BK({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const iS=(n,e,t,r={},i,a)=>o=>{const c=qE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Ga(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};BK(c)||Object.assign(h,LK(n,h)),h.duration&&(h.duration=Ga(h.duration)),h.repeatDelay&&(h.repeatDelay=Ga(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(w_(h),h.delay===0&&(p=!0)),(js.instantAnimations||js.skipAnimations)&&(p=!0,w_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=PK(h.keyframes,c);if(m!==void 0){an.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new FE(h):new lY(h)};function UK({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function a3(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&UK(d,h))continue;const b={delay:t,...qE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=i3(n);if(T){const C=window.MotionHandoffAnimation(T,h,an);C!==null&&(b.startTime=C,w=!0)}}I_(n,h),p.start(iS(h,p,m,n.shouldReduceMotion&&T4.has(h)?{type:!1}:b,n,w));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{an.update(()=>{o&&rS(n,o)})}),u}function s3(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,c=(o-1)*r;return typeof t=="function"?t(a,o):i===1?a*r:c-a*r}function R_(n,e,t={}){const r=nd(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all(a3(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return FK(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(t.delay)])}function FK(n,e,t=0,r=0,i=0,a=1,o){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push(R_(u,e,{...o,delay:t+(typeof r=="function"?0:r)+s3(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function o3(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>R_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=R_(n,e,t);else{const i=typeof e=="function"?nd(n,e,t.custom):e;r=Promise.all(a3(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function l3(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const GK=WE.length;function c3(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?c3(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<GK;t++){const r=WE[t],i=n.props[r];(ap(i)||i===!1)&&(e[r]=i)}return e}const qK=[...XE].reverse(),$K=XE.length;function HK(n){return e=>Promise.all(e.map(({animation:t,options:r})=>o3(n,t,r)))}function YK(n){let e=HK(n),t=bD(),r=!0;const i=u=>(d,h)=>{const p=nd(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function o(u){const{props:d}=n,h=c3(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let S=0;S<$K;S++){const T=qK[S],C=t[T],R=d[T]!==void 0?d[T]:h[T],O=ap(R),P=T===u?C.isActive:null;P===!1&&(_=S);let M=R===h[T]&&R!==d[T]&&O;if(M&&r&&n.manuallyAnimateOnMount&&(M=!1),C.protectedKeys={...b},!C.isActive&&P===null||!R&&!C.prevProp||ry(R)||typeof R=="boolean")continue;const A=KK(C.prevProp,R);let I=A||T===u&&C.isActive&&!M&&O||S>_&&O,k=!1;const z=Array.isArray(R)?R:[R];let V=z.reduce(i(T),{});P===!1&&(V={});const{prevResolvedValues:B={}}=C,j={...B,...V},X=W=>{I=!0,m.has(W)&&(k=!0,m.delete(W)),C.needsAnimating[W]=!0;const ee=n.getValue(W);ee&&(ee.liveStyle=!1)};for(const W in j){const ee=V[W],he=B[W];if(b.hasOwnProperty(W))continue;let K=!1;C_(ee)&&C_(he)?K=!l3(ee,he):K=ee!==he,K?ee!=null?X(W):m.add(W):ee!==void 0&&m.has(W)?X(W):C.protectedKeys[W]=!0}C.prevProp=R,C.prevResolvedValues=V,C.isActive&&(b={...b,...V}),r&&n.blockInitialAnimation&&(I=!1);const H=M&&A;I&&(!H||k)&&p.push(...z.map(W=>{const ee={type:T};if(typeof W=="string"&&r&&!H&&n.manuallyAnimateOnMount&&n.parent){const{parent:he}=n,K=nd(he,W);if(he.enteringChildren&&K){const{delayChildren:G}=K.transition||{};ee.delay=s3(he.enteringChildren,n,G)}}return{animation:W,options:ee}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=nd(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const C=n.getBaseTarget(T),R=n.getValue(T);R&&(R.liveStyle=!0),S[T]=C??null}),p.push({animation:S})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=o(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=bD()}}}function KK(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!l3(e,n):!1}function Ul(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function bD(){return{animate:Ul(!0),whileInView:Ul(),whileHover:Ul(),whileTap:Ul(),whileDrag:Ul(),whileFocus:Ul(),exit:Ul()}}class ul{constructor(e){this.isMounted=!1,this.node=e}update(){}}class XK extends ul{constructor(e){super(e),e.animationState||(e.animationState=YK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();ry(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let WK=0;class QK extends ul{constructor(){super(...arguments),this.id=WK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const ZK={animation:{Feature:XK},exit:{Feature:QK}};function op(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function qp(n){return{point:{x:n.pageX,y:n.pageY}}}const JK=n=>e=>YE(e)&&n(e,qp(e));function Ch(n,e,t,r){return op(n,e,JK(t),r)}const u3=1e-4,eX=1-u3,tX=1+u3,d3=.01,nX=0-d3,rX=0+d3;function Ir(n){return n.max-n.min}function iX(n,e,t){return Math.abs(n-e)<=t}function xD(n,e,t,r=.5){n.origin=r,n.originPoint=fn(e.min,e.max,n.origin),n.scale=Ir(t)/Ir(e),n.translate=fn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=eX&&n.scale<=tX||isNaN(n.scale))&&(n.scale=1),(n.translate>=nX&&n.translate<=rX||isNaN(n.translate))&&(n.translate=0)}function Ih(n,e,t,r){xD(n.x,e.x,t.x,r?r.originX:void 0),xD(n.y,e.y,t.y,r?r.originY:void 0)}function _D(n,e,t){n.min=t.min+e.min,n.max=n.min+Ir(e)}function aX(n,e,t){_D(n.x,e.x,t.x),_D(n.y,e.y,t.y)}function wD(n,e,t){n.min=e.min-t.min,n.max=n.min+Ir(e)}function Rh(n,e,t){wD(n.x,e.x,t.x),wD(n.y,e.y,t.y)}function Ti(n){return[n("x"),n("y")]}const f3=({current:n})=>n?n.ownerDocument.defaultView:null,ED=(n,e)=>Math.abs(n-e);function sX(n,e){const t=ED(n.x,e.x),r=ED(n.y,e.y);return Math.sqrt(t**2+r**2)}class h3{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Jx(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=sX(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:S}=or;this.history.push({...w,timestamp:S});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Zx(b,this.transformPagePoint),an.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Jx(m.type==="pointercancel"?this.lastMoveEventInfo:Zx(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!YE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=qp(e),u=Zx(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=or;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,Jx(u,this.history)),this.removeListeners=Up(Ch(this.contextWindow,"pointermove",this.handlePointerMove),Ch(this.contextWindow,"pointerup",this.handlePointerUp),Ch(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),tl(this.updatePoint)}}function Zx(n,e){return e?{point:e(n.point)}:n}function SD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Jx({point:n},e){return{point:n,delta:SD(n,p3(e)),offset:SD(n,oX(e)),velocity:lX(e,.1)}}function oX(n){return n[0]}function p3(n){return n[n.length-1]}function lX(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=p3(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ga(e)));)t--;if(!r)return{x:0,y:0};const a=Ri(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function cX(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?fn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?fn(t,n,r.max):Math.min(n,t)),n}function TD(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function uX(n,{top:e,left:t,bottom:r,right:i}){return{x:TD(n.x,t,i),y:TD(n.y,e,r)}}function AD(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function dX(n,e){return{x:AD(n.x,e.x),y:AD(n.y,e.y)}}function fX(n,e){let t=.5;const r=Ir(n),i=Ir(e);return i>r?t=np(e.min,e.max-r,n.min):r>i&&(t=np(n.min,n.max-i,e.min)),Os(0,1,t)}function hX(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const D_=.35;function pX(n=D_){return n===!1?n=0:n===!0&&(n=D_),{x:CD(n,"left","right"),y:CD(n,"top","bottom")}}function CD(n,e,t){return{min:ID(n,e),max:ID(n,t)}}function ID(n,e){return typeof n=="number"?n:n[e]||0}const gX=new WeakMap;class mX{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(qp(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=SY(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ti(T=>{let C=this.getAxisMotionValue(T).get()||0;if(qa.test(C)){const{projection:R}=this.visualElement;if(R&&R.layout){const O=R.layout.layoutBox[T];O&&(C=Ir(O)*(parseFloat(C)/100))}}this.originPoint[T]=C}),w&&an.postRender(()=>w(p,m)),I_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=vX(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Ti(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new h3(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:f3(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&an.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!zm(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=cX(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Uu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=uX(r.layoutBox,e):this.constraints=!1,this.elastic=pX(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ti(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=hX(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Uu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=xK(r,i.root,this.visualElement.getTransformPagePoint());let o=dX(i.layout.layoutBox,a);if(t){const c=t(vK(o));this.hasMutatedConstraints=!!c,c&&(o=W4(c))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=Ti(h=>{if(!zm(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return I_(this.visualElement,e),r.start(iS(e,r,0,t,this.visualElement,!1))}stopAnimation(){Ti(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ti(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Ti(t=>{const{drag:r}=this.getProps();if(!zm(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[t];a.set(e[t]-fn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Uu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ti(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=fX({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ti(o=>{if(!zm(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(fn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;gX.set(this.visualElement,this);const e=this.visualElement.current,t=Ch(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Uu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),an.read(r);const o=op(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ti(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=D_,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function zm(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function vX(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class yX extends ul{constructor(e){super(e),this.removeGroupControls=ki,this.removeListeners=ki,this.controls=new mX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ki}unmount(){this.removeGroupControls(),this.removeListeners()}}const RD=n=>(e,t)=>{n&&an.postRender(()=>n(e,t))};class bX extends ul{constructor(){super(...arguments),this.removePointerDownListener=ki}onPointerDown(e){this.session=new h3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:f3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:RD(e),onStart:RD(t),onMove:r,onEnd:(a,o)=>{delete this.session,i&&an.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Ch(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const x0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function DD(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const eh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(nt.test(n))n=parseFloat(n);else return n;const t=DD(n,e.target.x),r=DD(n,e.target.y);return`${t}% ${r}%`}},xX={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=nl.parse(n);if(i.length>5)return r;const a=nl.createTransformer(n),o=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=fn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let e1=!1;class _X extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;$Y(wX),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),e1&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),x0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,e1=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||an.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),HE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;e1=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function g3(n){const[e,t]=j4(),r=U.useContext(SE);return v.jsx(_X,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(K4),isPresent:e,safeToRemove:t})}const wX={borderRadius:{...eh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:eh,borderTopRightRadius:eh,borderBottomLeftRadius:eh,borderBottomRightRadius:eh,boxShadow:xX};function EX(n,e,t){const r=mr(n)?n:yd(n);return r.start(iS("",r,e,t)),r.animation}const SX=(n,e)=>n.depth-e.depth;class TX{constructor(){this.children=[],this.isDirty=!1}add(e){CE(this.children,e),this.isDirty=!0}remove(e){IE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(SX),this.isDirty=!1,this.children.forEach(e)}}function AX(n,e){const t=Ur.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(tl(r),n(a-e))};return an.setup(r,!0),()=>tl(r)}const m3=["TopLeft","TopRight","BottomLeft","BottomRight"],CX=m3.length,kD=n=>typeof n=="string"?parseFloat(n):n,ND=n=>typeof n=="number"||nt.test(n);function IX(n,e,t,r,i,a){i?(n.opacity=fn(0,t.opacity??1,RX(r)),n.opacityExit=fn(e.opacity??1,0,DX(r))):a&&(n.opacity=fn(e.opacity??1,t.opacity??1,r));for(let o=0;o<CX;o++){const c=`border${m3[o]}Radius`;let u=MD(e,c),d=MD(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||ND(u)===ND(d)?(n[c]=Math.max(fn(kD(u),kD(d),r),0),(qa.test(d)||qa.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=fn(e.rotate||0,t.rotate||0,r))}function MD(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const RX=v3(0,.5,n4),DX=v3(.5,.95,ki);function v3(n,e,t){return r=>r<n?0:r>e?1:t(np(n,e,r))}function PD(n,e){n.min=e.min,n.max=e.max}function Ei(n,e){PD(n.x,e.x),PD(n.y,e.y)}function OD(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function jD(n,e,t,r,i){return n-=e,n=sv(n,1/t,r),i!==void 0&&(n=sv(n,1/i,r)),n}function kX(n,e=0,t=1,r=.5,i,a=n,o=n){if(qa.test(e)&&(e=parseFloat(e),e=fn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=fn(a.min,a.max,r);n===a&&(c-=e),n.min=jD(n.min,e,t,c,i),n.max=jD(n.max,e,t,c,i)}function VD(n,e,[t,r,i],a,o){kX(n,e[t],e[r],e[i],e.scale,a,o)}const NX=["x","scaleX","originX"],MX=["y","scaleY","originY"];function zD(n,e,t,r){VD(n.x,e,NX,t?t.x:void 0,r?r.x:void 0),VD(n.y,e,MX,t?t.y:void 0,r?r.y:void 0)}function LD(n){return n.translate===0&&n.scale===1}function y3(n){return LD(n.x)&&LD(n.y)}function BD(n,e){return n.min===e.min&&n.max===e.max}function PX(n,e){return BD(n.x,e.x)&&BD(n.y,e.y)}function UD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function b3(n,e){return UD(n.x,e.x)&&UD(n.y,e.y)}function FD(n){return Ir(n.x)/Ir(n.y)}function GD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class OX{constructor(){this.members=[]}add(e){CE(this.members,e),e.scheduleRender()}remove(e){if(IE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function jX(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const t1=["","X","Y","Z"],VX=1e3;let zX=0;function n1(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function x3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=i3(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",an,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&x3(r)}function _3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=zX++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(UX),this.nodes.forEach($X),this.nodes.forEach(HX),this.nodes.forEach(FX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new TX)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new kE),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=O4(o)&&!DY(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;an.read(()=>{p=window.innerWidth}),n(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=AX(m,250),x0.hasAnimatedSinceResize&&(x0.hasAnimatedSinceResize=!1,this.nodes.forEach(HD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||QX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!b3(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const R={...qE(_,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R),this.setAnimationOrigin(h,C)}else p||HD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),tl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(YX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&x3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(qD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach($D);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(qX),this.nodes.forEach(LX),this.nodes.forEach(BX)):this.nodes.forEach($D),this.clearAllSnapshots();const c=Ur.now();or.delta=Os(0,1e3/60,c-or.timestamp),or.timestamp=c,or.isProcessing=!0,qx.update.process(or),qx.preRender.process(or),qx.render.process(or),or.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,HE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(GX),this.sharedNodes.forEach(KX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,an.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){an.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ir(this.snapshot.measuredBox.x)&&!Ir(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Tn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!y3(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Hl(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),ZX(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Tn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(JX))){const{scroll:d}=this.root;d&&(Fu(c.x,d.offset.x),Fu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=Tn();if(Ei(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Ei(c,o),Fu(c.x,h.offset.x),Fu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=Tn();Ei(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Gu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Hl(h.latestValues)&&Gu(u,h.latestValues)}return Hl(this.latestValues)&&Gu(u,this.latestValues),u}removeTransform(o){const c=Tn();Ei(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Hl(d.latestValues))continue;S_(d.latestValues)&&d.updateSnapshot();const h=Tn(),p=d.measurePageBox();Ei(h,p),zD(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Hl(this.latestValues)&&zD(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==or.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=or.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Rh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Tn(),this.targetWithTransforms=Tn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),aX(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ei(this.target,this.layout.layoutBox),Z4(this.target,this.targetDelta)):Ei(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Rh(this.relativeTargetOrigin,this.target,m.target),Ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||S_(this.parent.latestValues)||Q4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===or.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Ei(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;bK(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Tn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(OD(this.prevProjectionDelta.x,this.projectionDelta.x),OD(this.prevProjectionDelta.y,this.projectionDelta.y)),Ih(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!GD(this.projectionDelta.x,this.prevProjectionDelta.x)||!GD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=qu(),this.projectionDelta=qu(),this.projectionDeltaWithTransform=qu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=qu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Tn(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,S=this.getStack(),T=!S||S.members.length<=1,C=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(WX));this.animationProgress=0;let R;this.mixTargetDelta=O=>{const P=O/1e3;YD(p.x,o.x,P),YD(p.y,o.y,P),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Rh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),XX(this.relativeTarget,this.relativeTargetOrigin,m,P),R&&PX(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=Tn()),Ei(R,this.relativeTarget)),w&&(this.animationValues=h,IX(h,d,this.latestValues,P,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(tl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=an.update(()=>{x0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=yd(0)),this.currentAnimation=EX(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(VX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&w3(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Tn();const p=Ir(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=Ir(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Ei(c,u),Gu(c,h),Ih(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new OX),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&n1("z",o,d,this.animationValues);for(let h=0;h<t1.length;h++)n1(`rotate${t1[h]}`,o,d,this.animationValues),n1(`skew${t1[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=b0(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=b0(c?.pointerEvents)||""),this.hasProjected&&!Hl(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=jX(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in sp){if(h[_]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:T}=sp[_],C=p==="none"?h[_]:w(h[_],d);if(S){const R=S.length;for(let O=0;O<R;O++)o[S[O]]=C}else T?this.options.visualElement.renderState.vars[_]=C:o[_]=C}this.options.layoutId&&(o.pointerEvents=d===this?b0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(qD),this.root.sharedNodes.clear()}}}function LX(n){n.updateLayout()}function BX(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?Ti(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Ir(p);p.min=t[h].min,p.max=p.min+m}):w3(i,e.layoutBox,t)&&Ti(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Ir(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const o=qu();Ih(o,t,e.layoutBox);const c=qu();a?Ih(c,n.applyTransform(r,!0),e.measuredBox):Ih(c,t,e.layoutBox);const u=!y3(o);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=Tn();Rh(b,e.layoutBox,p.layoutBox);const _=Tn();Rh(_,t,m.layoutBox),b3(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function UX(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function FX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function GX(n){n.clearSnapshot()}function qD(n){n.clearMeasurements()}function $D(n){n.isLayoutDirty=!1}function qX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function HD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function $X(n){n.resolveTargetDelta()}function HX(n){n.calcProjection()}function YX(n){n.resetSkewAndRotation()}function KX(n){n.removeLeadSnapshot()}function YD(n,e,t){n.translate=fn(e.translate,0,t),n.scale=fn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function KD(n,e,t,r){n.min=fn(e.min,t.min,r),n.max=fn(e.max,t.max,r)}function XX(n,e,t,r){KD(n.x,e.x,t.x,r),KD(n.y,e.y,t.y,r)}function WX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const QX={duration:.45,ease:[.4,0,.1,1]},XD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),WD=XD("applewebkit/")&&!XD("chrome/")?Math.round:ki;function QD(n){n.min=WD(n.min),n.max=WD(n.max)}function ZX(n){QD(n.x),QD(n.y)}function w3(n,e,t){return n==="position"||n==="preserve-aspect"&&!iX(FD(e),FD(t),.2)}function JX(n){return n!==n.root&&n.scroll?.wasRoot}const eW=_3({attachResizeListener:(n,e)=>op(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),r1={current:void 0},E3=_3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!r1.current){const n=new eW({});n.mount(window),n.setOptions({layoutScroll:!0}),r1.current=n}return r1.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),tW={pan:{Feature:bX},drag:{Feature:yX,ProjectionNode:E3,MeasureLayout:g3}};function ZD(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&an.postRender(()=>a(e,qp(e)))}class nW extends ul{mount(){const{current:e}=this.node;e&&(this.unmount=TY(e,(t,r)=>(ZD(this.node,r,"Start"),i=>ZD(this.node,i,"End"))))}unmount(){}}class rW extends ul{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Up(op(this.node.current,"focus",()=>this.onFocus()),op(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function JD(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&an.postRender(()=>a(e,qp(e)))}class iW extends ul{mount(){const{current:e}=this.node;e&&(this.unmount=RY(e,(t,r)=>(JD(this.node,r,"Start"),(i,{success:a})=>JD(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const k_=new WeakMap,i1=new WeakMap,aW=n=>{const e=k_.get(n.target);e&&e(n)},sW=n=>{n.forEach(aW)};function oW({root:n,...e}){const t=n||document;i1.has(t)||i1.set(t,{});const r=i1.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(sW,{root:n,...e})),r[i]}function lW(n,e,t){const r=oW(e);return k_.set(n,t),r.observe(n),()=>{k_.delete(n),r.unobserve(n)}}const cW={some:0,all:1};class uW extends ul{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:cW[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return lW(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(dW(e,t))&&this.startObserver()}unmount(){}}function dW({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const fW={inView:{Feature:uW},tap:{Feature:iW},focus:{Feature:rW},hover:{Feature:nW}},hW={layout:{ProjectionNode:E3,MeasureLayout:g3}},pW={...ZK,...fW,...tW,...hW},xn=mK(pW,RK);function gW(n){n.values.forEach(e=>e.stop())}function N_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&rS(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{N_(a,e)})})}function mW(n,e){if(Array.isArray(e))return N_(n,e);if(typeof e=="string")return N_(n,[e]);rS(n,e)}function vW(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(o3(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{mW(r,t)})},stop(){n.forEach(t=>{gW(t)})},mount(){return()=>{e.stop()}}};return e}function yW(){const n=ey(vW);return AE(n.mount,[]),n}const bW=yW,jc=Cw((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{n({isVisible:!1})}})),xW=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=jc(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(ci,{children:t&&v.jsx(xn.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-24 right-6 z-[110] max-w-xs",children:v.jsxs("div",{className:`rounded-lg shadow-lg p-3 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-xs font-medium whitespace-pre-line pr-2",children:n})}),v.jsxs("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-2 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-bold transition-colors",children:[v.jsx(jF,{size:12,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-0.5 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(Dv,{size:14})})]})]})})})};class Xi extends U.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(ed,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(Lh,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(sF,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const _W=({onAddTransaction:n})=>{const e=Qa(),t=da(),[r,i]=U.useState(!1),a=U.useRef(null),o=d=>t.pathname===d;U.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(RU,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(V0,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(kU,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=o(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(Rv,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(lF,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),n){n();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(Tp,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(YU,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(TF,{className:"w-6 h-6"})})]})})};function wW(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function EW(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function Cs(n,e){return function(t){t&&(n[e]=t)}}function S3(n,e,t){return function(r){r&&(n[e][t]=r)}}function ek(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function SW(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var TW="function",AW="object",CW="string",IW="number",aS="undefined",T3=typeof window!==aS,RW=typeof document!==aS&&document,DW=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Ln=1e-7,Lm={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function kW(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function ov(n,e,t,r){return(n*r+e*t)/(t+r)}function ay(n){return typeof n===aS}function la(n){return n&&typeof n===AW}function Fn(n){return Array.isArray(n)}function Fr(n){return typeof n===CW}function xd(n){return typeof n===IW}function sS(n){return typeof n===TW}function NW(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function A3(n,e,t,r,i){var a=oS(n,e,t);return a?t:MW(n,e,t+1,r,i)}function oS(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function MW(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!oS(n,e,d))return{value:d};var p=d,m=Gr(i,function(b){var _=b.open;return _===h});if(m&&(p=A3(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=t;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function lS(n,e){var t=Fr(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,o=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?o:c,d=t.openCloseCharacters,h=d===void 0?DW:d,p=h.map(function(A){var I=A.open,k=A.close;return I===k?I:I+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(A){return A&&A!=="undefined"}),w=_.length,S=[],T=[];function C(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var R=function(A){var I=_[A].trim(),k=A,z=Gr(h,function(j){var X=j.open;return X===I}),V=Gr(h,function(j){var X=j.close;return X===I});if(z){if(k=A3(z,_,A,w,h),k!==-1&&u)return C()&&a||(S.push(_.slice(A,k+1).join("")),A=k,a)?(O=A,"break"):(O=A,"continue")}else if(V&&!oS(V,_,A)){var B=kW(h);return B.splice(h.indexOf(V),1),{value:lS(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:B})}}else if(NW(I,i)&&!o)return C(),a?(O=A,"break"):(O=A,"continue");k===-1&&(k=w-1),T.push(_.slice(A,k+1).join("")),A=k,O=A},O,P=0;P<w;++P){var M=R(P);if(P=O,typeof M=="object")return M.value;if(M==="break")break}return T.length&&S.push(T.join("")),S}function rl(n){return lS(n,"")}function ac(n){return lS(n,",")}function C3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function $p(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function PW(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function _0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function lp(){return Date.now?Date.now():new Date().getTime()}function Vs(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function Gr(n,e,t){var r=Vs(n,e);return r>-1?n[r]:t}var I3=(function(){var n=lp(),e=T3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=lp(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),OW=(function(){var n=T3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function zs(n){return Object.keys(n)}function jW(n){var e=zs(n);return e.map(function(t){return n[t]})}function Ht(n,e){var t=$p(n),r=t.value,i=t.unit;if(la(e)){var a=e[i];if(a){if(sS(a))return a(r);if(Lm[i])return Lm[i](r,a)}}else if(i==="%")return r*e/100;return Lm[i]?Lm[i](r):r}function M_(n,e,t){return Math.max(e,Math.min(n,t))}function tk(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[at(e[0],Ln),at(e[0]/r,Ln)],[at(e[1]*r,Ln),at(e[1],Ln)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=at(c,Ln);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function R3(n,e,t,r){if(!r)return n.map(function(b,_){return M_(b,e[_],t[_])});var i=n[0],a=n[1],o=r===!0?i/a:r,c=tk(n,e,!1,o),u=c[0],d=c[1],h=tk(n,t,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function VW(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function P_(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function An(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function zW(n){return[0,1].map(function(e){return P_(n.map(function(t){return t[e]}))})}function nk(n){var e=zW(n),t=An(e,n[0]),r=An(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function Is(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function at(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function rk(n,e){return n.forEach(function(t,r){n[r]=at(n[r],e)}),n}function LW(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function D3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function k3(n,e){n.indexOf(e)===-1&&n.push(e)}function Hn(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function N3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function M3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function sr(n,e,t,r){n.addEventListener(e,t,r)}function qn(n,e,t,r){n.removeEventListener(e,t,r)}function Ud(n){return n?.ownerDocument||RW}function cS(n){return Ud(n).documentElement}function dl(n){return Ud(n).body}function Ko(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function P3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function Fd(n){return la(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var BW=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,o=i.indexOf(t),c=o===-1?i.length:o;i[c]=t,a[c]=r},n})(),UW=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),FW=typeof Map=="function",GW=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function qW(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],o=i[1],c=new GW;t[a]=c,r[o]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=t[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var $W=(function(){function n(t,r,i,a,o,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=qW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function Hp(n,e,t){var r=FW?Map:t?UW:BW,i=t||function(C){return C},a=[],o=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],S=0,T=0;return u.forEach(function(C,R){h.set(C,R)}),d.forEach(function(C,R){p.set(C,R)}),u.forEach(function(C,R){var O=p.get(C);typeof O>"u"?(++T,o.push(R)):_[O]=T}),d.forEach(function(C,R){var O=h.get(C);typeof O>"u"?(a.push(R),++S):(c.push([O,R]),T=_[R]||0,m.push([O-T,R-S]),b.push(R===O),O!==R&&w.push([O,R]))}),o.reverse(),new $W(n,e,a,o,w,c,m,b)}var HW=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=Hp(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),O_=function(n,e){return O_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},O_(n,e)};function Yp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");O_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ja=function(){return ja=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ja.apply(this,arguments)};function O3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function ik(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function ak(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function j3(n){var e=[];return n.forEach(function(t){e=e.concat(Fn(t)?j3(t):t)}),e}function a1(n,e){if(!e)return n;for(var t in e)ay(n[t])&&(n[t]=e[t]);return n}function lv(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function sk(n){var e=n.className,t=O3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function ok(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function sy(n){if(!n)return null;var e=n.b;return Fd(e)?e:sy(n.c)}function V3(n){var e=n.parentNode;e&&e.removeChild(n)}function z3(n){n.forEach(function(e){e()})}function YW(){return this.constructor(this.props,this.context)}var uS=0,oy=(function(){function n(t,r,i,a,o,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,o){var c=this,u=c.d,d=jW(r).filter(function(_){return _.$_req}),h=j3(d.map(function(_){return _.$_subs})),p=Gr(h,function(_){return _.d===u});if(c.b&&!Fr(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var S=w.d;return _[0]?_[0].d===S&&_.push(w):S>u&&_.push(w),_},[]);return m.forEach(function(_){Kp(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return Fr(i)||(c.ps=i.props,c.ref=i.ref),dS(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function L3(){return Object.__CROACT_CURRENT_INSTNACE__}function KW(){return uS}function XW(n){uS=n}function dS(n){return Object.__CROACT_CURRENT_INSTNACE__=n,uS=0,n}var fS=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=ja(ja({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,o=Kp(a.c,[a],[a.o],i,a._cs,ja(ja({},this.state),this.$_state),r);o&&(t&&i.push(t),z3(i),dS(null))},n})(),B3=(function(n){Yp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return lv(this.props,r)||lv(this.state,i)},e})(fS);function U3(n){var e=function(t){e.current=t};return e.current=n,e}function WW(n){return n._fr=!0,n}function QW(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new fS(e,t),a.constructor=n,n._fr?(r.fr=U3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=YW),a.$_p=r,a}var ZW=(function(n){Yp(e,n);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,o,c,u,a1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(a1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=a1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=QW(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=ja(ja({},i),b.$_cs);Kp(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(oy);function JW(n,e,t){var r=hS(sk(n),sk(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in o)t.setAttribute(u,o[u][1]);for(var d in a)t.removeAttribute(d)}function eQ(n,e,t){var r=hS(n,e),i=r.added,a=r.removed;for(var o in a)t.e(o,!0);for(var c in i)t.e(c)}function hS(n,e){var t=zs(n),r=zs(e),i=Hp(t,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];o[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function tQ(n,e,t){var r=t.style,i=hS(n,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=_0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=_0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=_0(u,"-");r.removeProperty(p)}}function nQ(n){return n.replace(/^on/g,"").toLowerCase()}var rQ=(function(n){Yp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,o=a._es,c=a.b,u=nQ(r);i?(qn(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},sr(c,u,o[r]))},t.s=function(r){return lv(this.ps,r)},t.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=sy(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Ud(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}Kp(c,c._ps,d.children,r,i);var w=c.b,S=ok(a),T=S[0],C=S[1],R=ok(d),O=R[0],P=R[1];return JW(T,O,w),eQ(C,P,c),tQ(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)qn(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||V3(a)},e})(oy);function cp(n){if(!n||Fd(n))return n;var e=n.$_p._ps;return e.length?cp(e[0].b):null}function F3(n){if(n){if(n.b&&Fd(n.b))return n;var e=n._ps;return e.length?F3(e[0]):null}}function na(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=O3(i,["key","ref"]);return{type:n,key:a,ref:o,props:ja(ja({},c),{children:D3(t).filter(function(u){return u!=null&&u!==!1})})}}var G3=(function(n){Yp(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(oy),iQ=(function(n){Yp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,o=!a.b;if(o){var c=sy(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Ud(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},t.un=function(){V3(this.b)},e})(oy);function aQ(n,e,t){var r=t.map(function(u){return Fr(u)?null:u.key}),i=ak(e.map(function(u){return u.k})),a=ak(r),o=Hp(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=cp(p.b),b=cp(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,lk(t[u],r[u],u,n))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=Fr(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,lk(h,r[d],d,n)),!0):(p.i=d,!1)});return ik(ik([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function sQ(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=cp(t[i].b);if(a)return a}return null}function lk(n,e,t,r){var i=r.d+1;if(Fr(n)||xd(n))return new iQ("text_".concat(n),i,e,t,r,null,{});var a=n.type,o=typeof a=="string"?rQ:ZW;return new o(a,i,e,t,r,n.ref,n.props)}function Kp(n,e,t,r,i,a,o){var c=aQ(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,o)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=F3(p);m&&(m._sel=!0)}),n._hyd=null;var h=sy(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=cp(m.b);if(b&&h!==b&&!b.parentNode){var _=sQ(n,m);h.insertBefore(b,_)}}),d.length>0}function oQ(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new G3(e));var a=[];return Kp(t,t._ps,n?[n]:[],a,r,void 0,void 0),z3(a),dS(null),i||(e.__CROACT__=t),t}function ck(n,e,t){return!t&&n&&(t=new G3(e.parentElement),t._hyd=[e],t._sel=!0),oQ(n,e,t),t}function q3(n){var e=L3(),t=e._hs||(e._hs=[]),r=KW(),i=t[r];if(XW(r+1),i){if(!lv(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function lQ(n,e){var t=q3({func:n,deps:e});return t.value}function cQ(n){return lQ(function(){return U3(n)},[])}function $3(n,e,t){var r=L3(),i=q3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function uQ(n,e,t){$3(function(){n?.(e())},t,!0)}function pS(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function H3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function Y3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function gS(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function dQ(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function fQ(n,e){var t=gS("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function j_(n){return n.replace(/_/g,".")}function dh(n,e){var t=null,r="-1";return pS(n,function(i){var a=gS("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=fQ(i.versionTest.toLowerCase(),e)||r),r=j_(r),!0)}),{preset:t,version:r}}function Bm(n,e){var t={brand:"",version:"-1"};return pS(n,function(r){var i=K3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function K3(n,e){return H3(n,function(t){var r=t.brand;return gS(""+e.test,r.toLowerCase())})}var X3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],W3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],V_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Q3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],Z3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function J3(n){return!!dh(Q3,n).preset}function hQ(n){var e=Y3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:J3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=dh(X3,e),o=a.preset,c=a.version,u=dh(Z3,e),d=u.preset,h=u.version,p=dh(W3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=dh(V_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function pQ(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Bm(Q3,t).brand||J3(Y3())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&pS(V_,function(m){return K3(t,m)});var u=Bm(W3,t);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Bm(V_,t);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=H3(Z3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Bm(X3,t);o.name=p.brand||o.name,o.version=p.brand&&n?n.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=j_(c.version),o.version=j_(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function gQ(n){return dQ()?pQ():hQ(n)}function mQ(n,e,t,r,i,a){for(var o=0;o<i;++o){var c=t+o*i,u=r+o*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function vQ(n,e,t,r,i){for(var a=0;a<i;++a){var o=t+a*i,c=r+a*i,u=n[o],d=e[o];n[o]=n[c],n[c]=u,e[o]=e[c],e[c]=d}}function yQ(n,e,t,r,i){for(var a=0;a<r;++a){var o=t+a*r;n[o]/=i,e[o]/=i}}function ej(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function Ya(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=Jt(e),i=0;i<e;++i){var a=e*i+i;if(!at(t[a],Ln)){for(var o=i+1;o<e;++o)if(t[e*i+o]){vQ(t,r,i,o,e);break}}if(!at(t[a],Ln))return[];yQ(t,r,i,e,t[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=t[u];!at(d,Ln)||i===o||mQ(t,r,c,i,e,-d)}}return r}function bQ(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function tj(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function xQ(n,e){for(var t=Jt(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function Ic(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function ca(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=Jt(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*t+o]=n[a*e+o];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function cv(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=Jt(n);return e.forEach(function(i){r=Yt(r,i,n)}),r}function Yt(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var o=0;o<t;++o)for(var c=0;c<a;++c){r[c*t+o]=0;for(var u=0;u<i;++u)r[c*t+o]+=n[u*t+o]*e[c*i+u]}return r}function It(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function Ke(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function _Q(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function nj(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function br(n,e,t){t===void 0&&(t=e.length);var r=Yt(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function wQ(n,e){return Yt(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function EQ(n,e){return Yt(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function SQ(n,e){return Yt(n,Wp(e,4))}function Um(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return Yt(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Xp(n,e){return br(Wp(e,3),Ic(n,3))}function s1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return Yt(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function uk(n,e){return Yt(n,e,4)}function Wp(n,e){var t=Math.cos(n),r=Math.sin(n),i=Jt(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function Jt(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function mS(n,e){for(var t=Jt(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function Rc(n,e){for(var t=Jt(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function vS(n,e,t,r,i,a,o,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],S=i[0],T=i[1],C=a[0],R=a[1],O=o[0],P=o[1],M=c[0],A=c[1],I=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-S*u,-T*u,-C*h,-R*h,-O*m,-P*m,-M*_,-A*_,-S*d,-T*d,-C*p,-R*p,-O*b,-P*b,-M*w,-A*w],k=Ya(I,8);if(!k.length)return[];var z=Yt(k,[S,T,C,R,O,P,M,A],8);return z[8]=1,ca(bQ(z),3,4)}var Dh=function(){return Dh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Dh.apply(this,arguments)};function TQ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function up(n,e){return e===void 0&&(e=0),zu(_d(n,e))}function AQ(n,e){var t=br(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function zu(n){var e=TQ();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function _d(n,e){e===void 0&&(e=0);var t=Fn(n)?n:rl(n);return t.map(function(r){var i=C3(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=la(e)?Dh(Dh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=ac(o).map(function(j,X){return X===0&&"x%"in h?h["%"]=e["x%"]:X===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],Ht(j,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],S=w===void 0?0:w;c=s1,d=[m,_,S]}else if(a==="translateY"){var T=la(e)?Dh({"%":e["y%"]},e):{"%":e},_=Ht(o,T);c=s1,d=[0,_,0]}else if(a==="translateZ"){var S=parseFloat(o);c=s1,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var C=ac(o).map(function(j){return parseFloat(j)}),R=C[0],O=C[1],P=O===void 0?R:O,M=C[2],A=M===void 0?1:M;c=Um,d=[R,P,A]}else if(a==="scaleX"){var R=parseFloat(o);c=Um,d=[R,1,1]}else if(a==="scaleY"){var P=parseFloat(o);c=Um,d=[1,P,1]}else if(a==="scaleZ"){var A=parseFloat(o);c=Um,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var I=$p(o),k=I.unit,z=I.value,V=k==="rad"?z:z*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=SQ):a==="rotateX"?c=wQ:a==="rotateY"&&(c=EQ),d=V}else if(a==="matrix3d")c=uk,d=ac(o).map(function(j){return parseFloat(j)});else if(a==="matrix"){var B=ac(o).map(function(j){return parseFloat(j)});c=uk,d=[B[0],B[1],0,0,B[2],B[3],0,0,0,0,1,0,B[4],B[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var z_=function(n,e){return z_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},z_(n,e)};function CQ(n,e){z_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var rj=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),ij=(function(n){CQ(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,rj)||this}return e})(HW);function IQ(n,e){return Hp(n,e,rj)}var L_=function(){return L_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},L_.apply(this,arguments)};function RQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var ly=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(la(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(la(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var o=Vs(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var o=!1;return r.eventType=t,r.stop=function(){o=!0},r.currentTarget=this,RQ(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!o},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var o=a[t];o.push(L_({listener:r},i))},n})();var B_=function(n,e){return B_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},B_(n,e)};function DQ(n,e){B_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $u=function(){return $u=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$u.apply(this,arguments)};function kQ(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function dk(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function Fm(n){if(n){if(Fr(n))return document.querySelector(n)}else return null;if(sS(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var NQ=(function(n){DQ(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=Fm(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag($u($u({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],_=m[1]-o[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?kQ:o;return c({container:Fm(a),direction:r})},t._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=lp(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Fm(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll($u($u({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?dk:i,o=Fm(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=dk(window,this._onScroll):this._unregister=a(o,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(ly);function MQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function Lr(n){return at(n,Ln)}function PQ(n,e){return n.every(function(t,r){return Lr(t-e[r])===0})}function OQ(n,e){return!Lr(n[0]-e[0])&&!Lr(n[1]-e[1])}function aj(n){return n.length<3?0:Math.abs(VW(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function fk(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,o=Dc(n),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function Dc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function U_(n,e,t){var r=n[0],i=n[1],a=Dc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=uv(u[0],u[1]),h=F_(e),p=[];if(h.forEach(function(_){var w=uv(_[0],_[1]),S=_[0];if(PQ(d,w))p.push({pos:n,line:_,type:"line"});else{var T=sj(yS(d,w),[u,_]);T.forEach(function(C){_.some(function(R){return OQ(R,C)})?p.push({pos:C,line:_,type:"point"}):Lr(S[1]-i)!==0&&p.push({pos:C,line:_,type:"intersection"})})}}),Gr(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,S=_.type,T=_.line;if(!(w[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var C=Gr(T,function(P){return P[1]!==i}),R=b[w[0]],O=C[1]>i?1:-1;R?R!==O&&++m:b[w[0]]=O}}}),m%2===1}function uv(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],o=i-t,c=a-r;Math.abs(o)<Ln&&(o=0),Math.abs(c)<Ln&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function yS(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],o=e[1],c=e[2],u=t===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,S=-(o*w+c)/a;h=[[S,w]]}else if(a===0){var w=-c/o,S=-(r*w+i)/t;h=[[S,w]]}else if(r===0){var S=-i/t,w=-(a*S+c)/o;h=[[S,w]]}else if(o===0){var S=-c/a,w=-(t*S+i)/r;h=[[S,w]]}else{var S=(r*c-o*i)/(o*t-r*a),w=-(t*S+i)/r;h=[[S,w]]}return h.map(function(T){return[T[0],T[1]]})}function sj(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],o=i[1];if(Lr(a-n[1][0])){if(!Lr(o-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(Lr(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(Lr(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=Lr(m-_[0][0])&&0<=Lr(_[0][1]-m)&&0<=Lr(b-_[1][0])&&0<=Lr(_[1][1]-b)})})),r.map(function(p){return[Lr(p[0]),Lr(p[1])]})}function F_(n){return MQ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function jQ(n,e){var t=n.slice(),r=e.slice();nk(t)===-1&&t.reverse(),nk(r)===-1&&r.reverse();var i=F_(t),a=F_(r),o=i.map(function(h){return uv(h[0],h[1])}),c=a.map(function(h){return uv(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var S=yS(h,_),T=sj(S,[m,a[w]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:w,pos:C,type:"intersection"}}))}),b.sort(function(_,w){return Is(m[0],_.pos)-Is(m[0],w.pos)}),u.push.apply(u,b),U_(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(U_(h[1],t)){var m=!1,b=Vs(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Vs(u,function(_){var w=_.index1,S=_.index2;return w===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function VQ(n,e){var t=jQ(n,e);return t.map(function(r){var i=r.pos;return i})}function zQ(n,e){var t=VQ(n,e);return aj(t)}var G_=function(n,e){return G_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},G_(n,e)};function LQ(n,e){G_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var jn=function(){return jn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},jn.apply(this,arguments)};function BQ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function o1(n){return BQ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function UQ(n){return n.touches&&n.touches.length>=2}function Gm(n){return n?n.touches?GQ(n.touches):[oj(n)]:[]}function FQ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function hk(n,e,t){var r=t.length,i=kh(n,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=kh(e,r),h=d.clientX,p=d.clientY,m=kh(t,r),b=m.clientX,_=m.clientY,w=a-h,S=o-p,T=a-b,C=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:S,distX:T,distY:C}}function l1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function GQ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(oj(n[r]));return t}function oj(n){return{clientX:n.clientX,clientY:n.clientY}}function kh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var c1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),o1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),o1(e)-o1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=hk(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],o=0;o<i;++o)a[o]=hk([e[o]],[t[o]],[r[o]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=kh(e,this.length),i=kh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),l1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),l1(e)/l1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),pk=["textarea","input"],qQ=(function(n){LQ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,S=w.container,T=w.pinchOutside,C=w.preventWheelClick,R=w.preventRightClick,O=w.preventDefault,P=w.checkInput,M=w.dragFocusedInput,A=w.preventClickEventOnDragStart,I=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,z=i._useTouch,V=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||R&&(m.which===3||m.button===2))return i.stop(),!1;if(V){var B=i._window.document.activeElement,j=m.target;if(j){var X=j.tagName.toLowerCase(),H=pk.indexOf(X)>-1,$=j.isContentEditable;if(H||$){if(P||!M&&B===j)return!1;if(B&&(B===j||$&&B.isContentEditable&&B.contains(j)))if(M)j.blur();else return!1}else if((O||m.type==="touchstart")&&B){var W=B.tagName.toLowerCase();(B.isContentEditable||pk.indexOf(W)>-1)&&B.blur()}(A||I||k)&&sr(i._window,"click",i._onClick,!0)}i.clientStores=[new c1(Gm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=lp()-i.prevTime<200,i._isMouseEvent=FQ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var ee=i._preventMouseEvent||i.emit("dragStart",jn(jn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));ee===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&m.preventDefault()}if(!i.flag)return!1;var he=0;if(V?(i._attchDragEvent(),z&&T&&(he=setTimeout(function(){sr(S,"touchstart",i.onDragStart,{passive:!1})}))):z&&T&&qn(S,"touchstart",i.onDragStart),i.flag&&UQ(m)){if(clearTimeout(he),V&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Gm(m),S=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",jn(jn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,R=i.isDrag;(S||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&S&&!R&&i._allowClickEvent(),i._useTouch&&_&&qn(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var O=m?.touches?Gm(m):[],P=O.length;P===0||!i.options.keepDragging?i.flag=!1:i._addStore(new c1(O));var M=i._getPosition(),A=lp(),I=!R&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=R||I?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",jn({data:i.data,datas:i.data,isDouble:I,isDrag:R,isClick:!R,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},M)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){qn(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),o=a[0];i._window=P3(o)?o:Ko(o),i.options=jn({checkInput:!1,container:o&&!("document"in o)?Ko(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){sr(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){sr(m,"mousedown",i.onDragStart),sr(m,"mousemove",i._passCallback)}),sr(u,"contextmenu",i._onContextMenu)),h&&sr(Ko(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){sr(m,"touchstart",i.onDragStart,p),sr(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),jn(jn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),qn(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){qn(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){qn(a,"mousedown",t.onDragStart)}),qn(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){qn(a,"touchstart",t.onDragStart)}),qn(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new c1(Gm(t));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",jn(jn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",jn(jn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",jn(jn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),jn(jn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return jn(jn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(sr(r,"dragover",this.onDrag,i),sr(t,"dragend",this.onDragEnd)),this._useMouse&&(sr(r,"mousemove",this.onDrag),sr(t,"mouseup",this.onDragEnd)),this._useTouch&&(sr(r,"touchmove",this.onDrag,i),sr(t,"touchend",this.onDragEnd,i),sr(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&(qn(r,"dragover",this.onDrag),qn(t,"dragend",this.onDragEnd)),this._useMouse&&(qn(r,"mousemove",this.onDrag),qn(t,"mouseup",this.onDragEnd)),this._useTouch&&(qn(r,"touchstart",this.onDragStart),qn(r,"touchmove",this.onDrag),qn(t,"touchend",this.onDragEnd),qn(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(ly);function $Q(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var HQ=$Q;function YQ(n){return HQ(n).toString(36)}function KQ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function XQ(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?ac(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function WQ(n,e,t,r,i){var a=Ud(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",n),o.setAttribute("data-styled-count","1"),t.nonce&&o.setAttribute("nonce",t.nonce),o.innerHTML=XQ(n,e,t),(i||a.head||a.body).appendChild(o),o}function QQ(n){var e="rCS"+YQ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=KQ(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=WQ(e,n,r,t,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var q_=function(){return q_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},q_.apply(this,arguments)};function ZQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function lj(n,e){var t=QQ(e),r=t.className;return WW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=ZQ(i,["className","cspNonce"]),d=cQ();return uQ(a,function(){return d.current},[]),$3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),na(n,q_({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var $_=function(n,e){return $_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},$_(n,e)};function Qp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var J=function(){return J=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},J.apply(this,arguments)};function JQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function eZ(n,e,t,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function tZ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function te(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Ie(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Zp(n,e){return J({events:[],props:[],name:n},e)}var nZ=["n","w","s","e"],bS=["n","w","s","e","nw","ne","sw","se"];function rZ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function iZ(n){var e=rZ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Gd=gQ(),cj=Gd.browser.webkit,uj=cj&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),dj=Gd.browser.name,fj=parseInt(Gd.browser.version,10),aZ=dj==="chrome",sZ=Gd.browser.chromium,oZ=parseInt(Gd.browser.chromiumVersion,10)||0,lZ=aZ&&fj>=109||sZ&&oZ>=109,cZ=dj==="firefox",uZ=parseInt(Gd.browser.webkitVersion,10)>=612||fj>=15,xS="moveable-",dZ=bS.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),fZ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(dZ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(iZ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(uj?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),hZ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],H_=1e-4,kr=1e-7,qm=1e-9,Y_=Math.pow(10,10),gk=-Y_,pZ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},_S={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},hj={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},pj=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Jp(n,e,t,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return J(J({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var wd=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),J(J({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function rd(n,e,t,r){var i=n.length===16,a=i?4:3,o=zc(n,t,r,a),c=te(o,4),u=te(c[0],2),d=u[0],h=u[1],p=te(c[1],2),m=p[0],b=p[1],_=te(c[2],2),w=_[0],S=_[1],T=te(c[3],2),C=T[0],R=T[1],O=te(un(n,e,a),2),P=O[0],M=O[1],A=Math.min(d,m,w,C),I=Math.min(h,b,S,R),k=Math.max(d,m,w,C),z=Math.max(h,b,S,R);d=d-A||0,m=m-A||0,w=w-A||0,C=C-A||0,h=h-I||0,b=b-I||0,S=S-I||0,R=R-I||0,P=P-A||0,M=M-I||0;var V=n[0],B=n[a+1],j=Ar(V*B);return{left:A,top:I,right:k,bottom:z,origin:[P,M],pos1:[d,h],pos2:[m,b],pos3:[w,S],pos4:[C,R],direction:j}}function gj(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=te(Ke(Td(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],S=te(Za({datas:i,distX:_,distY:w}),2),T=S[0],C=S[1];return[T,C]}function Vc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;t.is3d=o,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=Ya(i,b),t.inverseBeforeMatrix=Ya(a,b),t.absoluteOrigin=Ic(It([c,u],d),b),t.startDragBeforeDist=br(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=br(t.inverseMatrix,t.absoluteOrigin,b)}function gZ(n){return rd(n.datas.beforeTransform,[50,50],100,100).direction}function cy(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=Vs(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):Gr(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=UJ(o,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ie(Ie([],te(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function uy(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function mZ(n){var e=n.datas,t=n.distX,r=n.distY,i=te(vj({datas:e,distX:t,distY:r}),2),a=i[0],o=i[1],c=mj(e,xQ([a,o],4));return br(c,Ic([0,0,0],4),4)}function mj(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,o=n.afterTransform2,c=n.targetAllTransform,u=t?Yt(c,e,4):Yt(e,c,4),d=Yt(Ya(t?a:r,4),u,4),h=Yt(d,Ya(t?o:i,4),4);return h}function vj(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return Ke(br(i,It(c,[t,r]),u),o)}function Za(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,o=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return Ke(br(e?a:o,It(h,[r,i]),p),e?u:d)}function vZ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,o=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=o?4:3;return Ke(br(a,It(c,[r,i]),d),u)}function yZ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(o,c){var u=$p(o),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function yj(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function bZ(n,e){return yj(e).map(function(t){return n[t]})}function u1(n,e){var t=(e+1)/2;return[ov(n[0][0],n[1][0],t,1-t),ov(n[0][1],n[1][1],t,1-t)]}function Yn(n,e){var t=u1([n[0],n[1]],e[0]),r=u1([n[2],n[3]],e[0]);return u1([t,r],e[1])}function xZ(n,e,t,r,i,a){var o=zc(e,t,r,i),c=Yn(o,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function eg(n,e,t,r){return Yt(n,Mh(e,r,t),r)}function _Z(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,o=n.is3d,c=o?4:3,u;if(Fr(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=ca(up(t),4,c):u=ca(Yt(Yt(d,up([t]),4),h,4),4,c)}else u=t;return eg(a,u,i,c)}function wZ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,o=n.targetAllTransform,c=i?4:3;return eg(r,Yt(o||a,mS(e,c),c),t,c)}function dy(n,e){var t=qd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=Fn(r)?r:rl(r),K_(n,e,i)},setTransformIndex:function(r){K_(n,e,r)}}}function fy(n,e,t){var r=qd(e),i=r.startTransforms;K_(n,e,Vs(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function K_(n,e,t){var r=qd(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var o=n.state,c=_d([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function wS(n,e){var t=qd(n);t.nextTransforms=rl(e)}function qd(n){return n.originalDatas.beforeRenderable}function dv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function $m(n){return(dv(n)||[]).join(" ")}function Hm(n){return qd(n).nextStyle}function bj(n,e,t,r,i){wS(i,e);var a=Tr.drag(n,Jp(i,n.state,t,r)),o=a?a.transform:e;return J(J({transform:e,drag:a},Rr({transform:o},i)),{afterTransform:o})}function ES(n,e,t,r,i,a){var o=_Z(n.state,i,e,a),c=TZ(n,t,r,o);return c}function xj(n,e,t,r,i,a,o){var c=ES(n,e,t,i,a,o),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=Ke(r,c);return Ke(_,[m,b])}function EZ(n,e,t,r,i,a,o){var c=xj(n,e,t,r,i,a,o);return c}function SZ(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function TZ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],o/2*(1+e[1])+t[1]];return un(r,d,u)}function AZ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return xj(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function CZ(n,e,t,r,i,a){var o=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=yZ(i,e,t,p,m,u),R=o?b:0,O=o?_:0,P=eg(d,S,C,T),M=xZ(r,P,e,t,T,w);return Ke(M,[R,O])}function IZ(n,e){return Yn(Oi(n.state),e)}function RZ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function DZ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function kZ(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function _j(n,e,t){for(var r=n,i=[],a=cS(n)||dl(n),o=!t&&n===e||n===a,c=o,u=!1,d=3,h,p,m,b=!1,_=fp(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var S=qr(r),T=S("position"),C=$j(r),R=T==="fixed",O=kZ(S),P=_Q(IJ(C)),M=void 0,A=!1,I=!1,k=0,z=0,V=0,B=0,j={hasTransform:!1,fixedContainer:null};R&&(b=!0,j=MJ(r),_=j.fixedContainer);var X=P.length;!u&&(X===16||O.length)&&(u=!0,d=4,ew(i),m&&(m=ca(m,3,4))),u&&X===9&&(P=ca(P,3,4));var H=NJ(r,n),$=H.tagName,W=H.hasOffset,ee=H.isSVG,he=H.origin,K=H.targetOrigin,G=H.offset,Y=te(G,2),re=Y[0],Z=Y[1];$==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:PJ(r,d)}),i.push({type:"offset",target:r,matrix:Jt(d)}));var le=parseFloat(S("zoom"))||1;if(R)M=j.fixedContainer,A=!0;else{var fe=fp(r,e,!1,!0,S),xe=fe.offsetZoom;if(M=fe.offsetParent,A=fe.isEnd,I=fe.isStatic,w*=xe,(fe.isCustomElement||xe!==1)&&I)re-=M.offsetLeft,Z-=M.offsetTop;else if(cZ||lZ){var ve=fe.parentSlotElement;if(ve){for(var Ce=M,Ge=0,ae=0;Ce&&DZ(Ce);)Ge+=Ce.offsetLeft,ae+=Ce.offsetTop,Ce=Ce.offsetParent;re-=Ge,Z-=ae}}}if(cj&&!uZ&&W&&!ee&&I&&(T==="relative"||T==="static")&&(re-=M.offsetLeft,Z-=M.offsetTop,o=o||A),R)W&&j.hasTransform&&(V=M.clientLeft,B=M.clientTop);else if(W&&_!==M&&(k=M.clientLeft,z=M.clientTop),W&&M===a){var Te=Hj(r,!1);re+=Te[0],Z+=Te[1]}if(i.push({type:"target",target:r,matrix:Mh(P,d,he)}),O.length&&(i.push({type:"offset",target:r,matrix:Jt(d)}),i.push({type:"target",target:r,matrix:Mh(up(O),d,he)})),W){var Pe=r===n,Oe=Pe?0:r.scrollLeft,qe=Pe?0:r.scrollTop;i.push({type:"offset",target:r,matrix:Rc([re-Oe+k-V,Z-qe+z-B],d)})}else i.push({type:"offset",target:r,origin:he});if(le!==1&&i.push({type:"zoom",target:r,matrix:Mh(mS([le,le],d),d,[0,0])}),m||(m=P),h||(h=he),p||(p=K),c||R)break;r=M,o=A,(!t||r===a)&&(c=o)}return m||(m=Jt(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var Zl=null,Jl=null,Hu=null;function Ed(n){n?(window.Map&&(Zl=new Map,Jl=new Map),Hu=[]):(Zl=null,Hu=null,Jl=null)}function NZ(n){var e=Jl?.get(n);if(e)return e;var t=Ph(n,!0);return Jl&&Jl.set(n,t),t}function MZ(n,e){if(Hu){var t=Gr(Hu,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=_j(n,e,!0);return Hu&&Hu.push([[n,e],r]),r}function qr(n){var e=Zl?.get(n);if(!e){var t=Ko(n).getComputedStyle(n);if(!Zl)return function(a){return t[a]};e={style:t,cached:{}},Zl.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function ra(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},J(J({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function d1(n,e,t,r,i,a,o){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=ra(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,S){var T=m[S],C=T.state,R=C.gestos,O=w;if(c)O=new wd(o).dragStart(r,w),b.push(O);else{if(R[o]||(R[o]=h.childGestos[S]),!R[o])return;O=Jp(w,C,r,d,a,o),b.push(O)}var P=e[t](T,J(J({},O),{parentFlag:!0}));return u&&(R[o]=null),P});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:b}}function Rs(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!t.match(/End$/g),c=ra(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,J(J({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function fv(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,o=r.datas.startPositions||Oi(e.state),c=Yn(o,i),u=te(br(Wp(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function wj(n,e,t,r){var i=n.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=kc(n.props,e).zoom,d=Nh(o/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=Ar(c);return t.map(function(_){var w=_.data,S=_.classNames,T=_.dir,C=_S[T];if(!C||!h[T])return null;m[T]=!0;var R=(at(d,15)+b*hj[T]+720)%180,O={};return zs(w).forEach(function(P){O["data-".concat(P)]=w[P]}),r.createElement("div",J({className:$e.apply(void 0,Ie(["control","direction",T,e],te(S),!1)),"data-rotation":R,"data-direction":T},O,{key:"direction-".concat(T),style:mv.apply(void 0,Ie([o,u],te(C.map(function(P){return a[P]})),!1))}))})}function Ej(n,e,t,r){var i=kc(n.props,t),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?bS:o;return Ie(Ie([],te(c?Cj(n,r,t,u):[]),!1),te(wj(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function dp(n,e,t,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=An(t,r),d=e?at(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:$e.apply(void 0,Ie(["line","direction",e?"edge":"",e],te(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:hh(t,r,i,u)})}function Sj(n,e,t,r,i){var a=t===!0?nZ:t;return a.map(function(o,c){var u=te(_S[o],2),d=u[0],h=u[1];if(h!=null)return dp(n,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function Tj(n){return function(e,t){var r=kc(e.props,n).edge;return r&&(r===!0||r.length)?Ie(Ie([],te(Sj(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),te(PZ(e,n,t)),!1):Aj(e,n,t)}}function Aj(n,e,t){return Ej(n,bS,e,t)}function PZ(n,e,t){return Ej(n,["nw","ne","sw","se"],e,t)}function Cj(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=Ar(u),m=c/Math.PI*180;return(r||zs(d)).map(function(b){var _=_S[b];if(!_)return null;var w=(at(m,15)+p*hj[b]+720)%180,S=["around-control"];return t&&S.push("direction",t),e.createElement("div",{className:$e.apply(void 0,Ie([],te(S),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:mv.apply(void 0,Ie([c,h],te(_.map(function(T){return o[T]})),!1))})})}function SS(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:mk(_,e,!0),horizontal:mk(_,t,!1)}}function hy(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",S=b.left,T=S===void 0?-1/0:S,C=b.top,R=C===void 0?-1/0:C,O=b.right,P=O===void 0?w?-1/0:1/0:O,M=b.bottom,A=M===void 0?w?-1/0:1/0:M;return w&&(P=a+p-d-P,A=i+m-h-A),{left:T+d-o,right:P+d-o,top:R+h-c,bottom:A+h-c}}function OZ(n,e,t){var r=hy(n),i=r.left,a=r.top,o=r.right,c=r.bottom,u=te(t,2),d=u[0],h=u[1],p=te(Ke(t,e),2),m=p[0],b=p[1];we(m)<kr&&(m=0),we(b)<kr&&(b=0);var _=b>0,w=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var C=b/m,R=t[1]-C*d,O=0,P=0,M=!1;w&&o<=d?(O=C*o+R,P=o,M=!0):!w&&d<=i&&(O=C*i+R,P=i,M=!0),M&&(O<a||O>c)&&(M=!1),M||(_&&c<=h?(O=c,P=(O-R)/C,M=!0):!_&&h<=a&&(O=a,P=(O-R)/C,M=!0)),M&&(S.isBound=!0,S.pos=P,S.offset=d-P,T.isBound=!0,T.pos=O,T.offset=h-O)}return{vertical:S,horizontal:T}}function mk(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ie([],te(e),!1)),o=Math.max.apply(Math,Ie([],te(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return we(d.offset)-we(u.offset)})}function vk(n,e,t){var r=t?n.map(function(i){return Xp(i,t)}):n;return r.some(function(i){return i[0]<e.left&&we(i[0]-e.left)>.1||i[0]>e.right&&we(i[0]-e.right)>.1||i[1]<e.top&&we(i[1]-e.top)>.1||i[1]>e.bottom&&we(i[1]-e.bottom)>.1})}function jZ(n,e,t){var r=Pi(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return we(a-n[t?0:1])-we(o-n[t?0:1])}).map(function(a){return An([0,0],t?[a,e]:[e,a])})}function VZ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,o=hy(n),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!vk(t,w,0))return[];var S=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var C=te(T,2),R=C[0],O=C[1];t.forEach(function(P){var M=An([0,0],P);S.push.apply(S,Ie([],te(jZ(P,R,O).map(function(A){return a+A-M}).filter(function(A){return!vk(e,w,A)}).map(function(A){return at(A*180/Math.PI,kr)})),!1))})}),S}var zZ=["left","right","center"],LZ=["top","bottom","middle"],yk={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},il={start:"left",end:"right",center:"center"},al={start:"top",end:"bottom",center:"middle"};function Yu(){return{left:!1,top:!1,right:!1,bottom:!1}}function $d(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,o=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function TS(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function BZ(n,e){var t=TS(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function AS(n,e){var t=BZ(n,e),r=LZ.filter(function(a){return a in t}),i=zZ.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function UZ(n,e,t){var r=un(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function FZ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Ln&&(i=0),Math.abs(a)<Ln&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*t[0]-t[1]):(c=1,u=-t[1]):(o=-1,u=t[0]),[o,c,u].map(function(d){return at(d,Ln)})}var Ij="snapRotationThreshold",Rj="snapRotationDegrees",Dj="snapHorizontalThreshold",kj="snapVerticalThreshold";function py(n,e,t,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=Mk(o,u[Dj],5),p=Mk(a,u[kj],5);return Nj(n.state.guidelines,e,t,r,i,h,p,d)}function Nj(n,e,t,r,i,a,o,c){return{vertical:xk(n,"vertical",e,o*c[0],r),horizontal:xk(n,"horizontal",t,a*c[1],i)}}function GZ(n,e,t){var r=te(t,2),i=r[0],a=r[1],o=te(e,2),c=o[0],u=o[1],d=te(Ke(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=vv(h),p=vv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var S=py(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,C=S.horizontal;T.posInfos.filter(function($){var W=$.pos;return b?W>=c:W<=c}),C.posInfos.filter(function($){var W=$.pos;return m?W>=u:W<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var R=X_(T),O=R.isSnap,P=R.guideline,M=X_(C),A=M.isSnap,I=M.guideline,k=A?I.pos[1]:0,z=O?P.pos[0]:0;if(h===0)A&&(w.isSnap=!0,w.pos=I.pos[1],w.offset=a-w.pos);else if(p===0)O&&(_.isSnap=!0,_.pos=z,_.offset=i-z);else{var V=p/h,B=t[1]-V*i,j=0,X=0,H=!1;O?(X=z,j=V*X+B,H=!0):A&&(j=k,X=(j-B)/V,H=!0),H&&(_.isSnap=!0,_.pos=X,_.offset=i-X,w.isSnap=!0,w.pos=j,w.offset=a-j)}return{vertical:_,horizontal:w}}function zo(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function bk(n,e,t,r){var i=AS(n.props.snapDirections,e),a=py(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return zo(u)}),i.horizontalNames.map(function(u){return zo(u)}),t,r),o=zo(i.horizontalNames[a.horizontal.index]),c=zo(i.verticalNames[a.vertical.index]);return{vertical:J(J({},a.vertical),{direction:c}),horizontal:J(J({},a.horizontal),{direction:o})}}function X_(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:o}}function xk(n,e,t,r,i){var a,o;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var S=w.pos,T=p-S[u];return{offset:T,dist:we(T),guideline:w,direction:b}}).filter(function(w){var S=w.guideline,T=w.dist,C=S.type;return!(C!==e||T>r)}).sort(function(w,S){return w.dist-S.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function qZ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ie([],te(bZ([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return Yn(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=py(n,c,u,a.map(function(m){return zo(m[0])}),a.map(function(m){return zo(m[1])}),r,i),h=zo(a.map(function(m){return m[0]})[d.vertical.index]),p=zo(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:J(J({},d.vertical),{direction:h}),horizontal:J(J({},d.horizontal),{direction:p})}}function Mj(n,e){var t=we(n.offset),r=we(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<kr?1:r<kr?-1:t-r}function hv(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],o=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return Mj({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function $Z(n,e,t){var r=[];if(t)we(e[0])!==1||we(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=we(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*n[0],-1]],[[e[0],0],[o*n[0],0]],[[e[0],1],[o*n[0],1]])})}else if(n[1]){var a=we(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function Pj(n,e){var t=P_([e[0][0],e[1][0]]),r=P_([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function CS(n,e){var t=te(e,2),r=t[0],i=t[1],a=i[0]-r[0],o=i[1]-r[1];we(a)<kr&&(a=0),we(o)<kr&&(o=0);var c,u;if(!a)c=r[0],u=n[0];else if(!o)c=r[1],u=n[1];else{var d=o/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function Oj(n,e,t,r){return r===void 0&&(r=kr),n.every(function(i){var a=CS(i,e),o=a<=0;return o===t||we(a)<=r})}function _k(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function HZ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(Oj([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=Lo(t,o,b,i),T=Lo(t,o,w,i),C=Lo(t,o,m,a),R=Lo(t,o,_,a),O=S.isBound&&T.isBound,P=S.isBound||T.isBound,M=C.isBound&&R.isBound,A=C.isBound||R.isBound,I=Sd(S.offset,T.offset),k=Sd(C.offset,R.offset),z=[0,0],V=!1,B=!1;return we(k)<we(I)?(z=[I,0],V=P,B=O):(z=[0,k],V=A,B=M),{isAllBound:B,isVerticalBound:P,isHorizontalBound:A,isBound:V,offset:z}}function Lo(n,e,t,r,i,a){var o=te(e,2),c=o[0],u=o[1],d=n[0],h=t[0],p=t[1],m=vv(p[1]-h[1]),b=vv(p[0]-h[0]),_=u,w=c,S=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var O=(h[1]-d[1])/S+d[0];return _k(O,h[0],p[0],r,i)}else{var C=h[1]-d[1],R=we(C)<=(i||0);return{isBound:R,offset:R?C:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=S*(h[0]-d[0])+d[1];return _k(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],R=we(C)<=(i||0);return{isBound:R,offset:R?C:0}}}return{isBound:!1,offset:0}}function jj(n,e,t){return e.map(function(r){var i=HZ(n,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=Za({datas:t,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function YZ(n,e,t){var r,i=IS(n,e,[0,0],!1).map(function(m){return J(J({},m),{multiple:m.multiple.map(function(b){return we(b)*2})})}),a=jj(n,i,t),o=hv(a,0),c=hv(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=te(vZ({datas:t,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function KZ(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function IS(n,e,t,r){var i=n.state,a=i.allMatrix,o=i.is3d,c=zc(a,100,100,o?4:3),u=Yn(c,[0,0]);return KZ(t,r).map(function(d){var h=te(d,3),p=h[0],m=h[1],b=h[2],_=[Yn(c,m),Yn(c,b)],w=FZ(_),S=Pj(u,_),T=S.vertical,C=S.horizontal,R=CS(u,_)<=0;return{multiple:p,centerSign:R,verticalSign:T,horizontalSign:C,lineConstants:w,line:[Yn(e,m),Yn(e,b)]}})}function wk(n,e,t,r){var i=r?n.map(function(a){return Xp(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=CS(t,a)<=0;return!Oj(e,a,o)})}function XZ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return we(t[0]);if(!a)return we(t[1]);var o=a/i;return we((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function WZ(n){var e=te(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var o=a/i,c=-o*t[0]+t[1];return[-c/(o+1/o),c/(o*o+1)]}function QZ(n,e,t,r,i){var a=n.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],S=Yn(t,[0,0]);if(!wk(t,w,S,0))return[];var T=[],C=w.map(function(R){return[Pi(R),An([0,0],R)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(R){var O=An([0,0],WZ(R)),P=XZ(R);T.push.apply(T,Ie([],te(C.filter(function(M){var A=te(M,1),I=A[0];return I&&P<=I}).map(function(M){var A=te(M,2),I=A[0],k=A[1],z=Math.acos(I?P/I:0),V=k+z,B=k-z;return[o+V-O,o+B-O]}).reduce(function(M,A){return M.push.apply(M,Ie([],te(A),!1)),M},[]).filter(function(M){return!wk(e,w,S,M)}).map(function(M){return at(M*180/Math.PI,kr)})),!1))}),T}function ZZ(n){var e=n.props.innerBounds,t=Yu();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=Yn(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=IS(n,u,[0,0],!1),R=[],O=[];return C.forEach(function(P){var M=P.line,A=P.lineConstants,I=Pj(d,M),k=I.horizontal,z=I.vertical,V=Lo(M,A,w,z,1,!0),B=Lo(M,A,T,z,1,!0),j=Lo(M,A,_,k,1,!0),X=Lo(M,A,S,k,1,!0);V.isBound&&!t.top&&(R.push(p),t.top=!0),B.isBound&&!t.bottom&&(R.push(p+b),t.bottom=!0),j.isBound&&!t.left&&(O.push(h),t.left=!0),X.isBound&&!t.right&&(O.push(h+m),t.right=!0)}),{boundMap:t,horizontal:R,vertical:O}}function JZ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(we(i)<Ln&&(i=0),we(a)<Ln&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var o=a/i,c=n[1]-o*n[0];if(r){var u=o*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/o;return[d-e[0],t]}}function W_(n,e,t,r,i){var a=JZ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=Is(n,e),c=Is(a,n),u=Is(a,e),d=c>o||u>o,h=te(Za({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function pv(n,e){return n.isBound?n.offset:e.isSnap?X_(e).offset:0}function eJ(n,e,t,r,i){var a=te(e,2),o=a[0],c=a[1],u=te(t,2),d=u[0],h=u[1],p=te(r,2),m=p[0],b=p[1],_=te(i,2),w=_[0],S=_[1],T=-w,C=-S;if(n&&o&&c){T=0,C=0;var R=[];if(d&&h?R.push([0,S],[w,0]):d?R.push([w,0]):h?R.push([0,S]):m&&b?R.push([0,S],[w,0]):m?R.push([w,0]):b&&R.push([0,S]),R.length){R.sort(function(A,I){return Pi(Ke([o,c],A))-Pi(Ke([o,c],I))});var O=R[0];if(O[0]&&we(o)>Ln)T=-O[0],C=c*we(o+T)/we(o)-c;else if(O[1]&&we(c)>Ln){var P=c;C=-O[1],T=o*we(c+C)/we(P)-o}if(n&&h&&d)if(we(T)>Ln&&we(T)<we(w)){var M=we(w)/we(T);T*=M,C*=M}else if(we(C)>Ln&&we(C)<we(S)){var M=we(S)/we(C);T*=M,C*=M}else T=Sd(-w,T),C=Sd(-S,C)}}else T=o||d?-w:0,C=c||h?-S:0;return[T,C]}function tJ(n,e,t,r,i,a){if(!$d(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=kS(a.absolutePoses,[e,t]),c=Ni(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(X){return X[1]}),vertical:o.map(function(X){return X[0]})},b=TS(n.props.snapDirections),_=AS(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=gy(n,i,_,m),S=w.vertical,T=w.horizontal,C=YZ(n,o,a),R=C.vertical,O=C.horizontal,P=S.isSnap,M=T.isSnap,A=S.isBound||R.isBound,I=T.isBound||O.isBound,k=Sd(S.offset,R.offset),z=Sd(T.offset,O.offset),V=te(eJ(r,[e,t],[A,I],[P,M],[k,z]),2),B=V[0],j=V[1];return[{isBound:A,isSnap:P,offset:B},{isBound:I,isSnap:M,offset:j}]}function gy(n,e,t,r){r===void 0&&(r=t);var i=SS(hy(n),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:py(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=pv(a[0],u),p=pv(o[0],d),m=we(h),b=we(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function Ek(n,e,t,r,i,a,o){o===void 0&&(o=[1,1]);var c=SS(e,t,r),u=c.horizontal,d=c.vertical,h=Nj(n,t,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=pv(u[0],p),_=pv(d[0],m),w=we(b),S=we(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:S,bounds:d,snap:m}}}function nJ(n,e,t,r){var i=An(n,e)/Math.PI*180,a=t.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function rJ(n,e,t,r,i,a){return t.map(function(o){var c=te(o,2),u=c[0],d=c[1],h=Yn(e,u),p=Yn(e,d),m=r?iJ(n,h,p,i):gy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,S=b.isSnap,T=m.vertical,C=T.offset,R=T.isBound,O=T.isSnap,P=Ke(d,u);if(!C&&!_)return{isBound:R||w,isSnap:O||S,sign:P,offset:[0,0]};var M=nJ(h,p,m,r);if(!M)return{sign:P,isBound:!1,isSnap:!1,offset:[0,0]};var A=M==="vertical",I=[0,0];return!r&&we(d[0])===1&&we(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?I=Za({datas:a,distX:-C,distY:-_}):I=W_(h,p,-(A?C:_),A,a).offset,I=I.map(function(k,z){return k*(P[z]?2/P[z]:0)}),{sign:P,isBound:A?R:w,isSnap:A?O:S,offset:I}})}function Sk(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function iJ(n,e,t,r){var i=OZ(n,e,t),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:GZ(n,e,t),u=c.horizontal,d=c.vertical,h=Sk(a,u),p=Sk(o,d),m=we(h),b=we(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function aJ(n,e,t,r,i){var a=[-t[0],-t[1]],o=n.state,c=o.width,u=o.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,S=w===void 0?-1/0:w,T=d.right,C=T===void 0?1/0:T,R=d.bottom,O=R===void 0?1/0:R;m.forEach(function(P){var M=P[0]!==a[0],A=P[1]!==a[1],I=Yn(e,P),k=An(r,I)*360/Math.PI;if(A){var z=I.slice();(we(k-360)<2||we(k-180)<2)&&(z[1]=r[1]);var V=W_(r,z,(r[1]<I[1]?O:S)-I[1],!1,i),B=te(V.offset,2),j=B[1],X=V.isOutside;isNaN(j)||(p=u+(X?1:-1)*we(j))}if(M){var z=I.slice();(we(k-90)<2||we(k-270)<2)&&(z[0]=r[0]);var H=W_(r,z,(r[0]<I[0]?C:_)-I[0],!0,i),$=te(H.offset,1),W=$[0],ee=H.isOutside;isNaN(W)||(h=c+(ee?1:-1)*we(W))}})}return{maxWidth:h,maxHeight:p}}var Tr={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,o=n.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=Pi(d),p=An(d,[0,0]);return[e.createElement("div",{className:$e("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],Vc(n,e),fy(n,e,"translate"),SJ(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=dt(n,e,J({set:function(h){t.startValue=h}},dy(n,e))),d=r||Me(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){cy(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,S=t.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=n.props,C=T.parentMoveable,R=d?0:T.throttleDrag||h||0,O=r?0:T.throttleDragRotate||0,P=0,M=!1,A=!1,I=!1,k=!1;if(!r&&O>0&&(p||m)){var z=T.startDragRotate||0,V=at(z+An([0,0],[p,m])*180/Math.PI,O)-z,B=m*Math.abs(Math.cos((V-90)/180*Math.PI)),j=p*Math.abs(Math.cos(V/180*Math.PI)),X=Pi([j,B]);P=V*Math.PI/180,p=X*Math.cos(P),m=X*Math.sin(P)}if(!a&&!r&&!i){var H=te(tJ(n,p,m,O,!c&&u||o,t),2),$=H[0],W=H[1];M=$.isSnap,A=$.isBound,I=W.isSnap,k=W.isBound;var ee=$.offset,he=W.offset;p+=ee,m+=he}var K=It(vj({datas:t,distX:p,distY:m}),S),G=It(mZ({datas:t,distX:p,distY:m}),S);rk(G,kr),rk(K,kr),O||(!M&&!A&&(G[0]=at(G[0],R),K[0]=at(K[0],R)),!I&&!k&&(G[1]=at(G[1],R),K[1]=at(K[1],R)));var Y=Ke(K,S),re=Ke(G,S),Z=Ke(re,_),le=Ke(Y,w);t.prevDist=re,t.prevBeforeDist=Y,t.passDelta=Z,t.passDist=re;var fe=t.left+Y[0],xe=t.top+Y[1],ve=t.right-Y[0],Ce=t.bottom-Y[1],Ge=uy(t,"translate(".concat(G[0],"px, ").concat(G[1],"px)"),"translate(".concat(re[0],"px, ").concat(re[1],"px)"));if(wS(e,Ge),n.state.dragInfo.dist=r?[0,0]:re,!(!r&&!C&&Z.every(function(qe){return!qe})&&le.some(function(qe){return!qe}))){var ae=n.state,Te=ae.width,Pe=ae.height,Oe=dt(n,e,J({transform:Ge,dist:re,delta:Z,translate:G,beforeDist:Y,beforeDelta:le,beforeTranslate:K,left:fe,top:xe,right:ve,bottom:Ce,width:Te,height:Pe,isPinch:a},Rr({transform:Ge},e)));return!r&&Me(n,"onDrag",Oe),Oe}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,J(J({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=li(n,e,{});return!t&&Me(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=d1(n,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=J(J({},c),{targets:n.props.targets,events:h}),m=Me(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,J(J({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=d1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=J({targets:n.props.targets,events:a},r);return Me(n,"onDragGroup",o),o}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=d1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Me(n,"onDragGroupEnd",li(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-t.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-t.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function Vj(n,e){var t=Yn(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function sJ(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=un(t,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function zj(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=SZ(e,i,a),u=un(t,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var Tk=PS("resizable"),Q_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:Tj("resizable"),dragControlCondition:Tk,viewClassName:MS("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=Qj(o,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||n.controlGesto,!i&&Vc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=Fr(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function C(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Oi(n.state);function R(k){var z=Vj(u.startPositions,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function O(k){var z=zj(n.state,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function P(k){u.minSize=[Ht("".concat(k[0]),0)||0,Ht("".concat(k[1]),0)||0]}function M(k){var z=[k[0]||1/0,k[1]||1/0];(!xd(z[0])||isFinite(z[0]))&&(z[0]=Ht("".concat(z[0]),0)||1/0),(!xd(z[1])||isFinite(z[1]))&&(z[1]=Ht("".concat(z[1]),0)||1/0),u.maxSize=z}C(_/w),R(d||[-p[0],-p[1]]),u.setFixedDirection=R,u.setFixedPosition=O,u.setMin=P,u.setMax=M;var A=dt(n,e,{direction:p,startRatio:u.ratio,set:function(k){var z=te(k,2),V=z[0],B=z[1];u.startWidth=V,u.startHeight=B},setMin:P,setMax:M,setRatio:C,setFixedDirection:R,setFixedPosition:O,setOrigin:function(k){u.transformOrigin=k},dragStart:Tr.dragStart(n,new wd().dragStart([0,0],e))}),I=h||Me(n,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,I!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,S=r.startWidth,T=r.startHeight,C=r.prevWidth,R=r.prevHeight,O=r.minSize,P=r.maxSize,M=r.ratio,A=r.startOffsetWidth,I=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(b){var z=n.state.is3d,V=r.startOffsetMatrix,B=r.startTransformOrigin,j=z?4:3,X=up(dv(e)),H=Math.sqrt(X.length);j!==H&&(X=ca(X,H,j));var $=eg(V,X,B,j),W=zc($,A,I,j);r.startPositions=W,r.nextTargetMatrix=X,r.nextAllMatrix=$}var ee=kc(n.props,"resizable"),he=ee.resizeFormat,K=ee.throttleResize,G=K===void 0?i?0:1:K,Y=ee.parentMoveable,re=ee.keepRatioFinally,Z=r.direction,le=Z,fe=0,xe=0;!Z[0]&&!Z[1]&&(le=[1,1]);var ve=M&&(o??ee.keepRatio)||!1;function Ce(){var ft=r.fixedDirection,kt=r5(le,ve,r,e);fe=kt.distWidth,xe=kt.distHeight;var pn=le[0]-ft[0]||ve?Math.max(A+fe,kr):A,Ut=le[1]-ft[1]||ve?Math.max(I+xe,kr):I;return ve&&A&&I&&(k?Ut=pn/M:pn=Ut*M),[pn,Ut]}var Ge=te(Ce(),2),ae=Ge[0],Te=Ge[1];m||(r.setFixedDirection(r.fixedDirection),Me(n,"onBeforeResize",dt(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(ft){var kt;return r.setFixedDirection(ft),kt=te(Ce(),2),ae=kt[0],Te=kt[1],[ae,Te]},setFixedPosition:function(ft){var kt;return r.setFixedPosition(ft),kt=te(Ce(),2),ae=kt[0],Te=kt[1],[ae,Te]},boundingWidth:ae,boundingHeight:Te,setSize:function(ft){var kt;kt=te(ft,2),ae=kt[0],Te=kt[1]}},!0)));var Pe=c;c||(!i&&a?Pe=IZ(n,[0,0]):Pe=r.fixedPosition);var Oe=[0,0];a||(Oe=wJ(n,ae,Te,Z,Pe,!d&&h,r)),u&&(!u[0]&&(Oe[0]=0),!u[1]&&(Oe[1]=0));function qe(){var ft;he&&(ft=te(he([ae,Te]),2),ae=ft[0],Te=ft[1]),ae=at(ae,G),Te=at(Te,G)}if(ve){le[0]&&le[1]&&Oe[0]&&Oe[1]&&(we(Oe[0])>we(Oe[1])?Oe[1]=0:Oe[0]=0);var Ue=!Oe[0]&&!Oe[1];Ue&&qe(),le[0]&&!le[1]||Oe[0]&&!Oe[1]||Ue&&k?(ae+=Oe[0],Te=ae/M):(!le[0]&&le[1]||!Oe[0]&&Oe[1]||Ue&&!k)&&(Te+=Oe[1],ae=Te*M)}else ae+=Oe[0],Te+=Oe[1],ae=Math.max(0,ae),Te=Math.max(0,Te);t=te(R3([ae,Te],O,P,ve?M:!1),2),ae=t[0],Te=t[1],qe(),ve&&(p||re)&&(k?Te=ae/M:ae=Te*M),fe=ae-A,xe=Te-I;var Se=[fe-C,xe-R];r.prevWidth=fe,r.prevHeight=xe;var ze=CZ(n,ae,Te,Pe,w,r);if(!(!Y&&Se.every(function(ft){return!ft})&&ze.every(function(ft){return!ft}))){var Ne=Tr.drag(n,Jp(e,n.state,ze,!!a,!1,"draggable")),Le=Ne.transform,lt=S+fe,Ct=T+xe,et=dt(n,e,J({width:lt,height:Ct,offsetWidth:Math.round(ae),offsetHeight:Math.round(Te),startRatio:M,boundingWidth:ae,boundingHeight:Te,direction:Z,dist:[fe,xe],delta:Se,isPinch:!!a,drag:Ne},Jj({style:{width:"".concat(lt,"px"),height:"".concat(Ct,"px")},transform:Le},Ne,e)));return!m&&Me(n,"onResize",et),et}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,o=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=we(p)>3,_=we(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=li(n,e,{});return!r&&Me(n,"onResizeEnd",i),i}},dragGroupControlCondition:Tk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,J(J({},e),{isGroup:!0}));if(!r)return!1;var i=ra(n,"resizable",e),a=t.startOffsetWidth,o=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,S=w.minSize,T=w.startOffsetWidth,C=w.startOffsetHeight,R=a*(T?S[0]/T:0),O=o*(C?S[1]/C:0);b[0]=Math.max(b[0],R),b[1]=Math.max(b[1],O)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,S=w.maxSize,T=w.startOffsetWidth,C=w.startOffsetHeight,R=a*(T?S[0]/T:0),O=o*(C?S[1]/C:0);b[0]=Math.min(b[0],R),b[1]=Math.min(b[1],O)})}var d=Rs(n,this,"dragControlStart",e,function(b,_){return fv(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),fv(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=J(J({},r),{targets:n.props.targets,events:d.map(function(b){return J(J({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=Me(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=kc(n.props,"resizable");vy(n,"onBeforeResize",function(b){Me(n,"onBeforeResizeGroup",dt(n,e,J(J({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,J(J({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=t.fixedPosition,p=Rs(n,this,"dragControl",e,function(b,_){var w=te(br(Wp(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),S=w[0],T=w[1];return J(J({},_),{parentDist:null,parentScale:d,dragClient:It(h,[S,T]),parentKeepRatio:u})}),m=J({targets:r.targets,events:p},i);return Me(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=Rs(n,this,"dragControlEnd",e),a=li(n,e,{targets:n.props.targets,events:i});return Me(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function f1(n,e,t,r,i){var a=n.props.groupable,o=n.state,c=o.is3d?4:3,u=e.origin,d=un(n.state.rootMatrix,Ke([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=It([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=An(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Is(h,[t,r])}function w0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++o:a<n&&a<90&&n>270&&--o;var c=e*(o*360+n-r);return t.prevDeg=r+c,c}function h1(n,e,t,r){return w0(An(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function p1(n,e,t,r,i,a){var o=n.props.throttleRotate,c=o===void 0?0:o,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=_J(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=at(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function Lj(n,e,t){var r=te(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(n==="none")return[];if(Fn(n))return n.map(function(S){return Lj(S,[i,a,o,c],t)[0]});var u=te((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=Xj(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function Z_(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(Hn(t,$e("rotation-control"))||n.props.rotateAroundControls&&Hn(t,$e("around-control"))||Hn(t,$e("control"))&&Hn(t,$e("rotatable")))return!0;var r=n.props.rotationTarget;return r?OS(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var oJ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,lJ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[oJ],viewClassName:function(n){return n.isDragging("rotatable")?$e("view-rotation-dragging"):""},render:function(n,e){var t=kc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,o=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=Lj(i,h,p),b=[];if(m.forEach(function(T,C){var R=te(T,2),O=R[0],P=R[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:$e("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(P,"rad)")}},e.createElement("div",{className:$e("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:$e("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=zs(u||{}),w={};_.forEach(function(T){u[T].forEach(function(C){w[C]=T})});var S=[];Fn(o)&&(S=o.map(function(T){var C=w[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ie([],te(wj(n,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ie([],te(Cj(n,e)),!1)),b},dragControlCondition:Z_,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,S=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,R=p.offsetMatrix,O=p.targetMatrix,P=p.allMatrix,M=p.width,A=p.height;if(!h&&!m)return!1;var I=n.getRect();i.rect=I,i.transform=T,i.left=b,i.top=_;var k=function(le){var fe=zj(n.state,le);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedPosition(le)},z=function(le){var fe=sJ(n.state,le);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedDirection(le)},V=a,B=o;if(h||d||u){var j=c||0;i.beforeInfo={origin:I.beforeOrigin,prevDeg:j,defaultDeg:j,prevSnapDeg:0,startDist:0},i.afterInfo=J(J({},i.beforeInfo),{origin:I.origin}),i.absoluteInfo=J(J({},i.beforeInfo),{origin:I.origin,startValue:j})}else{var X=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(X){var H=X.getAttribute("data-direction")||"",$=pZ[H];if($){i.isControl=!0,i.isAroundControl=Hn(X,$e("around-control")),i.controlDirection=$;var W=X.getAttribute("data-resolve");W&&(i.resolveAble=W);var ee=VJ(p.rootMatrix,p.renderPoses,C);t=te(Yn(ee,$),2),V=t[0],B=t[1]}}i.beforeInfo={origin:I.beforeOrigin},i.afterInfo={origin:I.origin},i.absoluteInfo={origin:I.origin,startValue:I.rotation};var he=k;k=function(le){var fe=p.is3d?4:3,xe=te(It(tj(O,fe),le),2),ve=xe[0],Ce=xe[1],Ge=br(R,Ic([ve,Ce],fe)),ae=br(P,Ic([le[0],le[1]],fe));he(le);var Te=p.posDelta;i.beforeInfo.origin=Ke(Ge,Te),i.afterInfo.origin=Ke(ae,Te),i.absoluteInfo.origin=Ke(ae,Te),f1(n,i.beforeInfo,V,B,C),f1(n,i.afterInfo,V,B,C),f1(n,i.absoluteInfo,V,B,C)},z=function(le){var fe=Yn([[0,0],[M,0],[0,A],[M,A]],le);k(fe)}}i.startClientX=V,i.startClientY=B,i.direction=w,i.beforeDirection=S,i.startValue=0,i.datas={},fy(n,e,"rotate");var K=!1,G=!1;if(i.isControl&&i.resolveAble){var Y=i.resolveAble;Y==="resizable"&&(G=Q_.dragControlStart(n,J(J({},new wd("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}G||(K=Tr.dragStart(n,new wd().dragStart([0,0],e))),k(zJ(n));var re=dt(n,e,J(J({set:function(le){i.startValue=le*Math.PI/180},setFixedDirection:z,setFixedPosition:k},dy(n,e)),{dragStart:K,resizeStart:G})),Z=Me(n,"onRotateStart",re);return i.isRotate=Z!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?re:!1},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,C=a.startValue,R=a.rect,O=a.startClientX,P=a.startClientY;if(T){cy(n,e,"rotate");var M=gZ(e),A=b*M,I=n.props.parentMoveable,k=0,z,V,B=0,j,X,H=0,$,W,ee=180/Math.PI*C,he=S.startValue,K=!1,G=O+o,Y=P+c;if(!d&&"parentDist"in e){var re=e.parentDist;z=re,j=re,$=re}else h||d?(z=w0(u,b,_),j=w0(u,A,w),$=w0(u,A,S)):(z=h1(G,Y,b,_),j=h1(G,Y,A,w),$=h1(G,Y,A,S),K=!0);if(V=ee+z,X=ee+j,W=he+$,Me(n,"onBeforeRotate",dt(n,e,{beforeRotation:V,rotation:X,absoluteRotation:W,setRotation:function(Pe){j=Pe-ee,z=j,$=j}},!0)),t=te(p1(n,R,_,z,ee,K),3),k=t[0],z=t[1],V=t[2],r=te(p1(n,R,w,j,ee,K),3),B=r[0],j=r[1],X=r[2],i=te(p1(n,R,S,$,he,K),3),H=i[0],$=i[1],W=i[2],!(!H&&!B&&!k&&!I&&!m)){var Z=uy(a,"rotate(".concat(X,"deg)"),"rotate(".concat(j,"deg)"));m&&(a.fixedPosition=ES(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var le=AZ(n,j,a),fe=Ke(It(p||[0,0],le),a.prevInverseDist||[0,0]);a.prevInverseDist=le,a.requestValue=null;var xe=bj(n,Z,fe,h,e),ve=xe,Ce=Is([G,Y],S.startAbsoluteOrigin)-S.startDist,Ge=void 0;if(a.resolveAble==="resizable"){var ae=Q_.dragControl(n,J(J({},Jp(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:Ce}));ae&&(Ge=ae,ve=Jj(ve,ae,e))}var Te=dt(n,e,J(J({delta:B,dist:j,rotate:X,rotation:X,beforeDist:z,beforeDelta:k,beforeRotate:V,beforeRotation:V,absoluteDist:$,absoluteDelta:H,absoluteRotate:W,absoluteRotation:W,isPinch:!!h,resize:Ge},xe),ve));return Me(n,"onRotate",Te),Te}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=li(n,e,{});return Me(n,"onRotateEnd",r),r}},dragGroupControlCondition:Z_,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=Rs(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,S=b.beforeOrigin,T=It(Ke([_,w],[i,a]),Ke(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,J(J({},m),{parentRotate:0})}),d=J(J({},c),{targets:n.props.targets,events:u}),h=Me(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){vy(n,"onBeforeRotate",function(d){Me(n,"onBeforeRotateGroup",dt(n,e,J(J({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Rs(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=te(h.datas.groupClient,2),b=m[0],_=m[1],w=te(Xp(p,o*i),2),S=w[0],T=w[1],C=[S-b,T-_];return h.datas.groupClient=[S,T],J(J({},h),{parentRotate:a,groupDelta:C})});n.rotation=i*r.beforeRotation;var u=J({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return Me(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=Rs(n,this,"dragControlEnd",e),a=li(n,e,{targets:n.props.targets,events:i});return Me(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function cJ(n,e){var t,r=n.direction,i=n.classNames,a=n.size,o=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function RS(n,e){return cJ(J(J({},n),{classNames:Ie([$e("line","guideline",n.direction)],te(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(at(t,.1),"px")})}),e)}function Ak(n,e,t,r,i,a,o,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,RS({key:"".concat(e,"TargetGuideline").concat(h),classNames:[$e("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function Ck(n,e,t,r,i,a){var o=n.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?il:al,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,S=m.element,T=m.className,C=[-r[0]+_[0],-r[1]+_[1]];return RS({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[$e("bold"),T]:[$e("normal"),T],direction:e,posValue:C,sizeValue:w,zoom:c},a)})}function fh(n,e,t,r,i,a,o,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(P,M){return P}:_,S=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",R=Math.abs(i),O=b?parseFloat(R.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:$e("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(R,"px"),u)},RS({direction:e,classNames:[$e(t),o],size:"100%",posValue:[0,0],sizeValue:R,zoom:S},c),c.createElement("div",{className:$e("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},O>0?w(O,e):""))}function uJ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,o=i?il:al,c=t[o.start],u=t[o.end];return e5(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var C=b.pos,R={element:S,rect:J(J({},T),(_={},_[o.end]=T[o.start],_))},O={element:S,rect:J(J({},T),(w={},w[o.start]=T[o.end],w))},P=[0,0],M=[0,0];P[i]=C[i],P[a]=C[a],M[i]=C[i],M[a]=C[a]+b.size,h.push({type:n,pos:P,size:0,elementRect:R,direction:"",elementDirection:"end"}),p.push({type:n,pos:M,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function dJ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=uJ(c,u,r,a),m=d?al:il,b=d?il:al,_=r[m.start],w=r[m.end];p.forEach(function(S){var T=S.total,C=S.start,R=S.end,O=S.inner,P=t[h]+T[0].pos[h]-r[b.start],M=r;C.forEach(function(A){var I=A.elementRect.rect,k=M[m.start]-I[m.end];if(k>0){var z=[0,0];z[d]=t[d]+M[m.start]-_-k,z[h]=P,o.push(fh(n,c,"dashed",o.length,k,z,A.className,i))}M=I}),M=r,R.forEach(function(A){var I=A.elementRect.rect,k=I[m.start]-M[m.end];if(k>0){var z=[0,0];z[d]=t[d]+M[m.end]-_,z[h]=P,o.push(fh(n,c,"dashed",o.length,k,z,A.className,i))}M=I}),O.forEach(function(A){var I=A.elementRect.rect,k=_-I[m.start],z=I[m.end]-w,V=[0,0],B=[0,0];V[d]=t[d]-k,V[h]=P,B[d]=t[d]+w-_,B[h]=P,o.push(fh(n,c,"dashed",o.length,k,V,A.className,i)),o.push(fh(n,c,"dashed",o.length,z,B,A.className,i))})})}),o}function fJ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?al:il,p=u?il:al,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(S){var T=S.gap,C=S.gapRects,R=Math.max.apply(Math,Ie([_],te(C.map(function(M){var A=M.rect;return A[p.start]})),!1)),O=Math.min.apply(Math,Ie([w],te(C.map(function(M){var A=M.rect;return A[p.end]})),!1)),P=(R+O)/2;R===O||P===(_+w)/2||C.forEach(function(M){var A=M.rect,I=M.className,k=[t[0],t[1]];if(A[h.end]<m)k[u]+=A[h.end]-m;else if(b<A[h.start])k[u]+=A[h.start]-m-T;else return;k[d]+=P-_,a.push(fh(n,u?"vertical":"horizontal","gap",a.length,T,k,I,i))})})}),a}function J_(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,S=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,R=C===void 0?5:C,O=b.maxSnapElementGuidelineDistance,P=O===void 0?1/0:O,M=b.isDisplayGridGuidelines,A=Ni(Oi(n.state)),I=A.top,k=A.left,z=A.bottom,V=A.right,B={top:I,left:k,bottom:z,right:V,center:(k+V)/2,middle:(I+z)/2},j=mJ(n),X=Ie([],te(j),!1),H=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(he){return he*R});w&&X.push.apply(X,Ie([],te(hJ(n,B,H)),!1));var $=J({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(X.push.apply(X,Ie([],te(gJ(n,o?u:h,o?c:d,p,m,$,M)),!1)),a){var W=i.left,ee=i.top;$.left+=W,$.top+=ee,$.right+=W,$.bottom+=ee}return X.push.apply(X,Ie([],te(Uj(T||!1,S||!1,o?u:h,o?c:d,p,m,$)),!1)),X=X.filter(function(he){var K=he.element,G=he.elementRect,Y=he.type;if(!K||!G)return!0;var re=G.rect;return Bj(B,re,Y,P)}),X}function hJ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=n.state.elementRects,d=[];return[["vertical",il,al],["horizontal",al,il]].forEach(function(h){var p=te(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],S=e[b.end],T=e[b.center],C=e[_.start],R=e[_.end],O={left:t[0],top:t[1]};function P(I){var k=I.rect,z=O[b.start];return k[b.end]<w+z?w-k[b.end]:S-z<k[b.start]?k[b.start]-S:-1}var M=u.filter(function(I){var k=I.rect;return k[_.start]>R||k[_.end]<C?!1:P(I)>0}).sort(function(I,k){return P(I)-P(k)}),A=[];M.forEach(function(I){M.forEach(function(k){if(I!==k){var z=I.rect,V=k.rect,B=z[_.start],j=z[_.end],X=V[_.start],H=V[_.end];B>H||X>j||A.push([I,k])}})}),A.forEach(function(I){var k=te(I,2),z=k[0],V=k[1],B=z.rect,j=V.rect,X=B[b.start],H=B[b.end],$=j[b.start],W=j[b.end],ee=O[b.start],he=0,K=0,G=!1,Y=!1,re=!1;if(H<=w&&S<=$){if(Y=!0,he=($-H-(S-w))/2,K=H+he+(S-w)/2,we(K-T)>ee)return}else if(H<$&&W<w+ee){if(G=!0,he=$-H,K=W+he,we(K-w)>ee)return}else if(H<$&&S-ee<X){if(re=!0,he=$-H,K=X-he,we(K-S)>ee)return}else return;he&&Bj(e,j,m,a)&&(he>c||d.push({type:m,pos:m==="vertical"?[K,0]:[0,K],element:V.element,size:0,className:V.className,isStart:G,isCenter:Y,isEnd:re,gap:he,hide:!0,gapRects:[z,V],direction:"",elementDirection:""}))})}),d}function pJ(n,e,t,r){var i,a,o=n.props,c=n.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=n.getRect(),T=S.children,C=b.direction;if(T){var R=C.map(function(P,M){var A=M===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},I=A.snapSize,k=A.posName,z=A.sizeName,V=A.clientOffset;if(!I)return{dir:P,multiple:1,snapSize:I,snapOffset:0};var B=S[z],j=S[k],X=D3(T.map(function(G){return[G[k]-j,G[z],B-G[z]-G[k]+j]})).filter(function(G){return G}).sort(function(G,Y){return G-Y}),H=X[0],$=X.map(function(G){return at(G/H,.1)*I}),W=1,ee=at(B/H,.1);for(W=1;W<=10&&!$.every(function(G){return G*W%1===0});++W);var he=(-P+1)/2,K=ov(j-V,j-V+B,he,1-he);return{multiple:ee*W,dir:P,snapSize:I,snapOffset:Math.round(K/I)}}),O=R.map(function(P){return P.multiple||1});c.snapThresholdInfo.multiples=O,c.snapThresholdInfo.offset=R.map(function(P){return P.snapOffset}),R.forEach(function(P,M){P.snapSize})}}else c.snapThresholdInfo=null}function gJ(n,e,t,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,S=[0,0];pJ(n,r,i,a);var T=u.snapThresholdInfo,C=h,R=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var O=function(M){b.push({type:"horizontal",pos:[_,at(S[1]*R+M-i+w,.1)],className:$e("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},P=0;P<=t*2;P+=m)O(P);for(var P=-m;P>=-t;P-=m)O(P)}if(h){for(var O=function(A){b.push({type:"vertical",pos:[at(S[0]*C+A-r+_,.1),w],className:$e("grid-guideline"),size:t,hide:!o,direction:"",grid:!0})},P=0;P<=e*2;P+=h)O(P);for(var P=-h;P>=-e;P-=h)O(P)}return b}function Bj(n,e,t,r){return t==="horizontal"?we(n.right-e.left)<=r||we(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?we(n.bottom-e.top)<=r||we(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function mJ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return la(m)&&"element"in m?J(J({},m),{element:$a(m.element,!0)}):{element:$a(m,!0)}}).filter(function(m){return m.element}),o=IQ(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=te(m,2),_=b[0],w=b[1];d[w]=i[_]}),vJ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=TS(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,S=m.left,T=S===void 0?h.left:S,C=m.right,R=C===void 0?h.right:C,O=m.bottom,P=O===void 0?h.bottom:O,M=m.center,A=M===void 0?h.center:M,I=m.middle,k=I===void 0?h.middle:I,z=m.className,V=m.rect,B=AS({top:w,right:R,left:T,bottom:P,center:A,middle:k},V),j=B.horizontal,X=B.vertical,H=B.horizontalNames,$=B.verticalNames,W=V.top,ee=V.left,he=V.right-ee,K=V.bottom-W,G=[he,K];X.forEach(function(Y,re){p.push({type:"vertical",element:b,pos:[at(Y,.1),W],size:K,sizes:G,className:z,elementRect:m,elementDirection:yk[$[re]]||$[re],direction:""})}),j.forEach(function(Y,re){p.push({type:"horizontal",element:b,pos:[ee,at(Y,.1)],size:he,sizes:G,className:z,elementRect:m,elementDirection:yk[H[re]]||H[re],direction:""})})}),p}function Ik(n,e){return n?n.map(function(t){var r=la(t)?t:{pos:t},i=r.pos;return xd(i)?r:J(J({},r),{pos:Ht(i,e)})}):[]}function Uj(n,e,t,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=t+p-u,b=r+h-d;return Ik(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,at(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),Ik(e,m).forEach(function(_){c.push({type:"vertical",pos:[at(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function vJ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=te(UZ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),S=w.left-h-m,T=w.top-p-b,C=T+w.height,R=S+w.width,O=te(Td(a,[S,T],u),2),P=O[0],M=O[1],A=te(Td(a,[R,C],u),2),I=A[0],k=A[1];return J(J({},_),{rect:{left:P,right:I,top:M,bottom:k,center:(P+I)/2,middle:(M+k)/2}})})}function Ym(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var o=$a(r,!0);if(o){var c=Ph(o),u=Pk(e,[c.left-i.left,c.top-i.top]),d=Pk(e,[c.right-i.right,c.bottom-i.bottom]);a.left=at(u[0],1e-5),a.top=at(u[1],1e-5),a.right=at(d[0],1e-5),a.bottom=at(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=J_(n),e.enableSnap=!0,!0}function Fj(n,e,t,r,i,a){var o=zc(n,e,t,a?4:3),c=Yn(o,r);return kS(o,Ke(i,c))}function Rk(n){return n?n/we(n):0}function yJ(n,e,t,r,i,a){var o=a.fixedDirection,c=$Z(t,o,r),u=IS(n,e,t,r),d=Ie(Ie([],te(rJ(n,e,c,r,i,a)),!1),te(jj(n,u,a)),!1),h=hv(d,0),p=hv(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function bJ(n,e,t,r,i,a,o,c,u){var d=Yn(e,o),h=gy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(at(m,H_)||at(p,H_)){var b=te(Za({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],S=Math.min(i||1/0,t+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[S-t,T-r]}return[0,0]}function Gj(n,e,t,r,i,a,o,c){for(var u=Oi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=yJ(n,b,i,d,o,c),w=_.width,S=_.height,T=w.isBound,C=S.isBound,R=w.offset,O=S.offset;if(m===1&&(T||(R=0),C||(O=0)),m===0&&o&&!T&&!C)return[0,0];if(d){var P=we(R)*(t?1/t:1),M=we(O)*(r?1/r:1),A=T&&C?P<M:C||!T&&P<M;A?R=t*O/r:O=r*R/t}h+=R,p+=O}if(!d&&i[0]&&i[1]){var I=aJ(n,u,i,a,c),k=I.maxWidth,z=I.maxHeight,V=te(bJ(n,e(h,p).map(function(X){return X.map(function(H){return at(H,H_)})}),t+h,r+p,k,z,i,o,c),2),R=V[0],O=V[1];h+=R,p+=O}return[h,p]}function Nh(n){return n<0&&(n=n%360+360),n%=360,n}function xJ(n,e){e=Nh(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return we(n-r)<we(n-i)?r:i}function g1(n,e){n=Nh(n),e=Nh(e);var t=Nh(n-e);return Math.min(t,360-t)}function _J(n,e,t,r){var i,a=n.props,o=(i=a[Ij])!==null&&i!==void 0?i:5,c=a[Rj];if($d(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(O){return Ke(O,m)}),w=_.map(function(O){return Xp(O,b)}),S=Ie(Ie([],te(VZ(n,_,w,m,t)),!1),te(QZ(n,_,w,m,t)),!1);S.sort(function(O,P){return we(O-t)-we(P-t)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:t}}if(c?.length&&o){var C=c.slice().sort(function(O,P){return g1(O,r)-g1(P,r)}),R=C[0];if(g1(R,r)<=o)return{isSnap:!0,dist:t+xJ(r,R)-r}}return{isSnap:!1,dist:t}}function wJ(n,e,t,r,i,a,o){if(!$d(n,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return Gj(n,function(m,b){return Fj(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,o)}function EJ(n,e,t,r,i){if(!$d(n,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=Gj(n,function(p,m){return Fj(wZ(i,It(e,[p/a,m/o])),a,o,u,c,d)},a,o,t,c,r,i);return[h[0]/a,h[1]/o]}function SJ(n,e){e.absolutePoses=Oi(n.state)}function Dk(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;Gr(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return J(J({},r),{direction:i.direction})})}function kk(n,e,t,r,i,a){var o=SS(hy(n,a),e,t),c=o.vertical,u=o.horizontal,d=Yu();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=ZZ(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){Vs(r,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){Vs(i,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var TJ=PS("",["resizable","scalable"]),AJ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",Ij,Rj,Dj,kj,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,o=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!$d(n,""))return Xu(n,"boundMap",Yu(),function(Z){return JSON.stringify(Z)}),Xu(n,"innerBoundMap",Yu(),function(Z){return JSON.stringify(Z)}),[];t.guidelines=J_(n);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Oi(n.state),S=[],T=[],C=[],R=[],O=[],P=Ni(w),M=P.width,A=P.height,I=P.top,k=P.left,z=P.bottom,V=P.right,B={left:k,right:V,top:I,bottom:z,center:(k+V)/2,middle:(I+z)/2},j=_.length>0,X=j?Ni(_):{};if(!d.request){if(d.direction&&O.push(qZ(n,w,d.direction,p,p)),d.snap){var H=Ni(w);d.center&&(H.middle=(H.top+H.bottom)/2,H.center=(H.left+H.right)/2),O.push(bk(n,H,p,p))}j&&(d.center&&(X.middle=(X.top+X.bottom)/2,X.center=(X.left+X.right)/2),O.push(bk(n,X,p,p))),O.forEach(function(Z){var le=Z.vertical.posInfos,fe=Z.horizontal.posInfos;S.push.apply(S,Ie([],te(le.filter(function(xe){var ve=xe.guidelineInfos;return ve.some(function(Ce){var Ge=Ce.guideline;return!Ge.hide})}).map(function(xe){return{type:"snap",pos:xe.pos}})),!1)),T.push.apply(T,Ie([],te(fe.filter(function(xe){var ve=xe.guidelineInfos;return ve.some(function(Ce){var Ge=Ce.guideline;return!Ge.hide})}).map(function(xe){return{type:"snap",pos:xe.pos}})),!1)),C.push.apply(C,Ie([],te(Dk(le)),!1)),R.push.apply(R,Ie([],te(Dk(fe)),!1))})}var $=kk(n,[k,V],[I,z],S,T),W=$.boundMap,ee=$.innerBoundMap;j&&kk(n,[X.left,X.right],[X.top,X.bottom],S,T,d.externalBounds);var he=Ie(Ie([],te(C),!1),te(R),!1),K=he.filter(function(Z){return Z.element&&!Z.gapRects}),G=he.filter(function(Z){return Z.gapRects}).sort(function(Z,le){return Z.gap-le.gap});Me(n,"onSnap",{guidelines:he.filter(function(Z){var le=Z.element;return!le}),elements:K,gaps:G},!0);var Y=Xu(n,"boundMap",W,function(Z){return JSON.stringify(Z)},Yu()),re=Xu(n,"innerBoundMap",ee,function(Z){return JSON.stringify(Z)},Yu());return(W===Y||ee===re)&&Me(n,"onBound",{bounds:W,innerBounds:ee},!0),Ie(Ie(Ie(Ie(Ie(Ie([],te(dJ(n,K,[m,b],B,e)),!1),te(fJ(n,G,[m,b],B,e)),!1),te(Ck(n,"horizontal",R,[i,r],B,e)),!1),te(Ck(n,"vertical",C,[i,r],B,e)),!1),te(Ak(n,"horizontal",T,m,r,M,0,e)),!1),te(Ak(n,"vertical",S,b,i,A,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Ym(n)},drag:function(n){var e=n.state;Ym(n)||(e.guidelines=J_(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(TJ(n,e)||Z_(n,e))return!0;if(!e.isRequest&&e.inputEvent)return Hn(e.inputEvent.target,$e("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,Ym(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,Ym(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function CJ(n,e){return[n[0]*e[0],n[1]*e[1]]}function $e(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return wW.apply(void 0,Ie([xS],te(n),!1))}function qj(n){n()}function IJ(n){return!n||n==="none"?[1,0,0,1,0,0]:la(n)?n:up(n)}function Mh(n,e,t){return cv(e,Rc(t,e),n,Rc(t.map(function(r){return-r}),e))}function RJ(n,e,t){if(e==="%"){var r=DS(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function DJ(n){var e=kJ(NS(n,":before"));return e.map(function(t,r){var i=$p(t),a=i.value,o=i.unit;return a*RJ(n,o,r===0)})}function gv(n){return n?n.split(" "):["0","0"]}function kJ(n){return gv(n.transformOrigin)}function $j(n){var e=qr(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function fp(n,e,t,r,i){var a,o,c=cS(n)||dl(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",S=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(_=!0);var R=qr(d),O=d.tagName.toLowerCase(),P=$j(d),M=R("willChange"),A=parseFloat(R("zoom"))||1;if(w=R("position"),r&&A!==1){S=A;break}if(!t&&r&&T!==1&&C&&C!=="absolute"||O==="svg"||O==="foreignobject"||w!=="static"||P&&P!=="none"||M==="transform")break;var I=(o=n?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;I&&(u=!0,h=k);var z=k;if(z&&z.nodeType===11){d=z.host,b=!0,w=qr(d)("position");break}d=z,w="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function NJ(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,o=qr(n),c=ay(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=uj?DJ(n):gv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=te(OJ(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=gv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function Hj(n,e){var t=qr(n),r=qr(dl(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,o]}function ew(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=ca(t,3,4))})}function MJ(n){for(var e=n.parentElement,t=!1,r=dl(n);e;){var i=NS(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function my(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat(nj(n,!e).join(","),")")}function DS(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function PJ(n,e){var t,r=DS(n),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);_[0]=C,_[1]=C,w[0]=(o-i)/2*S,w[1]=(c-a)/2*T}var R=mS(_,e);return t=te(w,2),R[e*(e-1)]=t[0],R[e*(e-1)+1]=t[1],Mh(R,e,b)}function OJ(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=qr(n),a=i("transform-box")==="fill-box",o=n.getBBox(),c=DS(n.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function un(n,e,t){return br(n,Ic(e,t),t)}function zc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return un(n,i,r)})}function Ni(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ie([],te(e),!1)),i=Math.min.apply(Math,Ie([],te(t),!1)),a=Math.max.apply(Math,Ie([],te(e),!1)),o=Math.max.apply(Math,Ie([],te(t),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function Nk(n,e,t,r){var i=zc(n,e,t,r);return Ni(i)}function jJ(n,e,t,r,i){var a,o=n.target,c=n.origin,u=e.matrix,d=Kj(o),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===dl(t)&&(b=Hj(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],S=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,C=_.height,R=cv(r,i,u),O=Nk(R,h,p,r),P=O.left,M=O.top,A=O.width,I=O.height,k=un(R,c,r),z=Ke(k,[P,M]),V=[w+z[0]*T/A,S+z[1]*C/I],B=[0,0],j=0;++j<10;){var X=Ya(i,r);a=te(Ke(un(X,V,r),un(X,k,r)),2),B[0]=a[0],B[1]=a[1];var H=cv(r,i,Rc(B,r),u),$=Nk(H,h,p,r),W=$.left,ee=$.top,he=W-w,K=ee-S;if(we(he)<2&&we(K)<2)break;V[0]-=he,V[1]-=K}return B.map(function(G){return Math.round(G)})}function VJ(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return un(n,u,i)}),o=t.left,c=t.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function Pi(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Yj(n,e){return Pi([e[0]-n[0],e[1]-n[1]])}function hh(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=An(n,e));var i=Yj(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function mv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,o=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function kc(n,e){var t=n[e];return la(t)?J(J({},n),t):n}function Kj(n){var e=n&&!ay(n.offsetWidth),t=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,S=1/0,T=1/0,C=0,R=0,O=!1;if(n)if(!e&&n.ownerSVGElement){var P=n.getBBox();O=!0,t=P.width,r=P.height,o=t,c=r,u=t,d=r,i=t,a=r}else{var M=qr(n),A=n.style,I=M("boxSizing")==="border-box",k=parseFloat(M("borderLeftWidth"))||0,z=parseFloat(M("borderRightWidth"))||0,V=parseFloat(M("borderTopWidth"))||0,B=parseFloat(M("borderBottomWidth"))||0,j=parseFloat(M("paddingLeft"))||0,X=parseFloat(M("paddingRight"))||0,H=parseFloat(M("paddingTop"))||0,$=parseFloat(M("paddingBottom"))||0,W=j+X,ee=H+$,he=k+z,K=V+B,G=W+he,Y=ee+K,re=M("position"),Z=0,le=0;if("clientLeft"in n){var fe=null;if(re==="absolute"){var xe=fp(n,dl(n));fe=xe.offsetParent}else fe=n.parentElement;if(fe){var ve=qr(fe);Z=parseFloat(ve("width")),le=parseFloat(ve("height"))}}h=Math.max(W,Ht(M("minWidth"),Z)||0),p=Math.max(ee,Ht(M("minHeight"),le)||0),_=Ht(M("maxWidth"),Z),w=Ht(M("maxHeight"),le),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),C=Ht(A.width,0)||0,R=Ht(A.height,0)||0,o=parseFloat(M("width"))||0,c=parseFloat(M("height"))||0,u=we(o-C)<1?M_(h,C||o,_):o,d=we(c-R)<1?M_(p,R||c,w):c,t=u,r=d,i=u,a=d,I?(S=_,T=w,m=h,b=p,u=t-G,d=r-Y):(S=_+G,T=w+Y,m=h+G,b=p+Y,t=u+G,r=d+Y),i=u+W,a=d+ee}return{svg:O,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:R,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function Xj(n,e){return An(e>0?n[0]:n[1],e>0?n[1]:n[0])}function Km(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function Wj(n,e){var t=n===dl(n)||n===cS(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=qr(n)("overflow")!=="visible",J(J({},e),r)}function m1(n,e,t,r){var i=n.left,a=n.right,o=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return t&&r?Wj(t,h):h}function Ph(n,e){var t=0,r=0,i=0,a=0;if(n){var o=n.getBoundingClientRect();t=o.left,r=o.top,i=o.width,a=o.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?Wj(n,c):c}function zJ(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?jS(r,a,o):u}function Qj(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=Zj(a,r)}return i}function Zj(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function kS(n,e){return[It(e,n[0]),It(e,n[1]),It(e,n[2]),It(e,n[3])]}function Oi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,o=n.pos4;return kS([r,i,a,o],[e,t])}function tw(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Ku(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&tw(n,e),r?.unset(),n[t]=null}function Rr(n,e){if(e){var t=qd(e);t.nextStyle=J(J({},t.nextStyle),n)}return{style:n,cssText:zs(n).map(function(r){return"".concat(_0(r,"-"),": ").concat(n[r],";")}).join("")}}function Jj(n,e,t){var r=e.afterTransform||e.transform;return J(J({},Rr(J(J(J({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function dt(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=J(J({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function li(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),J(J({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function vy(n,e,t){n._emitter.on(e,t)}function Me(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function NS(n,e){return Ko(n).getComputedStyle(n,e)}function Xm(n,e,t){var r={},i={};return n.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function nw(n,e){return n===e||n==null&&e==null}function Mk(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!ay(i))return i}return n[t]}function e5(n,e){var t=[],r=[];return n.forEach(function(i,a){var o=e(i,a,n),c=r.indexOf(o),u=t[c]||[];c===-1&&(r.push(o),t.push(u)),u.push(i)}),t}function LJ(n,e){var t=[],r={};return n.forEach(function(i,a){var o=e(i,a,n),c=r[o];c||(c=[],r[o]=c,t.push(c)),c.push(i)}),t}function t5(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Sd(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return we(r)-we(t)}),n[0]}function Td(n,e,t){return br(Ya(n,t),Ic(e,t),t)}function BJ(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=te(Td(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function Si(n,e,t,r){if(!t[0]&&!t[1])return e;var i=un(n,[Rk(t[0]||1),0],r),a=un(n,[0,Rk(t[1]||1)],r),o=un(n,[t[0]/Pi(i),t[1]/Pi(a)],r);return It(e,o)}function Qi(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function vv(n){return we(n)<=kr?0:n}function MS(n){return function(e){if(!e.isDragging(n))return"";var t=RZ(e,n),r=t.deg;return r?$e("view-control-rotation".concat(r)):""}}function PS(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return Hn(i,$e("direction"))&&(!n||Hn(i,$e(n)))}}function UJ(n,e,t){var r,i=_d(n,{"x%":function(P){return P/100*e.offsetWidth},"y%":function(P){return P/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),o=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:_d([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],S=zu(h),T=zu(p),C=zu(b),R=zu(_),O=Yt(S,C,4);return{transforms:n,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:zu(w),afterFunctionMatrix:C,afterFunctionMatrix2:R,allFunctionMatrix:O,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function FJ(n){return!n||!la(n)||Fd(n)?!1:Fn(n)||"length"in n}function $a(n,e){return n?Fd(n)?n:Fr(n)?e?document.querySelector(n):n:sS(n)?n():P3(n)?n:"current"in n?n.current:n:null}function OS(n,e){if(!n)return[];var t=FJ(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return Fr(i)&&e?Ie(Ie([],te(r),!1),te([].slice.call(document.querySelectorAll(i))),!1):(Fn(i)?r.push(OS(i,e)):r.push($a(i,e)),r)},[])}function GJ(n,e,t){var r=An(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function Pk(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=Ya(t,i);return r||(a=ca(a,3,4)),a[12]=0,a[13]=0,a[14]=0,AQ(a,e)}function n5(n,e,t,r,i){var a=te(n,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=An([0,0],e),p=An([0,0],r),m=Pi(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*o,w=r[1]*c,S=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;we(S-T)<Math.PI/2||we(S-T)>Math.PI/2*3||(T+=Math.PI),C=S-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var R=Pi([_+e[0],w+e[1]])*Math.cos(C);u=R*Math.sin(T)-_,d=R*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function r5(n,e,t,r){var i,a=t.ratio,o=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,S=t.fixedDirection,T=[0,1].map(function(A){return we(n[A]-S[A])}),C=[0,1].map(function(A){var I=T[A];return I!==0&&(I=2/I),I});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(xd(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(b){var R=o*T[0],O=c*T[1],P=Pi([R,O]);u=b/P*R*C[0],d=b/P*O*C[1]}else{var M=Za({datas:t,distX:h,distY:p});M=C.map(function(A,I){return M[I]*A}),i=te(n5([o,c],M,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function rw(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=te(n.split(" "),2),r=t[0],i=t[1],a=rw(r||""),o=rw(i||""),c=J(J({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function jS(n,e,t){var r=rw(n,!0),i=r.x,a=r.y;return[Ht(i,e)||0,Ht(a,t)||0]}function qJ(n,e,t){var r=n.map(function(a){return Ke(a,e)}),i=r.map(function(a){return Xp(a,t)});return{prev:r,next:i,result:i.map(function(a){return It(a,e)})}}function i5(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=Fn(t),o=Fn(i);return a&&o?i5(t,i):!a&&!o?t===i:!1})}function Xu(n,e,t,r,i){var a=n._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=t,t;return o===t||r(o)===r(t)?o:(a[e]=t,t)}function Ar(n){return n>=0?1:-1}function we(n){return Math.abs(n)}function v1(n,e){return LW(n).map(function(t){return e(t)})}function a5(n){return xd(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var $J=Zp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=n.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=dt(n,e,{});r&&(m.targets=r);var b=Me(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var S=J(J({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,S)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=dt(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");Me(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,J(J({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=li(n,e,{isDrag:r});a&&(u.targets=a),Me(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,J(J({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,J(J({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,J(J({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,J(J({},e),{targets:n.props.targets}))}}),Ok=PS("scalable"),HJ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:Tj("scalable"),dragControlCondition:Ok,viewClassName:MS("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=Qj(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Vc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];fy(n,e,"scale"),t.isWidth=w;function S(M){t.ratio=M&&isFinite(M)?M:0}t.startPositions=Oi(n.state);function T(M){var A=Vj(t.startPositions,M);t.fixedDirection=A.fixedDirection,t.fixedPosition=A.fixedPosition,t.fixedOffset=A.fixedOffset}t.setFixedDirection=T,S(Is(m,b)/Is(b,_)),T([-o[0],-o[1]]);var C=function(M){t.minScaleSize=M},R=function(M){t.maxScaleSize=M};C([-1/0,-1/0]),R([1/0,1/0]);var O=dt(n,e,J(J({direction:o,set:function(M){t.startValue=M},setRatio:S,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:R},dy(n,e)),{dragStart:Tr.dragStart(n,new wd().dragStart([0,0],e))})),P=Me(n,"onScaleStart",O);return t.startFixedDirection=t.fixedDirection,P!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:o}),t.isScale?O:!1},dragControl:function(n,e){cy(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,S=t.isWidth,T=t.ratio;if(!_)return!1;var C=n.props,R=C.throttleScale,O=C.parentMoveable,P=p;!p[0]&&!p[1]&&(P=[1,1]);var M=T&&(r??C.keepRatio)||!1,A=n.state,I=[w[0],w[1]];function k(){var ae=r5(P,M,t,e),Te=ae.distWidth,Pe=ae.distHeight,Oe=m?(m+Te)/m:1,qe=b?(b+Pe)/b:1;w[0]||(I[0]=Te/m),w[1]||(I[1]=Pe/b);var Ue=(P[0]||M?Oe:1)*I[0],Se=(P[1]||M?qe:1)*I[1];return Ue===0&&(Ue=Ar(h[0])*qm),Se===0&&(Se=Ar(h[1])*qm),[Ue,Se]}var z=k();if(!a&&n.props.groupable){var V=A.snapRenderInfo||{},B=V.direction;Fn(B)&&(B[0]||B[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}Me(n,"onBeforeScale",dt(n,e,{scale:z,setFixedDirection:function(ae){return t.setFixedDirection(ae),z=k(),z},startFixedDirection:t.startFixedDirection,setScale:function(ae){z=ae}},!0));var j=[z[0]/I[0],z[1]/I[1]],X=o,H=[0,0],$=Ar(j[0]*j[1]),W=!o&&!i&&a;if(W||d?X=ES(n,t.targetAllTransform,[0,0],[0,0],t):o||(X=t.fixedPosition),a||(H=EJ(n,j,p,!u&&c,t)),M){P[0]&&P[1]&&H[0]&&H[1]&&(Math.abs(H[0]*m)>Math.abs(H[1]*b)?H[1]=0:H[0]=0);var ee=!H[0]&&!H[1];if(ee&&(S?j[0]=at(j[0]*I[0],R)/I[0]:j[1]=at(j[1]*I[1],R)/I[1]),P[0]&&!P[1]||H[0]&&!H[1]||ee&&S){j[0]+=H[0];var he=m*j[0]*I[0]/T;j[1]=Ar($*j[0])*we(he/b/I[1])}else if(!P[0]&&P[1]||!H[0]&&H[1]||ee&&!S){j[1]+=H[1];var K=b*j[1]*I[1]*T;j[0]=Ar($*j[1])*we(K/m/I[0])}}else j[0]+=H[0],j[1]+=H[1],H[0]||(j[0]=at(j[0]*I[0],R)/I[0]),H[1]||(j[1]=at(j[1]*I[1],R)/I[1]);j[0]===0&&(j[0]=Ar(h[0])*qm),j[1]===0&&(j[1]=Ar(h[1])*qm),z=CJ(j,[I[0],I[1]]);var G=[m,b],Y=[m*z[0],b*z[1]];Y=R3(Y,t.minScaleSize,t.maxScaleSize,M?T:!1),z=v1(2,function(ae){return G[ae]?Y[ae]/G[ae]:Y[ae]}),j=v1(2,function(ae){return z[ae]/I[ae]});var re=v1(2,function(ae){return h[ae]?j[ae]/h[ae]:j[ae]}),Z="scale(".concat(j.join(", "),")"),le="scale(".concat(z.join(", "),")"),fe=uy(t,le,Z),xe=!w[0]||!w[1],ve=EZ(n,xe?le:Z,t.fixedDirection,X,t.fixedOffset,t,xe),Ce=W?ve:Ke(ve,t.prevInverseDist||[0,0]);if(t.prevDist=j,t.prevInverseDist=ve,z[0]===h[0]&&z[1]===h[1]&&Ce.every(function(ae){return!ae})&&!O&&!W)return!1;var Ge=dt(n,e,J({offsetWidth:m,offsetHeight:b,direction:p,scale:z,dist:j,delta:re,isPinch:!!a},bj(n,fe,Ce,a,e)));return Me(n,"onScale",Ge),Ge},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=li(n,e,{});return Me(n,"onScaleEnd",r),r},dragGroupControlCondition:Ok,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=ra(n,"resizable",e);t.moveableScale=n.scale;var a=Rs(n,this,"dragControlStart",e,function(d,h){return fv(n,d,t,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),fv(n,h.moveable,t,i[p])})};t.setFixedDirection=o;var c=J(J({},r),{targets:n.props.targets,events:a,setFixedDirection:o}),u=Me(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){vy(n,"onBeforeScale",function(h){Me(n,"onBeforeScaleGroup",dt(n,e,J(J({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var o=n.props.keepRatio,c=t.fixedPosition,u=Rs(n,this,"dragControl",e,function(h,p){var m=te(br(Wp(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return J(J({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:It(c,[b,_])})}),d=J({targets:n.props.targets,events:u},r);return Me(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=Rs(n,this,"dragControlEnd",e),a=li(n,e,{targets:n.props.targets,events:i});return Me(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function Io(n,e){return n.map(function(t,r){return ov(t,e[r],1,2)})}function jk(n,e,t){var r=An(n,e),i=An(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function YJ(n,e){var t=jk(n[0],n[1],n[2]),r=jk(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var KJ={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:MS("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,o=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=Io(u,d),b=Io(d,u),_=Io(u,h),w=Io(h,u),S=Io(h,p),T=Io(p,h),C=Io(d,p),R=Io(p,d);return Ie([e.createElement("div",{className:$e("line"),key:"middeLine1",style:hh(m,S,o)}),e.createElement("div",{className:$e("line"),key:"middeLine2",style:hh(b,T,o)}),e.createElement("div",{className:$e("line"),key:"middeLine3",style:hh(_,C,o)}),e.createElement("div",{className:$e("line"),key:"middeLine4",style:hh(w,R,o)})],te(Aj(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return Hn(t,$e("direction"))&&Hn(t,$e("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,o=Zj(a,t);if(!o||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:ca(p,3,4),t.targetInverseMatrix=ej(Ya(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return Ke(C,u)}),t.nextPoses=t.poses.map(function(C){var R=te(C,2),O=R[0],P=R[1];return br(t.warpTargetMatrix,[O,P,0,1],4)}),t.startValue=Jt(4),t.prevMatrix=Jt(4),t.absolutePoses=Oi(c),t.posIndexes=yj(o),Vc(n,e),fy(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=dt(n,e,J({set:function(C){t.startValue=C}},dy(n,e))),T=Me(n,"onWarpStart",S);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(cy(n,e,"matrix3d"),$d(n,"warpable")){var b=p.map(function(k){return m[k]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=gy(n,r,{horizontal:b.map(function(k){return k[1]+a}),vertical:b.map(function(k){return k[0]+i})}),w=_.horizontal,S=_.vertical;a-=w.offset,i-=S.offset}var T=Za({datas:t,distX:i,distY:a},!0),C=t.nextPoses.slice();if(p.forEach(function(k){C[k]=It(C[k],T)}),!hZ.every(function(k){return YJ(k.map(function(z){return h[z]}),k.map(function(z){return C[z]}))}))return!1;var R=vS(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!R.length)return!1;var O=Yt(o,R,4),P=mj(t,O,!0),M=Yt(Ya(c,4),P,4);t.prevMatrix=P;var A=Yt(d,P,4),I=uy(t,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(P.join(", "),")"));return wS(e,I),Me(n,"onWarp",dt(n,e,J({delta:M,matrix:A,dist:P,multiply:Yt,transform:I},Rr({transform:I},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,Me(n,"onWarpEnd",li(n,e,{})),r):!1}},XJ=$e("area-pieces"),Wm=$e("area-piece"),s5=$e("avoid"),WJ=$e("view-dragging");function y1(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;M3(e,s5),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Vk(n){return n.createElement("div",{key:"area_pieces",className:XJ},n.createElement("div",{className:Wm}),n.createElement("div",{className:Wm}),n.createElement("div",{className:Wm}),n.createElement("div",{className:Wm}))}var o5={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,o=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?$e("area","pass"):$e("area");if(a)return[e.createElement("div",{key:"area",ref:Cs(n,"areaElement"),className:p}),Vk(e)];if(!r||!i)return[];var m=vS([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?my(m,!0):"none";return[e.createElement("div",{key:"area",ref:Cs(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),Vk(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var o=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=Ni(d),w=_.left,S=_.top,T=_.width,C=_.height,R=p?4:3,O=te(Td(h,[r-m,i-b],R),2),P=O[0],M=O[1];P-=w,M-=S;var A=[{left:w,top:S,width:T,height:M-10},{left:w,top:S,width:P-10,height:C},{left:w,top:S+M+10,width:T,height:C-M-10},{left:w+P+10,top:S,width:T-P-10,height:C}],I=[].slice.call(o.nextElementSibling.children);A.forEach(function(k,z){I[z].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),N3(o,s5),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,y1(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||y1(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){y1(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&I3(function(){e.disableNativeEvent=!1})}},QJ=Zp("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,o=n.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,_=o.offsetWidth,w=o.offsetHeight,S;if(!a&&d&&i){var T=te(jS(i,_,w),2),C=T[0],R=T[1],O=p?4:3,P=un(h,[C,R],O);S=mv(u,r,Ke(P,[m,b]))}else S=mv(u,r,c);return[e.createElement("div",{className:$e("control","origin"),style:S,key:"beforeOrigin"})]}});function ZJ(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var JJ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,o=new NQ,c=$a(i,!0);e.datas.dragScroll=o,n.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=dt(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),Me(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),o.dragStart(e,J({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?ZJ:h,m=r.scrollOptions;return t.drag(e,J({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,J(J({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,J(J({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,J(J({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,J(J({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,J(J({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,J(J({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,J(J({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},l5={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},eee=Zp("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=a5(t.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(S,T){var C=te(S,2),R=C[0],O=C[1],P=_[R],M=_[O],A=d[R],I=d[O],k=vS([0,0],[100,0],[0,100],[100,100],P,M,A,I);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:$e("padding"),style:{transform:my(k,!0)}})})}}),zk=["nw","ne","se","sw"];function Qm(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var tee=[1,2,5,6],nee=[0,3,4,7],ec=[1,-1,-1,1],tc=[1,1,-1,-1];function VS(n,e,t,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(Qi(S,r,e)),S}else{var S=Math.max(0,b===1?w[0]-i:o-w[0]);return u.push(Qi(S,t,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function c5(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function u5(n,e,t,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,S=_.length,T=S>0,C=te(b,4),R=C[0],O=R===void 0?"0px":R,P=C[1],M=P===void 0?O:P,A=C[2],I=A===void 0?O:A,k=C[3],z=k===void 0?M:k,V=te(_,4),B=V[0],j=B===void 0?O:B,X=V[1],H=X===void 0?T?j:M:X,$=V[2],W=$===void 0?T?j:I:$,ee=V[3],he=ee===void 0?T?H:z:ee,K=[O,M,I,z].map(function(fe){return Ht(fe,e)}),G=[j,H,W,he].map(function(fe){return Ht(fe,t)}),Y=K.slice(),re=G.slice();c=te(Qm([Y[0],Y[1]],e),2),Y[0]=c[0],Y[1]=c[1],u=te(Qm([Y[3],Y[2]],e),2),Y[3]=u[0],Y[2]=u[1],d=te(Qm([re[0],re[3]],t),2),re[0]=d[0],re[3]=d[1],h=te(Qm([re[1],re[2]],t),2),re[1]=h[0],re[2]=h[1];var Z=o?Y:Y.slice(0,Math.max(a[0],w)),le=o?re:re.slice(0,Math.max(a[1],S));return Ie(Ie([],te(Z.map(function(fe,xe){var ve=zk[xe];return{virtual:xe>=w,horizontal:ec[xe],vertical:0,pos:[r+fe,i+(tc[xe]===-1?t:0)],sub:!0,raw:K[xe],direction:ve}})),!1),te(le.map(function(fe,xe){var ve=zk[xe];return{virtual:xe>=S,horizontal:0,vertical:tc[xe],pos:[r+(ec[xe]===-1?e:0),i+fe],sub:!0,raw:G[xe],direction:ve}})),!1)}function ree(n,e,t,r,i){i===void 0&&(i=e.length);var a=c5(n.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function iee(n,e,t,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=c5(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=ec[r]===1?a-d:c-a,w=m[1];w<=r;++w){var S=tc[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:ec[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:ec[w],vertical:0,pos:[T,S]}),e.splice(t+w,0,[T,S]),w===0)break}else if(i>-1){var C=tc[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var R=[d+C,h];n.push({horizontal:ec[0],vertical:0,pos:R}),e.push(R)}for(var O=b[0],w=b[1];w<=i;++w){var T=ec[w]===1?d:c,S=0;if(i===w?S=o:w===0?S=h+C:tc[w]===1?S=e[t+O][1]:tc[w]===-1&&(S=u-(e[t+O][1]-h)),n.push({horizontal:0,vertical:tc[w],pos:[T,S]}),e.push([T,S]),w===0)break}}}function aee(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var see=[[0,-1,"n"],[1,0,"e"]],oee=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function zS(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(M){return"".concat(Qi(M[0],a,r)," ").concat(Qi(M[1],o,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(M){return"".concat(M,"px")});var S=[m,a-b,o-w,_].map(function(M,A){return Qi(M,A%2?a:o,r)});if(t.length>8){var T=te(Ke(t[4],t[0]),2),C=T[0],R=T[1];S.push.apply(S,Ie(["round"],te(VS(d.slice(8).map(function(M,A){return J(J({},M),{pos:t[A]})}),r,C,R,_,m,b,w).styles),!1))}return S}else if(p||u==="ellipse"){var O=t[0],P=Qi(we(t[1][1]-O[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[P]:[Qi(we(t[2][0]-O[0]),a,r),P];return S.push("at",Qi(O[0],a,r),Qi(O[1],o,r)),S}}function yv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return oee.map(function(o){var c=te(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:we(d),horizontal:we(u),direction:h,pos:[p,m]}})}function d5(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[we(e[1]-e[0]),we(t[1]-t[0])]}function Lk(n,e,t,r,i){var a,o,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=qr(n),S=w("clipPath");_=S!=="none"?S:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=C3(_),C=T.prefix,R=C===void 0?_:C,O=T.value,P=O===void 0?"":O,M=R==="circle",A=" ";if(R==="polygon"){var I=ac(P||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var k=I.map(function(lt){var Ct=te(lt.split(" "),2),et=Ct[0],ft=Ct[1];return{vertical:1,horizontal:1,pos:[Ht(et,e),Ht(ft,t)]}}),z=Dc(k.map(function(lt){return lt.pos}));return{type:R,clipText:_,poses:k,splitter:A,left:z.minX,right:z.maxX,top:z.minY,bottom:z.maxY}}else if(M||R==="ellipse"){var V="",B="",j=0,X=0,I=rl(P);if(M){var H="";a=te(I,4),o=a[0],H=o===void 0?"50%":o,c=a[2],V=c===void 0?"50%":c,u=a[3],B=u===void 0?"50%":u,j=Ht(H,Math.sqrt((e*e+t*t)/2)),X=j}else{var $="",W="";d=te(I,5),h=d[0],$=h===void 0?"50%":h,p=d[1],W=p===void 0?"50%":p,m=d[3],V=m===void 0?"50%":m,b=d[4],B=b===void 0?"50%":b,j=Ht($,e),X=Ht(W,t)}var ee=[Ht(V,e),Ht(B,t)],k=Ie([{vertical:1,horizontal:1,pos:ee,direction:"nesw"}],te(see.slice(0,M?1:2).map(function(et){return{vertical:we(et[1]),horizontal:et[0],direction:et[2],sub:!0,pos:[ee[0]+et[0]*j,ee[1]+et[1]*X]}})),!1);return{type:R,clipText:_,radiusX:j,radiusY:X,left:ee[0]-j,top:ee[1]-X,right:ee[0]+j,bottom:ee[1]+X,poses:k,splitter:A}}else if(R==="inset"){var I=rl(P||"0 0 0 0"),he=I.indexOf("round"),K=(he>-1?I.slice(0,he):I).length,G=I.slice(K+1),Y=te(I.slice(0,K),4),re=Y[0],Z=Y[1],le=Z===void 0?re:Z,fe=Y[2],xe=fe===void 0?re:fe,ve=Y[3],Ce=ve===void 0?le:ve,Ge=te([re,xe].map(function(et){return Ht(et,t)}),2),ae=Ge[0],Te=Ge[1],Pe=te([Ce,le].map(function(et){return Ht(et,e)}),2),Oe=Pe[0],qe=Pe[1],Ue=e-qe,Se=t-Te,ze=u5(G,Ue-Oe,Se-ae,Oe,ae),k=Ie(Ie([],te(yv(ae,Ue,Se,Oe)),!1),te(ze),!1);return{type:"inset",clipText:_,poses:k,top:ae,left:Oe,right:Ue,bottom:Se,radius:G,splitter:A}}else if(R==="rect"){var I=ac(P||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));A=",";var Ne=te(I.map(function(pn){var Ut=$p(pn).value;return Ut}),4),Le=Ne[0],qe=Ne[1],Te=Ne[2],Oe=Ne[3],k=yv(Le,qe,Te,Oe);return{type:"rect",clipText:_,poses:k,top:Le,right:qe,bottom:Te,left:Oe,values:I,splitter:A}}}}}function lee(n,e,t,r,i){var a=n[e],o=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(j){return j==="w"||j==="e"}),p=d.filter(function(j){return j==="n"||j==="s"}),m=h[0],b=p[0];u[e]=t;var _=te(d5(n),2),w=_[0],S=_[1],T=w&&S?w/S:0;if(T&&i){var C=(e+4)%8,R=n[C].pos,O=[0,0];o.indexOf("w")>-1?O[0]=-1:o.indexOf("e")>-1&&(O[0]=1),o.indexOf("n")>-1?O[1]=-1:o.indexOf("s")>-1&&(O[1]=1);var P=n5([w,S],t,T,O,!0),M=w+P[0],A=S+P[1],I=R[1],k=R[1],z=R[0],V=R[0];O[0]===-1?z=V-M:O[0]===1?V=z+M:(z=z-M/2,V=V+M/2),O[1]===-1?I=k-A:(O[1]===1||(I=k-A/2),k=I+A);var B=yv(I,V,k,z);n.forEach(function(j,X){u[X][0]=B[X].pos[0]-j.pos[0],u[X][1]=B[X].pos[1]-j.pos[1]})}else n.forEach(function(j,X){var H=j.direction;H&&(H.indexOf(m)>-1&&(u[X][0]=t[0]),H.indexOf(b)>-1&&(u[X][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else o&&!c?d.forEach(function(j){var X=j==="n"||j==="s";n.forEach(function(H,$){var W=H.direction,ee=H.horizontal,he=H.vertical;!W||W.indexOf(j)===-1||(u[$]=[X||!ee?0:t[0],!X||!he?0:t[1]])})}):u[e]=t;return u}function cee(n,e){var t=te(gj(n,e),2),r=t[0],i=t[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=tee.indexOf(c),_=nee.indexOf(c),w=h.length;if(iee(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var S=zS(n,o,m),T="".concat(d,"(").concat(S.join(p),")");Me(n,"onClip",dt(n,e,J({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},Rr({clipPath:T},e))))}function uee(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(ree(c,d,i,8,h),h===c.length))return}else return;var p=zS(n,r,d),m="".concat(o,"(").concat(p.join(u),")");Me(n,"onClip",dt(n,e,J({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},Rr({clipPath:m},e))))}var dee={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,o=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,S=u.pos1,T=u.pos2,C=u.pos3,R=u.pos4,O=u.clipPathState,P=u.snapBoundInfos,M=u.rotation;if(!d||c)return[];var A=Lk(d,h,p,i||"inset",O||r);if(!A)return[];var I=b?4:3,k=A.type,z=A.poses,V=z.map(function(qe){var Ue=un(m,qe.pos,I);return[Ue[0]-_,Ue[1]-w]}),B=[],j=[],X=k==="rect",H=k==="inset",$=k==="polygon";if(X||H||$){var W=H?V.slice(0,8):V;j=W.map(function(qe,Ue){var Se=Ue===0?W[W.length-1]:W[Ue-1],ze=An(Se,qe),Ne=Yj(Se,qe);return e.createElement("div",{key:"clipLine".concat(Ue),className:$e("line","clip-line","snap-control"),"data-clip-index":Ue,style:{width:"".concat(Ne,"px"),transform:"translate(".concat(Se[0],"px, ").concat(Se[1],"px) rotate(").concat(ze,"rad) scaleY(").concat(o,")")}})})}if(B=V.map(function(qe,Ue){return e.createElement("div",{key:"clipControl".concat(Ue),className:$e("control","clip-control","snap-control"),"data-clip-index":Ue,style:{transform:"translate(".concat(qe[0],"px, ").concat(qe[1],"px) rotate(").concat(M,"rad) scale(").concat(o,")")}})}),H&&B.push.apply(B,Ie([],te(V.slice(8).map(function(qe,Ue){return e.createElement("div",{key:"clipRadiusControl".concat(Ue),className:$e("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Ue,style:{transform:"translate(".concat(qe[0],"px, ").concat(qe[1],"px) rotate(").concat(M,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var ee=A.left,he=A.top,K=A.radiusX,G=A.radiusY,Y=te(Ke(un(m,[ee,he],I),un(m,[0,0],I)),2),re=Y[0],Z=Y[1],le="none";if(!a){for(var fe=Math.max(10,K/5,G/5),xe=[],ve=0;ve<=fe;++ve){var Ce=Math.PI*2/fe*ve;xe.push([K+(K-o)*Math.cos(Ce),G+(G-o)*Math.sin(Ce)])}xe.push([K,-2]),xe.push([-2,-2]),xe.push([-2,G*2+2]),xe.push([K*2+2,G*2+2]),xe.push([K*2+2,-2]),xe.push([K,-2]),le="polygon(".concat(xe.map(function(qe){return"".concat(qe[0],"px ").concat(qe[1],"px")}).join(", "),")")}B.push(e.createElement("div",{key:"clipEllipse",className:$e("clip-ellipse","snap-control"),style:{width:"".concat(K*2,"px"),height:"".concat(G*2,"px"),clipPath:le,transform:"translate(".concat(-_+re,"px, ").concat(-w+Z,"px) ").concat(my(m))}}))}if(a){var Ge=Ni(Ie([S,T,C,R],te(V),!1)),ae=Ge.width,Te=Ge.height,Pe=Ge.left,Oe=Ge.top;if($||X||H){var xe=H?V.slice(0,8):V;B.push(e.createElement("div",{key:"clipArea",className:$e("clip-area","snap-control"),style:{width:"".concat(ae,"px"),height:"".concat(Te,"px"),transform:"translate(".concat(Pe,"px, ").concat(Oe,"px)"),clipPath:"polygon(".concat(xe.map(function(Ue){return"".concat(Ue[0]-Pe,"px ").concat(Ue[1]-Oe,"px")}).join(", "),")")}}))}}return P&&["vertical","horizontal"].forEach(function(qe){var Ue=P[qe],Se=qe==="horizontal";Ue.isSnap&&j.push.apply(j,Ie([],te(Ue.snap.posInfos.map(function(ze,Ne){var Le=ze.pos,lt=Ke(un(m,Se?[0,Le]:[Le,0],I),[_,w]),Ct=Ke(un(m,Se?[h,Le]:[Le,p],I),[_,w]);return dp(e,"",lt,Ct,o,"clip".concat(qe,"snap").concat(Ne),"guideline")})),!1)),Ue.isBound&&j.push.apply(j,Ie([],te(Ue.bounds.map(function(ze,Ne){var Le=ze.pos,lt=Ke(un(m,Se?[0,Le]:[Le,0],I),[_,w]),Ct=Ke(un(m,Se?[h,Le]:[Le,p],I),[_,w]);return dp(e,"",lt,Ct,o,"clip".concat(qe,"bounds").concat(Ne),"guideline","bounds","bold")})),!1))}),Ie(Ie([],te(B),!1),te(j),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,J(J({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,o=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=Lk(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,S=Me(n,"onClipStart",dt(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,Vc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=kc(n.props,"clippable"),w=_.keepRatio,S=0,T=0,C=o.draggable,R=Za(e);c&&C?(t=te(C.prevBeforeDist,2),S=t[0],T=t[1]):(r=te(R,2),S=r[0],T=r[1]);var O=[S,T],P=n.state,M=P.width,A=P.height,I=!p&&!d&&!h,k=b.type,z=b.poses,V=b.splitter,B=z.map(function(mt){return mt.pos});I&&(S=-S,T=-T);var j=!d||z[m].direction==="nesw",X=k==="inset"||k==="rect",H=z.map(function(){return[0,0]});if(d&&!j){var $=z[m],W=$.horizontal,ee=$.vertical,he=[S*we(W),T*we(ee)];H=lee(z,m,he,X,w)}else j&&(H=B.map(function(){return[S,T]}));var K=B.map(function(mt,ln){return It(mt,H[ln])}),G=Ie([],te(K),!1);P.snapBoundInfos=null;var Y=b.type==="circle",re=b.type==="ellipse";if(Y||re){var Z=Ni(K),le=we(Z.bottom-Z.top),fe=we(re?Z.right-Z.left:le),xe=K[0][1]+le,ve=K[0][0]-fe,Ce=K[0][0]+fe;Y&&(G.push([Ce,Z.bottom]),H.push([1,0])),G.push([Z.left,xe]),H.push([0,1]),G.push([ve,Z.bottom]),H.push([1,0])}var Ge=Uj((_.clipHorizontalGuidelines||[]).map(function(mt){return Ht("".concat(mt),A)}),(_.clipVerticalGuidelines||[]).map(function(mt){return Ht("".concat(mt),M)}),M,A),ae=[],Te=[];if(Y||re)ae=[G[4][0],G[2][0]],Te=[G[1][1],G[3][1]];else if(X){var Pe=[G[0],G[2],G[4],G[6]],Oe=[H[0],H[2],H[4],H[6]];ae=Pe.filter(function(mt,ln){return Oe[ln][0]}).map(function(mt){return mt[0]}),Te=Pe.filter(function(mt,ln){return Oe[ln][1]}).map(function(mt){return mt[1]})}else ae=G.filter(function(mt,ln){return H[ln][0]}).map(function(mt){return mt[0]}),Te=G.filter(function(mt,ln){return H[ln][1]}).map(function(mt){return mt[1]});var qe=[0,0],Ue=Ek(Ge,_.clipTargetBounds&&{left:0,top:0,right:M,bottom:A},ae,Te,5,5),Se=Ue.horizontal,ze=Ue.vertical,Ne=Se.offset,Le=ze.offset;if(Se.isBound&&(qe[1]+=Ne),ze.isBound&&(qe[0]+=Le),(re||Y)&&H[0][0]===0&&H[0][1]===0){var Z=Ni(K),lt=Z.bottom-Z.top,Ct=re?Z.right-Z.left:lt,et=ze.isBound?we(Le):ze.snapIndex===0?-Le:Le,ft=Se.isBound?we(Ne):Se.snapIndex===0?-Ne:Ne;Ct-=et,lt-=ft,Y&&(lt=Mj(ze,Se)>0?lt:Ct,Ct=lt);var kt=G[0];G[1][1]=kt[1]-lt,G[2][0]=kt[0]+Ct,G[3][1]=kt[1]+lt,G[4][0]=kt[0]-Ct}else if(X&&w&&d){var pn=te(d5(z),2),Ut=pn[0],Cn=pn[1],Hr=Ut&&Cn?Ut/Cn:0,fa=z[m],Ja=fa.direction||"",Gs=G[1][1],xe=G[5][1],ve=G[7][0],Ce=G[3][0];we(Ne)<=we(Le)?Ne=Ar(Ne)*we(Le)/Hr:Le=Ar(Le)*we(Ne)*Hr,Ja.indexOf("w")>-1?ve-=Le:Ja.indexOf("e")>-1?Ce-=Le:(ve+=Le/2,Ce-=Le/2),Ja.indexOf("n")>-1?Gs-=Ne:Ja.indexOf("s")>-1?xe-=Ne:(Gs+=Ne/2,xe-=Ne/2);var Yr=yv(Gs,Ce,xe,ve);G.forEach(function(Kr,ui){var _r;_r=te(Yr[ui].pos,2),Kr[0]=_r[0],Kr[1]=_r[1]})}else G.forEach(function(mt,ln){var cn=H[ln];cn[0]&&(mt[0]-=Le),cn[1]&&(mt[1]-=Ne)});var In=zS(n,b,K),dr="".concat(k,"(").concat(In.join(V),")");if(P.clipPathState=dr,Y||re)ae=[G[4][0],G[2][0]],Te=[G[1][1],G[3][1]];else if(X){var Pe=[G[0],G[2],G[4],G[6]];ae=Pe.map(function(ln){return ln[0]}),Te=Pe.map(function(ln){return ln[1]})}else ae=G.map(function(mt){return mt[0]}),Te=G.map(function(mt){return mt[1]});if(P.snapBoundInfos=Ek(Ge,_.clipTargetBounds&&{left:0,top:0,right:M,bottom:A},ae,Te,1,1),C){var on=P.is3d,Lc=P.allMatrix,qs=on?4:3,$s=qe;c&&($s=[O[0]+qe[0]-R[0],O[1]+qe[1]-R[1]]),C.deltaOffset=Yt(Lc,[$s[0],$s[1],0,0],qs)}return Me(n,"onClip",dt(n,e,J({clipEventType:"changed",clipType:k,poses:K,clipStyle:dr,clipStyles:In,distX:S,distY:T},Rr((i={},i[k==="rect"?"clip":"clipPath"]=dr,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(Me(n,"onClipEnd",li(n,e,{})),i&&(c?uee(n,e):a&&cee(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},fee={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":Hn(e.inputEvent.target,$e("origin"))},dragControlStart:function(n,e){var t=e.datas;Vc(n,e);var r=dt(n,e,{dragStart:Tr.dragStart(n,new wd().dragStart([0,0],e))}),i=Me(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=te(Za(e),2),o=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,S=b?4:3,T=[o,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var R=It(t.startOrigin,T),O=It(t.startTargetOrigin,T),P=Ke(T,t.prevOrigin),M=eg(p,m,R,S),A=n.getRect(),I=Ni(zc(M,d,h,S)),k=[A.left-I.left,A.top-I.top];t.prevOrigin=T;var z=[Qi(O[0],d,w),Qi(O[1],h,w)].join(" "),V=Tr.drag(n,Jp(e,n.state,k,!!r)),B=dt(n,e,J(J({width:d,height:h,origin:R,dist:T,delta:P,transformOrigin:z,drag:V},Rr({transformOrigin:z,transform:V.transform},e)),{afterTransform:V.transform}));return Me(n,"onDragOrigin",B),B},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(Me(n,"onDragOriginEnd",li(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function hee(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!n[o].virtual)){var c=n[o];pee(n,o),o<4?c.pos[0]=t:c.pos[1]=r}}function pee(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function gee(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function Bk(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=rl(n),u5(a,e,t,0,0,r,i)}function Uk(n,e,t,r,i){var a=n.state,o=a.width,c=a.height,u=VS(i,n.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=aee(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var S=dt(n,e,J({horizontals:b,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:t},Rr({borderRadius:w},e)));return Me(n,"onRound",S),S}function Fk(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],o=n.getTargets()[0];o&&(a?.props.target===o?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=NS(o).borderRadius,r.borderRadius=i))}return i}var mee={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?$e("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,o=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,S=p.zoom,T=p.roundPadding,C=T===void 0?0:T,R=p.isDisplayShadowRoundControls,O=p.groupable;if(!r)return null;var P=h||Fk(n),M=c?4:3,A=Bk(P,i,a,b,!0);if(!A)return null;var I=0,k=0,z=O?[0,0]:[u,d];return A.map(function(V,B){var j=V.horizontal,X=V.vertical,H=V.direction||"",$=Ie([],te(V.pos),!1);k+=Math.abs(j),I+=Math.abs(X),j&&H.indexOf("n")>-1&&($[1]-=C),X&&H.indexOf("w")>-1&&($[0]-=C),j&&H.indexOf("s")>-1&&($[1]+=C),X&&H.indexOf("e")>-1&&($[0]+=C);var W=Ke(un(o,$,M),z),ee=R&&R!=="horizontal",he=V.vertical?I<=w[1]&&(ee||!V.virtual):k<=w[0]&&(R||!V.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(B),className:$e("control","border-radius",V.vertical?"vertical":"",V.virtual?"virtual":""),"data-radius-index":B,style:{display:he?"block":"none",transform:"translate(".concat(W[0],"px, ").concat(W[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=dt(n,e,{}),m=Me(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Vc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,S=w===void 0?[0,0]:w,T=n.state,C=T.width,R=T.height;r.isRound=!0,r.prevDist=[0,0];var O=Fk(n),P=Bk(O||"",C,R,S,!0)||[];return r.controlPoses=P,T.borderRadiusState=VS(P,_,C,R).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=te(Za(e),2),o=a[0],c=a[1],u=[o,c],d=Ke(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],S=w.vertical,T=w.horizontal,C=r.map(function(O){var P=O.horizontal,M=O.vertical,A=[P*T*u[0],M*S*u[1]];if(P){if(p[0]===1)return A;if(p[0]<4&&P!==T)return A}else{if(p[1]===0)return A[1]=M*T*u[0]/b*_,A;if(S){if(p[1]===1)return A;if(p[1]<4&&M!==S)return A}}return[0,0]});C[i]=u;var R=r.map(function(O,P){return J(J({},O),{pos:It(O.pos,C[P])})});return i<4?R.slice(0,i+1).forEach(function(O){O.virtual=!1}):R.slice(4,i+1).forEach(function(O){O.virtual=!1}),t.prevDist=[o,c],Uk(n,e,u,d,R)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))gee(d,o);else if(c&&(m===!0||m==="line")){var b=te(gj(n,e),2),_=b[0],w=b[1];hee(d,u,_,w)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&Uk(n,e,[0,0],[0,0],d)}var S=li(n,e,{});return Me(n,"onRoundEnd",S),t.borderRadiusState="",S},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=ra(n,"roundable",e),o=J({targets:n.props.targets,events:a.map(function(c,u){return J(J({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return Me(n,"onRoundGroupStart",o),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=ra(n,"roundable",e),o=J({targets:n.props.targets,events:a.map(function(c,u){return J(J(J({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),Rr({borderRadius:t.borderRadius},c))})},t);return Me(n,"onRoundGroup",o),o},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=ra(n,"roundable",e);vy(n,"onRound",function(c){var u=J({targets:n.props.targets,events:i.map(function(d,h){return J(J(J({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),Rr({borderRadius:c.borderRadius},d))})},c);Me(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var o=J({targets:n.props.targets,events:i.map(function(c,u){var d;return J(J({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return Me(n,"onRoundGroupEnd",o),o},unset:function(n){n.state.borderRadiusState=""}};function vee(n,e){var t=e?4:3,r=Jt(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var f5={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(nj(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=vee(c,r)?[]:rl(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return dt(n,e,{setTransform:function(t){e.datas.startTransforms=Fn(t)?t:rl(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return dt(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),Me(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),Me(n,"onBeforeRender",dt(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),Me(n,"onBeforeRenderEnd",dt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=ra(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.setTransform(u,o),t.resetStyle(o),t.fillDragStartParams(u,o)});Me(n,"onBeforeRenderGroupStart",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=ra(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.resetStyle(o),t.fillDragParams(u,o)});Me(n,"onBeforeRenderGroup",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),Me(n,"onBeforeRenderGroupEnd",dt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},h5={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){Me(n,"onRenderStart",dt(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){Me(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){Me(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){Me(n,"onRenderGroupStart",dt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=ra(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragParams(u,o)});Me(n,"onRenderGroup",dt(n,e,J(J({isPinch:!!e.isPinch,targets:n.props.targets,transform:$m(e),transformObject:{}},Rr(Hm(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=ra(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragEndParams(u,o)});Me(n,"onRenderGroupEnd",dt(n,e,J({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:$m(e)},Rr(Hm(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return _d(dv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),dt(n,e,J({isPinch:!!e.isPinch,transformObject:t,transform:$m(e)},Rr(Hm(e))))},fillDragEndParams:function(n,e){var t={};return _d(dv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),dt(n,e,J({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:$m(e)},Rr(Hm(e))))}};function Oh(n,e,t,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ie([],te(e),!1);if(p){var _=a.requestAble;b.some(function(B){return B.name===_})||b.push.apply(b,Ie([],te(n.props.ables.filter(function(B){return B.name===_})),!1))}if(!b.length||b.every(function(B){return B.dragRelation}))return!1;var w=a.inputEvent,S;u&&w&&(S=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,C=function(){var B;T=!0,(B=a.stop)===null||B===void 0||B.call(a)},R=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());R&&n.updateRect(i,!0,!1);var O=a.datas,P=m?"controlGesto":"targetGesto",M=n[P],A=function(B,j,X){if(!(j in B)||M!==n[P])return!1;var H=B.name,$=O[H]||(O[H]={});if(c&&($.isEventStart=!X||!B[X]||B[X](n,a)),!$.isEventStart)return!1;var W=B[j](n,J(J({},a),{stop:C,datas:$,originalDatas:O,inputTarget:S}));return n._emitter.off(),c&&W===!1&&($.isEventStart=!1),W};R&&b.forEach(function(B){B.unset&&B.unset(n)}),A(f5,"drag".concat(r).concat(i));var I=0,k=0;t.forEach(function(B){if(T)return!1;var j="".concat(B).concat(r).concat(i),X="".concat(B).concat(r,"Condition");i===""&&!p&&BJ(n.state,a);var H=b.filter(function(ee){return ee[j]});H=H.filter(function(ee,he){return ee.name&&H.indexOf(ee)===he});var $=H.filter(function(ee){return A(ee,j,X)}),W=$.length;T&&++I,W&&++k,!T&&c&&H.length&&!W&&(I+=H.filter(function(ee){var he=ee.name,K=O[he];return K.isEventStart?ee.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&A(h5,"drag".concat(r).concat(i));var z=M!==n[P]||I===t.length;if((u||T||z)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(B){B.state.gestos={}}),b.forEach(function(B){B.unset&&B.unset(n)})),c&&!z&&!p&&k&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||z)return!1;if(!c&&k&&!o||u){var V=n.props.flushSync||qj;V(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&Oh(n,e,t,r,i+"After",a),!0}function LS(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,o=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||Hn(a,"moveable-area")||Hn(a,"moveable-padding")||Hn(a,"moveable-edgeDraggable")}}function p5(n,e,t){var r=n.controlBox,i=[],a=n.props,o=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=LS(n);return m5(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function g5(n,e){var t=n.controlBox,r=[];r.push(t);var i=LS(n,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===t)return!0;var u=i(o,c);return!u};return m5(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function m5(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",o=n.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,_=b===void 0?!0:b,w=o.preventRightClick,S=w===void 0?!0:w,T=o.preventWheelClick,C=T===void 0?!0:T,R=o.dragContainer,O=$a(R,!0),P={preventDefault:_,preventRightClick:S,preventWheelClick:C,container:O||Ko(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(I){return n.controlBox.contains(I.target)},checkInput:a?p:!1,dragFocusedInput:m},M=new qQ(e,P),A=r==="Control";return["drag","pinch"].forEach(function(I){["Start","","End"].forEach(function(k){M.on("".concat(I).concat(k),function(z){var V,B=z.eventType,j=I==="drag"&&z.isPinch;if(i[B]&&!i[B](z)){z.stop();return}if(!j){var X=I==="drag"?[I]:["drag",I],H=Ie([],te(n[t]),!1),$=Oh(n,H,X,r,k,z);$?(n.props.stopPropagation||k==="Start"&&A)&&((V=z?.inputEvent)===null||V===void 0||V.stopPropagation()):z.stop()}})})}),M}var yee=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function bee(n,e,t,r){var i;t===void 0&&(t=e);var a=_j(n,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=MZ(p,t),w=_.matrixes,S=_.is3d,T=_.offsetContainer,C=_.zoom,R=r,O=4,P=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,M=u,A=Jt(O),I=Jt(O),k=Jt(O),z=Jt(O),V=o.length,B=w.map(function(he){return J(J({},he),{matrix:he.matrix?Ie([],te(he.matrix),!1):void 0})}).reverse();o.reverse(),!c&&R&&(M=ca(M,3,4),ew(o)),!S&&R&&ew(B),B.forEach(function(he){I=Yt(I,he.matrix,O)});var j=t||dl(n),X=((i=B[0])===null||i===void 0?void 0:i.target)||fp(j,j,!0).offsetParent,H=B.slice(1).reduce(function(he,K){return Yt(he,K.matrix,O)},Jt(O));o.forEach(function(he,K){if(V-2===K&&(k=A.slice()),V-1===K&&(z=A.slice()),!he.matrix){var G=o[K+1],Y=jJ(he,G,X,O,Yt(H,A,O));he.matrix=Rc(Y,O)}A=Yt(A,he.matrix,O)});var $=!P&&c;M||(M=Jt($?4:3));var W=my(P&&M.length===16?ca(M,4,3):M,$),ee=I;return I=ej(I,O,O),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:o,rootMatrix:I,originalRootMatrix:ee,beforeMatrix:k,offsetMatrix:z,allMatrix:A,targetMatrix:M,targetTransform:W,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:R,offsetContainer:p,offsetRootContainer:T}}function xee(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,o=0,c={},u=Kj(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=bee(n,e,t,r),h=rd(d.allMatrix,d.transformOrigin,i,a);c=J(J({},d),h);var p=rd(d.allMatrix,[50,50],100,100);o=Xj([p.pos1,p.pos2],p.direction)}var m=4;return J(J(J({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:Jt(m),rootMatrix:Jt(m),beforeMatrix:Jt(m),offsetMatrix:Jt(m),allMatrix:Jt(m),targetMatrix:Jt(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function iw(n,e,t,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Km(),d=Km(),h=Km(),p=Km(),m=[0,0],b={},_=xee(e,t,i,!0);if(e){var w=qr(e);a.forEach(function(B){b[B]=w(B)});var S=_.is3d?4:3,T=rd(_.offsetMatrix,It(_.transformOrigin,tj(_.targetMatrix,S)),_.width,_.height);o=T.direction,c=It(T.origin,[T.left-_.left,T.top-_.top]),p=Ph(_.offsetRootContainer);var C=fp(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var R=rd(Yt(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),O=rd(_.originalRootMatrix,gv(qr(C)("transformOrigin")).map(function(B){return parseFloat(B)}),C.offsetWidth,C.offsetHeight);if(u=m1(R,p),h=m1(O,p,C,!0),n){var P=R.left,M=R.top;d=m1({left:P,top:M,bottom:M,right:M},p)}}else{u=Ph(e),h=NZ(C),n&&(d=Ph(n));var A=h.left,I=h.top,k=h.clientLeft,z=h.clientTop,V=[u.left-A,u.top-I];m=Ke(Td(_.rootMatrix,V,4),[k+_.left,z+_.top])}}return J({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function Gk(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=Dc([e,t,r,i]),o=[a.minX,a.minY],c=Ke(n.origin,o);return e=Ke(e,o),t=Ke(t,o),r=Ke(r,o),i=Ke(i,o),J(J({},n),{left:n.left,top:n.top,posDelta:o,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var Ad=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=J({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},iw(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new ly,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}OW(t._observerId),t._observerId=I3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,o=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=te(i||[0,0],2),w=_[0],S=_[1],T=r.left,C=r.top,R=r.target,O=r.direction,P=r.hasFixed,M=r.offsetDelta,A=t.targets,I=this.isDragging(),k={};this.getEnabledAbles().forEach(function(H){k["data-able-".concat(H.name.toLowerCase())]=!0});var z=this._getAbleClassName(),V=A&&A.length&&(R||p)||o||!this._hasFirstTarget&&this.state.isPersisted,B=this.controlBox||this.props.firstRenderState||this.props.persistData,j=[T-w,C-S];!p&&t.useAccuratePosition&&(j[0]+=M[0],j[1]+=M[1]);var X={position:P?"fixed":"absolute",display:V?"block":"none",visibility:B?"visible":"hidden",transform:"translate3d(".concat(j[0],"px, ").concat(j[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(X["--moveable-line-padding"]=m),b&&(X["--moveable-control-padding"]=b),na(h,J({cspNonce:u,ref:Cs(this,"controlBox"),className:"".concat($e("control-box",O===-1?"reverse":"",I?"dragging":"")," ").concat(z," ").concat(a)},k,{onClick:this._onPreventClick,style:X}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Ku(this,!1),Ku(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return Gr(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(xS)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&LS(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(Fd(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=J({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,S=fk([a,o,u,c],d),T=zQ(S,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),C=aj(S);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?U_([t,r],fk([o,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Ed(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=iw(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=Gk(a.persistData);for(var _ in b)m[_]=b[_]}o&&Ed(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!t)return!0;var c=o.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=Oi(this.state),i=te(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=Ni(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,S=[t.left,t.top],T=It(S,t.origin),C=It(S,t.beforeOrigin),R=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:R,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&tw(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&tw(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return GJ(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=Gr(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ie([],te(c[b]),!1),S={request:function(T){return Oh(a,w,["drag"],_,"",J(J({},p.request(T)),{requestAble:t,isRequest:!0}),m),S},requestEnd:function(){return Oh(a,w,["drag"],_,"End",J(J({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),S}};return Oh(a,w,["drag"],_,"Start",J(J({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,o=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,S=r.zoom||1;if(!i&&S<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=a5(i||{}),C=T.left,R=T.top,O=T.bottom,P=T.right,M=u?4:3,A=[];w?A=o:this.controlBox&&r.groupable?A=a:A=It(a,[b,_]);var I=cv(M,Rc(A.map(function(X){return-X}),M),c,Rc(o,M)),k=Si(I,d,[-C,-R],M),z=Si(I,h,[P,-R],M),V=Si(I,p,[-C,O],M),B=Si(I,m,[P,O],M);t.renderPoses=[k,z,V,B],t.renderLines=[[k,z],[z,B],[B,V],[V,k]];{var j=S/2;t.renderLines=[[Si(I,d,[-C-j,-R],M),Si(I,h,[P+j,-R],M)],[Si(I,h,[P,-R-j],M),Si(I,m,[P,O+j],M)],[Si(I,m,[P+j,O],M),Si(I,p,[-C-j,O],M)],[Si(I,p,[-C,O+j],M),Si(I,d,[-C,-R-j],M)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!nw(c,r),h=d||!nw(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=lj(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=Gk(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=Xm(o,[c,u],a),p=Xm(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:na};return this.renderState={},LJ(t5(Xm(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(t,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ie(Ie([],te(r),!1),te(c),!1)},Ie([],te(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Ku(this,!1),this.updateState({gestos:{}})),r||Ku(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=p5(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=g5(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=$a(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:na};return u.renderLines.map(function(h,p){return dp(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=zs(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=Xm(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new yee(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=$a(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=$a(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ie(Ie([],te(this._getAbleViewClassNames()),!1),[this.isDragging()?WJ:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=e5(t.filter(Boolean),function(d){return d}).map(function(d){var h=te(d,1),p=h[0];return p}),a=this._viewClassNames,o=Hp(a,i),c=o.removed,u=o.added;c.forEach(function(d){M3(r,a[d])}),u.forEach(function(d){N3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat($e("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,o=Ko(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,o=a.target,c=Ko(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=tZ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:qj,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(B3),BS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Xu(n,"parentPosition",[o,c],function(_){return _.join(",")}),b=Xu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ie(Ie([],te(i.map(function(_,w){return e.createElement(Ad,{key:"moveable"+w,ref:S3(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),te(t5(h.map(function(_,w){var S=_.pos1,T=_.pos2,C=_.pos3,R=_.pos4,O=[S,T,C,R];return[[0,1],[1,3],[3,2],[2,0]].map(function(P,M){var A=te(P,2),I=A[0],k=A[1];return dp(e,"",Ke(O[I],m),Ke(O[k],m),d,"group-rect-".concat(w,"-").concat(M))})}))),!1)}},_ee=Zp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),o=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||o)){var c=t.contains(i);Me(n,"onClick",dt(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Vs(i,function(u){return u.contains(r)}),c=a>-1),Me(n,"onClickGroup",dt(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Nu(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),J(J({},n),{datas:e})}var wee=Zp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?Sj(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Hn(i,$e("direction"))&&Hn(i,$e("edge"))&&Hn(i,$e("edgeDraggable"))},dragStart:function(n,e){return Tr.dragStart(n,Nu(e))},drag:function(n,e){return Tr.drag(n,Nu(e))},dragEnd:function(n,e){return Tr.dragEnd(n,Nu(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&Hn(i,$e("direction"))&&Hn(i,$e("line"))},dragGroupStart:function(n,e){return Tr.dragGroupStart(n,Nu(e))},dragGroup:function(n,e){return Tr.dragGroup(n,Nu(e))},dragGroupEnd:function(n,e){return Tr.dragGroupEnd(n,Nu(e))},unset:function(n){return Tr.unset(n)}}),v5={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},US=[f5,l5,AJ,$J,Tr,wee,Q_,HJ,KJ,lJ,JJ,eee,QJ,fee,dee,mee,BS,v5,_ee,o5,h5],Eee=US.reduce(function(n,e){return(e.events||[]).forEach(function(t){k3(n,t)}),n},[]),See=US.reduce(function(n,e){return(e.props||[]).forEach(function(t){k3(n,t)}),n},[]);function qk(n,e){var t=te(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Zm(n,e){var t=te(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function $k(n,e){return Math.max.apply(Math,Ie([],te(n.map(function(t){var r=te(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function Hk(n,e){return Math.min.apply(Math,Ie([],te(n.map(function(t){var r=te(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function Tee(n,e){var t,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=at(e,kr);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[Y_,gk],S=[[0,0],[0,0]],T=[Y_,gk],C=[[0,0],[0,0]];n.forEach(function(re){re.forEach(function(Z){var le=qk([-b,1,0],Z),fe=qk([-_,1,0],Z);w[0]>le&&(S[0]=Z,w[0]=le),w[1]<le&&(S[1]=Z,w[1]=le),T[0]>fe&&(C[0]=Z,T[0]=fe),T[1]<fe&&(C[1]=Z,T[1]=fe)})});var R=te(S,2),O=R[0],P=R[1],M=te(C,2),A=M[0],I=M[1],k=[-b,1,Zm([-b,1],O)],z=[-b,1,Zm([-b,1],P)],V=[-_,1,Zm([-_,1],A)],B=[-_,1,Zm([-_,1],I)];t=te([[k,V],[k,B],[z,V],[z,B]].map(function(re){var Z=te(re,2),le=Z[0],fe=Z[1];return yS(le,fe)[0]}),4),a=t[0],o=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var j=Hk(n,0),X=Hk(n,1),H=$k(n,0),$=$k(n,1);if(a=[j,X],o=[H,X],c=[j,$],u=[H,$],d=H-j,h=$-X,p%180){var W=[c,a,u,o];r=te(W,4),a=r[0],o=r[1],c=r[2],u=r[3],d=$-X,h=H-j}}if(p%360>180){var W=[u,c,o,a];i=te(W,4),a=i[0],o=i[1],c=i[2],u=i[3]}var ee=Dc([a,o,c,u]),he=ee.minX,K=ee.minY,G=ee.maxX,Y=ee.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:he,minY:K,maxX:G,maxY:Y,rotation:e}}function y5(n,e){var t=e.map(function(r){if(Fn(r)){var i=y5(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=Gr(n,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&Fn(t[0])?t[0]:t}var Aee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new ij,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Ed(!0),this.moveables.forEach(function(ve){ve.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(ve){return{finded:!1,manager:ve}}),p=this.props.targetGroups||[],m=y5(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ie([],te(h.filter(function(ve){var Ce=ve.finded;return!Ce}).map(function(ve){var Ce=ve.manager;return Ce})),!1));var _=[],w=!r||t!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function C(ve,Ce,Ge){var ae=ve.map(function(ze){if(Fn(ze)){var Ne=C(ze,Ce),Le=[Ne.pos1,Ne.pos2,Ne.pos3,Ne.pos4];return _.push(Ne),{poses:Le,rotation:Ne.rotation}}else return{poses:Oi(ze.state),rotation:ze.getRotation()}}),Te=ae.map(function(ze){var Ne=ze.rotation;return Ne}),Pe=0,Oe=Te[0],qe=Te.every(function(ze){return Math.abs(Oe-ze)<.1});w?Pe=!b&&qe?Oe:S:Pe=!b&&!Ge&&qe?Oe:Ce;var Ue=ae.map(function(ze){var Ne=ze.poses;return Ne}),Se=Tee(Ue,Pe);return Se}var R=C(m,this.rotation,!0);w&&(this.rotation=R.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var O=this.transformOrigin,P=this.rotation,M=this.scale,A=R.width,I=R.height,k=R.minX,z=R.minY,V=qJ([[0,0],[A,0],[0,I],[A,I]],jS(O,A,I),this.rotation/180*Math.PI),B=Dc(V.result),j=B.minX,X=B.minY,H=" rotate(".concat(P,"deg)")+" scale(".concat(Ar(M[0]),", ").concat(Ar(M[1]),")"),$="translate(".concat(-j,"px, ").concat(-X,"px)").concat(H);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(z,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(A,"px;height:").concat(I,"px;")+"transform: ".concat($),o.width=A,o.height=I;var W=this.getContainer(),ee=iw(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||W,[]),he=[ee.left,ee.top],K=te(Oi(ee),4),G=K[0],Y=K[1],re=K[2],Z=K[3],le=Dc([G,Y,re,Z]),fe=[le.minX,le.minY],xe=Ar(M[0]*M[1]);ee.pos1=Ke(G,fe),ee.pos2=Ke(Y,fe),ee.pos3=Ke(re,fe),ee.pos4=Ke(Z,fe),ee.left=k-ee.left+fe[0],ee.top=z-ee.top+fe[1],ee.origin=Ke(It(he,ee.origin),fe),ee.beforeOrigin=Ke(It(he,ee.beforeOrigin),fe),ee.originalBeforeOrigin=It(he,ee.originalBeforeOrigin),ee.transformOrigin=Ke(It(he,ee.transformOrigin),fe),d.style.transform="translate(".concat(-j-fe[0],"px, ").concat(-X-fe[1],"px)")+H,Ed(),this.updateState(J(J({},ee),{posDelta:fe,direction:xe,beforeDirection:xe}),i)},e.prototype.getRect=function(){return J(J({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ie(Ie([],te(r),!1),te(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ie([],te(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ie(Ie([],te(this.props.ables),!1),[BS],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=$a(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Ku(this,!1),Ku(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=p5(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=g5(this,"GroupControl")));var m=!nw(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!i5(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=J(J({},Ad.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Ad),Cee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),na(o,{cspNonce:a,ref:Cs(this,"controlBox"),className:$e("control-box")},u.map(function(m,b){var _,w,S=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return na(Ad,J({key:"moveable"+b,ref:S3(t,"moveables",b)},i,S,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Ed(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Ed()},e.prototype.getRect=function(){return J(J({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,J(J({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=Gr(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ie([],te(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Ad);function b5(n,e){var t=[];return n.forEach(function(r){if(r){if(Fr(r)){e[r]&&t.push.apply(t,Ie([],te(e[r]),!1));return}Fn(r)?t.push.apply(t,Ie([],te(b5(r,e)),!1)):t.push(r)}}),t}function x5(n,e){var t=[];return n.forEach(function(r){if(r){if(Fr(r)){e[r]&&t.push.apply(t,Ie([],te(e[r]),!1));return}Fn(r)?t.push(x5(r,e)):t.push(r)}}),t}function _5(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?Fn(t)&&Fn(i)?_5(t,i):!0:!1})}var Iee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new ij,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){t[c]=!0})});var i=zs(t).join(`
`);this.defaultStyled=lj("div",EW(xS,fZ+i))},e.getTotalAbles=function(){return Ie([l5,BS,v5,o5],te(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=JQ(i,["ables","props"]),u=te(this._updateRefs(!0),2),d=u[0],h=u[1],p=b5(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ie(Ie([],te(b),!1),te(a||[]),!1),w=J(J(J({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return na(Cee,J({key:"individual-group",ref:Cs(this,"moveable")},w,{target:null,targets:p}));if(m){var R=x5(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var O=T.props.target;O&&p.indexOf(O)>-1&&(S=J({},T.state))}return na(Aee,J({key:"group",ref:Cs(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:R,firstRenderState:S}))}else{var P=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var M=T.moveables||[],A=Gr(M,function(I){return I.props.target===P});A&&(S=J({},A.state))}return na(Ad,J({key:"single",ref:Cs(this,"moveable")},w,{target:P,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=OS(this.props.target||this.props.targets),a=typeof document<"u",o=_5(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(Fr(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else Fn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&o]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=te(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,eZ([SW(pj)],e.prototype,"moveable",void 0),e})(B3),Ree=(function(n){Qp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=US,e})(Iee),aw=function(n,e){return aw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},aw(n,e)};function FS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");aw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var hp=function(){return hp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},hp.apply(this,arguments)};function Dee(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var kee=(function(n){FS(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return na(Ree,hp({ref:Cs(this,"moveable")},this.state))},e})(fS),Nee=See,Mee=pj,Pee=Eee,Oee=(function(n){FS(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=hp({},i),c={};Pee.forEach(function(h){c[PW("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Ud(r).createElement("div"),r.appendChild(u)),a.containerProvider=ck(na(kee,hp({ref:Cs(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return Fn(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;ck(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=Dee([ek(Mee,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),ek(Nee,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(ly),jee=(function(n){FS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(Oee),sc=(n=>(n.Mouse="mouse",n.Touch="touch",n.Pointer="pointer",n))(sc||{}),ph=(n=>(n.CancelledByMovement="cancelled-by-movement",n.CancelledByRelease="cancelled-by-release",n.CancelledOutsideElement="cancelled-outside-element",n))(ph||{});const Vee=["mousedown","mousemove","mouseup","mouseleave","mouseout"],zee=["touchstart","touchmove","touchend","touchcancel"],Lee=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function Bee(n){return typeof n=="object"&&n!==null&&"pageX"in n&&typeof n.pageX=="number"&&"pageY"in n&&typeof n.pageY=="number"}function Uee(n){var e;return Vee.includes((e=n?.nativeEvent)==null?void 0:e.type)}function w5(n){var e;return zee.includes((e=n?.nativeEvent)==null?void 0:e.type)||"touches"in n}function Fee(n){const{nativeEvent:e}=n;return e?Lee.includes(e?.type)||"pointerId"in e:!1}function b1(n){return Uee(n)||w5(n)||Fee(n)}function Yk(n){var e;const t=w5(n)?(e=n?.touches)==null?void 0:e[0]:n;return Bee(t)?{x:t.pageX,y:t.pageY}:null}function Gee(n){return{target:n.target,currentTarget:n.currentTarget,nativeEvent:n,persist:()=>{}}}function E5(n,{threshold:e=400,captureEvent:t=!1,detect:r=sc.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:o,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=U.useRef(!1),m=U.useRef(!1),b=U.useRef(),_=U.useRef(),w=U.useRef(n),S=U.useRef(null),T=U.useCallback(P=>M=>{m.current||b1(M)&&(o!==void 0&&!o(M)||(t&&M.persist(),c?.(M,{context:P}),S.current=Yk(M),m.current=!0,b.current=M.currentTarget,_.current=setTimeout(()=>{w.current&&(w.current(M,{context:P}),p.current=!0)},e)))},[t,o,c,e]),C=U.useCallback(P=>(M,A)=>{b1(M)&&m.current&&(S.current=null,t&&M.persist(),p.current?d?.(M,{context:P}):m.current&&h?.(M,{context:P,reason:A??ph.CancelledByRelease}),p.current=!1,m.current=!1,_.current!==void 0&&clearTimeout(_.current))},[t,d,h]),R=U.useCallback(P=>M=>{if(b1(M)&&(u?.(M,{context:P}),i!==!1&&S.current)){const A=Yk(M);if(A){const I=i===!0?25:i,k={x:Math.abs(A.x-S.current.x),y:Math.abs(A.y-S.current.y)};(k.x>I||k.y>I)&&C(P)(M,ph.CancelledByMovement)}}},[C,i,u]),O=U.useCallback(P=>{if(n===null)return{};switch(r){case sc.Mouse:{const M={onMouseDown:T(P),onMouseMove:R(P),onMouseUp:C(P)};return a&&(M.onMouseLeave=A=>{C(P)(A,ph.CancelledOutsideElement)}),M}case sc.Touch:return{onTouchStart:T(P),onTouchMove:R(P),onTouchEnd:C(P)};case sc.Pointer:{const M={onPointerDown:T(P),onPointerMove:R(P),onPointerUp:C(P)};return a&&(M.onPointerLeave=A=>C(P)(A,ph.CancelledOutsideElement)),M}}},[n,C,a,r,R,T]);return U.useEffect(()=>{function P(M){const A=Gee(M);C()(A)}return window.addEventListener("mouseup",P),window.addEventListener("touchend",P),window.addEventListener("pointerup",P),()=>{window.removeEventListener("mouseup",P),window.removeEventListener("touchend",P),window.removeEventListener("pointerup",P)}},[C]),U.useEffect(()=>()=>{_.current!==void 0&&clearTimeout(_.current)},[]),U.useEffect(()=>{w.current=n},[n]),O}const S5=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},bv=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,Yl=n=>bv(n).toISOString(),qee=n=>{const e=bv(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},$ee=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},GS=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=Yl(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||qee(r),description:e.description||"",merchant:e.merchant||void 0,type:$ee(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class oc{static instance;static getInstance(){return oc.instance||(oc.instance=new oc),oc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(t.allocations,t.incomeSources)},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=St(tt,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=UO(tt);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Sr(tt,"users",e,"envelopes"),a=(await Zi(t)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Sr(tt,"users",e,"transactions"),r=oa(t,el("date","desc")),a=(await Zi(r)).docs.map(o=>{const c={id:o.id,...o.data()};return GS(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Sr(tt,"users",e.userId,"envelopes"),r=St(t),i=pt.now(),a={...e,createdAt:i,lastUpdated:i};ai(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Yl(i),lastUpdated:Yl(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=St(tt,"users",e,"envelopes",t.id);ai(r,{...t,lastUpdated:pt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{const r=St(tt,"users",e,"envelopes",t),i=oa(Sr(tt,"users",e,"transactions"),C$("envelopeId","==",t)),o=(await Zi(i)).docs.map(c=>Ji(c.ref));await Promise.all([Ji(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=St(tt,"users",e,"envelopes",i.id);return ai(a,{orderIndex:i.orderIndex,lastUpdated:pt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Sr(tt,"users",e.userId,"transactions"),r=St(t),i=pt.now();if(e.paymentMethod){const u={...e.paymentMethod};u.last4===void 0&&delete u.last4,e.paymentMethod=u}const o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};ai(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{if(console.log(" BudgetService.updateTransaction called for transaction:",t.id),t.paymentMethod){const a={...t.paymentMethod};a.last4===void 0&&delete a.last4,t.paymentMethod=a}const r=Object.fromEntries(Object.entries(t).filter(([a,o])=>o!==void 0)),i=St(tt,"users",e,"transactions",t.id);ai(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=St(tt,"users",e,"transactions",t);Ji(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=St(tt,"users",e.userId,"monthlyBudgets",e.month),r=pt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};Ma(t,{incomeSources:k$(a),updatedAt:r}).catch(c=>{c.code==="not-found"?ai(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Yl(r),updatedAt:Yl(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=St(tt,"users",e,"monthlyBudgets",r);Fx(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:pt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});Ma(a,{incomeSources:d,updatedAt:pt.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=St(tt,"users",e,"monthlyBudgets",r);Fx(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);Ma(i,{incomeSources:u,updatedAt:pt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=St(tt,"users",e.userId,"monthlyBudgets",e.month),r=pt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};Ma(t,i).catch(o=>{o.code==="not-found"?ai(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Yl(r),updatedAt:Yl(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=St(tt,"users",e,"monthlyBudgets",r),o={updatedAt:pt.now()};i.budgetedAmount!==void 0&&(o[`allocations.${t}`]=Number(i.budgetedAmount)),Ma(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=St(tt,"users",e,"monthlyBudgets",r);Ma(i,{[`allocations.${t}`]:LR(),updatedAt:pt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=St(tt,"users",e,"monthlyBudgets",t),i=await Fx(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Sr(tt,"users",e,"envelopeAllocations"),o=await Zi(a),c=[],u=new Set;for(const b of o.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>Ji(St(tt,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Sr(tt,"users",e,"monthlyBudgets"),h=await Zi(d);for(const b of h.docs){const w=b.data().allocations||{},S={};let T=!1;Object.keys(w).forEach(C=>{i.has(C)||(S[`allocations.${C}`]=LR(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(S.updatedAt=pt.now(),await Ma(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>Ji(St(tt,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=St(tt,"users",e,"monthlyBudgets",t);return Vd(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,t){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),t&&Object.keys(t).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=t?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Sr(tt,"users",e,r),a=await Zi(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Ji(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const qS=oc.getInstance();class Bo{static instance;constructor(){}static getInstance(){return Bo.instance||(Bo.instance=new Bo),Bo.instance}createId(){return St(Sr(tt,"temp")).id}async createCategory(e){const t=St(tt,`users/${e.userId}/categories`,e.id);return await ai(t,e),e}async getCategories(e){const t=oa(Sr(tt,`users/${e}/categories`),el("orderIndex","asc"));return(await Zi(t)).docs.map(i=>i.data())}async updateCategory(e,t){const r=St(tt,`users/${e}/categories`,t.id);await ai(r,t,{merge:!0})}async deleteCategory(e,t){const r=St(tt,`users/${e}/categories`,t);await Ji(r)}async reorderCategories(e,t){const r=UO(tt);t.forEach((i,a)=>{const o=St(tt,`users/${e}/categories`,i.id);r.update(o,{orderIndex:a})}),await r.commit()}subscribeToCategories(e,t){const r=oa(Sr(tt,`users/${e}/categories`),el("orderIndex","asc"));return Vd(r,i=>{const a=i.docs.map(o=>o.data());t(a)},i=>{console.error(" Category subscription error:",i)})}}Bo.getInstance();const x1=n=>Sr(tt,"users",n,"transactions"),Hee={subscribeToTransactions:(n,e)=>{const t=oa(x1(n),el("date","desc"));return Vd(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=oa(x1(n),el("date","desc")),r=(await Zi(e)).docs.map(i=>{const a={id:i.id,...i.data()};return GS(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await Jv(x1(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=St(tt,"users",n,"transactions",e);return await Ma(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=St(tt,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await Ji(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},_1=n=>Sr(tt,"users",n,"envelopes"),Yee={subscribeToEnvelopes:(n,e)=>{const t=oa(_1(n),el("orderIndex","asc"));return Vd(t,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=_1(n),i=(await Zi(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await Jv(_1(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=St(tt,"users",n,"envelopes",e.id);return await ai(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=St(tt,"users",n,"envelopes",e);return await Ma(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=St(tt,"users",n,"envelopes",e);await Ji(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},w1=n=>Sr(tt,"users",n,"distributionTemplates"),Kee={subscribeToDistributionTemplates:(n,e)=>{const t=oa(w1(n),el("lastUsed","desc"));return Vd(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=oa(w1(n),el("lastUsed","desc"));return(await Zi(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await Jv(w1(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=St(tt,"users",n,"distributionTemplates",e.id);return await ai(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=St(tt,"users",n,"distributionTemplates",e);return await Ma(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=St(tt,"users",n,"distributionTemplates",e);await Ji(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},E1=n=>Sr(tt,"users",n,"appSettings"),T5={subscribeToAppSettings:(n,e)=>{const t=oa(E1(n),jR(1));return Vd(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async n=>{const e=oa(E1(n),jR(1)),t=await Zi(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await Jv(E1(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=St(tt,"users",n,"appSettings",e.id);return await ai(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=St(tt,"users",n,"appSettings",e);return await ai(r,t,{merge:!0})},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=St(tt,"users",n,"appSettings",e);await Ji(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},Kk=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:T5},Symbol.toStringTag,{value:"Module"})),Xee=n=>GS(n),Wee=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig,categoryId:n.categoryId}),Qee=n=>({id:n.id,userId:n.userId,name:n.name,orderIndex:n.orderIndex,isArchived:n.isArchived,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,updatedAt:n.updatedAt?.toDate?.()?n.updatedAt.toDate().toISOString():n.updatedAt}),Xk=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=Yee.subscribeToEnvelopes(e,h=>{console.log(" Real-time sync: Envelopes updated",h.length);const p=h.map(Wee),m=n.getState(),b=new Set(m.envelopes.map(S=>S.id)),_=new Set(p.map(S=>S.id)),w=[...p.filter(S=>b.has(S.id)),...m.envelopes.filter(S=>!_.has(S.id))];n.setState({envelopes:w})}),i=Hee.subscribeToTransactions(e,h=>{console.log(" Real-time sync: Transactions updated",h.length);const p=h.map(Xee),m=n.getState(),b=new Set(m.transactions.map(S=>`${S.id}-${S.month}`)),_=new Set(p.map(S=>`${S.id}-${S.month}`)),w=[...p.filter(S=>b.has(`${S.id}-${S.month}`)),...m.transactions.filter(S=>!_.has(`${S.id}-${S.month}`))];n.setState({transactions:w})}),o=Bo.getInstance().subscribeToCategories(e,h=>{console.log(" Real-time sync: Categories updated",h.length);const p=h.map(Qee);n.setState({categories:p})}),c=Kee.subscribeToDistributionTemplates(e,h=>{console.log(" Real-time sync: Templates updated from Firebase",h.length)}),u=T5.subscribeToAppSettings(e,h=>{console.log(" Real-time sync: Settings updated",h?"found":"null");const p=n.getState();if(h){const m={...p.appSettings,...h,paymentSources:h.paymentSources??p.appSettings?.paymentSources??[]};n.setState({appSettings:m})}else console.log(" Firebase settings null, preserving local state")}),d=qS.subscribeToMonthlyBudget(e,t,h=>{console.log(` Real-time sync: Monthly budget updated (${h.incomeSources.length} sources, ${h.allocations.length} allocations)`);const p=n.getState();n.setState({incomeSources:{...p.incomeSources,[t]:h.incomeSources},allocations:{...p.allocations,[t]:h.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,categories:o,templates:c,settings:u,monthlyBudget:d},console.log(" Real-time subscriptions active - cross-device sync enabled")},Zee=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),Xk(e,r())),t.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),Xk(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.categories&&c.categories(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=qS.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},E0=()=>ta.getState().currentUser?.id||"",Sn=oc.getInstance(),Fl=Bo.getInstance(),rn=Cw()(WF(AM((n,e)=>({envelopes:[],transactions:[],categories:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null,setIsOnboardingActive:t=>{n({isOnboardingActive:t})},checkAndStartOnboarding:()=>{const t=E0();if(!t){console.log(" No user ID, skipping onboarding check");return}const r=`onboardingCompleted_${t}`,i=typeof localStorage<"u"?localStorage.getItem(r)==="true":!1;console.log(" checkAndStartOnboarding called:",{userId:t,isOnboardingCompleted:i,isOnboardingActive:e().isOnboardingActive,localStorage_key:r,localStorage_value:localStorage.getItem(r)}),n({isOnboardingCompleted:i}),!i&&!e().isOnboardingActive?(console.log(" Starting onboarding for new user - setting isOnboardingActive to TRUE"),n({isOnboardingActive:!0}),console.log(" isOnboardingActive set to:",e().isOnboardingActive)):console.log(" Skipping onboarding:",{reason:i?"already completed":"already active"})},completeOnboarding:()=>{const t=E0();if(t){const r=`onboardingCompleted_${t}`;localStorage.setItem(r,"true"),console.log(" Onboarding completed for user:",t)}n({isOnboardingCompleted:!0,isOnboardingActive:!1})},resetOnboarding:()=>{const t=E0();if(t){const r=`onboardingCompleted_${t}`;localStorage.removeItem(r),console.log(" Onboarding reset for user:",t)}n({isOnboardingCompleted:!1,isOnboardingActive:!0})},clearMonthData:async t=>{try{n({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${t}`);const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await At(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-Dy1LIoPL.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,t),await e().init(),console.log(` Cleared month data for ${t}`),n({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async t=>{try{const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await Sn.getMonthData(i.id,t),o=e();n({incomeSources:{...o.incomeSources,[t]:a.incomeSources},allocations:{...o.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${t} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,o,c,u]=await Promise.all([Sn.getEnvelopes(i.id),Sn.getTransactions(i.id),Fl.getCategories(i.id).catch(d=>(console.error(" Failed to load categories:",d),[])),Sn.getMonthData(i.id,t.currentMonth)]);n({envelopes:a,transactions:o,categories:c,incomeSources:{...t.incomeSources,[t.currentMonth]:u.incomeSources},allocations:{...t.allocations,[t.currentMonth]:u.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.length} categories, ${u.incomeSources.length} income sources, ${u.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},fetchCategories:async()=>{try{n({isLoading:!0,error:null});const r=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!r)return;const i=await Fl.getCategories(r.id);n({categories:i,isLoading:!1})}catch(t){console.error("Failed to fetch categories:",t),n({isLoading:!1})}},addCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=Fl.createId(),o={...t,id:a,userId:i.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),orderIndex:e().categories.length};return await Fl.createCategory(o),n(c=>c.categories.some(d=>d.id===a)?{isLoading:!1}:{categories:[...c.categories,o],isLoading:!1}),a}catch(r){throw console.error("Failed to add category:",r),n({isLoading:!1}),r}},updateCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a={...t,updatedAt:new Date().toISOString()};await Fl.updateCategory(i.id,a),n(o=>({categories:o.categories.map(c=>c.id===t.id?a:c),isLoading:!1}))}catch(r){throw console.error("Failed to update category:",r),n({isLoading:!1}),r}},deleteCategory:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");await Fl.deleteCategory(i.id,t),n(a=>({categories:a.categories.filter(o=>o.id!==t),isLoading:!1}))}catch(r){throw console.error("Failed to delete category:",r),n({isLoading:!1}),r}},reorderCategories:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No user logged in");const a=e(),o=new Map;t.forEach((u,d)=>o.set(u,d));const c=a.categories.map(u=>{if(!o.has(u.id))return u;const d=o.get(u.id);return u.orderIndex===d?u:{...u,orderIndex:d}});n({categories:c.sort((u,d)=>u.orderIndex-d.orderIndex)}),await Fl.reorderCategories(i.id,c),n({isLoading:!1})}catch(r){throw console.error("Failed to reorder categories:",r),n({isLoading:!1}),r}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},o=await Sn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Sn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(o=>o.id===t.id?t:o),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Sn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(o=>o.id!==t),transactions:a.transactions.filter(o=>o.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){n({isLoading:!1});return}const u=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await Sn.reorderEnvelopes(u.id,o),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:o},u=await Sn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:o};await Sn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Sn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(o=>o.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await Sn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===t),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await Sn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await Sn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",fontSize:t.fontSize??r.appSettings?.fontSize??"medium",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:t.paymentSources??r.appSettings?.paymentSources??[]};(t.userId||r.appSettings?.userId)&&(i.userId=t.userId??r.appSettings?.userId),i.paymentSources&&(i.paymentSources=i.paymentSources.map(c=>{const u={...c};return u.last4===void 0&&delete u.last4,u}));const o=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(o){const{AppSettingsService:c}=await At(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Kk);return{AppSettingsService:u}},void 0);await c.updateAppSettings(o.id,i.id,i)}n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:o}=await At(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Kk);return{AppSettingsService:u}},void 0),c=await o.getAppSettings(i.id);if(c){n({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",fontSize:"medium",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),n({appSettings:a}),console.log(" Initialized default app settings")}catch(t){console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await Sn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const o=await Sn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Sn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Sn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,o]=t.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`;(!e().incomeSources[d]||!e().allocations[d])&&(console.log(` Previous month ${d} data missing, fetching...`),await e().fetchMonthData(d));const h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...S}=_;await e().addIncomeSource(t,S)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>{const w=e().envelopes.find(S=>S.id===_.envelopeId);return!!w&&!w.isPiggybank});if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,S=_.piggybankConfig?.paused??!1;if(!S&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${S}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===t);if(!c){console.error(` setEnvelopeAllocation: Envelope ${t} not found in store! Aborting.`),n({isLoading:!1});return}const u=!!c.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await Sn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,o=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await Sn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await At(()=>Promise.resolve().then(()=>zt),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await Sn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],incomeSources:{},allocations:{},isOnboardingActive:!1,isOnboardingCompleted:!1,isLoading:!1,error:null})}}),{name:"budget-storage",partialize:n=>({envelopes:n.envelopes,transactions:n.transactions,categories:n.categories,appSettings:n.appSettings,incomeSources:n.incomeSources,allocations:n.allocations,currentMonth:n.currentMonth,isOnline:n.isOnline})})));Zee({useBudgetStore:rn,useAuthStore:ta,getCurrentUserId:E0});const Jee=Object.freeze(Object.defineProperty({__proto__:null,useBudgetStore:rn},Symbol.toStringTag,{value:"Module"}));var Wu=9e15,fl=1e9,sw="0123456789abcdef",xv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",_v="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ow={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Wu,maxE:Wu,crypto:!1},A5,Ss,rt=!0,yy="[DecimalError] ",sl=yy+"Invalid argument: ",C5=yy+"Precision limit exceeded",I5=yy+"crypto unavailable",R5="[object Decimal]",xr=Math.floor,$n=Math.pow,ete=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,tte=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,nte=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,D5=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ia=1e7,Ze=7,rte=9007199254740991,ite=xv.length-1,lw=_v.length-1,Ee={toStringTag:R5};Ee.absoluteValue=Ee.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),He(n)};Ee.ceil=function(){return He(new this.constructor(this),this.e+1,2)};Ee.clampedTo=Ee.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(sl+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};Ee.comparedTo=Ee.cmp=function(n){var e,t,r,i,a=this,o=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};Ee.cosine=Ee.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Ze,r.rounding=1,t=ate(r,O5(r,t)),r.precision=n,r.rounding=e,He(Ss==2||Ss==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};Ee.cubeRoot=Ee.cbrt=function(){var n,e,t,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(rt=!1,a=h.s*$n(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=ur(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=$n(t,1/3),n=xr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),o=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=Xt(d.plus(h).times(c),d.plus(u),o+2,1),ur(c.d).slice(0,o)===(t=ur(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&(He(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(He(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return rt=!0,He(r,n,p.rounding,e)};Ee.decimalPlaces=Ee.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-xr(this.e/Ze))*Ze,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};Ee.dividedBy=Ee.div=function(n){return Xt(this,new this.constructor(n))};Ee.dividedToIntegerBy=Ee.divToInt=function(n){var e=this,t=e.constructor;return He(Xt(e,new t(n),0,1,1),t.precision,t.rounding)};Ee.equals=Ee.eq=function(n){return this.cmp(n)===0};Ee.floor=function(){return He(new this.constructor(this),this.e+1,3)};Ee.greaterThan=Ee.gt=function(n){return this.cmp(n)>0};Ee.greaterThanOrEqualTo=Ee.gte=function(n){var e=this.cmp(n);return e==1||e===0};Ee.hyperbolicCosine=Ee.cosh=function(){var n,e,t,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/xy(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=Cd(o,1,a.times(e),new o(1),!0);for(var u,d=n,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return He(a,o.precision=t,o.rounding=r,!0)};Ee.hyperbolicSine=Ee.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Cd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/xy(5,n)),i=Cd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);n--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=t,He(i,e,t,!0)};Ee.hyperbolicTangent=Ee.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,Xt(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};Ee.inverseCosine=Ee.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?Va(e,r,i):new e(0):new e(NaN):n.isZero()?Va(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};Ee.inverseHyperbolicCosine=Ee.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,rt=!1,t=t.times(t).minus(1).sqrt().plus(t),rt=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};Ee.inverseHyperbolicSine=Ee.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,rt=!1,t=t.times(t).plus(1).sqrt().plus(t),rt=!0,r.precision=n,r.rounding=e,t.ln())};Ee.inverseHyperbolicTangent=Ee.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?He(new a(i),n,e,!0):(a.precision=t=r-i.e,i=Xt(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};Ee.inverseSine=Ee.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=Va(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};Ee.inverseTangent=Ee.atan=function(){var n,e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=lw)return o=Va(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=lw)return o=Va(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/Ze+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(rt=!1,e=Math.ceil(c/Ze),r=1,u=d.times(d),o=new h(d),i=d;n!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(n=e;o.d[n]===a.d[n]&&n--;);return t&&(o=o.times(2<<t-1)),rt=!0,He(o,h.precision=p,h.rounding=m,!0)};Ee.isFinite=function(){return!!this.d};Ee.isInteger=Ee.isInt=function(){return!!this.d&&xr(this.e/Ze)>this.d.length-2};Ee.isNaN=function(){return!this.s};Ee.isNegative=Ee.isNeg=function(){return this.s<0};Ee.isPositive=Ee.isPos=function(){return this.s>0};Ee.isZero=function(){return!!this.d&&this.d[0]===0};Ee.lessThan=Ee.lt=function(n){return this.cmp(n)<0};Ee.lessThanOrEqualTo=Ee.lte=function(n){return this.cmp(n)<1};Ee.logarithm=Ee.log=function(n){var e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(rt=!1,c=p+b,o=Uo(d,c),r=e?wv(h,c+10):Uo(n,c),u=Xt(o,r,c,1),pp(u.d,i=p,m))do if(c+=10,o=Uo(d,c),r=e?wv(h,c+10):Uo(n,c),u=Xt(o,r,c,1),!a){+ur(u.d).slice(i+1,i+15)+1==1e14&&(u=He(u,p+1,0));break}while(pp(u.d,i+=10,m));return rt=!0,He(u,p,m)};Ee.minus=Ee.sub=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return rt?He(n,c,u):n}if(t=xr(n.e/Ze),h=xr(b.e/Ze),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,t=h,o=d.length),r=Math.max(Math.ceil(c/Ze),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=ia-1;--d[i],d[r]+=ia}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=by(d,t),rt?He(n,c,u):n):new _(u===3?-0:0)};Ee.modulo=Ee.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?He(new r(t),r.precision,r.rounding):(rt=!1,r.modulo==9?(e=Xt(t,n.abs(),0,3,1),e.s*=n.s):e=Xt(t,n,0,r.modulo,1),e=e.times(n),rt=!0,t.minus(e))};Ee.naturalExponential=Ee.exp=function(){return cw(this)};Ee.naturalLogarithm=Ee.ln=function(){return Uo(this)};Ee.negated=Ee.neg=function(){var n=new this.constructor(this);return n.s=-n.s,He(n)};Ee.plus=Ee.add=function(n){var e,t,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),rt?He(n,c,u):n;if(a=xr(p.e/Ze),r=xr(n.e/Ze),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,o=h.length):(t=h,r=a,o=d.length),a=Math.ceil(c/Ze),o=a>o?a+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/ia|0,d[i]%=ia;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return n.d=d,n.e=by(d,r),rt?He(n,c,u):n};Ee.precision=Ee.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(sl+n);return t.d?(e=k5(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};Ee.round=function(){var n=this,e=n.constructor;return He(new e(n),n.e+1,e.rounding)};Ee.sine=Ee.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Ze,r.rounding=1,t=ote(r,O5(r,t)),r.precision=n,r.rounding=e,He(Ss>2?t.neg():t,n,e,!0)):new r(NaN)};Ee.squareRoot=Ee.sqrt=function(){var n,e,t,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(rt=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=ur(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=xr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(Xt(o,a,t+2,1)).times(.5),ur(a.d).slice(0,t)===(e=ur(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(He(a,u+1,0),a.times(a).eq(o))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(He(r,u+1,1),n=!r.times(r).eq(o));break}return rt=!0,He(r,u,h.rounding,n)};Ee.tangent=Ee.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=Xt(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,He(Ss==2||Ss==4?t.neg():t,n,e,!0)):new r(NaN)};Ee.times=Ee.mul=function(n){var e,t,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=xr(h.e/Ze)+xr(n.e/Ze),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%ia|0,e=c/ia|0;a[i]=(a[i]+e)%ia|0}for(;!a[--o];)a.pop();return e?++t:a.shift(),n.d=a,n.e=by(a,t),rt?He(n,p.precision,p.rounding):n};Ee.toBinary=function(n,e){return $S(this,2,n,e)};Ee.toDecimalPlaces=Ee.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:($r(n,0,fl),e===void 0?e=r.rounding:$r(e,0,8),He(t,n+t.e+1,e))};Ee.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Ka(r,!0):($r(n,0,fl),e===void 0?e=i.rounding:$r(e,0,8),r=He(new i(r),n+1,e),t=Ka(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};Ee.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=Ka(i):($r(n,0,fl),e===void 0?e=a.rounding:$r(e,0,8),r=He(new a(i),n+i.e+1,e),t=Ka(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};Ee.toFraction=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=k5(_)-b.e-1,o=a%Ze,e.d[0]=$n(10,o<0?Ze+o:o),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(sl+c);n=c.gt(e)?a>0?e:d:c}for(rt=!1,c=new w(ur(_)),h=w.precision,w.precision=a=_.length*Ze*2;p=Xt(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=Xt(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=Xt(d,r,a,1).minus(b).abs().cmp(Xt(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,rt=!0,m};Ee.toHexadecimal=Ee.toHex=function(n,e){return $S(this,16,n,e)};Ee.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:$r(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(rt=!1,t=Xt(t,n,0,e,1).times(n),rt=!0,He(t)):(n.s=t.s,t=n),t};Ee.toNumber=function(){return+this};Ee.toOctal=function(n,e){return $S(this,8,n,e)};Ee.toPower=Ee.pow=function(n){var e,t,r,i,a,o,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u($n(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return He(c,r,a);if(e=xr(n.e/Ze),e>=n.d.length-1&&(t=d<0?-d:d)<=rte)return i=N5(u,c,t,r),n.s<0?new u(1).div(i):He(i,r,a);if(o=c.s,o<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return t=$n(+c,d),e=t==0||!isFinite(t)?xr(d*(Math.log("0."+ur(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(rt=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=cw(n.times(Uo(c,r+t)),r),i.d&&(i=He(i,r+5,1),pp(i.d,r,a)&&(e=r+10,i=He(cw(n.times(Uo(c,e+t)),e),e+5,1),+ur(i.d).slice(r+1,r+15)+1==1e14&&(i=He(i,r+1,0)))),i.s=o,rt=!0,u.rounding=a,He(i,r,a))};Ee.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Ka(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):($r(n,1,fl),e===void 0?e=i.rounding:$r(e,0,8),r=He(new i(r),n,e),t=Ka(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};Ee.toSignificantDigits=Ee.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):($r(n,1,fl),e===void 0?e=r.rounding:$r(e,0,8)),He(new r(t),n,e)};Ee.toString=function(){var n=this,e=n.constructor,t=Ka(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};Ee.truncated=Ee.trunc=function(){return He(new this.constructor(this),this.e+1,1)};Ee.valueOf=Ee.toJSON=function(){var n=this,e=n.constructor,t=Ka(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function ur(n){var e,t,r,i=n.length-1,a="",o=n[0];if(i>0){for(a+=o,e=1;e<i;e++)r=n[e]+"",t=Ze-r.length,t&&(a+=ko(t)),a+=r;o=n[e],r=o+"",t=Ze-r.length,t&&(a+=ko(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function $r(n,e,t){if(n!==~~n||n<e||n>t)throw Error(sl+n)}function pp(n,e,t,r){var i,a,o,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=Ze,i=0):(i=Math.ceil((e+1)/Ze),e%=Ze),a=$n(10,Ze-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):o=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==$n(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||t<4)&&c==9999||!r&&t>3&&c==4999):o=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==$n(10,e-3)-1,o}function S0(n,e,t){for(var r,i=[0],a,o=0,c=n.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=sw.indexOf(n.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function ate(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/xy(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=Cd(n,1,e.times(i),new n(1));for(var a=t;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=t,e}var Xt=(function(){function n(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,_,w,S,T,C,R,O,P,M,A,I,k,z,V,B,j=r.constructor,X=r.s==i.s?1:-1,H=r.d,$=i.d;if(!H||!H[0]||!$||!$[0])return new j(!r.s||!i.s||(H?$&&H[0]==$[0]:!$)?NaN:H&&H[0]==0||!$?X*0:X/0);for(u?(b=1,h=r.e-i.e):(u=ia,b=Ze,h=xr(r.e/b)-xr(i.e/b)),V=$.length,k=H.length,T=new j(X),C=T.d=[],p=0;$[p]==(H[p]||0);p++);if($[p]>(H[p]||0)&&h--,a==null?(M=a=j.precision,o=j.rounding):c?M=a+(r.e-i.e)+1:M=a,M<0)C.push(1),_=!0;else{if(M=M/b+2|0,p=0,V==1){for(m=0,$=$[0],M++;(p<k||m)&&M--;p++)A=m*u+(H[p]||0),C[p]=A/$|0,m=A%$|0;_=m||p<k}else{for(m=u/($[0]+1)|0,m>1&&($=n($,m,u),H=n(H,m,u),V=$.length,k=H.length),I=V,R=H.slice(0,V),O=R.length;O<V;)R[O++]=0;B=$.slice(),B.unshift(0),z=$[0],$[1]>=u/2&&++z;do m=0,d=e($,R,V,O),d<0?(P=R[0],V!=O&&(P=P*u+(R[1]||0)),m=P/z|0,m>1?(m>=u&&(m=u-1),w=n($,m,u),S=w.length,O=R.length,d=e(w,R,S,O),d==1&&(m--,t(w,V<S?B:$,S,u))):(m==0&&(d=m=1),w=$.slice()),S=w.length,S<O&&w.unshift(0),t(R,w,O,u),d==-1&&(O=R.length,d=e($,R,V,O),d<1&&(m++,t(R,V<O?B:$,O,u))),O=R.length):d===0&&(m++,R=[0]),C[p++]=m,d&&R[0]?R[O++]=H[I]||0:(R=[H[I]],O=1);while((I++<k||R[0]!==void 0)&&M--);_=R[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,A5=_;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,He(T,c?a+T.e+1:a,o,_)}return T}})();function He(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Ze,o=e,h=p[m=0],u=h/$n(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/Ze),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Ze,o=a-Ze+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Ze,o=a-Ze+i,u=o<0?0:h/$n(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%$n(10,i-o-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?o>0?h/$n(10,i-o):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=$n(10,(Ze-e%Ze)%Ze),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=$n(10,Ze-a),p[m]=o>0?(h/$n(10,i-o)%$n(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(n.e++,p[0]==ia&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=ia)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return rt&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function Ka(n,e,t){if(!n.isFinite())return P5(n);var r,i=n.e,a=ur(n.d),o=a.length;return e?(t&&(r=t-o)>0?a=a.charAt(0)+"."+a.slice(1)+ko(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+ko(-i-1)+a,t&&(r=t-o)>0&&(a+=ko(r))):i>=o?(a+=ko(i+1-o),t&&(r=t-i-1)>0&&(a=a+"."+ko(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(a+="."),a+=ko(r))),a}function by(n,e){var t=n[0];for(e*=Ze;t>=10;t/=10)e++;return e}function wv(n,e,t){if(e>ite)throw rt=!0,t&&(n.precision=t),Error(C5);return He(new n(xv),e,1,!0)}function Va(n,e,t){if(e>lw)throw Error(C5);return He(new n(_v),e,t,!0)}function k5(n){var e=n.length-1,t=e*Ze+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function ko(n){for(var e="";n--;)e+="0";return e}function N5(n,e,t,r){var i,a=new n(1),o=Math.ceil(r/Ze+4);for(rt=!1;;){if(t%2&&(a=a.times(e),Qk(a.d,o)&&(i=!0)),t=xr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),Qk(e.d,o)}return rt=!0,a}function Wk(n){return n.d[n.d.length-1]&1}function M5(n,e,t){for(var r,i,a=new n(e[0]),o=0;++o<e.length;){if(i=new n(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function cw(n,e){var t,r,i,a,o,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(rt=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log($n(2,p))/Math.LN10*2+5|0,u+=r,t=a=o=new m(1),m.precision=u;;){if(a=He(a.times(n),u,1),t=t.times(++h),c=o.plus(Xt(a,t,u,1)),ur(c.d).slice(0,u)===ur(o.d).slice(0,u)){for(i=p;i--;)o=He(o.times(o),u,1);if(e==null)if(d<3&&pp(o.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return He(o,m.precision=_,b,rt=!0);else return m.precision=_,o}o=c}}function Uo(n,e){var t,r,i,a,o,c,u,d,h,p,m,b=1,_=10,w=n,S=w.d,T=w.constructor,C=T.rounding,R=T.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(e==null?(rt=!1,h=R):h=e,T.precision=h+=_,t=ur(S),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=ur(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=wv(T,h+2,R).times(a+""),w=Uo(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=R,e==null?He(w,R,C,rt=!0):w;for(p=w,u=o=w=Xt(w.minus(1),w.plus(1),h,1),m=He(w.times(w),h,1),i=3;;){if(o=He(o.times(m),h,1),d=u.plus(Xt(o,new T(i),h,1)),ur(d.d).slice(0,h)===ur(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(wv(T,h+2,R).times(a+""))),u=Xt(u,new T(b),h,1),e==null)if(pp(u.d,h-_,C,c))T.precision=h+=_,d=o=w=Xt(p.minus(1),p.plus(1),h,1),m=He(w.times(w),h,1),i=c=1;else return He(u,T.precision=R,C,rt=!0);else return T.precision=R,u;u=d,i+=2}}function P5(n){return String(n.s*n.s/0)}function T0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Ze,t<0&&(r+=Ze),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Ze;r<i;)n.d.push(+e.slice(r,r+=Ze));e=e.slice(r),r=Ze-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),rt&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function ste(n,e){var t,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),D5.test(e))return T0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(tte.test(e))t=16,e=e.toLowerCase();else if(ete.test(e))t=2;else if(nte.test(e))t=8;else throw Error(sl+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=n.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=N5(r,new r(t),a,a*2)),d=S0(e,t,ia),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=by(d,h),n.d=d,rt=!1,o&&(n=Xt(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?$n(2,u):Id.pow(2,u))),rt=!0,n)}function ote(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:Cd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/xy(5,t)),e=Cd(n,2,e,e);for(var i,a=new n(5),o=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function Cd(n,e,t,r,i){var a,o,c,u,d=n.precision,h=Math.ceil(d/Ze);for(rt=!1,u=t.times(t),c=new n(r);;){if(o=Xt(c.times(u),new n(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=Xt(o.times(u),new n(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return rt=!0,o.d.length=h+1,o}function xy(n,e){for(var t=n;--e;)t*=n;return t}function O5(n,e){var t,r=e.s<0,i=Va(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return Ss=r?4:1,e;if(t=e.divToInt(i),t.isZero())Ss=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return Ss=Wk(t)?r?2:3:r?4:1,e;Ss=Wk(t)?r?1:4:r?3:2}return e.minus(i).abs()}function $S(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?($r(t,1,fl),r===void 0?r=b.rounding:$r(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=P5(n);else{for(h=Ka(n),o=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=S0(Ka(m),10,i),m.e=m.d.length),p=S0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(n=new b(n),n.d=p,n.e=a,n=Xt(n,m,t,r,0,i),p=n.d,a=n.e,d=A5),o=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(n.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=sw.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=S0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=sw.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function Qk(n,e){if(n.length>e)return n.length=e,!0}function lte(n){return new this(n).abs()}function cte(n){return new this(n).acos()}function ute(n){return new this(n).acosh()}function dte(n,e){return new this(n).plus(e)}function fte(n){return new this(n).asin()}function hte(n){return new this(n).asinh()}function pte(n){return new this(n).atan()}function gte(n){return new this(n).atanh()}function mte(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=Va(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?Va(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=Va(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(Xt(n,e,a,1)),e=Va(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(Xt(n,e,a,1)),t}function vte(n){return new this(n).cbrt()}function yte(n){return He(n=new this(n),n.e+1,2)}function bte(n,e,t){return new this(n).clamp(e,t)}function xte(n){if(!n||typeof n!="object")throw Error(yy+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,fl,"rounding",0,8,"toExpNeg",-Wu,0,"toExpPos",0,Wu,"maxE",0,Wu,"minE",-Wu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=ow[t]),(r=n[t])!==void 0)if(xr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(sl+t+": "+r);if(t="crypto",i&&(this[t]=ow[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(I5);else this[t]=!1;else throw Error(sl+t+": "+r);return this}function _te(n){return new this(n).cos()}function wte(n){return new this(n).cosh()}function j5(n){var e,t,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,Zk(a)){d.s=a.s,rt?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;rt?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return T0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),D5.test(a)?T0(d,a):ste(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,T0(d,a.toString());throw Error(sl+a)}if(i.prototype=Ee,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=xte,i.clone=j5,i.isDecimal=Zk,i.abs=lte,i.acos=cte,i.acosh=ute,i.add=dte,i.asin=fte,i.asinh=hte,i.atan=pte,i.atanh=gte,i.atan2=mte,i.cbrt=vte,i.ceil=yte,i.clamp=bte,i.cos=_te,i.cosh=wte,i.div=Ete,i.exp=Ste,i.floor=Tte,i.hypot=Ate,i.ln=Cte,i.log=Ite,i.log10=Dte,i.log2=Rte,i.max=kte,i.min=Nte,i.mod=Mte,i.mul=Pte,i.pow=Ote,i.random=jte,i.round=Vte,i.sign=zte,i.sin=Lte,i.sinh=Bte,i.sqrt=Ute,i.sub=Fte,i.sum=Gte,i.tan=qte,i.tanh=$te,i.trunc=Hte,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function Ete(n,e){return new this(n).div(e)}function Ste(n){return new this(n).exp()}function Tte(n){return He(n=new this(n),n.e+1,3)}function Ate(){var n,e,t=new this(0);for(rt=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return rt=!0,new this(1/0);t=e}return rt=!0,t.sqrt()}function Zk(n){return n instanceof Id||n&&n.toStringTag===R5||!1}function Cte(n){return new this(n).ln()}function Ite(n,e){return new this(n).log(e)}function Rte(n){return new this(n).log(2)}function Dte(n){return new this(n).log(10)}function kte(){return M5(this,arguments,-1)}function Nte(){return M5(this,arguments,1)}function Mte(n,e){return new this(n).mod(e)}function Pte(n,e){return new this(n).mul(e)}function Ote(n,e){return new this(n).pow(e)}function jte(n){var e,t,r,i,a=0,o=new this(1),c=[];if(n===void 0?n=this.precision:$r(n,1,fl),r=Math.ceil(n/Ze),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(I5);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=Ze,r&&n&&(i=$n(10,Ze-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=Ze)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Ze&&(t-=Ze-r)}return o.e=t,o.d=c,o}function Vte(n){return He(n=new this(n),n.e+1,this.rounding)}function zte(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function Lte(n){return new this(n).sin()}function Bte(n){return new this(n).sinh()}function Ute(n){return new this(n).sqrt()}function Fte(n,e){return new this(n).sub(e)}function Gte(){var n=0,e=arguments,t=new this(e[n]);for(rt=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return rt=!0,He(t,this.precision,this.rounding)}function qte(n){return new this(n).tan()}function $te(n){return new this(n).tanh()}function Hte(n){return He(n=new this(n),n.e+1,1)}Ee[Symbol.for("nodejs.util.inspect.custom")]=Ee.toString;Ee[Symbol.toStringTag]="Decimal";var Id=Ee.constructor=j5(ow);xv=new Id(xv);_v=new Id(_v);const Jk=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},Yte=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=rn(),{currentUser:o}=ta(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=rn(),{showToast:_}=jc(),[w,S]=U.useState(!1),T=U.useRef(null),[C,R]=U.useState(!1),O=!C||r||b,[P,M]=U.useState([]),A=U.useRef([]),[I,k]=U.useState([]),z=U.useRef([]),V=U.useCallback(re=>{if(n.find(fe=>fe.id===re)?.isPiggybank){const fe=rn.getState().getEnvelopeBalance(re);return new Id(fe)}const le=rn.getState().getEnvelopeBalance(re,c);return new Id(le)},[n,c]);U.useEffect(()=>{const re=n.filter(Z=>{if(!Z.isPiggybank||!Z.isActive)return!1;if(Z.createdAt)try{const le=Jk(Z.createdAt);if(!le)return console.error(` Invalid creation date for piggybank ${Z.name}:`,Z.createdAt),!1;const fe=`${le.getFullYear()}-${String(le.getMonth()+1).padStart(2,"0")}`;return c>=fe}catch(le){return console.error(` Error processing piggybank ${Z.name}:`,le,{createdAt:Z.createdAt,typeofCreatedAt:typeof Z.createdAt}),!1}return!0}).sort((Z,le)=>{const fe=Z.orderIndex??0,xe=le.orderIndex??0;return fe-xe});k(re),z.current=re},[n,c]);const B=I,j=P;U.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),t(),R(!0),()=>{T.current&&clearTimeout(T.current)}),[]),U.useEffect(()=>{C&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[C,r,b]),U.useEffect(()=>{const re=n.filter(Z=>{if(Z.isPiggybank||Z.isActive===!1)return!1;const fe=(d[c]||[]).some(ve=>ve.envelopeId===Z.id),xe=e.some(ve=>ve.envelopeId===Z.id&&(ve.month===c||ve.date.startsWith(c)));return fe||xe}).sort((Z,le)=>{const fe=Z.orderIndex??0,xe=le.orderIndex??0;return fe-xe});M(re),A.current=re},[n,d,c,e]);const X=(u[c]||[]).reduce((re,Z)=>re+Z.amount,0),H=(d[c]||[]).filter(re=>j.some(Z=>Z.id===re.envelopeId)||B.some(Z=>Z.id===re.envelopeId)).reduce((re,Z)=>re+Z.budgetedAmount,0),$=X-H,W=U.useCallback(async re=>{if(!re.length)return;const Z=re.map(le=>le.id);try{await a(Z)}catch(le){console.error("Failed to persist envelope order:",le),_("Failed to save envelope order","error")}},[a,_]),ee=U.useCallback(async re=>{await W(re)},[W]),he=U.useCallback(re=>{h(c,re.id).catch(console.error),_(`Deleted "${re.name}"`,"neutral")},[h,c,_]),K=U.useCallback(async re=>{try{const Z=re||c;console.log(" Copying to month:",Z),await m(Z),_("Previous month budget copied","success")}catch(Z){console.error("Error copying previous month:",Z),_("Failed to copy previous month","error")}},[m,_,c]),G=U.useCallback(async()=>{if(!o||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await rn.getState().clearMonthData(c),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(re){console.error("Error clearing month data:",re),_("Failed to clear month data","error")}},[o,c,_]),Y=U.useCallback(async(re,Z)=>{try{await p(re,Z),setTimeout(()=>{const le=rn.getState(),fe=le.currentMonth,xe=le.incomeSources[fe]||[],ve=le.allocations[fe]||[],Ce=new Set(le.envelopes.filter(Pe=>{if(Pe.isPiggybank){if(!Pe.isActive)return!1;if(Pe.createdAt){const Oe=Jk(Pe.createdAt);if(!Oe)return!1;const qe=`${Oe.getFullYear()}-${String(Oe.getMonth()+1).padStart(2,"0")}`;return fe>=qe}return!0}return Pe.isActive!==!1}).map(Pe=>Pe.id)),Ge=ve.filter(Pe=>Ce.has(Pe.envelopeId)),ae=xe.reduce((Pe,Oe)=>Pe+Oe.amount,0),Te=Ge.reduce((Pe,Oe)=>Pe+Oe.budgetedAmount,0);ae-Te<-.005?_(`You can't spend more than you make.
You're not in Congress!`,"error"):Math.abs(ae-Te)<.005&&ae>0&&_("Every dollar has a job ","success")},100)}catch(le){console.error("Failed to set allocation:",le),_("Failed to update budget","error")}},[p,_]);return{visibleEnvelopes:j,piggybanks:B,incomeSources:u,availableToBudget:$,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:O,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:V,fetchData:t,reorderEnvelopes:ee,deleteIncomeSource:he,clearMonthData:G,copyFromPreviousMonth:K,setEnvelopeAllocation:Y,localOrderRef:A,setLocalEnvelopes:M,localPiggybankOrderRef:z,setLocalPiggybanks:k}},Kte=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(_)<.005,C=_<-.005,R=w>0?S/w*100:0;let O="text-gray-900 dark:text-white",P="bg-green-500",M="Left to Budget",A=w>0?Math.min(R,100):0,I=!0;return w===0?(M="Add income to start budgeting",A=0,I=!1,O="text-gray-500 dark:text-zinc-500"):T?(O="text-green-600 dark:text-emerald-400",P="bg-green-500",M="Perfect! Every dollar has a job ",A=100,I=!1):C&&(O="text-red-600 dark:text-red-400",P="bg-red-500",M="You're not in Congress! Try again.",A=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${O}`,children:M}),I&&v.jsxs("span",{className:`text-sm font-bold truncate ${O}`,children:[C?"-":"","$",Math.abs(_).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${P}`,style:{width:`${A}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(OU,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(ka,{size:20})})]}),t&&v.jsx("div",{className:"px-1",children:h()})]})},_y=({children:n,onDelete:e,threshold:t=-100,disabled:r=!1})=>{const i=bW(),[a,o]=U.useState(!1),c=U.useRef(0),u=()=>{r||(o(!0),c.current=Date.now())},d=async(h,p)=>{if(r)return;const m=p.offset.x,b=p.velocity.x;if(setTimeout(()=>o(!1),100),m<t||m<-50&&b<-500){const _=e();_===!1?i.start({x:0}):_ instanceof Promise&&_.then(w=>{w===!1&&i.start({x:0})})}else i.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(j0,{className:"text-white w-6 h-6"})}),v.jsx(xn.div,{drag:r?!1:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:u,onDragEnd:d,animate:i,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${a?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:a?"none":"auto"},children:n})]})},Xte=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=rn(),{showToast:c}=jc(),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(!1);U.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const S=w.target.value.replace(/\D/g,"");if(!S){p("");return}const C=(parseInt(S,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},Wte=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),o=i(n);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(CU,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(Bh,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},Qte="/personal-budget-pwa/icon-512.png",S1="/personal-budget-pwa/images/budget-balanced.png",eN=["Giving","Savings","Housing","Transportation","Food","Personal","Health","Insurance","Debt"],Zte=({currentMonth:n,onComplete:e})=>{const[t,r]=U.useState(0),[i,a]=U.useState(0),[o,c]=U.useState(2500),[u,d]=U.useState(eN),{addCategory:h}=rn(),p=M=>{d(A=>A.includes(M)?A.filter(I=>I!==M):[...A,M])},m=async()=>{for(let M=0;M<u.length;M++)await h({name:u[M],orderIndex:M,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});e()};U.useEffect(()=>{if(console.log("Animation effect triggered:",{currentStep:t,animationKey:i}),t===4){console.log("Starting animation from $2500 to $0"),c(2500);const M=2e3,A=20,I=M/A,k=2500/A;let z=0;const V=setInterval(()=>{z++;const B=Math.max(0,2500-k*z);console.log("Phase 1 - Animation step:",z,"New amount:",B),c(B),z>=A&&(clearInterval(V),console.log("Phase 1 completed - Perfect budget reached"),setTimeout(()=>{console.log("Starting Phase 2 - Over budget demonstration");let j=0;const X=10,H=200,$=500/X,W=setInterval(()=>{j++;const ee=-($*j);console.log("Phase 2 - Over budget step:",j,"Over budget amount:",ee),c(ee),j>=X&&(clearInterval(W),console.log("Animation completed - Over budget scenario demonstrated"))},H)},1e3))},I);return()=>{console.log("Cleaning up animation timers"),clearInterval(V)}}},[i,t]);const _=(M=>{const[A,I]=M.split("-");return new Date(parseInt(A),parseInt(I)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(n),w=[{icon:Bh,title:"Welcome to Dollars At Work!",description:`Let's set up your budget for ${_}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Dollars At Work helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:IF,title:"Step 1: Choose Categories",description:"Select categories to organize your spending",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Categories help group your envelopes. Select the ones you need:"}),v.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto pr-1",children:eN.map(M=>v.jsxs("button",{onClick:()=>p(M),className:`p-3 rounded-xl border text-sm font-medium transition-all flex items-center gap-2 ${u.includes(M)?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-400"}`,children:[v.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${u.includes(M)?"border-blue-500 bg-blue-500":"border-gray-400"}`,children:u.includes(M)&&v.jsx(xs,{size:12,className:"text-white"})}),M]},M))}),u.length===0&&v.jsx("p",{className:"text-red-500 text-xs",children:"Please select at least one category."})]}),color:"blue"},{icon:cI,title:"Step 2: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(xs,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(xs,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(xs,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(Tp,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:Rv,title:"Step 3: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are where you track expenses. You'll assign each envelope to a category."}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(xs,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," (Food)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(xs,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," (Housing)"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(xs,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Gas"})," (Transportation)"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Tap "+" on a category section'})," to add an envelope to it."]})})]}),color:"purple"},{icon:V0,title:"Step 4: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4 relative",children:[v.jsx("button",{onClick:()=>a(M=>M+1),className:"absolute top-2 right-2 p-1.5 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-lg transition-colors",title:"Replay animation",children:v.jsx(_F,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Left to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 mb-3",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-xs text-blue-700 dark:text-blue-300 font-medium",children:[v.jsx("span",{children:"Left to Budget"}),v.jsxs("span",{className:`font-bold ${o<0?"text-red-600 dark:text-red-400":""}`,children:["$",o.toFixed(2)]})]}),v.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:v.jsx(xn.div,{className:`h-full rounded-full ${o<0?"bg-red-500":"bg-green-500"}`,initial:{width:"0%"},animate:{width:o<0?"100%":`${(2500-o)/2500*100}%`},transition:{duration:.3,ease:"easeInOut"}})}),v.jsxs(xn.div,{className:`text-xs font-medium text-center mt-1 ${o===0?"text-green-600 dark:text-emerald-400":o<0?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:.5},children:[o===0&&"Perfect! Every dollar has a job ",o<0&&"You're not in Congress! Try again.",o>0&&"Keep allocating until you reach $0"]})]},i)]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:Sp,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(DF,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(cI,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(V0,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:S1,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of Dollars At Work:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Choose your categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Create envelopes in categories"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Allocate until Left to Budget = $0"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green",useCustomIcon:!0}],S=w[t],T=S.useCustomIcon?S1:S.icon,C=t===w.length-1,R=t===0,P={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[S.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(ci,{mode:"wait",children:v.jsxs(xn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 pb-2",children:v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:S.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:S.description})]}),v.jsx("div",{className:"flex flex-col items-center mx-4",children:t===0?v.jsx("img",{src:Qte,alt:"Dollars At Work",className:`w-20 h-20 ${P.text}`}):S.useCustomIcon?v.jsx("img",{src:S1,alt:"Budget Balanced",className:`w-32 h-32 ${P.text}`}):v.jsx("div",{className:`${P.bg} p-3 rounded-xl`,children:v.jsx(T,{className:`w-8 h-8 ${P.text}`})})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400 whitespace-nowrap",children:["Step ",t+1," of ",w.length]})]})}),v.jsx("div",{className:"px-6 pb-6 pt-2",children:S.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:w.map((M,A)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A===t?`w-8 ${P.button}`:A<t?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},A))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!R&&v.jsxs("button",{onClick:()=>r(M=>M-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(yc,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{if(C)m();else{if(S.title.includes("Choose Categories")&&u.length===0)return;r(M=>M+1)}},disabled:S.title.includes("Choose Categories")&&u.length===0,className:`${R?"flex-1":"flex-[2]"} py-3 px-4 ${P.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:C?v.jsxs(v.Fragment,{children:[v.jsx(Bh,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(EU,{className:"w-5 h-5"})]})})]})]},t)})})})},Jte=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onLongPressTrigger:c})=>{const u=U.useRef(null),[d,h]=U.useState(!1),p=E5(k=>{S5(),c(k,n.id)},{threshold:500,cancelOnMovement:25,detect:sc.Touch}),m=n.piggybankConfig?.targetAmount,b=n.piggybankConfig?.monthlyContribution??0,_=n.piggybankConfig?.color||"#3B82F6",w=n.piggybankConfig?.paused||!1,S=typeof e=="number"?e:e.toNumber(),T=(k,z=1)=>{const V=k.replace("#",""),B=parseInt(V,16),j=B>>16&255,X=B>>8&255,H=B&255;return`rgba(${j}, ${X}, ${H}, ${z})`},C=`linear-gradient(135deg, ${T(_,.14)} 0%, ${T(_,.05)} 100%)`,R=T(_,.4),O=m&&m>0?Math.min(S/m*100,100):0,P=m&&S>=m;U.useEffect(()=>{a&&a!==n.id&&h(!1)},[a,n.id]),U.useEffect(()=>{a===n.id&&(h(!0),o&&o(n.id))},[a,n.id,o]),U.useEffect(()=>{if(!a&&d){const k=setTimeout(()=>{h(!1)},300);return()=>clearTimeout(k)}},[a,d]);const M=k=>{if(d||i){k.preventDefault(),k.stopPropagation();return}t(n.id)},A=a===n.id,I=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:k=>c(k,n.id),children:v.jsx(SM,{size:20})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[v.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[v.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0 flex items-center justify-center",style:{backgroundColor:`${_}20`},children:v.jsx(Sp,{size:12,style:{color:_}})}),v.jsxs("div",{className:"min-w-0",children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx(V0,{size:10,style:{color:_}}),v.jsxs("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400 font-medium",children:["$",b.toFixed(2),"/mo"]}),w&&v.jsxs("span",{className:"text-[9px] text-orange-600 dark:text-orange-400 font-bold ml-1 flex items-center gap-0.5",children:[v.jsx(pF,{size:8})," PAUSED"]})]})]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"text-sm font-bold text-gray-900 dark:text-white leading-none",children:["$",S.toFixed(2)]}),v.jsxs("div",{className:"text-[9px] text-gray-400 dark:text-zinc-500 mt-1",children:["of $",m?.toFixed(0)||"0"]})]})]}),m&&m>0&&v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${O}%`,backgroundColor:_}})}),P&&!m&&v.jsx("div",{className:"text-[9px] text-green-600 dark:text-green-400 font-bold mt-0.5",children:" GOAL REACHED"})]})]});return v.jsx(xn.div,{...p(),layout:!A,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:k=>{r&&r(k),u.current=k},onClick:M,style:{background:C,borderColor:R,boxShadow:A?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:A?50:1,scale:A?1.02:1},className:"rounded-xl py-1.5 px-3 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:I})},th=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},ene=12,tne=(n,e,t)=>Math.min(Math.max(n,e),t),nne=({env:n,budgetedAmount:e,remainingBalance:t,navigate:r,transactions:i,currentMonth:a,setMoveableRef:o,isReorderingActive:c,activelyDraggingId:u,onItemDragStart:d,onLongPressTrigger:h})=>{const p=!!n.isPiggybank,m=n.piggybankConfig?.color||"#3B82F6",b=p?`linear-gradient(135deg, ${th(m,.18)} 0%, ${th(m,.08)} 100%)`:void 0,_=p?th(m,.5):void 0,[w,S]=U.useState(!1),T=E5(V=>{S5(),h(V,n.id)},{threshold:500,cancelOnMovement:25,detect:sc.Touch}),C=i.filter(V=>V.envelopeId===n.id&&V.month===a),R=C.filter(V=>V.type==="Expense"),O=C.filter(V=>V.type==="Income"),P=R.reduce((V,B)=>V+(B.amount||0),0),M=O.reduce((V,B)=>V+(B.amount||0),0),A=M>0?Math.max(0,P/M*100):0,I=V=>{if(w||c){V.preventDefault(),V.stopPropagation();return}r(`/envelope/${n.id}`)};U.useEffect(()=>{u&&u!==n.id&&S(!1)},[u,n.id]),U.useEffect(()=>{u===n.id&&(S(!0),d(n.id))},[u,n.id,d]),U.useEffect(()=>{if(!u&&w){const V=setTimeout(()=>{S(!1)},300);return()=>clearTimeout(V)}},[u,w]);const k=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:V=>h(V,n.id),children:v.jsx(SM,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[p&&v.jsx("span",{className:"w-5 h-5 rounded-full flex items-center justify-center border",style:{borderColor:th(m,.4),backgroundColor:th(m,.15),color:m},children:v.jsx(Sp,{size:10})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"text-[10px] font-medium text-gray-700 dark:text-zinc-300",children:["$",e.toFixed(2)]})]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsxs("span",{className:`text-sm font-bold leading-none ${(typeof t=="number"?t:t.toNumber())<0||100-A<=5?"text-red-500":A>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]}),v.jsx("span",{className:"text-[9px] text-gray-400 dark:text-zinc-500 block uppercase tracking-wider mt-0.5",children:"Remaining"})]})]}),e>0&&v.jsx("div",{className:"mt-1",children:v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-A<=5?"bg-red-500":A>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-A,2)}%`}})})})]})]}),z=u===n.id;return v.jsx(xn.div,{...T(),layout:!z,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":n.id,ref:o(n.id),onClick:I,style:{boxShadow:z?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:b,borderColor:_,cursor:z?"grabbing":"pointer",zIndex:z?50:1,scale:z?1.02:1},className:`py-1.5 px-3 rounded-xl active:scale-[0.99] transition-all select-none border group ${p?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:k})},tN=({category:n,envelopes:e,allocations:t,currentMonth:r,transactions:i,navigate:a,getEnvelopeBalance:o,onReorderGlobal:c})=>{if(e.length===0&&n.id==="uncategorized")return null;const[u,d]=U.useState(e),h=U.useRef(e),[p,m]=U.useState(!1),[b,_]=U.useState(null),w=U.useRef(!1),S=U.useRef(null),T=U.useRef({}),C=U.useRef({}),R=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0});U.useEffect(()=>{p||(d(e),h.current=e)},[e,p]);const O=U.useCallback((M,A)=>{const I=C.current[A];if(I){w.current=!0;const k=M.nativeEvent||M;I.dragStart(k)}},[]),P=U.useCallback(M=>A=>{A?T.current[M]=A:delete T.current[M]},[]);return U.useEffect(()=>{const M=()=>{Object.values(C.current).forEach(k=>k?.destroy()),C.current={}};if(!u.length)return;const A=()=>{u.forEach(k=>{const z=T.current[k.id];if(!z||!S.current)return;const V=new jee(S.current,{target:z,draggable:!0,throttleDrag:0,snappable:!0,snapThreshold:5,snapDirections:{top:!0,bottom:!0},elementSnapDirections:{top:!0,bottom:!0},clickable:!0,dragArea:!1,hideDefaultLines:!0,renderDirections:[]});V.on("dragStart",j=>{if(!w.current){j.stop();return}const X=j.inputEvent.target;if(X.closest(".js-budget-target")||X.tagName==="INPUT"){j.stop();return}const H=h.current.findIndex(ee=>ee.id===k.id),$=j.target,W=$.getBoundingClientRect();_(k.id),R.current={activeId:k.id,startIndex:H,currentIndex:H,itemHeight:W.height+ene},$.style.transition="none",$.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",$.style.zIndex="20",m(!0)});let B=null;V.on("drag",j=>{const X=j.target;B!==null&&cancelAnimationFrame(B),B=requestAnimationFrame(()=>{const H=R.current;if(H.activeId!==k.id)return;const $=j.beforeTranslate[1];X.style.transform=`translateY(${$}px)`,X.style.transition="none";const{itemHeight:W,startIndex:ee}=H,he=Math.round($/W),K=tne(ee+he,0,h.current.length-1);K!==H.currentIndex&&(H.currentIndex=K,h.current.forEach((G,Y)=>{if(G.id===k.id)return;const re=T.current[G.id];if(!re)return;let Z=0;ee<K&&Y>ee&&Y<=K?Z=-W:ee>K&&Y>=K&&Y<ee&&(Z=W),re.style.transform=Z?`translateY(${Z}px)`:"",re.style.transition="transform 0.2s ease"})),B=null})}),V.on("dragEnd",j=>{B!==null&&(cancelAnimationFrame(B),B=null);const X=j.target,{startIndex:H,currentIndex:$}=R.current;if(X.style.transform="",X.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",X.style.boxShadow="",h.current.forEach(W=>{const ee=T.current[W.id];ee&&(ee.style.transform="",ee.style.transition="")}),H!==$){const W=[...h.current],[ee]=W.splice(H,1);W.splice($,0,ee),h.current=W,d(W),c(W.map(he=>he.id))}setTimeout(()=>{X.style.zIndex="",_(null),m(!1),w.current=!1},300)}),V.on("click",()=>{const j=window.event?.target;j&&(j.closest(".js-budget-target")||j.tagName==="INPUT")||a(`/envelope/${k.id}`)}),C.current[k.id]=V})},I=window.setTimeout(A,80);return()=>{clearTimeout(I),M()}},[u,a,c]),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white flex items-center gap-2",children:n.name}),v.jsx("button",{onClick:()=>a(n.id==="uncategorized"?"/add-envelope":`/add-envelope?categoryId=${n.id}`),className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",title:`Add to ${n.name}`,children:v.jsx(Tp,{size:20})})]}),v.jsx("div",{ref:S,className:"space-y-2 relative",children:u.length===0?v.jsx("div",{className:"py-2 text-center border border-dashed border-gray-100 dark:border-zinc-800 rounded-xl",children:v.jsx("p",{className:"text-[10px] text-gray-400 dark:text-zinc-500",children:"Empty category"})}):v.jsx(ci,{initial:!1,children:u.map(M=>{const I=(t[r]||[]).find(z=>z.envelopeId===M.id)?.budgetedAmount||0,k=o(M.id);return M.isPiggybank?v.jsx(Jte,{piggybank:M,balance:k,onNavigate:z=>a(`/envelope/${z}`),setMoveableRef:P(M.id),isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:O},M.id):v.jsx(nne,{env:M,budgetedAmount:I,remainingBalance:k,navigate:a,transactions:i,currentMonth:r,setMoveableRef:P,isReorderingActive:p,activelyDraggingId:b,onItemDragStart:()=>{},onLongPressTrigger:O},M.id)})})})]})},rne=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,deleteIncomeSource:p}=Yte(),{setMonth:m,setIsOnboardingActive:b,isOnboardingActive:_,isOnboardingCompleted:w,completeOnboarding:S,categories:T,fetchCategories:C,envelopes:R,reorderEnvelopes:O}=rn(),P=Qa(),[M,A]=U.useState(!1),[I,k]=U.useState("add"),[z,V]=U.useState(null),[B,j]=U.useState(!1),[X,H]=U.useState(!1),$=U.useRef(null),W=U.useRef(null),[ee,he]=U.useState(0);U.useEffect(()=>{T.length===0&&C()},[T.length,C]);const K=U.useMemo(()=>{const ve={},Ce=[];return T.forEach(ae=>ve[ae.id]=[]),[...n,...e].sort((ae,Te)=>(ae.orderIndex??0)-(Te.orderIndex??0)).forEach(ae=>{ae.categoryId&&ve[ae.categoryId]?ve[ae.categoryId].push(ae):Ce.push(ae)}),{groups:ve,uncategorized:Ce}},[T,n,e]),G=U.useCallback(async ve=>{const Ce=[...R.map(Pe=>Pe.id)],Ge=new Set(ve),ae=[];let Te=0;Ce.forEach(Pe=>{Ge.has(Pe)?ae.push(ve[Te++]):ae.push(Pe)}),await O(ae)},[R,O]);U.useLayoutEffect(()=>{if(_)return;const ve=W.current;if(!ve)return;const Ce=()=>he(ve.getBoundingClientRect().height);Ce();const Ge=new ResizeObserver(()=>Ce());return Ge.observe(ve),window.addEventListener("resize",Ce),()=>{window.removeEventListener("resize",Ce),Ge.disconnect()}},[_,i,t,a,n,e,r]),U.useEffect(()=>{if(!u&&!c){const ve=setTimeout(()=>{if(_)return;if(w){b(!1);const ae=(t[i]||[]).length===0&&(a[i]||[]).length===0,Te=Object.keys(t).some(Pe=>(t[Pe]||[]).length>0)||Object.keys(a).some(Pe=>(a[Pe]||[]).length>0);H(!!(ae&&Te));return}const Ce=(t[i]||[]).length===0&&(a[i]||[]).length===0,Ge=Object.keys(t).some(ae=>(t[ae]||[]).length>0)||Object.keys(a).some(ae=>(a[ae]||[]).length>0);Ce?Ge?(H(!0),b(!1)):(b(!0),H(!1)):(H(!1),b(!1))},500);return()=>clearTimeout(ve)}},[u,c,i,t,a,w]);const Y=()=>{k("add"),V(null),A(!0)},re=ve=>{$.current&&clearTimeout($.current),!B&&(k("edit"),V(ve),A(!0))},Z=ve=>{$.current&&clearTimeout($.current),j(!0),p(ve),setTimeout(()=>j(!1),500)},le=()=>{A(!1),V(null)},fe=async()=>{H(!1);const{copyPreviousMonthAllocations:ve}=rn.getState();await ve(i)},xe=()=>{S(),b(!1)};return u?v.jsx($O,{message:d?"Still loading...":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:".moveable-control, .moveable-origin, .moveable-line { display: none !important; }"}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!_&&v.jsx("header",{ref:W,className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(Kte,{currentMonth:i,onMonthChange:ve=>{H(!1),m(ve)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((ve,Ce)=>ve+Ce.amount,0),totalAllocated:(a[i]||[]).filter(ve=>n.some(Ce=>Ce.id===ve.envelopeId)||e.some(Ce=>Ce.id===ve.envelopeId)).reduce((ve,Ce)=>ve+Ce.budgetedAmount,0)}})}),v.jsxs("div",{className:"pb-[calc(8rem+env(safe-area-inset-bottom))] px-4 max-w-4xl mx-auto space-y-4",style:_?void 0:{paddingTop:Math.max(0,ee+16)},children:[_?v.jsx(Zte,{currentMonth:i,onComplete:xe}):X?v.jsx(Wte,{currentMonth:i,onCopy:fe}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-3 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2 px-1",children:[v.jsx("h2",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:Y,className:"text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 p-1 rounded-full transition-colors",children:v.jsx(Tp,{size:20})})]}),(t[i]||[]).length===0?v.jsx("div",{className:"text-center py-4",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-[10px]",children:"No income sources yet."})}):v.jsx("div",{className:"space-y-2",children:v.jsx(ci,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(ve=>v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(_y,{onDelete:()=>Z(ve),children:v.jsxs("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>re(ve),children:[v.jsx("div",{className:"flex-1",children:v.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:ve.name})}),v.jsxs("p",{className:"text-xs font-bold text-green-600 dark:text-emerald-400",children:["$",ve.amount.toFixed(2)]})]})})},ve.id))})})]}),T.map(ve=>v.jsx(tN,{category:ve,envelopes:K.groups[ve.id]||[],allocations:a,currentMonth:i,transactions:o,navigate:P,getEnvelopeBalance:h,onReorderGlobal:G},ve.id)),K.uncategorized.length>0&&v.jsx(tN,{category:{id:"uncategorized",name:"Uncategorized"},envelopes:K.uncategorized,allocations:a,currentMonth:i,transactions:o,navigate:P,getEnvelopeBalance:h,onReorderGlobal:G}),T.length===0&&K.uncategorized.length===0&&v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800 text-center py-12",children:[v.jsx(Rv,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:"No envelopes yet."}),v.jsx("button",{onClick:()=>P("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]})]}),v.jsx(Xte,{isVisible:M,onClose:le,mode:I,initialIncomeSource:z})]})]})]})},ine=[],V5=({selectedCard:n,onCardSelect:e,initialCards:t=ine,disabled:r=!1,isUserSelected:i=!1})=>{const a=rn(V=>V.appSettings),o=rn(V=>V.updateAppSettings),[c,u]=U.useState(t.length>0?t[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=U.useState(!1),[p,m]=U.useState(!1),[b,_]=U.useState(t),[w,S]=U.useState(null),[T,C]=U.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"});U.useEffect(()=>{a?.paymentSources&&(_(a.paymentSources),a.paymentSources.length>0&&!n&&u(a.paymentSources[0]))},[a,n]);const R=n||c;U.useEffect(()=>{!n&&e&&b.length>0&&e(b[0])},[n,e,b]);const O=V=>{r||(V.id==="add-new"?m(!0):(u(V),e?.(V),h(!1)))},P=()=>{r||h(!d)},M=V=>{r||S(V)},A=async()=>{if(w&&!r){const V=b.filter(B=>B.id!==w.id);if(_(V),R?.id===w.id){const B=V.length>0?V[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(B),e?.(B)}S(null),h(!1);try{await o({paymentSources:V})}catch(B){console.error("Failed to delete card from app settings:",B),_(b),alert("Failed to delete card. Please try again.");return}}},I=()=>{S(null)},k=async()=>{if(r)return;const V=!["Cash","Venmo"].includes(T.network);if(V&&(T.last4.length!==4||!/^\d{4}$/.test(T.last4))){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a name");return}const B={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:V?T.last4:void 0,color:T.color},j=[...b,B];_(j),u(B),e?.(B),m(!1),h(!1);try{await o({paymentSources:j})}catch(X){console.error("Failed to save card to app settings:",X),_(b),u(R),alert("Failed to save card. Please try again.");return}C({name:"",network:"Visa",last4:"",color:"#3b82f6"})},z=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:P,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:R.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:R.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(R.network)?R.network==="Cash"?"$$$":"@":` ${R.last4||""}`})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:R.name}),v.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Cash","Venmo"].includes(R.network)?R.network:`(...${R.last4})`})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsx("div",{className:"card-stack-dropdown",children:v.jsx("div",{className:"card-stack",children:v.jsx(ci,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((V,B)=>{const j=R.id===V.id,X=V.id==="add-new",H=["Cash","Venmo"].includes(V.network);return v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(_y,{onDelete:()=>!X&&!r&&M(V),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${j?"selected":""} ${X?"add-new-card":""}`,onClick:()=>O(V),style:{backgroundColor:X?"#f3f4f6":V.color,color:X?"#374151":V.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-B},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:X?"":V.network}),j&&!X&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:V.name}),v.jsx("div",{className:"card-number",children:X?"":H?V.network==="Cash"?"$$$":"@":` ${V.last4}`})]}),X&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},V.id)})})})})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Payment Method"}),v.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Name"}),v.jsx("input",{type:"text",value:T.name,onChange:V=>C({...T,name:V.target.value}),placeholder:"e.g., Wallet Cash, My Venmo",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),v.jsxs("select",{value:T.network,onChange:V=>C({...T,network:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"}),v.jsx("option",{value:"Cash",children:"Cash"}),v.jsx("option",{value:"Venmo",children:"Venmo"})]})]}),!["Cash","Venmo"].includes(T.network)&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:V=>C({...T,last4:V.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:z.map(V=>v.jsx("button",{type:"button",onClick:()=>C({...T,color:V}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===V?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:V}},V))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(T.network)?T.network==="Cash"?"$$$":"@":` ${T.last4||"0000"}`})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:k,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add"})]})]})]})}),w&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:w.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:A,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},z5=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=rn(),[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState(""),[w,S]=U.useState(new Date().toISOString().split("T")[0]),[T,C]=U.useState(null);U.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),C(i.paymentMethod||null);try{const A=new Date(i.date);isNaN(A.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(A.toISOString().split("T")[0])}catch(A){console.error("Error parsing transaction date:",A),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),S(new Date().toISOString().split("T")[0])},[n,t,i]);const R=async A=>{A.preventDefault();const I=parseFloat(d);if(isNaN(I)||I<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:I,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),z=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(z!==u){const V=`This transaction date (${z}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(V))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},O=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},P=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",M=t==="add"?"text-green-500":"text-red-500";return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:P}),v.jsx("button",{onClick:R,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0||i?.isAutomatic,children:i?.isAutomatic?"":"Save"})]}),v.jsxs("form",{onSubmit:R,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${M}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:A=>{const I=A.target.value.replace(/\D/g,"");if(!I){h("");return}const z=(parseInt(I,10)/100).toFixed(2);h(z)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,disabled:i?.isAutomatic,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${M} placeholder-gray-700 ${i?.isAutomatic?"cursor-not-allowed opacity-80":""}`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),!i?.isAutomatic&&v.jsx(V5,{selectedCard:T,onCardSelect:C}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:A=>_(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(w);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(ed,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:w,onChange:A=>{console.log("Date changed to:",A.target.value),S(A.target.value)},required:!0,disabled:i?.isAutomatic,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark] disabled:opacity-80"})]}),t==="edit"&&!i?.isAutomatic&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:O,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(TM,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},ane=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=rn(),[a,o]=U.useState(""),[c,u]=U.useState(""),[d,h]=U.useState(""),[p,m]=U.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==t.id);U.useEffect(()=>{if(!n)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[n]);const _=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(S=>S.id===a);return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>v.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const R=(parseInt(T,10)/100).toFixed(2);u(R)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},sne=({isOpen:n,onClose:e,onSave:t,existingPiggybank:r})=>{const[i,a]=U.useState(""),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState("#3B82F6"),[m,b]=U.useState("piggy-bank"),[_,w]=U.useState(!1),[S,T]=U.useState(!1);U.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),w(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),w(!1))},[r,n]);const C=async O=>{if(O.preventDefault(),!(!i.trim()||!u)){T(!0);try{const P={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:_}};o&&parseFloat(o)>0&&(P.piggybankConfig.targetAmount=parseFloat(o)),r&&(P.id=r.id,P.currentBalance=r.currentBalance,P.lastUpdated=new Date().toISOString(),P.isActive=r.isActive,P.orderIndex=r.orderIndex,P.userId=r.userId),await t(P),e()}catch(P){console.error("Error saving piggybank:",P),alert("Failed to save piggybank")}finally{T(!1)}}},R=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(Sp,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(Dv,{size:24})})]}),v.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:O=>a(O.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:O=>{const P=O.target.value.replace(/\D/g,"");if(!P){d("");return}const A=(parseInt(P,10)/100).toFixed(2);d(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:O=>{const P=O.target.value.replace(/\D/g,"");if(!P){c("");return}const A=(parseInt(P,10)/100).toFixed(2);c(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:_,onChange:O=>w(O.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:R.map(O=>v.jsx("button",{type:"button",onClick:()=>p(O.value),className:`w-full aspect-square rounded-lg transition-all ${h===O.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:O.value},title:O.label},O.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:S,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||S,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!S?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:S?"Saving...":r?"Update":"Create"})]})]})]})]})})},one=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},lne=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},L5=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:one(n.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",lne(n.amount)]}),t?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?v.jsx(xs,{className:"text-green-500",size:20}):v.jsx(lI,{className:"text-gray-400",size:20})}):v.jsx("span",{children:n.reconciled?v.jsx(xs,{className:"text-green-500",size:20}):v.jsx(lI,{className:"text-gray-400",size:20})})]})]})},T1=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),cne=()=>{const{id:n}=g8(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p,allocations:m,incomeSources:b,setEnvelopeAllocation:_,updatePiggybankContribution:w,updateEnvelope:S}=rn(),{showToast:T}=jc(),C=Qa(),R=da(),[O,P]=U.useState(!1),[M,A]=U.useState(!1),[I,k]=U.useState(!1),[z,V]=U.useState(null),[B,j]=U.useState(!1),[X,H]=U.useState(!1),[$,W]=U.useState(""),ee=U.useRef(null),he=U.useRef(!1);U.useEffect(()=>{e.length===0&&r()},[]);const K=e.find(ae=>ae.id===n),G=async ae=>{if(K)try{const Te={...K,...ae,id:K.id,userId:K.userId,currentBalance:K.currentBalance,lastUpdated:new Date().toISOString(),isActive:K.isActive,orderIndex:K.orderIndex};await S(Te),T("Piggybank updated successfully","success"),j(!1)}catch(Te){console.error("Failed to update piggybank:",Te),T("Failed to update piggybank","error")}},Y=K?.isPiggybank?K.piggybankConfig?.monthlyContribution||0:m[p]?.find(ae=>ae.envelopeId===n)?.budgetedAmount||0;U.useEffect(()=>{X&&(W(Y.toString()),setTimeout(()=>{ee.current?.focus(),ee.current?.select()},50))},[X,Y]);const re=ae=>{const Te=(b[p]||[]).reduce((Ue,Se)=>Ue+Se.amount,0),Pe=m[p]||[];let qe=Pe.map(Ue=>K&&Ue.envelopeId===K.id&&ae!==void 0?{...Ue,budgetedAmount:ae}:Ue).filter(Ue=>{const Se=e.find(ze=>ze.id===Ue.envelopeId);return Se?Se.isActive!==!1:!1}).reduce((Ue,Se)=>Ue+Se.budgetedAmount,0);return ae!==void 0&&K&&(Pe.some(Se=>Se.envelopeId===K.id)||(qe+=ae)),Te-qe},le=X?re(parseFloat($)||0):re(),fe=async()=>{if(!K||he.current)return;const ae=parseFloat($);if(isNaN(ae)||ae<0){T("Please enter a valid positive number","error");return}he.current=!0;try{K.isPiggybank?await w(K.id,ae):await _(K.id,ae),H(!1)}catch(Te){console.error("Failed to save budget:",Te),T("Failed to update budget","error")}finally{he.current=!1}};if(!K)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(K.isPiggybank){const ae=t.filter(Te=>Te.envelopeId===K.id);console.log(" Piggybank:",K.name),console.log(" Created at:",K.createdAt),console.log(" Transactions:",ae.map(Te=>({date:Te.date,description:Te.description,amount:Te.amount})))}const xe=t.filter(ae=>ae.envelopeId===K.id).filter(ae=>{if(ae.description==="Budgeted"||ae.description==="Piggybank Contribution")return!1;if(K.isPiggybank){if(!K.createdAt)return!0;const Te=bv(K.createdAt).toISOString().split("T")[0];return bv(ae.date).toISOString().split("T")[0]>=Te}return ae.month===p||!ae.month}).sort((ae,Te)=>new Date(Te.date).getTime()-new Date(ae.date).getTime()),ve=()=>{R.state?.fromGlobalFAB?C("/"):C(-1)},Ce=()=>{n&&(a(n),C(-1))},Ge=ae=>{const Te={...ae,reconciled:!ae.reconciled};c(Te)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{if(K.isPiggybank)j(!0);else{const ae=prompt("Rename envelope:",K.name);ae&&ae.trim()&&n&&o(n,ae)}},className:"text-blue-600 dark:text-blue-400 font-medium",children:K.isPiggybank?"Edit":"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:K.name}),v.jsx("button",{onClick:ve,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsxs("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const ae=K.isPiggybank?h(K.id):h(K.id,p);return console.log(`Debug: Envelope ${K.name} Balance:`,ae),v.jsx("span",{className:`text-xl font-bold ${ae<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:T1(ae)})})()]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-zinc-400",children:K.isPiggybank?"Monthly Contribution":"Budgeted This Month"}),X?v.jsx("form",{onSubmit:ae=>{ae.preventDefault(),fe()},className:"flex items-center gap-2",children:v.jsx("input",{ref:ee,type:"number",step:"0.01",value:$,onChange:ae=>W(ae.target.value),onBlur:fe,className:"w-24 px-2 py-1 text-right font-semibold bg-gray-100 dark:bg-zinc-800 rounded border border-blue-500 focus:outline-none"})}):v.jsx("div",{onClick:()=>H(!0),className:"px-2 py-1 -mr-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800 cursor-pointer transition-colors",children:v.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:T1(Y)})})]}),v.jsxs("div",{className:`mt-3 py-1.5 px-3 rounded-md flex justify-between items-center text-xs font-medium transition-colors ${le<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":le===0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:[v.jsx("span",{children:"Left to Budget:"}),v.jsx("span",{children:T1(le)})]})]})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>P(!0),children:[v.jsx(BU,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>A(!0),children:[v.jsx(zU,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>k(!0),children:[v.jsx(_U,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:xe.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(ci,{initial:!1,mode:"popLayout",children:xe.map(ae=>v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(_y,{disabled:ae.isAutomatic,onDelete:()=>{if(!ae.id)return;const Te={...ae};u(ae.id),T("Transaction deleted","neutral",()=>d(Te))},children:v.jsx(L5,{transaction:ae,onReconcile:()=>Ge(ae),onEdit:()=>{ae.isAutomatic||V(ae)}})})},ae.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const ae=K.isPiggybank?`Are you sure you want to delete "${K.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${K.name}" from ${p}? This will delete all transactions for this month only.`;confirm(ae)&&Ce()},children:[v.jsx(TM,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(z5,{isVisible:O||M||!!z,onClose:()=>{P(!1),A(!1),V(null)},mode:O?"add":M?"spend":"edit",currentEnvelope:K,initialTransaction:z}),v.jsx(ane,{isVisible:I,onClose:()=>k(!1),sourceEnvelope:K}),v.jsx(sne,{isOpen:B,onClose:()=>j(!1),onSave:G,existingPiggybank:K})]})},une=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=U.useState("confirm"),b=S=>{const[T,C]=S.split("-");return new Date(parseInt(T),parseInt(C)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},_=()=>{p==="confirm"?m("final_confirm"):p==="final_confirm"&&t()},w=()=>{m("confirm"),e()};return v.jsx(ci,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(xn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(xn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",b(r)]}),v.jsx("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:p==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})})]}):v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4",children:v.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),v.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-2",children:"Are you absolutely sure?"}),v.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["This action cannot be undone. All budget data and transactions for ",v.jsx("strong",{children:b(r)})," will be permanently removed."]})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:w,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:_,disabled:h,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":p==="confirm"?"Continue":"Yes, Start Fresh"})]})]})]})})},dne=()=>{const n=Qa(),e=U.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:_,resetOnboarding:w}=rn(),{deleteAccount:S,currentUser:T,logout:C}=ta(),[R,O]=U.useState(null),[P,M]=U.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[A,I]=U.useState(!1),[k,z]=U.useState(""),[V,B]=U.useState(!1),[j,X]=U.useState(!1),[H,$]=U.useState(null),[W,ee]=U.useState(!1),[he,K]=U.useState(!1),G=978307200,Y=c?.theme??"system",re=c?.fontSize??"medium";U.useEffect(()=>{c||d().catch(Se=>{console.error("Failed to initialize app settings:",Se)})},[d,c]);const Z=(Se,ze)=>{O({type:Se,text:ze}),setTimeout(()=>O(null),3500)},le=U.useMemo(()=>{const Se=t.length,ze=r.length,Ne=m?p[m]||[]:[],Le=Object.values(h).reduce((pn,Ut)=>pn+Ut.length,0),lt=Ne.length,Ct=t.reduce((pn,Ut)=>{const Cn=o(Ut.id);return pn+(typeof Cn=="number"?Cn:0)},0),et=0,ft=r.reduce((pn,Ut)=>{let Cn=0;if(typeof Ut.date=="string"){const Hr=Date.parse(Ut.date);Cn=Number.isNaN(Hr)?0:Hr}else typeof Ut.date=="number"&&(Cn=Ut.date<2e9?(Ut.date+G)*1e3:Ut.date);return Math.max(pn,Cn)},0),kt=et||ft?new Date(Math.max(et,ft)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:Se,transactionCount:ze,incomeSourceCount:Le,allocationCount:lt,totalBalance:Ct,lastUpdated:kt}},[t,r,h,p,m]),fe=()=>{try{console.log(" Creating backup...");const Se={appVersion:"1.6.8",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(Ct=>({...Ct,currentBalance:(()=>{const et=o(Ct.id);return typeof et=="number"?et:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},ze=new Blob([JSON.stringify(Se,null,2)],{type:"application/json"}),Ne=URL.createObjectURL(ze),Le=document.createElement("a");Le.href=Ne,Le.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Le),Le.click(),document.body.removeChild(Le),URL.revokeObjectURL(Ne);const lt=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",lt),M(lt),$({success:!0,message:"Backup downloaded successfully."})}catch(Se){console.error(Se),$({success:!1,message:"Failed to create backup file.",onRetry:fe})}},xe=()=>{X(!0),$(null);try{const Se=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],ze=r.filter(et=>et.description!=="Budgeted"&&et.description!=="Piggybank Contribution").map(et=>{const ft=t.find(fa=>fa.id===et.envelopeId)?.name||"Unknown",kt=(et.merchant||"").replace(/"/g,'""'),pn=(et.description||"").replace(/"/g,'""');let Ut="";et.paymentMethod&&(Ut=`${et.paymentMethod.name} (...${et.paymentMethod.last4})`);const Cn=Ut.replace(/"/g,'""');let Hr="Invalid Date";if(et.date){if(typeof et.date=="string")Hr=et.date.split("T")[0];else if(typeof et.date=="number"){const fa=et.date<2e9?(et.date+G)*1e3:et.date;Hr=new Date(fa).toISOString().split("T")[0]}}return[Hr,`"${kt}"`,`"${Cn}"`,`"${pn}"`,et.amount.toFixed(2),et.type,`"${ft}"`,et.reconciled?"Yes":"No"].join(",")}),Ne=[Se.join(","),...ze].join(`
`),Le=new Blob([Ne],{type:"text/csv;charset=utf-8;"}),lt=URL.createObjectURL(Le),Ct=document.createElement("a");Ct.href=lt,Ct.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Ct),Ct.click(),document.body.removeChild(Ct),URL.revokeObjectURL(lt),$({success:!0,message:"Transactions CSV exported successfully."})}catch(Se){console.error(Se),$({success:!1,message:"Failed to export CSV. Please try again.",onRetry:xe})}finally{X(!1)}},ve=()=>{e.current?.click()},Ce=Se=>{const ze=Se.target.files?.[0];if(!ze)return;const Ne=new FileReader;Ne.onload=async Le=>{try{const lt=JSON.parse(Le.target?.result),Ct=await a(lt);if(!Ct.success){Z("error",Ct.message);return}if(lt.appSettings?.theme)try{await u({theme:lt.appSettings.theme})}catch(et){console.error("Failed to update imported settings:",et)}Z("success",`Loaded ${lt.envelopes?.length??0} envelopes, ${lt.transactions?.length??0} transactions.`)}catch(lt){console.error(lt),Z("error","Invalid backup file. Please verify the JSON.")}},Ne.readAsText(ze),Se.target.value=""},Ge=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),Z("success","All data has been permanently deleted."),n("/")}catch(Se){console.error("Reset failed:",Se),Z("error","Failed to delete all data. Some data may remain.")}},ae=async()=>{if(!k.trim()){Z("error","Please enter your password to confirm account deletion.");return}I(!0);try{await i(),await S(k)?Z("success","Your account has been permanently deleted."):Z("error","Failed to delete account. Please try again.")}catch(Se){console.error("Account deletion failed:",Se),Z("error","Failed to delete account. Please try again.")}finally{I(!1),B(!1),z("")}},Te=async()=>{if(!T){Z("error","You must be logged in to clean up data.");return}ee(!0);try{const Se=await qS.cleanupOrphanedData(T.id),ze=Se.orphanedAllocationsDeleted+Se.orphanedTransactionsDeleted;ze>0?Z("success",`Cleaned ${ze} orphaned items: ${Se.orphanedAllocationsDeleted} allocations and ${Se.orphanedTransactionsDeleted} transactions.`):Z("success","No orphaned data found. Your database is already clean!")}catch(Se){console.error("Cleanup failed:",Se),Z("error","Failed to clean up orphaned data. Please try again.")}finally{ee(!1)}},Pe=()=>{K(!0)},Oe=async()=>{K(!1),await b(m),Z("success","Month data has been reset.")},qe=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{_(),C(),n("/")}catch(Se){console.error("Logout failed:",Se)}},Ue=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[R&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${R.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[R.type==="success"?v.jsx(V1,{size:18}):v.jsx(j0,{size:18}),R.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:Ue}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:qe,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(dF,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(uI,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:le.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Categories"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>n("/settings/categories"),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Manage Categories"})]}),v.jsx(ka,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[Y==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),Y==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),Y==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:Y})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({theme:Se.value})}catch(ze){console.error("Failed to update theme setting:",ze)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${Y===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:Se.label},Se.value))})]}),v.jsx("div",{className:"h-px bg-gray-100 dark:bg-zinc-800"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-gray-500 text-lg",children:"Aa"}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Font Size"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:re})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"A",value:"extra-small",sizeClass:"text-[10px]"},{label:"A",value:"small",sizeClass:"text-xs"},{label:"A",value:"medium",sizeClass:"text-base"},{label:"A",value:"large",sizeClass:"text-xl"},{label:"A",value:"extra-large",sizeClass:"text-2xl"}].map(Se=>v.jsx("button",{onClick:async()=>{try{await u({fontSize:Se.value})}catch(ze){console.error("Failed to update font size setting:",ze)}},className:`flex-1 py-2 rounded-lg font-medium border transition-colors flex items-center justify-center ${re===Se.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:v.jsx("span",{className:Se.sizeClass,children:Se.label})},Se.value))})]})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{w(),n("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Bh,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(ka,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:fe,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(uI,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",P]})]})]}),v.jsx(ka,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:ve,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(zF,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(ka,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:xe,disabled:j,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[j?v.jsx(dI,{className:"text-blue-500 animate-spin",size:20}):v.jsx(JU,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:j?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(ka,{className:"text-gray-400",size:18})]}),v.jsx("input",{type:"file",ref:e,onChange:Ce,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:Pe,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Lh,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(ka,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Te,disabled:W,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[W?v.jsx(dI,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(Bh,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:W?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(ka,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ge,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(j0,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(ka,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>B(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(ed,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(ka,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.6.8"," (PWA)"]}),"        "]}),H&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[H.success?v.jsx(V1,{className:"text-green-500",size:24}):v.jsx(ed,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:H.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:H.message}),v.jsxs("div",{className:"flex gap-2",children:[H.onRetry&&v.jsx("button",{onClick:()=>{$(null),H.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>$(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(une,{isVisible:he,onClose:()=>K(!1),onConfirm:Oe,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((Se,ze)=>Se+ze.amount,0),allocationCount:(p[m]||[]).filter(Se=>t.some(ze=>ze.id===Se.envelopeId)).length,totalAllocated:(p[m]||[]).filter(Se=>t.some(ze=>ze.id===Se.envelopeId)).reduce((Se,ze)=>Se+ze.budgetedAmount,0),transactionCount:r.filter(Se=>Se.month===m).length,totalTransactionAmount:r.filter(Se=>Se.month===m).reduce((Se,ze)=>Se+ze.amount,0)}),V&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(ed,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:k,onChange:Se=>z(Se.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{B(!1),z("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:ae,disabled:A||!k.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?"Deleting...":"Delete Account"})]})]})})]})]})},fne=()=>{const n=Qa(),{categories:e,addCategory:t,updateCategory:r,deleteCategory:i,reorderCategories:a}=rn(),{showToast:o}=jc(),[c,u]=U.useState(!1),[d,h]=U.useState(""),[p,m]=U.useState(null),[b,_]=U.useState(""),w=async R=>{if(R.preventDefault(),!!d.trim())try{await t({name:d.trim(),orderIndex:e.length,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),h(""),u(!1),o("Category added","success")}catch(O){console.error(O),o("Failed to add category","error")}},S=async R=>{if(!b.trim())return;const O=e.find(P=>P.id===R);if(O)try{await r({...O,name:b.trim()}),m(null),o("Category updated","success")}catch(P){console.error(P),o("Failed to update category","error")}},T=async R=>{if(confirm("Are you sure? Envelopes in this category will become Uncategorized."))try{await i(R),o("Category deleted","success")}catch(O){console.error(O),o("Failed to delete category","error")}},C=async(R,O)=>{if(O==="up"&&R===0||O==="down"&&R===e.length-1)return;const P=[...e],M=O==="up"?R-1:R+1;[P[R],P[M]]=[P[M],P[R]];const A=P.map(I=>I.id);try{await a(A)}catch(I){console.error(I),o("Failed to reorder","error")}};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(yc,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Manage Categories"})]}),v.jsxs("div",{className:"p-4 max-w-2xl mx-auto space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:c?v.jsxs("form",{onSubmit:w,className:"flex gap-2",children:[v.jsx("input",{type:"text",value:d,onChange:R=>h(R.target.value),placeholder:"Category Name",className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium",children:"Save"}),v.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-gray-500 px-2",children:"Cancel"})]}):v.jsxs("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 font-medium py-2",children:[v.jsx(Tp,{size:20}),"Add Category"]})}),v.jsxs("div",{className:"space-y-2",children:[e.map((R,O)=>v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800 flex items-center justify-between group",children:p===R.id?v.jsxs("div",{className:"flex-1 flex gap-2",children:[v.jsx("input",{type:"text",value:b,onChange:P=>_(P.target.value),className:"flex-1 px-3 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg outline-none dark:text-white",autoFocus:!0}),v.jsx("button",{onClick:()=>S(R.id),className:"bg-green-600 text-white px-3 py-2 rounded-lg text-sm",children:"Save"}),v.jsx("button",{onClick:()=>m(null),className:"text-gray-500 px-2 text-sm",children:"Cancel"})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("div",{className:"flex flex-col gap-1 text-gray-400",children:[v.jsx("button",{onClick:()=>C(O,"up"),disabled:O===0,className:"hover:text-blue-500 disabled:opacity-30 disabled:cursor-not-allowed",children:v.jsx(TU,{size:16})}),v.jsx("button",{onClick:()=>C(O,"down"),disabled:O===e.length-1,className:"hover:text-blue-500 disabled:opacity-30 disabled:cursor-not-allowed",children:v.jsx(yU,{size:16})})]}),v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:R.name})]}),v.jsxs("div",{className:"flex gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[v.jsx("button",{onClick:()=>{m(R.id),_(R.name)},className:"p-2 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400",children:v.jsx(mF,{size:18})}),v.jsx("button",{onClick:()=>T(R.id),className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400",children:v.jsx(j0,{size:18})})]})]})},R.id)),e.length===0&&!c&&v.jsx("div",{className:"text-center text-gray-500 dark:text-zinc-500 py-8",children:"No categories yet. Add one to get started."})]})]})]})},hne=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t,categories:r,fetchCategories:i}=rn(),{showToast:a}=jc(),o=Qa(),[c]=sU();nh.useEffect(()=>{r.length===0&&i()},[r.length,i]);const[u,d]=U.useState(""),[h,p]=U.useState(c.get("type")==="piggybank"),[m,b]=U.useState(c.get("categoryId")||""),[_,w]=U.useState(""),[S,T]=U.useState(""),[C,R]=U.useState("#3B82F6"),[O,P]=U.useState(!1),M=async A=>{if(A.preventDefault(),!u.trim()||O)return;P(!0);const I=rn.getState().envelopes,z=(I.length>0?Math.max(...I.map(X=>X.orderIndex??0)):-1)+1,V=h?new Date(`${t}-01T00:00:00`):new Date,B={name:u,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:V.toISOString(),isActive:!0,orderIndex:z,categoryId:m||void 0};if(h){B.isPiggybank=!0;const X={monthlyContribution:parseFloat(S||"0"),color:C,icon:"piggy-bank"};_&&parseFloat(_)>0&&(X.targetAmount=parseFloat(_)),B.piggybankConfig=X}n(B).then(X=>{if(X){const H=h?parseFloat(S||"0"):0;e(X,H).catch($=>console.error("Failed to create allocation:",$)),setTimeout(()=>{o("/")},50)}}).catch(X=>{console.error("Failed to create envelope:",X),a(X.message||"Failed to create envelope","error"),P(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>o("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(yc,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:h?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:h?v.jsx(Sp,{size:40}):v.jsx(tF,{size:40})})}),v.jsxs("form",{onSubmit:M,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Type"}),v.jsxs("div",{className:"flex bg-gray-100 dark:bg-zinc-800 p-1 rounded-xl",children:[v.jsx("button",{type:"button",onClick:()=>p(!1),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300":"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm"}`,children:"Spending"}),v.jsx("button",{type:"button",onClick:()=>p(!0),className:`flex-1 py-2 px-4 rounded-lg text-sm font-semibold transition-all ${h?"bg-white dark:bg-zinc-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300"}`,children:"Piggybank"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Category"}),v.jsxs("select",{id:"category",value:m,onChange:A=>b(A.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all appearance-none",children:[v.jsx("option",{value:"",children:"Uncategorized"}),r.map(A=>v.jsx("option",{value:A.id,children:A.name},A.id))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:h?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:u,onChange:A=>d(A.target.value),placeholder:h?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),h&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:S,onChange:A=>T(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:h})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:_,onChange:A=>w(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(A=>v.jsx("button",{type:"button",onClick:()=>R(A.value),className:`w-full aspect-square rounded-lg transition-all ${C===A.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:A.value},title:A.label},A.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>o("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!u.trim()||h&&!S||O,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${u.trim()&&(!h||S)&&!O?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:O?"Creating...":h?"Create Piggybank":"Create Envelope"})]})]})]})})]})},pne=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=U.useState([]),[a,o]=U.useState({}),[c,u]=U.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(S=>S!==_):[...w,_])},h=(_,w)=>{o(S=>({...S,[_]:w}))};U.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),U.useEffect(()=>{const _=Object.values(a).reduce((w,S)=>w+(S||0),0);u(e-_),t(a)},[a,e,t]),U.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return v.jsxs("div",{className:"space-y-3",children:[r.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&v.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},B5=({onClose:n,onSaved:e})=>{const t=Qa(),{envelopes:r,addTransaction:i,currentMonth:a}=rn(),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(()=>{const H=new Date;return new Date(H.getTime()-H.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[_,w]=U.useState("expense"),[S,T]=U.useState({}),[C,R]=U.useState(null),[O,P]=U.useState(!1),M=()=>{if(n){n();return}t(-1)},A=H=>{R(H),C&&P(!0)},I=Object.keys(S).length>0,k=Object.values(S).reduce((H,$)=>H+($||0),0),z=Math.abs(k-parseFloat(o||"0"))<.01,V=o&&parseFloat(o)>0&&I&&z,B=async H=>{if(H.preventDefault(),!V)return;const[$,W,ee]=m.split("-").map(Number),he=new Date($,W-1,ee,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",he.toISOString());try{const[K,G]=m.split("-").map(Number),Y=`${K}-${G.toString().padStart(2,"0")}`;if(Y!==a){const Z=`This transaction date (${Y}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(Z))return}const re=Object.entries(S).filter(([Z,le])=>le>0);Promise.all(re.map(([Z,le])=>i({amount:le,description:h,merchant:u||void 0,date:he.toISOString(),envelopeId:Z,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:C||void 0}).catch(fe=>console.error("Failed to create transaction:",fe)))).catch(Z=>console.error("Failed to create transactions:",Z)),e&&e(),n?n():t("/")}catch(K){console.error("Error saving transaction:",K),alert("Failed to save transaction: "+(K instanceof Error?K.message:"Unknown error"))}},j=[...r].filter(H=>H.isActive!==!1).sort((H,$)=>{const W=H.orderIndex??0,ee=$.orderIndex??0;return W!==ee?W-ee:H.name.localeCompare($.name)}),X=_==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:M,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:B,disabled:!V,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:B,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${X}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:o,onChange:H=>{const $=H.target.value.replace(/\D/g,"");if(!$){c("");return}const ee=(parseInt($,10)/100).toFixed(2);c(ee)},onKeyDown:H=>{(H.key==="e"||H.key==="E"||H.key==="+"||H.key==="-")&&H.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${X} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:u,onChange:H=>d(H.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(V5,{selectedCard:C,onCardSelect:A,isUserSelected:O}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:h,onChange:H=>p(H.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[H,$]=m.split("-").map(Number);return`${H}-${$.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(ed,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:m,onChange:H=>b(H.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(pne,{envelopes:j,transactionAmount:parseFloat(o)||0,onSplitChange:T})})]})})]})},gne=()=>{const n=Qa(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o,appSettings:c}=rn(),{showToast:u}=jc(),[d,h]=U.useState(!1),[p,m]=U.useState(""),[b,_]=U.useState("all"),[w,S]=U.useState("All"),[T,C]=U.useState(!1),[R,O]=U.useState("all"),[P,M]=U.useState(!1),[A,I]=U.useState("all"),[k,z]=U.useState(!1),[V,B]=U.useState(()=>{const K=new Date;return K.setMonth(K.getMonth()-1),K.toISOString().split("T")[0]}),[j,X]=U.useState(()=>new Date().toISOString().split("T")[0]),[H,$]=U.useState(null),W=U.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:P,currentMonth:o,transactionMonths:e.map(Y=>({id:Y.id,month:Y.month,date:Y.date,description:Y.description}))});let K=e;return P||(K=e.filter(Y=>Y.month===o||!Y.month),console.log(" After month filter:",{remaining:K.length,currentMonth:o,filteredTransactions:K.map(Y=>({id:Y.id,description:Y.description,month:Y.month,matchesCurrentMonth:Y.month===o}))})),K.map(Y=>{if(!Y)return null;let re=Y.date;if(typeof Y.date=="number"){const le=(Y.date+978307200)*1e3;re=new Date(le).toISOString()}else if(!Y.date||typeof Y.date!="string")return null;return{...Y,date:re}}).filter(Boolean).filter(Y=>{if(Y.description==="Budgeted"||Y.description==="Piggybank Contribution")return!1;if(p){const Z=p.toLowerCase(),le=t.find(ve=>ve.id===Y.envelopeId)?.name.toLowerCase()||"",fe=Y.amount.toFixed(2);if(!(Y.description.toLowerCase().includes(Z)||le.includes(Z)||fe.includes(Z)))return!1}if(b!=="all"&&Y.envelopeId!==b||w!=="All"&&Y.type!==w||A!=="all"&&(!Y.paymentMethod||Y.paymentMethod.id!==A)||!Y.date||typeof Y.date!="string")return!1;const re=Y.date.split("T")[0];return!(k&&(re<V||re>j)||R!=="all"&&new Date(re).getMonth()!==parseInt(R)||T&&!Y.reconciled)}).sort((Y,re)=>new Date(re.date).getTime()-new Date(Y.date).getTime())},[e,t,p,b,w,A,V,j,T,P,o,k]);console.log(" Final filtered transactions:",{count:W.length,transactions:W.map(K=>({id:K.id,description:K.description,amount:K.amount,date:K.date,month:K.month,type:K.type}))});const ee=H?t.find(K=>K.id===H.envelopeId):null,he=K=>{const G={...K,reconciled:!K.reconciled};r(G)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(yc,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(rF,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>M(!P),className:`text-sm px-3 py-1 rounded-md ${P?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:P?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(EF,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:K=>m(K.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(Dv,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:A,onChange:K=>I(K.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(K=>v.jsx("option",{value:K.id,children:K.name},K.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:K=>_(K.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),t.sort((K,G)=>K.name.localeCompare(G.name)).map(K=>v.jsx("option",{value:K.id,children:K.name},K.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(K=>v.jsx("button",{onClick:()=>S(K),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${w===K?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:K},K))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:R,onChange:K=>O(K.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(K,G)=>G).map(K=>v.jsx("option",{value:K,children:new Date(2022,K).toLocaleString("default",{month:"long"})},K))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>z(!k),className:`w-9 h-5 rounded-full transition-colors relative ${k?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${k?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${k?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:V,onChange:K=>B(K.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:j,onChange:K=>X(K.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>C(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>M(!P),className:`w-11 h-6 rounded-full transition-colors relative ${P?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${P?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:W.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(ci,{initial:!1,mode:"popLayout",children:W.map(K=>{const G=t.find(Y=>Y.id===K.envelopeId);return v.jsx(xn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(_y,{disabled:K.isAutomatic,onDelete:()=>{if(!K.id)return;const Y={...K};i(K.id),u("Transaction deleted","neutral",()=>a(Y))},children:v.jsx(L5,{transaction:K,envelopeName:G?.name||"Unknown Envelope",onReconcile:()=>he(K),onEdit:()=>{K.isAutomatic||(G?$(K):alert("Cannot edit: Envelope deleted."))}})})},K.id)})})})}),v.jsx(z5,{isVisible:!!H&&!!ee,onClose:()=>$(null),mode:"edit",currentEnvelope:ee||{},initialTransaction:H})]})},Ro=({children:n})=>v.jsx(xn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),mne=()=>{const n=da();return v.jsx(ci,{mode:"wait",children:v.jsxs(D8,{location:n,children:[v.jsx(bs,{path:"/",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(rne,{})})})}),v.jsx(bs,{path:"/envelope/:id",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(cne,{})})})}),v.jsx(bs,{path:"/add-envelope",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(hne,{})})})}),v.jsx(bs,{path:"/add-transaction",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(B5,{})})})}),v.jsx(bs,{path:"/transactions",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(gne,{})})})}),v.jsx(bs,{path:"/settings",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(dne,{})})})}),v.jsx(bs,{path:"/settings/categories",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(fne,{})})})}),v.jsx(bs,{path:"/verify-email",element:v.jsx(Ro,{children:v.jsx(Xi,{children:v.jsx(qO,{})})})})]},n.pathname)})};function vne(){const[n,e]=U.useState(!0),[t,r]=U.useState(!1),{appSettings:i,isOnboardingActive:a}=rn(),{isAuthenticated:o,isInitialized:c,initializeAuth:u,lastAuthTime:d,offlineGracePeriod:h,currentUser:p}=ta();if(U.useEffect(()=>{const _=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(_)},[]),U.useEffect(()=>u(),[u]),U.useEffect(()=>{(async()=>{const w=new URLSearchParams(window.location.search),S=w.get("mode"),T=w.get("oobCode");if(S==="verifyEmail"&&T){console.log(" Processing email verification from URL");try{await f9(Yi,T),console.log(" Email verification successful");const C=window.location.pathname;window.history.replaceState({},document.title,C),alert("Email verified successfully! You can now sign in.")}catch(C){console.error(" Email verification failed:",C),alert("Email verification failed. The link may be expired or invalid.")}}})()},[]),U.useEffect(()=>{const _=document.documentElement,w=window.matchMedia("(prefers-color-scheme: dark)"),S=()=>{const T=i?.theme??"system",C=w.matches;T==="dark"||T==="system"&&C?_.classList.add("dark"):_.classList.remove("dark")};if(S(),i?.theme==="system")return w.addEventListener("change",S),()=>w.removeEventListener("change",S)},[i]),U.useEffect(()=>{const _=document.documentElement;switch(i?.fontSize??"medium"){case"extra-small":_.style.fontSize="75%";break;case"small":_.style.fontSize="87.5%";break;case"large":_.style.fontSize="112.5%";break;case"extra-large":_.style.fontSize="125%";break;default:_.style.fontSize="100%"}},[i?.fontSize]),n||!c)return v.jsx($O,{message:"Initializing Personal Budget..."});if(!o)return p?v.jsx(Xi,{children:v.jsx(qO,{})}):v.jsx(Xi,{children:v.jsx(j$,{})});const b=typeof navigator<"u"&&!navigator.onLine&&o&&d&&Date.now()-d<h;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Xi,{children:[b&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((h-(Date.now()-d))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(tU,{children:[v.jsx(mne,{}),t&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(B5,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!a&&v.jsx(_W,{onAddTransaction:()=>r(!0)})]}),v.jsx(xW,{})]})]})}Dz({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});Cz.createRoot(document.getElementById("root")).render(v.jsx(U.StrictMode,{children:v.jsx(vne,{})}));export{pt as T,tt as a,k$ as b,LR as c,St as d,Sr as e,Zi as f,Fx as g,Ji as h,Vd as o,oa as q,ai as s,Yl as t,Ma as u,C$ as w};
