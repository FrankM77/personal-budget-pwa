(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function hz(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hx={exports:{}},Yf={};var c2;function pz(){if(c2)return Yf;c2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Yf.Fragment=e,Yf.jsx=t,Yf.jsxs=t,Yf}var u2;function gz(){return u2||(u2=1,hx.exports=pz()),hx.exports}var v=gz(),px={exports:{}},dt={};var d2;function mz(){if(d2)return dt;d2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(G,$,re){this.props=G,this.context=$,this.refs=S,this.updater=re||_}T.prototype.isReactComponent={},T.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function A(){}A.prototype=T.prototype;function D(G,$,re){this.props=G,this.context=$,this.refs=S,this.updater=re||_}var P=D.prototype=new A;P.constructor=D,w(P,T.prototype),P.isPureReactComponent=!0;var M=Array.isArray;function V(){}var C={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(G,$,re){var W=re.ref;return{$$typeof:n,type:G,key:$,ref:W!==void 0?W:null,props:re}}function z(G,$){return k(G.type,$,G.props)}function L(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function B(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(re){return $[re]})}var O=/\/+/g;function J(G,$){return typeof G=="object"&&G!==null&&G.key!=null?B(""+G.key):$.toString(36)}function K(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(V,V):(G.status="pending",G.then(function($){G.status==="pending"&&(G.status="fulfilled",G.value=$)},function($){G.status==="pending"&&(G.status="rejected",G.reason=$)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function H(G,$,re,W,oe){var he=typeof G;(he==="undefined"||he==="boolean")&&(G=null);var ye=!1;if(G===null)ye=!0;else switch(he){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(G.$$typeof){case n:case e:ye=!0;break;case h:return ye=G._init,H(ye(G._payload),$,re,W,oe)}}if(ye)return oe=oe(G),ye=W===""?"."+J(G,0):W,M(oe)?(re="",ye!=null&&(re=ye.replace(O,"$&/")+"/"),H(oe,$,re,"",function(We){return We})):oe!=null&&(L(oe)&&(oe=z(oe,re+(oe.key==null||G&&G.key===oe.key?"":(""+oe.key).replace(O,"$&/")+"/")+ye)),$.push(oe)),1;ye=0;var Te=W===""?".":W+":";if(M(G))for(var Me=0;Me<G.length;Me++)W=G[Me],he=Te+J(W,Me),ye+=H(W,$,re,he,oe);else if(Me=b(G),typeof Me=="function")for(G=Me.call(G),Me=0;!(W=G.next()).done;)W=W.value,he=Te+J(W,Me++),ye+=H(W,$,re,he,oe);else if(he==="object"){if(typeof G.then=="function")return H(K(G),$,re,W,oe);throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return ye}function Z(G,$,re){if(G==null)return G;var W=[],oe=0;return H(G,W,"","",function(he){return $.call(re,he,oe++)}),W}function ne(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(re){(G._status===0||G._status===-1)&&(G._status=1,G._result=re)},function(re){(G._status===0||G._status===-1)&&(G._status=2,G._result=re)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var ue=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},Y={map:Z,forEach:function(G,$,re){Z(G,function(){$.apply(this,arguments)},re)},count:function(G){var $=0;return Z(G,function(){$++}),$},toArray:function(G){return Z(G,function($){return $})||[]},only:function(G){if(!L(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return dt.Activity=p,dt.Children=Y,dt.Component=T,dt.Fragment=t,dt.Profiler=i,dt.PureComponent=D,dt.StrictMode=r,dt.Suspense=u,dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,dt.__COMPILER_RUNTIME={__proto__:null,c:function(G){return C.H.useMemoCache(G)}},dt.cache=function(G){return function(){return G.apply(null,arguments)}},dt.cacheSignal=function(){return null},dt.cloneElement=function(G,$,re){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var W=w({},G.props),oe=G.key;if($!=null)for(he in $.key!==void 0&&(oe=""+$.key),$)!I.call($,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&$.ref===void 0||(W[he]=$[he]);var he=arguments.length-2;if(he===1)W.children=re;else if(1<he){for(var ye=Array(he),Te=0;Te<he;Te++)ye[Te]=arguments[Te+2];W.children=ye}return k(G.type,oe,W)},dt.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},dt.createElement=function(G,$,re){var W,oe={},he=null;if($!=null)for(W in $.key!==void 0&&(he=""+$.key),$)I.call($,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(oe[W]=$[W]);var ye=arguments.length-2;if(ye===1)oe.children=re;else if(1<ye){for(var Te=Array(ye),Me=0;Me<ye;Me++)Te[Me]=arguments[Me+2];oe.children=Te}if(G&&G.defaultProps)for(W in ye=G.defaultProps,ye)oe[W]===void 0&&(oe[W]=ye[W]);return k(G,he,oe)},dt.createRef=function(){return{current:null}},dt.forwardRef=function(G){return{$$typeof:c,render:G}},dt.isValidElement=L,dt.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:ne}},dt.memo=function(G,$){return{$$typeof:d,type:G,compare:$===void 0?null:$}},dt.startTransition=function(G){var $=C.T,re={};C.T=re;try{var W=G(),oe=C.S;oe!==null&&oe(re,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(V,ue)}catch(he){ue(he)}finally{$!==null&&re.types!==null&&($.types=re.types),C.T=$}},dt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},dt.use=function(G){return C.H.use(G)},dt.useActionState=function(G,$,re){return C.H.useActionState(G,$,re)},dt.useCallback=function(G,$){return C.H.useCallback(G,$)},dt.useContext=function(G){return C.H.useContext(G)},dt.useDebugValue=function(){},dt.useDeferredValue=function(G,$){return C.H.useDeferredValue(G,$)},dt.useEffect=function(G,$){return C.H.useEffect(G,$)},dt.useEffectEvent=function(G){return C.H.useEffectEvent(G)},dt.useId=function(){return C.H.useId()},dt.useImperativeHandle=function(G,$,re){return C.H.useImperativeHandle(G,$,re)},dt.useInsertionEffect=function(G,$){return C.H.useInsertionEffect(G,$)},dt.useLayoutEffect=function(G,$){return C.H.useLayoutEffect(G,$)},dt.useMemo=function(G,$){return C.H.useMemo(G,$)},dt.useOptimistic=function(G,$){return C.H.useOptimistic(G,$)},dt.useReducer=function(G,$,re){return C.H.useReducer(G,$,re)},dt.useRef=function(G){return C.H.useRef(G)},dt.useState=function(G){return C.H.useState(G)},dt.useSyncExternalStore=function(G,$,re){return C.H.useSyncExternalStore(G,$,re)},dt.useTransition=function(){return C.H.useTransition()},dt.version="19.2.0",dt}var f2;function ow(){return f2||(f2=1,px.exports=mz()),px.exports}var U=ow();const Em=hz(U);var gx={exports:{}},Kf={},mx={exports:{}},vx={};var h2;function vz(){return h2||(h2=1,(function(n){function e(H,Z){var ne=H.length;H.push(Z);e:for(;0<ne;){var ue=ne-1>>>1,Y=H[ue];if(0<i(Y,Z))H[ue]=Z,H[ne]=Y,ne=ue;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Z=H[0],ne=H.pop();if(ne!==Z){H[0]=ne;e:for(var ue=0,Y=H.length,G=Y>>>1;ue<G;){var $=2*(ue+1)-1,re=H[$],W=$+1,oe=H[W];if(0>i(re,ne))W<Y&&0>i(oe,re)?(H[ue]=oe,H[W]=ne,ue=W):(H[ue]=re,H[$]=ne,ue=$);else if(W<Y&&0>i(oe,ne))H[ue]=oe,H[W]=ne,ue=W;else break e}}return Z}function i(H,Z){var ne=H.sortIndex-Z.sortIndex;return ne!==0?ne:H.id-Z.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function P(H){for(var Z=t(d);Z!==null;){if(Z.callback===null)r(d);else if(Z.startTime<=H)r(d),Z.sortIndex=Z.expirationTime,e(u,Z);else break;Z=t(d)}}function M(H){if(w=!1,P(H),!_)if(t(u)!==null)_=!0,V||(V=!0,B());else{var Z=t(d);Z!==null&&K(M,Z.startTime-H)}}var V=!1,C=-1,I=5,k=-1;function z(){return S?!0:!(n.unstable_now()-k<I)}function L(){if(S=!1,V){var H=n.unstable_now();k=H;var Z=!0;try{e:{_=!1,w&&(w=!1,A(C),C=-1),b=!0;var ne=m;try{t:{for(P(H),p=t(u);p!==null&&!(p.expirationTime>H&&z());){var ue=p.callback;if(typeof ue=="function"){p.callback=null,m=p.priorityLevel;var Y=ue(p.expirationTime<=H);if(H=n.unstable_now(),typeof Y=="function"){p.callback=Y,P(H),Z=!0;break t}p===t(u)&&r(u),P(H)}else r(u);p=t(u)}if(p!==null)Z=!0;else{var G=t(d);G!==null&&K(M,G.startTime-H),Z=!1}}break e}finally{p=null,m=ne,b=!1}Z=void 0}}finally{Z?B():V=!1}}}var B;if(typeof D=="function")B=function(){D(L)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,J=O.port2;O.port1.onmessage=L,B=function(){J.postMessage(null)}}else B=function(){T(L,0)};function K(H,Z){C=T(function(){H(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(H){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var ne=m;m=Z;try{return H()}finally{m=ne}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(H,Z){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ne=m;m=H;try{return Z()}finally{m=ne}},n.unstable_scheduleCallback=function(H,Z,ne){var ue=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ue+ne:ue):ne=ue,H){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ne+Y,H={id:h++,callback:Z,priorityLevel:H,startTime:ne,expirationTime:Y,sortIndex:-1},ne>ue?(H.sortIndex=ne,e(d,H),t(u)===null&&H===t(d)&&(w?(A(C),C=-1):w=!0,K(M,ne-ue))):(H.sortIndex=Y,e(u,H),_||b||(_=!0,V||(V=!0,B()))),H},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(H){var Z=m;return function(){var ne=m;m=Z;try{return H.apply(this,arguments)}finally{m=ne}}}})(vx)),vx}var p2;function yz(){return p2||(p2=1,mx.exports=vz()),mx.exports}var yx={exports:{}},Ar={};var g2;function bz(){if(g2)return Ar;g2=1;var n=ow();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ar.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},Ar.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},Ar.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Ar.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Ar.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ar.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Ar.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ar.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Ar.requestFormReset=function(u){r.d.r(u)},Ar.unstable_batchedUpdates=function(u,d){return u(d)},Ar.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},Ar.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ar.version="19.2.0",Ar}var m2;function xz(){if(m2)return yx.exports;m2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),yx.exports=bz(),yx.exports}var v2;function _z(){if(v2)return Kf;v2=1;var n=yz(),e=ow(),t=xz();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var E=x.alternate;if(E===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===f)return u(x),s;if(E===g)return u(x),l;E=E.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=E;else{for(var N=!1,F=x.child;F;){if(F===f){N=!0,f=x,g=E;break}if(F===g){N=!0,g=x,f=E;break}F=F.sibling}if(!N){for(F=E.child;F;){if(F===f){N=!0,f=E,g=x;break}if(F===g){N=!0,g=E,f=x;break}F=F.sibling}if(!N)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),D=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var O=Symbol.for("react.client.reference");function J(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===O?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case M:return"Suspense";case V:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case D:return s.displayName||"Context";case A:return(s._context.displayName||"Context")+".Consumer";case P:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return l=s.displayName||null,l!==null?l:J(s.type)||"Memo";case I:l=s._payload,s=s._init;try{return J(s(l))}catch{}}return null}var K=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},ue=[],Y=-1;function G(s){return{current:s}}function $(s){0>Y||(s.current=ue[Y],ue[Y]=null,Y--)}function re(s,l){Y++,ue[Y]=s.current,s.current=l}var W=G(null),oe=G(null),he=G(null),ye=G(null);function Te(s,l){switch(re(he,l),re(oe,s),re(W,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?NC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=NC(l),s=MC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}$(W),re(W,s)}function Me(){$(W),$(oe),$(he)}function We(s){s.memoizedState!==null&&re(ye,s);var l=W.current,f=MC(l,s.type);l!==f&&(re(oe,s),re(W,f))}function de(s){oe.current===s&&($(W),$(oe)),ye.current===s&&($(ye),Gf._currentValue=ne)}var Se,Be;function Pe(s){if(Se===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Se=l&&l[1]||"",Be=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Se+s+Be}var Ge=!1;function Ue(s,l){if(!s||Ge)return"";Ge=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(ge){var fe=ge}Reflect.construct(s,[],xe)}else{try{xe.call()}catch(ge){fe=ge}s.call(xe.prototype)}}else{try{throw Error()}catch(ge){fe=ge}(xe=s())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(ge){if(ge&&fe&&typeof ge.stack=="string")return[ge.stack,fe.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=g.DetermineComponentFrameRoot(),N=E[0],F=E[1];if(N&&F){var X=N.split(`
`),ce=F.split(`
`);for(x=g=0;g<X.length&&!X[g].includes("DetermineComponentFrameRoot");)g++;for(;x<ce.length&&!ce[x].includes("DetermineComponentFrameRoot");)x++;if(g===X.length||x===ce.length)for(g=X.length-1,x=ce.length-1;1<=g&&0<=x&&X[g]!==ce[x];)x--;for(;1<=g&&0<=x;g--,x--)if(X[g]!==ce[x]){if(g!==1||x!==1)do if(g--,x--,0>x||X[g]!==ce[x]){var ve=`
`+X[g].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=g&&0<=x);break}}}finally{Ge=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Pe(f):""}function we(s,l){switch(s.tag){case 26:case 27:case 5:return Pe(s.type);case 16:return Pe("Lazy");case 13:return s.child!==l&&l!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return Ue(s.type,!1);case 11:return Ue(s.type.render,!1);case 1:return Ue(s.type,!0);case 31:return Pe("Activity");default:return""}}function Oe(s){try{var l="",f=null;do l+=we(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var ke=Object.prototype.hasOwnProperty,Ve=n.unstable_scheduleCallback,et=n.unstable_cancelCallback,Tt=n.unstable_shouldYield,Qe=n.unstable_requestPaint,ct=n.unstable_now,Mt=n.unstable_getCurrentPriorityLevel,an=n.unstable_ImmediatePriority,zt=n.unstable_UserBlockingPriority,yn=n.unstable_NormalPriority,Tr=n.unstable_LowPriority,_i=n.unstable_IdlePriority,Xi=n.log,_a=n.unstable_setDisableYieldValue,Or=null,Tn=null;function ur(s){if(typeof Xi=="function"&&_a(s),Tn&&typeof Tn.setStrictMode=="function")try{Tn.setStrictMode(Or,s)}catch{}}var Ne=Math.clz32?Math.clz32:ut,wt=Math.log,An=Math.LN2;function ut(s){return s>>>=0,s===0?32:31-(wt(s)/An|0)|0}var tt=256,Pt=262144,Dt=4194304;function Gt(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function _t(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,E=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var F=g&134217727;return F!==0?(g=F&~E,g!==0?x=Gt(g):(N&=F,N!==0?x=Gt(N):f||(f=F&~s,f!==0&&(x=Gt(f))))):(F=g&~E,F!==0?x=Gt(F):N!==0?x=Gt(N):f||(f=g&~s,f!==0&&(x=Gt(f)))),x===0?0:l!==0&&l!==x&&(l&E)===0&&(E=x&-x,f=l&-l,E>=f||E===32&&(f&4194048)!==0)?l:x}function ft(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function bn(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xt(){var s=Dt;return Dt<<=1,(Dt&62914560)===0&&(Dt=4194304),s}function Wt(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function bt(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function xn(s,l,f,g,x,E){var N=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var F=s.entanglements,X=s.expirationTimes,ce=s.hiddenUpdates;for(f=N&~f;0<f;){var ve=31-Ne(f),xe=1<<ve;F[ve]=0,X[ve]=-1;var fe=ce[ve];if(fe!==null)for(ce[ve]=null,ve=0;ve<fe.length;ve++){var ge=fe[ve];ge!==null&&(ge.lane&=-536870913)}f&=~xe}g!==0&&Mn(s,g,0),E!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=E&~(N&~l))}function Mn(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-Ne(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function Wi(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-Ne(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function jr(s,l){var f=l&-l;return f=(f&42)!==0?1:Vr(f),(f&(s.suspendedLanes|l))!==0?0:f}function Vr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function tr(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function tg(){var s=Z.p;return s!==0?s:(s=window.event,s===void 0?32:n2(s.type))}function Qi(s,l){var f=Z.p;try{return Z.p=s,l()}finally{Z.p=f}}var Zi=Math.random().toString(36).slice(2),Bn="__reactFiber$"+Zi,dr="__reactProps$"+Zi,wa="__reactContainer$"+Zi,Fc="__reactEvents$"+Zi,by="__reactListeners$"+Zi,ng="__reactHandles$"+Zi,rg="__reactResources$"+Zi,Ea="__reactMarker$"+Zi;function Gc(s){delete s[Bn],delete s[dr],delete s[Fc],delete s[by],delete s[ng]}function Sa(s){var l=s[Bn];if(l)return l;for(var f=s.parentNode;f;){if(l=f[wa]||f[Bn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=BC(s);s!==null;){if(f=s[Bn])return f;s=BC(s)}return l}s=f,f=s.parentNode}return null}function wi(s){if(s=s[Bn]||s[wa]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function li(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function Ta(s){var l=s[rg];return l||(l=s[rg]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Un(s){s[Ea]=!0}var Xd=new Set,Wd={};function Aa(s,l){Ca(s,l),Ca(s+"Capture",l)}function Ca(s,l){for(Wd[s]=l,s=0;s<l.length;s++)Xd.add(l[s])}var Qd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zd={},Jd={};function ig(s){return ke.call(Jd,s)?!0:ke.call(Zd,s)?!1:Qd.test(s)?Jd[s]=!0:(Zd[s]=!0,!1)}function qc(s,l,f){if(ig(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function ci(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function Fn(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function fr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Js(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function ef(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,E=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(N){f=""+N,E.call(this,N)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(N){f=""+N},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function qt(s){if(!s._valueTracker){var l=Js(s)?"checked":"value";s._valueTracker=ef(s,l,""+s[l])}}function bl(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=Js(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function Ia(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var xl=/[\n"\\]/g;function Yr(s){return s.replace(xl,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Hc(s,l,f,g,x,E,N,F){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),l!=null?N==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+fr(l)):s.value!==""+fr(l)&&(s.value=""+fr(l)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),l!=null?tf(s,N,fr(l)):f!=null?tf(s,N,fr(f)):g!=null&&s.removeAttribute("value"),x==null&&E!=null&&(s.defaultChecked=!!E),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+fr(F):s.removeAttribute("name")}function ag(s,l,f,g,x,E,N,F){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){qt(s);return}f=f!=null?""+fr(f):"",l=l!=null?""+fr(l):f,F||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=F?s.checked:!!g,s.defaultChecked=!!g,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),qt(s)}function tf(s,l,f){l==="number"&&Ia(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function eo(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+fr(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function sg(s,l,f){if(l!=null&&(l=""+fr(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+fr(f):""}function to(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(K(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=fr(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),qt(s)}function Kr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var og=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||og.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function rf(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&nf(s,x,g)}else for(var E in l)l.hasOwnProperty(E)&&nf(s,E,l[E])}function $c(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),no=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yc(s){return no.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Ji(){}var af=null;function Ei(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ro=null,Ra=null;function _l(s){var l=wi(s);if(l&&(s=l.stateNode)){var f=s[dr]||null;e:switch(s=l.stateNode,l.type){case"input":if(Hc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Yr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[dr]||null;if(!x)throw Error(r(90));Hc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&bl(g)}break e;case"textarea":sg(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&eo(s,!!f.multiple,l,!1)}}}var Kc=!1;function io(s,l,f){if(Kc)return s(l,f);Kc=!0;try{var g=s(l);return g}finally{if(Kc=!1,(ro!==null||Ra!==null)&&(tm(),ro&&(l=ro,s=Ra,Ra=ro=null,_l(l),s)))for(l=0;l<s.length;l++)_l(s[l])}}function ea(s,l){var f=s.stateNode;if(f===null)return null;var g=f[dr]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var Si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wl=!1;if(Si)try{var Qt={};Object.defineProperty(Qt,"passive",{get:function(){wl=!0}}),window.addEventListener("test",Qt,Qt),window.removeEventListener("test",Qt,Qt)}catch{wl=!1}var Da=null,sf=null,El=null;function of(){if(El)return El;var s,l=sf,f=l.length,g,x="value"in Da?Da.value:Da.textContent,E=x.length;for(s=0;s<f&&l[s]===x[s];s++);var N=f-s;for(g=1;g<=N&&l[f-g]===x[E-g];g++);return El=x.slice(s,1<g?1-g:void 0)}function Sl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function ls(){return!0}function ta(){return!1}function gr(s){function l(f,g,x,E,N){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=E,this.target=N,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(f=s[F],this[F]=f?f(E):E[F]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?ls:ta,this.isPropagationStopped=ta,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ls)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ls)},persist:function(){},isPersistent:ls}),l}var cs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=gr(cs),ao=p({},cs,{view:0,detail:0}),lf=gr(ao),so,Xc,Na,Wc=p({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Na&&(Na&&s.type==="mousemove"?(so=s.screenX-Na.screenX,Xc=s.screenY-Na.screenY):Xc=so=0,Na=s),so)},movementY:function(s){return"movementY"in s?s.movementY:Xc}}),cf=gr(Wc),Tl=p({},Wc,{dataTransfer:0}),cg=gr(Tl),ug=p({},ao,{relatedTarget:0}),Al=gr(ug),uf=p({},cs,{animationName:0,elapsedTime:0,pseudoElement:0}),dg=gr(uf),Qc=p({},cs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),fg=gr(Qc),hg=p({},cs,{data:0}),Ma=gr(hg),pg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=mg[s])?!!l[s]:!1}function oo(){return vg}var zr=p({},ao,{key:function(s){if(s.key){var l=pg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Sl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?gg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oo,charCode:function(s){return s.type==="keypress"?Sl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Sl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),yg=gr(zr),bg=p({},Wc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),us=gr(bg),y=p({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oo}),R=gr(y),j=p({},cs,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=gr(j),se=p({},Wc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=gr(se),Re=p({},cs,{newState:0,oldState:0}),ht=gr(Re),Pn=[9,13,27,32],Lt=Si&&"CompositionEvent"in window,fn=null;Si&&"documentMode"in document&&(fn=document.documentMode);var Ti=Si&&"TextEvent"in window&&!fn,Pa=Si&&(!Lt||fn&&8<fn&&11>=fn),na=" ",ra=!1;function Cl(s,l){switch(s){case"keyup":return Pn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Jc=!1;function V5(s,l){switch(s){case"compositionend":return Zc(l);case"keypress":return l.which!==32?null:(ra=!0,na);case"textInput":return s=l.data,s===na&&ra?null:s;default:return null}}function z5(s,l){if(Jc)return s==="compositionend"||!Lt&&Cl(s,l)?(s=of(),El=sf=Da=null,Jc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Pa&&l.locale!=="ko"?null:l.data;default:return null}}var L5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function GS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!L5[s.type]:l==="textarea"}function qS(s,l,f,g){ro?Ra?Ra.push(g):Ra=[g]:ro=g,l=lm(l,"onChange"),0<l.length&&(f=new ka("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var df=null,ff=null;function B5(s){AC(s,0)}function xg(s){var l=li(s);if(bl(l))return s}function HS(s,l){if(s==="change")return l}var $S=!1;if(Si){var xy;if(Si){var _y="oninput"in document;if(!_y){var YS=document.createElement("div");YS.setAttribute("oninput","return;"),_y=typeof YS.oninput=="function"}xy=_y}else xy=!1;$S=xy&&(!document.documentMode||9<document.documentMode)}function KS(){df&&(df.detachEvent("onpropertychange",XS),ff=df=null)}function XS(s){if(s.propertyName==="value"&&xg(ff)){var l=[];qS(l,ff,s,Ei(s)),io(B5,l)}}function U5(s,l,f){s==="focusin"?(KS(),df=l,ff=f,df.attachEvent("onpropertychange",XS)):s==="focusout"&&KS()}function F5(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return xg(ff)}function G5(s,l){if(s==="click")return xg(l)}function q5(s,l){if(s==="input"||s==="change")return xg(l)}function H5(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ui=typeof Object.is=="function"?Object.is:H5;function hf(s,l){if(ui(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!ke.call(l,x)||!ui(s[x],l[x]))return!1}return!0}function WS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function QS(s,l){var f=WS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=WS(f)}}function ZS(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?ZS(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function JS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ia(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=Ia(s.document)}return l}function wy(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var $5=Si&&"documentMode"in document&&11>=document.documentMode,eu=null,Ey=null,pf=null,Sy=!1;function eT(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Sy||eu==null||eu!==Ia(g)||(g=eu,"selectionStart"in g&&wy(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),pf&&hf(pf,g)||(pf=g,g=lm(Ey,"onSelect"),0<g.length&&(l=new ka("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=eu)))}function Il(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var tu={animationend:Il("Animation","AnimationEnd"),animationiteration:Il("Animation","AnimationIteration"),animationstart:Il("Animation","AnimationStart"),transitionrun:Il("Transition","TransitionRun"),transitionstart:Il("Transition","TransitionStart"),transitioncancel:Il("Transition","TransitionCancel"),transitionend:Il("Transition","TransitionEnd")},Ty={},tT={};Si&&(tT=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function Rl(s){if(Ty[s])return Ty[s];if(!tu[s])return s;var l=tu[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in tT)return Ty[s]=l[f];return s}var nT=Rl("animationend"),rT=Rl("animationiteration"),iT=Rl("animationstart"),Y5=Rl("transitionrun"),K5=Rl("transitionstart"),X5=Rl("transitioncancel"),aT=Rl("transitionend"),sT=new Map,Ay="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ay.push("scrollEnd");function ia(s,l){sT.set(s,l),Aa(l,[s])}var _g=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ai=[],nu=0,Cy=0;function wg(){for(var s=nu,l=Cy=nu=0;l<s;){var f=Ai[l];Ai[l++]=null;var g=Ai[l];Ai[l++]=null;var x=Ai[l];Ai[l++]=null;var E=Ai[l];if(Ai[l++]=null,g!==null&&x!==null){var N=g.pending;N===null?x.next=x:(x.next=N.next,N.next=x),g.pending=x}E!==0&&oT(f,x,E)}}function Eg(s,l,f,g){Ai[nu++]=s,Ai[nu++]=l,Ai[nu++]=f,Ai[nu++]=g,Cy|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function Iy(s,l,f,g){return Eg(s,l,f,g),Sg(s)}function Dl(s,l){return Eg(s,null,null,l),Sg(s)}function oT(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,E=s.return;E!==null;)E.childLanes|=f,g=E.alternate,g!==null&&(g.childLanes|=f),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(x=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,x&&l!==null&&(x=31-Ne(f),s=E.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),E):null}function Sg(s){if(50<jf)throw jf=0,Vb=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var ru={};function W5(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(s,l,f,g){return new W5(s,l,f,g)}function Ry(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ds(s,l){var f=s.alternate;return f===null?(f=di(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function lT(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Tg(s,l,f,g,x,E){var N=0;if(g=s,typeof s=="function")Ry(s)&&(N=1);else if(typeof s=="string")N=tz(s,f,W.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=di(31,f,l,x),s.elementType=k,s.lanes=E,s;case w:return kl(f.children,x,E,l);case S:N=8,x|=24;break;case T:return s=di(12,f,l,x|2),s.elementType=T,s.lanes=E,s;case M:return s=di(13,f,l,x),s.elementType=M,s.lanes=E,s;case V:return s=di(19,f,l,x),s.elementType=V,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:N=10;break e;case A:N=9;break e;case P:N=11;break e;case C:N=14;break e;case I:N=16,g=null;break e}N=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=di(N,f,l,x),l.elementType=s,l.type=g,l.lanes=E,l}function kl(s,l,f,g){return s=di(7,s,g,l),s.lanes=f,s}function Dy(s,l,f){return s=di(6,s,null,l),s.lanes=f,s}function cT(s){var l=di(18,null,null,0);return l.stateNode=s,l}function ky(s,l,f){return l=di(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var uT=new WeakMap;function Ci(s,l){if(typeof s=="object"&&s!==null){var f=uT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:Oe(l)},uT.set(s,l),l)}return{value:s,source:l,stack:Oe(l)}}var iu=[],au=0,Ag=null,gf=0,Ii=[],Ri=0,lo=null,Oa=1,ja="";function fs(s,l){iu[au++]=gf,iu[au++]=Ag,Ag=s,gf=l}function dT(s,l,f){Ii[Ri++]=Oa,Ii[Ri++]=ja,Ii[Ri++]=lo,lo=s;var g=Oa;s=ja;var x=32-Ne(g)-1;g&=~(1<<x),f+=1;var E=32-Ne(l)+x;if(30<E){var N=x-x%5;E=(g&(1<<N)-1).toString(32),g>>=N,x-=N,Oa=1<<32-Ne(l)+x|f<<x|g,ja=E+s}else Oa=1<<E|f<<x|g,ja=s}function Ny(s){s.return!==null&&(fs(s,1),dT(s,1,0))}function My(s){for(;s===Ag;)Ag=iu[--au],iu[au]=null,gf=iu[--au],iu[au]=null;for(;s===lo;)lo=Ii[--Ri],Ii[Ri]=null,ja=Ii[--Ri],Ii[Ri]=null,Oa=Ii[--Ri],Ii[Ri]=null}function fT(s,l){Ii[Ri++]=Oa,Ii[Ri++]=ja,Ii[Ri++]=lo,Oa=l.id,ja=l.overflow,lo=s}var mr=null,ln=null,kt=!1,co=null,Di=!1,Py=Error(r(519));function uo(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mf(Ci(l,s)),Py}function hT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[Bn]=s,l[dr]=g,f){case"dialog":St("cancel",l),St("close",l);break;case"iframe":case"object":case"embed":St("load",l);break;case"video":case"audio":for(f=0;f<zf.length;f++)St(zf[f],l);break;case"source":St("error",l);break;case"img":case"image":case"link":St("error",l),St("load",l);break;case"details":St("toggle",l);break;case"input":St("invalid",l),ag(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":St("invalid",l);break;case"textarea":St("invalid",l),to(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||DC(l.textContent,f)?(g.popover!=null&&(St("beforetoggle",l),St("toggle",l)),g.onScroll!=null&&St("scroll",l),g.onScrollEnd!=null&&St("scrollend",l),g.onClick!=null&&(l.onclick=Ji),l=!0):l=!1,l||uo(s,!0)}function pT(s){for(mr=s.return;mr;)switch(mr.tag){case 5:case 31:case 13:Di=!1;return;case 27:case 3:Di=!0;return;default:mr=mr.return}}function su(s){if(s!==mr)return!1;if(!kt)return pT(s),kt=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Zb(s.type,s.memoizedProps)),f=!f),f&&ln&&uo(s),pT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));ln=LC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));ln=LC(s)}else l===27?(l=ln,To(s.type)?(s=rx,rx=null,ln=s):ln=l):ln=mr?Ni(s.stateNode.nextSibling):null;return!0}function Nl(){ln=mr=null,kt=!1}function Oy(){var s=co;return s!==null&&(Zr===null?Zr=s:Zr.push.apply(Zr,s),co=null),s}function mf(s){co===null?co=[s]:co.push(s)}var jy=G(null),Ml=null,hs=null;function fo(s,l,f){re(jy,l._currentValue),l._currentValue=f}function ps(s){s._currentValue=jy.current,$(jy)}function Vy(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function zy(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var E=x.dependencies;if(E!==null){var N=x.child;E=E.firstContext;e:for(;E!==null;){var F=E;E=x;for(var X=0;X<l.length;X++)if(F.context===l[X]){E.lanes|=f,F=E.alternate,F!==null&&(F.lanes|=f),Vy(E.return,f,s),g||(N=null);break e}E=F.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(r(341));N.lanes|=f,E=N.alternate,E!==null&&(E.lanes|=f),Vy(N,f,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function ou(s,l,f,g){s=null;for(var x=l,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var F=x.type;ui(x.pendingProps.value,N.value)||(s!==null?s.push(F):s=[F])}}else if(x===ye.current){if(N=x.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Gf):s=[Gf])}x=x.return}s!==null&&zy(l,s,f,g),l.flags|=262144}function Cg(s){for(s=s.firstContext;s!==null;){if(!ui(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Pl(s){Ml=s,hs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function vr(s){return gT(Ml,s)}function Ig(s,l){return Ml===null&&Pl(s),gT(s,l)}function gT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},hs===null){if(s===null)throw Error(r(308));hs=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else hs=hs.next=l;return f}var Q5=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},Z5=n.unstable_scheduleCallback,J5=n.unstable_NormalPriority,Gn={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ly(){return{controller:new Q5,data:new Map,refCount:0}}function vf(s){s.refCount--,s.refCount===0&&Z5(J5,function(){s.controller.abort()})}var yf=null,By=0,lu=0,cu=null;function eV(s,l){if(yf===null){var f=yf=[];By=0,lu=Gb(),cu={status:"pending",value:void 0,then:function(g){f.push(g)}}}return By++,l.then(mT,mT),l}function mT(){if(--By===0&&yf!==null){cu!==null&&(cu.status="fulfilled");var s=yf;yf=null,lu=0,cu=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function tV(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var vT=H.S;H.S=function(s,l){eC=ct(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&eV(s,l),vT!==null&&vT(s,l)};var Ol=G(null);function Uy(){var s=Ol.current;return s!==null?s:sn.pooledCache}function Rg(s,l){l===null?re(Ol,Ol.current):re(Ol,l.pool)}function yT(){var s=Uy();return s===null?null:{parent:Gn._currentValue,pool:s}}var uu=Error(r(460)),Fy=Error(r(474)),Dg=Error(r(542)),kg={then:function(){}};function bT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function xT(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Ji,Ji),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,wT(s),s;default:if(typeof l.status=="string")l.then(Ji,Ji);else{if(s=sn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,wT(s),s}throw Vl=l,uu}}function jl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Vl=f,uu):f}}var Vl=null;function _T(){if(Vl===null)throw Error(r(459));var s=Vl;return Vl=null,s}function wT(s){if(s===uu||s===Dg)throw Error(r(483))}var du=null,bf=0;function Ng(s){var l=bf;return bf+=1,du===null&&(du=[]),xT(du,s,l)}function xf(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Mg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function ET(s){function l(ie,te){if(s){var le=ie.deletions;le===null?(ie.deletions=[te],ie.flags|=16):le.push(te)}}function f(ie,te){if(!s)return null;for(;te!==null;)l(ie,te),te=te.sibling;return null}function g(ie){for(var te=new Map;ie!==null;)ie.key!==null?te.set(ie.key,ie):te.set(ie.index,ie),ie=ie.sibling;return te}function x(ie,te){return ie=ds(ie,te),ie.index=0,ie.sibling=null,ie}function E(ie,te,le){return ie.index=le,s?(le=ie.alternate,le!==null?(le=le.index,le<te?(ie.flags|=67108866,te):le):(ie.flags|=67108866,te)):(ie.flags|=1048576,te)}function N(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function F(ie,te,le,be){return te===null||te.tag!==6?(te=Dy(le,ie.mode,be),te.return=ie,te):(te=x(te,le),te.return=ie,te)}function X(ie,te,le,be){var Ye=le.type;return Ye===w?ve(ie,te,le.props.children,be,le.key):te!==null&&(te.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&jl(Ye)===te.type)?(te=x(te,le.props),xf(te,le),te.return=ie,te):(te=Tg(le.type,le.key,le.props,null,ie.mode,be),xf(te,le),te.return=ie,te)}function ce(ie,te,le,be){return te===null||te.tag!==4||te.stateNode.containerInfo!==le.containerInfo||te.stateNode.implementation!==le.implementation?(te=ky(le,ie.mode,be),te.return=ie,te):(te=x(te,le.children||[]),te.return=ie,te)}function ve(ie,te,le,be,Ye){return te===null||te.tag!==7?(te=kl(le,ie.mode,be,Ye),te.return=ie,te):(te=x(te,le),te.return=ie,te)}function xe(ie,te,le){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=Dy(""+te,ie.mode,le),te.return=ie,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case b:return le=Tg(te.type,te.key,te.props,null,ie.mode,le),xf(le,te),le.return=ie,le;case _:return te=ky(te,ie.mode,le),te.return=ie,te;case I:return te=jl(te),xe(ie,te,le)}if(K(te)||B(te))return te=kl(te,ie.mode,le,null),te.return=ie,te;if(typeof te.then=="function")return xe(ie,Ng(te),le);if(te.$$typeof===D)return xe(ie,Ig(ie,te),le);Mg(ie,te)}return null}function fe(ie,te,le,be){var Ye=te!==null?te.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Ye!==null?null:F(ie,te,""+le,be);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case b:return le.key===Ye?X(ie,te,le,be):null;case _:return le.key===Ye?ce(ie,te,le,be):null;case I:return le=jl(le),fe(ie,te,le,be)}if(K(le)||B(le))return Ye!==null?null:ve(ie,te,le,be,null);if(typeof le.then=="function")return fe(ie,te,Ng(le),be);if(le.$$typeof===D)return fe(ie,te,Ig(ie,le),be);Mg(ie,le)}return null}function ge(ie,te,le,be,Ye){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return ie=ie.get(le)||null,F(te,ie,""+be,Ye);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case b:return ie=ie.get(be.key===null?le:be.key)||null,X(te,ie,be,Ye);case _:return ie=ie.get(be.key===null?le:be.key)||null,ce(te,ie,be,Ye);case I:return be=jl(be),ge(ie,te,le,be,Ye)}if(K(be)||B(be))return ie=ie.get(le)||null,ve(te,ie,be,Ye,null);if(typeof be.then=="function")return ge(ie,te,le,Ng(be),Ye);if(be.$$typeof===D)return ge(ie,te,le,Ig(te,be),Ye);Mg(te,be)}return null}function ze(ie,te,le,be){for(var Ye=null,jt=null,Fe=te,mt=te=0,Ct=null;Fe!==null&&mt<le.length;mt++){Fe.index>mt?(Ct=Fe,Fe=null):Ct=Fe.sibling;var Vt=fe(ie,Fe,le[mt],be);if(Vt===null){Fe===null&&(Fe=Ct);break}s&&Fe&&Vt.alternate===null&&l(ie,Fe),te=E(Vt,te,mt),jt===null?Ye=Vt:jt.sibling=Vt,jt=Vt,Fe=Ct}if(mt===le.length)return f(ie,Fe),kt&&fs(ie,mt),Ye;if(Fe===null){for(;mt<le.length;mt++)Fe=xe(ie,le[mt],be),Fe!==null&&(te=E(Fe,te,mt),jt===null?Ye=Fe:jt.sibling=Fe,jt=Fe);return kt&&fs(ie,mt),Ye}for(Fe=g(Fe);mt<le.length;mt++)Ct=ge(Fe,ie,mt,le[mt],be),Ct!==null&&(s&&Ct.alternate!==null&&Fe.delete(Ct.key===null?mt:Ct.key),te=E(Ct,te,mt),jt===null?Ye=Ct:jt.sibling=Ct,jt=Ct);return s&&Fe.forEach(function(Do){return l(ie,Do)}),kt&&fs(ie,mt),Ye}function Ze(ie,te,le,be){if(le==null)throw Error(r(151));for(var Ye=null,jt=null,Fe=te,mt=te=0,Ct=null,Vt=le.next();Fe!==null&&!Vt.done;mt++,Vt=le.next()){Fe.index>mt?(Ct=Fe,Fe=null):Ct=Fe.sibling;var Do=fe(ie,Fe,Vt.value,be);if(Do===null){Fe===null&&(Fe=Ct);break}s&&Fe&&Do.alternate===null&&l(ie,Fe),te=E(Do,te,mt),jt===null?Ye=Do:jt.sibling=Do,jt=Do,Fe=Ct}if(Vt.done)return f(ie,Fe),kt&&fs(ie,mt),Ye;if(Fe===null){for(;!Vt.done;mt++,Vt=le.next())Vt=xe(ie,Vt.value,be),Vt!==null&&(te=E(Vt,te,mt),jt===null?Ye=Vt:jt.sibling=Vt,jt=Vt);return kt&&fs(ie,mt),Ye}for(Fe=g(Fe);!Vt.done;mt++,Vt=le.next())Vt=ge(Fe,ie,mt,Vt.value,be),Vt!==null&&(s&&Vt.alternate!==null&&Fe.delete(Vt.key===null?mt:Vt.key),te=E(Vt,te,mt),jt===null?Ye=Vt:jt.sibling=Vt,jt=Vt);return s&&Fe.forEach(function(fz){return l(ie,fz)}),kt&&fs(ie,mt),Ye}function en(ie,te,le,be){if(typeof le=="object"&&le!==null&&le.type===w&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case b:e:{for(var Ye=le.key;te!==null;){if(te.key===Ye){if(Ye=le.type,Ye===w){if(te.tag===7){f(ie,te.sibling),be=x(te,le.props.children),be.return=ie,ie=be;break e}}else if(te.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&jl(Ye)===te.type){f(ie,te.sibling),be=x(te,le.props),xf(be,le),be.return=ie,ie=be;break e}f(ie,te);break}else l(ie,te);te=te.sibling}le.type===w?(be=kl(le.props.children,ie.mode,be,le.key),be.return=ie,ie=be):(be=Tg(le.type,le.key,le.props,null,ie.mode,be),xf(be,le),be.return=ie,ie=be)}return N(ie);case _:e:{for(Ye=le.key;te!==null;){if(te.key===Ye)if(te.tag===4&&te.stateNode.containerInfo===le.containerInfo&&te.stateNode.implementation===le.implementation){f(ie,te.sibling),be=x(te,le.children||[]),be.return=ie,ie=be;break e}else{f(ie,te);break}else l(ie,te);te=te.sibling}be=ky(le,ie.mode,be),be.return=ie,ie=be}return N(ie);case I:return le=jl(le),en(ie,te,le,be)}if(K(le))return ze(ie,te,le,be);if(B(le)){if(Ye=B(le),typeof Ye!="function")throw Error(r(150));return le=Ye.call(le),Ze(ie,te,le,be)}if(typeof le.then=="function")return en(ie,te,Ng(le),be);if(le.$$typeof===D)return en(ie,te,Ig(ie,le),be);Mg(ie,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,te!==null&&te.tag===6?(f(ie,te.sibling),be=x(te,le),be.return=ie,ie=be):(f(ie,te),be=Dy(le,ie.mode,be),be.return=ie,ie=be),N(ie)):f(ie,te)}return function(ie,te,le,be){try{bf=0;var Ye=en(ie,te,le,be);return du=null,Ye}catch(Fe){if(Fe===uu||Fe===Dg)throw Fe;var jt=di(29,Fe,null,ie.mode);return jt.lanes=be,jt.return=ie,jt}finally{}}}var zl=ET(!0),ST=ET(!1),ho=!1;function Gy(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function po(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function go(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Bt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=Sg(s),oT(s,null,f),l}return Eg(s,g,l,f),Sg(s)}function _f(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Wi(s,f)}}function Hy(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var N={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?x=E=N:E=E.next=N,f=f.next}while(f!==null);E===null?x=E=l:E=E.next=l}else x=E=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var $y=!1;function wf(){if($y){var s=cu;if(s!==null)throw s}}function Ef(s,l,f,g){$y=!1;var x=s.updateQueue;ho=!1;var E=x.firstBaseUpdate,N=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var X=F,ce=X.next;X.next=null,N===null?E=ce:N.next=ce,N=X;var ve=s.alternate;ve!==null&&(ve=ve.updateQueue,F=ve.lastBaseUpdate,F!==N&&(F===null?ve.firstBaseUpdate=ce:F.next=ce,ve.lastBaseUpdate=X))}if(E!==null){var xe=x.baseState;N=0,ve=ce=X=null,F=E;do{var fe=F.lane&-536870913,ge=fe!==F.lane;if(ge?(At&fe)===fe:(g&fe)===fe){fe!==0&&fe===lu&&($y=!0),ve!==null&&(ve=ve.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var ze=s,Ze=F;fe=l;var en=f;switch(Ze.tag){case 1:if(ze=Ze.payload,typeof ze=="function"){xe=ze.call(en,xe,fe);break e}xe=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ze.payload,fe=typeof ze=="function"?ze.call(en,xe,fe):ze,fe==null)break e;xe=p({},xe,fe);break e;case 2:ho=!0}}fe=F.callback,fe!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[fe]:ge.push(fe))}else ge={lane:fe,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ve===null?(ce=ve=ge,X=xe):ve=ve.next=ge,N|=fe;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;ge=F,F=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);ve===null&&(X=xe),x.baseState=X,x.firstBaseUpdate=ce,x.lastBaseUpdate=ve,E===null&&(x.shared.lanes=0),xo|=N,s.lanes=N,s.memoizedState=xe}}function TT(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function AT(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)TT(f[s],l)}var fu=G(null),Pg=G(0);function CT(s,l){s=Es,re(Pg,s),re(fu,l),Es=s|l.baseLanes}function Yy(){re(Pg,Es),re(fu,fu.current)}function Ky(){Es=Pg.current,$(fu),$(Pg)}var fi=G(null),ki=null;function mo(s){var l=s.alternate;re(On,On.current&1),re(fi,s),ki===null&&(l===null||fu.current!==null||l.memoizedState!==null)&&(ki=s)}function Xy(s){re(On,On.current),re(fi,s),ki===null&&(ki=s)}function IT(s){s.tag===22?(re(On,On.current),re(fi,s),ki===null&&(ki=s)):vo()}function vo(){re(On,On.current),re(fi,fi.current)}function hi(s){$(fi),ki===s&&(ki=null),$(On)}var On=G(0);function Og(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||tx(f)||nx(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var gs=0,pt=null,Zt=null,qn=null,jg=!1,hu=!1,Ll=!1,Vg=0,Sf=0,pu=null,nV=0;function Cn(){throw Error(r(321))}function Wy(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!ui(s[f],l[f]))return!1;return!0}function Qy(s,l,f,g,x,E){return gs=E,pt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,H.H=s===null||s.memoizedState===null?dA:fb,Ll=!1,E=f(g,x),Ll=!1,hu&&(E=DT(l,f,g,x)),RT(s),E}function RT(s){H.H=Cf;var l=Zt!==null&&Zt.next!==null;if(gs=0,qn=Zt=pt=null,jg=!1,Sf=0,pu=null,l)throw Error(r(300));s===null||Hn||(s=s.dependencies,s!==null&&Cg(s)&&(Hn=!0))}function DT(s,l,f,g){pt=s;var x=0;do{if(hu&&(pu=null),Sf=0,hu=!1,25<=x)throw Error(r(301));if(x+=1,qn=Zt=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}H.H=fA,E=l(f,g)}while(hu);return E}function rV(){var s=H.H,l=s.useState()[0];return l=typeof l.then=="function"?Tf(l):l,s=s.useState()[0],(Zt!==null?Zt.memoizedState:null)!==s&&(pt.flags|=1024),l}function Zy(){var s=Vg!==0;return Vg=0,s}function Jy(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function eb(s){if(jg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}jg=!1}gs=0,qn=Zt=pt=null,hu=!1,Sf=Vg=0,pu=null}function Lr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?pt.memoizedState=qn=s:qn=qn.next=s,qn}function jn(){if(Zt===null){var s=pt.alternate;s=s!==null?s.memoizedState:null}else s=Zt.next;var l=qn===null?pt.memoizedState:qn.next;if(l!==null)qn=l,Zt=s;else{if(s===null)throw pt.alternate===null?Error(r(467)):Error(r(310));Zt=s,s={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},qn===null?pt.memoizedState=qn=s:qn=qn.next=s}return qn}function zg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tf(s){var l=Sf;return Sf+=1,pu===null&&(pu=[]),s=xT(pu,s,l),l=pt,(qn===null?l.memoizedState:qn.next)===null&&(l=l.alternate,H.H=l===null||l.memoizedState===null?dA:fb),s}function Lg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Tf(s);if(s.$$typeof===D)return vr(s)}throw Error(r(438,String(s)))}function tb(s){var l=null,f=pt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=pt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=zg(),pt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=z;return l.index++,f}function ms(s,l){return typeof l=="function"?l(s):l}function Bg(s){var l=jn();return nb(l,Zt,s)}function nb(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,E=g.pending;if(E!==null){if(x!==null){var N=x.next;x.next=E.next,E.next=N}l.baseQueue=x=E,g.pending=null}if(E=s.baseState,x===null)s.memoizedState=E;else{l=x.next;var F=N=null,X=null,ce=l,ve=!1;do{var xe=ce.lane&-536870913;if(xe!==ce.lane?(At&xe)===xe:(gs&xe)===xe){var fe=ce.revertLane;if(fe===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),xe===lu&&(ve=!0);else if((gs&fe)===fe){ce=ce.next,fe===lu&&(ve=!0);continue}else xe={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},X===null?(F=X=xe,N=E):X=X.next=xe,pt.lanes|=fe,xo|=fe;xe=ce.action,Ll&&f(E,xe),E=ce.hasEagerState?ce.eagerState:f(E,xe)}else fe={lane:xe,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},X===null?(F=X=fe,N=E):X=X.next=fe,pt.lanes|=xe,xo|=xe;ce=ce.next}while(ce!==null&&ce!==l);if(X===null?N=E:X.next=F,!ui(E,s.memoizedState)&&(Hn=!0,ve&&(f=cu,f!==null)))throw f;s.memoizedState=E,s.baseState=N,s.baseQueue=X,g.lastRenderedState=E}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function rb(s){var l=jn(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,E=l.memoizedState;if(x!==null){f.pending=null;var N=x=x.next;do E=s(E,N.action),N=N.next;while(N!==x);ui(E,l.memoizedState)||(Hn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,g]}function kT(s,l,f){var g=pt,x=jn(),E=kt;if(E){if(f===void 0)throw Error(r(407));f=f()}else f=l();var N=!ui((Zt||x).memoizedState,f);if(N&&(x.memoizedState=f,Hn=!0),x=x.queue,sb(PT.bind(null,g,x,s),[s]),x.getSnapshot!==l||N||qn!==null&&qn.memoizedState.tag&1){if(g.flags|=2048,gu(9,{destroy:void 0},MT.bind(null,g,x,f,l),null),sn===null)throw Error(r(349));E||(gs&127)!==0||NT(g,l,f)}return f}function NT(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=pt.updateQueue,l===null?(l=zg(),pt.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function MT(s,l,f,g){l.value=f,l.getSnapshot=g,OT(l)&&jT(s)}function PT(s,l,f){return f(function(){OT(l)&&jT(s)})}function OT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!ui(s,f)}catch{return!0}}function jT(s){var l=Dl(s,2);l!==null&&Jr(l,s,2)}function ib(s){var l=Lr();if(typeof s=="function"){var f=s;if(s=f(),Ll){ur(!0);try{f()}finally{ur(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:s},l}function VT(s,l,f,g){return s.baseState=f,nb(s,Zt,typeof g=="function"?g:ms)}function iV(s,l,f,g,x){if(Gg(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){E.listeners.push(N)}};H.T!==null?f(!0):E.isTransition=!1,g(E),f=l.pending,f===null?(E.next=l.pending=E,zT(l,E)):(E.next=f.next,l.pending=f.next=E)}}function zT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var E=H.T,N={};H.T=N;try{var F=f(x,g),X=H.S;X!==null&&X(N,F),LT(s,l,F)}catch(ce){ab(s,l,ce)}finally{E!==null&&N.types!==null&&(E.types=N.types),H.T=E}}else try{E=f(x,g),LT(s,l,E)}catch(ce){ab(s,l,ce)}}function LT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){BT(s,l,g)},function(g){return ab(s,l,g)}):BT(s,l,f)}function BT(s,l,f){l.status="fulfilled",l.value=f,UT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,zT(s,f)))}function ab(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,UT(l),l=l.next;while(l!==g)}s.action=null}function UT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function FT(s,l){return l}function GT(s,l){if(kt){var f=sn.formState;if(f!==null){e:{var g=pt;if(kt){if(ln){t:{for(var x=ln,E=Di;x.nodeType!==8;){if(!E){x=null;break t}if(x=Ni(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){ln=Ni(x.nextSibling),g=x.data==="F!";break e}}uo(g)}g=!1}g&&(l=f[0])}}return f=Lr(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:FT,lastRenderedState:l},f.queue=g,f=lA.bind(null,pt,g),g.dispatch=f,g=ib(!1),E=db.bind(null,pt,!1,g.queue),g=Lr(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=iV.bind(null,pt,x,E,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function qT(s){var l=jn();return HT(l,Zt,s)}function HT(s,l,f){if(l=nb(s,l,FT)[0],s=Bg(ms)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Tf(l)}catch(N){throw N===uu?Dg:N}else g=l;l=jn();var x=l.queue,E=x.dispatch;return f!==l.memoizedState&&(pt.flags|=2048,gu(9,{destroy:void 0},aV.bind(null,x,f),null)),[g,E,s]}function aV(s,l){s.action=l}function $T(s){var l=jn(),f=Zt;if(f!==null)return HT(l,f,s);jn(),l=l.memoizedState,f=jn();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function gu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=pt.updateQueue,l===null&&(l=zg(),pt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function YT(){return jn().memoizedState}function Ug(s,l,f,g){var x=Lr();pt.flags|=s,x.memoizedState=gu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Fg(s,l,f,g){var x=jn();g=g===void 0?null:g;var E=x.memoizedState.inst;Zt!==null&&g!==null&&Wy(g,Zt.memoizedState.deps)?x.memoizedState=gu(l,E,f,g):(pt.flags|=s,x.memoizedState=gu(1|l,E,f,g))}function KT(s,l){Ug(8390656,8,s,l)}function sb(s,l){Fg(2048,8,s,l)}function sV(s){pt.flags|=4;var l=pt.updateQueue;if(l===null)l=zg(),pt.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function XT(s){var l=jn().memoizedState;return sV({ref:l,nextImpl:s}),function(){if((Bt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function WT(s,l){return Fg(4,2,s,l)}function QT(s,l){return Fg(4,4,s,l)}function ZT(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function JT(s,l,f){f=f!=null?f.concat([s]):null,Fg(4,4,ZT.bind(null,l,s),f)}function ob(){}function eA(s,l){var f=jn();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&Wy(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function tA(s,l){var f=jn();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&Wy(l,g[1]))return g[0];if(g=s(),Ll){ur(!0);try{s()}finally{ur(!1)}}return f.memoizedState=[g,l],g}function lb(s,l,f){return f===void 0||(gs&1073741824)!==0&&(At&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=nC(),pt.lanes|=s,xo|=s,f)}function nA(s,l,f,g){return ui(f,l)?f:fu.current!==null?(s=lb(s,f,g),ui(s,l)||(Hn=!0),s):(gs&42)===0||(gs&1073741824)!==0&&(At&261930)===0?(Hn=!0,s.memoizedState=f):(s=nC(),pt.lanes|=s,xo|=s,l)}function rA(s,l,f,g,x){var E=Z.p;Z.p=E!==0&&8>E?E:8;var N=H.T,F={};H.T=F,db(s,!1,l,f);try{var X=x(),ce=H.S;if(ce!==null&&ce(F,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ve=tV(X,g);Af(s,l,ve,mi(s))}else Af(s,l,g,mi(s))}catch(xe){Af(s,l,{then:function(){},status:"rejected",reason:xe},mi())}finally{Z.p=E,N!==null&&F.types!==null&&(N.types=F.types),H.T=N}}function oV(){}function cb(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=iA(s).queue;rA(s,x,l,ne,f===null?oV:function(){return aA(s),f(g)})}function iA(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:ne},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function aA(s){var l=iA(s);l.next===null&&(l=s.alternate.memoizedState),Af(s,l.next.queue,{},mi())}function ub(){return vr(Gf)}function sA(){return jn().memoizedState}function oA(){return jn().memoizedState}function lV(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=mi();s=po(f);var g=go(l,s,f);g!==null&&(Jr(g,l,f),_f(g,l,f)),l={cache:Ly()},s.payload=l;return}l=l.return}}function cV(s,l,f){var g=mi();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Gg(s)?cA(l,f):(f=Iy(s,l,f,g),f!==null&&(Jr(f,s,g),uA(f,l,g)))}function lA(s,l,f){var g=mi();Af(s,l,f,g)}function Af(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Gg(s))cA(l,x);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var N=l.lastRenderedState,F=E(N,f);if(x.hasEagerState=!0,x.eagerState=F,ui(F,N))return Eg(s,l,x,0),sn===null&&wg(),!1}catch{}finally{}if(f=Iy(s,l,x,g),f!==null)return Jr(f,s,g),uA(f,l,g),!0}return!1}function db(s,l,f,g){if(g={lane:2,revertLane:Gb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Gg(s)){if(l)throw Error(r(479))}else l=Iy(s,f,g,2),l!==null&&Jr(l,s,2)}function Gg(s){var l=s.alternate;return s===pt||l!==null&&l===pt}function cA(s,l){hu=jg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function uA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Wi(s,f)}}var Cf={readContext:vr,use:Lg,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useLayoutEffect:Cn,useInsertionEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useSyncExternalStore:Cn,useId:Cn,useHostTransitionStatus:Cn,useFormState:Cn,useActionState:Cn,useOptimistic:Cn,useMemoCache:Cn,useCacheRefresh:Cn};Cf.useEffectEvent=Cn;var dA={readContext:vr,use:Lg,useCallback:function(s,l){return Lr().memoizedState=[s,l===void 0?null:l],s},useContext:vr,useEffect:KT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Ug(4194308,4,ZT.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Ug(4194308,4,s,l)},useInsertionEffect:function(s,l){Ug(4,2,s,l)},useMemo:function(s,l){var f=Lr();l=l===void 0?null:l;var g=s();if(Ll){ur(!0);try{s()}finally{ur(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Lr();if(f!==void 0){var x=f(l);if(Ll){ur(!0);try{f(l)}finally{ur(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=cV.bind(null,pt,s),[g.memoizedState,s]},useRef:function(s){var l=Lr();return s={current:s},l.memoizedState=s},useState:function(s){s=ib(s);var l=s.queue,f=lA.bind(null,pt,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:ob,useDeferredValue:function(s,l){var f=Lr();return lb(f,s,l)},useTransition:function(){var s=ib(!1);return s=rA.bind(null,pt,s.queue,!0,!1),Lr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=pt,x=Lr();if(kt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),sn===null)throw Error(r(349));(At&127)!==0||NT(g,l,f)}x.memoizedState=f;var E={value:f,getSnapshot:l};return x.queue=E,KT(PT.bind(null,g,E,s),[s]),g.flags|=2048,gu(9,{destroy:void 0},MT.bind(null,g,E,f,l),null),f},useId:function(){var s=Lr(),l=sn.identifierPrefix;if(kt){var f=ja,g=Oa;f=(g&~(1<<32-Ne(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Vg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=nV++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:ub,useFormState:GT,useActionState:GT,useOptimistic:function(s){var l=Lr();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=db.bind(null,pt,!0,f),f.dispatch=l,[s,l]},useMemoCache:tb,useCacheRefresh:function(){return Lr().memoizedState=lV.bind(null,pt)},useEffectEvent:function(s){var l=Lr(),f={impl:s};return l.memoizedState=f,function(){if((Bt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},fb={readContext:vr,use:Lg,useCallback:eA,useContext:vr,useEffect:sb,useImperativeHandle:JT,useInsertionEffect:WT,useLayoutEffect:QT,useMemo:tA,useReducer:Bg,useRef:YT,useState:function(){return Bg(ms)},useDebugValue:ob,useDeferredValue:function(s,l){var f=jn();return nA(f,Zt.memoizedState,s,l)},useTransition:function(){var s=Bg(ms)[0],l=jn().memoizedState;return[typeof s=="boolean"?s:Tf(s),l]},useSyncExternalStore:kT,useId:sA,useHostTransitionStatus:ub,useFormState:qT,useActionState:qT,useOptimistic:function(s,l){var f=jn();return VT(f,Zt,s,l)},useMemoCache:tb,useCacheRefresh:oA};fb.useEffectEvent=XT;var fA={readContext:vr,use:Lg,useCallback:eA,useContext:vr,useEffect:sb,useImperativeHandle:JT,useInsertionEffect:WT,useLayoutEffect:QT,useMemo:tA,useReducer:rb,useRef:YT,useState:function(){return rb(ms)},useDebugValue:ob,useDeferredValue:function(s,l){var f=jn();return Zt===null?lb(f,s,l):nA(f,Zt.memoizedState,s,l)},useTransition:function(){var s=rb(ms)[0],l=jn().memoizedState;return[typeof s=="boolean"?s:Tf(s),l]},useSyncExternalStore:kT,useId:sA,useHostTransitionStatus:ub,useFormState:$T,useActionState:$T,useOptimistic:function(s,l){var f=jn();return Zt!==null?VT(f,Zt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:tb,useCacheRefresh:oA};fA.useEffectEvent=XT;function hb(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var pb={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=mi(),x=po(g);x.payload=l,f!=null&&(x.callback=f),l=go(s,x,g),l!==null&&(Jr(l,s,g),_f(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=mi(),x=po(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=go(s,x,g),l!==null&&(Jr(l,s,g),_f(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=mi(),g=po(f);g.tag=2,l!=null&&(g.callback=l),l=go(s,g,f),l!==null&&(Jr(l,s,f),_f(l,s,f))}};function hA(s,l,f,g,x,E,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,N):l.prototype&&l.prototype.isPureReactComponent?!hf(f,g)||!hf(x,E):!0}function pA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&pb.enqueueReplaceState(l,l.state,null)}function Bl(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function gA(s){_g(s)}function mA(s){console.error(s)}function vA(s){_g(s)}function qg(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function yA(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function gb(s,l,f){return f=po(f),f.tag=3,f.payload={element:null},f.callback=function(){qg(s,l)},f}function bA(s){return s=po(s),s.tag=3,s}function xA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var E=g.value;s.payload=function(){return x(E)},s.callback=function(){yA(l,f,g)}}var N=f.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){yA(l,f,g),typeof x!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var F=g.stack;this.componentDidCatch(g.value,{componentStack:F!==null?F:""})})}function uV(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&ou(l,f,x,!0),f=fi.current,f!==null){switch(f.tag){case 31:case 13:return ki===null?nm():f.alternate===null&&In===0&&(In=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===kg?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),Bb(s,g,x)),!1;case 22:return f.flags|=65536,g===kg?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),Bb(s,g,x)),!1}throw Error(r(435,f.tag))}return Bb(s,g,x),nm(),!1}if(kt)return l=fi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==Py&&(s=Error(r(422),{cause:g}),mf(Ci(s,f)))):(g!==Py&&(l=Error(r(423),{cause:g}),mf(Ci(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=Ci(g,f),x=gb(s.stateNode,g,x),Hy(s,x),In!==4&&(In=2)),!1;var E=Error(r(520),{cause:g});if(E=Ci(E,f),Of===null?Of=[E]:Of.push(E),In!==4&&(In=2),l===null)return!0;g=Ci(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=gb(f.stateNode,g,s),Hy(f,s),!1;case 1:if(l=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(_o===null||!_o.has(E))))return f.flags|=65536,x&=-x,f.lanes|=x,x=bA(x),xA(x,s,f,g),Hy(f,x),!1}f=f.return}while(f!==null);return!1}var mb=Error(r(461)),Hn=!1;function yr(s,l,f,g){l.child=s===null?ST(l,null,f,g):zl(l,s.child,f,g)}function _A(s,l,f,g,x){f=f.render;var E=l.ref;if("ref"in g){var N={};for(var F in g)F!=="ref"&&(N[F]=g[F])}else N=g;return Pl(l),g=Qy(s,l,f,N,E,x),F=Zy(),s!==null&&!Hn?(Jy(s,l,x),vs(s,l,x)):(kt&&F&&Ny(l),l.flags|=1,yr(s,l,g,x),l.child)}function wA(s,l,f,g,x){if(s===null){var E=f.type;return typeof E=="function"&&!Ry(E)&&E.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=E,EA(s,l,E,g,x)):(s=Tg(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!Sb(s,x)){var N=E.memoizedProps;if(f=f.compare,f=f!==null?f:hf,f(N,g)&&s.ref===l.ref)return vs(s,l,x)}return l.flags|=1,s=ds(E,g),s.ref=l.ref,s.return=l,l.child=s}function EA(s,l,f,g,x){if(s!==null){var E=s.memoizedProps;if(hf(E,g)&&s.ref===l.ref)if(Hn=!1,l.pendingProps=g=E,Sb(s,x))(s.flags&131072)!==0&&(Hn=!0);else return l.lanes=s.lanes,vs(s,l,x)}return vb(s,l,f,g,x)}function SA(s,l,f,g){var x=g.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~E}else g=0,l.child=null;return TA(s,l,E,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Rg(l,E!==null?E.cachePool:null),E!==null?CT(l,E):Yy(),IT(l);else return g=l.lanes=536870912,TA(s,l,E!==null?E.baseLanes|f:f,f,g)}else E!==null?(Rg(l,E.cachePool),CT(l,E),vo(),l.memoizedState=null):(s!==null&&Rg(l,null),Yy(),vo());return yr(s,l,x,f),l.child}function If(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function TA(s,l,f,g,x){var E=Uy();return E=E===null?null:{parent:Gn._currentValue,pool:E},l.memoizedState={baseLanes:f,cachePool:E},s!==null&&Rg(l,null),Yy(),IT(l),s!==null&&ou(s,l,g,!0),l.childLanes=x,null}function Hg(s,l){return l=Yg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function AA(s,l,f){return zl(l,s.child,null,f),s=Hg(l,l.pendingProps),s.flags|=2,hi(l),l.memoizedState=null,s}function dV(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(kt){if(g.mode==="hidden")return s=Hg(l,g),l.lanes=536870912,If(null,s);if(Xy(l),(s=ln)?(s=zC(s,Di),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:lo!==null?{id:Oa,overflow:ja}:null,retryLane:536870912,hydrationErrors:null},f=cT(s),f.return=l,l.child=f,mr=l,ln=null)):s=null,s===null)throw uo(l);return l.lanes=536870912,null}return Hg(l,g)}var E=s.memoizedState;if(E!==null){var N=E.dehydrated;if(Xy(l),x)if(l.flags&256)l.flags&=-257,l=AA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Hn||ou(s,l,f,!1),x=(f&s.childLanes)!==0,Hn||x){if(g=sn,g!==null&&(N=jr(g,f),N!==0&&N!==E.retryLane))throw E.retryLane=N,Dl(s,N),Jr(g,s,N),mb;nm(),l=AA(s,l,f)}else s=E.treeContext,ln=Ni(N.nextSibling),mr=l,kt=!0,co=null,Di=!1,s!==null&&fT(l,s),l=Hg(l,g),l.flags|=4096;return l}return s=ds(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function $g(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function vb(s,l,f,g,x){return Pl(l),f=Qy(s,l,f,g,void 0,x),g=Zy(),s!==null&&!Hn?(Jy(s,l,x),vs(s,l,x)):(kt&&g&&Ny(l),l.flags|=1,yr(s,l,f,x),l.child)}function CA(s,l,f,g,x,E){return Pl(l),l.updateQueue=null,f=DT(l,g,f,x),RT(s),g=Zy(),s!==null&&!Hn?(Jy(s,l,E),vs(s,l,E)):(kt&&g&&Ny(l),l.flags|=1,yr(s,l,f,E),l.child)}function IA(s,l,f,g,x){if(Pl(l),l.stateNode===null){var E=ru,N=f.contextType;typeof N=="object"&&N!==null&&(E=vr(N)),E=new f(g,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=pb,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=g,E.state=l.memoizedState,E.refs={},Gy(l),N=f.contextType,E.context=typeof N=="object"&&N!==null?vr(N):ru,E.state=l.memoizedState,N=f.getDerivedStateFromProps,typeof N=="function"&&(hb(l,f,N,g),E.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(N=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),N!==E.state&&pb.enqueueReplaceState(E,E.state,null),Ef(l,g,E,x),wf(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){E=l.stateNode;var F=l.memoizedProps,X=Bl(f,F);E.props=X;var ce=E.context,ve=f.contextType;N=ru,typeof ve=="object"&&ve!==null&&(N=vr(ve));var xe=f.getDerivedStateFromProps;ve=typeof xe=="function"||typeof E.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,ve||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F||ce!==N)&&pA(l,E,g,N),ho=!1;var fe=l.memoizedState;E.state=fe,Ef(l,g,E,x),wf(),ce=l.memoizedState,F||fe!==ce||ho?(typeof xe=="function"&&(hb(l,f,xe,g),ce=l.memoizedState),(X=ho||hA(l,f,X,g,fe,ce,N))?(ve||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ce),E.props=g,E.state=ce,E.context=N,g=X):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{E=l.stateNode,qy(s,l),N=l.memoizedProps,ve=Bl(f,N),E.props=ve,xe=l.pendingProps,fe=E.context,ce=f.contextType,X=ru,typeof ce=="object"&&ce!==null&&(X=vr(ce)),F=f.getDerivedStateFromProps,(ce=typeof F=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(N!==xe||fe!==X)&&pA(l,E,g,X),ho=!1,fe=l.memoizedState,E.state=fe,Ef(l,g,E,x),wf();var ge=l.memoizedState;N!==xe||fe!==ge||ho||s!==null&&s.dependencies!==null&&Cg(s.dependencies)?(typeof F=="function"&&(hb(l,f,F,g),ge=l.memoizedState),(ve=ho||hA(l,f,ve,g,fe,ge,X)||s!==null&&s.dependencies!==null&&Cg(s.dependencies))?(ce||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(g,ge,X),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(g,ge,X)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ge),E.props=g,E.state=ge,E.context=X,g=ve):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(l.flags|=1024),g=!1)}return E=g,$g(s,l),g=(l.flags&128)!==0,E||g?(E=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&g?(l.child=zl(l,s.child,null,x),l.child=zl(l,null,f,x)):yr(s,l,f,x),l.memoizedState=E.state,s=l.child):s=vs(s,l,x),s}function RA(s,l,f,g){return Nl(),l.flags|=256,yr(s,l,f,g),l.child}var yb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bb(s){return{baseLanes:s,cachePool:yT()}}function xb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=gi),s}function DA(s,l,f){var g=l.pendingProps,x=!1,E=(l.flags&128)!==0,N;if((N=E)||(N=s!==null&&s.memoizedState===null?!1:(On.current&2)!==0),N&&(x=!0,l.flags&=-129),N=(l.flags&32)!==0,l.flags&=-33,s===null){if(kt){if(x?mo(l):vo(),(s=ln)?(s=zC(s,Di),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:lo!==null?{id:Oa,overflow:ja}:null,retryLane:536870912,hydrationErrors:null},f=cT(s),f.return=l,l.child=f,mr=l,ln=null)):s=null,s===null)throw uo(l);return nx(s)?l.lanes=32:l.lanes=536870912,null}var F=g.children;return g=g.fallback,x?(vo(),x=l.mode,F=Yg({mode:"hidden",children:F},x),g=kl(g,x,f,null),F.return=l,g.return=l,F.sibling=g,l.child=F,g=l.child,g.memoizedState=bb(f),g.childLanes=xb(s,N,f),l.memoizedState=yb,If(null,g)):(mo(l),_b(l,F))}var X=s.memoizedState;if(X!==null&&(F=X.dehydrated,F!==null)){if(E)l.flags&256?(mo(l),l.flags&=-257,l=wb(s,l,f)):l.memoizedState!==null?(vo(),l.child=s.child,l.flags|=128,l=null):(vo(),F=g.fallback,x=l.mode,g=Yg({mode:"visible",children:g.children},x),F=kl(F,x,f,null),F.flags|=2,g.return=l,F.return=l,g.sibling=F,l.child=g,zl(l,s.child,null,f),g=l.child,g.memoizedState=bb(f),g.childLanes=xb(s,N,f),l.memoizedState=yb,l=If(null,g));else if(mo(l),nx(F)){if(N=F.nextSibling&&F.nextSibling.dataset,N)var ce=N.dgst;N=ce,g=Error(r(419)),g.stack="",g.digest=N,mf({value:g,source:null,stack:null}),l=wb(s,l,f)}else if(Hn||ou(s,l,f,!1),N=(f&s.childLanes)!==0,Hn||N){if(N=sn,N!==null&&(g=jr(N,f),g!==0&&g!==X.retryLane))throw X.retryLane=g,Dl(s,g),Jr(N,s,g),mb;tx(F)||nm(),l=wb(s,l,f)}else tx(F)?(l.flags|=192,l.child=s.child,l=null):(s=X.treeContext,ln=Ni(F.nextSibling),mr=l,kt=!0,co=null,Di=!1,s!==null&&fT(l,s),l=_b(l,g.children),l.flags|=4096);return l}return x?(vo(),F=g.fallback,x=l.mode,X=s.child,ce=X.sibling,g=ds(X,{mode:"hidden",children:g.children}),g.subtreeFlags=X.subtreeFlags&65011712,ce!==null?F=ds(ce,F):(F=kl(F,x,f,null),F.flags|=2),F.return=l,g.return=l,g.sibling=F,l.child=g,If(null,g),g=l.child,F=s.child.memoizedState,F===null?F=bb(f):(x=F.cachePool,x!==null?(X=Gn._currentValue,x=x.parent!==X?{parent:X,pool:X}:x):x=yT(),F={baseLanes:F.baseLanes|f,cachePool:x}),g.memoizedState=F,g.childLanes=xb(s,N,f),l.memoizedState=yb,If(s.child,g)):(mo(l),f=s.child,s=f.sibling,f=ds(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(N=l.deletions,N===null?(l.deletions=[s],l.flags|=16):N.push(s)),l.child=f,l.memoizedState=null,f)}function _b(s,l){return l=Yg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Yg(s,l){return s=di(22,s,null,l),s.lanes=0,s}function wb(s,l,f){return zl(l,s.child,null,f),s=_b(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function kA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Vy(s.return,l,f)}function Eb(s,l,f,g,x,E){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:E}:(N.isBackwards=l,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=f,N.tailMode=x,N.treeForkCount=E)}function NA(s,l,f){var g=l.pendingProps,x=g.revealOrder,E=g.tail;g=g.children;var N=On.current,F=(N&2)!==0;if(F?(N=N&1|2,l.flags|=128):N&=1,re(On,N),yr(s,l,g,f),g=kt?gf:0,!F&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&kA(s,f,l);else if(s.tag===19)kA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Og(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),Eb(l,!1,x,f,E,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Og(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}Eb(l,!0,f,null,E,g);break;case"together":Eb(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function vs(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),xo|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(ou(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=ds(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=ds(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function Sb(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Cg(s)))}function fV(s,l,f){switch(l.tag){case 3:Te(l,l.stateNode.containerInfo),fo(l,Gn,s.memoizedState.cache),Nl();break;case 27:case 5:We(l);break;case 4:Te(l,l.stateNode.containerInfo);break;case 10:fo(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Xy(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(mo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?DA(s,l,f):(mo(l),s=vs(s,l,f),s!==null?s.sibling:null);mo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(ou(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return NA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),re(On,On.current),g)break;return null;case 22:return l.lanes=0,SA(s,l,f,l.pendingProps);case 24:fo(l,Gn,s.memoizedState.cache)}return vs(s,l,f)}function MA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Hn=!0;else{if(!Sb(s,f)&&(l.flags&128)===0)return Hn=!1,fV(s,l,f);Hn=(s.flags&131072)!==0}else Hn=!1,kt&&(l.flags&1048576)!==0&&dT(l,gf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=jl(l.elementType),l.type=s,typeof s=="function")Ry(s)?(g=Bl(s,g),l.tag=1,l=IA(null,l,s,g,f)):(l.tag=0,l=vb(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===P){l.tag=11,l=_A(null,l,s,g,f);break e}else if(x===C){l.tag=14,l=wA(null,l,s,g,f);break e}}throw l=J(s)||s,Error(r(306,l,""))}}return l;case 0:return vb(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Bl(g,l.pendingProps),IA(s,l,g,x,f);case 3:e:{if(Te(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var E=l.memoizedState;x=E.element,qy(s,l),Ef(l,g,null,f);var N=l.memoizedState;if(g=N.cache,fo(l,Gn,g),g!==E.cache&&zy(l,[Gn],f,!0),wf(),g=N.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:N.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=RA(s,l,g,f);break e}else if(g!==x){x=Ci(Error(r(424)),l),mf(x),l=RA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ln=Ni(s.firstChild),mr=l,kt=!0,co=null,Di=!0,f=ST(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Nl(),g===x){l=vs(s,l,f);break e}yr(s,l,g,f)}l=l.child}return l;case 26:return $g(s,l),s===null?(f=qC(l.type,null,l.pendingProps,null))?l.memoizedState=f:kt||(f=l.type,s=l.pendingProps,g=cm(he.current).createElement(f),g[Bn]=l,g[dr]=s,br(g,f,s),Un(g),l.stateNode=g):l.memoizedState=qC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return We(l),s===null&&kt&&(g=l.stateNode=UC(l.type,l.pendingProps,he.current),mr=l,Di=!0,x=ln,To(l.type)?(rx=x,ln=Ni(g.firstChild)):ln=x),yr(s,l,l.pendingProps.children,f),$g(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&kt&&((x=g=ln)&&(g=FV(g,l.type,l.pendingProps,Di),g!==null?(l.stateNode=g,mr=l,ln=Ni(g.firstChild),Di=!1,x=!0):x=!1),x||uo(l)),We(l),x=l.type,E=l.pendingProps,N=s!==null?s.memoizedProps:null,g=E.children,Zb(x,E)?g=null:N!==null&&Zb(x,N)&&(l.flags|=32),l.memoizedState!==null&&(x=Qy(s,l,rV,null,null,f),Gf._currentValue=x),$g(s,l),yr(s,l,g,f),l.child;case 6:return s===null&&kt&&((s=f=ln)&&(f=GV(f,l.pendingProps,Di),f!==null?(l.stateNode=f,mr=l,ln=null,s=!0):s=!1),s||uo(l)),null;case 13:return DA(s,l,f);case 4:return Te(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=zl(l,null,g,f):yr(s,l,g,f),l.child;case 11:return _A(s,l,l.type,l.pendingProps,f);case 7:return yr(s,l,l.pendingProps,f),l.child;case 8:return yr(s,l,l.pendingProps.children,f),l.child;case 12:return yr(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,fo(l,l.type,g.value),yr(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Pl(l),x=vr(x),g=g(x),l.flags|=1,yr(s,l,g,f),l.child;case 14:return wA(s,l,l.type,l.pendingProps,f);case 15:return EA(s,l,l.type,l.pendingProps,f);case 19:return NA(s,l,f);case 31:return dV(s,l,f);case 22:return SA(s,l,f,l.pendingProps);case 24:return Pl(l),g=vr(Gn),s===null?(x=Uy(),x===null&&(x=sn,E=Ly(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=f),x=E),l.memoizedState={parent:g,cache:x},Gy(l),fo(l,Gn,x)):((s.lanes&f)!==0&&(qy(s,l),Ef(l,null,null,f),wf()),x=s.memoizedState,E=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),fo(l,Gn,g)):(g=E.cache,fo(l,Gn,g),g!==x.cache&&zy(l,[Gn],f,!0))),yr(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function ys(s){s.flags|=4}function Tb(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(sC())s.flags|=8192;else throw Vl=kg,Fy}else s.flags&=-16777217}function PA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!XC(l))if(sC())s.flags|=8192;else throw Vl=kg,Fy}function Kg(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Xt():536870912,s.lanes|=l,bu|=l)}function Rf(s,l){if(!kt)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function cn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function hV(s,l,f){var g=l.pendingProps;switch(My(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(l),null;case 1:return cn(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),ps(Gn),Me(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(su(l)?ys(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Oy())),cn(l),null;case 26:var x=l.type,E=l.memoizedState;return s===null?(ys(l),E!==null?(cn(l),PA(l,E)):(cn(l),Tb(l,x,null,g,f))):E?E!==s.memoizedState?(ys(l),cn(l),PA(l,E)):(cn(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&ys(l),cn(l),Tb(l,x,s,g,f)),null;case 27:if(de(l),f=he.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&ys(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return cn(l),null}s=W.current,su(l)?hT(l):(s=UC(x,g,f),l.stateNode=s,ys(l))}return cn(l),null;case 5:if(de(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&ys(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return cn(l),null}if(E=W.current,su(l))hT(l);else{var N=cm(he.current);switch(E){case 1:E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=N.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof g.is=="string"?N.createElement("select",{is:g.is}):N.createElement("select"),g.multiple?E.multiple=!0:g.size&&(E.size=g.size);break;default:E=typeof g.is=="string"?N.createElement(x,{is:g.is}):N.createElement(x)}}E[Bn]=l,E[dr]=g;e:for(N=l.child;N!==null;){if(N.tag===5||N.tag===6)E.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===l)break e;for(;N.sibling===null;){if(N.return===null||N.return===l)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}l.stateNode=E;e:switch(br(E,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&ys(l)}}return cn(l),Tb(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&ys(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=he.current,su(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=mr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[Bn]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||DC(s.nodeValue,f)),s||uo(l,!0)}else s=cm(s).createTextNode(g),s[Bn]=l,l.stateNode=s}return cn(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=su(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Bn]=l}else Nl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;cn(l),s=!1}else f=Oy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(hi(l),l):(hi(l),null);if((l.flags&128)!==0)throw Error(r(558))}return cn(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=su(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Bn]=l}else Nl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;cn(l),x=!1}else x=Oy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(hi(l),l):(hi(l),null)}return hi(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Kg(l,l.updateQueue),cn(l),null);case 4:return Me(),s===null&&Yb(l.stateNode.containerInfo),cn(l),null;case 10:return ps(l.type),cn(l),null;case 19:if($(On),g=l.memoizedState,g===null)return cn(l),null;if(x=(l.flags&128)!==0,E=g.rendering,E===null)if(x)Rf(g,!1);else{if(In!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Og(s),E!==null){for(l.flags|=128,Rf(g,!1),s=E.updateQueue,l.updateQueue=s,Kg(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)lT(f,s),f=f.sibling;return re(On,On.current&1|2),kt&&fs(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&ct()>Jg&&(l.flags|=128,x=!0,Rf(g,!1),l.lanes=4194304)}else{if(!x)if(s=Og(E),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Kg(l,s),Rf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!E.alternate&&!kt)return cn(l),null}else 2*ct()-g.renderingStartTime>Jg&&f!==536870912&&(l.flags|=128,x=!0,Rf(g,!1),l.lanes=4194304);g.isBackwards?(E.sibling=l.child,l.child=E):(s=g.last,s!==null?s.sibling=E:l.child=E,g.last=E)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=ct(),s.sibling=null,f=On.current,re(On,x?f&1|2:f&1),kt&&fs(l,g.treeForkCount),s):(cn(l),null);case 22:case 23:return hi(l),Ky(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(cn(l),l.subtreeFlags&6&&(l.flags|=8192)):cn(l),f=l.updateQueue,f!==null&&Kg(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&$(Ol),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),ps(Gn),cn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function pV(s,l){switch(My(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return ps(Gn),Me(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return de(l),null;case 31:if(l.memoizedState!==null){if(hi(l),l.alternate===null)throw Error(r(340));Nl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(hi(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Nl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return $(On),null;case 4:return Me(),null;case 10:return ps(l.type),null;case 22:case 23:return hi(l),Ky(),s!==null&&$(Ol),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return ps(Gn),null;case 25:return null;default:return null}}function OA(s,l){switch(My(l),l.tag){case 3:ps(Gn),Me();break;case 26:case 27:case 5:de(l);break;case 4:Me();break;case 31:l.memoizedState!==null&&hi(l);break;case 13:hi(l);break;case 19:$(On);break;case 10:ps(l.type);break;case 22:case 23:hi(l),Ky(),s!==null&&$(Ol);break;case 24:ps(Gn)}}function Df(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var E=f.create,N=f.inst;g=E(),N.destroy=g}f=f.next}while(f!==x)}}catch(F){$t(l,l.return,F)}}function yo(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var E=x.next;g=E;do{if((g.tag&s)===s){var N=g.inst,F=N.destroy;if(F!==void 0){N.destroy=void 0,x=l;var X=f,ce=F;try{ce()}catch(ve){$t(x,X,ve)}}}g=g.next}while(g!==E)}}catch(ve){$t(l,l.return,ve)}}function jA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{AT(l,f)}catch(g){$t(s,s.return,g)}}}function VA(s,l,f){f.props=Bl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){$t(s,l,g)}}function kf(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){$t(s,l,x)}}function Va(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){$t(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){$t(s,l,x)}else f.current=null}function zA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){$t(s,s.return,x)}}function Ab(s,l,f){try{var g=s.stateNode;jV(g,s.type,f,l),g[dr]=l}catch(x){$t(s,s.return,x)}}function LA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&To(s.type)||s.tag===4}function Cb(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||LA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&To(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ib(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Ji));else if(g!==4&&(g===27&&To(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(Ib(s,l,f),s=s.sibling;s!==null;)Ib(s,l,f),s=s.sibling}function Xg(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&To(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Xg(s,l,f),s=s.sibling;s!==null;)Xg(s,l,f),s=s.sibling}function BA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);br(l,g,f),l[Bn]=s,l[dr]=f}catch(E){$t(s,s.return,E)}}var bs=!1,$n=!1,Rb=!1,UA=typeof WeakSet=="function"?WeakSet:Set,hr=null;function gV(s,l){if(s=s.containerInfo,Wb=mm,s=JS(s),wy(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var N=0,F=-1,X=-1,ce=0,ve=0,xe=s,fe=null;t:for(;;){for(var ge;xe!==f||x!==0&&xe.nodeType!==3||(F=N+x),xe!==E||g!==0&&xe.nodeType!==3||(X=N+g),xe.nodeType===3&&(N+=xe.nodeValue.length),(ge=xe.firstChild)!==null;)fe=xe,xe=ge;for(;;){if(xe===s)break t;if(fe===f&&++ce===x&&(F=N),fe===E&&++ve===g&&(X=N),(ge=xe.nextSibling)!==null)break;xe=fe,fe=xe.parentNode}xe=ge}f=F===-1||X===-1?null:{start:F,end:X}}else f=null}f=f||{start:0,end:0}}else f=null;for(Qb={focusedElem:s,selectionRange:f},mm=!1,hr=l;hr!==null;)if(l=hr,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,hr=s;else for(;hr!==null;){switch(l=hr,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,f=l,x=E.memoizedProps,E=E.memoizedState,g=f.stateNode;try{var ze=Bl(f.type,x);s=g.getSnapshotBeforeUpdate(ze,E),g.__reactInternalSnapshotBeforeUpdate=s}catch(Ze){$t(f,f.return,Ze)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)ex(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ex(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,hr=s;break}hr=l.return}}function FA(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:_s(s,f),g&4&&Df(5,f);break;case 1:if(_s(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(N){$t(f,f.return,N)}else{var x=Bl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(N){$t(f,f.return,N)}}g&64&&jA(f),g&512&&kf(f,f.return);break;case 3:if(_s(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{AT(s,l)}catch(N){$t(f,f.return,N)}}break;case 27:l===null&&g&4&&BA(f);case 26:case 5:_s(s,f),l===null&&g&4&&zA(f),g&512&&kf(f,f.return);break;case 12:_s(s,f);break;case 31:_s(s,f),g&4&&HA(s,f);break;case 13:_s(s,f),g&4&&$A(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=SV.bind(null,f),qV(s,f))));break;case 22:if(g=f.memoizedState!==null||bs,!g){l=l!==null&&l.memoizedState!==null||$n,x=bs;var E=$n;bs=g,($n=l)&&!E?ws(s,f,(f.subtreeFlags&8772)!==0):_s(s,f),bs=x,$n=E}break;case 30:break;default:_s(s,f)}}function GA(s){var l=s.alternate;l!==null&&(s.alternate=null,GA(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Gc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var hn=null,Xr=!1;function xs(s,l,f){for(f=f.child;f!==null;)qA(s,l,f),f=f.sibling}function qA(s,l,f){if(Tn&&typeof Tn.onCommitFiberUnmount=="function")try{Tn.onCommitFiberUnmount(Or,f)}catch{}switch(f.tag){case 26:$n||Va(f,l),xs(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:$n||Va(f,l);var g=hn,x=Xr;To(f.type)&&(hn=f.stateNode,Xr=!1),xs(s,l,f),Bf(f.stateNode),hn=g,Xr=x;break;case 5:$n||Va(f,l);case 6:if(g=hn,x=Xr,hn=null,xs(s,l,f),hn=g,Xr=x,hn!==null)if(Xr)try{(hn.nodeType===9?hn.body:hn.nodeName==="HTML"?hn.ownerDocument.body:hn).removeChild(f.stateNode)}catch(E){$t(f,l,E)}else try{hn.removeChild(f.stateNode)}catch(E){$t(f,l,E)}break;case 18:hn!==null&&(Xr?(s=hn,jC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Cu(s)):jC(hn,f.stateNode));break;case 4:g=hn,x=Xr,hn=f.stateNode.containerInfo,Xr=!0,xs(s,l,f),hn=g,Xr=x;break;case 0:case 11:case 14:case 15:yo(2,f,l),$n||yo(4,f,l),xs(s,l,f);break;case 1:$n||(Va(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&VA(f,l,g)),xs(s,l,f);break;case 21:xs(s,l,f);break;case 22:$n=(g=$n)||f.memoizedState!==null,xs(s,l,f),$n=g;break;default:xs(s,l,f)}}function HA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Cu(s)}catch(f){$t(l,l.return,f)}}}function $A(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Cu(s)}catch(f){$t(l,l.return,f)}}function mV(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new UA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new UA),l;default:throw Error(r(435,s.tag))}}function Wg(s,l){var f=mV(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=TV.bind(null,s,g);g.then(x,x)}})}function Wr(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],E=s,N=l,F=N;e:for(;F!==null;){switch(F.tag){case 27:if(To(F.type)){hn=F.stateNode,Xr=!1;break e}break;case 5:hn=F.stateNode,Xr=!1;break e;case 3:case 4:hn=F.stateNode.containerInfo,Xr=!0;break e}F=F.return}if(hn===null)throw Error(r(160));qA(E,N,x),hn=null,Xr=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)YA(l,s),l=l.sibling}var aa=null;function YA(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Wr(l,s),Qr(s),g&4&&(yo(3,s,s.return),Df(3,s),yo(5,s,s.return));break;case 1:Wr(l,s),Qr(s),g&512&&($n||f===null||Va(f,f.return)),g&64&&bs&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=aa;if(Wr(l,s),Qr(s),g&512&&($n||f===null||Va(f,f.return)),g&4){var E=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":E=x.getElementsByTagName("title")[0],(!E||E[Ea]||E[Bn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(g),x.head.insertBefore(E,x.querySelector("head > title"))),br(E,g,f),E[Bn]=s,Un(E),g=E;break e;case"link":var N=YC("link","href",x).get(g+(f.href||""));if(N){for(var F=0;F<N.length;F++)if(E=N[F],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){N.splice(F,1);break t}}E=x.createElement(g),br(E,g,f),x.head.appendChild(E);break;case"meta":if(N=YC("meta","content",x).get(g+(f.content||""))){for(F=0;F<N.length;F++)if(E=N[F],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){N.splice(F,1);break t}}E=x.createElement(g),br(E,g,f),x.head.appendChild(E);break;default:throw Error(r(468,g))}E[Bn]=s,Un(E),g=E}s.stateNode=g}else KC(x,s.type,s.stateNode);else s.stateNode=$C(x,g,s.memoizedProps);else E!==g?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,g===null?KC(x,s.type,s.stateNode):$C(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&Ab(s,s.memoizedProps,f.memoizedProps)}break;case 27:Wr(l,s),Qr(s),g&512&&($n||f===null||Va(f,f.return)),f!==null&&g&4&&Ab(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Wr(l,s),Qr(s),g&512&&($n||f===null||Va(f,f.return)),s.flags&32){x=s.stateNode;try{Kr(x,"")}catch(ze){$t(s,s.return,ze)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,Ab(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Rb=!0);break;case 6:if(Wr(l,s),Qr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(ze){$t(s,s.return,ze)}}break;case 3:if(fm=null,x=aa,aa=um(l.containerInfo),Wr(l,s),aa=x,Qr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Cu(l.containerInfo)}catch(ze){$t(s,s.return,ze)}Rb&&(Rb=!1,KA(s));break;case 4:g=aa,aa=um(s.stateNode.containerInfo),Wr(l,s),Qr(s),aa=g;break;case 12:Wr(l,s),Qr(s);break;case 31:Wr(l,s),Qr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 13:Wr(l,s),Qr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Zg=ct()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 22:x=s.memoizedState!==null;var X=f!==null&&f.memoizedState!==null,ce=bs,ve=$n;if(bs=ce||x,$n=ve||X,Wr(l,s),$n=ve,bs=ce,Qr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||X||bs||$n||Ul(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){X=f=l;try{if(E=X.stateNode,x)N=E.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{F=X.stateNode;var xe=X.memoizedProps.style,fe=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;F.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(ze){$t(X,X.return,ze)}}}else if(l.tag===6){if(f===null){X=l;try{X.stateNode.nodeValue=x?"":X.memoizedProps}catch(ze){$t(X,X.return,ze)}}}else if(l.tag===18){if(f===null){X=l;try{var ge=X.stateNode;x?VC(ge,!0):VC(X.stateNode,!1)}catch(ze){$t(X,X.return,ze)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Wg(s,f))));break;case 19:Wr(l,s),Qr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Wg(s,g)));break;case 30:break;case 21:break;default:Wr(l,s),Qr(s)}}function Qr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(LA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,E=Cb(s);Xg(s,E,x);break;case 5:var N=f.stateNode;f.flags&32&&(Kr(N,""),f.flags&=-33);var F=Cb(s);Xg(s,F,N);break;case 3:case 4:var X=f.stateNode.containerInfo,ce=Cb(s);Ib(s,ce,X);break;default:throw Error(r(161))}}catch(ve){$t(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function KA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;KA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function _s(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)FA(s,l.alternate,l),l=l.sibling}function Ul(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:yo(4,l,l.return),Ul(l);break;case 1:Va(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&VA(l,l.return,f),Ul(l);break;case 27:Bf(l.stateNode);case 26:case 5:Va(l,l.return),Ul(l);break;case 22:l.memoizedState===null&&Ul(l);break;case 30:Ul(l);break;default:Ul(l)}s=s.sibling}}function ws(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,E=l,N=E.flags;switch(E.tag){case 0:case 11:case 15:ws(x,E,f),Df(4,E);break;case 1:if(ws(x,E,f),g=E,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ce){$t(g,g.return,ce)}if(g=E,x=g.updateQueue,x!==null){var F=g.stateNode;try{var X=x.shared.hiddenCallbacks;if(X!==null)for(x.shared.hiddenCallbacks=null,x=0;x<X.length;x++)TT(X[x],F)}catch(ce){$t(g,g.return,ce)}}f&&N&64&&jA(E),kf(E,E.return);break;case 27:BA(E);case 26:case 5:ws(x,E,f),f&&g===null&&N&4&&zA(E),kf(E,E.return);break;case 12:ws(x,E,f);break;case 31:ws(x,E,f),f&&N&4&&HA(x,E);break;case 13:ws(x,E,f),f&&N&4&&$A(x,E);break;case 22:E.memoizedState===null&&ws(x,E,f),kf(E,E.return);break;case 30:break;default:ws(x,E,f)}l=l.sibling}}function Db(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&vf(f))}function kb(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&vf(s))}function sa(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)XA(s,l,f,g),l=l.sibling}function XA(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:sa(s,l,f,g),x&2048&&Df(9,l);break;case 1:sa(s,l,f,g);break;case 3:sa(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&vf(s)));break;case 12:if(x&2048){sa(s,l,f,g),s=l.stateNode;try{var E=l.memoizedProps,N=E.id,F=E.onPostCommit;typeof F=="function"&&F(N,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(X){$t(l,l.return,X)}}else sa(s,l,f,g);break;case 31:sa(s,l,f,g);break;case 13:sa(s,l,f,g);break;case 23:break;case 22:E=l.stateNode,N=l.alternate,l.memoizedState!==null?E._visibility&2?sa(s,l,f,g):Nf(s,l):E._visibility&2?sa(s,l,f,g):(E._visibility|=2,mu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Db(N,l);break;case 24:sa(s,l,f,g),x&2048&&kb(l.alternate,l);break;default:sa(s,l,f,g)}}function mu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,N=l,F=f,X=g,ce=N.flags;switch(N.tag){case 0:case 11:case 15:mu(E,N,F,X,x),Df(8,N);break;case 23:break;case 22:var ve=N.stateNode;N.memoizedState!==null?ve._visibility&2?mu(E,N,F,X,x):Nf(E,N):(ve._visibility|=2,mu(E,N,F,X,x)),x&&ce&2048&&Db(N.alternate,N);break;case 24:mu(E,N,F,X,x),x&&ce&2048&&kb(N.alternate,N);break;default:mu(E,N,F,X,x)}l=l.sibling}}function Nf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:Nf(f,g),x&2048&&Db(g.alternate,g);break;case 24:Nf(f,g),x&2048&&kb(g.alternate,g);break;default:Nf(f,g)}l=l.sibling}}var Mf=8192;function vu(s,l,f){if(s.subtreeFlags&Mf)for(s=s.child;s!==null;)WA(s,l,f),s=s.sibling}function WA(s,l,f){switch(s.tag){case 26:vu(s,l,f),s.flags&Mf&&s.memoizedState!==null&&nz(f,aa,s.memoizedState,s.memoizedProps);break;case 5:vu(s,l,f);break;case 3:case 4:var g=aa;aa=um(s.stateNode.containerInfo),vu(s,l,f),aa=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Mf,Mf=16777216,vu(s,l,f),Mf=g):vu(s,l,f));break;default:vu(s,l,f)}}function QA(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Pf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];hr=g,JA(g,s)}QA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)ZA(s),s=s.sibling}function ZA(s){switch(s.tag){case 0:case 11:case 15:Pf(s),s.flags&2048&&yo(9,s,s.return);break;case 3:Pf(s);break;case 12:Pf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Qg(s)):Pf(s);break;default:Pf(s)}}function Qg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];hr=g,JA(g,s)}QA(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:yo(8,l,l.return),Qg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Qg(l));break;default:Qg(l)}s=s.sibling}}function JA(s,l){for(;hr!==null;){var f=hr;switch(f.tag){case 0:case 11:case 15:yo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:vf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,hr=g;else e:for(f=s;hr!==null;){g=hr;var x=g.sibling,E=g.return;if(GA(g),g===f){hr=null;break e}if(x!==null){x.return=E,hr=x;break e}hr=E}}}var vV={getCacheForType:function(s){var l=vr(Gn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return vr(Gn).controller.signal}},yV=typeof WeakMap=="function"?WeakMap:Map,Bt=0,sn=null,Et=null,At=0,Ht=0,pi=null,bo=!1,yu=!1,Nb=!1,Es=0,In=0,xo=0,Fl=0,Mb=0,gi=0,bu=0,Of=null,Zr=null,Pb=!1,Zg=0,eC=0,Jg=1/0,em=null,_o=null,nr=0,wo=null,xu=null,Ss=0,Ob=0,jb=null,tC=null,jf=0,Vb=null;function mi(){return(Bt&2)!==0&&At!==0?At&-At:H.T!==null?Gb():tg()}function nC(){if(gi===0)if((At&536870912)===0||kt){var s=Pt;Pt<<=1,(Pt&3932160)===0&&(Pt=262144),gi=s}else gi=536870912;return s=fi.current,s!==null&&(s.flags|=32),gi}function Jr(s,l,f){(s===sn&&(Ht===2||Ht===9)||s.cancelPendingCommit!==null)&&(_u(s,0),Eo(s,At,gi,!1)),bt(s,f),((Bt&2)===0||s!==sn)&&(s===sn&&((Bt&2)===0&&(Fl|=f),In===4&&Eo(s,At,gi,!1)),za(s))}function rC(s,l,f){if((Bt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||ft(s,l),x=g?_V(s,l):Lb(s,l,!0),E=g;do{if(x===0){yu&&!g&&Eo(s,l,0,!1);break}else{if(f=s.current.alternate,E&&!bV(f)){x=Lb(s,l,!1),E=!1;continue}if(x===2){if(E=l,s.errorRecoveryDisabledLanes&E)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){l=N;e:{var F=s;x=Of;var X=F.current.memoizedState.isDehydrated;if(X&&(_u(F,N).flags|=256),N=Lb(F,N,!1),N!==2){if(Nb&&!X){F.errorRecoveryDisabledLanes|=E,Fl|=E,x=4;break e}E=Zr,Zr=x,E!==null&&(Zr===null?Zr=E:Zr.push.apply(Zr,E))}x=N}if(E=!1,x!==2)continue}}if(x===1){_u(s,0),Eo(s,l,0,!0);break}e:{switch(g=s,E=x,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:Eo(g,l,gi,!bo);break e;case 2:Zr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Zg+300-ct(),10<x)){if(Eo(g,l,gi,!bo),_t(g,0,!0)!==0)break e;Ss=l,g.timeoutHandle=PC(iC.bind(null,g,f,Zr,em,Pb,l,gi,Fl,bu,bo,E,"Throttled",-0,0),x);break e}iC(g,f,Zr,em,Pb,l,gi,Fl,bu,bo,E,null,-0,0)}}break}while(!0);za(s)}function iC(s,l,f,g,x,E,N,F,X,ce,ve,xe,fe,ge){if(s.timeoutHandle=-1,xe=l.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ji},WA(l,E,xe);var ze=(E&62914560)===E?Zg-ct():(E&4194048)===E?eC-ct():0;if(ze=rz(xe,ze),ze!==null){Ss=E,s.cancelPendingCommit=ze(fC.bind(null,s,l,E,f,g,x,N,F,X,ve,xe,null,fe,ge)),Eo(s,E,N,!ce);return}}fC(s,l,E,f,g,x,N,F,X)}function bV(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],E=x.getSnapshot;x=x.value;try{if(!ui(E(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Eo(s,l,f,g){l&=~Mb,l&=~Fl,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var E=31-Ne(x),N=1<<E;g[E]=-1,x&=~N}f!==0&&Mn(s,f,l)}function tm(){return(Bt&6)===0?(Vf(0),!1):!0}function zb(){if(Et!==null){if(Ht===0)var s=Et.return;else s=Et,hs=Ml=null,eb(s),du=null,bf=0,s=Et;for(;s!==null;)OA(s.alternate,s),s=s.return;Et=null}}function _u(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,LV(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Ss=0,zb(),sn=s,Et=f=ds(s.current,null),At=l,Ht=0,pi=null,bo=!1,yu=ft(s,l),Nb=!1,bu=gi=Mb=Fl=xo=In=0,Zr=Of=null,Pb=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-Ne(g),E=1<<x;l|=s[x],g&=~E}return Es=l,wg(),f}function aC(s,l){pt=null,H.H=Cf,l===uu||l===Dg?(l=_T(),Ht=3):l===Fy?(l=_T(),Ht=4):Ht=l===mb?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,pi=l,Et===null&&(In=1,qg(s,Ci(l,s.current)))}function sC(){var s=fi.current;return s===null?!0:(At&4194048)===At?ki===null:(At&62914560)===At||(At&536870912)!==0?s===ki:!1}function oC(){var s=H.H;return H.H=Cf,s===null?Cf:s}function lC(){var s=H.A;return H.A=vV,s}function nm(){In=4,bo||(At&4194048)!==At&&fi.current!==null||(yu=!0),(xo&134217727)===0&&(Fl&134217727)===0||sn===null||Eo(sn,At,gi,!1)}function Lb(s,l,f){var g=Bt;Bt|=2;var x=oC(),E=lC();(sn!==s||At!==l)&&(em=null,_u(s,l)),l=!1;var N=In;e:do try{if(Ht!==0&&Et!==null){var F=Et,X=pi;switch(Ht){case 8:zb(),N=6;break e;case 3:case 2:case 9:case 6:fi.current===null&&(l=!0);var ce=Ht;if(Ht=0,pi=null,wu(s,F,X,ce),f&&yu){N=0;break e}break;default:ce=Ht,Ht=0,pi=null,wu(s,F,X,ce)}}xV(),N=In;break}catch(ve){aC(s,ve)}while(!0);return l&&s.shellSuspendCounter++,hs=Ml=null,Bt=g,H.H=x,H.A=E,Et===null&&(sn=null,At=0,wg()),N}function xV(){for(;Et!==null;)cC(Et)}function _V(s,l){var f=Bt;Bt|=2;var g=oC(),x=lC();sn!==s||At!==l?(em=null,Jg=ct()+500,_u(s,l)):yu=ft(s,l);e:do try{if(Ht!==0&&Et!==null){l=Et;var E=pi;t:switch(Ht){case 1:Ht=0,pi=null,wu(s,l,E,1);break;case 2:case 9:if(bT(E)){Ht=0,pi=null,uC(l);break}l=function(){Ht!==2&&Ht!==9||sn!==s||(Ht=7),za(s)},E.then(l,l);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:bT(E)?(Ht=0,pi=null,uC(l)):(Ht=0,pi=null,wu(s,l,E,7));break;case 5:var N=null;switch(Et.tag){case 26:N=Et.memoizedState;case 5:case 27:var F=Et;if(N?XC(N):F.stateNode.complete){Ht=0,pi=null;var X=F.sibling;if(X!==null)Et=X;else{var ce=F.return;ce!==null?(Et=ce,rm(ce)):Et=null}break t}}Ht=0,pi=null,wu(s,l,E,5);break;case 6:Ht=0,pi=null,wu(s,l,E,6);break;case 8:zb(),In=6;break e;default:throw Error(r(462))}}wV();break}catch(ve){aC(s,ve)}while(!0);return hs=Ml=null,H.H=g,H.A=x,Bt=f,Et!==null?0:(sn=null,At=0,wg(),In)}function wV(){for(;Et!==null&&!Tt();)cC(Et)}function cC(s){var l=MA(s.alternate,s,Es);s.memoizedProps=s.pendingProps,l===null?rm(s):Et=l}function uC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=CA(f,l,l.pendingProps,l.type,void 0,At);break;case 11:l=CA(f,l,l.pendingProps,l.type.render,l.ref,At);break;case 5:eb(l);default:OA(f,l),l=Et=lT(l,Es),l=MA(f,l,Es)}s.memoizedProps=s.pendingProps,l===null?rm(s):Et=l}function wu(s,l,f,g){hs=Ml=null,eb(l),du=null,bf=0;var x=l.return;try{if(uV(s,x,l,f,At)){In=1,qg(s,Ci(f,s.current)),Et=null;return}}catch(E){if(x!==null)throw Et=x,E;In=1,qg(s,Ci(f,s.current)),Et=null;return}l.flags&32768?(kt||g===1?s=!0:yu||(At&536870912)!==0?s=!1:(bo=s=!0,(g===2||g===9||g===3||g===6)&&(g=fi.current,g!==null&&g.tag===13&&(g.flags|=16384))),dC(l,s)):rm(l)}function rm(s){var l=s;do{if((l.flags&32768)!==0){dC(l,bo);return}s=l.return;var f=hV(l.alternate,l,Es);if(f!==null){Et=f;return}if(l=l.sibling,l!==null){Et=l;return}Et=l=s}while(l!==null);In===0&&(In=5)}function dC(s,l){do{var f=pV(s.alternate,s);if(f!==null){f.flags&=32767,Et=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){Et=s;return}Et=s=f}while(s!==null);In=6,Et=null}function fC(s,l,f,g,x,E,N,F,X){s.cancelPendingCommit=null;do im();while(nr!==0);if((Bt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Cy,xn(s,f,E,N,F,X),s===sn&&(Et=sn=null,At=0),xu=l,wo=s,Ss=f,Ob=E,jb=x,tC=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,AV(yn,function(){return vC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=H.T,H.T=null,x=Z.p,Z.p=2,N=Bt,Bt|=4;try{gV(s,l,f)}finally{Bt=N,Z.p=x,H.T=g}}nr=1,hC(),pC(),gC()}}function hC(){if(nr===1){nr=0;var s=wo,l=xu,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=H.T,H.T=null;var g=Z.p;Z.p=2;var x=Bt;Bt|=4;try{YA(l,s);var E=Qb,N=JS(s.containerInfo),F=E.focusedElem,X=E.selectionRange;if(N!==F&&F&&F.ownerDocument&&ZS(F.ownerDocument.documentElement,F)){if(X!==null&&wy(F)){var ce=X.start,ve=X.end;if(ve===void 0&&(ve=ce),"selectionStart"in F)F.selectionStart=ce,F.selectionEnd=Math.min(ve,F.value.length);else{var xe=F.ownerDocument||document,fe=xe&&xe.defaultView||window;if(fe.getSelection){var ge=fe.getSelection(),ze=F.textContent.length,Ze=Math.min(X.start,ze),en=X.end===void 0?Ze:Math.min(X.end,ze);!ge.extend&&Ze>en&&(N=en,en=Ze,Ze=N);var ie=QS(F,Ze),te=QS(F,en);if(ie&&te&&(ge.rangeCount!==1||ge.anchorNode!==ie.node||ge.anchorOffset!==ie.offset||ge.focusNode!==te.node||ge.focusOffset!==te.offset)){var le=xe.createRange();le.setStart(ie.node,ie.offset),ge.removeAllRanges(),Ze>en?(ge.addRange(le),ge.extend(te.node,te.offset)):(le.setEnd(te.node,te.offset),ge.addRange(le))}}}}for(xe=[],ge=F;ge=ge.parentNode;)ge.nodeType===1&&xe.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<xe.length;F++){var be=xe[F];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}mm=!!Wb,Qb=Wb=null}finally{Bt=x,Z.p=g,H.T=f}}s.current=l,nr=2}}function pC(){if(nr===2){nr=0;var s=wo,l=xu,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=H.T,H.T=null;var g=Z.p;Z.p=2;var x=Bt;Bt|=4;try{FA(s,l.alternate,l)}finally{Bt=x,Z.p=g,H.T=f}}nr=3}}function gC(){if(nr===4||nr===3){nr=0,Qe();var s=wo,l=xu,f=Ss,g=tC;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?nr=5:(nr=0,xu=wo=null,mC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(_o=null),tr(f),l=l.stateNode,Tn&&typeof Tn.onCommitFiberRoot=="function")try{Tn.onCommitFiberRoot(Or,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=H.T,x=Z.p,Z.p=2,H.T=null;try{for(var E=s.onRecoverableError,N=0;N<g.length;N++){var F=g[N];E(F.value,{componentStack:F.stack})}}finally{H.T=l,Z.p=x}}(Ss&3)!==0&&im(),za(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Vb?jf++:(jf=0,Vb=s):jf=0,Vf(0)}}function mC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,vf(l)))}function im(){return hC(),pC(),gC(),vC()}function vC(){if(nr!==5)return!1;var s=wo,l=Ob;Ob=0;var f=tr(Ss),g=H.T,x=Z.p;try{Z.p=32>f?32:f,H.T=null,f=jb,jb=null;var E=wo,N=Ss;if(nr=0,xu=wo=null,Ss=0,(Bt&6)!==0)throw Error(r(331));var F=Bt;if(Bt|=4,ZA(E.current),XA(E,E.current,N,f),Bt=F,Vf(0,!1),Tn&&typeof Tn.onPostCommitFiberRoot=="function")try{Tn.onPostCommitFiberRoot(Or,E)}catch{}return!0}finally{Z.p=x,H.T=g,mC(s,l)}}function yC(s,l,f){l=Ci(f,l),l=gb(s.stateNode,l,2),s=go(s,l,2),s!==null&&(bt(s,2),za(s))}function $t(s,l,f){if(s.tag===3)yC(s,s,f);else for(;l!==null;){if(l.tag===3){yC(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(_o===null||!_o.has(g))){s=Ci(f,s),f=bA(2),g=go(l,f,2),g!==null&&(xA(f,g,l,s),bt(g,2),za(g));break}}l=l.return}}function Bb(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new yV;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Nb=!0,x.add(f),s=EV.bind(null,s,l,f),l.then(s,s))}function EV(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,sn===s&&(At&f)===f&&(In===4||In===3&&(At&62914560)===At&&300>ct()-Zg?(Bt&2)===0&&_u(s,0):Mb|=f,bu===At&&(bu=0)),za(s)}function bC(s,l){l===0&&(l=Xt()),s=Dl(s,l),s!==null&&(bt(s,l),za(s))}function SV(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),bC(s,f)}function TV(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),bC(s,f)}function AV(s,l){return Ve(s,l)}var am=null,Eu=null,Ub=!1,sm=!1,Fb=!1,So=0;function za(s){s!==Eu&&s.next===null&&(Eu===null?am=Eu=s:Eu=Eu.next=s),sm=!0,Ub||(Ub=!0,IV())}function Vf(s,l){if(!Fb&&sm){Fb=!0;do for(var f=!1,g=am;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var E=0;else{var N=g.suspendedLanes,F=g.pingedLanes;E=(1<<31-Ne(42|s)+1)-1,E&=x&~(N&~F),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,EC(g,E))}else E=At,E=_t(g,g===sn?E:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(E&3)===0||ft(g,E)||(f=!0,EC(g,E));g=g.next}while(f);Fb=!1}}function CV(){xC()}function xC(){sm=Ub=!1;var s=0;So!==0&&zV()&&(s=So);for(var l=ct(),f=null,g=am;g!==null;){var x=g.next,E=_C(g,l);E===0?(g.next=null,f===null?am=x:f.next=x,x===null&&(Eu=f)):(f=g,(s!==0||(E&3)!==0)&&(sm=!0)),g=x}nr!==0&&nr!==5||Vf(s),So!==0&&(So=0)}function _C(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var N=31-Ne(E),F=1<<N,X=x[N];X===-1?((F&f)===0||(F&g)!==0)&&(x[N]=bn(F,l)):X<=l&&(s.expiredLanes|=F),E&=~F}if(l=sn,f=At,f=_t(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(Ht===2||Ht===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&et(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||ft(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&et(g),tr(f)){case 2:case 8:f=zt;break;case 32:f=yn;break;case 268435456:f=_i;break;default:f=yn}return g=wC.bind(null,s),f=Ve(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&et(g),s.callbackPriority=2,s.callbackNode=null,2}function wC(s,l){if(nr!==0&&nr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(im()&&s.callbackNode!==f)return null;var g=At;return g=_t(s,s===sn?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(rC(s,g,l),_C(s,ct()),s.callbackNode!=null&&s.callbackNode===f?wC.bind(null,s):null)}function EC(s,l){if(im())return null;rC(s,l,!0)}function IV(){BV(function(){(Bt&6)!==0?Ve(an,CV):xC()})}function Gb(){if(So===0){var s=lu;s===0&&(s=tt,tt<<=1,(tt&261888)===0&&(tt=256)),So=s}return So}function SC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Yc(""+s)}function TC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function RV(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var E=SC((x[dr]||null).action),N=g.submitter;N&&(l=(l=N[dr]||null)?SC(l.formAction):N.getAttribute("formAction"),l!==null&&(E=l,N=null));var F=new ka("action","action",null,g,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(So!==0){var X=N?TC(x,N):new FormData(x);cb(f,{pending:!0,data:X,method:x.method,action:E},null,X)}}else typeof E=="function"&&(F.preventDefault(),X=N?TC(x,N):new FormData(x),cb(f,{pending:!0,data:X,method:x.method,action:E},E,X))},currentTarget:x}]})}}for(var qb=0;qb<Ay.length;qb++){var Hb=Ay[qb],DV=Hb.toLowerCase(),kV=Hb[0].toUpperCase()+Hb.slice(1);ia(DV,"on"+kV)}ia(nT,"onAnimationEnd"),ia(rT,"onAnimationIteration"),ia(iT,"onAnimationStart"),ia("dblclick","onDoubleClick"),ia("focusin","onFocus"),ia("focusout","onBlur"),ia(Y5,"onTransitionRun"),ia(K5,"onTransitionStart"),ia(X5,"onTransitionCancel"),ia(aT,"onTransitionEnd"),Ca("onMouseEnter",["mouseout","mouseover"]),Ca("onMouseLeave",["mouseout","mouseover"]),Ca("onPointerEnter",["pointerout","pointerover"]),Ca("onPointerLeave",["pointerout","pointerover"]),Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NV=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zf));function AC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var N=g.length-1;0<=N;N--){var F=g[N],X=F.instance,ce=F.currentTarget;if(F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ce;try{E(x)}catch(ve){_g(ve)}x.currentTarget=null,E=X}else for(N=0;N<g.length;N++){if(F=g[N],X=F.instance,ce=F.currentTarget,F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=ce;try{E(x)}catch(ve){_g(ve)}x.currentTarget=null,E=X}}}}function St(s,l){var f=l[Fc];f===void 0&&(f=l[Fc]=new Set);var g=s+"__bubble";f.has(g)||(CC(l,s,2,!1),f.add(g))}function $b(s,l,f){var g=0;l&&(g|=4),CC(f,s,g,l)}var om="_reactListening"+Math.random().toString(36).slice(2);function Yb(s){if(!s[om]){s[om]=!0,Xd.forEach(function(f){f!=="selectionchange"&&(NV.has(f)||$b(f,!1,s),$b(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[om]||(l[om]=!0,$b("selectionchange",!1,l))}}function CC(s,l,f,g){switch(n2(l)){case 2:var x=sz;break;case 8:x=oz;break;default:x=lx}f=x.bind(null,l,f,s),x=void 0,!wl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Kb(s,l,f,g,x){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var F=g.stateNode.containerInfo;if(F===x)break;if(N===4)for(N=g.return;N!==null;){var X=N.tag;if((X===3||X===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;F!==null;){if(N=Sa(F),N===null)return;if(X=N.tag,X===5||X===6||X===26||X===27){g=E=N;continue e}F=F.parentNode}}g=g.return}io(function(){var ce=E,ve=Ei(f),xe=[];e:{var fe=sT.get(s);if(fe!==void 0){var ge=ka,ze=s;switch(s){case"keypress":if(Sl(f)===0)break e;case"keydown":case"keyup":ge=yg;break;case"focusin":ze="focus",ge=Al;break;case"focusout":ze="blur",ge=Al;break;case"beforeblur":case"afterblur":ge=Al;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=cf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=R;break;case nT:case rT:case iT:ge=dg;break;case aT:ge=q;break;case"scroll":case"scrollend":ge=lf;break;case"wheel":ge=pe;break;case"copy":case"cut":case"paste":ge=fg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=us;break;case"toggle":case"beforetoggle":ge=ht}var Ze=(l&4)!==0,en=!Ze&&(s==="scroll"||s==="scrollend"),ie=Ze?fe!==null?fe+"Capture":null:fe;Ze=[];for(var te=ce,le;te!==null;){var be=te;if(le=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||le===null||ie===null||(be=ea(te,ie),be!=null&&Ze.push(Lf(te,be,le))),en)break;te=te.return}0<Ze.length&&(fe=new ge(fe,ze,null,f,ve),xe.push({event:fe,listeners:Ze}))}}if((l&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",fe&&f!==af&&(ze=f.relatedTarget||f.fromElement)&&(Sa(ze)||ze[wa]))break e;if((ge||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,ge?(ze=f.relatedTarget||f.toElement,ge=ce,ze=ze?Sa(ze):null,ze!==null&&(en=a(ze),Ze=ze.tag,ze!==en||Ze!==5&&Ze!==27&&Ze!==6)&&(ze=null)):(ge=null,ze=ce),ge!==ze)){if(Ze=cf,be="onMouseLeave",ie="onMouseEnter",te="mouse",(s==="pointerout"||s==="pointerover")&&(Ze=us,be="onPointerLeave",ie="onPointerEnter",te="pointer"),en=ge==null?fe:li(ge),le=ze==null?fe:li(ze),fe=new Ze(be,te+"leave",ge,f,ve),fe.target=en,fe.relatedTarget=le,be=null,Sa(ve)===ce&&(Ze=new Ze(ie,te+"enter",ze,f,ve),Ze.target=le,Ze.relatedTarget=en,be=Ze),en=be,ge&&ze)t:{for(Ze=MV,ie=ge,te=ze,le=0,be=ie;be;be=Ze(be))le++;be=0;for(var Ye=te;Ye;Ye=Ze(Ye))be++;for(;0<le-be;)ie=Ze(ie),le--;for(;0<be-le;)te=Ze(te),be--;for(;le--;){if(ie===te||te!==null&&ie===te.alternate){Ze=ie;break t}ie=Ze(ie),te=Ze(te)}Ze=null}else Ze=null;ge!==null&&IC(xe,fe,ge,Ze,!1),ze!==null&&en!==null&&IC(xe,en,ze,Ze,!0)}}e:{if(fe=ce?li(ce):window,ge=fe.nodeName&&fe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&fe.type==="file")var jt=HS;else if(GS(fe))if($S)jt=q5;else{jt=F5;var Fe=U5}else ge=fe.nodeName,!ge||ge.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ce&&$c(ce.elementType)&&(jt=HS):jt=G5;if(jt&&(jt=jt(s,ce))){qS(xe,jt,f,ve);break e}Fe&&Fe(s,fe,ce),s==="focusout"&&ce&&fe.type==="number"&&ce.memoizedProps.value!=null&&tf(fe,"number",fe.value)}switch(Fe=ce?li(ce):window,s){case"focusin":(GS(Fe)||Fe.contentEditable==="true")&&(eu=Fe,Ey=ce,pf=null);break;case"focusout":pf=Ey=eu=null;break;case"mousedown":Sy=!0;break;case"contextmenu":case"mouseup":case"dragend":Sy=!1,eT(xe,f,ve);break;case"selectionchange":if($5)break;case"keydown":case"keyup":eT(xe,f,ve)}var mt;if(Lt)e:{switch(s){case"compositionstart":var Ct="onCompositionStart";break e;case"compositionend":Ct="onCompositionEnd";break e;case"compositionupdate":Ct="onCompositionUpdate";break e}Ct=void 0}else Jc?Cl(s,f)&&(Ct="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(Ct="onCompositionStart");Ct&&(Pa&&f.locale!=="ko"&&(Jc||Ct!=="onCompositionStart"?Ct==="onCompositionEnd"&&Jc&&(mt=of()):(Da=ve,sf="value"in Da?Da.value:Da.textContent,Jc=!0)),Fe=lm(ce,Ct),0<Fe.length&&(Ct=new Ma(Ct,s,null,f,ve),xe.push({event:Ct,listeners:Fe}),mt?Ct.data=mt:(mt=Zc(f),mt!==null&&(Ct.data=mt)))),(mt=Ti?V5(s,f):z5(s,f))&&(Ct=lm(ce,"onBeforeInput"),0<Ct.length&&(Fe=new Ma("onBeforeInput","beforeinput",null,f,ve),xe.push({event:Fe,listeners:Ct}),Fe.data=mt)),RV(xe,s,ce,f,ve)}AC(xe,l)})}function Lf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function lm(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=ea(s,f),x!=null&&g.unshift(Lf(s,x,E)),x=ea(s,l),x!=null&&g.push(Lf(s,x,E))),s.tag===3)return g;s=s.return}return[]}function MV(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function IC(s,l,f,g,x){for(var E=l._reactName,N=[];f!==null&&f!==g;){var F=f,X=F.alternate,ce=F.stateNode;if(F=F.tag,X!==null&&X===g)break;F!==5&&F!==26&&F!==27||ce===null||(X=ce,x?(ce=ea(f,E),ce!=null&&N.unshift(Lf(f,ce,X))):x||(ce=ea(f,E),ce!=null&&N.push(Lf(f,ce,X)))),f=f.return}N.length!==0&&s.push({event:l,listeners:N})}var PV=/\r\n?/g,OV=/\u0000|\uFFFD/g;function RC(s){return(typeof s=="string"?s:""+s).replace(PV,`
`).replace(OV,"")}function DC(s,l){return l=RC(l),RC(s)===l}function Jt(s,l,f,g,x,E){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Kr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Kr(s,""+g);break;case"className":ci(s,"class",g);break;case"tabIndex":ci(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":ci(s,f,g);break;case"style":rf(s,g,E);break;case"data":if(l!=="object"){ci(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=Yc(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(l!=="input"&&Jt(s,l,"name",x.name,x,null),Jt(s,l,"formEncType",x.formEncType,x,null),Jt(s,l,"formMethod",x.formMethod,x,null),Jt(s,l,"formTarget",x.formTarget,x,null)):(Jt(s,l,"encType",x.encType,x,null),Jt(s,l,"method",x.method,x,null),Jt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=Yc(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=Ji);break;case"onScroll":g!=null&&St("scroll",s);break;case"onScrollEnd":g!=null&&St("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=Yc(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":St("beforetoggle",s),St("toggle",s),qc(s,"popover",g);break;case"xlinkActuate":Fn(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Fn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Fn(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Fn(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Fn(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Fn(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Fn(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Fn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Fn(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":qc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=lg.get(f)||f,qc(s,f,g))}}function Xb(s,l,f,g,x,E){switch(f){case"style":rf(s,g,E);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?Kr(s,g):(typeof g=="number"||typeof g=="bigint")&&Kr(s,""+g);break;case"onScroll":g!=null&&St("scroll",s);break;case"onScrollEnd":g!=null&&St("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Ji);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),E=s[dr]||null,E=E!=null?E[f]:null,typeof E=="function"&&s.removeEventListener(l,E,x),typeof g=="function")){typeof E!="function"&&E!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):qc(s,f,g)}}}function br(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":St("error",s),St("load",s);var g=!1,x=!1,E;for(E in f)if(f.hasOwnProperty(E)){var N=f[E];if(N!=null)switch(E){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Jt(s,l,E,N,f,null)}}x&&Jt(s,l,"srcSet",f.srcSet,f,null),g&&Jt(s,l,"src",f.src,f,null);return;case"input":St("invalid",s);var F=E=N=x=null,X=null,ce=null;for(g in f)if(f.hasOwnProperty(g)){var ve=f[g];if(ve!=null)switch(g){case"name":x=ve;break;case"type":N=ve;break;case"checked":X=ve;break;case"defaultChecked":ce=ve;break;case"value":E=ve;break;case"defaultValue":F=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,l));break;default:Jt(s,l,g,ve,f,null)}}ag(s,E,F,X,ce,N,x,!1);return;case"select":St("invalid",s),g=N=E=null;for(x in f)if(f.hasOwnProperty(x)&&(F=f[x],F!=null))switch(x){case"value":E=F;break;case"defaultValue":N=F;break;case"multiple":g=F;default:Jt(s,l,x,F,f,null)}l=E,f=N,s.multiple=!!g,l!=null?eo(s,!!g,l,!1):f!=null&&eo(s,!!g,f,!0);return;case"textarea":St("invalid",s),E=x=g=null;for(N in f)if(f.hasOwnProperty(N)&&(F=f[N],F!=null))switch(N){case"value":g=F;break;case"defaultValue":x=F;break;case"children":E=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(91));break;default:Jt(s,l,N,F,f,null)}to(s,g,x,E);return;case"option":for(X in f)if(f.hasOwnProperty(X)&&(g=f[X],g!=null))switch(X){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Jt(s,l,X,g,f,null)}return;case"dialog":St("beforetoggle",s),St("toggle",s),St("cancel",s),St("close",s);break;case"iframe":case"object":St("load",s);break;case"video":case"audio":for(g=0;g<zf.length;g++)St(zf[g],s);break;case"image":St("error",s),St("load",s);break;case"details":St("toggle",s);break;case"embed":case"source":case"link":St("error",s),St("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in f)if(f.hasOwnProperty(ce)&&(g=f[ce],g!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Jt(s,l,ce,g,f,null)}return;default:if($c(l)){for(ve in f)f.hasOwnProperty(ve)&&(g=f[ve],g!==void 0&&Xb(s,l,ve,g,f,void 0));return}}for(F in f)f.hasOwnProperty(F)&&(g=f[F],g!=null&&Jt(s,l,F,g,f,null))}function jV(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,N=null,F=null,X=null,ce=null,ve=null;for(ge in f){var xe=f[ge];if(f.hasOwnProperty(ge)&&xe!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":X=xe;default:g.hasOwnProperty(ge)||Jt(s,l,ge,null,g,xe)}}for(var fe in g){var ge=g[fe];if(xe=f[fe],g.hasOwnProperty(fe)&&(ge!=null||xe!=null))switch(fe){case"type":E=ge;break;case"name":x=ge;break;case"checked":ce=ge;break;case"defaultChecked":ve=ge;break;case"value":N=ge;break;case"defaultValue":F=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,l));break;default:ge!==xe&&Jt(s,l,fe,ge,g,xe)}}Hc(s,N,F,X,ce,ve,E,x);return;case"select":ge=N=F=fe=null;for(E in f)if(X=f[E],f.hasOwnProperty(E)&&X!=null)switch(E){case"value":break;case"multiple":ge=X;default:g.hasOwnProperty(E)||Jt(s,l,E,null,g,X)}for(x in g)if(E=g[x],X=f[x],g.hasOwnProperty(x)&&(E!=null||X!=null))switch(x){case"value":fe=E;break;case"defaultValue":F=E;break;case"multiple":N=E;default:E!==X&&Jt(s,l,x,E,g,X)}l=F,f=N,g=ge,fe!=null?eo(s,!!f,fe,!1):!!g!=!!f&&(l!=null?eo(s,!!f,l,!0):eo(s,!!f,f?[]:"",!1));return;case"textarea":ge=fe=null;for(F in f)if(x=f[F],f.hasOwnProperty(F)&&x!=null&&!g.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:Jt(s,l,F,null,g,x)}for(N in g)if(x=g[N],E=f[N],g.hasOwnProperty(N)&&(x!=null||E!=null))switch(N){case"value":fe=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==E&&Jt(s,l,N,x,g,E)}sg(s,fe,ge);return;case"option":for(var ze in f)if(fe=f[ze],f.hasOwnProperty(ze)&&fe!=null&&!g.hasOwnProperty(ze))switch(ze){case"selected":s.selected=!1;break;default:Jt(s,l,ze,null,g,fe)}for(X in g)if(fe=g[X],ge=f[X],g.hasOwnProperty(X)&&fe!==ge&&(fe!=null||ge!=null))switch(X){case"selected":s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Jt(s,l,X,fe,g,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in f)fe=f[Ze],f.hasOwnProperty(Ze)&&fe!=null&&!g.hasOwnProperty(Ze)&&Jt(s,l,Ze,null,g,fe);for(ce in g)if(fe=g[ce],ge=f[ce],g.hasOwnProperty(ce)&&fe!==ge&&(fe!=null||ge!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,l));break;default:Jt(s,l,ce,fe,g,ge)}return;default:if($c(l)){for(var en in f)fe=f[en],f.hasOwnProperty(en)&&fe!==void 0&&!g.hasOwnProperty(en)&&Xb(s,l,en,void 0,g,fe);for(ve in g)fe=g[ve],ge=f[ve],!g.hasOwnProperty(ve)||fe===ge||fe===void 0&&ge===void 0||Xb(s,l,ve,fe,g,ge);return}}for(var ie in f)fe=f[ie],f.hasOwnProperty(ie)&&fe!=null&&!g.hasOwnProperty(ie)&&Jt(s,l,ie,null,g,fe);for(xe in g)fe=g[xe],ge=f[xe],!g.hasOwnProperty(xe)||fe===ge||fe==null&&ge==null||Jt(s,l,xe,fe,g,ge)}function kC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function VV(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],E=x.transferSize,N=x.initiatorType,F=x.duration;if(E&&F&&kC(N)){for(N=0,F=x.responseEnd,g+=1;g<f.length;g++){var X=f[g],ce=X.startTime;if(ce>F)break;var ve=X.transferSize,xe=X.initiatorType;ve&&kC(xe)&&(X=X.responseEnd,N+=ve*(X<F?1:(F-ce)/(X-ce)))}if(--g,l+=8*(E+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Wb=null,Qb=null;function cm(s){return s.nodeType===9?s:s.ownerDocument}function NC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function MC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Zb(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Jb=null;function zV(){var s=window.event;return s&&s.type==="popstate"?s===Jb?!1:(Jb=s,!0):(Jb=null,!1)}var PC=typeof setTimeout=="function"?setTimeout:void 0,LV=typeof clearTimeout=="function"?clearTimeout:void 0,OC=typeof Promise=="function"?Promise:void 0,BV=typeof queueMicrotask=="function"?queueMicrotask:typeof OC<"u"?function(s){return OC.resolve(null).then(s).catch(UV)}:PC;function UV(s){setTimeout(function(){throw s})}function To(s){return s==="head"}function jC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Cu(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Bf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Bf(f);for(var E=f.firstChild;E;){var N=E.nextSibling,F=E.nodeName;E[Ea]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=N}}else f==="body"&&Bf(s.ownerDocument.body);f=x}while(f);Cu(l)}function VC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function ex(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":ex(f),Gc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function FV(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[Ea])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Ni(s.nextSibling),s===null)break}return null}function GV(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=Ni(s.nextSibling),s===null))return null;return s}function zC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ni(s.nextSibling),s===null))return null;return s}function tx(s){return s.data==="$?"||s.data==="$~"}function nx(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function qV(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Ni(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var rx=null;function LC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return Ni(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function BC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function UC(s,l,f){switch(l=cm(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Bf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Gc(s)}var Mi=new Map,FC=new Set;function um(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ts=Z.d;Z.d={f:HV,r:$V,D:YV,C:KV,L:XV,m:WV,X:ZV,S:QV,M:JV};function HV(){var s=Ts.f(),l=tm();return s||l}function $V(s){var l=wi(s);l!==null&&l.tag===5&&l.type==="form"?aA(l):Ts.r(s)}var Su=typeof document>"u"?null:document;function GC(s,l,f){var g=Su;if(g&&typeof l=="string"&&l){var x=Yr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),FC.has(x)||(FC.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),br(l,"link",s),Un(l),g.head.appendChild(l)))}}function YV(s){Ts.D(s),GC("dns-prefetch",s,null)}function KV(s,l){Ts.C(s,l),GC("preconnect",s,l)}function XV(s,l,f){Ts.L(s,l,f);var g=Su;if(g&&s&&l){var x='link[rel="preload"][as="'+Yr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Yr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Yr(f.imageSizes)+'"]')):x+='[href="'+Yr(s)+'"]';var E=x;switch(l){case"style":E=Tu(s);break;case"script":E=Au(s)}Mi.has(E)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),Mi.set(E,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Uf(E))||l==="script"&&g.querySelector(Ff(E))||(l=g.createElement("link"),br(l,"link",s),Un(l),g.head.appendChild(l)))}}function WV(s,l){Ts.m(s,l);var f=Su;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Yr(g)+'"][href="'+Yr(s)+'"]',E=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Au(s)}if(!Mi.has(E)&&(s=p({rel:"modulepreload",href:s},l),Mi.set(E,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Ff(E)))return}g=f.createElement("link"),br(g,"link",s),Un(g),f.head.appendChild(g)}}}function QV(s,l,f){Ts.S(s,l,f);var g=Su;if(g&&s){var x=Ta(g).hoistableStyles,E=Tu(s);l=l||"default";var N=x.get(E);if(!N){var F={loading:0,preload:null};if(N=g.querySelector(Uf(E)))F.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=Mi.get(E))&&ix(s,f);var X=N=g.createElement("link");Un(X),br(X,"link",s),X._p=new Promise(function(ce,ve){X.onload=ce,X.onerror=ve}),X.addEventListener("load",function(){F.loading|=1}),X.addEventListener("error",function(){F.loading|=2}),F.loading|=4,dm(N,l,g)}N={type:"stylesheet",instance:N,count:1,state:F},x.set(E,N)}}}function ZV(s,l){Ts.X(s,l);var f=Su;if(f&&s){var g=Ta(f).hoistableScripts,x=Au(s),E=g.get(x);E||(E=f.querySelector(Ff(x)),E||(s=p({src:s,async:!0},l),(l=Mi.get(x))&&ax(s,l),E=f.createElement("script"),Un(E),br(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function JV(s,l){Ts.M(s,l);var f=Su;if(f&&s){var g=Ta(f).hoistableScripts,x=Au(s),E=g.get(x);E||(E=f.querySelector(Ff(x)),E||(s=p({src:s,async:!0,type:"module"},l),(l=Mi.get(x))&&ax(s,l),E=f.createElement("script"),Un(E),br(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function qC(s,l,f,g){var x=(x=he.current)?um(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Tu(f.href),f=Ta(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Tu(f.href);var E=Ta(x).hoistableStyles,N=E.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,N),(E=x.querySelector(Uf(s)))&&!E._p&&(N.instance=E,N.state.loading=5),Mi.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Mi.set(s,f),E||ez(x,s,f,N.state))),l&&g===null)throw Error(r(528,""));return N}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Au(f),f=Ta(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Tu(s){return'href="'+Yr(s)+'"'}function Uf(s){return'link[rel="stylesheet"]['+s+"]"}function HC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function ez(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),br(l,"link",f),Un(l),s.head.appendChild(l))}function Au(s){return'[src="'+Yr(s)+'"]'}function Ff(s){return"script[async]"+s}function $C(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Yr(f.href)+'"]');if(g)return l.instance=g,Un(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),Un(g),br(g,"style",x),dm(g,f.precedence,s),l.instance=g;case"stylesheet":x=Tu(f.href);var E=s.querySelector(Uf(x));if(E)return l.state.loading|=4,l.instance=E,Un(E),E;g=HC(f),(x=Mi.get(x))&&ix(g,x),E=(s.ownerDocument||s).createElement("link"),Un(E);var N=E;return N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),br(E,"link",g),l.state.loading|=4,dm(E,f.precedence,s),l.instance=E;case"script":return E=Au(f.src),(x=s.querySelector(Ff(E)))?(l.instance=x,Un(x),x):(g=f,(x=Mi.get(E))&&(g=p({},f),ax(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),Un(x),br(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,dm(g,f.precedence,s));return l.instance}function dm(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,E=x,N=0;N<g.length;N++){var F=g[N];if(F.dataset.precedence===l)E=F;else if(E!==x)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function ix(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function ax(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var fm=null;function YC(s,l,f){if(fm===null){var g=new Map,x=fm=new Map;x.set(f,g)}else x=fm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var E=f[x];if(!(E[Ea]||E[Bn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var N=E.getAttribute(l)||"";N=s+N;var F=g.get(N);F?F.push(E):g.set(N,[E])}}return g}function KC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function tz(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function XC(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function nz(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Tu(g.href),E=l.querySelector(Uf(x));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=hm.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=E,Un(E);return}E=l.ownerDocument||l,g=HC(g),(x=Mi.get(x))&&ix(g,x),E=E.createElement("link"),Un(E);var N=E;N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),br(E,"link",g),f.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=hm.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var sx=0;function rz(s,l){return s.stylesheets&&s.count===0&&gm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&gm(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&sx===0&&(sx=62500*VV());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&gm(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>sx?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function hm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var pm=null;function gm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,pm=new Map,l.forEach(iz,s),pm=null,hm.call(s))}function iz(s,l){if(!(l.state.loading&4)){var f=pm.get(s);if(f)var g=f.get(null);else{f=new Map,pm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var N=x[E];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(f.set(N.dataset.precedence,N),g=N)}g&&f.set(null,g)}x=l.instance,N=x.getAttribute("data-precedence"),E=f.get(N)||g,E===g&&f.set(null,x),f.set(N,x),this.count++,g=hm.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),E?E.parentNode.insertBefore(x,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var Gf={$$typeof:D,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function az(s,l,f,g,x,E,N,F,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Wt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wt(0),this.hiddenUpdates=Wt(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function WC(s,l,f,g,x,E,N,F,X,ce,ve,xe){return s=new az(s,l,f,N,X,ce,ve,xe,F),l=1,E===!0&&(l|=24),E=di(3,null,null,l),s.current=E,E.stateNode=s,l=Ly(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:g,isDehydrated:f,cache:l},Gy(E),s}function QC(s){return s?(s=ru,s):ru}function ZC(s,l,f,g,x,E){x=QC(x),g.context===null?g.context=x:g.pendingContext=x,g=po(l),g.payload={element:f},E=E===void 0?null:E,E!==null&&(g.callback=E),f=go(s,g,l),f!==null&&(Jr(f,s,l),_f(f,s,l))}function JC(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function ox(s,l){JC(s,l),(s=s.alternate)&&JC(s,l)}function e2(s){if(s.tag===13||s.tag===31){var l=Dl(s,67108864);l!==null&&Jr(l,s,67108864),ox(s,67108864)}}function t2(s){if(s.tag===13||s.tag===31){var l=mi();l=Vr(l);var f=Dl(s,l);f!==null&&Jr(f,s,l),ox(s,l)}}var mm=!0;function sz(s,l,f,g){var x=H.T;H.T=null;var E=Z.p;try{Z.p=2,lx(s,l,f,g)}finally{Z.p=E,H.T=x}}function oz(s,l,f,g){var x=H.T;H.T=null;var E=Z.p;try{Z.p=8,lx(s,l,f,g)}finally{Z.p=E,H.T=x}}function lx(s,l,f,g){if(mm){var x=cx(g);if(x===null)Kb(s,l,g,vm,f),r2(s,g);else if(cz(x,s,l,f,g))g.stopPropagation();else if(r2(s,g),l&4&&-1<lz.indexOf(s)){for(;x!==null;){var E=wi(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var N=Gt(E.pendingLanes);if(N!==0){var F=E;for(F.pendingLanes|=2,F.entangledLanes|=2;N;){var X=1<<31-Ne(N);F.entanglements[1]|=X,N&=~X}za(E),(Bt&6)===0&&(Jg=ct()+500,Vf(0))}}break;case 31:case 13:F=Dl(E,2),F!==null&&Jr(F,E,2),tm(),ox(E,2)}if(E=cx(g),E===null&&Kb(s,l,g,vm,f),E===x)break;x=E}x!==null&&g.stopPropagation()}else Kb(s,l,g,null,f)}}function cx(s){return s=Ei(s),ux(s)}var vm=null;function ux(s){if(vm=null,s=Sa(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return vm=s,null}function n2(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Mt()){case an:return 2;case zt:return 8;case yn:case Tr:return 32;case _i:return 268435456;default:return 32}default:return 32}}var dx=!1,Ao=null,Co=null,Io=null,qf=new Map,Hf=new Map,Ro=[],lz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function r2(s,l){switch(s){case"focusin":case"focusout":Ao=null;break;case"dragenter":case"dragleave":Co=null;break;case"mouseover":case"mouseout":Io=null;break;case"pointerover":case"pointerout":qf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hf.delete(l.pointerId)}}function $f(s,l,f,g,x,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:E,targetContainers:[x]},l!==null&&(l=wi(l),l!==null&&e2(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function cz(s,l,f,g,x){switch(l){case"focusin":return Ao=$f(Ao,s,l,f,g,x),!0;case"dragenter":return Co=$f(Co,s,l,f,g,x),!0;case"mouseover":return Io=$f(Io,s,l,f,g,x),!0;case"pointerover":var E=x.pointerId;return qf.set(E,$f(qf.get(E)||null,s,l,f,g,x)),!0;case"gotpointercapture":return E=x.pointerId,Hf.set(E,$f(Hf.get(E)||null,s,l,f,g,x)),!0}return!1}function i2(s){var l=Sa(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Qi(s.priority,function(){t2(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Qi(s.priority,function(){t2(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ym(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=cx(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);af=g,f.target.dispatchEvent(g),af=null}else return l=wi(f),l!==null&&e2(l),s.blockedOn=f,!1;l.shift()}return!0}function a2(s,l,f){ym(s)&&f.delete(l)}function uz(){dx=!1,Ao!==null&&ym(Ao)&&(Ao=null),Co!==null&&ym(Co)&&(Co=null),Io!==null&&ym(Io)&&(Io=null),qf.forEach(a2),Hf.forEach(a2)}function bm(s,l){s.blockedOn===l&&(s.blockedOn=null,dx||(dx=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,uz)))}var xm=null;function s2(s){xm!==s&&(xm=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){xm===s&&(xm=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(ux(g||f)===null)continue;break}var E=wi(f);E!==null&&(s.splice(l,3),l-=3,cb(E,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Cu(s){function l(X){return bm(X,s)}Ao!==null&&bm(Ao,s),Co!==null&&bm(Co,s),Io!==null&&bm(Io,s),qf.forEach(l),Hf.forEach(l);for(var f=0;f<Ro.length;f++){var g=Ro[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<Ro.length&&(f=Ro[0],f.blockedOn===null);)i2(f),f.blockedOn===null&&Ro.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],E=f[g+1],N=x[dr]||null;if(typeof E=="function")N||s2(f);else if(N){var F=null;if(E&&E.hasAttribute("formAction")){if(x=E,N=E[dr]||null)F=N.formAction;else if(ux(x)!==null)continue}else F=N.action;typeof F=="function"?f[g+1]=F:(f.splice(g,3),g-=3),s2(f)}}}function o2(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function fx(s){this._internalRoot=s}_m.prototype.render=fx.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=mi();ZC(f,g,s,l,null,null)},_m.prototype.unmount=fx.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;ZC(s.current,2,null,s,null,null),tm(),l[wa]=null}};function _m(s){this._internalRoot=s}_m.prototype.unstable_scheduleHydration=function(s){if(s){var l=tg();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Ro.length&&l!==0&&l<Ro[f].priority;f++);Ro.splice(f,0,s),f===0&&i2(s)}};var l2=e.version;if(l2!=="19.2.0")throw Error(r(527,l2,"19.2.0"));Z.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var dz={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wm.isDisabled&&wm.supportsFiber)try{Or=wm.inject(dz),Tn=wm}catch{}}return Kf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=gA,E=mA,N=vA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=WC(s,1,!1,null,null,f,g,null,x,E,N,o2),s[wa]=l.current,Yb(s),new fx(l)},Kf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",E=gA,N=mA,F=vA,X=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(N=f.onCaughtError),f.onRecoverableError!==void 0&&(F=f.onRecoverableError),f.formState!==void 0&&(X=f.formState)),l=WC(s,1,!0,l,f??null,g,x,X,E,N,F,o2),l.context=QC(null),f=l.current,g=mi(),g=Vr(g),x=po(g),x.callback=null,go(f,x,g),f=g,l.current.lanes=f,bt(l,f),za(l),s[wa]=l.current,Yb(s),new _m(l)},Kf.version="19.2.0",Kf}var y2;function wz(){if(y2)return gx.exports;y2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gx.exports=_z(),gx.exports}var Ez=wz();const Sz="modulepreload",Tz=function(n){return"/personal-budget-pwa/"+n},b2={},tn=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(t.map(d=>{if(d=Tz(d),d in b2)return;b2[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Sz,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,_)=>{m.addEventListener("load",b),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function Az(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await tn(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}var x2="popstate";function Cz(n={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Oc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),w1("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:Vh(a))}function r(i,a){Hi(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return Rz(e,t,r,n)}function Sn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Hi(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Iz(){return Math.random().toString(36).substring(2,10)}function _2(n,e){return{usr:n.state,key:n.key,idx:e}}function w1(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Oc(e):e,state:t,key:e&&e.key||r||Iz()}}function Vh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Oc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function Rz(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:w.location,delta:T})}function m(S,T){c="PUSH";let A=w1(w.location,S,T);t&&t(A,S),d=h()+1;let D=_2(A,d),P=w.createHref(A);try{o.pushState(D,"",P)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;i.location.assign(P)}a&&u&&u({action:c,location:w.location,delta:1})}function b(S,T){c="REPLACE";let A=w1(w.location,S,T);t&&t(A,S),d=h();let D=_2(A,d),P=w.createHref(A);o.replaceState(D,"",P),a&&u&&u({action:c,location:w.location,delta:0})}function _(S){return Dz(S)}let w={get action(){return c},get location(){return n(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(x2,p),u=S,()=>{i.removeEventListener(x2,p),u=null}},createHref(S){return e(i,S)},createURL:_,encodeLocation(S){let T=_(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return w}function Dz(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Sn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Vh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Jk(n,e,t="/"){return kz(n,e,t,!1)}function kz(n,e,t,r){let i=typeof e=="string"?Oc(e):e,a=Vs(i.pathname||"/",t);if(a==null)return null;let o=eN(n);Nz(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=Gz(a);c=Uz(o[u],d,r)}return c}function eN(n,e=[],t=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;Sn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Ns([r,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(Sn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),eN(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:Lz(p,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of tN(o.path))a(o,c,!0,u)}),e}function tN(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=tN(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function Nz(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Bz(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var Mz=/^:[\w-]+$/,Pz=3,Oz=2,jz=1,Vz=10,zz=-2,w2=n=>n==="*";function Lz(n,e){let t=n.split("/"),r=t.length;return t.some(w2)&&(r+=zz),e&&(r+=Oz),t.filter(i=>!w2(i)).reduce((i,a)=>i+(Mz.test(a)?Pz:a===""?jz:Vz),r)}function Bz(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function Uz(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=S0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Ns([a,p.pathname]),pathnameBase:Yz(Ns([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Ns([a,p.pathnameBase]))}return o}function S0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Fz(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function Fz(n,e=!1,t=!0){Hi(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Gz(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Hi(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Vs(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var qz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Hz(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Oc(n):n,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=E2(t.substring(1),"/"):a=E2(t,e)):a=e,{pathname:a,search:Kz(r),hash:Xz(i)}}function E2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function bx(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function $z(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function nN(n){let e=$z(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function rN(n,e,t,r=!1){let i;typeof n=="string"?i=Oc(n):(i={...n},Sn(!i.pathname||!i.pathname.includes("?"),bx("?","pathname","search",i)),Sn(!i.pathname||!i.pathname.includes("#"),bx("#","pathname","hash",i)),Sn(!i.search||!i.search.includes("#"),bx("#","search","hash",i)));let a=n===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=Hz(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Ns=n=>n.join("/").replace(/\/\/+/g,"/"),Yz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Kz=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Xz=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,Wz=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function Qz(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function Zz(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var iN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function aN(n,e){let t=n;if(typeof t!="string"||!qz.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(iN)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=Vs(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:i=!0}catch{Hi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var sN=["POST","PUT","PATCH","DELETE"];new Set(sN);var Jz=["GET",...sN];new Set(Jz);var Md=U.createContext(null);Md.displayName="DataRouter";var xv=U.createContext(null);xv.displayName="DataRouterState";var e6=U.createContext(!1),oN=U.createContext({isTransitioning:!1});oN.displayName="ViewTransition";var t6=U.createContext(new Map);t6.displayName="Fetchers";var n6=U.createContext(null);n6.displayName="Await";var Ki=U.createContext(null);Ki.displayName="Navigation";var mp=U.createContext(null);mp.displayName="Location";var as=U.createContext({outlet:null,matches:[],isDataRoute:!1});as.displayName="Route";var lw=U.createContext(null);lw.displayName="RouteError";var lN="REACT_ROUTER_ERROR",r6="REDIRECT",i6="ROUTE_ERROR_RESPONSE";function a6(n){if(n.startsWith(`${lN}:${r6}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function s6(n){if(n.startsWith(`${lN}:${i6}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Wz(e.status,e.statusText,e.data)}catch{}}function o6(n,{relative:e}={}){Sn(vp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext(Ki),{hash:i,pathname:a,search:o}=yp(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Ns([t,a])),r.createHref({pathname:c,search:o,hash:i})}function vp(){return U.useContext(mp)!=null}function xa(){return Sn(vp(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(mp).location}var cN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uN(n){U.useContext(Ki).static||U.useLayoutEffect(n)}function Ys(){let{isDataRoute:n}=U.useContext(as);return n?_6():l6()}function l6(){Sn(vp(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Md),{basename:e,navigator:t}=U.useContext(Ki),{matches:r}=U.useContext(as),{pathname:i}=xa(),a=JSON.stringify(nN(r)),o=U.useRef(!1);return uN(()=>{o.current=!0}),U.useCallback((u,d={})=>{if(Hi(o.current,cN),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=rN(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ns([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}U.createContext(null);function c6(){let{matches:n}=U.useContext(as),e=n[n.length-1];return e?e.params:{}}function yp(n,{relative:e}={}){let{matches:t}=U.useContext(as),{pathname:r}=xa(),i=JSON.stringify(nN(t));return U.useMemo(()=>rN(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function u6(n,e){return dN(n,e)}function dN(n,e,t,r,i){Sn(vp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(Ki),{matches:o}=U.useContext(as),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let A=p&&p.path||"";hN(d,!p||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let m=xa(),b;if(e){let A=typeof e=="string"?Oc(e):e;Sn(h==="/"||A.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${A.pathname}" was given in the \`location\` prop.`),b=A}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let A=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=Jk(n,{pathname:w});Hi(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Hi(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=g6(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},u,A.params),pathname:Ns([h,a.encodeLocation?a.encodeLocation(A.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?h:Ns([h,a.encodeLocation?a.encodeLocation(A.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathnameBase])})),o,t,r,i);return e&&T?U.createElement(mp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function d6(){let n=x6(),e=Qz(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,o)}var f6=U.createElement(d6,null),fN=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=s6(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(as.Provider,{value:this.props.routeContext},U.createElement(lw.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(h6,{error:n},e):e}};fN.contextType=e6;var xx=new WeakMap;function h6({children:n,error:e}){let{basename:t}=U.useContext(Ki);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=a6(e.digest);if(r){let i=xx.get(e);if(i)throw i;let a=aN(r.location,t);if(iN&&!xx.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw xx.set(e,o),o}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function p6({routeContext:n,match:e,children:t}){let r=U.useContext(Md);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(as.Provider,{value:n},t)}function g6(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);Sn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:Zz(t.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,S=null;t&&(b=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||f6,c&&(u<0&&m===0?(hN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):u===m&&(_=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),A=()=>{let D;return b?D=w:_?D=S:p.route.Component?D=U.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=h,U.createElement(p6,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:D})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?U.createElement(fN,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:A(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):A()},null)}function cw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function m6(n){let e=U.useContext(Md);return Sn(e,cw(n)),e}function v6(n){let e=U.useContext(xv);return Sn(e,cw(n)),e}function y6(n){let e=U.useContext(as);return Sn(e,cw(n)),e}function uw(n){let e=y6(n),t=e.matches[e.matches.length-1];return Sn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function b6(){return uw("useRouteId")}function x6(){let n=U.useContext(lw),e=v6("useRouteError"),t=uw("useRouteError");return n!==void 0?n:e.errors?.[t]}function _6(){let{router:n}=m6("useNavigate"),e=uw("useNavigate"),t=U.useRef(!1);return uN(()=>{t.current=!0}),U.useCallback(async(i,a={})=>{Hi(t.current,cN),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var S2={};function hN(n,e,t){!e&&!S2[n]&&(S2[n]=!0,Hi(!1,t))}U.memo(w6);function w6({routes:n,future:e,state:t,onError:r}){return dN(n,void 0,t,r,e)}function Vo(n){Sn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function E6({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){Sn(!vp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof t=="string"&&(t=Oc(t));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=t,_=U.useMemo(()=>{let w=Vs(d,c);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Hi(_!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement(Ki.Provider,{value:u},U.createElement(mp.Provider,{children:e,value:_}))}function S6({children:n,location:e}){return u6(E1(n),e)}function E1(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let a=[...e,i];if(r.type===U.Fragment){t.push.apply(t,E1(r.props.children,a));return}Sn(r.type===Vo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Sn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=E1(r.props.children,a)),t.push(o)}),t}var Zm="get",Jm="application/x-www-form-urlencoded";function _v(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function T6(n){return _v(n)&&n.tagName.toLowerCase()==="button"}function A6(n){return _v(n)&&n.tagName.toLowerCase()==="form"}function C6(n){return _v(n)&&n.tagName.toLowerCase()==="input"}function I6(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function R6(n,e){return n.button===0&&(!e||e==="_self")&&!I6(n)}function S1(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function D6(n,e){let t=S1(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var Sm=null;function k6(){if(Sm===null)try{new FormData(document.createElement("form"),0),Sm=!1}catch{Sm=!0}return Sm}var N6=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _x(n){return n!=null&&!N6.has(n)?(Hi(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jm}"`),null):n}function M6(n,e){let t,r,i,a,o;if(A6(n)){let c=n.getAttribute("action");r=c?Vs(c,e):null,t=n.getAttribute("method")||Zm,i=_x(n.getAttribute("enctype"))||Jm,a=new FormData(n)}else if(T6(n)||C6(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?Vs(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||Zm,i=_x(n.getAttribute("formenctype"))||_x(c.getAttribute("enctype"))||Jm,a=new FormData(c,n),!k6()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(_v(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Zm,r=null,i=Jm,o=n}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function dw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function P6(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Vs(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function O6(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function j6(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function V6(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await O6(a,t);return o.links?o.links():[]}return[]}));return U6(r.flat(1).filter(j6).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function T2(n,e,t,r,i,a){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function z6(n,e,{includeHydrateFallback:t}={}){return L6(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function L6(n){return[...new Set(n)]}function B6(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function U6(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(B6(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function pN(){let n=U.useContext(Md);return dw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function F6(){let n=U.useContext(xv);return dw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var fw=U.createContext(void 0);fw.displayName="FrameworkContext";function gN(){let n=U.useContext(fw);return dw(n,"You must render this element inside a <HydratedRouter> element"),n}function G6(n,e){let t=U.useContext(fw),[r,i]=U.useState(!1),[a,o]=U.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let w=T=>{T.forEach(A=>{o(A.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),U.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Xf(c,b),onBlur:Xf(u,_),onMouseEnter:Xf(d,b),onMouseLeave:Xf(h,_),onTouchStart:Xf(p,b)}]:[!1,m,{}]}function Xf(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function q6({page:n,...e}){let{router:t}=pN(),r=U.useMemo(()=>Jk(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement($6,{page:n,matches:r,...e}):null}function H6(n){let{manifest:e,routeModules:t}=gN(),[r,i]=U.useState([]);return U.useEffect(()=>{let a=!1;return V6(n,e,t).then(o=>{a||i(o)}),()=>{a=!0}},[n,e,t]),r}function $6({page:n,matches:e,...t}){let r=xa(),{future:i,manifest:a,routeModules:o}=gN(),{basename:c}=pN(),{loaderData:u,matches:d}=F6(),h=U.useMemo(()=>T2(n,e,d,a,r,"data"),[n,e,d,a,r]),p=U.useMemo(()=>T2(n,e,d,a,r,"assets"),[n,e,d,a,r]),m=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,S=!1;if(e.forEach(A=>{let D=a.routes[A.route.id];!D||!D.hasLoader||(!h.some(P=>P.route.id===A.route.id)&&A.route.id in u&&o[A.route.id]?.shouldRevalidate||D.hasClientLoader?S=!0:w.add(A.route.id))}),w.size===0)return[];let T=P6(n,c,i.unstable_trailingSlashAwareDataRequests,"data");return S&&w.size>0&&T.searchParams.set("_routes",e.filter(A=>w.has(A.route.id)).map(A=>A.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,n,o]),b=U.useMemo(()=>z6(p,a),[p,a]),_=H6(p);return U.createElement(U.Fragment,null,m.map(w=>U.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>U.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),_.map(({key:w,link:S})=>U.createElement("link",{key:w,nonce:t.nonce,...S,crossOrigin:S.crossOrigin??t.crossOrigin})))}function Y6(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var K6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{K6&&(window.__reactRouterVersion="7.13.0")}catch{}function X6({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=Cz({window:r,v5Compat:!0}));let a=i.current,[o,c]=U.useState({action:a.action,location:a.location}),u=U.useCallback(d=>{t===!1?c(d):U.startTransition(()=>c(d))},[t]);return U.useLayoutEffect(()=>a.listen(u),[a,u]),U.createElement(E6,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var mN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vN=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_){let{basename:w,unstable_useTransitions:S}=U.useContext(Ki),T=typeof d=="string"&&mN.test(d),A=aN(d,w);d=A.to;let D=o6(d,{relative:i}),[P,M,V]=G6(r,b),C=J6(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:S});function I(z){e&&e(z),z.defaultPrevented||C(z)}let k=U.createElement("a",{...b,...V,href:A.absoluteURL||D,onClick:A.isExternal||a?e:I,ref:Y6(_,M),target:u,"data-discover":!T&&t==="render"?"true":void 0});return P&&!T?U.createElement(U.Fragment,null,k,U.createElement(q6,{page:D})):k});vN.displayName="Link";var W6=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=yp(o,{relative:d.relative}),m=xa(),b=U.useContext(xv),{navigator:_,basename:w}=U.useContext(Ki),S=b!=null&&aL(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,A=m.pathname,D=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(A=A.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&w&&(D=Vs(D,w)||D);const P=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let M=A===T||!i&&A.startsWith(T)&&A.charAt(P)==="/",V=D!=null&&(D===T||!i&&D.startsWith(T)&&D.charAt(T.length)==="/"),C={isActive:M,isPending:V,isTransitioning:S},I=M?e:void 0,k;typeof r=="function"?k=r(C):k=[r,M?"active":null,V?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let z=typeof a=="function"?a(C):a;return U.createElement(vN,{...d,"aria-current":I,className:k,ref:h,style:z,to:o,viewTransition:c},typeof u=="function"?u(C):u)});W6.displayName="NavLink";var Q6=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:o=Zm,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_)=>{let{unstable_useTransitions:w}=U.useContext(Ki),S=rL(),T=iL(c,{relative:d}),A=o.toLowerCase()==="get"?"get":"post",D=typeof c=="string"&&mN.test(c),P=M=>{if(u&&u(M),M.defaultPrevented)return;M.preventDefault();let V=M.nativeEvent.submitter,C=V?.getAttribute("formmethod")||o,I=()=>S(V||M.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});w&&t!==!1?U.startTransition(()=>I()):I()};return U.createElement("form",{ref:_,method:A,action:T,onSubmit:r?u:P,...b,"data-discover":!D&&n==="render"?"true":void 0})});Q6.displayName="Form";function Z6(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yN(n){let e=U.useContext(Md);return Sn(e,Z6(n)),e}function J6(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=Ys(),h=xa(),p=yp(n,{relative:a});return U.useCallback(m=>{if(R6(m,e)){m.preventDefault();let b=t!==void 0?t:Vh(h)===Vh(p),_=()=>d(n,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?U.startTransition(()=>_()):_()}},[h,d,p,t,r,e,n,i,a,o,c,u])}function eL(n){Hi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(S1(n)),t=U.useRef(!1),r=xa(),i=U.useMemo(()=>D6(r.search,t.current?null:e.current),[r.search]),a=Ys(),o=U.useCallback((c,u)=>{const d=S1(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var tL=0,nL=()=>`__${String(++tL)}__`;function rL(){let{router:n}=yN("useSubmit"),{basename:e}=U.useContext(Ki),t=b6(),r=n.fetch,i=n.navigate;return U.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=M6(a,e);if(o.navigate===!1){let m=o.fetcherKey||nL();await r(m,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,t])}function iL(n,{relative:e}={}){let{basename:t}=U.useContext(Ki),r=U.useContext(as);Sn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...yp(n||".",{relative:e})},o=xa();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Ns([t,a.pathname])),Vh(a)}function aL(n,{relative:e}={}){let t=U.useContext(oN);Sn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=yN("useViewTransitionState"),i=yp(n,{relative:e});if(!t.isTransitioning)return!1;let a=Vs(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Vs(t.nextLocation.pathname,r)||t.nextLocation.pathname;return S0(i.pathname,o)!=null||S0(i.pathname,a)!=null}const sL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oL=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),A2=n=>{const e=oL(n);return e.charAt(0).toUpperCase()+e.slice(1)},bN=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),lL=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var cL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const uL=U.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>U.createElement("svg",{ref:u,...cL,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:bN("lucide",i),...!a&&!lL(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>U.createElement(d,h)),...Array.isArray(a)?a:[a]]));const at=(n,e)=>{const t=U.forwardRef(({className:r,...i},a)=>U.createElement(uL,{ref:a,iconNode:e,className:bN(`lucide-${sL(A2(n))}`,`lucide-${n}`,r),...i}));return t.displayName=A2(n),t};const dL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],sd=at("arrow-left",dL);const fL=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],hL=at("arrow-right-left",fL);const pL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],gL=at("arrow-right",pL);const mL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],vL=at("calendar",mL);const yL=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],bL=at("chart-column",yL);const xL=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],_L=at("chart-pie",xL);const wL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],EL=at("check",wL);const SL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],TL=at("chevron-left",SL);const AL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],As=at("chevron-right",AL);const CL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],IL=at("circle-arrow-down",CL);const RL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],DL=at("circle-arrow-up",RL);const kL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],T1=at("circle-check-big",kL);const NL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Cs=at("circle-check",NL);const ML=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],C2=at("circle",ML);const PL=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],I2=at("dollar-sign",PL);const OL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],R2=at("download",OL);const jL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],VL=at("ellipsis",jL);const zL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],LL=at("eye-off",zL);const BL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],UL=at("eye",BL);const FL=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],GL=at("file-text",FL);const qL=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],HL=at("folder",qL);const $L=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],YL=at("funnel",$L);const KL=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],xN=at("grip-vertical",KL);const XL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],WL=at("house",XL);const QL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],ZL=at("list",QL);const JL=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],D2=at("loader",JL);const e9=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],t9=at("log-out",e9);const n9=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],A1=at("mail",n9);const r9=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],i9=at("pause",r9);const a9=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],yc=at("piggy-bank",a9);const s9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],gh=at("plus",s9);const o9=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],zh=at("refresh-cw",o9);const l9=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],c9=at("rotate-ccw",l9);const u9=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],d9=at("search",u9);const f9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],h9=at("settings",f9);const p9=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Lh=at("sparkles",p9);const g9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],m9=at("target",g9);const v9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],C1=at("trash-2",v9);const y9=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_N=at("trash",y9);const b9=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],T0=at("trending-up",b9);const x9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ju=at("triangle-alert",x9);const _9=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],w9=at("undo-2",_9);const E9=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],S9=at("upload",E9);const T9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],A9=at("user-plus",T9);const C9=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],wv=at("wallet",C9);const I9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ev=at("x",I9),k2=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},R9=(n=>n?k2(n):k2),D9=n=>n;function k9(n,e=D9){const t=Em.useSyncExternalStore(n.subscribe,Em.useCallback(()=>e(n.getState()),[n,e]),Em.useCallback(()=>e(n.getInitialState()),[n,e]));return Em.useDebugValue(t),t}const N2=n=>{const e=R9(n),t=r=>k9(e,r);return Object.assign(t,e),t},hw=(n=>n?N2(n):N2),M2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyCS5qM6LW_IC4bRoK524UQP-9p9GdCxKns",VITE_FIREBASE_APP_ID:"1:137454342284:web:ab8b52955e6f0ffd42aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-BCLXBQHT9L",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},Bh=new Map,Tm=n=>{const e=Bh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},N9=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=Bh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return Bh.set(t.name,i),{type:"tracked",store:n,...i}},M9=(n,e)=>{if(e===void 0)return;const t=Bh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&Bh.delete(n))},P9=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},O9=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(M2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=N9(c,d,u);let m=!0;i.setState=((w,S,T)=>{const A=t(w,S);if(!m)return A;const D=T===void 0?{type:o||P9(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(D,r()),A):(h?.send({...D,type:`${c}/${D.type}`},{...Tm(u.name),[c]:i.getState()}),A)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),M9(u.name,c)}};const b=(...w)=>{const S=m;m=!1,t(...w),m=S},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,S])=>[w,w===p.store?_:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const S=i.dispatch;i.dispatch=(...T)=>{(M2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),S(...T)}}return h.subscribe(w=>{var S;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return wx(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const A=T.state[c];if(A==null)return;JSON.stringify(i.getState())!==JSON.stringify(A)&&b(A);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(Tm(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(Tm(u.name));case"ROLLBACK":return wx(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(Tm(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return wx(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,A=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!A)return;b(c===void 0?A:A[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},j9=O9,wx=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function V9(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const I1=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return I1(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return I1(r)(t)}}}},z9=(n,e)=>(t,r,i)=>{let a={storage:V9(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,S)=>(p(w,S),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,S;if(!d)return;o=!1,c.forEach(A=>{var D;return A((D=r())!=null?D:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(w=r())!=null?w:m))||void 0;return I1(d.getItem.bind(d))(a.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==a.version){if(a.migrate){const D=a.migrate(A.state,A.version);return D instanceof Promise?D.then(P=>[!0,P]):[!0,D]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var D;const[P,M]=A;if(b=a.merge(M,(D=r())!=null?D:m),t(b,!0),P)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(A=>A(b))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},wN=z9,L9=()=>{};var P2={};const EN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},B9=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},SN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(EN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):B9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new U9;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class U9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F9=function(n){const e=EN(n);return SN.encodeByteArray(e,!0)},A0=function(n){return F9(n).replace(/\./g,"")},TN=function(n){try{return SN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function AN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const G9=()=>AN().__FIREBASE_DEFAULTS__,q9=()=>{if(typeof process>"u"||typeof P2>"u")return;const n=P2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},H9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&TN(n[1]);return e&&JSON.parse(e)},Sv=()=>{try{return L9()||G9()||q9()||H9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},CN=n=>Sv()?.emulatorHosts?.[n],$9=n=>{const e=CN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},IN=()=>Sv()?.config,RN=n=>Sv()?.[`_${n}`];class Y9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Pd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function DN(n){return(await fetch(n,{credentials:"include"})).ok}function K9(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[A0(JSON.stringify(t)),A0(JSON.stringify(o)),""].join(".")}const mh={};function X9(){const n={prod:[],emulator:[]};for(const e of Object.keys(mh))mh[e]?n.emulator.push(e):n.prod.push(e);return n}function W9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let O2=!1;function kN(n,e){if(typeof window>"u"||typeof document>"u"||!Pd(window.location.host)||mh[n]===e||mh[n]||O2)return;mh[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=X9().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{O2=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=W9(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),S=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),A=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const D=m.element;c(D),h(S,w);const P=d();u(A,T),D.append(A,_,S,P),document.body.appendChild(D)}a?(_.innerText="Preview backend disconnected.",A.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(A.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function lr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Q9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lr())}function NN(){const n=Sv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Z9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function J9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function eB(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tB(){const n=lr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function MN(){return!NN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PN(){return!NN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ON(){try{return typeof indexedDB=="object"}catch{return!1}}function nB(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const rB="FirebaseError";class Ks extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=rB,Object.setPrototypeOf(this,Ks.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bp.prototype.create)}}class bp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?iB(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ks(i,c,r)}}function iB(n,e){return n.replace(aB,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const aB=/\{\$([^}]+)}/g;function sB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function nl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],o=e[i];if(j2(a)&&j2(o)){if(!nl(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function j2(n){return n!==null&&typeof n=="object"}function xp(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function rh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function ih(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function oB(n,e){const t=new lB(n,e);return t.subscribe.bind(t)}class lB{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");cB(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ex),i.error===void 0&&(i.error=Ex),i.complete===void 0&&(i.complete=Ex);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ex(){}function dn(n){return n&&n._delegate?n._delegate:n}let bc=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const $l="[DEFAULT]";let uB=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Y9;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fB(e))try{this.getOrInitializeService({instanceIdentifier:$l})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=$l){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$l){return this.instances.has(e)}getOptions(e=$l){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:dB(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$l){return this.component?this.component.multipleInstances?e:$l:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function dB(n){return n===$l?void 0:n}function fB(n){return n.instantiationMode==="EAGER"}class hB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new uB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var It;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(It||(It={}));const pB={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},gB=It.INFO,mB={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},vB=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=mB[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pw{constructor(e){this.name=e,this._logLevel=gB,this._logHandler=vB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}}const yB=(n,e)=>e.some(t=>n instanceof t);let V2,z2;function bB(){return V2||(V2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xB(){return z2||(z2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jN=new WeakMap,R1=new WeakMap,VN=new WeakMap,Sx=new WeakMap,gw=new WeakMap;function _B(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",o)},a=()=>{t(Xo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&jN.set(t,n)}).catch(()=>{}),gw.set(e,n),e}function wB(n){if(R1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",o),n.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",o),n.addEventListener("abort",o)});R1.set(n,e)}let D1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return R1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||VN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function EB(n){D1=n(D1)}function SB(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Tx(this),e,...t);return VN.set(r,e.sort?e.sort():[e]),Xo(r)}:xB().includes(n)?function(...e){return n.apply(Tx(this),e),Xo(jN.get(this))}:function(...e){return Xo(n.apply(Tx(this),e))}}function TB(n){return typeof n=="function"?SB(n):(n instanceof IDBTransaction&&wB(n),yB(n,bB())?new Proxy(n,D1):n)}function Xo(n){if(n instanceof IDBRequest)return _B(n);if(Sx.has(n))return Sx.get(n);const e=TB(n);return e!==n&&(Sx.set(n,e),gw.set(e,n)),e}const Tx=n=>gw.get(n);function AB(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(n,e),c=Xo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Xo(o.result),u.oldVersion,u.newVersion,Xo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const CB=["get","getKey","getAll","getAllKeys","count"],IB=["put","add","delete","clear"],Ax=new Map;function L2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ax.get(e))return Ax.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=IB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||CB.includes(t)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return Ax.set(e,a),a}EB(n=>({...n,get:(e,t,r)=>L2(e,t)||n.get(e,t,r),has:(e,t)=>!!L2(e,t)||n.has(e,t)}));class RB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(DB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function DB(n){return n.getComponent()?.type==="VERSION"}const k1="@firebase/app",B2="0.14.6";const zs=new pw("@firebase/app"),kB="@firebase/app-compat",NB="@firebase/analytics-compat",MB="@firebase/analytics",PB="@firebase/app-check-compat",OB="@firebase/app-check",jB="@firebase/auth",VB="@firebase/auth-compat",zB="@firebase/database",LB="@firebase/data-connect",BB="@firebase/database-compat",UB="@firebase/functions",FB="@firebase/functions-compat",GB="@firebase/installations",qB="@firebase/installations-compat",HB="@firebase/messaging",$B="@firebase/messaging-compat",YB="@firebase/performance",KB="@firebase/performance-compat",XB="@firebase/remote-config",WB="@firebase/remote-config-compat",QB="@firebase/storage",ZB="@firebase/storage-compat",JB="@firebase/firestore",e8="@firebase/ai",t8="@firebase/firestore-compat",n8="firebase",r8="12.6.0";const N1="[DEFAULT]",i8={[k1]:"fire-core",[kB]:"fire-core-compat",[MB]:"fire-analytics",[NB]:"fire-analytics-compat",[OB]:"fire-app-check",[PB]:"fire-app-check-compat",[jB]:"fire-auth",[VB]:"fire-auth-compat",[zB]:"fire-rtdb",[LB]:"fire-data-connect",[BB]:"fire-rtdb-compat",[UB]:"fire-fn",[FB]:"fire-fn-compat",[GB]:"fire-iid",[qB]:"fire-iid-compat",[HB]:"fire-fcm",[$B]:"fire-fcm-compat",[YB]:"fire-perf",[KB]:"fire-perf-compat",[XB]:"fire-rc",[WB]:"fire-rc-compat",[QB]:"fire-gcs",[ZB]:"fire-gcs-compat",[JB]:"fire-fst",[t8]:"fire-fst-compat",[e8]:"fire-vertex","fire-js":"fire-js",[n8]:"fire-js-all"};const C0=new Map,a8=new Map,M1=new Map;function U2(n,e){try{n.container.addComponent(e)}catch(t){zs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function od(n){const e=n.name;if(M1.has(e))return zs.debug(`There were multiple attempts to register component ${e}.`),!1;M1.set(e,n);for(const t of C0.values())U2(t,n);for(const t of a8.values())U2(t,n);return!0}function mw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function zi(n){return n==null?!1:n.settings!==void 0}const s8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wo=new bp("app","Firebase",s8);class o8{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wo.create("app-deleted",{appName:this._name})}}const Od=r8;function zN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:N1,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Wo.create("bad-app-name",{appName:String(i)});if(t||(t=IN()),!t)throw Wo.create("no-options");const a=C0.get(i);if(a){if(nl(t,a.options)&&nl(r,a.config))return a;throw Wo.create("duplicate-app",{appName:i})}const o=new hB(i);for(const u of M1.values())o.addComponent(u);const c=new o8(t,r,o);return C0.set(i,c),c}function LN(n=N1){const e=C0.get(n);if(!e&&n===N1&&IN())return zN();if(!e)throw Wo.create("no-app",{appName:n});return e}function Qo(n,e,t){let r=i8[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zs.warn(o.join(" "));return}od(new bc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const l8="firebase-heartbeat-database",c8=1,Uh="firebase-heartbeat-store";let Cx=null;function BN(){return Cx||(Cx=AB(l8,c8,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Uh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Wo.create("idb-open",{originalErrorMessage:n.message})})),Cx}async function u8(n){try{const t=(await BN()).transaction(Uh),r=await t.objectStore(Uh).get(UN(n));return await t.done,r}catch(e){if(e instanceof Ks)zs.warn(e.message);else{const t=Wo.create("idb-get",{originalErrorMessage:e?.message});zs.warn(t.message)}}}async function F2(n,e){try{const r=(await BN()).transaction(Uh,"readwrite");await r.objectStore(Uh).put(e,UN(n)),await r.done}catch(t){if(t instanceof Ks)zs.warn(t.message);else{const r=Wo.create("idb-set",{originalErrorMessage:t?.message});zs.warn(r.message)}}}function UN(n){return`${n.name}!${n.options.appId}`}const d8=1024,f8=30;class h8{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new g8(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=G2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>f8){const i=m8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){zs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=G2(),{heartbeatsToSend:t,unsentEntries:r}=p8(this._heartbeatsCache.heartbeats),i=A0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return zs.warn(e),""}}}function G2(){return new Date().toISOString().substring(0,10)}function p8(n,e=d8){const t=[];let r=n.slice();for(const i of n){const a=t.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),q2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),q2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class g8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ON()?nB().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await u8(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return F2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return F2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function q2(n){return A0(JSON.stringify({version:2,heartbeats:n})).length}function m8(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function v8(n){od(new bc("platform-logger",e=>new RB(e),"PRIVATE")),od(new bc("heartbeat",e=>new h8(e),"PRIVATE")),Qo(k1,B2,n),Qo(k1,B2,"esm2020"),Qo("fire-js","")}v8("");function FN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const y8=FN,GN=new bp("auth","Firebase",FN());const I0=new pw("@firebase/auth");function b8(n,...e){I0.logLevel<=It.WARN&&I0.warn(`Auth (${Od}): ${n}`,...e)}function e0(n,...e){I0.logLevel<=It.ERROR&&I0.error(`Auth (${Od}): ${n}`,...e)}function ma(n,...e){throw vw(n,...e)}function Ka(n,...e){return vw(n,...e)}function qN(n,e,t){const r={...y8(),[e]:t};return new bp("auth","Firebase",r).create(e,{appName:n.name})}function Ms(n){return qN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function vw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return GN.create(n,...e)}function nt(n,e,...t){if(!n)throw vw(e,...t)}function Is(n){const e="INTERNAL ASSERTION FAILED: "+n;throw e0(e),new Error(e)}function Ls(n,e){n||Is(e)}function P1(){return typeof self<"u"&&self.location?.href||""}function x8(){return H2()==="http:"||H2()==="https:"}function H2(){return typeof self<"u"&&self.location?.protocol||null}function _8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(x8()||J9()||"connection"in navigator)?navigator.onLine:!0}function w8(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class _p{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ls(t>e,"Short delay should be less than long delay!"),this.isMobile=Q9()||eB()}get(){return _8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function yw(n,e){Ls(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class HN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const E8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const S8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],T8=new _p(3e4,6e4);function Xs(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ss(n,e,t,r,i={}){return $N(n,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=xp({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return Z9()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(d.credentials="include"),HN.fetch()(await YN(n,n.config.apiHost,t,c),d)})}async function $N(n,e,t){n._canInitEmulator=!1;const r={...E8,...e};try{const i=new C8(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Am(n,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Am(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Am(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Am(n,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw qN(n,h,d);ma(n,h)}}catch(i){if(i instanceof Ks)throw i;ma(n,"network-request-failed",{message:String(i)})}}async function wp(n,e,t,r,i={}){const a=await ss(n,e,t,r,i);return"mfaPendingCredential"in a&&ma(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function YN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,o=a.config.emulator?yw(n.config,i):`${n.config.apiScheme}://${i}`;return S8.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function A8(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class C8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ka(this.auth,"network-request-failed")),T8.get())})}}function Am(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ka(n,e,r);return i.customData._tokenResponse=t,i}function $2(n){return n!==void 0&&n.enterprise!==void 0}class I8{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return A8(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function R8(n,e){return ss(n,"GET","/v2/recaptchaConfig",Xs(n,e))}async function D8(n,e){return ss(n,"POST","/v1/accounts:delete",e)}async function R0(n,e){return ss(n,"POST","/v1/accounts:lookup",e)}function vh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k8(n,e=!1){const t=dn(n),r=await t.getIdToken(e),i=bw(r);nt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:vh(Ix(i.auth_time)),issuedAtTime:vh(Ix(i.iat)),expirationTime:vh(Ix(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Ix(n){return Number(n)*1e3}function bw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return e0("JWT malformed, contained fewer than 3 sections"),null;try{const i=TN(t);return i?JSON.parse(i):(e0("Failed to decode base64 JWT payload"),null)}catch(i){return e0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Y2(n){const e=bw(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ld(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ks&&N8(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function N8({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class M8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class O1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vh(this.lastLoginAt),this.creationTime=vh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function D0(n){const e=n.auth,t=await n.getIdToken(),r=await ld(n,R0(e,{idToken:t}));nt(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?KN(i.providerUserInfo):[],o=O8(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new O1(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function P8(n){const e=dn(n);await D0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function O8(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function KN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function j8(n,e){const t=await $N(n,{},async()=>{const r=xp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,o=await YN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Pd(n.emulatorConfig.host)&&(u.credentials="include"),HN.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function V8(n,e){return ss(n,"POST","/v2/accounts:revokeToken",Xs(n,e))}class ed{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Y2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=Y2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await j8(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,o=new ed;return r&&(nt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(nt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(nt(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ed,this.toJSON())}_performRefresh(){return Is("not implemented")}}function ko(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class da{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new M8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new O1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ld(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return k8(this,e)}reload(){return P8(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new da({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await D0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zi(this.auth.app))return Promise.reject(Ms(this.auth));const e=await this.getIdToken();return await ld(this,D8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;nt(p&&w,e,"internal-error");const S=ed.fromJSON(this.name,w);nt(typeof p=="string",e,"internal-error"),ko(r,e.name),ko(i,e.name),nt(typeof m=="boolean",e,"internal-error"),nt(typeof b=="boolean",e,"internal-error"),ko(a,e.name),ko(o,e.name),ko(c,e.name),ko(u,e.name),ko(d,e.name),ko(h,e.name);const T=new da({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(A=>({...A}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new ed;i.updateFromServerResponse(t);const a=new da({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await D0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];nt(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?KN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new ed;c.updateFromIdToken(r);const u=new da({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new O1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const K2=new Map;function Rs(n){Ls(n instanceof Function,"Expected a class definition");let e=K2.get(n);return e?(Ls(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,K2.set(n,e),e)}class XN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XN.type="NONE";const X2=XN;function t0(n,e,t){return`firebase:${n}:${e}:${t}`}class td{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=t0(this.userKey,i.apiKey,a),this.fullPersistenceKey=t0("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await R0(this.auth,{idToken:e}).catch(()=>{});return t?da._fromGetAccountInfoResponse(this.auth,t,e):null}return da._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new td(Rs(X2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||Rs(X2);const o=t0(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await R0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await da._fromGetAccountInfoResponse(e,m,h)}else p=da._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new td(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new td(a,e,r))}}function W2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(WN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tM(e))return"Blackberry";if(nM(e))return"Webos";if(QN(e))return"Safari";if((e.includes("chrome/")||ZN(e))&&!e.includes("edge/"))return"Chrome";if(eM(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function WN(n=lr()){return/firefox\//i.test(n)}function QN(n=lr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ZN(n=lr()){return/crios\//i.test(n)}function JN(n=lr()){return/iemobile/i.test(n)}function eM(n=lr()){return/android/i.test(n)}function tM(n=lr()){return/blackberry/i.test(n)}function nM(n=lr()){return/webos/i.test(n)}function xw(n=lr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function z8(n=lr()){return xw(n)&&!!window.navigator?.standalone}function L8(){return tB()&&document.documentMode===10}function rM(n=lr()){return xw(n)||eM(n)||nM(n)||tM(n)||/windows phone/i.test(n)||JN(n)}function iM(n,e=[]){let t;switch(n){case"Browser":t=W2(lr());break;case"Worker":t=`${W2(lr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Od}/${r}`}class B8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function U8(n,e={}){return ss(n,"GET","/v2/passwordPolicy",Xs(n,e))}const F8=6;class G8{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??F8,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class q8{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q2(this),this.idTokenSubscription=new Q2(this),this.beforeStateQueue=new B8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Rs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await td.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await R0(this,{idToken:e}),r=await da._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await D0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=w8()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zi(this.app))return Promise.reject(Ms(this));const t=e?dn(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zi(this.app)?Promise.reject(Ms(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zi(this.app)?Promise.reject(Ms(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await U8(this),t=new G8(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new bp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await V8(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Rs(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await td.create(this,[Rs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iM(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(zi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&b8(`Error while retrieving App Check token: ${e.error}`),e?.token}}function hl(n){return dn(n)}class Q2{constructor(e){this.auth=e,this.observer=null,this.addObserver=oB(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Tv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function H8(n){Tv=n}function aM(n){return Tv.loadJS(n)}function $8(){return Tv.recaptchaEnterpriseScript}function Y8(){return Tv.gapiScript}function K8(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class X8{constructor(){this.enterprise=new W8}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class W8{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Q8="recaptcha-enterprise",sM="NO_RECAPTCHA";class Z8{constructor(e){this.type=Q8,this.auth=hl(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{R8(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new I8(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;$2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(sM)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new X8().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!t&&$2(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=$8();u.length!==0&&(u+=c),aM(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function Z2(n,e,t,r=!1,i=!1){const a=new Z8(n);let o;if(i)o=sM;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function k0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Z2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Z2(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}function J8(n,e){const t=mw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(nl(a,e??{}))return i;ma(i,"already-initialized")}return t.initialize({options:e})}function eU(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Rs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function tU(n,e,t){const r=hl(n);nt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=oM(e),{host:o,port:c}=nU(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){nt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),nt(nl(d,r.config.emulator)&&nl(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Pd(o)?(DN(`${a}//${o}${u}`),kN("Auth",!0)):rU()}function oM(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function nU(n){const e=oM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:J2(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:J2(o)}}}function J2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function rU(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class _w{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Is("not implemented")}_getIdTokenResponse(e){return Is("not implemented")}_linkToIdToken(e,t){return Is("not implemented")}_getReauthenticationResolver(e){return Is("not implemented")}}async function iU(n,e){return ss(n,"POST","/v1/accounts:signUp",e)}async function aU(n,e){return wp(n,"POST","/v1/accounts:signInWithPassword",Xs(n,e))}async function lM(n,e){return ss(n,"POST","/v1/accounts:sendOobCode",Xs(n,e))}async function sU(n,e){return lM(n,e)}async function oU(n,e){return lM(n,e)}async function lU(n,e){return wp(n,"POST","/v1/accounts:signInWithEmailLink",Xs(n,e))}async function cU(n,e){return wp(n,"POST","/v1/accounts:signInWithEmailLink",Xs(n,e))}class Fh extends _w{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Fh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Fh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,t,"signInWithPassword",aU);case"emailLink":return lU(e,{email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return k0(e,r,"signUpPassword",iU);case"emailLink":return cU(e,{idToken:t,email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function nd(n,e){return wp(n,"POST","/v1/accounts:signInWithIdp",Xs(n,e))}const uU="http://localhost";class xc extends _w{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new xc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ma("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const o=new xc(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return nd(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,nd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,nd(e,t)}buildRequest(){const e={requestUri:uU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=xp(t)}return e}}function dU(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function fU(n){const e=rh(ih(n)).link,t=e?rh(ih(e)).deep_link_id:null,r=rh(ih(n)).deep_link_id;return(r?rh(ih(r)).link:null)||r||t||e||n}class ww{constructor(e){const t=rh(ih(e)),r=t.apiKey??null,i=t.oobCode??null,a=dU(t.mode??null);nt(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=fU(e);try{return new ww(t)}catch{return null}}}class jc{constructor(){this.providerId=jc.PROVIDER_ID}static credential(e,t){return Fh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ww.parseLink(t);return nt(r,"argument-error"),Fh._fromEmailAndCode(e,r.code,r.tenantId)}}jc.PROVIDER_ID="password";jc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";jc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class cM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ep extends cM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Bo extends Ep{constructor(){super("facebook.com")}static credential(e){return xc._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bo.credential(e.oauthAccessToken)}catch{return null}}}Bo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bo.PROVIDER_ID="facebook.com";class Uo extends Ep{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return xc._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Uo.credential(t,r)}catch{return null}}}Uo.GOOGLE_SIGN_IN_METHOD="google.com";Uo.PROVIDER_ID="google.com";class Fo extends Ep{constructor(){super("github.com")}static credential(e){return xc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fo.credential(e.oauthAccessToken)}catch{return null}}}Fo.GITHUB_SIGN_IN_METHOD="github.com";Fo.PROVIDER_ID="github.com";class Go extends Ep{constructor(){super("twitter.com")}static credential(e,t){return xc._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Go.credential(t,r)}catch{return null}}}Go.TWITTER_SIGN_IN_METHOD="twitter.com";Go.PROVIDER_ID="twitter.com";async function hU(n,e){return wp(n,"POST","/v1/accounts:signUp",Xs(n,e))}class _c{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await da._fromIdTokenResponse(e,r,i),o=eI(r);return new _c({user:a,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=eI(r);return new _c({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function eI(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class N0 extends Ks{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,N0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new N0(e,t,r,i)}}function uM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?N0._fromErrorAndOperation(n,a,e,r):a})}async function pU(n,e,t=!1){const r=await ld(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return _c._forOperation(n,"link",r)}async function dM(n,e,t=!1){const{auth:r}=n;if(zi(r.app))return Promise.reject(Ms(r));const i="reauthenticate";try{const a=await ld(n,uM(r,i,e,n),t);nt(a.idToken,r,"internal-error");const o=bw(a.idToken);nt(o,r,"internal-error");const{sub:c}=o;return nt(n.uid===c,r,"user-mismatch"),_c._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ma(r,"user-mismatch"),a}}async function fM(n,e,t=!1){if(zi(n.app))return Promise.reject(Ms(n));const r="signIn",i=await uM(n,r,e),a=await _c._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function gU(n,e){return fM(hl(n),e)}async function mU(n,e){return dM(dn(n),e)}async function hM(n){const e=hl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function vU(n,e,t){const r=hl(n);await k0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",oU)}async function yU(n,e,t){if(zi(n.app))return Promise.reject(Ms(n));const r=hl(n),o=await k0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",hU).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&hM(n),u}),c=await _c._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function bU(n,e,t){return zi(n.app)?Promise.reject(Ms(n)):gU(dn(n),jc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&hM(n),r})}async function tI(n,e){const t=dn(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:a}=await sU(t.auth,i);a!==n.email&&await n.reload()}async function xU(n,e){return ss(n,"POST","/v1/accounts:update",e)}async function _U(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=dn(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await ld(r,xU(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function wU(n,e,t,r){return dn(n).onIdTokenChanged(e,t,r)}function EU(n,e,t){return dn(n).beforeAuthStateChanged(e,t)}function SU(n,e,t,r){return dn(n).onAuthStateChanged(e,t,r)}function nI(n){return dn(n).signOut()}async function TU(n){return dn(n).delete()}const M0="__sak";class pM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(M0,"1"),this.storage.removeItem(M0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const AU=1e3,CU=10;class gM extends pM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rM(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);L8()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,CU):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},AU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}gM.type="LOCAL";const IU=gM;class mM extends pM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}mM.type="SESSION";const vM=mM;function RU(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Av{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Av(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(t.origin,a)),u=await RU(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Av.receivers=[];function Ew(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class DU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=Ew("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Xa(){return window}function kU(n){Xa().location.href=n}function yM(){return typeof Xa().WorkerGlobalScope<"u"&&typeof Xa().importScripts=="function"}async function NU(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MU(){return navigator?.serviceWorker?.controller||null}function PU(){return yM()?self:null}const bM="firebaseLocalStorageDb",OU=1,P0="firebaseLocalStorage",xM="fbase_key";class Sp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cv(n,e){return n.transaction([P0],e?"readwrite":"readonly").objectStore(P0)}function jU(){const n=indexedDB.deleteDatabase(bM);return new Sp(n).toPromise()}function j1(){const n=indexedDB.open(bM,OU);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(P0,{keyPath:xM})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(P0)?e(r):(r.close(),await jU(),e(await j1()))})})}async function rI(n,e,t){const r=Cv(n,!0).put({[xM]:e,value:t});return new Sp(r).toPromise()}async function VU(n,e){const t=Cv(n,!1).get(e),r=await new Sp(t).toPromise();return r===void 0?null:r.value}function iI(n,e){const t=Cv(n,!0).delete(e);return new Sp(t).toPromise()}const zU=800,LU=3;class _M{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await j1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>LU)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Av._getInstance(PU()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await NU(),!this.activeServiceWorker)return;this.sender=new DU(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||MU()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await j1();return await rI(e,M0,"1"),await iI(e,M0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>rI(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>VU(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>iI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Cv(i,!1).getAll();return new Sp(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_M.type="LOCAL";const BU=_M;new _p(3e4,6e4);function UU(n,e){return e?Rs(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Sw extends _w{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return nd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return nd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function FU(n){return fM(n.auth,new Sw(n),n.bypassAuthState)}function GU(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),dM(t,new Sw(n),n.bypassAuthState)}async function qU(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),pU(t,new Sw(n),n.bypassAuthState)}class wM{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return FU;case"linkViaPopup":case"linkViaRedirect":return qU;case"reauthViaPopup":case"reauthViaRedirect":return GU;default:ma(this.auth,"internal-error")}}resolve(e){Ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ls(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const HU=new _p(2e3,1e4);class Uu extends wM{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Uu.currentPopupAction&&Uu.currentPopupAction.cancel(),Uu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){Ls(this.filter.length===1,"Popup operations only handle one event");const e=Ew();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ka(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ka(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Uu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ka(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,HU.get())};e()}}Uu.currentPopupAction=null;const $U="pendingRedirect",n0=new Map;class YU extends wM{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=n0.get(this.auth._key());if(!e){try{const r=await KU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}n0.set(this.auth._key(),e)}return this.bypassAuthState||n0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function KU(n,e){const t=QU(e),r=WU(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function XU(n,e){n0.set(n._key(),e)}function WU(n){return Rs(n._redirectPersistence)}function QU(n){return t0($U,n.config.apiKey,n.name)}async function ZU(n,e,t=!1){if(zi(n.app))return Promise.reject(Ms(n));const r=hl(n),i=UU(r,e),o=await new YU(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const JU=600*1e3;class eF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tF(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!EM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ka(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=JU&&this.cachedEventUids.clear(),this.cachedEventUids.has(aI(e))}saveEventToCache(e){this.cachedEventUids.add(aI(e)),this.lastProcessedEventTime=Date.now()}}function aI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function EM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function tF(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return EM(n);default:return!1}}async function nF(n,e={}){return ss(n,"GET","/v1/projects",e)}const rF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iF=/^https?/;async function aF(n){if(n.config.emulator)return;const{authorizedDomains:e}=await nF(n);for(const t of e)try{if(sF(t))return}catch{}ma(n,"unauthorized-domain")}function sF(n){const e=P1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!iF.test(t))return!1;if(rF.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const oF=new _p(3e4,6e4);function sI(){const n=Xa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lF(n){return new Promise((e,t)=>{function r(){sI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sI(),t(Ka(n,"network-request-failed"))},timeout:oF.get()})}if(Xa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Xa().gapi?.load)r();else{const i=K8("iframefcb");return Xa()[i]=()=>{gapi.load?r():t(Ka(n,"network-request-failed"))},aM(`${Y8()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw r0=null,e})}let r0=null;function cF(n){return r0=r0||lF(n),r0}const uF=new _p(5e3,15e3),dF="__/auth/iframe",fF="emulator/auth/iframe",hF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gF(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yw(e,fF):`https://${n.config.authDomain}/${dF}`,r={apiKey:e.apiKey,appName:n.name,v:Od},i=pF.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${xp(r).slice(1)}`}async function mF(n){const e=await cF(n),t=Xa().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:gF(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hF,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=Ka(n,"network-request-failed"),c=Xa().setTimeout(()=>{a(o)},uF.get());function u(){Xa().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const vF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yF=500,bF=600,xF="_blank",_F="http://localhost";class oI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wF(n,e,t,r=yF,i=bF){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...vF,width:r.toString(),height:i.toString(),top:a,left:o},d=lr().toLowerCase();t&&(c=ZN(d)?xF:t),WN(d)&&(e=e||_F,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(z8(d)&&c!=="_self")return EF(e||"",c),new oI(null);const p=window.open(e||"",c,h);nt(p,n,"popup-blocked");try{p.focus()}catch{}return new oI(p)}function EF(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const SF="__/auth/handler",TF="emulator/auth/handler",AF=encodeURIComponent("fac");async function lI(n,e,t,r,i,a){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Od,eventId:i};if(e instanceof cM){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",sB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof Ep){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${AF}=${encodeURIComponent(u)}`:"";return`${CF(n)}?${xp(c).slice(1)}${d}`}function CF({config:n}){return n.emulator?yw(n,TF):`https://${n.authDomain}/${SF}`}const Rx="webStorageSupport";class IF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vM,this._completeRedirectFn=ZU,this._overrideRedirectResult=XU}async _openPopup(e,t,r,i){Ls(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await lI(e,t,r,P1(),i);return wF(e,a,Ew())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await lI(e,t,r,P1(),i);return kU(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Ls(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await mF(e),r=new eF(e);return t.register("authEvent",i=>(nt(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rx,{type:Rx},i=>{const a=i?.[0]?.[Rx];a!==void 0&&t(!!a),ma(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=aF(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rM()||QN()||xw()}}const RF=IF;var cI="@firebase/auth",uI="1.11.1";class DF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function kF(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function NF(n){od(new bc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;nt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iM(n)},d=new q8(r,i,a,u);return eU(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),od(new bc("auth-internal",e=>{const t=hl(e.getProvider("auth").getImmediate());return(r=>new DF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qo(cI,uI,kF(n)),Qo(cI,uI,"esm2020")}const MF=300,PF=RN("authIdTokenMaxAge")||MF;let dI=null;const OF=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>PF)return;const i=t?.token;dI!==i&&(dI=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function jF(n=LN()){const e=mw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=J8(n,{popupRedirectResolver:RF,persistence:[BU,IU,vM]}),r=RN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=OF(a.toString());EU(t,o,()=>o(t.currentUser)),wU(t,c=>o(c))}}const i=CN("auth");return i&&tU(t,`http://${i}`),t}function VF(){return document.getElementsByTagName("head")?.[0]??document}H8({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=Ka("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",VF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});NF("Browser");var zF="firebase",LF="12.6.0";Qo(zF,LF,"app");var fI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Zo,SM;(function(){var n;function e(C,I){function k(){}k.prototype=I.prototype,C.F=I.prototype,C.prototype=new k,C.prototype.constructor=C,C.D=function(z,L,B){for(var O=Array(arguments.length-2),J=2;J<arguments.length;J++)O[J-2]=arguments[J];return I.prototype[L].apply(z,O)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,I,k){k||(k=0);const z=Array(16);if(typeof I=="string")for(var L=0;L<16;++L)z[L]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(L=0;L<16;++L)z[L]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=C.g[0],k=C.g[1],L=C.g[2];let B=C.g[3],O;O=I+(B^k&(L^B))+z[0]+3614090360&4294967295,I=k+(O<<7&4294967295|O>>>25),O=B+(L^I&(k^L))+z[1]+3905402710&4294967295,B=I+(O<<12&4294967295|O>>>20),O=L+(k^B&(I^k))+z[2]+606105819&4294967295,L=B+(O<<17&4294967295|O>>>15),O=k+(I^L&(B^I))+z[3]+3250441966&4294967295,k=L+(O<<22&4294967295|O>>>10),O=I+(B^k&(L^B))+z[4]+4118548399&4294967295,I=k+(O<<7&4294967295|O>>>25),O=B+(L^I&(k^L))+z[5]+1200080426&4294967295,B=I+(O<<12&4294967295|O>>>20),O=L+(k^B&(I^k))+z[6]+2821735955&4294967295,L=B+(O<<17&4294967295|O>>>15),O=k+(I^L&(B^I))+z[7]+4249261313&4294967295,k=L+(O<<22&4294967295|O>>>10),O=I+(B^k&(L^B))+z[8]+1770035416&4294967295,I=k+(O<<7&4294967295|O>>>25),O=B+(L^I&(k^L))+z[9]+2336552879&4294967295,B=I+(O<<12&4294967295|O>>>20),O=L+(k^B&(I^k))+z[10]+4294925233&4294967295,L=B+(O<<17&4294967295|O>>>15),O=k+(I^L&(B^I))+z[11]+2304563134&4294967295,k=L+(O<<22&4294967295|O>>>10),O=I+(B^k&(L^B))+z[12]+1804603682&4294967295,I=k+(O<<7&4294967295|O>>>25),O=B+(L^I&(k^L))+z[13]+4254626195&4294967295,B=I+(O<<12&4294967295|O>>>20),O=L+(k^B&(I^k))+z[14]+2792965006&4294967295,L=B+(O<<17&4294967295|O>>>15),O=k+(I^L&(B^I))+z[15]+1236535329&4294967295,k=L+(O<<22&4294967295|O>>>10),O=I+(L^B&(k^L))+z[1]+4129170786&4294967295,I=k+(O<<5&4294967295|O>>>27),O=B+(k^L&(I^k))+z[6]+3225465664&4294967295,B=I+(O<<9&4294967295|O>>>23),O=L+(I^k&(B^I))+z[11]+643717713&4294967295,L=B+(O<<14&4294967295|O>>>18),O=k+(B^I&(L^B))+z[0]+3921069994&4294967295,k=L+(O<<20&4294967295|O>>>12),O=I+(L^B&(k^L))+z[5]+3593408605&4294967295,I=k+(O<<5&4294967295|O>>>27),O=B+(k^L&(I^k))+z[10]+38016083&4294967295,B=I+(O<<9&4294967295|O>>>23),O=L+(I^k&(B^I))+z[15]+3634488961&4294967295,L=B+(O<<14&4294967295|O>>>18),O=k+(B^I&(L^B))+z[4]+3889429448&4294967295,k=L+(O<<20&4294967295|O>>>12),O=I+(L^B&(k^L))+z[9]+568446438&4294967295,I=k+(O<<5&4294967295|O>>>27),O=B+(k^L&(I^k))+z[14]+3275163606&4294967295,B=I+(O<<9&4294967295|O>>>23),O=L+(I^k&(B^I))+z[3]+4107603335&4294967295,L=B+(O<<14&4294967295|O>>>18),O=k+(B^I&(L^B))+z[8]+1163531501&4294967295,k=L+(O<<20&4294967295|O>>>12),O=I+(L^B&(k^L))+z[13]+2850285829&4294967295,I=k+(O<<5&4294967295|O>>>27),O=B+(k^L&(I^k))+z[2]+4243563512&4294967295,B=I+(O<<9&4294967295|O>>>23),O=L+(I^k&(B^I))+z[7]+1735328473&4294967295,L=B+(O<<14&4294967295|O>>>18),O=k+(B^I&(L^B))+z[12]+2368359562&4294967295,k=L+(O<<20&4294967295|O>>>12),O=I+(k^L^B)+z[5]+4294588738&4294967295,I=k+(O<<4&4294967295|O>>>28),O=B+(I^k^L)+z[8]+2272392833&4294967295,B=I+(O<<11&4294967295|O>>>21),O=L+(B^I^k)+z[11]+1839030562&4294967295,L=B+(O<<16&4294967295|O>>>16),O=k+(L^B^I)+z[14]+4259657740&4294967295,k=L+(O<<23&4294967295|O>>>9),O=I+(k^L^B)+z[1]+2763975236&4294967295,I=k+(O<<4&4294967295|O>>>28),O=B+(I^k^L)+z[4]+1272893353&4294967295,B=I+(O<<11&4294967295|O>>>21),O=L+(B^I^k)+z[7]+4139469664&4294967295,L=B+(O<<16&4294967295|O>>>16),O=k+(L^B^I)+z[10]+3200236656&4294967295,k=L+(O<<23&4294967295|O>>>9),O=I+(k^L^B)+z[13]+681279174&4294967295,I=k+(O<<4&4294967295|O>>>28),O=B+(I^k^L)+z[0]+3936430074&4294967295,B=I+(O<<11&4294967295|O>>>21),O=L+(B^I^k)+z[3]+3572445317&4294967295,L=B+(O<<16&4294967295|O>>>16),O=k+(L^B^I)+z[6]+76029189&4294967295,k=L+(O<<23&4294967295|O>>>9),O=I+(k^L^B)+z[9]+3654602809&4294967295,I=k+(O<<4&4294967295|O>>>28),O=B+(I^k^L)+z[12]+3873151461&4294967295,B=I+(O<<11&4294967295|O>>>21),O=L+(B^I^k)+z[15]+530742520&4294967295,L=B+(O<<16&4294967295|O>>>16),O=k+(L^B^I)+z[2]+3299628645&4294967295,k=L+(O<<23&4294967295|O>>>9),O=I+(L^(k|~B))+z[0]+4096336452&4294967295,I=k+(O<<6&4294967295|O>>>26),O=B+(k^(I|~L))+z[7]+1126891415&4294967295,B=I+(O<<10&4294967295|O>>>22),O=L+(I^(B|~k))+z[14]+2878612391&4294967295,L=B+(O<<15&4294967295|O>>>17),O=k+(B^(L|~I))+z[5]+4237533241&4294967295,k=L+(O<<21&4294967295|O>>>11),O=I+(L^(k|~B))+z[12]+1700485571&4294967295,I=k+(O<<6&4294967295|O>>>26),O=B+(k^(I|~L))+z[3]+2399980690&4294967295,B=I+(O<<10&4294967295|O>>>22),O=L+(I^(B|~k))+z[10]+4293915773&4294967295,L=B+(O<<15&4294967295|O>>>17),O=k+(B^(L|~I))+z[1]+2240044497&4294967295,k=L+(O<<21&4294967295|O>>>11),O=I+(L^(k|~B))+z[8]+1873313359&4294967295,I=k+(O<<6&4294967295|O>>>26),O=B+(k^(I|~L))+z[15]+4264355552&4294967295,B=I+(O<<10&4294967295|O>>>22),O=L+(I^(B|~k))+z[6]+2734768916&4294967295,L=B+(O<<15&4294967295|O>>>17),O=k+(B^(L|~I))+z[13]+1309151649&4294967295,k=L+(O<<21&4294967295|O>>>11),O=I+(L^(k|~B))+z[4]+4149444226&4294967295,I=k+(O<<6&4294967295|O>>>26),O=B+(k^(I|~L))+z[11]+3174756917&4294967295,B=I+(O<<10&4294967295|O>>>22),O=L+(I^(B|~k))+z[2]+718787259&4294967295,L=B+(O<<15&4294967295|O>>>17),O=k+(B^(L|~I))+z[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(L+(O<<21&4294967295|O>>>11))&4294967295,C.g[2]=C.g[2]+L&4294967295,C.g[3]=C.g[3]+B&4294967295}r.prototype.v=function(C,I){I===void 0&&(I=C.length);const k=I-this.blockSize,z=this.C;let L=this.h,B=0;for(;B<I;){if(L==0)for(;B<=k;)i(this,C,B),B+=this.blockSize;if(typeof C=="string"){for(;B<I;)if(z[L++]=C.charCodeAt(B++),L==this.blockSize){i(this,z),L=0;break}}else for(;B<I;)if(z[L++]=C[B++],L==this.blockSize){i(this,z),L=0;break}}this.h=L,this.o+=I},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;I=this.o*8;for(var k=C.length-8;k<C.length;++k)C[k]=I&255,I/=256;for(this.v(C),C=Array(16),I=0,k=0;k<4;++k)for(let z=0;z<32;z+=8)C[I++]=this.g[k]>>>z&255;return C};function a(C,I){var k=c;return Object.prototype.hasOwnProperty.call(k,C)?k[C]:k[C]=I(C)}function o(C,I){this.h=I;const k=[];let z=!0;for(let L=C.length-1;L>=0;L--){const B=C[L]|0;z&&B==I||(k[L]=B,z=!1)}this.g=k}var c={};function u(C){return-128<=C&&C<128?a(C,function(I){return new o([I|0],I<0?-1:0)}):new o([C|0],C<0?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return p;if(C<0)return S(d(-C));const I=[];let k=1;for(let z=0;C>=k;z++)I[z]=C/k|0,k*=4294967296;return new o(I,0)}function h(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return S(h(C.substring(1),I));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(I,8));let z=p;for(let B=0;B<C.length;B+=8){var L=Math.min(8,C.length-B);const O=parseInt(C.substring(B,B+L),I);L<8?(L=d(Math.pow(I,L)),z=z.j(L).add(d(O))):(z=z.j(k),z=z.add(d(O)))}return z}var p=u(0),m=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(w(this))return-S(this).m();let C=0,I=1;for(let k=0;k<this.g.length;k++){const z=this.i(k);C+=(z>=0?z:4294967296+z)*I,I*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(_(this))return"0";if(w(this))return"-"+S(this).toString(C);const I=d(Math.pow(C,6));var k=this;let z="";for(;;){const L=P(k,I).g;k=T(k,L.j(I));let B=((k.g.length>0?k.g[0]:k.h)>>>0).toString(C);if(k=L,_(k))return B+z;for(;B.length<6;)B="0"+B;z=B+z}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function _(C){if(C.h!=0)return!1;for(let I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function w(C){return C.h==-1}n.l=function(C){return C=T(this,C),w(C)?-1:_(C)?0:1};function S(C){const I=C.g.length,k=[];for(let z=0;z<I;z++)k[z]=~C.g[z];return new o(k,~C.h).add(m)}n.abs=function(){return w(this)?S(this):this},n.add=function(C){const I=Math.max(this.g.length,C.g.length),k=[];let z=0;for(let L=0;L<=I;L++){let B=z+(this.i(L)&65535)+(C.i(L)&65535),O=(B>>>16)+(this.i(L)>>>16)+(C.i(L)>>>16);z=O>>>16,B&=65535,O&=65535,k[L]=O<<16|B}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(C,I){return C.add(S(I))}n.j=function(C){if(_(this)||_(C))return p;if(w(this))return w(C)?S(this).j(S(C)):S(S(this).j(C));if(w(C))return S(this.j(S(C)));if(this.l(b)<0&&C.l(b)<0)return d(this.m()*C.m());const I=this.g.length+C.g.length,k=[];for(var z=0;z<2*I;z++)k[z]=0;for(z=0;z<this.g.length;z++)for(let L=0;L<C.g.length;L++){const B=this.i(z)>>>16,O=this.i(z)&65535,J=C.i(L)>>>16,K=C.i(L)&65535;k[2*z+2*L]+=O*K,A(k,2*z+2*L),k[2*z+2*L+1]+=B*K,A(k,2*z+2*L+1),k[2*z+2*L+1]+=O*J,A(k,2*z+2*L+1),k[2*z+2*L+2]+=B*J,A(k,2*z+2*L+2)}for(C=0;C<I;C++)k[C]=k[2*C+1]<<16|k[2*C];for(C=I;C<2*I;C++)k[C]=0;return new o(k,0)};function A(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function D(C,I){this.g=C,this.h=I}function P(C,I){if(_(I))throw Error("division by zero");if(_(C))return new D(p,p);if(w(C))return I=P(S(C),I),new D(S(I.g),S(I.h));if(w(I))return I=P(C,S(I)),new D(S(I.g),I.h);if(C.g.length>30){if(w(C)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var k=m,z=I;z.l(C)<=0;)k=M(k),z=M(z);var L=V(k,1),B=V(z,1);for(z=V(z,2),k=V(k,2);!_(z);){var O=B.add(z);O.l(C)<=0&&(L=L.add(k),B=O),z=V(z,1),k=V(k,1)}return I=T(C,L.j(I)),new D(L,I)}for(L=p;C.l(I)>=0;){for(k=Math.max(1,Math.floor(C.m()/I.m())),z=Math.ceil(Math.log(k)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),B=d(k),O=B.j(I);w(O)||O.l(C)>0;)k-=z,B=d(k),O=B.j(I);_(B)&&(B=m),L=L.add(B),C=T(C,O)}return new D(L,C)}n.B=function(C){return P(this,C).h},n.and=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)&C.i(z);return new o(k,this.h&C.h)},n.or=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)|C.i(z);return new o(k,this.h|C.h)},n.xor=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let z=0;z<I;z++)k[z]=this.i(z)^C.i(z);return new o(k,this.h^C.h)};function M(C){const I=C.g.length+1,k=[];for(let z=0;z<I;z++)k[z]=C.i(z)<<1|C.i(z-1)>>>31;return new o(k,C.h)}function V(C,I){const k=I>>5;I%=32;const z=C.g.length-k,L=[];for(let B=0;B<z;B++)L[B]=I>0?C.i(B+k)>>>I|C.i(B+k+1)<<32-I:C.i(B+k);return new o(L,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,SM=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Zo=o}).apply(typeof fI<"u"?fI:typeof self<"u"?self:typeof window<"u"?window:{});var Cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var TM,ah,AM,i0,V1,CM,IM,RM;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cm=="object"&&Cm];for(var R=0;R<y.length;++R){var j=y[R];if(j&&j.Math==Math)return j}throw Error("Cannot find global object")}var r=t(this);function i(y,R){if(R)e:{var j=r;y=y.split(".");for(var q=0;q<y.length-1;q++){var se=y[q];if(!(se in j))break e;j=j[se]}y=y[y.length-1],q=j[y],R=R(q),R!=q&&R!=null&&e(j,y,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(R){var j=[],q;for(q in R)Object.prototype.hasOwnProperty.call(R,q)&&j.push([q,R[q]]);return j}});var a=a||{},o=this||self;function c(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function u(y,R,j){return y.call.apply(y.bind,arguments)}function d(y,R,j){return d=u,d.apply(null,arguments)}function h(y,R){var j=Array.prototype.slice.call(arguments,1);return function(){var q=j.slice();return q.push.apply(q,arguments),y.apply(this,q)}}function p(y,R){function j(){}j.prototype=R.prototype,y.Z=R.prototype,y.prototype=new j,y.prototype.constructor=y,y.Ob=function(q,se,pe){for(var Re=Array(arguments.length-2),ht=2;ht<arguments.length;ht++)Re[ht-2]=arguments[ht];return R.prototype[se].apply(q,Re)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const R=y.length;if(R>0){const j=Array(R);for(let q=0;q<R;q++)j[q]=y[q];return j}return[]}function _(y,R){for(let q=1;q<arguments.length;q++){const se=arguments[q];var j=typeof se;if(j=j!="object"?j:se?Array.isArray(se)?"array":j:"null",j=="array"||j=="object"&&typeof se.length=="number"){j=y.length||0;const pe=se.length||0;y.length=j+pe;for(let Re=0;Re<pe;Re++)y[j+Re]=se[Re]}else y.push(se)}}class w{constructor(R,j){this.i=R,this.j=j,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function S(y){o.setTimeout(()=>{throw y},0)}function T(){var y=C;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class A{constructor(){this.h=this.g=null}add(R,j){const q=D.get();q.set(R,j),this.h?this.h.next=q:this.g=q,this.h=q}}var D=new w(()=>new P,y=>y.reset());class P{constructor(){this.next=this.g=this.h=null}set(R,j){this.h=R,this.g=j,this.next=null}reset(){this.next=this.g=this.h=null}}let M,V=!1,C=new A,I=()=>{const y=Promise.resolve(void 0);M=()=>{y.then(k)}};function k(){for(var y;y=T();){try{y.h.call(y.g)}catch(j){S(j)}var R=D;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}V=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const j=()=>{};o.addEventListener("test",j,R),o.removeEventListener("test",j,R)}catch{}return y})();function O(y){return/^[\s\xa0]*$/.test(y)}function J(y,R){L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}p(J,L),J.prototype.init=function(y,R){const j=this.type=y.type,q=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(j=="mouseover"?R=y.fromElement:j=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&J.Z.h.call(this)},J.prototype.h=function(){J.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),H=0;function Z(y,R,j,q,se){this.listener=y,this.proxy=null,this.src=R,this.type=j,this.capture=!!q,this.ha=se,this.key=++H,this.da=this.fa=!1}function ne(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ue(y,R,j){for(const q in y)R.call(j,y[q],q,y)}function Y(y,R){for(const j in y)R.call(void 0,y[j],j,y)}function G(y){const R={};for(const j in y)R[j]=y[j];return R}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function re(y,R){let j,q;for(let se=1;se<arguments.length;se++){q=arguments[se];for(j in q)y[j]=q[j];for(let pe=0;pe<$.length;pe++)j=$[pe],Object.prototype.hasOwnProperty.call(q,j)&&(y[j]=q[j])}}function W(y){this.src=y,this.g={},this.h=0}W.prototype.add=function(y,R,j,q,se){const pe=y.toString();y=this.g[pe],y||(y=this.g[pe]=[],this.h++);const Re=he(y,R,q,se);return Re>-1?(R=y[Re],j||(R.fa=!1)):(R=new Z(R,this.src,pe,!!q,se),R.fa=j,y.push(R)),R};function oe(y,R){const j=R.type;if(j in y.g){var q=y.g[j],se=Array.prototype.indexOf.call(q,R,void 0),pe;(pe=se>=0)&&Array.prototype.splice.call(q,se,1),pe&&(ne(R),y.g[j].length==0&&(delete y.g[j],y.h--))}}function he(y,R,j,q){for(let se=0;se<y.length;++se){const pe=y[se];if(!pe.da&&pe.listener==R&&pe.capture==!!j&&pe.ha==q)return se}return-1}var ye="closure_lm_"+(Math.random()*1e6|0),Te={};function Me(y,R,j,q,se){if(Array.isArray(R)){for(let pe=0;pe<R.length;pe++)Me(y,R[pe],j,q,se);return null}return j=Oe(j),y&&y[K]?y.J(R,j,c(q)?!!q.capture:!1,se):We(y,R,j,!1,q,se)}function We(y,R,j,q,se,pe){if(!R)throw Error("Invalid event type");const Re=c(se)?!!se.capture:!!se;let ht=Ue(y);if(ht||(y[ye]=ht=new W(y)),j=ht.add(R,j,q,Re,pe),j.proxy)return j;if(q=de(),j.proxy=q,q.src=y,q.listener=j,y.addEventListener)B||(se=Re),se===void 0&&(se=!1),y.addEventListener(R.toString(),q,se);else if(y.attachEvent)y.attachEvent(Pe(R.toString()),q);else if(y.addListener&&y.removeListener)y.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return j}function de(){function y(j){return R.call(y.src,y.listener,j)}const R=Ge;return y}function Se(y,R,j,q,se){if(Array.isArray(R))for(var pe=0;pe<R.length;pe++)Se(y,R[pe],j,q,se);else q=c(q)?!!q.capture:!!q,j=Oe(j),y&&y[K]?(y=y.i,pe=String(R).toString(),pe in y.g&&(R=y.g[pe],j=he(R,j,q,se),j>-1&&(ne(R[j]),Array.prototype.splice.call(R,j,1),R.length==0&&(delete y.g[pe],y.h--)))):y&&(y=Ue(y))&&(R=y.g[R.toString()],y=-1,R&&(y=he(R,j,q,se)),(j=y>-1?R[y]:null)&&Be(j))}function Be(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[K])oe(R.i,y);else{var j=y.type,q=y.proxy;R.removeEventListener?R.removeEventListener(j,q,y.capture):R.detachEvent?R.detachEvent(Pe(j),q):R.addListener&&R.removeListener&&R.removeListener(q),(j=Ue(R))?(oe(j,y),j.h==0&&(j.src=null,R[ye]=null)):ne(y)}}}function Pe(y){return y in Te?Te[y]:Te[y]="on"+y}function Ge(y,R){if(y.da)y=!0;else{R=new J(R,this);const j=y.listener,q=y.ha||y.src;y.fa&&Be(y),y=j.call(q,R)}return y}function Ue(y){return y=y[ye],y instanceof W?y:null}var we="__closure_events_fn_"+(Math.random()*1e9>>>0);function Oe(y){return typeof y=="function"?y:(y[we]||(y[we]=function(R){return y.handleEvent(R)}),y[we])}function ke(){z.call(this),this.i=new W(this),this.M=this,this.G=null}p(ke,z),ke.prototype[K]=!0,ke.prototype.removeEventListener=function(y,R,j,q){Se(this,y,R,j,q)};function Ve(y,R){var j,q=y.G;if(q)for(j=[];q;q=q.G)j.push(q);if(y=y.M,q=R.type||R,typeof R=="string")R=new L(R,y);else if(R instanceof L)R.target=R.target||y;else{var se=R;R=new L(q,y),re(R,se)}se=!0;let pe,Re;if(j)for(Re=j.length-1;Re>=0;Re--)pe=R.g=j[Re],se=et(pe,q,!0,R)&&se;if(pe=R.g=y,se=et(pe,q,!0,R)&&se,se=et(pe,q,!1,R)&&se,j)for(Re=0;Re<j.length;Re++)pe=R.g=j[Re],se=et(pe,q,!1,R)&&se}ke.prototype.N=function(){if(ke.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const j=y.g[R];for(let q=0;q<j.length;q++)ne(j[q]);delete y.g[R],y.h--}}this.G=null},ke.prototype.J=function(y,R,j,q){return this.i.add(String(y),R,!1,j,q)},ke.prototype.K=function(y,R,j,q){return this.i.add(String(y),R,!0,j,q)};function et(y,R,j,q){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let se=!0;for(let pe=0;pe<R.length;++pe){const Re=R[pe];if(Re&&!Re.da&&Re.capture==j){const ht=Re.listener,Pn=Re.ha||Re.src;Re.fa&&oe(y.i,Re),se=ht.call(Pn,q)!==!1&&se}}return se&&!q.defaultPrevented}function Tt(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:o.setTimeout(y,R||0)}function Qe(y){y.g=Tt(()=>{y.g=null,y.i&&(y.i=!1,Qe(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class ct extends z{constructor(R,j){super(),this.m=R,this.l=j,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Qe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(y){z.call(this),this.h=y,this.g={}}p(Mt,z);var an=[];function zt(y){ue(y.g,function(R,j){this.g.hasOwnProperty(j)&&Be(R)},y),y.g={}}Mt.prototype.N=function(){Mt.Z.N.call(this),zt(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yn=o.JSON.stringify,Tr=o.JSON.parse,_i=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Xi(){}function _a(){}var Or={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Tn(){L.call(this,"d")}p(Tn,L);function ur(){L.call(this,"c")}p(ur,L);var Ne={},wt=null;function An(){return wt=wt||new ke}Ne.Ia="serverreachability";function ut(y){L.call(this,Ne.Ia,y)}p(ut,L);function tt(y){const R=An();Ve(R,new ut(R))}Ne.STAT_EVENT="statevent";function Pt(y,R){L.call(this,Ne.STAT_EVENT,y),this.stat=R}p(Pt,L);function Dt(y){const R=An();Ve(R,new Pt(R,y))}Ne.Ja="timingevent";function Gt(y,R){L.call(this,Ne.Ja,y),this.size=R}p(Gt,L);function _t(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},R)}function ft(){this.g=!0}ft.prototype.ua=function(){this.g=!1};function bn(y,R,j,q,se,pe){y.info(function(){if(y.g)if(pe){var Re="",ht=pe.split("&");for(let Lt=0;Lt<ht.length;Lt++){var Pn=ht[Lt].split("=");if(Pn.length>1){const fn=Pn[0];Pn=Pn[1];const Ti=fn.split("_");Re=Ti.length>=2&&Ti[1]=="type"?Re+(fn+"="+Pn+"&"):Re+(fn+"=redacted&")}}}else Re=null;else Re=pe;return"XMLHTTP REQ ("+q+") [attempt "+se+"]: "+R+`
`+j+`
`+Re})}function Xt(y,R,j,q,se,pe,Re){y.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+se+"]: "+R+`
`+j+`
`+pe+" "+Re})}function Wt(y,R,j,q){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+xn(y,j)+(q?" "+q:"")})}function bt(y,R){y.info(function(){return"TIMEOUT: "+R})}ft.prototype.info=function(){};function xn(y,R){if(!y.g)return R;if(!R)return null;try{const pe=JSON.parse(R);if(pe){for(y=0;y<pe.length;y++)if(Array.isArray(pe[y])){var j=pe[y];if(!(j.length<2)){var q=j[1];if(Array.isArray(q)&&!(q.length<1)){var se=q[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Re=1;Re<q.length;Re++)q[Re]=""}}}}return yn(pe)}catch{return R}}var Mn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Wi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},jr;function Vr(){}p(Vr,Xi),Vr.prototype.g=function(){return new XMLHttpRequest},jr=new Vr;function tr(y){return encodeURIComponent(String(y))}function tg(y){var R=1;y=y.split(":");const j=[];for(;R>0&&y.length;)j.push(y.shift()),R--;return y.length&&j.push(y.join(":")),j}function Qi(y,R,j,q){this.j=y,this.i=R,this.l=j,this.S=q||1,this.V=new Mt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Zi}function Zi(){this.i=null,this.g="",this.h=!1}var Bn={},dr={};function wa(y,R,j){y.M=1,y.A=bl(Fn(R)),y.u=j,y.R=!0,Fc(y,null)}function Fc(y,R){y.F=Date.now(),Ea(y),y.B=Fn(y.A);var j=y.B,q=y.S;Array.isArray(q)||(q=[String(q)]),$c(j.i,"t",q),y.C=0,j=y.j.L,y.h=new Zi,y.g=mg(y.j,j?R:null,!y.u),y.P>0&&(y.O=new ct(d(y.Y,y,y.g),y.P)),R=y.V,j=y.g,q=y.ba;var se="readystatechange";Array.isArray(se)||(se&&(an[0]=se.toString()),se=an);for(let pe=0;pe<se.length;pe++){const Re=Me(j,se[pe],q||R.handleEvent,!1,R.h||R);if(!Re)break;R.g[Re.key]=Re}R=y.J?G(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),tt(),bn(y.i,y.v,y.B,y.l,y.S,y.u)}Qi.prototype.ba=function(y){y=y.target;const R=this.O;R&&ta(y)==3?R.j():this.Y(y)},Qi.prototype.Y=function(y){try{if(y==this.g)e:{const ht=ta(this.g),Pn=this.g.ya(),Lt=this.g.ca();if(!(ht<3)&&(ht!=3||this.g&&(this.h.h||this.g.la()||gr(this.g)))){this.K||ht!=4||Pn==7||(Pn==8||Lt<=0?tt(3):tt(2)),Sa(this);var R=this.g.ca();this.X=R;var j=by(this);if(this.o=R==200,Xt(this.i,this.v,this.B,this.l,this.S,ht,R),this.o){if(this.U&&!this.L){t:{if(this.g){var q,se=this.g;if((q=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(q)){var pe=q;break t}}pe=null}if(y=pe)Wt(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ta(this,y);else{this.o=!1,this.m=3,Dt(12),li(this),wi(this);break e}}if(this.R){y=!0;let fn;for(;!this.K&&this.C<j.length;)if(fn=rg(this,j),fn==dr){ht==4&&(this.m=4,Dt(14),y=!1),Wt(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==Bn){this.m=4,Dt(15),Wt(this.i,this.l,j,"[Invalid Chunk]"),y=!1;break}else Wt(this.i,this.l,fn,null),Ta(this,fn);if(ng(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ht!=4||j.length!=0||this.h.h||(this.m=1,Dt(16),y=!1),this.o=this.o&&y,!y)Wt(this.i,this.l,j,"[Invalid Chunked Response]"),li(this),wi(this);else if(j.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),uf(Re),Re.P=!0,Dt(11))}}else Wt(this.i,this.l,j,null),Ta(this,j);ht==4&&li(this),this.o&&!this.K&&(ht==4?fg(this.j,this):(this.o=!1,Ea(this)))}else cs(this.g),R==400&&j.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),li(this),wi(this)}}}catch{}finally{}};function by(y){if(!ng(y))return y.g.la();const R=gr(y.g);if(R==="")return"";let j="";const q=R.length,se=ta(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return li(y),wi(y),"";y.h.i=new o.TextDecoder}for(let pe=0;pe<q;pe++)y.h.h=!0,j+=y.h.i.decode(R[pe],{stream:!(se&&pe==q-1)});return R.length=0,y.h.g+=j,y.C=0,y.h.g}function ng(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function rg(y,R){var j=y.C,q=R.indexOf(`
`,j);return q==-1?dr:(j=Number(R.substring(j,q)),isNaN(j)?Bn:(q+=1,q+j>R.length?dr:(R=R.slice(q,q+j),y.C=q+j,R)))}Qi.prototype.cancel=function(){this.K=!0,li(this)};function Ea(y){y.T=Date.now()+y.H,Gc(y,y.H)}function Gc(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=_t(d(y.aa,y),R)}function Sa(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Qi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(bt(this.i,this.B),this.M!=2&&(tt(),Dt(17)),li(this),this.m=2,wi(this)):Gc(this,this.T-y)};function wi(y){y.j.I==0||y.K||fg(y.j,y)}function li(y){Sa(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,zt(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function Ta(y,R){try{var j=y.j;if(j.I!=0&&(j.g==y||Ca(j.h,y))){if(!y.L&&Ca(j.h,y)&&j.I==3){try{var q=j.Ba.g.parse(R)}catch{q=null}if(Array.isArray(q)&&q.length==3){var se=q;if(se[0]==0){e:if(!j.v){if(j.g)if(j.g.F+3e3<y.F)Qc(j),so(j);else break e;Al(j),Dt(18)}}else j.xa=se[1],0<j.xa-j.K&&se[2]<37500&&j.F&&j.A==0&&!j.C&&(j.C=_t(d(j.Va,j),6e3));Aa(j.h)<=1&&j.ta&&(j.ta=void 0)}else Ma(j,11)}else if((y.L||j.g==y)&&Qc(j),!O(R))for(se=j.Ba.g.parse(R),R=0;R<se.length;R++){let Lt=se[R];const fn=Lt[0];if(!(fn<=j.K))if(j.K=fn,Lt=Lt[1],j.I==2)if(Lt[0]=="c"){j.M=Lt[1],j.ba=Lt[2];const Ti=Lt[3];Ti!=null&&(j.ka=Ti,j.j.info("VER="+j.ka));const Pa=Lt[4];Pa!=null&&(j.za=Pa,j.j.info("SVER="+j.za));const na=Lt[5];na!=null&&typeof na=="number"&&na>0&&(q=1.5*na,j.O=q,j.j.info("backChannelRequestTimeoutMs_="+q)),q=j;const ra=y.g;if(ra){const Cl=ra.g?ra.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cl){var pe=q.h;pe.g||Cl.indexOf("spdy")==-1&&Cl.indexOf("quic")==-1&&Cl.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Qd(pe,pe.h),pe.h=null))}if(q.G){const Zc=ra.g?ra.g.getResponseHeader("X-HTTP-Session-Id"):null;Zc&&(q.wa=Zc,qt(q.J,q.G,Zc))}}j.I=3,j.l&&j.l.ra(),j.aa&&(j.T=Date.now()-y.F,j.j.info("Handshake RTT: "+j.T+"ms")),q=j;var Re=y;if(q.na=gg(q,q.L?q.ba:null,q.W),Re.L){Zd(q.h,Re);var ht=Re,Pn=q.O;Pn&&(ht.H=Pn),ht.D&&(Sa(ht),Ea(ht)),q.g=Re}else ug(q);j.i.length>0&&Na(j)}else Lt[0]!="stop"&&Lt[0]!="close"||Ma(j,7);else j.I==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?Ma(j,7):lf(j):Lt[0]!="noop"&&j.l&&j.l.qa(Lt),j.A=0)}}tt(4)}catch{}}var Un=class{constructor(y,R){this.g=y,this.map=R}};function Xd(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Wd(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Aa(y){return y.h?1:y.g?y.g.size:0}function Ca(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function Qd(y,R){y.g?y.g.add(R):y.h=R}function Zd(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}Xd.prototype.cancel=function(){if(this.i=Jd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Jd(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const j of y.g.values())R=R.concat(j.G);return R}return b(y.i)}var ig=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qc(y,R){if(y){y=y.split("&");for(let j=0;j<y.length;j++){const q=y[j].indexOf("=");let se,pe=null;q>=0?(se=y[j].substring(0,q),pe=y[j].substring(q+1)):se=y[j],R(se,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function ci(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof ci?(this.l=y.l,fr(this,y.j),this.o=y.o,this.g=y.g,Js(this,y.u),this.h=y.h,ef(this,lg(y.i)),this.m=y.m):y&&(R=String(y).match(ig))?(this.l=!1,fr(this,R[1]||"",!0),this.o=Ia(R[2]||""),this.g=Ia(R[3]||"",!0),Js(this,R[4]),this.h=Ia(R[5]||"",!0),ef(this,R[6]||"",!0),this.m=Ia(R[7]||"")):(this.l=!1,this.i=new to(null,this.l))}ci.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(xl(R,Hc,!0),":");var j=this.g;return(j||R=="file")&&(y.push("//"),(R=this.o)&&y.push(xl(R,Hc,!0),"@"),y.push(tr(j).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j=this.u,j!=null&&y.push(":",String(j))),(j=this.h)&&(this.g&&j.charAt(0)!="/"&&y.push("/"),y.push(xl(j,j.charAt(0)=="/"?tf:ag,!0))),(j=this.i.toString())&&y.push("?",j),(j=this.m)&&y.push("#",xl(j,sg)),y.join("")},ci.prototype.resolve=function(y){const R=Fn(this);let j=!!y.j;j?fr(R,y.j):j=!!y.o,j?R.o=y.o:j=!!y.g,j?R.g=y.g:j=y.u!=null;var q=y.h;if(j)Js(R,y.u);else if(j=!!y.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var se=R.h.lastIndexOf("/");se!=-1&&(q=R.h.slice(0,se+1)+q)}if(se=q,se==".."||se==".")q="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){q=se.lastIndexOf("/",0)==0,se=se.split("/");const pe=[];for(let Re=0;Re<se.length;){const ht=se[Re++];ht=="."?q&&Re==se.length&&pe.push(""):ht==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),q&&Re==se.length&&pe.push("")):(pe.push(ht),q=!0)}q=pe.join("/")}else q=se}return j?R.h=q:j=y.i.toString()!=="",j?ef(R,lg(y.i)):j=!!y.m,j&&(R.m=y.m),R};function Fn(y){return new ci(y)}function fr(y,R,j){y.j=j?Ia(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function Js(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function ef(y,R,j){R instanceof to?(y.i=R,Yc(y.i,y.l)):(j||(R=xl(R,eo)),y.i=new to(R,y.l))}function qt(y,R,j){y.i.set(R,j)}function bl(y){return qt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Ia(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function xl(y,R,j){return typeof y=="string"?(y=encodeURI(y).replace(R,Yr),j&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Yr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Hc=/[#\/\?@]/g,ag=/[#\?:]/g,tf=/[#\?]/g,eo=/[#\?@]/g,sg=/#/g;function to(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Kr(y){y.g||(y.g=new Map,y.h=0,y.i&&qc(y.i,function(R,j){y.add(decodeURIComponent(R.replace(/\+/g," ")),j)}))}n=to.prototype,n.add=function(y,R){Kr(this),this.i=null,y=no(this,y);let j=this.g.get(y);return j||this.g.set(y,j=[]),j.push(R),this.h+=1,this};function og(y,R){Kr(y),R=no(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function nf(y,R){return Kr(y),R=no(y,R),y.g.has(R)}n.forEach=function(y,R){Kr(this),this.g.forEach(function(j,q){j.forEach(function(se){y.call(R,se,q,this)},this)},this)};function rf(y,R){Kr(y);let j=[];if(typeof R=="string")nf(y,R)&&(j=j.concat(y.g.get(no(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)j=j.concat(y[R]);return j}n.set=function(y,R){return Kr(this),this.i=null,y=no(this,y),nf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},n.get=function(y,R){return y?(y=rf(this,y),y.length>0?String(y[0]):R):R};function $c(y,R,j){og(y,R),j.length>0&&(y.i=null,y.g.set(no(y,R),b(j)),y.h+=j.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let q=0;q<R.length;q++){var j=R[q];const se=tr(j);j=rf(this,j);for(let pe=0;pe<j.length;pe++){let Re=se;j[pe]!==""&&(Re+="="+tr(j[pe])),y.push(Re)}}return this.i=y.join("&")};function lg(y){const R=new to;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function no(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function Yc(y,R){R&&!y.j&&(Kr(y),y.i=null,y.g.forEach(function(j,q){const se=q.toLowerCase();q!=se&&(og(this,q),$c(this,se,j))},y)),y.j=R}function Ji(y,R){const j=new ft;if(o.Image){const q=new Image;q.onload=h(Ei,j,"TestLoadImage: loaded",!0,R,q),q.onerror=h(Ei,j,"TestLoadImage: error",!1,R,q),q.onabort=h(Ei,j,"TestLoadImage: abort",!1,R,q),q.ontimeout=h(Ei,j,"TestLoadImage: timeout",!1,R,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=y}else R(!1)}function af(y,R){const j=new ft,q=new AbortController,se=setTimeout(()=>{q.abort(),Ei(j,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:q.signal}).then(pe=>{clearTimeout(se),pe.ok?Ei(j,"TestPingServer: ok",!0,R):Ei(j,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(se),Ei(j,"TestPingServer: error",!1,R)})}function Ei(y,R,j,q,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),q(j)}catch{}}function ro(){this.g=new _i}function Ra(y){this.i=y.Sb||null,this.h=y.ab||!1}p(Ra,Xi),Ra.prototype.g=function(){return new _l(this.i,this.h)};function _l(y,R){ke.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(_l,ke),n=_l.prototype,n.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,ea(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||o).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,io(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,ea(this)),this.g&&(this.readyState=3,ea(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Kc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Kc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?io(this):ea(this),this.readyState==3&&Kc(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,io(this))},n.Na=function(y){this.g&&(this.response=y,io(this))},n.ga=function(){this.g&&io(this)};function io(y){y.readyState=4,y.l=null,y.j=null,y.B=null,ea(y)}n.setRequestHeader=function(y,R){this.A.append(y,R)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var j=R.next();!j.done;)j=j.value,y.push(j[0]+": "+j[1]),j=R.next();return y.join(`\r
`)};function ea(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(_l.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Si(y){let R="";return ue(y,function(j,q){R+=q,R+=":",R+=j,R+=`\r
`}),R}function wl(y,R,j){e:{for(q in j){var q=!1;break e}q=!0}q||(j=Si(j),typeof y=="string"?j!=null&&tr(j):qt(y,R,j))}function Qt(y){ke.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Qt,ke);var Da=/^https?$/i,sf=["POST","PUT"];n=Qt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,R,j,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():jr.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(pe){El(this,pe);return}if(y=j||"",j=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var se in q)j.set(se,q[se]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const pe of q.keys())j.set(pe,q.get(pe));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(j.keys()).find(pe=>pe.toLowerCase()=="content-type"),se=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(sf,R,void 0)>=0)||q||se||j.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,Re]of j)this.g.setRequestHeader(pe,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(pe){El(this,pe)}};function El(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,of(y),ls(y)}function of(y){y.A||(y.A=!0,Ve(y,"complete"),Ve(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Ve(this,"complete"),Ve(this,"abort"),ls(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ls(this,!0)),Qt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Sl(this):this.Xa())},n.Xa=function(){Sl(this)};function Sl(y){if(y.h&&typeof a<"u"){if(y.v&&ta(y)==4)setTimeout(y.Ca.bind(y),0);else if(Ve(y,"readystatechange"),ta(y)==4){y.h=!1;try{const pe=y.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var j;if(!(j=R)){var q;if(q=pe===0){let Re=String(y.D).match(ig)[1]||null;!Re&&o.self&&o.self.location&&(Re=o.self.location.protocol.slice(0,-1)),q=!Da.test(Re?Re.toLowerCase():"")}j=q}if(j)Ve(y,"complete"),Ve(y,"success");else{y.o=6;try{var se=ta(y)>2?y.g.statusText:""}catch{se=""}y.l=se+" ["+y.ca()+"]",of(y)}}finally{ls(y)}}}}function ls(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const j=y.g;y.g=null,R||Ve(y,"ready");try{j.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ta(y){return y.g?y.g.readyState:0}n.ca=function(){try{return ta(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),Tr(R)}};function gr(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function cs(y){const R={};y=(y.g&&ta(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<y.length;q++){if(O(y[q]))continue;var j=tg(y[q]);const se=j[0];if(j=j[1],typeof j!="string")continue;j=j.trim();const pe=R[se]||[];R[se]=pe,pe.push(j)}Y(R,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ka(y,R,j){return j&&j.internalChannelParams&&j.internalChannelParams[y]||R}function ao(y){this.za=0,this.i=[],this.j=new ft,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ka("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ka("baseRetryDelayMs",5e3,y),this.Za=ka("retryDelaySeedMs",1e4,y),this.Ta=ka("forwardChannelMaxRetries",2,y),this.va=ka("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Xd(y&&y.concurrentRequestLimit),this.Ba=new ro,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ao.prototype,n.ka=8,n.I=1,n.connect=function(y,R,j,q){Dt(0),this.W=y,this.H=R||{},j&&q!==void 0&&(this.H.OSID=j,this.H.OAID=q),this.F=this.X,this.J=gg(this,null,this.W),Na(this)};function lf(y){if(Xc(y),y.I==3){var R=y.V++,j=Fn(y.J);if(qt(j,"SID",y.M),qt(j,"RID",R),qt(j,"TYPE","terminate"),Tl(y,j),R=new Qi(y,y.j,R),R.M=2,R.A=bl(Fn(j)),j=!1,o.navigator&&o.navigator.sendBeacon)try{j=o.navigator.sendBeacon(R.A.toString(),"")}catch{}!j&&o.Image&&(new Image().src=R.A,j=!0),j||(R.g=mg(R.j,null),R.g.ea(R.A)),R.F=Date.now(),Ea(R)}pg(y)}function so(y){y.g&&(uf(y),y.g.cancel(),y.g=null)}function Xc(y){so(y),y.v&&(o.clearTimeout(y.v),y.v=null),Qc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function Na(y){if(!Wd(y.h)&&!y.m){y.m=!0;var R=y.Ea;M||I(),V||(M(),V=!0),C.add(R,y),y.D=0}}function Wc(y,R){return Aa(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=_t(d(y.Ea,y,R),hg(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const se=new Qi(this,this.j,y);let pe=this.o;if(this.U&&(pe?(pe=G(pe),re(pe,this.U)):pe=this.U),this.u!==null||this.R||(se.J=pe,pe=null),this.S)e:{for(var R=0,j=0;j<this.i.length;j++){t:{var q=this.i[j];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(R+=q,R>4096){R=j;break e}if(R===4096||j===this.i.length-1){R=j+1;break e}}R=1e3}else R=1e3;R=cg(this,se,R),j=Fn(this.J),qt(j,"RID",y),qt(j,"CVER",22),this.G&&qt(j,"X-HTTP-Session-Id",this.G),Tl(this,j),pe&&(this.R?R="headers="+tr(Si(pe))+"&"+R:this.u&&wl(j,this.u,pe)),Qd(this.h,se),this.Ra&&qt(j,"TYPE","init"),this.S?(qt(j,"$req",R),qt(j,"SID","null"),se.U=!0,wa(se,j,null)):wa(se,j,R),this.I=2}}else this.I==3&&(y?cf(this,y):this.i.length==0||Wd(this.h)||cf(this))};function cf(y,R){var j;R?j=R.l:j=y.V++;const q=Fn(y.J);qt(q,"SID",y.M),qt(q,"RID",j),qt(q,"AID",y.K),Tl(y,q),y.u&&y.o&&wl(q,y.u,y.o),j=new Qi(y,y.j,j,y.D+1),y.u===null&&(j.J=y.o),R&&(y.i=R.G.concat(y.i)),R=cg(y,j,1e3),j.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Qd(y.h,j),wa(j,q,R)}function Tl(y,R){y.H&&ue(y.H,function(j,q){qt(R,q,j)}),y.l&&ue({},function(j,q){qt(R,q,j)})}function cg(y,R,j){j=Math.min(y.i.length,j);const q=y.l?d(y.l.Ka,y.l,y):null;e:{var se=y.i;let ht=-1;for(;;){const Pn=["count="+j];ht==-1?j>0?(ht=se[0].g,Pn.push("ofs="+ht)):ht=0:Pn.push("ofs="+ht);let Lt=!0;for(let fn=0;fn<j;fn++){var pe=se[fn].g;const Ti=se[fn].map;if(pe-=ht,pe<0)ht=Math.max(0,se[fn].g-100),Lt=!1;else try{pe="req"+pe+"_"||"";try{var Re=Ti instanceof Map?Ti:Object.entries(Ti);for(const[Pa,na]of Re){let ra=na;c(na)&&(ra=yn(na)),Pn.push(pe+Pa+"="+encodeURIComponent(ra))}}catch(Pa){throw Pn.push(pe+"type="+encodeURIComponent("_badmap")),Pa}}catch{q&&q(Ti)}}if(Lt){Re=Pn.join("&");break e}}Re=void 0}return y=y.i.splice(0,j),R.G=y,Re}function ug(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;M||I(),V||(M(),V=!0),C.add(R,y),y.A=0}}function Al(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=_t(d(y.Da,y),hg(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,dg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=_t(d(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),so(this),dg(this))};function uf(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function dg(y){y.g=new Qi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=Fn(y.na);qt(R,"RID","rpc"),qt(R,"SID",y.M),qt(R,"AID",y.K),qt(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&qt(R,"TO",y.ia),qt(R,"TYPE","xmlhttp"),Tl(y,R),y.u&&y.o&&wl(R,y.u,y.o),y.O&&(y.g.H=y.O);var j=y.g;y=y.ba,j.M=1,j.A=bl(Fn(R)),j.u=null,j.R=!0,Fc(j,y)}n.Va=function(){this.C!=null&&(this.C=null,so(this),Al(this),Dt(19))};function Qc(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function fg(y,R){var j=null;if(y.g==R){Qc(y),uf(y),y.g=null;var q=2}else if(Ca(y.h,R))j=R.G,Zd(y.h,R),q=1;else return;if(y.I!=0){if(R.o)if(q==1){j=R.u?R.u.length:0,R=Date.now()-R.F;var se=y.D;q=An(),Ve(q,new Gt(q,j)),Na(y)}else ug(y);else if(se=R.m,se==3||se==0&&R.X>0||!(q==1&&Wc(y,R)||q==2&&Al(y)))switch(j&&j.length>0&&(R=y.h,R.i=R.i.concat(j)),se){case 1:Ma(y,5);break;case 4:Ma(y,10);break;case 3:Ma(y,6);break;default:Ma(y,2)}}}function hg(y,R){let j=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(j*=2),j*R}function Ma(y,R){if(y.j.info("Error code "+R),R==2){var j=d(y.bb,y),q=y.Ua;const se=!q;q=new ci(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||fr(q,"https"),bl(q),se?Ji(q.toString(),j):af(q.toString(),j)}else Dt(2);y.I=0,y.l&&y.l.pa(R),pg(y),Xc(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function pg(y){if(y.I=0,y.ja=[],y.l){const R=Jd(y.h);(R.length!=0||y.i.length!=0)&&(_(y.ja,R),_(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function gg(y,R,j){var q=j instanceof ci?Fn(j):new ci(j);if(q.g!="")R&&(q.g=R+"."+q.g),Js(q,q.u);else{var se=o.location;q=se.protocol,R=R?R+"."+se.hostname:se.hostname,se=+se.port;const pe=new ci(null);q&&fr(pe,q),R&&(pe.g=R),se&&Js(pe,se),j&&(pe.h=j),q=pe}return j=y.G,R=y.wa,j&&R&&qt(q,j,R),qt(q,"VER",y.ka),Tl(y,q),q}function mg(y,R,j){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new Qt(new Ra({ab:j})):new Qt(y.ma),R.Fa(y.L),R}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function vg(){}n=vg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function oo(){}oo.prototype.g=function(y,R){return new zr(y,R)};function zr(y,R){ke.call(this),this.g=new ao(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!O(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!O(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new us(this)}p(zr,ke),zr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},zr.prototype.close=function(){lf(this.g)},zr.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var j={};j.__data__=y,y=j}else this.v&&(j={},j.__data__=yn(y),y=j);R.i.push(new Un(R.Ya++,y)),R.I==3&&Na(R)},zr.prototype.N=function(){this.g.l=null,delete this.j,lf(this.g),delete this.g,zr.Z.N.call(this)};function yg(y){Tn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const j in R){y=j;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(yg,Tn);function bg(){ur.call(this),this.status=1}p(bg,ur);function us(y){this.g=y}p(us,vg),us.prototype.ra=function(){Ve(this.g,"a")},us.prototype.qa=function(y){Ve(this.g,new yg(y))},us.prototype.pa=function(y){Ve(this.g,new bg)},us.prototype.oa=function(){Ve(this.g,"b")},oo.prototype.createWebChannel=oo.prototype.g,zr.prototype.send=zr.prototype.o,zr.prototype.open=zr.prototype.m,zr.prototype.close=zr.prototype.close,RM=function(){return new oo},IM=function(){return An()},CM=Ne,V1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Mn.NO_ERROR=0,Mn.TIMEOUT=8,Mn.HTTP_ERROR=6,i0=Mn,Wi.COMPLETE="complete",AM=Wi,_a.EventType=Or,Or.OPEN="a",Or.CLOSE="b",Or.ERROR="c",Or.MESSAGE="d",ke.prototype.listen=ke.prototype.J,ah=_a,Qt.prototype.listenOnce=Qt.prototype.K,Qt.prototype.getLastError=Qt.prototype.Ha,Qt.prototype.getLastErrorCode=Qt.prototype.ya,Qt.prototype.getStatus=Qt.prototype.ca,Qt.prototype.getResponseJson=Qt.prototype.La,Qt.prototype.getResponseText=Qt.prototype.la,Qt.prototype.send=Qt.prototype.ea,Qt.prototype.setWithCredentials=Qt.prototype.Fa,TM=Qt}).apply(typeof Cm<"u"?Cm:typeof self<"u"?self:typeof window<"u"?window:{});const hI="@firebase/firestore",pI="4.9.2";class wr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wr.UNAUTHENTICATED=new wr(null),wr.GOOGLE_CREDENTIALS=new wr("google-credentials-uid"),wr.FIRST_PARTY=new wr("first-party-uid"),wr.MOCK_USER=new wr("mock-user");let jd="12.3.0";const wc=new pw("@firebase/firestore");function Ou(){return wc.logLevel}function Ae(n,...e){if(wc.logLevel<=It.DEBUG){const t=e.map(Tw);wc.debug(`Firestore (${jd}): ${n}`,...t)}}function Fr(n,...e){if(wc.logLevel<=It.ERROR){const t=e.map(Tw);wc.error(`Firestore (${jd}): ${n}`,...t)}}function Ec(n,...e){if(wc.logLevel<=It.WARN){const t=e.map(Tw);wc.warn(`Firestore (${jd}): ${n}`,...t)}}function Tw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Le(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,DM(n,r,t)}function DM(n,e,t){let r=`FIRESTORE (${jd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Fr(r),new Error(r)}function qe(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||DM(e,i,r)}function lt(n,e){return n}const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends Ks{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Wa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class kM{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class BF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wr.UNAUTHENTICATED)))}shutdown(){}}class UF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class FF{constructor(e){this.t=e,this.currentUser=wr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){qe(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new Wa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Wa,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Wa)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(qe(typeof r.accessToken=="string",31837,{l:r}),new kM(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qe(e===null||typeof e=="string",2055,{h:e}),new wr(e)}}class GF{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=wr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qF{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new GF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(wr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HF{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){qe(this.o===void 0,3512);const r=a=>{a.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Ae("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(qe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function $F(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Aw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=$F(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function st(n,e){return n<e?-1:n>e?1:0}function z1(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Dx(i)===Dx(a)?st(i,a):Dx(i)?1:-1}return st(n.length,e.length)}const YF=55296,KF=57343;function Dx(n){const e=n.charCodeAt(0);return e>=YF&&e<=KF}function cd(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function NM(n){return n+"\0"}const mI="__name__";class La{constructor(e,t,r){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Le(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return La.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof La?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=La.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return st(e.length,t.length)}static compareSegments(e,t){const r=La.isNumericId(e),i=La.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?La.extractNumericId(e).compare(La.extractNumericId(t)):z1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Zo.fromString(e.substring(4,e.length-2))}}class Ut extends La{construct(e,t,r){return new Ut(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ie(me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Ut(t)}static emptyPath(){return new Ut([])}}const XF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wn extends La{construct(e,t,r){return new wn(e,t,r)}static isValidIdentifier(e){return XF.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mI}static keyField(){return new wn([mI])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Ie(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ie(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ie(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Ie(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wn(t)}static emptyPath(){return new wn([])}}class De{constructor(e){this.path=e}static fromPath(e){return new De(Ut.fromString(e))}static fromName(e){return new De(Ut.fromString(e).popFirst(5))}static empty(){return new De(Ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ut.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new Ut(e.slice()))}}function MM(n,e,t){if(!t)throw new Ie(me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function WF(n,e,t,r){if(e===!0&&r===!0)throw new Ie(me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function vI(n){if(!De.isDocumentKey(n))throw new Ie(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yI(n){if(De.isDocumentKey(n))throw new Ie(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function PM(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Iv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function kr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Iv(n);throw new Ie(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Zn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Tp(n,e){if(!PM(n))throw new Ie(me.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Ie(me.INVALID_ARGUMENT,t);return!0}const bI=-62135596800,xI=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(e){return yt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*xI);return new yt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<bI)throw new Ie(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/xI}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Tp(e,yt._jsonSchema))return new yt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-bI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:Zn("string",yt._jsonSchemaVersion),seconds:Zn("number"),nanoseconds:Zn("number")};class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new yt(0,0))}static max(){return new Xe(new yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Gh=-1;class O0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function L1(n){return n.fields.find((e=>e.kind===2))}function Yl(n){return n.fields.filter((e=>e.kind!==2))}O0.UNKNOWN_ID=-1;class a0{constructor(e,t){this.fieldPath=e,this.kind=t}}class qh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new qh(0,bi.min())}}function QF(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Xe.fromTimestamp(r===1e9?new yt(t+1,0):new yt(t,r));return new bi(i,De.empty(),e)}function OM(n){return new bi(n.readTime,n.key,Gh)}class bi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new bi(Xe.min(),De.empty(),Gh)}static max(){return new bi(Xe.max(),De.empty(),Gh)}}function Cw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=De.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}const jM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class VM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Vc(n){if(n.code!==me.FAILED_PRECONDITION||n.message!==jM)throw n;Ae("LocalStore","Unexpectedly lost primary lease")}class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,r)=>{t(e)}))}static reject(e){return new ae(((t,r)=>{r(e)}))}static waitFor(e){return new ae(((t,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&t()}),(u=>r(u)))})),o=!0,a===i&&t()}))}static or(e){let t=ae.resolve(!1);for(const r of e)t=t.next((i=>i?ae.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new ae(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new ae(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const vi="SimpleDb";class Rv{static open(e,t,r,i){try{return new Rv(t,e.transaction(i,r))}catch(a){throw new yh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Wa,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new yh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Iw(r.target.error);this.S.reject(new yh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ae(vi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new JF(t)}}class Jo{static delete(e){return Ae(vi,"Removing database:",e),Ql(AN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!ON())return!1;if(Jo.F())return!0;const e=lr(),t=Jo.M(e),r=0<t&&t<10,i=zM(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Jo.M(lr())===12.2&&Fr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ae(vi,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;t(o)},i.onblocked=()=>{r(new yh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new Ie(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Ie(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new yh(e,o))},i.onupgradeneeded=a=>{Ae(vi,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Ae(vi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Rv.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),ae.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Ae(vi,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class ZF{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ql(this.U.delete())}}class yh extends Ie{constructor(e,t){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function pl(n){return n.name==="IndexedDbTransactionError"}class JF{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ae(vi,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ae(vi,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ql(r)}add(e){return Ae(vi,"ADD",this.store.name,e,e),Ql(this.store.add(e))}get(e){return Ql(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ae(vi,"GET",this.store.name,e,t),t)))}delete(e){return Ae(vi,"DELETE",this.store.name,e),Ql(this.store.delete(e))}count(){return Ae(vi,"COUNT",this.store.name),Ql(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new ae(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new ae(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){Ae(vi,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new ae(((r,i)=>{t.onerror=a=>{const o=Iw(a.target.error);i(o)},t.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){const r=[];return new ae(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new ZF(c),d=t(c.primaryKey,c.value,u);if(d instanceof ae){const h=d.catch((p=>(u.done(),ae.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>ae.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ql(n){return new ae(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Iw(r.target.error);t(i)}}))}let _I=!1;function Iw(n){const e=Jo.M(lr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _I||(_I=!0,setTimeout((()=>{throw r}),0)),r}}return n}const bh="IndexBackfiller";class e7{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ae(bh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ae(bh,`Documents written: ${t}`)}catch(t){pl(t)?Ae(bh,"Ignoring IndexedDB error during index backfill: ",t):await Vc(t)}await this.re(6e4)}))}}class t7{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return ae.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Ae(bh,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Ae(bh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const o=OM(a);Cw(o,r)>0&&(r=o)})),new bi(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Bi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Bi.ce=-1;const dc=-1;function Dv(n){return n==null}function Hh(n){return n===0&&1/n==-1/0}function n7(n){return typeof n=="number"&&Number.isInteger(n)&&!Hh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const j0="";function Nr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=wI(e)),e=r7(n.get(t),e);return wI(e)}function r7(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case j0:t+="";break;default:t+=a}}return t}function wI(n){return n+j0+""}function qa(n){const e=n.length;if(qe(e>=2,64408,{path:n}),e===2)return qe(n.charAt(0)===j0&&n.charAt(1)==="",56145,{path:n}),Ut.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const o=n.indexOf(j0,a);switch((o<0||o>t)&&Le(50515,{path:n}),n.charAt(o+1)){case"":const c=n.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,o),i+="\0";break;case"":i+=n.substring(a,o+1);break;default:Le(61167,{path:n})}a=o+2}return new Ut(r)}const Kl="remoteDocuments",Ap="owner",Iu="owner",$h="mutationQueues",i7="userId",la="mutations",EI="batchId",ac="userMutationsIndex",SI=["userId","batchId"];function s0(n,e){return[n,Nr(e)]}function LM(n,e,t){return[n,Nr(e),t]}const a7={},ud="documentMutations",V0="remoteDocumentsV14",s7=["prefixPath","collectionGroup","readTime","documentId"],o0="documentKeyIndex",o7=["prefixPath","collectionGroup","documentId"],BM="collectionGroupIndex",l7=["collectionGroup","readTime","prefixPath","documentId"],Yh="remoteDocumentGlobal",B1="remoteDocumentGlobalKey",dd="targets",UM="queryTargetsIndex",c7=["canonicalId","targetId"],fd="targetDocuments",u7=["targetId","path"],Rw="documentTargetsIndex",d7=["path","targetId"],z0="targetGlobalKey",fc="targetGlobal",Kh="collectionParents",f7=["collectionId","parent"],hd="clientMetadata",h7="clientId",kv="bundles",p7="bundleId",Nv="namedQueries",g7="name",Dw="indexConfiguration",m7="indexId",U1="collectionGroupIndex",v7="collectionGroup",xh="indexState",y7=["indexId","uid"],FM="sequenceNumberIndex",b7=["uid","sequenceNumber"],_h="indexEntries",x7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],GM="documentKeyIndex",_7=["indexId","uid","orderedDocumentKey"],Mv="documentOverlays",w7=["userId","collectionPath","documentId"],F1="collectionPathOverlayIndex",E7=["userId","collectionPath","largestBatchId"],qM="collectionGroupOverlayIndex",S7=["userId","collectionGroup","largestBatchId"],kw="globals",T7="name",HM=[$h,la,ud,Kl,dd,Ap,fc,fd,hd,Yh,Kh,kv,Nv],A7=[...HM,Mv],$M=[$h,la,ud,V0,dd,Ap,fc,fd,hd,Yh,Kh,kv,Nv,Mv],YM=$M,Nw=[...YM,Dw,xh,_h],C7=Nw,KM=[...Nw,kw],I7=KM;class G1 extends VM{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function cr(n,e){const t=lt(n);return Jo.O(t.le,e)}function TI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function gl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function XM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class vn{constructor(e,t){this.comparator=e,this.root=t||Er.EMPTY}insert(e,t){return new vn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Er.BLACK,null,null))}remove(e){return new vn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Er.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Im(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Im(this.root,e,this.comparator,!1)}getReverseIterator(){return new Im(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Im(this.root,e,this.comparator,!0)}}class Im{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Er{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Er.RED,this.left=i??Er.EMPTY,this.right=a??Er.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Er(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Er.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Er.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Er.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Er.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}Er.EMPTY=null,Er.RED=!0,Er.BLACK=!1;Er.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new Er(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Kt{constructor(e){this.comparator=e,this.data=new vn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new AI(this.data.getIterator())}getIteratorFrom(e){return new AI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Kt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Kt(this.comparator);return t.data=e,t}}class AI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ru(n){return n.hasNext()?n.getNext():void 0}class ti{constructor(e){this.fields=e,e.sort(wn.comparator)}static empty(){return new ti([])}unionWith(e){let t=new Kt(wn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ti(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cd(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class WM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new WM("Invalid base64 string: "+a):a}})(e);return new Jn(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const R7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(n){if(qe(!!n,39018),typeof n=="string"){let e=0;const t=R7.exec(n);if(qe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gn(n.seconds),nanos:gn(n.nanos)}}function gn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Us(n){return typeof n=="string"?Jn.fromBase64String(n):Jn.fromUint8Array(n)}const QM="server_timestamp",ZM="__type__",JM="__previous_value__",eP="__local_write_time__";function Mw(n){return(n?.mapValue?.fields||{})[ZM]?.stringValue===QM}function Pv(n){const e=n.mapValue.fields[JM];return Mw(e)?Pv(e):e}function Xh(n){const e=Bs(n.mapValue.fields[eP].timestampValue);return new yt(e.seconds,e.nanos)}class D7{constructor(e,t,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const L0="(default)";class Sc{constructor(e,t){this.projectId=e,this.database=t||L0}static empty(){return new Sc("","")}get isDefaultDatabase(){return this.database===L0}isEqual(e){return e instanceof Sc&&e.projectId===this.projectId&&e.database===this.database}}const Pw="__type__",tP="__max__",Ho={mapValue:{fields:{__type__:{stringValue:tP}}}},Ow="__vector__",pd="value",l0={nullValue:"NULL_VALUE"};function rl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Mw(n)?4:nP(n)?9007199254740991:Ov(n)?10:11:Le(28295,{value:n})}function ns(n,e){if(n===e)return!0;const t=rl(n);if(t!==rl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Xh(n).isEqual(Xh(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Bs(i.timestampValue),c=Bs(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return Us(i.bytesValue).isEqual(Us(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return gn(i.geoPointValue.latitude)===gn(a.geoPointValue.latitude)&&gn(i.geoPointValue.longitude)===gn(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return gn(i.integerValue)===gn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=gn(i.doubleValue),c=gn(a.doubleValue);return o===c?Hh(o)===Hh(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return cd(n.arrayValue.values||[],e.arrayValue.values||[],ns);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(TI(o)!==TI(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!ns(o[u],c[u])))return!1;return!0})(n,e);default:return Le(52216,{left:n})}}function Wh(n,e){return(n.values||[]).find((t=>ns(t,e)))!==void 0}function il(n,e){if(n===e)return 0;const t=rl(n),r=rl(e);if(t!==r)return st(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=gn(a.integerValue||a.doubleValue),u=gn(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return CI(n.timestampValue,e.timestampValue);case 4:return CI(Xh(n),Xh(e));case 5:return z1(n.stringValue,e.stringValue);case 6:return(function(a,o){const c=Us(a),u=Us(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=st(c[d],u[d]);if(h!==0)return h}return st(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=st(gn(a.latitude),gn(o.latitude));return c!==0?c:st(gn(a.longitude),gn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return II(n.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[pd]?.arrayValue,h=u[pd]?.arrayValue,p=st(d?.values?.length||0,h?.values?.length||0);return p!==0?p:II(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,o){if(a===Ho.mapValue&&o===Ho.mapValue)return 0;if(a===Ho.mapValue)return 1;if(o===Ho.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=z1(u[p],h[p]);if(m!==0)return m;const b=il(c[u[p]],d[h[p]]);if(b!==0)return b}return st(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function CI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=Bs(n),r=Bs(e),i=st(t.seconds,r.seconds);return i!==0?i:st(t.nanos,r.nanos)}function II(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=il(t[i],r[i]);if(a)return a}return st(t.length,r.length)}function gd(n){return q1(n)}function q1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Bs(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Us(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return De.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=q1(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${q1(t.fields[o])}`;return i+"}"})(n.mapValue):Le(61005,{value:n})}function c0(n){switch(rl(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Pv(n);return e?16+c0(e):16;case 5:return 2*n.stringValue.length;case 6:return Us(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+c0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return gl(r.fields,((a,o)=>{i+=a.length+c0(o)})),i})(n.mapValue);default:throw Le(13486,{value:n})}}function Qh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function H1(n){return!!n&&"integerValue"in n}function Zh(n){return!!n&&"arrayValue"in n}function RI(n){return!!n&&"nullValue"in n}function DI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function u0(n){return!!n&&"mapValue"in n}function Ov(n){return(n?.mapValue?.fields||{})[Pw]?.stringValue===Ow}function wh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return gl(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=wh(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wh(n.arrayValue.values[t]);return e}return{...n}}function nP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===tP}const rP={mapValue:{fields:{[Pw]:{stringValue:Ow},[pd]:{arrayValue:{}}}}};function k7(n){return"nullValue"in n?l0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Qh(Sc.empty(),De.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Ov(n)?rP:{mapValue:{}}:Le(35942,{value:n})}function N7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Qh(Sc.empty(),De.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?rP:"mapValue"in n?Ov(n)?{mapValue:{}}:Ho:Le(61959,{value:n})}function kI(n,e){const t=il(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function NI(n,e){const t=il(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Rr{constructor(e){this.value=e}static empty(){return new Rr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!u0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wh(t)}setAll(e){let t=wn.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=wh(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());u0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ns(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];u0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){gl(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Rr(wh(this.value))}}function iP(n){const e=[];return gl(n.fields,((t,r)=>{const i=new wn([t]);if(u0(r)){const a=iP(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new ti(e)}class Dn{constructor(e,t,r,i,a,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Dn(e,0,Xe.min(),Xe.min(),Xe.min(),Rr.empty(),0)}static newFoundDocument(e,t,r,i){return new Dn(e,1,t,Xe.min(),r,i,0)}static newNoDocument(e,t){return new Dn(e,2,t,Xe.min(),Xe.min(),Rr.empty(),0)}static newUnknownDocument(e,t){return new Dn(e,3,t,Xe.min(),Xe.min(),Rr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class md{constructor(e,t){this.position=e,this.inclusive=t}}function MI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],o=n.position[i];if(a.field.isKeyField()?r=De.comparator(De.fromName(o.referenceValue),t.key):r=il(o,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function PI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ns(n.position[t],e.position[t]))return!1;return!0}class Jh{constructor(e,t="asc"){this.field=e,this.dir=t}}function M7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class aP{}class Rt extends aP{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new P7(e,t,r):t==="array-contains"?new V7(e,r):t==="in"?new dP(e,r):t==="not-in"?new z7(e,r):t==="array-contains-any"?new L7(e,r):new Rt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new O7(e,r):new j7(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(il(t,this.value)):t!==null&&rl(this.value)===rl(t)&&this.matchesComparison(il(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yt extends aP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Yt(e,t)}matches(e){return vd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vd(n){return n.op==="and"}function $1(n){return n.op==="or"}function jw(n){return sP(n)&&vd(n)}function sP(n){for(const e of n.filters)if(e instanceof Yt)return!1;return!0}function Y1(n){if(n instanceof Rt)return n.field.canonicalString()+n.op.toString()+gd(n.value);if(jw(n))return n.filters.map((e=>Y1(e))).join(",");{const e=n.filters.map((t=>Y1(t))).join(",");return`${n.op}(${e})`}}function oP(n,e){return n instanceof Rt?(function(r,i){return i instanceof Rt&&r.op===i.op&&r.field.isEqual(i.field)&&ns(r.value,i.value)})(n,e):n instanceof Yt?(function(r,i){return i instanceof Yt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&oP(o,i.filters[c])),!0):!1})(n,e):void Le(19439)}function lP(n,e){const t=n.filters.concat(e);return Yt.create(t,n.op)}function cP(n){return n instanceof Rt?(function(t){return`${t.field.canonicalString()} ${t.op} ${gd(t.value)}`})(n):n instanceof Yt?(function(t){return t.op.toString()+" {"+t.getFilters().map(cP).join(" ,")+"}"})(n):"Filter"}class P7 extends Rt{constructor(e,t,r){super(e,t,r),this.key=De.fromName(r.referenceValue)}matches(e){const t=De.comparator(e.key,this.key);return this.matchesComparison(t)}}class O7 extends Rt{constructor(e,t){super(e,"in",t),this.keys=uP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class j7 extends Rt{constructor(e,t){super(e,"not-in",t),this.keys=uP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function uP(n,e){return(e.arrayValue?.values||[]).map((t=>De.fromName(t.referenceValue)))}class V7 extends Rt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zh(t)&&Wh(t.arrayValue,this.value)}}class dP extends Rt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wh(this.value.arrayValue,t)}}class z7 extends Rt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wh(this.value.arrayValue,t)}}class L7 extends Rt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Wh(this.value.arrayValue,r)))}}class B7{constructor(e,t=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function K1(n,e=null,t=[],r=[],i=null,a=null,o=null){return new B7(n,e,t,r,i,a,o)}function Tc(n){const e=lt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Y1(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Dv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>gd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>gd(r))).join(",")),e.Te=t}return e.Te}function Cp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!M7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!oP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!PI(n.startAt,e.startAt)&&PI(n.endAt,e.endAt)}function B0(n){return De.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function U0(n,e){return n.filters.filter((t=>t instanceof Rt&&t.field.isEqual(e)))}function OI(n,e,t){let r=l0,i=!0;for(const a of U0(n,e)){let o=l0,c=!0;switch(a.op){case"<":case"<=":o=k7(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=l0}kI({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];kI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function jI(n,e,t){let r=Ho,i=!0;for(const a of U0(n,e)){let o=Ho,c=!0;switch(a.op){case">=":case">":o=N7(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=Ho}NI({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];NI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class Vd{constructor(e,t=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function U7(n,e,t,r,i,a,o,c){return new Vd(n,e,t,r,i,a,o,c)}function Ip(n){return new Vd(n)}function VI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function fP(n){return n.collectionGroup!==null}function Eh(n){const e=lt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Kt(wn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Jh(a,r))})),t.has(wn.keyField().canonicalString())||e.Ie.push(new Jh(wn.keyField(),r))}return e.Ie}function Fi(n){const e=lt(n);return e.Ee||(e.Ee=F7(e,Eh(n))),e.Ee}function F7(n,e){if(n.limitType==="F")return K1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Jh(i.field,a)}));const t=n.endAt?new md(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new md(n.startAt.position,n.startAt.inclusive):null;return K1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function X1(n,e){const t=n.filters.concat([e]);return new Vd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function F0(n,e,t){return new Vd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function jv(n,e){return Cp(Fi(n),Fi(e))&&n.limitType===e.limitType}function hP(n){return`${Tc(Fi(n))}|lt:${n.limitType}`}function ju(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>cP(i))).join(", ")}]`),Dv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>gd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>gd(i))).join(",")),`Target(${r})`})(Fi(n))}; limitType=${n.limitType})`}function Rp(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):De.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of Eh(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=MI(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,Eh(r),i)||r.endAt&&!(function(o,c,u){const d=MI(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,Eh(r),i))})(n,e)}function G7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pP(n){return(e,t)=>{let r=!1;for(const i of Eh(n)){const a=q7(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function q7(n,e,t){const r=n.field.isKeyField()?De.comparator(e.key,t.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?il(u,d):Le(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Le(19790,{direction:n.dir})}}class Ws{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gl(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return XM(this.inner)}size(){return this.innerSize}}const H7=new vn(De.comparator);function yi(){return H7}const gP=new vn(De.comparator);function sh(...n){let e=gP;for(const t of n)e=e.insert(t.key,t);return e}function mP(n){let e=gP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ha(){return Sh()}function vP(){return Sh()}function Sh(){return new Ws((n=>n.toString()),((n,e)=>n.isEqual(e)))}const $7=new vn(De.comparator),Y7=new Kt(De.comparator);function xt(...n){let e=Y7;for(const t of n)e=e.add(t);return e}const K7=new Kt(st);function X7(){return K7}function Vw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hh(e)?"-0":e}}function yP(n){return{integerValue:""+n}}function W7(n,e){return n7(e)?yP(e):Vw(n,e)}class Vv{constructor(){this._=void 0}}function Q7(n,e,t){return n instanceof ep?(function(i,a){const o={fields:{[ZM]:{stringValue:QM},[eP]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Mw(a)&&(a=Pv(a)),a&&(o.fields[JM]=a),{mapValue:o}})(t,e):n instanceof Ac?xP(n,e):n instanceof yd?_P(n,e):(function(i,a){const o=bP(i,a),c=zI(o)+zI(i.Ae);return H1(o)&&H1(i.Ae)?yP(c):Vw(i.serializer,c)})(n,e)}function Z7(n,e,t){return n instanceof Ac?xP(n,e):n instanceof yd?_P(n,e):t}function bP(n,e){return n instanceof tp?(function(r){return H1(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class ep extends Vv{}class Ac extends Vv{constructor(e){super(),this.elements=e}}function xP(n,e){const t=wP(e);for(const r of n.elements)t.some((i=>ns(i,r)))||t.push(r);return{arrayValue:{values:t}}}class yd extends Vv{constructor(e){super(),this.elements=e}}function _P(n,e){let t=wP(e);for(const r of n.elements)t=t.filter((i=>!ns(i,r)));return{arrayValue:{values:t}}}class tp extends Vv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function zI(n){return gn(n.integerValue||n.doubleValue)}function wP(n){return Zh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class EP{constructor(e,t){this.field=e,this.transform=t}}function J7(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Ac&&i instanceof Ac||r instanceof yd&&i instanceof yd?cd(r.elements,i.elements,ns):r instanceof tp&&i instanceof tp?ns(r.Ae,i.Ae):r instanceof ep&&i instanceof ep})(n.transform,e.transform)}class eG{constructor(e,t){this.version=e,this.transformResults=t}}class or{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new or}static exists(e){return new or(void 0,e)}static updateTime(e){return new or(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function d0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class zv{}function SP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Dp(n.key,or.none()):new zd(n.key,n.data,or.none());{const t=n.data,r=Rr.empty();let i=new Kt(wn.comparator);for(let a of e.fields)if(!i.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Qs(n.key,r,new ti(i.toArray()),or.none())}}function tG(n,e,t){n instanceof zd?(function(i,a,o){const c=i.value.clone(),u=BI(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Qs?(function(i,a,o){if(!d0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=BI(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(TP(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Th(n,e,t,r){return n instanceof zd?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=a.value.clone(),h=UI(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Qs?(function(a,o,c,u){if(!d0(a.precondition,o))return c;const d=UI(a.fieldTransforms,u,o),h=o.data;return h.setAll(TP(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,o,c){return d0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function nG(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=bP(r.transform,i||null);a!=null&&(t===null&&(t=Rr.empty()),t.set(r.field,a))}return t||null}function LI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cd(r,i,((a,o)=>J7(a,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class zd extends zv{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Qs extends zv{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function TP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function BI(n,e,t){const r=new Map;qe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,Z7(o,c,t[i]))}return r}function UI(n,e,t){const r=new Map;for(const i of n){const a=i.transform,o=t.data.field(i.field);r.set(i.field,Q7(a,o,e))}return r}class Dp extends zv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AP extends zv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class zw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&tG(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Th(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Th(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=vP();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(i.key)?null:c;const u=SP(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xt())}isEqual(e){return this.batchId===e.batchId&&cd(this.mutations,e.mutations,((t,r)=>LI(t,r)))&&cd(this.baseMutations,e.baseMutations,((t,r)=>LI(t,r)))}}class Lw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){qe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return $7})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Lw(e,t,r,i)}}class Bw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class rG{constructor(e,t){this.count=e,this.unchangedNames=t}}var Kn,Nt;function iG(n){switch(n){case me.OK:return Le(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function CP(n){if(n===void 0)return Fr("GRPC error has no .code"),me.UNKNOWN;switch(n){case Kn.OK:return me.OK;case Kn.CANCELLED:return me.CANCELLED;case Kn.UNKNOWN:return me.UNKNOWN;case Kn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case Kn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case Kn.INTERNAL:return me.INTERNAL;case Kn.UNAVAILABLE:return me.UNAVAILABLE;case Kn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case Kn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case Kn.NOT_FOUND:return me.NOT_FOUND;case Kn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case Kn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case Kn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case Kn.ABORTED:return me.ABORTED;case Kn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case Kn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case Kn.DATA_LOSS:return me.DATA_LOSS;default:return Le(39323,{code:n})}}(Nt=Kn||(Kn={}))[Nt.OK=0]="OK",Nt[Nt.CANCELLED=1]="CANCELLED",Nt[Nt.UNKNOWN=2]="UNKNOWN",Nt[Nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nt[Nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nt[Nt.NOT_FOUND=5]="NOT_FOUND",Nt[Nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nt[Nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nt[Nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nt[Nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nt[Nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nt[Nt.ABORTED=10]="ABORTED",Nt[Nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nt[Nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nt[Nt.INTERNAL=13]="INTERNAL",Nt[Nt.UNAVAILABLE=14]="UNAVAILABLE",Nt[Nt.DATA_LOSS=15]="DATA_LOSS";function aG(){return new TextEncoder}const sG=new Zo([4294967295,4294967295],0);function FI(n){const e=aG().encode(n),t=new SM;return t.update(e),new Uint8Array(t.digest())}function GI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Zo([t,r],0),new Zo([i,a],0)]}class Uw{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new oh(`Invalid padding: ${t}`);if(r<0)throw new oh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new oh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new oh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Zo.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Zo.fromNumber(r)));return i.compare(sG)===1&&(i=new Zo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=FI(e),[r,i]=GI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Uw(a,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=FI(e),[r,i]=GI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class oh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Lv{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,kp.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Lv(Xe.min(),i,new vn(st),yi(),xt())}}class kp{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new kp(r,t,xt(),xt(),xt())}}class f0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class IP{constructor(e,t){this.targetId=e,this.Ce=t}}class RP{constructor(e,t,r=Jn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class qI{constructor(){this.ve=0,this.Fe=HI(),this.Me=Jn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xt(),t=xt(),r=xt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Le(38017,{changeType:a})}})),new kp(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=HI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,qe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class oG{constructor(e){this.Ge=e,this.ze=new Map,this.je=yi(),this.Je=Rm(),this.He=Rm(),this.Ye=new vn(st)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(B0(a))if(r===0){const o=new De(a.path);this.et(t,o,Dn.newNoDocument(o,Xe.min()))}else qe(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let o,c;try{o=Us(r).toUint8Array()}catch(u){if(u instanceof WM)return Ec("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Uw(o,i,a)}catch(u){return Ec(u instanceof oh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&B0(c.target)){const u=new De(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Dn.newNoDocument(u,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let r=xt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new Lv(e,t,this.Ye,this.je,r);return this.je=yi(),this.Je=Rm(),this.He=Rm(),this.Ye=new vn(st),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new qI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Kt(st),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Kt(st),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Rm(){return new vn(De.comparator)}function HI(){return new vn(De.comparator)}const lG={asc:"ASCENDING",desc:"DESCENDING"},cG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uG={and:"AND",or:"OR"};class dG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function W1(n,e){return n.useProto3Json||Dv(e)?e:{value:e}}function bd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function fG(n,e){return bd(n,e.toTimestamp())}function Hr(n){return qe(!!n,49232),Xe.fromTimestamp((function(t){const r=Bs(t);return new yt(r.seconds,r.nanos)})(n))}function Fw(n,e){return Q1(n,e).canonicalString()}function Q1(n,e){const t=(function(i){return new Ut(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function kP(n){const e=Ut.fromString(n);return qe(BP(e),10190,{key:e.toString()}),e}function G0(n,e){return Fw(n.databaseId,e.path)}function hc(n,e){const t=kP(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new De(PP(t))}function NP(n,e){return Fw(n.databaseId,e)}function MP(n){const e=kP(n);return e.length===4?Ut.emptyPath():PP(e)}function Z1(n){return new Ut(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function PP(n){return qe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function $I(n,e,t){return{name:G0(n,e),fields:t.value.mapValue.fields}}function hG(n,e,t){const r=hc(n,e.name),i=Hr(e.updateTime),a=e.createTime?Hr(e.createTime):Xe.min(),o=new Rr({mapValue:{fields:e.fields}}),c=Dn.newFoundDocument(r,i,a,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function pG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Le(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(qe(h===void 0||typeof h=="string",58123),Jn.fromBase64String(h||"")):(qe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Jn.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?me.UNKNOWN:CP(d.code);return new Ie(h,d.message||"")})(o);t=new RP(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=hc(n,r.document.name),a=Hr(r.document.updateTime),o=r.document.createTime?Hr(r.document.createTime):Xe.min(),c=new Rr({mapValue:{fields:r.document.fields}}),u=Dn.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new f0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=hc(n,r.document),a=r.readTime?Hr(r.readTime):Xe.min(),o=Dn.newNoDocument(i,a),c=r.removedTargetIds||[];t=new f0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=hc(n,r.document),a=r.removedTargetIds||[];t=new f0([],a,i,null)}else{if(!("filter"in e))return Le(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new rG(i,a),c=r.targetId;t=new IP(c,o)}}return t}function q0(n,e){let t;if(e instanceof zd)t={update:$I(n,e.key,e.value)};else if(e instanceof Dp)t={delete:G0(n,e.key)};else if(e instanceof Qs)t={update:$I(n,e.key,e.data),updateMask:xG(e.fieldMask)};else{if(!(e instanceof AP))return Le(16599,{Vt:e.type});t={verify:G0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof ep)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ac)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof yd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof tp)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Le(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:fG(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Le(27497)})(n,e.precondition)),t}function J1(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?or.updateTime(Hr(a.updateTime)):a.exists!==void 0?or.exists(a.exists):or.none()})(e.currentDocument):or.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)qe(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new ep;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Ac(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new yd(h)}else"increment"in c?u=new tp(o,c.increment):Le(16584,{proto:c});const d=wn.fromServerFormat(c.fieldPath);return new EP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=hc(n,e.update.name),a=new Rr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new ti(d.map((h=>wn.fromServerFormat(h))))})(e.updateMask);return new Qs(i,a,o,t,r)}return new zd(i,a,t,r)}if(e.delete){const i=hc(n,e.delete);return new Dp(i,t)}if(e.verify){const i=hc(n,e.verify);return new AP(i,t)}return Le(1463,{proto:e})}function gG(n,e){return n&&n.length>0?(qe(e!==void 0,14353),n.map((t=>(function(i,a){let o=i.updateTime?Hr(i.updateTime):Hr(a);return o.isEqual(Xe.min())&&(o=Hr(a)),new eG(o,i.transformResults||[])})(t,e)))):[]}function OP(n,e){return{documents:[NP(n,e.path)]}}function jP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=NP(n,i);const a=(function(d){if(d.length!==0)return LP(Yt.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:Vu(m.field),direction:vG(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=W1(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function VP(n){let e=MP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){qe(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=zP(p);return m instanceof Yt&&jw(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new Jh(zu(_.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,Dv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new md(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new md(b,m)})(t.endAt)),U7(e,i,o,a,c,"F",u,d)}function mG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function zP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=zu(t.unaryFilter.field);return Rt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=zu(t.unaryFilter.field);return Rt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=zu(t.unaryFilter.field);return Rt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=zu(t.unaryFilter.field);return Rt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Rt.create(zu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Yt.create(t.compositeFilter.filters.map((r=>zP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le(1026)}})(t.compositeFilter.op))})(n):Le(30097,{filter:n})}function vG(n){return lG[n]}function yG(n){return cG[n]}function bG(n){return uG[n]}function Vu(n){return{fieldPath:n.canonicalString()}}function zu(n){return wn.fromServerFormat(n.fieldPath)}function LP(n){return n instanceof Rt?(function(t){if(t.op==="=="){if(DI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NAN"}};if(RI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(DI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NOT_NAN"}};if(RI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vu(t.field),op:yG(t.op),value:t.value}}})(n):n instanceof Yt?(function(t){const r=t.getFilters().map((i=>LP(i)));return r.length===1?r[0]:{compositeFilter:{op:bG(t.op),filters:r}}})(n):Le(54877,{filter:n})}function xG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function BP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Ds{constructor(e,t,r,i,a=Xe.min(),o=Xe.min(),c=Jn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class UP{constructor(e){this.yt=e}}function _G(n,e){let t;if(e.document)t=hG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=De.fromSegments(e.noDocument.path),i=Ic(e.noDocument.readTime);t=Dn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le(56709);{const r=De.fromSegments(e.unknownDocument.path),i=Ic(e.unknownDocument.version);t=Dn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new yt(i[0],i[1]);return Xe.fromTimestamp(a)})(e.readTime)),t}function YI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:H0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:G0(a,o.key),fields:o.data.value.mapValue.fields,updateTime:bd(a,o.version.toTimestamp()),createTime:bd(a,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Cc(e.version)};else{if(!e.isUnknownDocument())return Le(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Cc(e.version)}}return r}function H0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ic(n){const e=new yt(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function Zl(n,e){const t=(e.baseMutations||[]).map((a=>J1(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>J1(n.yt,a))),i=yt.fromMillis(e.localWriteTimeMs);return new zw(e.batchId,i,t,r)}function lh(n){const e=Ic(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ic(n.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const o=a.documents.length;return qe(o===1,1966,{count:o}),Fi(Ip(MP(a.documents[0])))})(n.query):(function(a){return Fi(VP(a))})(n.query),new Ds(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Jn.fromBase64String(n.resumeToken))}function FP(n,e){const t=Cc(e.snapshotVersion),r=Cc(e.lastLimboFreeSnapshotVersion);let i;i=B0(e.target)?OP(n.yt,e.target):jP(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Tc(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function GP(n){const e=VP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?F0(e,e.limit,"L"):e}function kx(n,e){return new Bw(e.largestBatchId,J1(n.yt,e.overlayMutation))}function KI(n,e){const t=e.path.lastSegment();return[n,Nr(e.path.popLast()),t]}function XI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cc(r.readTime),documentKey:Nr(r.documentKey.path),largestBatchId:r.largestBatchId}}class wG{getBundleMetadata(e,t){return WI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Ic(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return WI(e).put((function(i){return{bundleId:i.id,createTime:Cc(Hr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return QI(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:GP(a.bundledQuery),readTime:Ic(a.readTime)}})(r)}))}saveNamedQuery(e,t){return QI(e).put((function(i){return{name:i.name,readTime:Cc(Hr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function WI(n){return cr(n,kv)}function QI(n){return cr(n,Nv)}class Bv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Bv(e,r)}getOverlay(e,t){return Wf(e).get(KI(this.userId,t)).next((r=>r?kx(this.serializer,r):null))}getOverlays(e,t){const r=Ha();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,o)=>{const c=new Bw(t,o);i.push(this.St(e,c))})),ae.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(Nr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Wf(e).Z(F1,c))})),ae.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Ha(),a=Nr(t),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Wf(e).J(F1,o).next((c=>{for(const u of c){const d=kx(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=Ha();let o;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wf(e).ee({index:qM,range:c},((u,d,h)=>{const p=kx(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return Wf(e).put((function(i,a,o){const[c,u,d]=KI(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:q0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Wf(n){return cr(n,Mv)}class EG{bt(e){return cr(e,kw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Jn.fromUint8Array(r):Jn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Jl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(gn(e.integerValue));else if("doubleValue"in e){const r=gn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Hh(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Bs(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Us(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?nP(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ov(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Le(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=pd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(gn(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),De.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Jl.Kt=new Jl;const Du=255;function SG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function ZI(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=SG(255&r[a]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class TG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=ZI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=ZI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Du),this.sn(255)}_n(){this.an(Du),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Du?(this.sn(Du),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Du?(this.an(Du),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class AG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class CG{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Qf{constructor(){this.cn=new TG,this.ln=new AG(this.cn),this.hn=new CG(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class ec{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new ec(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:h0(this.En),directionalValue:h0(this.dn),orderedDocumentKey:h0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function No(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=JI(n.En,e.En),t!==0?t:(t=JI(n.dn,e.dn),t!==0?t:De.comparator(n.In,e.In)))}function JI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function h0(n){return PN()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function eR(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class tR{constructor(e){this.mn=new Kt(((t,r)=>wn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(qe(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=L1(e);if(t!==void 0&&!this.wn(t))return!1;const r=Yl(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new Kt(wn.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new a0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new a0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new a0(r.field,r.dir==="asc"?0:1)));return new O0(O0.UNKNOWN_ID,this.collectionId,t,qh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function qP(n){if(qe(n instanceof Rt||n instanceof Yt,20012),n instanceof Rt){if(n instanceof dP){const t=n.value.arrayValue?.values?.map((r=>Rt.create(n.field,"==",r)))||[];return Yt.create(t,"or")}return n}const e=n.filters.map((t=>qP(t)));return Yt.create(e,n.op)}function IG(n){if(n.getFilters().length===0)return[];const e=n_(qP(n));return qe(HP(e),7391),e_(e)||t_(e)?[e]:e.getFilters()}function e_(n){return n instanceof Rt}function t_(n){return n instanceof Yt&&jw(n)}function HP(n){return e_(n)||t_(n)||(function(t){if(t instanceof Yt&&$1(t)){for(const r of t.getFilters())if(!e_(r)&&!t_(r))return!1;return!0}return!1})(n)}function n_(n){if(qe(n instanceof Rt||n instanceof Yt,34018),n instanceof Rt)return n;if(n.filters.length===1)return n_(n.filters[0]);const e=n.filters.map((r=>n_(r)));let t=Yt.create(e,n.op);return t=$0(t),HP(t)?t:(qe(t instanceof Yt,64498),qe(vd(t),40251),qe(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Gw(r,i))))}function Gw(n,e){let t;return qe(n instanceof Rt||n instanceof Yt,38388),qe(e instanceof Rt||e instanceof Yt,25473),t=n instanceof Rt?e instanceof Rt?(function(i,a){return Yt.create([i,a],"and")})(n,e):nR(n,e):e instanceof Rt?nR(e,n):(function(i,a){if(qe(i.filters.length>0&&a.filters.length>0,48005),vd(i)&&vd(a))return lP(i,a.getFilters());const o=$1(i)?i:a,c=$1(i)?a:i,u=o.filters.map((d=>Gw(d,c)));return Yt.create(u,"or")})(n,e),$0(t)}function nR(n,e){if(vd(e))return lP(e,n.getFilters());{const t=e.filters.map((r=>Gw(n,r)));return Yt.create(t,"or")}}function $0(n){if(qe(n instanceof Rt||n instanceof Yt,11850),n instanceof Rt)return n;const e=n.getFilters();if(e.length===1)return $0(e[0]);if(sP(n))return n;const t=e.map((i=>$0(i))),r=[];return t.forEach((i=>{i instanceof Rt?r.push(i):i instanceof Yt&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Yt.create(r,n.op)}class RG{constructor(){this.Cn=new qw}addToCollectionParentIndex(e,t){return this.Cn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(bi.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(bi.min())}updateCollectionGroup(e,t,r){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class qw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Kt(Ut.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Kt(Ut.comparator)).toArray()}}const rR="IndexedDbIndexManager",Dm=new Uint8Array(0);class DG{constructor(e,t){this.databaseId=t,this.vn=new qw,this.Fn=new Ws((r=>Tc(r)),((r,i)=>Cp(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Nr(i)};return iR(e).put(a)}return ae.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[NM(t),""],!1,!0);return iR(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==t)break;r.push(qa(o.parent))}return r}))}addFieldIndex(e,t){const r=Zf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const o=Nu(e);return a.next((c=>{o.put(XI(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=Zf(e),i=Nu(e),a=ku(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Zf(e),r=ku(e),i=Nu(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return ae.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new tR(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=ku(e);let i=!0;const a=new Map;return ae.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=xt();const c=[];return ae.forEach(a,((u,d)=>{Ae(rR,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((P=>`${P.fieldPath}:${P.kind}`)).join(",")}`})(u)} to execute ${Tc(t)}`);const h=(function(D,P){const M=L1(P);if(M===void 0)return null;for(const V of U0(D,M.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null})(d,u),p=(function(D,P){const M=new Map;for(const V of Yl(P))for(const C of U0(D,V.fieldPath))switch(C.op){case"==":case"in":M.set(V.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return M.set(V.fieldPath.canonicalString(),C.value),Array.from(M.values())}return null})(d,u),m=(function(D,P){const M=[];let V=!0;for(const C of Yl(P)){const I=C.kind===0?OI(D,C.fieldPath,D.startAt):jI(D,C.fieldPath,D.startAt);M.push(I.value),V&&(V=I.inclusive)}return new md(M,V)})(d,u),b=(function(D,P){const M=[];let V=!0;for(const C of Yl(P)){const I=C.kind===0?jI(D,C.fieldPath,D.endAt):OI(D,C.fieldPath,D.endAt);M.push(I.value),V&&(V=I.inclusive)}return new md(M,V)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),S=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,S);return ae.forEach(T,(A=>r.Y(A,t.limit).next((D=>{D.forEach((P=>{const M=De.fromSegments(P.documentKey);o.has(M)||(o=o.add(M),c.push(M))}))}))))})).next((()=>c))}return ae.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=IG(Yt.create(e.filters,"and")).map((r=>K1(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,o,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Dm,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((S=>this.kn(e,m,S,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new ec(e,De.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new ec(e,De.empty(),t,r);return i?a.An():a}xn(e,t){const r=new tR(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return ae.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new Kt(wn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Qf;for(const i of Yl(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);Jl.Kt.Dt(a,o)}return r.un()}Ln(e){const t=new Qf;return Jl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Qf;return Jl.Kt.Dt(Qh(this.databaseId,t),r.Pn((function(a){const o=Yl(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Qf);let a=0;for(const o of Yl(e)){const c=r[a++];for(const u of i)if(this.Un(t,o.fieldPath)&&Zh(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);Jl.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Qf;u.seed(c.un()),Jl.Kt.Dt(o,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof Rt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Zf(e),i=Nu(e);return(t?r.J(U1,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const o=[];return ae.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new qh(p.sequenceNumber,new bi(Ic(p.readTime),new De(qa(p.documentKey)),p.largestBatchId)):qh.empty(),b=h.fields.map((([_,w])=>new a0(wn.fromServerFormat(_),w)));return new O0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:st(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Zf(e),a=Nu(e);return this.Gn(e).next((o=>i.J(U1,IDBKeyRange.bound(t,t)).next((c=>ae.forEach(c,(u=>a.put(XI(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return ae.forEach(t,((i,a)=>{const o=r.get(i.collectionGroup);return(o?ae.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),ae.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?ae.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return ku(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return ku(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=ku(e);let a=new Kt(No);return i.ee({index:GM,range:IDBKeyRange.only([r.indexId,this.uid,h0(this.$n(r,t))])},((o,c)=>{a=a.add(new ec(r.indexId,t,eR(c.arrayValue),eR(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new Kt(No);const i=this.Qn(t,e);if(i==null)return r;const a=L1(t);if(a!=null){const o=e.data.field(a.fieldPath);if(Zh(o))for(const c of o.arrayValue.values||[])r=r.add(new ec(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new ec(t.indexId,e.key,Dm,i));return r}Jn(e,t,r,i,a){Ae(rR,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Ru(b),S=Ru(_);for(;w||S;){let T=!1,A=!1;if(w&&S){const D=h(w,S);D<0?A=!0:D>0&&(T=!0)}else w!=null?A=!0:T=!0;T?(p(S),S=Ru(_)):A?(m(w),w=Ru(b)):(w=Ru(b),S=Ru(_))}})(i,a,No,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),ae.waitFor(o)}Gn(e){let t=1;return Nu(e).ee({index:FM,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>No(o,c))).filter(((o,c,u)=>!c||No(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=No(o,e),u=No(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Dm,De.empty()),u=i[o+1].Vn(this.uid,Dm,De.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return No(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(aR)}getMinOffset(e,t){return ae.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Le(44426))))).next(aR)}}function iR(n){return cr(n,Kh)}function ku(n){return cr(n,_h)}function Zf(n){return cr(n,Dw)}function Nu(n){return cr(n,xh)}function aR(n){qe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Cw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new bi(e.readTime,e.documentKey,t)}const sR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$P=41943040;class Ir{static withCacheSize(e){return new Ir(e,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function YP(n,e,t){const r=n.store(la),i=n.store(ud),a=[],o=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{qe(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=LM(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return ae.waitFor(a).next((()=>d))}function Y0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Le(14731);e=n.noDocument}return JSON.stringify(e).length}Ir.DEFAULT_COLLECTION_PERCENTILE=10,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ir.DEFAULT=new Ir($P,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ir.DISABLED=new Ir(-1,0,0);class Uv{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){qe(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Uv(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).ee({index:ac,range:r},((i,a,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=Lu(e),o=Mo(e);return o.add({}).next((c=>{qe(typeof c=="number",49019);const u=new zw(c,t,r,i),d=(function(b,_,w){const S=w.baseMutations.map((A=>q0(b.yt,A))),T=w.mutations.map((A=>q0(b.yt,A)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:S,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new Kt(((m,b)=>st(m.canonicalString(),b.canonicalString())));for(const m of i){const b=LM(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(b,a7))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),ae.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return Mo(e).get(t).next((r=>r?(qe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Zl(this.serializer,r)):null))}er(e,t){return this.Xn[t]?ae.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Mo(e).ee({index:ac,range:i},((o,c,u)=>{c.userId===this.userId&&(qe(c.batchId>=r,47524,{tr:r}),a=Zl(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=dc;return Mo(e).ee({index:ac,range:t,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,dc],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).J(ac,t).next((r=>r.map((i=>Zl(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=s0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Lu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=qa(h);if(d===this.userId&&t.path.isEqual(m))return Mo(e).get(p).next((b=>{if(!b)throw Le(61480,{nr:o,batchId:p});qe(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(Zl(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Kt(st);const i=[];return t.forEach((a=>{const o=s0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=Lu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=qa(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),ae.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=s0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new Kt(st);return Lu(e).ee({range:o},((u,d,h)=>{const[p,m,b]=u,_=qa(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(Mo(e).get(a).next((o=>{if(o===null)throw Le(35274,{batchId:a});qe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(Zl(this.serializer,o))})))})),ae.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return YP(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ae.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ae.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Lu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=qa(a[1]);i.push(u)}else c.done()})).next((()=>{qe(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return KP(e,this.userId,t)}_r(e){return XP(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:dc,lastStreamToken:""}))}}function KP(n,e,t){const r=s0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return Lu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function Mo(n){return cr(n,la)}function Lu(n){return cr(n,ud)}function XP(n){return cr(n,$h)}class Rc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rc(0)}static cr(){return new Rc(-1)}}class kG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Rc(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Xe.fromTimestamp(new yt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Mu(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(qe(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return Mu(e).ee(((o,c)=>{const u=lh(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>ae.waitFor(a))).next((()=>i))}forEachTarget(e,t){return Mu(e).ee(((r,i)=>{const a=lh(i);t(a)}))}lr(e){return oR(e).get(z0).next((t=>(qe(t!==null,2888),t)))}hr(e,t){return oR(e).put(z0,t)}Pr(e,t){return Mu(e).put(FP(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Tc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Mu(e).ee({range:i,index:UM},((o,c,u)=>{const d=lh(c);Cp(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=qo(e);return t.forEach((o=>{const c=Nr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),ae.waitFor(i)}removeMatchingKeys(e,t,r){const i=qo(e);return ae.forEach(t,(a=>{const o=Nr(a.path);return ae.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=qo(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=qo(e);let a=xt();return i.ee({range:r,X:!0},((o,c,u)=>{const d=qa(o[1]),h=new De(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=Nr(t.path),i=IDBKeyRange.bound([r],[NM(r)],!1,!0);let a=0;return qo(e).ee({index:Rw,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return Mu(e).get(t).next((r=>r?lh(r):null))}}function Mu(n){return cr(n,dd)}function oR(n){return cr(n,fc)}function qo(n){return cr(n,fd)}const lR="LruGarbageCollector",NG=1048576;function cR([n,e],[t,r]){const i=st(n,t);return i===0?st(e,r):i}class MG{constructor(e){this.Ir=e,this.buffer=new Kt(cR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();cR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class WP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(lR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){pl(t)?Ae(lR,"Ignoring IndexedDB error during garbage collection: ",t):await Vc(t)}await this.Vr(3e5)}))}}class PG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Bi.ce);const r=new MG(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(sR)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Ou()<=It.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function QP(n,e){return new PG(n,e)}class OG{constructor(e,t){this.db=e,this.garbageCollector=QP(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return km(e,r)}removeReference(e,t,r){return km(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return km(e,t)}br(e,t){return(function(i,a){let o=!1;return XP(i).te((c=>KP(i,c,a).next((u=>(u&&(o=!0),ae.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=t){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Xe.min()),qo(e).delete((function(p){return[0,Nr(p.path)]})(o)))))}));i.push(u)}})).next((()=>ae.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return km(e,t)}Sr(e,t){const r=qo(e);let i,a=Bi.ce;return r.ee({index:Rw},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==Bi.ce&&t(new De(qa(i)),a),a=d,i=u):a=Bi.ce})).next((()=>{a!==Bi.ce&&t(new De(qa(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function km(n,e){return qo(n).put((function(r,i){return{targetId:0,path:Nr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class ZP{constructor(){this.changes=new Ws((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Dn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ae.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class jG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Gl(e).put(r)}removeEntry(e,t,r){return Gl(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],H0(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Dn.newInvalidDocument(t);return Gl(e).ee({index:o0,range:IDBKeyRange.only(Jf(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:Dn.newInvalidDocument(t)};return Gl(e).ee({index:o0,range:IDBKeyRange.only(Jf(t))},((i,a)=>{r={document:this.Cr(t,a),size:Y0(a)}})).next((()=>r))}getEntries(e,t){let r=yi();return this.Fr(e,t,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=yi(),i=new vn(De.comparator);return this.Fr(e,t,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,Y0(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return ae.resolve();let i=new Kt(fR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(Jf(i.first()),Jf(i.last())),o=i.getIterator();let c=o.getNext();return Gl(e).ee({index:o0,range:a},((u,d,h)=>{const p=De.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&fR(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(Jf(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const o=t.path,c=[o.popLast().toArray(),o.lastSegment(),H0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Gl(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=yi();for(const p of d){const m=this.Cr(De.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Rp(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=yi();const o=dR(t,r),c=dR(t,bi.max());return Gl(e).ee({index:BM,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(De.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new VG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return uR(e).get(B1).next((t=>(qe(!!t,20021),t)))}Dr(e,t){return uR(e).put(B1,t)}Cr(e,t){if(t){const r=_G(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return Dn.newInvalidDocument(e)}}function JP(n){return new jG(n)}class VG extends ZP{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ws((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Kt(((a,o)=>st(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=YI(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=Y0(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=YI(this.Nr.serializer,o.convertToNoDocument(Xe.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),ae.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function uR(n){return cr(n,Yh)}function Gl(n){return cr(n,V0)}function Jf(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dR(n,e){const t=e.documentKey.path.toArray();return[n,H0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function fR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=st(t[a],r[a]),i)return i;return i=st(t.length,r.length),i||(i=st(t[t.length-2],r[r.length-2]),i||st(t[t.length-1],r[r.length-1]))}class zG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class eO{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Th(r.mutation,i,ti.empty(),yt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,xt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=xt()){const i=Ha();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let o=sh();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Ha();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,xt())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let a=yi();const o=Sh(),c=(function(){return Sh()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Qs)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Th(h.mutation,d,h.mutation.getFieldMask(),yt.now())):o.set(d.key,ti.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>c.set(d,new zG(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Sh();let i=new vn(((o,c)=>o-c)),a=xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||ti.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||xt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=vP();h.forEach((m=>{if(!a.has(m)){const b=SP(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return ae.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return De.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):fP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ae.resolve(Ha());let c=Gh,u=a;return o.next((d=>ae.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?ae.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,xt()))).next((h=>({batchId:c,changes:mP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new De(t)).next((r=>{let i=sh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let o=sh();return this.indexManager.getCollectionParents(e,a).next((c=>ae.forEach(c,(u=>{const d=(function(p,m){return new Vd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Dn.newInvalidDocument(h)))}));let c=sh();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Th(h.mutation,d,ti.empty(),yt.now()),Rp(t,d)&&(c=c.insert(u,d))})),c}))}}class LG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Hr(i.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:GP(i.bundledQuery),readTime:Hr(i.readTime)}})(t)),ae.resolve()}}class BG{constructor(){this.overlays=new vn(De.comparator),this.qr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ha();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),ae.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),ae.resolve()}getOverlaysForCollection(e,t,r){const i=Ha(),a=t.length+1,o=new De(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new vn(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ha(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ha(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return ae.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Bw(t,r));let a=this.qr.get(t);a===void 0&&(a=xt(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class UG{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}class Hw{constructor(){this.Qr=new Kt(pr.$r),this.Ur=new Kt(pr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new pr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new pr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new De(new Ut([])),r=new pr(t,e),i=new pr(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new De(new Ut([])),r=new pr(t,e),i=new pr(t,e+1);let a=xt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new pr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class pr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return De.comparator(e.key,t.key)||st(e.Yr,t.Yr)}static Kr(e,t){return st(e.Yr,t.Yr)||De.comparator(e.key,t.key)}}class FG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Kt(pr.$r)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new zw(a,t,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new pr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,t){return ae.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return ae.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?dc:this.tr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new pr(t,0),i=new pr(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),ae.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Kt(st);return t.forEach((i=>{const a=new pr(i,0),o=new pr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),ae.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;De.isDocumentKey(a)||(a=a.child(""));const o=new pr(new De(a),0);let c=new Kt(st);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),ae.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){qe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ae.forEach(t.mutations,(i=>{const a=new pr(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new pr(t,0),i=this.Zr.firstAfterOrEqual(r);return ae.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class GG{constructor(e){this.ri=e,this.docs=(function(){return new vn(De.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ae.resolve(r?r.document.mutableCopy():Dn.newInvalidDocument(t))}getEntries(e,t){let r=yi();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Dn.newInvalidDocument(i))})),ae.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=yi();const o=t.path,c=new De(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Cw(OM(h),r)<=0||(i.has(h.key)||Rp(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return ae.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Le(9500)}ii(e,t){return ae.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new qG(this)}getSize(e){return ae.resolve(this.size)}}class qG extends ZP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),ae.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class HG{constructor(e){this.persistence=e,this.si=new Ws((t=>Tc(t)),Cp),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.oi=0,this._i=new Hw,this.targetCount=0,this.ai=Rc.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),ae.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.Pr(t),ae.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),ae.waitFor(a).next((()=>i))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return ae.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),ae.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),ae.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return ae.resolve(r)}containsKey(e,t){return ae.resolve(this._i.containsKey(t))}}class $w{constructor(e,t){this.ui={},this.overlays={},this.ci=new Bi(0),this.li=!1,this.li=!0,this.hi=new UG,this.referenceDelegate=e(this),this.Pi=new HG(this),this.indexManager=new RG,this.remoteDocumentCache=(function(i){return new GG(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new UP(t),this.Ii=new LG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new BG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new FG(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae("MemoryPersistence","Starting transaction:",e);const i=new $G(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return ae.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class $G extends VM{constructor(e){super(),this.currentSequenceNumber=e}}class Fv{constructor(e){this.persistence=e,this.Ri=new Hw,this.Vi=null}static mi(e){return new Fv(e)}get fi(){if(this.Vi)return this.Vi;throw Le(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),ae.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,(r=>{const i=De.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class K0{constructor(e,t){this.persistence=e,this.pi=new Ws((r=>Nr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=QP(this,t)}static mi(e,t){return new K0(e,t)}Ei(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return ae.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?ae.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,a.removeEntry(o,Xe.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=c0(e.data.value)),t}br(e,t,r){return ae.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return ae.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class YG{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Rv("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Ap)})(e),(function(u){u.createObjectStore($h,{keyPath:i7}),u.createObjectStore(la,{keyPath:EI,autoIncrement:!0}).createIndex(ac,SI,{unique:!0}),u.createObjectStore(ud)})(e),hR(e),(function(u){u.createObjectStore(Kl)})(e));let o=ae.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(fd),u.deleteObjectStore(dd),u.deleteObjectStore(fc)})(e),hR(e)),o=o.next((()=>(function(u){const d=u.store(fc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return d.put(z0,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(la).J().next((p=>{u.deleteObjectStore(la),u.createObjectStore(la,{keyPath:EI,autoIncrement:!0}).createIndex(ac,SI,{unique:!0});const m=d.store(la),b=p.map((_=>m.put(_)));return ae.waitFor(b)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(hd,{keyPath:h7})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Yh)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(kv,{keyPath:p7})})(e),(function(u){u.createObjectStore(Nv,{keyPath:g7})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(Mv,{keyPath:w7});d.createIndex(F1,E7,{unique:!1}),d.createIndex(qM,S7,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(V0,{keyPath:s7});d.createIndex(o0,o7),d.createIndex(BM,l7)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Kl)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Dw,{keyPath:m7,autoIncrement:!0}).createIndex(U1,v7,{unique:!1}),u.createObjectStore(xh,{keyPath:y7}).createIndex(FM,b7,{unique:!1}),u.createObjectStore(_h,{keyPath:x7}).createIndex(GM,_7,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(xh).clear()})).next((()=>{t.objectStore(_h).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(kw,{keyPath:T7})})(e)}))),r<18&&i>=18&&PN()&&(o=o.next((()=>{t.objectStore(xh).clear()})).next((()=>{t.objectStore(_h).clear()}))),o}wi(e){let t=0;return e.store(Kl).ee(((r,i)=>{t+=Y0(i)})).next((()=>{const r={byteSize:t};return e.store(Yh).put(B1,r)}))}yi(e){const t=e.store($h),r=e.store(la);return t.J().next((i=>ae.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,dc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(ac,o).next((c=>ae.forEach(c,(u=>{qe(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=Zl(this.serializer,u);return YP(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(fd),r=e.store(Kl);return e.store(fc).get(z0).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new Ut(o),d=(function(p){return[0,Nr(p)]})(u);a.push(t.get(d).next((h=>h?ae.resolve():(p=>t.put({targetId:0,path:Nr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>ae.waitFor(a)))}))}bi(e,t){e.createObjectStore(Kh,{keyPath:f7});const r=t.store(Kh),i=new qw,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:Nr(u)})}};return t.store(Kl).ee({X:!0},((o,c)=>{const u=new Ut(o);return a(u.popLast())})).next((()=>t.store(ud).ee({X:!0},(([o,c,u],d)=>{const h=qa(c);return a(h.popLast())}))))}Di(e){const t=e.store(dd);return t.ee(((r,i)=>{const a=lh(i),o=FP(this.serializer,a);return t.put(o)}))}Ci(e,t){const r=t.store(Kl),i=[];return r.ee(((a,o)=>{const c=t.store(V0),u=(function(p){return p.document?new De(Ut.fromString(p.document.name).popFirst(5)):p.noDocument?De.fromSegments(p.noDocument.path):p.unknownDocument?De.fromSegments(p.unknownDocument.path):Le(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>ae.waitFor(i)))}Fi(e,t){const r=t.store(la),i=JP(this.serializer),a=new $w(Fv.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??xt();Zl(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),ae.forEach(c,((u,d)=>{const h=new wr(d),p=Bv.wt(this.serializer,h),m=a.getIndexManager(h),b=Uv.wt(h,this.serializer,m,a.referenceDelegate);return new eO(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new G1(t,Bi.ce),u).next()}))}))}}function hR(n){n.createObjectStore(fd,{keyPath:u7}).createIndex(Rw,d7,{unique:!0}),n.createObjectStore(dd,{keyPath:"targetId"}).createIndex(UM,c7,{unique:!0}),n.createObjectStore(fc)}const Po="IndexedDbPersistence",Nx=18e5,Mx=5e3,Px="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",KG="main";class Yw{constructor(e,t,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Yw.v())throw new Ie(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new OG(this,i),this.$i=t+KG,this.serializer=new UP(u),this.Ui=new Jo(this.$i,this.Ni,new YG(this.serializer)),this.hi=new EG,this.Pi=new kG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=JP(this.serializer),this.Ii=new wG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Fr(Po,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ie(me.FAILED_PRECONDITION,Px);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Bi(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Nm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(pl(e))return Ae(Po,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ae(Po,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return eh(e).get(Iu).next((t=>ae.resolve(this.es(t))))}ts(e){return Nm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Nx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=cr(t,hd);return r.J().next((i=>{const a=this.ss(i,Nx),o=i.filter((c=>a.indexOf(c)===-1));return ae.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ae.resolve(!0):eh(e).get(Iu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Mx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ie(me.FAILED_PRECONDITION,Px);return!1}}return!(!this.networkEnabled||!this.inForeground)||Nm(e).J().next((r=>this.ss(r,Mx).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ae(Po,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Ap,hd],(e=>{const t=new G1(e,Bi.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Nm(e).J().next((t=>this.ss(t,Nx).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Uv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new DG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Bv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ae(Po,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?I7:u===17?KM:u===16?C7:u===15?Nw:u===14?YM:u===13?$M:u===12?A7:u===11?HM:void Le(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new G1(c,this.ci?this.ci.next():Bi.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Fr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ie(me.FAILED_PRECONDITION,jM);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return eh(e).get(Iu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Mx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ie(me.FAILED_PRECONDITION,Px)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return eh(e).put(Iu,t)}static v(){return Jo.v()}Zi(e){const t=eh(e);return t.get(Iu).next((r=>this.es(r)?(Ae(Po,"Releasing primary lease."),t.delete(Iu)):ae.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Fr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;MN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Ae(Po,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Fr(Po,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Fr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function eh(n){return cr(n,Ap)}function Nm(n){return cr(n,hd)}function XG(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Kw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=xt(),i=xt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Kw(e,t.fromCache,r,i)}}class WG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class tO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return MN()?8:zM(lr())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new WG;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Ou()<=It.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",ju(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(Ou()<=It.DEBUG&&Ae("QueryEngine","Query:",ju(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Ou()<=It.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",ju(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fi(t))):ae.resolve())}ys(e,t){if(VI(t))return ae.resolve(null);let r=Fi(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=F0(t,null,"F"),r=Fi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=xt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,o,u.readTime)?this.ys(e,F0(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return VI(t)||i.isEqual(Xe.min())?ae.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,r,i)?ae.resolve(null):(Ou()<=It.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ju(t)),this.vs(e,o,t,QF(i,Gh)).next((c=>c)))}))}Ds(e,t){let r=new Kt(pP(e));return t.forEach(((i,a)=>{Rp(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return Ou()<=It.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",ju(t)),this.ps.getDocumentsMatchingQuery(e,t,bi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const Xw="LocalStore",QG=3e8;class ZG{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new vn(st),this.xs=new Ws((a=>Tc(a)),Cp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new eO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function nO(n,e,t,r){return new ZG(n,e,t,r)}async function rO(n,e){const t=lt(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=xt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function JG(n,e){const t=lt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=ae.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const S=d.docVersions.get(_);qe(S!==null,48541),w.version.compareTo(S)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=xt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function iO(n){const e=lt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function eq(n,e){const t=lt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(Jn.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,S,T){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=QG?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=yi(),d=xt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(tq(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Xe.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return ae.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function tq(n,e,t){let r=xt(),i=xt();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let o=yi();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Xe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ae(Xw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function nq(n,e){const t=lt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=dc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function rq(n,e){const t=lt(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,ae.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new Ds(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function r_(n,e,t){const r=lt(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!pl(o))throw o;Ae(Xw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function pR(n,e,t){const r=lt(n);let i=Xe.min(),a=xt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=lt(u),m=p.xs.get(h);return m!==void 0?ae.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Fi(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:Xe.min(),t?a:xt()))).next((c=>(iq(r,G7(e),c),{documents:c,Qs:a})))))}function iq(n,e,t){let r=n.Os.get(e)||Xe.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class gR{constructor(){this.activeTargetIds=X7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aO{constructor(){this.Mo=new gR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new gR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class aq{Oo(e){}shutdown(){}}const mR="ConnectivityMonitor";class vR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(mR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(mR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Mm=null;function i_(){return Mm===null?Mm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Mm++,"0x"+Mm.toString(16)}const Ox="RestConnection",sq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===L0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const o=i_(),c=this.zo(e,t.toUriEncodedString());Ae(Ox,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Pd(d);return this.Jo(e,c,u,r,h).then((p=>(Ae(Ox,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Ec(Ox,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,o){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+jd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=sq[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class lq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Cr="WebChannelConnection";class cq extends oq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const o=i_();return new Promise(((c,u)=>{const d=new TM;d.setWithCredentials(!0),d.listenOnce(AM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case i0.NO_ERROR:const p=d.getResponseJson();Ae(Cr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case i0.TIMEOUT:Ae(Cr,`RPC '${e}' ${o} timed out`),u(new Ie(me.DEADLINE_EXCEEDED,"Request time out"));break;case i0.HTTP_ERROR:const m=d.getStatus();if(Ae(Cr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const A=T.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(A)>=0?A:me.UNKNOWN})(_.status);u(new Ie(w,_.message))}else u(new Ie(me.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Ie(me.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ae(Cr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Ae(Cr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=i_(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=RM(),c=IM(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Ae(Cr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new lq({Yo:S=>{b?Ae(Cr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Ae(Cr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Ae(Cr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),w=(S,T,A)=>{S.listen(T,(D=>{try{A(D)}catch(P){setTimeout((()=>{throw P}),0)}}))};return w(p,ah.EventType.OPEN,(()=>{b||(Ae(Cr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,ah.EventType.CLOSE,(()=>{b||(b=!0,Ae(Cr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,ah.EventType.ERROR,(S=>{b||(b=!0,Ec(Cr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),_.a_(new Ie(me.UNAVAILABLE,"The operation could not be completed")))})),w(p,ah.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];qe(!!T,16349);const A=T,D=A?.error||A[0]?.error;if(D){Ae(Cr,`RPC '${e}' stream ${i} received error:`,D);const P=D.status;let M=(function(I){const k=Kn[I];if(k!==void 0)return CP(k)})(P),V=D.message;M===void 0&&(M=me.INTERNAL,V="Unknown error status: "+P+" with message "+D.message),b=!0,_.a_(new Ie(M,V)),p.close()}else Ae(Cr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,CM.STAT_EVENT,(S=>{S.stat===V1.PROXY?Ae(Cr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===V1.NOPROXY&&Ae(Cr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function uq(){return typeof window<"u"?window:null}function p0(){return typeof document<"u"?document:null}function Gv(n){return new dG(n,!0)}class sO{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ae("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const yR="PersistentStream";class oO{constructor(e,t,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sO(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(Fr(t.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Ie(me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(yR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ae(yR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dq extends oO{constructor(e,t,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=pG(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Xe.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Xe.min():o.readTime?Hr(o.readTime):Xe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Z1(this.serializer),t.addTarget=(function(a,o){let c;const u=o.target;if(c=B0(u)?{documents:OP(a,u)}:{query:jP(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=DP(a,o.resumeToken);const d=W1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Xe.min())>0){c.readTime=bd(a,o.snapshotVersion.toTimestamp());const d=W1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=mG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Z1(this.serializer),t.removeTarget=e,this.q_(t)}}class fq extends oO{constructor(e,t,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return qe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=gG(e.writeResults,e.commitTime),r=Hr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Z1(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>q0(this.serializer,r)))};this.q_(t)}}class hq{}class pq extends hq{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ie(me.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,Q1(t,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(me.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,Q1(t,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ie(me.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class gq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Fr(t),this.aa=!1):Ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Dc="RemoteStore";class mq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{zc(this)&&(Ae(Dc,"Restarting streams for network reachability change."),await(async function(u){const d=lt(u);d.Ea.add(4),await Np(d),d.Ra.set("Unknown"),d.Ea.delete(4),await qv(d)})(this))}))})),this.Ra=new gq(r,i)}}async function qv(n){if(zc(n))for(const e of n.da)await e(!0)}async function Np(n){for(const e of n.da)await e(!1)}function lO(n,e){const t=lt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Jw(t)?Zw(t):Ld(t).O_()&&Qw(t,e))}function Ww(n,e){const t=lt(n),r=Ld(t);t.Ia.delete(e),r.O_()&&cO(t,e),t.Ia.size===0&&(r.O_()?r.L_():zc(t)&&t.Ra.set("Unknown"))}function Qw(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ld(n).Y_(e)}function cO(n,e){n.Va.Ue(e),Ld(n).Z_(e)}function Zw(n){n.Va=new oG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ld(n).start(),n.Ra.ua()}function Jw(n){return zc(n)&&!Ld(n).x_()&&n.Ia.size>0}function zc(n){return lt(n).Ea.size===0}function uO(n){n.Va=void 0}async function vq(n){n.Ra.set("Online")}async function yq(n){n.Ia.forEach(((e,t)=>{Qw(n,e)}))}async function bq(n,e){uO(n),Jw(n)?(n.Ra.ha(e),Zw(n)):n.Ra.set("Unknown")}async function xq(n,e,t){if(n.Ra.set("Online"),e instanceof RP&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Ae(Dc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await X0(n,r)}else if(e instanceof f0?n.Va.Ze(e):e instanceof IP?n.Va.st(e):n.Va.tt(e),!t.isEqual(Xe.min()))try{const r=await iO(n.localStore);t.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Jn.EMPTY_BYTE_STRING,h.snapshotVersion)),cO(a,u);const p=new Ds(h.target,u,d,h.sequenceNumber);Qw(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Ae(Dc,"Failed to raise snapshot:",r),await X0(n,r)}}async function X0(n,e,t){if(!pl(e))throw e;n.Ea.add(1),await Np(n),n.Ra.set("Offline"),t||(t=()=>iO(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ae(Dc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await qv(n)}))}function dO(n,e){return e().catch((t=>X0(n,t,e)))}async function Mp(n){const e=lt(n),t=al(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:dc;for(;_q(e);)try{const i=await nq(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,wq(e,i)}catch(i){await X0(e,i)}fO(e)&&hO(e)}function _q(n){return zc(n)&&n.Ta.length<10}function wq(n,e){n.Ta.push(e);const t=al(n);t.O_()&&t.X_&&t.ea(e.mutations)}function fO(n){return zc(n)&&!al(n).x_()&&n.Ta.length>0}function hO(n){al(n).start()}async function Eq(n){al(n).ra()}async function Sq(n){const e=al(n);for(const t of n.Ta)e.ea(t.mutations)}async function Tq(n,e,t){const r=n.Ta.shift(),i=Lw.from(r,e,t);await dO(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Mp(n)}async function Aq(n,e){e&&al(n).X_&&await(async function(r,i){if((function(o){return iG(o)&&o!==me.ABORTED})(i.code)){const a=r.Ta.shift();al(r).B_(),await dO(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Mp(r)}})(n,e),fO(n)&&hO(n)}async function bR(n,e){const t=lt(n);t.asyncQueue.verifyOperationInProgress(),Ae(Dc,"RemoteStore received new credentials");const r=zc(t);t.Ea.add(3),await Np(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await qv(t)}async function Cq(n,e){const t=lt(n);e?(t.Ea.delete(2),await qv(t)):e||(t.Ea.add(2),await Np(t),t.Ra.set("Unknown"))}function Ld(n){return n.ma||(n.ma=(function(t,r,i){const a=lt(t);return a.sa(),new dq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:vq.bind(null,n),t_:yq.bind(null,n),r_:bq.bind(null,n),H_:xq.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Jw(n)?Zw(n):n.Ra.set("Unknown")):(await n.ma.stop(),uO(n))}))),n.ma}function al(n){return n.fa||(n.fa=(function(t,r,i){const a=lt(t);return a.sa(),new fq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Eq.bind(null,n),r_:Aq.bind(null,n),ta:Sq.bind(null,n),na:Tq.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Mp(n)):(await n.fa.stop(),n.Ta.length>0&&(Ae(Dc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class eE{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Wa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const o=Date.now()+r,c=new eE(e,t,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tE(n,e){if(Fr("AsyncQueue",`${e}: ${n}`),pl(n))return new Ie(me.UNAVAILABLE,`${e}: ${n}`);throw n}class rd{static emptySet(e){return new rd(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||De.comparator(t.key,r.key):(t,r)=>De.comparator(t.key,r.key),this.keyedMap=sh(),this.sortedSet=new vn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof rd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new rd;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class xR{constructor(){this.ga=new vn(De.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class xd{constructor(e,t,r,i,a,o,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new xd(e,t,rd.emptySet(t),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Iq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Rq{constructor(){this.queries=_R(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=lt(t),a=i.queries;i.queries=_R(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Ie(me.ABORTED,"Firestore shutting down"))}}function _R(){return new Ws((n=>hP(n)),jv)}async function nE(n,e){const t=lt(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new Iq,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const c=tE(o,`Initialization of query '${ju(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&iE(t)}async function rE(n,e){const t=lt(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Dq(n,e){const t=lt(n);let r=!1;for(const i of e){const a=i.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&iE(t)}function kq(n,e,t){const r=lt(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function iE(n){n.Ca.forEach((e=>{e.next()}))}var a_,wR;(wR=a_||(a_={})).Ma="default",wR.Cache="cache";class aE{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new xd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=xd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==a_.Cache}}class pO{constructor(e){this.key=e}}class gO{constructor(e){this.key=e}}class Nq{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=xt(),this.mutatedKeys=xt(),this.eu=pP(e),this.tu=new rd(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new xR,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Rp(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,_){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Rt:S})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new xd(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new xR,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=xt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new gO(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new pO(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=xt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return xd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sE="SyncEngine";class Mq{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Pq{constructor(e){this.key=e,this.hu=!1}}class Oq{constructor(e,t,r,i,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ws((c=>hP(c)),jv),this.Iu=new Map,this.Eu=new Set,this.du=new vn(De.comparator),this.Au=new Map,this.Ru=new Hw,this.Vu={},this.mu=new Map,this.fu=Rc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jq(n,e,t=!0){const r=_O(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await mO(r,e,t,!0),i}async function Vq(n,e){const t=_O(n);await mO(t,e,!0,!1)}async function mO(n,e,t,r){const i=await rq(n.localStore,Fi(e)),a=i.targetId,o=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await zq(n,e,a,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&lO(n.remoteStore,i),c}async function zq(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,S,T,A){let D=S.view.ru(T);D.Cs&&(D=await pR(w.localStore,S.query,!1).then((({documents:C})=>S.view.ru(C,D))));const P=A&&A.targetChanges.get(S.targetId),M=A&&A.targetMismatches.get(S.targetId)!=null,V=S.view.applyChanges(D,w.isPrimaryClient,P,M);return SR(w,S.targetId,V.au),V.snapshot})(n,p,m,b);const a=await pR(n.localStore,e,!0),o=new Nq(e,a.Qs),c=o.ru(a.documents),u=kp.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(c,n.isPrimaryClient,u);SR(n,t,d.au);const h=new Mq(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function Lq(n,e,t){const r=lt(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!jv(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await r_(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ww(r.remoteStore,i.targetId),s_(r,i.targetId)})).catch(Vc)):(s_(r,i.targetId),await r_(r.localStore,i.targetId,!0))}async function Bq(n,e){const t=lt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ww(t.remoteStore,r.targetId))}async function Uq(n,e,t){const r=wO(n);try{const i=await(function(o,c){const u=lt(o),d=yt.now(),h=c.reduce(((b,_)=>b.add(_.key)),xt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=yi(),w=xt();return u.Ns.getEntries(b,h).next((S=>{_=S,_.forEach(((T,A)=>{A.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((S=>{p=S;const T=[];for(const A of c){const D=nG(A,p.get(A.key).overlayedDocument);D!=null&&T.push(new Qs(A.key,D,iP(D.value.mapValue),or.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:mP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new vn(st)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await Pp(r,i.changes),await Mp(r.remoteStore)}catch(i){const a=tE(i,"Failed to persist write");t.reject(a)}}async function vO(n,e){const t=lt(n);try{const r=await eq(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=t.Au.get(a);o&&(qe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?qe(o.hu,14607):i.removedDocuments.size>0&&(qe(o.hu,42227),o.hu=!1))})),await Pp(t,r,e)}catch(r){await Vc(r)}}function ER(n,e,t){const r=lt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=lt(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&iE(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Fq(n,e,t){const r=lt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new vn(De.comparator);o=o.insert(a,Dn.newNoDocument(a,Xe.min()));const c=xt().add(a),u=new Lv(Xe.min(),new Map,new vn(st),o,c);await vO(r,u),r.du=r.du.remove(a),r.Au.delete(e),oE(r)}else await r_(r.localStore,e,!1).then((()=>s_(r,e,t))).catch(Vc)}async function Gq(n,e){const t=lt(n),r=e.batch.batchId;try{const i=await JG(t.localStore,e);bO(t,r,null),yO(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Pp(t,i)}catch(i){await Vc(i)}}async function qq(n,e,t){const r=lt(n);try{const i=await(function(o,c){const u=lt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(qe(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);bO(r,e,t),yO(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Pp(r,i)}catch(i){await Vc(i)}}function yO(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function bO(n,e,t){const r=lt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function s_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||xO(n,r)}))}function xO(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Ww(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),oE(n))}function SR(n,e,t){for(const r of t)r instanceof pO?(n.Ru.addReference(r.key,e),Hq(n,r)):r instanceof gO?(Ae(sE,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||xO(n,r.key)):Le(19791,{wu:r})}function Hq(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ae(sE,"New document in limbo: "+t),n.Eu.add(r),oE(n))}function oE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new De(Ut.fromString(e)),r=n.fu.next();n.Au.set(r,new Pq(t)),n.du=n.du.insert(t,r),lO(n.remoteStore,new Ds(Fi(Ip(t.path)),r,"TargetPurposeLimboResolution",Bi.ce))}}async function Pp(n,e,t){const r=lt(n),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Kw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=lt(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>ae.forEach(d,(m=>ae.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>ae.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!pl(p))throw p;Ae(Xw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function $q(n,e){const t=lt(n);if(!t.currentUser.isEqual(e)){Ae(sE,"User change. New user:",e.toKey());const r=await rO(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Ie(me.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Pp(t,r.Ls)}}function Yq(n,e){const t=lt(n),r=t.Au.get(e);if(r&&r.hu)return xt().add(r.key);{let i=xt();const a=t.Iu.get(e);if(!a)return i;for(const o of a){const c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function _O(n){const e=lt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=vO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Yq.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Fq.bind(null,e),e.Pu.H_=Dq.bind(null,e.eventManager),e.Pu.yu=kq.bind(null,e.eventManager),e}function wO(n){const e=lt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gq.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qq.bind(null,e),e}class np{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gv(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return nO(this.persistence,new tO,e.initialUser,this.serializer)}Cu(e){return new $w(Fv.mi,this.serializer)}Du(e){return new aO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}np.provider={build:()=>new np};class Kq extends np{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){qe(this.persistence.referenceDelegate instanceof K0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new WP(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ir.withCacheSize(this.cacheSizeBytes):Ir.DEFAULT;return new $w((r=>K0.mi(r,t)),this.serializer)}}class Xq extends np{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await wO(this.xu.syncEngine),await Mp(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return nO(this.persistence,new tO,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new WP(r,e.asyncQueue,t)}Mu(e,t){const r=new t7(t,this.persistence);return new e7(e.asyncQueue,r)}Cu(e){const t=XG(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ir.withCacheSize(this.cacheSizeBytes):Ir.DEFAULT;return new Yw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,uq(),p0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new aO}}class W0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ER(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$q.bind(null,this.syncEngine),await Cq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Rq})()}createDatastore(e){const t=Gv(e.databaseInfo.databaseId),r=(function(a){return new cq(a)})(e.databaseInfo);return(function(a,o,c,u){return new pq(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,o,c){return new mq(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>ER(this.syncEngine,t,0)),(function(){return vR.v()?new vR:new aq})())}createSyncEngine(e,t){return(function(i,a,o,c,u,d,h){const p=new Oq(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=lt(t);Ae(Dc,"RemoteStore shutting down."),r.Ea.add(5),await Np(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}W0.provider={build:()=>new W0};class lE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Fr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const sl="FirestoreClient";class Wq{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=wr.UNAUTHENTICATED,this.clientId=Aw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Ae(sl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Ae(sl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=tE(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function jx(n,e){n.asyncQueue.verifyOperationInProgress(),Ae(sl,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await rO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function TR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Qq(n);Ae(sl,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>bR(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>bR(e.remoteStore,i))),n._onlineComponents=e}async function Qq(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ae(sl,"Using user provided OfflineComponentProvider");try{await jx(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===me.FAILED_PRECONDITION||i.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Ec("Error using user provided cache. Falling back to memory cache: "+t),await jx(n,new np)}}else Ae(sl,"Using default OfflineComponentProvider"),await jx(n,new Kq(void 0));return n._offlineComponents}async function EO(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ae(sl,"Using user provided OnlineComponentProvider"),await TR(n,n._uninitializedComponentsProvider._online)):(Ae(sl,"Using default OnlineComponentProvider"),await TR(n,new W0))),n._onlineComponents}function Zq(n){return EO(n).then((e=>e.syncEngine))}async function Q0(n){const e=await EO(n),t=e.eventManager;return t.onListen=jq.bind(null,e.syncEngine),t.onUnlisten=Lq.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Vq.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Bq.bind(null,e.syncEngine),t}function Jq(n,e,t={}){const r=new Wa;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new lE({next:m=>{h.Nu(),o.enqueueAndForget((()=>rE(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Ie(me.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Ie(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new aE(Ip(c.path),h,{includeMetadataChanges:!0,qa:!0});return nE(a,p)})(await Q0(n),n.asyncQueue,e,t,r))),r.promise}function eH(n,e,t={}){const r=new Wa;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new lE({next:m=>{h.Nu(),o.enqueueAndForget((()=>rE(a,p))),m.fromCache&&u.source==="server"?d.reject(new Ie(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new aE(c,h,{includeMetadataChanges:!0,qa:!0});return nE(a,p)})(await Q0(n),n.asyncQueue,e,t,r))),r.promise}function SO(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const AR=new Map;const TO="firestore.googleapis.com",CR=!0;class IR{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=TO,this.ssl=CR}else this.host=e.host,this.ssl=e.ssl??CR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$P;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<NG)throw new Ie(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=SO(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ie(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ie(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ie(me.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new IR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new IR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new BF;switch(r.type){case"firstParty":return new qF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ie(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=AR.get(t);r&&(Ae("ComponentProvider","Removing Datastore"),AR.delete(t),r.terminate())})(this),Promise.resolve()}}function tH(n,e,t,r={}){n=kr(n,Hv);const i=Pd(e),a=n._getSettings(),o={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(DN(`https://${c}`),kN("Firestore",!0)),a.host!==TO&&a.host!==c&&Ec("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!nl(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=wr.MOCK_USER;else{d=K9(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ie(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new wr(p)}n._authCredentials=new UF(new kM(d,h))}}class Zs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Zs(this.firestore,e,this._query)}}class kn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new el(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kn(this.firestore,e,this._key)}toJSON(){return{type:kn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Tp(t,kn._jsonSchema))return new kn(e,r||null,new De(Ut.fromString(t.referencePath)))}}kn._jsonSchemaVersion="firestore/documentReference/1.0",kn._jsonSchema={type:Zn("string",kn._jsonSchemaVersion),referencePath:Zn("string")};class el extends Zs{constructor(e,t,r){super(e,t,Ip(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new De(e))}withConverter(e){return new el(this.firestore,e,this._path)}}function Vi(n,e,...t){if(n=dn(n),MM("collection","path",e),n instanceof Hv){const r=Ut.fromString(e,...t);return yI(r),new el(n,null,r)}{if(!(n instanceof kn||n instanceof el))throw new Ie(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ut.fromString(e,...t));return yI(r),new el(n.firestore,null,r)}}function Ft(n,e,...t){if(n=dn(n),arguments.length===1&&(e=Aw.newId()),MM("doc","path",e),n instanceof Hv){const r=Ut.fromString(e,...t);return vI(r),new kn(n,null,new De(r))}{if(!(n instanceof kn||n instanceof el))throw new Ie(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ut.fromString(e,...t));return vI(r),new kn(n.firestore,n instanceof el?n.converter:null,new De(r))}}const RR="AsyncQueue";class DR{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sO(this,"async_queue_retry"),this._c=()=>{const r=p0();r&&Ae(RR,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=p0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=p0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Wa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!pl(e))throw e;Ae(RR,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Fr("INTERNAL UNHANDLED ERROR: ",kR(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=eE.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Le(47125,{Pc:kR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function kR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function NR(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class va extends Hv{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new DR,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new DR(e),this._firestoreClient=void 0,await e}}}function nH(n,e){const t=typeof n=="object"?n:LN(),r=typeof n=="string"?n:L0,i=mw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=$9("firestore");a&&tH(i,...a)}return i}function Op(n){if(n._terminated)throw new Ie(me.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AO(n),n._firestoreClient}function AO(n){const e=n._freezeSettings(),t=(function(i,a,o,c){return new D7(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,SO(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Wq(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}function rH(n,e){Ec("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return iH(n,W0.provider,{build:r=>new Xq(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function iH(n,e,t){if((n=kr(n,va))._firestoreClient||n._terminated)throw new Ie(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ie(me.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},AO(n)}class Li{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Li(Jn.fromBase64String(e))}catch(t){throw new Ie(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Li(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Li._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Tp(e,Li._jsonSchema))return Li.fromBase64String(e.bytes)}}Li._jsonSchemaVersion="firestore/bytes/1.0",Li._jsonSchema={type:Zn("string",Li._jsonSchemaVersion),bytes:Zn("string")};class jp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class $v{constructor(e){this._methodName=e}}class Qa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Qa._jsonSchemaVersion}}static fromJSON(e){if(Tp(e,Qa._jsonSchema))return new Qa(e.latitude,e.longitude)}}Qa._jsonSchemaVersion="firestore/geoPoint/1.0",Qa._jsonSchema={type:Zn("string",Qa._jsonSchemaVersion),latitude:Zn("number"),longitude:Zn("number")};class Za{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Za._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Tp(e,Za._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Za(e.vectorValues);throw new Ie(me.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Za._jsonSchemaVersion="firestore/vectorValue/1.0",Za._jsonSchema={type:Zn("string",Za._jsonSchemaVersion),vectorValues:Zn("object")};const aH=/^__.*__$/;class sH{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Qs(e,this.data,this.fieldMask,t,this.fieldTransforms):new zd(e,this.data,t,this.fieldTransforms)}}class CO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Qs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function IO(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ac:n})}}class Yv{constructor(e,t,r,i,a,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Yv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Z0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(IO(this.Ac)&&aH.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class oH{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Gv(e)}Cc(e,t,r,i=!1){return new Yv({Ac:e,methodName:t,Dc:r,path:wn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Vp(n){const e=n._freezeSettings(),t=Gv(n._databaseId);return new oH(n._databaseId,!!e.ignoreUndefinedProperties,t)}function cE(n,e,t,r,i,a={}){const o=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);dE("Data must be an object, but it was:",o,r);const c=kO(r,o);let u,d;if(a.merge)u=new ti(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=o_(e,p,t);if(!o.contains(m))throw new Ie(me.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);MO(h,m)||h.push(m)}u=new ti(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new sH(new Rr(c),u,d)}class zp extends $v{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zp}}function lH(n,e,t){return new Yv({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class uE extends $v{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=lH(this,e,!0),r=this.vc.map((a=>Bd(a,t))),i=new Ac(r);return new EP(e.path,i)}isEqual(e){return e instanceof uE&&nl(this.vc,e.vc)}}function RO(n,e,t,r){const i=n.Cc(1,e,t);dE("Data must be an object, but it was:",i,r);const a=[],o=Rr.empty();gl(r,((u,d)=>{const h=fE(e,u,t);d=dn(d);const p=i.yc(h);if(d instanceof zp)a.push(h);else{const m=Bd(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new ti(a);return new CO(o,c,i.fieldTransforms)}function DO(n,e,t,r,i,a){const o=n.Cc(1,e,t),c=[o_(e,r,t)],u=[i];if(a.length%2!=0)throw new Ie(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(o_(e,a[m])),u.push(a[m+1]);const d=[],h=Rr.empty();for(let m=c.length-1;m>=0;--m)if(!MO(d,c[m])){const b=c[m];let _=u[m];_=dn(_);const w=o.yc(b);if(_ instanceof zp)d.push(b);else{const S=Bd(_,w);S!=null&&(d.push(b),h.set(b,S))}}const p=new ti(d);return new CO(h,p,o.fieldTransforms)}function cH(n,e,t,r=!1){return Bd(t,n.Cc(r?4:3,e))}function Bd(n,e){if(NO(n=dn(n)))return dE("Unsupported field value:",e,n),kO(n,e);if(n instanceof $v)return(function(r,i){if(!IO(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=Bd(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=dn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return W7(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=yt.fromDate(r);return{timestampValue:bd(i.serializer,a)}}if(r instanceof yt){const a=new yt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:bd(i.serializer,a)}}if(r instanceof Qa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Li)return{bytesValue:DP(i.serializer,r._byteString)};if(r instanceof kn){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Fw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Za)return(function(o,c){return{mapValue:{fields:{[Pw]:{stringValue:Ow},[pd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Vw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Iv(r)}`)})(n,e)}function kO(n,e){const t={};return XM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gl(n,((r,i)=>{const a=Bd(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function NO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof yt||n instanceof Qa||n instanceof Li||n instanceof kn||n instanceof $v||n instanceof Za)}function dE(n,e,t){if(!NO(t)||!PM(t)){const r=Iv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function o_(n,e,t){if((e=dn(e))instanceof jp)return e._internalPath;if(typeof e=="string")return fE(n,e);throw Z0("Field path arguments must be of type string or ",n,!1,void 0,t)}const uH=new RegExp("[~\\*/\\[\\]]");function fE(n,e,t){if(e.search(uH)>=0)throw Z0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new jp(...e.split("."))._internalPath}catch{throw Z0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Z0(n,e,t,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Ie(me.INVALID_ARGUMENT,c+n+u)}function MO(n,e){return n.some((t=>t.isEqual(e)))}class PO{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Kv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class dH extends PO{data(){return super.data()}}function Kv(n,e){return typeof e=="string"?fE(n,e):e instanceof jp?e._internalPath:e._delegate._internalPath}function OO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hE{}class pE extends hE{}function Fs(n,e,...t){let r=[];e instanceof hE&&r.push(e),r=r.concat(t),(function(a){const o=a.filter((u=>u instanceof gE)).length,c=a.filter((u=>u instanceof Xv)).length;if(o>1||o>0&&c>0)throw new Ie(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Xv extends pE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Xv(e,t,r)}_apply(e){const t=this._parse(e);return jO(e._query,t),new Zs(e.firestore,e.converter,X1(e._query,t))}_parse(e){const t=Vp(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ie(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){OR(p,h);const _=[];for(const w of p)_.push(PR(u,a,w));m={arrayValue:{values:_}}}else m=PR(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||OR(p,h),m=cH(c,o,p,h==="in"||h==="not-in");return Rt.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function fH(n,e,t){const r=e,i=Kv("where",n);return Xv._create(i,r,t)}class gE extends hE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gE(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Yt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)jO(o,u),o=X1(o,u)})(e._query,t),new Zs(e.firestore,e.converter,X1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mE extends pE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mE(e,t)}_apply(e){const t=(function(i,a,o){if(i.startAt!==null)throw new Ie(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ie(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jh(a,o)})(e._query,this._field,this._direction);return new Zs(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new Vd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function _d(n,e="asc"){const t=e,r=Kv("orderBy",n);return mE._create(r,t)}class vE extends pE{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new vE(e,t,r)}_apply(e){return new Zs(e.firestore,e.converter,F0(e._query,this._limit,this._limitType))}}function MR(n){return vE._create("limit",n,"F")}function PR(n,e,t){if(typeof(t=dn(t))=="string"){if(t==="")throw new Ie(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fP(e)&&t.indexOf("/")!==-1)throw new Ie(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ut.fromString(t));if(!De.isDocumentKey(r))throw new Ie(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Qh(n,new De(r))}if(t instanceof kn)return Qh(n,t._key);throw new Ie(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Iv(t)}.`)}function OR(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jO(n,e){const t=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class hH{convertValue(e,t="none"){switch(rl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return gl(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[pd].arrayValue?.values?.map((r=>gn(r.doubleValue)));return new Za(t)}convertGeoPoint(e){return new Qa(gn(e.latitude),gn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Pv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Xh(e));default:return null}}convertTimestamp(e){const t=Bs(e);return new yt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ut.fromString(e);qe(BP(r),9688,{name:e});const i=new Sc(r.get(1),r.get(3)),a=new De(r.popFirst(5));return i.isEqual(t)||Fr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function yE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class ch{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pc extends PO{constructor(e,t,r,i,a,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new g0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Kv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(me.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=pc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}pc._jsonSchemaVersion="firestore/documentSnapshot/1.0",pc._jsonSchema={type:Zn("string",pc._jsonSchemaVersion),bundleSource:Zn("string","DocumentSnapshot"),bundleName:Zn("string"),bundle:Zn("string")};class g0 extends pc{data(e={}){return super.data(e)}}class gc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ch(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new g0(this._firestore,this._userDataWriter,r.key,r,new ch(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ch(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new g0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new ch(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:pH(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(me.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Aw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function pH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}function Vx(n){n=kr(n,kn);const e=kr(n.firestore,va);return Jq(Op(e),n._key).then((t=>VO(e,n,t)))}gc._jsonSchemaVersion="firestore/querySnapshot/1.0",gc._jsonSchema={type:Zn("string",gc._jsonSchemaVersion),bundleSource:Zn("string","QuerySnapshot"),bundleName:Zn("string"),bundle:Zn("string")};class bE extends hH{constructor(e){super(),this.firestore=e}convertBytes(e){return new Li(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,t)}}function Fa(n){n=kr(n,Zs);const e=kr(n.firestore,va),t=Op(e),r=new bE(e);return OO(n._query),eH(t,n._query).then((i=>new gc(e,r,n,i)))}function ca(n,e,t){n=kr(n,kn);const r=kr(n.firestore,va),i=yE(n.converter,e,t);return Bp(r,[cE(Vp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,or.none())])}function Ba(n,e,t,...r){n=kr(n,kn);const i=kr(n.firestore,va),a=Vp(i);let o;return o=typeof(e=dn(e))=="string"||e instanceof jp?DO(a,"updateDoc",n._key,e,t,r):RO(a,"updateDoc",n._key,e),Bp(i,[o.toMutation(n._key,or.exists(!0))])}function Ga(n){return Bp(kr(n.firestore,va),[new Dp(n._key,or.none())])}function Wv(n,e){const t=kr(n.firestore,va),r=Ft(n),i=yE(n.converter,e);return Bp(t,[cE(Vp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,or.exists(!1))]).then((()=>r))}function Lp(n,...e){n=dn(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||NR(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(NR(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(n instanceof kn)o=kr(n.firestore,va),c=Ip(n._key.path),a={next:u=>{e[r]&&e[r](VO(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=kr(n,Zs);o=kr(u.firestore,va),c=u._query;const d=new bE(o);a={next:h=>{e[r]&&e[r](new gc(o,d,u,h))},error:e[r+1],complete:e[r+2]},OO(n._query)}return(function(d,h,p,m){const b=new lE(m),_=new aE(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>nE(await Q0(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>rE(await Q0(d),_)))}})(Op(o),c,i,a)}function Bp(n,e){return(function(r,i){const a=new Wa;return r.asyncQueue.enqueueAndForget((async()=>Uq(await Zq(r),i,a))),a.promise})(Op(n),e)}function VO(n,e,t){const r=t.docs.get(e._key),i=new bE(n);return new pc(n,i,e._key,r,new ch(t.hasPendingWrites,t.fromCache),e.converter)}class gH{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Vp(e)}set(e,t,r){this._verifyNotCommitted();const i=zx(e,this._firestore),a=yE(i.converter,t,r),o=cE(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,or.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=zx(e,this._firestore);let o;return o=typeof(t=dn(t))=="string"||t instanceof jp?DO(this._dataReader,"WriteBatch.update",a._key,t,r,i):RO(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,or.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=zx(e,this._firestore);return this._mutations=this._mutations.concat(new Dp(t._key,or.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zx(n,e){if((n=dn(n)).firestore!==e)throw new Ie(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function jR(){return new zp("deleteField")}function mH(...n){return new uE("arrayUnion",n)}function vH(n){return Op(n=kr(n,va)),new gH(n,(e=>Bp(n,e)))}(function(e,t=!0){(function(i){jd=i})(Od),od(new bc("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new va(new FF(r.getProvider("auth-internal")),new HF(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ie(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sc(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Qo(hI,pI,e),Qo(hI,pI,"esm2020")})();const yH={apiKey:"AIzaSyCS5qM6LW_IC4bRoK524UQP-9p9GdCxKns",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:ab8b52955e6f0ffd42aba9",measurementId:"G-BCLXBQHT9L"},zO=zN(yH),Oo=jF(zO),vt=nH(zO);rH(vt).catch(n=>{n.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",n)});const Lx=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),fa=hw()(wN(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await bU(Oo,e,t)).user;if(!i.emailVerified)return await nI(Oo),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;const a=Lx(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await yU(Oo,e,t)).user;await _U(a,{displayName:r}),await tI(a);const o=Lx(a);return n({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await nI(Oo),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await vU(Oo,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=Oo.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await tI(e),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=fa.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},deleteAccount:async e=>{const t=Oo.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=jc.credential(t.email,e);return await mU(t,r),await TU(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>fa.getState().isInitialized?()=>{}:(n({isInitialized:!1}),SU(Oo,r=>{const i=Date.now(),a=fa.getState(),o=r?Lx(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m?console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"):console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),pn=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:fa},Symbol.toStringTag,{value:"Module"})),LO=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],bH=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=LO.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},xE=n=>{const e=LO.map(i=>({...i,met:i.regex.test(n)})),t=bH(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},xH=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=xE(n);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},_H=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=xE(n);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(EL,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(Ev,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},wH=()=>{const[n,e]=U.useState(""),[t,r]=U.useState(""),[i,a]=U.useState(""),[o,c]=U.useState(!1),[u,d]=U.useState(!1),[h,p]=U.useState(!1),[m,b]=U.useState(!1),{login:_,register:w,sendPasswordReset:S,isLoading:T,loginError:A,clearError:D}=fa(),P=xE(t),M=async C=>{if(C.preventDefault(),D(),n.trim()&&t.trim())if(u){if(!i.trim()||!P.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},V=async C=>{C.preventDefault(),n.trim()&&await S(n.trim())&&b(!0)};return U.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:V,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(A1,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:n,onChange:C=>e(C.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(A1,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:n})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(sd,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(sd,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:M,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:n,onChange:C=>e(C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:C=>a(C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:t,onChange:C=>r(C.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!P.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx(LL,{className:"h-5 w-5"}):v.jsx(UL,{className:"h-5 w-5"})})]}),u&&t&&v.jsx("div",{className:"mt-2",children:v.jsx(xH,{password:t})}),u&&t&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(_H,{password:t})})]}),A&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[A,A.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!P.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(A9,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},BO=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(!1),{currentUser:i,resendEmailVerification:a,logout:o,loginError:c}=fa();U.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]);const u=async()=>{e(!0),r(!1);const h=await a();e(!1),h&&(r(!0),setTimeout(()=>r(!1),3e3))},d=async()=>{await o()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(A1,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(T1,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),c&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:c}),t&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:u,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?v.jsxs(v.Fragment,{children:[v.jsx(zh,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(zh,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:d,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(sd,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},UO=({message:n="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(zh,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(wv,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),_E=U.createContext({});function Qv(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const wE=typeof window<"u",EE=wE?U.useLayoutEffect:U.useEffect,Zv=U.createContext(null);function SE(n,e){n.indexOf(e)===-1&&n.push(e)}function TE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Gs=(n,e,t)=>t>e?e:t<n?n:t;let AE=()=>{};const qs={},FO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function GO(n){return typeof n=="object"&&n!==null}const qO=n=>/^0[^.\s]+$/u.test(n);function CE(n){let e;return()=>(e===void 0&&(e=n()),e)}const Gi=n=>n,EH=(n,e)=>t=>e(n(t)),Up=(...n)=>n.reduce(EH),rp=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class IE{constructor(){this.subscriptions=[]}add(e){return SE(this.subscriptions,e),()=>TE(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ja=n=>n*1e3,Ui=n=>n/1e3;function HO(n,e){return e?n*(1e3/e):0}const $O=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,SH=1e-7,TH=12;function AH(n,e,t,r,i){let a,o,c=0;do o=e+(t-e)/2,a=$O(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>SH&&++c<TH);return o}function Fp(n,e,t,r){if(n===e&&t===r)return Gi;const i=a=>AH(a,0,1,n,t);return a=>a===0||a===1?a:$O(i(a),e,r)}const YO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,KO=n=>e=>1-n(1-e),XO=Fp(.33,1.53,.69,.99),RE=KO(XO),WO=YO(RE),QO=n=>(n*=2)<1?.5*RE(n):.5*(2-Math.pow(2,-10*(n-1))),DE=n=>1-Math.sin(Math.acos(n)),ZO=KO(DE),JO=YO(DE),CH=Fp(.42,0,1,1),IH=Fp(0,0,.58,1),e4=Fp(.42,0,.58,1),RH=n=>Array.isArray(n)&&typeof n[0]!="number",t4=n=>Array.isArray(n)&&typeof n[0]=="number",DH={linear:Gi,easeIn:CH,easeInOut:e4,easeOut:IH,circIn:DE,circInOut:JO,circOut:ZO,backIn:RE,backInOut:WO,backOut:XO,anticipate:QO},kH=n=>typeof n=="string",VR=n=>{if(t4(n)){AE(n.length===4);const[e,t,r,i]=n;return Fp(e,t,r,i)}else if(kH(n))return DH[n];return n},Pm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function NH(n,e){let t=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const MH=40;function n4(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=Pm.reduce((D,P)=>(D[P]=NH(a),D),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=o,w=()=>{const D=qs.useManualTiming?i.timestamp:performance.now();t=!1,qs.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(D-i.timestamp,MH),1)),i.timestamp=D,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},S=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:Pm.reduce((D,P)=>{const M=o[P];return D[P]=(V,C=!1,I=!1)=>(t||S(),M.schedule(V,C,I)),D},{}),cancel:D=>{for(let P=0;P<Pm.length;P++)o[Pm[P]].cancel(D)},state:i,steps:o}}const{schedule:mn,cancel:ol,state:_r,steps:Bx}=n4(typeof requestAnimationFrame<"u"?requestAnimationFrame:Gi,!0);let m0;function PH(){m0=void 0}const ni={now:()=>(m0===void 0&&ni.set(_r.isProcessing||qs.useManualTiming?_r.timestamp:performance.now()),m0),set:n=>{m0=n,queueMicrotask(PH)}},r4=n=>e=>typeof e=="string"&&e.startsWith(n),kE=r4("--"),OH=r4("var(--"),NE=n=>OH(n)?jH.test(n.split("/*")[0].trim()):!1,jH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Ud={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},ip={...Ud,transform:n=>Gs(0,1,n)},Om={...Ud,default:1},Ah=n=>Math.round(n*1e5)/1e5,ME=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function VH(n){return n==null}const zH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,PE=(n,e)=>t=>!!(typeof t=="string"&&zH.test(t)&&t.startsWith(n)||e&&!VH(t)&&Object.prototype.hasOwnProperty.call(t,e)),i4=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(ME);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},LH=n=>Gs(0,255,n),Ux={...Ud,transform:n=>Math.round(LH(n))},sc={test:PE("rgb","red"),parse:i4("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+Ux.transform(n)+", "+Ux.transform(e)+", "+Ux.transform(t)+", "+Ah(ip.transform(r))+")"};function BH(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const l_={test:PE("#"),parse:BH,transform:sc.transform},Gp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),zo=Gp("deg"),es=Gp("%"),rt=Gp("px"),UH=Gp("vh"),FH=Gp("vw"),zR={...es,parse:n=>es.parse(n)/100,transform:n=>es.transform(n*100)},Fu={test:PE("hsl","hue"),parse:i4("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+es.transform(Ah(e))+", "+es.transform(Ah(t))+", "+Ah(ip.transform(r))+")"},Xn={test:n=>sc.test(n)||l_.test(n)||Fu.test(n),parse:n=>sc.test(n)?sc.parse(n):Fu.test(n)?Fu.parse(n):l_.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?sc.transform(n):Fu.transform(n),getAnimatableNone:n=>{const e=Xn.parse(n);return e.alpha=0,Xn.transform(e)}},GH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function qH(n){return isNaN(n)&&typeof n=="string"&&(n.match(ME)?.length||0)+(n.match(GH)?.length||0)>0}const a4="number",s4="color",HH="var",$H="var(",LR="${}",YH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ap(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(YH,u=>(Xn.test(u)?(r.color.push(a),i.push(s4),t.push(Xn.parse(u))):u.startsWith($H)?(r.var.push(a),i.push(HH),t.push(u)):(r.number.push(a),i.push(a4),t.push(parseFloat(u))),++a,LR)).split(LR);return{values:t,split:c,indexes:r,types:i}}function o4(n){return ap(n).values}function l4(n){const{split:e,types:t}=ap(n),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=t[o];c===a4?a+=Ah(i[o]):c===s4?a+=Xn.transform(i[o]):a+=i[o]}return a}}const KH=n=>typeof n=="number"?0:Xn.test(n)?Xn.getAnimatableNone(n):n;function XH(n){const e=o4(n);return l4(n)(e.map(KH))}const ll={test:qH,parse:o4,createTransformer:l4,getAnimatableNone:XH};function Fx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function WH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=Fx(u,c,n+1/3),a=Fx(u,c,n),o=Fx(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function J0(n,e){return t=>t>0?e:n}const En=(n,e,t)=>n+(e-n)*t,Gx=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},QH=[l_,sc,Fu],ZH=n=>QH.find(e=>e.test(n));function BR(n){const e=ZH(n);if(!e)return!1;let t=e.parse(n);return e===Fu&&(t=WH(t)),t}const UR=(n,e)=>{const t=BR(n),r=BR(e);if(!t||!r)return J0(n,e);const i={...t};return a=>(i.red=Gx(t.red,r.red,a),i.green=Gx(t.green,r.green,a),i.blue=Gx(t.blue,r.blue,a),i.alpha=En(t.alpha,r.alpha,a),sc.transform(i))},c_=new Set(["none","hidden"]);function JH(n,e){return c_.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function e$(n,e){return t=>En(n,e,t)}function OE(n){return typeof n=="number"?e$:typeof n=="string"?NE(n)?J0:Xn.test(n)?UR:r$:Array.isArray(n)?c4:typeof n=="object"?Xn.test(n)?UR:t$:J0}function c4(n,e){const t=[...n],r=t.length,i=n.map((a,o)=>OE(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)t[o]=i[o](a);return t}}function t$(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=OE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function n$(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=n.indexes[a][r[a]],c=n.values[o]??0;t[i]=c,r[a]++}return t}const r$=(n,e)=>{const t=ll.createTransformer(e),r=ap(n),i=ap(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?c_.has(n)&&!i.values.length||c_.has(e)&&!r.values.length?JH(n,e):Up(c4(n$(r,i),i.values),t):J0(n,e)};function u4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?En(n,e,t):OE(n)(n,e)}const i$=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>mn.update(e,t),stop:()=>ol(e),now:()=>_r.isProcessing?_r.timestamp:ni.now()}},d4=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},ev=2e4;function jE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<ev;)e+=t,r=n.next(e);return e>=ev?1/0:e}function a$(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(jE(r),ev);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Ui(i)}}const s$=5;function f4(n,e,t){const r=Math.max(e-s$,0);return HO(t-n(r),e-r)}const Rn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},qx=.001;function o$({duration:n=Rn.duration,bounce:e=Rn.bounce,velocity:t=Rn.velocity,mass:r=Rn.mass}){let i,a,o=1-e;o=Gs(Rn.minDamping,Rn.maxDamping,o),n=Gs(Rn.minDuration,Rn.maxDuration,Ui(n)),o<1?(i=d=>{const h=d*o,p=h*n,m=h-t,b=u_(d,o),_=Math.exp(-p);return qx-m/b*_},a=d=>{const p=d*o*n,m=p*t+t,b=Math.pow(o,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=u_(Math.pow(d,2),o);return(-i(d)+qx>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-qx+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=c$(i,a,c);if(n=Ja(n),isNaN(u))return{stiffness:Rn.stiffness,damping:Rn.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const l$=12;function c$(n,e,t){let r=t;for(let i=1;i<l$;i++)r=r-n(r)/e(r);return r}function u_(n,e){return n*Math.sqrt(1-e*e)}const u$=["duration","bounce"],d$=["stiffness","damping","mass"];function FR(n,e){return e.some(t=>n[t]!==void 0)}function f$(n){let e={velocity:Rn.velocity,stiffness:Rn.stiffness,damping:Rn.damping,mass:Rn.mass,isResolvedFromDuration:!1,...n};if(!FR(n,d$)&&FR(n,u$))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*Gs(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Rn.mass,stiffness:i,damping:a}}else{const t=o$(n);e={...e,...t,mass:Rn.mass},e.isResolvedFromDuration=!0}return e}function tv(n=Rn.visualDuration,e=Rn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=f$({...t,velocity:-Ui(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),S=o-a,T=Ui(Math.sqrt(u/h)),A=Math.abs(S)<5;r||(r=A?Rn.restSpeed.granular:Rn.restSpeed.default),i||(i=A?Rn.restDelta.granular:Rn.restDelta.default);let D;if(w<1){const M=u_(T,w);D=V=>{const C=Math.exp(-w*T*V);return o-C*((_+w*T*S)/M*Math.sin(M*V)+S*Math.cos(M*V))}}else if(w===1)D=M=>o-Math.exp(-T*M)*(S+(_+T*S)*M);else{const M=T*Math.sqrt(w*w-1);D=V=>{const C=Math.exp(-w*T*V),I=Math.min(M*V,300);return o-C*((_+w*T*S)*Math.sinh(I)+M*S*Math.cosh(I))/M}}const P={calculatedDuration:b&&p||null,next:M=>{const V=D(M);if(b)c.done=M>=p;else{let C=M===0?_:0;w<1&&(C=M===0?Ja(_):f4(D,M,V));const I=Math.abs(C)<=r,k=Math.abs(o-V)<=i;c.done=I&&k}return c.value=c.done?o:V,c},toString:()=>{const M=Math.min(jE(P),ev),V=d4(C=>P.next(M*C).value,M,30);return M+"ms "+V},toTransition:()=>{}};return P}tv.applyToOptions=n=>{const e=a$(n,100,tv);return n.ease=e.ease,n.duration=Ja(e.duration),n.type="keyframes",n};function d_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=I=>c!==void 0&&I<c||u!==void 0&&I>u,_=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let w=t*e;const S=p+w,T=o===void 0?S:o(S);T!==S&&(w=T-p);const A=I=>-w*Math.exp(-I/r),D=I=>T+A(I),P=I=>{const k=A(I),z=D(I);m.done=Math.abs(k)<=d,m.value=m.done?T:z};let M,V;const C=I=>{b(m.value)&&(M=I,V=tv({keyframes:[m.value,_(m.value)],velocity:f4(D,I,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return C(0),{calculatedDuration:null,next:I=>{let k=!1;return!V&&M===void 0&&(k=!0,P(I),C(I)),M!==void 0&&I>=M?V.next(I-M):(!k&&P(I),m)}}}function h$(n,e,t){const r=[],i=t||qs.mix||u4,a=n.length-1;for(let o=0;o<a;o++){let c=i(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Gi:e;c=Up(u,c)}r.push(c)}return r}function p$(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(AE(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=h$(e,r,i),u=c.length,d=h=>{if(o&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=rp(n[p],n[p+1],h);return c[p](m)};return t?h=>d(Gs(n[0],n[a-1],h)):d}function g$(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=rp(0,e,r);n.push(En(t,1,i))}}function m$(n){const e=[0];return g$(e,n.length-1),e}function v$(n,e){return n.map(t=>t*e)}function y$(n,e){return n.map(()=>e||e4).splice(0,n.length-1)}function Ch({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=RH(r)?r.map(VR):VR(r),a={done:!1,value:e[0]},o=v$(t&&t.length===e.length?t:m$(e),n),c=p$(o,e,{ease:Array.isArray(i)?i:y$(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const b$=n=>n!==null;function VE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(b$),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const x$={decay:d_,inertia:d_,tween:Ch,keyframes:Ch,spring:tv};function h4(n){typeof n.type=="string"&&(n.type=x$[n.type])}class zE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const _$=n=>n/100;class LE extends zE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==ni.now()&&this.tick(ni.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;h4(e);const{type:t=Ch,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=t||Ch;u!==Ch&&typeof c[0]!="number"&&(this.mixKeyframes=Up(_$,u4(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=jE(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let D=this.currentTime,P=r;if(p){const I=Math.min(this.currentTime,i)/c;let k=Math.floor(I),z=I%1;!z&&I>=1&&(z=1),z===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(z=1-z,b&&(z-=b/c)):m==="mirror"&&(P=o)),D=Gs(0,1,z)*c}const M=A?{done:!1,value:h[0]}:P.next(D);a&&(M.value=a(M.value));let{done:V}=M;!A&&u!==null&&(V=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const C=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return C&&_!==d_&&(M.value=VE(h,this.options,S,this.speed)),w&&w(M.value),C&&this.finish(),M}then(e,t){return this.finished.then(e,t)}get duration(){return Ui(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ui(e)}get time(){return Ui(this.currentTime)}set time(e){e=Ja(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ni.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Ui(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=i$,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ni.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function w$(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const oc=n=>n*180/Math.PI,f_=n=>{const e=oc(Math.atan2(n[1],n[0]));return h_(e)},E$={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:f_,rotateZ:f_,skewX:n=>oc(Math.atan(n[1])),skewY:n=>oc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},h_=n=>(n=n%360,n<0&&(n+=360),n),GR=f_,qR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),HR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),S$={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:qR,scaleY:HR,scale:n=>(qR(n)+HR(n))/2,rotateX:n=>h_(oc(Math.atan2(n[6],n[5]))),rotateY:n=>h_(oc(Math.atan2(-n[2],n[0]))),rotateZ:GR,rotate:GR,skewX:n=>oc(Math.atan(n[4])),skewY:n=>oc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function p_(n){return n.includes("scale")?1:0}function g_(n,e){if(!n||n==="none")return p_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=S$,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=E$,i=c}if(!i)return p_(e);const a=r[e],o=i[1].split(",").map(A$);return typeof a=="function"?a(o):o[a]}const T$=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return g_(t,e)};function A$(n){return parseFloat(n.trim())}const Fd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Gd=new Set(Fd),$R=n=>n===Ud||n===rt,C$=new Set(["x","y","z"]),I$=Fd.filter(n=>!C$.has(n));function R$(n){const e=[];return I$.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const mc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>g_(e,"x"),y:(n,{transform:e})=>g_(e,"y")};mc.translateX=mc.x;mc.translateY=mc.y;const vc=new Set;let m_=!1,v_=!1,y_=!1;function p4(){if(v_){const n=Array.from(vc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=R$(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}v_=!1,m_=!1,vc.forEach(n=>n.complete(y_)),vc.clear()}function g4(){vc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(v_=!0)})}function D$(){y_=!0,g4(),p4(),y_=!1}class BE{constructor(e,t,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(vc.add(this),m_||(m_=!0,mn.read(g4),mn.resolveKeyframes(p4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}w$(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),vc.delete(this)}cancel(){this.state==="scheduled"&&(vc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const k$=n=>n.startsWith("--");function N$(n,e,t){k$(e)?n.style.setProperty(e,t):n.style[e]=t}const M$=CE(()=>window.ScrollTimeline!==void 0),P$={};function O$(n,e){const t=CE(n);return()=>P$[e]??t()}const m4=O$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),uh=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,YR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:uh([0,.65,.55,1]),circOut:uh([.55,0,1,.45]),backIn:uh([.31,.01,.66,-.59]),backOut:uh([.33,1.53,.69,.99])};function v4(n,e){if(n)return typeof n=="function"?m4()?d4(n,e):"ease-out":t4(n)?uh(n):Array.isArray(n)?n.map(t=>v4(t,e)||YR.easeOut):YR[n]}function j$(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=v4(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function y4(n){return typeof n=="function"&&"applyToOptions"in n}function V$({type:n,...e}){return y4(n)&&m4()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class z$ extends zE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,AE(typeof e.type!="string");const d=V$(e);this.animation=j$(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=VE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):N$(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Ui(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ui(e)}get time(){return Ui(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ja(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&M$()?(this.animation.timeline=e,Gi):t(this)}}const b4={anticipate:QO,backInOut:WO,circInOut:JO};function L$(n){return n in b4}function B$(n){typeof n.ease=="string"&&L$(n.ease)&&(n.ease=b4[n.ease])}const KR=10;class U$ extends z${constructor(e){B$(e),h4(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new LE({...o,autoplay:!1}),u=Ja(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-KR).value,c.sample(u).value,KR),c.stop()}}const XR=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ll.test(n)||n==="0")&&!n.startsWith("url("));function F$(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function G$(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],o=XR(i,e),c=XR(a,e);return!o||!c?!1:F$(n)||(t==="spring"||y4(t))&&r}function b_(n){n.duration=0,n.type="keyframes"}const q$=new Set(["opacity","clipPath","filter","transform"]),H$=CE(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function $$(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return H$()&&t&&q$.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const Y$=40;class K$ extends zE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ni.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||BE;this.keyframeResolver=new b(c,(_,w,S)=>this.onKeyframesResolved(_,w,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=ni.now(),G$(e,a,o,c)||((qs.instantAnimations||!u)&&h?.(VE(e,r,t)),e[0]=e[e.length-1],b_(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Y$?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&$$(m)?new U$({...m,element:m.motionValue.owner.current}):new LE(m);b.finished.then(()=>this.notifyFinished()).catch(Gi),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),D$()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const X$=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function W$(n){const e=X$.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function x4(n,e,t=1){const[r,i]=W$(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return FO(o)?parseFloat(o):o}return NE(i)?x4(i,e,t+1):i}function UE(n,e){return n?.[e]??n?.default??n}const _4=new Set(["width","height","top","left","right","bottom",...Fd]),Q$={test:n=>n==="auto",parse:n=>n},w4=n=>e=>e.test(n),E4=[Ud,rt,es,zo,FH,UH,Q$],WR=n=>E4.find(w4(n));function Z$(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||qO(n):!0}const J$=new Set(["brightness","contrast","saturate","opacity"]);function eY(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(ME)||[];if(!r)return n;const i=t.replace(r,"");let a=J$.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const tY=/\b([a-z-]*)\(.*?\)/gu,x_={...ll,getAnimatableNone:n=>{const e=n.match(tY);return e?e.map(eY).join(" "):n}},QR={...Ud,transform:Math.round},nY={rotate:zo,rotateX:zo,rotateY:zo,rotateZ:zo,scale:Om,scaleX:Om,scaleY:Om,scaleZ:Om,skew:zo,skewX:zo,skewY:zo,distance:rt,translateX:rt,translateY:rt,translateZ:rt,x:rt,y:rt,z:rt,perspective:rt,transformPerspective:rt,opacity:ip,originX:zR,originY:zR,originZ:rt},FE={borderWidth:rt,borderTopWidth:rt,borderRightWidth:rt,borderBottomWidth:rt,borderLeftWidth:rt,borderRadius:rt,radius:rt,borderTopLeftRadius:rt,borderTopRightRadius:rt,borderBottomRightRadius:rt,borderBottomLeftRadius:rt,width:rt,maxWidth:rt,height:rt,maxHeight:rt,top:rt,right:rt,bottom:rt,left:rt,padding:rt,paddingTop:rt,paddingRight:rt,paddingBottom:rt,paddingLeft:rt,margin:rt,marginTop:rt,marginRight:rt,marginBottom:rt,marginLeft:rt,backgroundPositionX:rt,backgroundPositionY:rt,...nY,zIndex:QR,fillOpacity:ip,strokeOpacity:ip,numOctaves:QR},rY={...FE,color:Xn,backgroundColor:Xn,outlineColor:Xn,fill:Xn,stroke:Xn,borderColor:Xn,borderTopColor:Xn,borderRightColor:Xn,borderBottomColor:Xn,borderLeftColor:Xn,filter:x_,WebkitFilter:x_},S4=n=>rY[n];function T4(n,e){let t=S4(n);return t!==x_&&(t=ll),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const iY=new Set(["auto","none","0"]);function aY(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!iY.has(a)&&ap(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=T4(t,i)}class sY extends BE{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),NE(d))){const h=x4(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!_4.has(r)||e.length!==2)return;const[i,a]=e,o=WR(i),c=WR(a);if(o!==c)if($R(o)&&$R(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else mc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||Z$(e[i]))&&r.push(i);r.length&&aY(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=mc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=mc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function oY(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const A4=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function C4(n){return GO(n)&&"offsetHeight"in n}const ZR=30,lY=n=>!isNaN(parseFloat(n));class cY{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=ni.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ni.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=lY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new IE);const r=this.events[e].add(t);return e==="change"?()=>{r(),mn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ni.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>ZR)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,ZR);return HO(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function wd(n,e){return new cY(n,e)}const{schedule:GE}=n4(queueMicrotask,!1),oa={x:!1,y:!1};function I4(){return oa.x||oa.y}function uY(n){return n==="x"||n==="y"?oa[n]?null:(oa[n]=!0,()=>{oa[n]=!1}):oa.x||oa.y?null:(oa.x=oa.y=!0,()=>{oa.x=oa.y=!1})}function R4(n,e){const t=oY(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function JR(n){return!(n.pointerType==="touch"||I4())}function dY(n,e,t={}){const[r,i,a]=R4(n,t),o=c=>{if(!JR(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{JR(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const D4=(n,e)=>e?n===e?!0:D4(n,e.parentElement):!1,qE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,fY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function hY(n){return fY.has(n.tagName)||n.tabIndex!==-1}const v0=new WeakSet;function eD(n){return e=>{e.key==="Enter"&&n(e)}}function Hx(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const pY=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=eD(()=>{if(v0.has(t))return;Hx(t,"down");const i=eD(()=>{Hx(t,"up")}),a=()=>Hx(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function tD(n){return qE(n)&&!I4()}function gY(n,e,t={}){const[r,i,a]=R4(n,t),o=c=>{const u=c.currentTarget;if(!tD(c))return;v0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),v0.has(u)&&v0.delete(u),tD(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||D4(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),C4(c)&&(c.addEventListener("focus",d=>pY(d,i)),!hY(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function k4(n){return GO(n)&&"ownerSVGElement"in n}function mY(n){return k4(n)&&n.tagName==="svg"}const Dr=n=>!!(n&&n.getVelocity),vY=[...E4,Xn,ll],yY=n=>vY.find(w4(n)),HE=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function nD(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function bY(...n){return e=>{let t=!1;const r=n.map(i=>{const a=nD(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():nD(n[i],null)}}}}function xY(...n){return U.useCallback(bY(...n),n)}class _Y extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=C4(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function wY({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),a=U.useRef(null),o=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=U.useContext(HE),u=xY(a,n?.ref);return U.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const S=r??document.head;return S.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(w)&&S.removeChild(w)}},[e]),v.jsx(_Y,{isPresent:e,childRef:a,sizeRef:o,children:U.cloneElement(n,{ref:u})})}const EY=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=Qv(SY),h=U.useId();let p=!0,m=U.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),U.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),U.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),o==="popLayout"&&(n=v.jsx(wY,{isPresent:t,anchorX:c,root:u,children:n})),v.jsx(Zv.Provider,{value:m,children:n})};function SY(){return new Map}function N4(n=!0){const e=U.useContext(Zv);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=U.useId();U.useEffect(()=>{if(n)return i(a)},[n]);const o=U.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,o]:[!0]}const jm=n=>n.key||"";function rD(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const ri=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=N4(o),p=U.useMemo(()=>rD(n),[n]),m=o&&!d?[]:p.map(jm),b=U.useRef(!0),_=U.useRef(p),w=Qv(()=>new Map),[S,T]=U.useState(p),[A,D]=U.useState(p);EE(()=>{b.current=!1,_.current=p;for(let V=0;V<A.length;V++){const C=jm(A[V]);m.includes(C)?w.delete(C):w.get(C)!==!0&&w.set(C,!1)}},[A,m.length,m.join("-")]);const P=[];if(p!==S){let V=[...p];for(let C=0;C<A.length;C++){const I=A[C],k=jm(I);m.includes(k)||(V.splice(C,0,I),P.push(I))}return a==="wait"&&P.length&&(V=P),D(rD(V)),T(p),null}const{forceRender:M}=U.useContext(_E);return v.jsx(v.Fragment,{children:A.map(V=>{const C=jm(V),I=o&&!d?!1:p===A||m.includes(C),k=()=>{if(w.has(C))w.set(C,!0);else return;let z=!0;w.forEach(L=>{L||(z=!1)}),z&&(M?.(),D(_.current),o&&h?.(),r&&r())};return v.jsx(EY,{isPresent:I,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:I?void 0:k,anchorX:c,children:V},C)})})},M4=U.createContext({strict:!1}),iD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ed={};for(const n in iD)Ed[n]={isEnabled:e=>iD[n].some(t=>!!e[t])};function TY(n){for(const e in n)Ed[e]={...Ed[e],...n[e]}}const AY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function nv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||AY.has(n)}let P4=n=>!nv(n);function CY(n){typeof n=="function"&&(P4=e=>e.startsWith("on")?!nv(e):n(e))}try{CY(require("@emotion/is-prop-valid").default)}catch{}function IY(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(P4(i)||t===!0&&nv(i)||!e&&!nv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const Jv=U.createContext({});function ey(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function sp(n){return typeof n=="string"||Array.isArray(n)}const $E=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],YE=["initial",...$E];function ty(n){return ey(n.animate)||YE.some(e=>sp(n[e]))}function O4(n){return!!(ty(n)||n.variants)}function RY(n,e){if(ty(n)){const{initial:t,animate:r}=n;return{initial:t===!1||sp(t)?t:void 0,animate:sp(r)?r:void 0}}return n.inherit!==!1?e:{}}function DY(n){const{initial:e,animate:t}=RY(n,U.useContext(Jv));return U.useMemo(()=>({initial:e,animate:t}),[aD(e),aD(t)])}function aD(n){return Array.isArray(n)?n.join(" "):n}const op={};function kY(n){for(const e in n)op[e]=n[e],kE(e)&&(op[e].isCSSVariable=!0)}function j4(n,{layout:e,layoutId:t}){return Gd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!op[n]||n==="opacity")}const NY={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},MY=Fd.length;function PY(n,e,t){let r="",i=!0;for(let a=0;a<MY;a++){const o=Fd[a],c=n[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=A4(c,FE[o]);if(!u){i=!1;const h=NY[o]||o;r+=`${h}(${d}) `}t&&(e[o]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function KE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let o=!1,c=!1;for(const u in e){const d=e[u];if(Gd.has(u)){o=!0;continue}else if(kE(u)){i[u]=d;continue}else{const h=A4(d,FE[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||t?r.transform=PY(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const XE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function V4(n,e,t){for(const r in e)!Dr(e[r])&&!j4(r,t)&&(n[r]=e[r])}function OY({transformTemplate:n},e){return U.useMemo(()=>{const t=XE();return KE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function jY(n,e){const t=n.style||{},r={};return V4(r,t,n),Object.assign(r,OY(n,e)),r}function VY(n,e){const t={},r=jY(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const zY={offset:"stroke-dashoffset",array:"stroke-dasharray"},LY={offset:"strokeDashoffset",array:"strokeDasharray"};function BY(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?zY:LY;n[a.offset]=rt.transform(-r);const o=rt.transform(e),c=rt.transform(t);n[a.array]=`${o} ${c}`}function z4(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(KE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&BY(p,i,a,o,!1)}const L4=()=>({...XE(),attrs:{}}),B4=n=>typeof n=="string"&&n.toLowerCase()==="svg";function UY(n,e,t,r){const i=U.useMemo(()=>{const a=L4();return z4(a,e,B4(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};V4(a,n.style,n),i.style={...a,...i.style}}return i}const FY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function WE(n){return typeof n!="string"||n.includes("-")?!1:!!(FY.indexOf(n)>-1||/[A-Z]/u.test(n))}function GY(n,e,t,{latestValues:r},i,a=!1){const c=(WE(n)?UY:VY)(e,r,i,n),u=IY(e,typeof n=="string",a),d=n!==U.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=U.useMemo(()=>Dr(h)?h.get():h,[h]);return U.createElement(n,{...d,children:p})}function sD(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function QE(n,e,t,r){if(typeof e=="function"){const[i,a]=sD(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=sD(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function y0(n){return Dr(n)?n.get():n}function qY({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:HY(t,r,i,n),renderState:e()}}function HY(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=y0(a[m]);let{initial:o,animate:c}=n;const u=ty(n),d=O4(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!ey(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=QE(n,m[b]);if(_){const{transitionEnd:w,transition:S,...T}=_;for(const A in T){let D=T[A];if(Array.isArray(D)){const P=h?D.length-1:0;D=D[P]}D!==null&&(i[A]=D)}for(const A in w)i[A]=w[A]}}}return i}const U4=n=>(e,t)=>{const r=U.useContext(Jv),i=U.useContext(Zv),a=()=>qY(n,e,r,i);return t?a():Qv(a)};function ZE(n,e,t){const{style:r}=n,i={};for(const a in r)(Dr(r[a])||e.style&&Dr(e.style[a])||j4(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const $Y=U4({scrapeMotionValuesFromProps:ZE,createRenderState:XE});function F4(n,e,t){const r=ZE(n,e,t);for(const i in n)if(Dr(n[i])||Dr(e[i])){const a=Fd.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const YY=U4({scrapeMotionValuesFromProps:F4,createRenderState:L4}),KY=Symbol.for("motionComponentSymbol");function Gu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function XY(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Gu(t)&&(t.current=r))},[e])}const JE=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),WY="framerAppearId",G4="data-"+JE(WY),q4=U.createContext({});function QY(n,e,t,r,i){const{visualElement:a}=U.useContext(Jv),o=U.useContext(M4),c=U.useContext(Zv),u=U.useContext(HE).reducedMotion,d=U.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=U.useContext(q4);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&ZY(d.current,t,i,p);const m=U.useRef(!1);U.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[G4],_=U.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return EE(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),U.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function ZY(n,e,t,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:H4(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&Gu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function H4(n){if(n)return n.options.allowProjection!==!1?n.projection:H4(n.parent)}function $x(n,{forwardMotionProps:e=!1}={},t,r){t&&TY(t);const i=WE(n)?YY:$Y;function a(c,u){let d;const h={...U.useContext(HE),...c,layoutId:JY(c)},{isStatic:p}=h,m=DY(c),b=i(c,p);if(!p&&wE){eK();const _=tK(h);d=_.MeasureLayout,m.visualElement=QY(n,b,h,r,_.ProjectionNode)}return v.jsxs(Jv.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,GY(n,c,XY(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=U.forwardRef(a);return o[KY]=n,o}function JY({layoutId:n}){const e=U.useContext(_E).id;return e&&n!==void 0?e+"-"+n:n}function eK(n,e){U.useContext(M4).strict}function tK(n){const{drag:e,layout:t}=Ed;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function nK(n,e){if(typeof Proxy>"u")return $x;const t=new Map,r=(a,o)=>$x(a,o,n,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(t.has(o)||t.set(o,$x(o,void 0,n,e)),t.get(o))})}function $4({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function rK({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function iK(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function Yx(n){return n===void 0||n===1}function __({scale:n,scaleX:e,scaleY:t}){return!Yx(n)||!Yx(e)||!Yx(t)}function Xl(n){return __(n)||Y4(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function Y4(n){return oD(n.x)||oD(n.y)}function oD(n){return n&&n!=="0%"}function rv(n,e,t){const r=n-t,i=e*r;return t+i}function lD(n,e,t,r,i){return i!==void 0&&(n=rv(n,i,r)),rv(n,t,r)+e}function w_(n,e=0,t=1,r,i){n.min=lD(n.min,e,t,r,i),n.max=lD(n.max,e,t,r,i)}function K4(n,{x:e,y:t}){w_(n.x,e.translate,e.scale,e.originPoint),w_(n.y,t.translate,t.scale,t.originPoint)}const cD=.999999999999,uD=1.0000000000001;function aK(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=t[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Hu(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,K4(n,o)),r&&Xl(a.latestValues)&&Hu(n,a.latestValues))}e.x<uD&&e.x>cD&&(e.x=1),e.y<uD&&e.y>cD&&(e.y=1)}function qu(n,e){n.min=n.min+e,n.max=n.max+e}function dD(n,e,t,r,i=.5){const a=En(n.min,n.max,i);w_(n,e,t,a,r)}function Hu(n,e){dD(n.x,e.x,e.scaleX,e.scale,e.originX),dD(n.y,e.y,e.scaleY,e.scale,e.originY)}function X4(n,e){return $4(iK(n.getBoundingClientRect(),e))}function sK(n,e,t){const r=X4(n,t),{scroll:i}=e;return i&&(qu(r.x,i.offset.x),qu(r.y,i.offset.y)),r}const fD=()=>({translate:0,scale:1,origin:0,originPoint:0}),$u=()=>({x:fD(),y:fD()}),hD=()=>({min:0,max:0}),zn=()=>({x:hD(),y:hD()}),E_={current:null},W4={current:!1};function oK(){if(W4.current=!0,!!wE)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>E_.current=n.matches;n.addEventListener("change",e),e()}else E_.current=!1}const lK=new WeakMap;function cK(n,e,t){for(const r in e){const i=e[r],a=t[r];if(Dr(i))n.addValue(r,i);else if(Dr(a))n.addValue(r,wd(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,wd(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const pD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class uK{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=BE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ni.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,mn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=ty(t),this.isVariantNode=O4(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&Dr(b)&&b.set(u[m])}}mount(e){this.current=e,lK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),W4.current||oK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:E_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ol(this.notifyUpdate),ol(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Gd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&mn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ed){const t=Ed[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):zn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<pD.length;r++){const i=pD[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=cK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=wd(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(FO(r)||qO(r))?r=parseFloat(r):!yY(r)&&ll.test(t)&&(r=T4(e,t)),this.setBaseTarget(e,Dr(r)?r.get():r)),Dr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=QE(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Dr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new IE),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){GE.render(this.render)}}class Q4 extends uK{constructor(){super(...arguments),this.KeyframeResolver=sY}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Dr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function Z4(n,{style:e,vars:t},r,i){const a=n.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in t)a.setProperty(o,t[o])}function dK(n){return window.getComputedStyle(n)}class fK extends Q4{constructor(){super(...arguments),this.type="html",this.renderInstance=Z4}readValueFromInstance(e,t){if(Gd.has(t))return this.projection?.isProjecting?p_(t):T$(e,t);{const r=dK(e),i=(kE(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return X4(e,t)}build(e,t,r){KE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return ZE(e,t,r)}}const J4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function hK(n,e,t,r){Z4(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(J4.has(i)?i:JE(i),e.attrs[i])}class pK extends Q4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=zn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Gd.has(t)){const r=S4(t);return r&&r.default||0}return t=J4.has(t)?t:JE(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return F4(e,t,r)}build(e,t,r){z4(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){hK(e,t,r,i)}mount(e){this.isSVGTag=B4(e.tagName),super.mount(e)}}const gK=(n,e)=>WE(n)?new pK(e):new fK(e,{allowProjection:n!==U.Fragment});function id(n,e,t){const r=n.getProps();return QE(r,e,t!==void 0?t:r.custom,n)}const S_=n=>Array.isArray(n);function mK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,wd(t))}function vK(n){return S_(n)?n[n.length-1]||0:n}function eS(n,e){const t=id(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const o in a){const c=vK(a[o]);mK(n,o,c)}}function yK(n){return!!(Dr(n)&&n.add)}function T_(n,e){const t=n.getValue("willChange");if(yK(t))return t.add(e);if(!t&&qs.WillChange){const r=new qs.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function e3(n){return n.props[G4]}const bK=n=>n!==null;function xK(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(bK),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const _K={type:"spring",stiffness:500,damping:25,restSpeed:10},wK=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),EK={type:"keyframes",duration:.8},SK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},TK=(n,{keyframes:e})=>e.length>2?EK:Gd.has(n)?n.startsWith("scale")?wK(e[1]):_K:SK;function AK({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const tS=(n,e,t,r={},i,a)=>o=>{const c=UE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Ja(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};AK(c)||Object.assign(h,TK(n,h)),h.duration&&(h.duration=Ja(h.duration)),h.repeatDelay&&(h.repeatDelay=Ja(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(b_(h),h.delay===0&&(p=!0)),(qs.instantAnimations||qs.skipAnimations)&&(p=!0,b_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=xK(h.keyframes,c);if(m!==void 0){mn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new LE(h):new K$(h)};function CK({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function t3(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&CK(d,h))continue;const b={delay:t,...UE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=e3(n);if(T){const A=window.MotionHandoffAnimation(T,h,mn);A!==null&&(b.startTime=A,w=!0)}}T_(n,h),p.start(tS(h,p,m,n.shouldReduceMotion&&_4.has(h)?{type:!1}:b,n,w));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{mn.update(()=>{o&&eS(n,o)})}),u}function n3(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,c=(o-1)*r;return typeof t=="function"?t(a,o):i===1?a*r:c-a*r}function A_(n,e,t={}){const r=id(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all(t3(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return IK(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(t.delay)])}function IK(n,e,t=0,r=0,i=0,a=1,o){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push(A_(u,e,{...o,delay:t+(typeof r=="function"?0:r)+n3(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function r3(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>A_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=A_(n,e,t);else{const i=typeof e=="function"?id(n,e,t.custom):e;r=Promise.all(t3(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function i3(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const RK=YE.length;function a3(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?a3(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<RK;t++){const r=YE[t],i=n.props[r];(sp(i)||i===!1)&&(e[r]=i)}return e}const DK=[...$E].reverse(),kK=$E.length;function NK(n){return e=>Promise.all(e.map(({animation:t,options:r})=>r3(n,t,r)))}function MK(n){let e=NK(n),t=gD(),r=!0;const i=u=>(d,h)=>{const p=id(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function o(u){const{props:d}=n,h=a3(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let S=0;S<kK;S++){const T=DK[S],A=t[T],D=d[T]!==void 0?d[T]:h[T],P=sp(D),M=T===u?A.isActive:null;M===!1&&(_=S);let V=D===h[T]&&D!==d[T]&&P;if(V&&r&&n.manuallyAnimateOnMount&&(V=!1),A.protectedKeys={...b},!A.isActive&&M===null||!D&&!A.prevProp||ey(D)||typeof D=="boolean")continue;const C=PK(A.prevProp,D);let I=C||T===u&&A.isActive&&!V&&P||S>_&&P,k=!1;const z=Array.isArray(D)?D:[D];let L=z.reduce(i(T),{});M===!1&&(L={});const{prevResolvedValues:B={}}=A,O={...B,...L},J=Z=>{I=!0,m.has(Z)&&(k=!0,m.delete(Z)),A.needsAnimating[Z]=!0;const ne=n.getValue(Z);ne&&(ne.liveStyle=!1)};for(const Z in O){const ne=L[Z],ue=B[Z];if(b.hasOwnProperty(Z))continue;let Y=!1;S_(ne)&&S_(ue)?Y=!i3(ne,ue):Y=ne!==ue,Y?ne!=null?J(Z):m.add(Z):ne!==void 0&&m.has(Z)?J(Z):A.protectedKeys[Z]=!0}A.prevProp=D,A.prevResolvedValues=L,A.isActive&&(b={...b,...L}),r&&n.blockInitialAnimation&&(I=!1);const K=V&&C;I&&(!K||k)&&p.push(...z.map(Z=>{const ne={type:T};if(typeof Z=="string"&&r&&!K&&n.manuallyAnimateOnMount&&n.parent){const{parent:ue}=n,Y=id(ue,Z);if(ue.enteringChildren&&Y){const{delayChildren:G}=Y.transition||{};ne.delay=n3(ue.enteringChildren,n,G)}}return{animation:Z,options:ne}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=id(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const A=n.getBaseTarget(T),D=n.getValue(T);D&&(D.liveStyle=!0),S[T]=A??null}),p.push({animation:S})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=o(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=gD()}}}function PK(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!i3(e,n):!1}function ql(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function gD(){return{animate:ql(!0),whileInView:ql(),whileHover:ql(),whileTap:ql(),whileDrag:ql(),whileFocus:ql(),exit:ql()}}class ml{constructor(e){this.isMounted=!1,this.node=e}update(){}}class OK extends ml{constructor(e){super(e),e.animationState||(e.animationState=MK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();ey(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let jK=0;class VK extends ml{constructor(){super(...arguments),this.id=jK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const zK={animation:{Feature:OK},exit:{Feature:VK}};function lp(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function qp(n){return{point:{x:n.pageX,y:n.pageY}}}const LK=n=>e=>qE(e)&&n(e,qp(e));function Ih(n,e,t,r){return lp(n,e,LK(t),r)}const s3=1e-4,BK=1-s3,UK=1+s3,o3=.01,FK=0-o3,GK=0+o3;function Gr(n){return n.max-n.min}function qK(n,e,t){return Math.abs(n-e)<=t}function mD(n,e,t,r=.5){n.origin=r,n.originPoint=En(e.min,e.max,n.origin),n.scale=Gr(t)/Gr(e),n.translate=En(t.min,t.max,n.origin)-n.originPoint,(n.scale>=BK&&n.scale<=UK||isNaN(n.scale))&&(n.scale=1),(n.translate>=FK&&n.translate<=GK||isNaN(n.translate))&&(n.translate=0)}function Rh(n,e,t,r){mD(n.x,e.x,t.x,r?r.originX:void 0),mD(n.y,e.y,t.y,r?r.originY:void 0)}function vD(n,e,t){n.min=t.min+e.min,n.max=n.min+Gr(e)}function HK(n,e,t){vD(n.x,e.x,t.x),vD(n.y,e.y,t.y)}function yD(n,e,t){n.min=e.min-t.min,n.max=n.min+Gr(e)}function Dh(n,e,t){yD(n.x,e.x,t.x),yD(n.y,e.y,t.y)}function ji(n){return[n("x"),n("y")]}const l3=({current:n})=>n?n.ownerDocument.defaultView:null,bD=(n,e)=>Math.abs(n-e);function $K(n,e){const t=bD(n.x,e.x),r=bD(n.y,e.y);return Math.sqrt(t**2+r**2)}class c3{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Xx(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=$K(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:S}=_r;this.history.push({...w,timestamp:S});const{onStart:T,onMove:A}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),A&&A(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Kx(b,this.transformPagePoint),mn.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Xx(m.type==="pointercancel"?this.lastMoveEventInfo:Kx(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!qE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=qp(e),u=Kx(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=_r;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,Xx(u,this.history)),this.removeListeners=Up(Ih(this.contextWindow,"pointermove",this.handlePointerMove),Ih(this.contextWindow,"pointerup",this.handlePointerUp),Ih(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ol(this.updatePoint)}}function Kx(n,e){return e?{point:e(n.point)}:n}function xD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Xx({point:n},e){return{point:n,delta:xD(n,u3(e)),offset:xD(n,YK(e)),velocity:KK(e,.1)}}function YK(n){return n[0]}function u3(n){return n[n.length-1]}function KK(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=u3(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Ja(e)));)t--;if(!r)return{x:0,y:0};const a=Ui(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function XK(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?En(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?En(t,n,r.max):Math.min(n,t)),n}function _D(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function WK(n,{top:e,left:t,bottom:r,right:i}){return{x:_D(n.x,t,i),y:_D(n.y,e,r)}}function wD(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function QK(n,e){return{x:wD(n.x,e.x),y:wD(n.y,e.y)}}function ZK(n,e){let t=.5;const r=Gr(n),i=Gr(e);return i>r?t=rp(e.min,e.max-r,n.min):r>i&&(t=rp(n.min,n.max-i,e.min)),Gs(0,1,t)}function JK(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const C_=.35;function eX(n=C_){return n===!1?n=0:n===!0&&(n=C_),{x:ED(n,"left","right"),y:ED(n,"top","bottom")}}function ED(n,e,t){return{min:SD(n,e),max:SD(n,t)}}function SD(n,e){return typeof n=="number"?n:n[e]||0}const tX=new WeakMap;class nX{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=zn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(qp(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=uY(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ji(T=>{let A=this.getAxisMotionValue(T).get()||0;if(es.test(A)){const{projection:D}=this.visualElement;if(D&&D.layout){const P=D.layout.layoutBox[T];P&&(A=Gr(P)*(parseFloat(A)/100))}}this.originPoint[T]=A}),w&&mn.postRender(()=>w(p,m)),T_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=rX(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>ji(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new c3(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:l3(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&mn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Vm(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=XK(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Gu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=WK(r.layoutBox,e):this.constraints=!1,this.elastic=eX(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&ji(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=JK(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Gu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=sK(r,i.root,this.visualElement.getTransformPagePoint());let o=QK(i.layout.layoutBox,a);if(t){const c=t(rK(o));this.hasMutatedConstraints=!!c,c&&(o=$4(c))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=ji(h=>{if(!Vm(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return T_(this.visualElement,e),r.start(tS(e,r,0,t,this.visualElement,!1))}stopAnimation(){ji(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ji(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ji(t=>{const{drag:r}=this.getProps();if(!Vm(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[t];a.set(e[t]-En(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Gu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ji(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=ZK({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ji(o=>{if(!Vm(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(En(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;tX.set(this.visualElement,this);const e=this.visualElement.current,t=Ih(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Gu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),mn.read(r);const o=lp(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(ji(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=C_,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Vm(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function rX(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class iX extends ml{constructor(e){super(e),this.removeGroupControls=Gi,this.removeListeners=Gi,this.controls=new nX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Gi}unmount(){this.removeGroupControls(),this.removeListeners()}}const TD=n=>(e,t)=>{n&&mn.postRender(()=>n(e,t))};class aX extends ml{constructor(){super(...arguments),this.removePointerDownListener=Gi}onPointerDown(e){this.session=new c3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:l3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:TD(e),onStart:TD(t),onMove:r,onEnd:(a,o)=>{delete this.session,i&&mn.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Ih(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const b0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function AD(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const th={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(rt.test(n))n=parseFloat(n);else return n;const t=AD(n,e.target.x),r=AD(n,e.target.y);return`${t}% ${r}%`}},sX={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=ll.parse(n);if(i.length>5)return r;const a=ll.createTransformer(n),o=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=En(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let Wx=!1;class oX extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;kY(lX),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),Wx&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),b0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,Wx=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||mn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),GE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;Wx=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function d3(n){const[e,t]=N4(),r=U.useContext(_E);return v.jsx(oX,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(q4),isPresent:e,safeToRemove:t})}const lX={borderRadius:{...th,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:th,borderTopRightRadius:th,borderBottomLeftRadius:th,borderBottomRightRadius:th,boxShadow:sX};function cX(n,e,t){const r=Dr(n)?n:wd(n);return r.start(tS("",r,e,t)),r.animation}const uX=(n,e)=>n.depth-e.depth;class dX{constructor(){this.children=[],this.isDirty=!1}add(e){SE(this.children,e),this.isDirty=!0}remove(e){TE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(uX),this.isDirty=!1,this.children.forEach(e)}}function fX(n,e){const t=ni.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(ol(r),n(a-e))};return mn.setup(r,!0),()=>ol(r)}const f3=["TopLeft","TopRight","BottomLeft","BottomRight"],hX=f3.length,CD=n=>typeof n=="string"?parseFloat(n):n,ID=n=>typeof n=="number"||rt.test(n);function pX(n,e,t,r,i,a){i?(n.opacity=En(0,t.opacity??1,gX(r)),n.opacityExit=En(e.opacity??1,0,mX(r))):a&&(n.opacity=En(e.opacity??1,t.opacity??1,r));for(let o=0;o<hX;o++){const c=`border${f3[o]}Radius`;let u=RD(e,c),d=RD(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||ID(u)===ID(d)?(n[c]=Math.max(En(CD(u),CD(d),r),0),(es.test(d)||es.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=En(e.rotate||0,t.rotate||0,r))}function RD(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const gX=h3(0,.5,ZO),mX=h3(.5,.95,Gi);function h3(n,e,t){return r=>r<n?0:r>e?1:t(rp(n,e,r))}function DD(n,e){n.min=e.min,n.max=e.max}function Pi(n,e){DD(n.x,e.x),DD(n.y,e.y)}function kD(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function ND(n,e,t,r,i){return n-=e,n=rv(n,1/t,r),i!==void 0&&(n=rv(n,1/i,r)),n}function vX(n,e=0,t=1,r=.5,i,a=n,o=n){if(es.test(e)&&(e=parseFloat(e),e=En(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=En(a.min,a.max,r);n===a&&(c-=e),n.min=ND(n.min,e,t,c,i),n.max=ND(n.max,e,t,c,i)}function MD(n,e,[t,r,i],a,o){vX(n,e[t],e[r],e[i],e.scale,a,o)}const yX=["x","scaleX","originX"],bX=["y","scaleY","originY"];function PD(n,e,t,r){MD(n.x,e,yX,t?t.x:void 0,r?r.x:void 0),MD(n.y,e,bX,t?t.y:void 0,r?r.y:void 0)}function OD(n){return n.translate===0&&n.scale===1}function p3(n){return OD(n.x)&&OD(n.y)}function jD(n,e){return n.min===e.min&&n.max===e.max}function xX(n,e){return jD(n.x,e.x)&&jD(n.y,e.y)}function VD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function g3(n,e){return VD(n.x,e.x)&&VD(n.y,e.y)}function zD(n){return Gr(n.x)/Gr(n.y)}function LD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class _X{constructor(){this.members=[]}add(e){SE(this.members,e),e.scheduleRender()}remove(e){if(TE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function wX(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Qx=["","X","Y","Z"],EX=1e3;let SX=0;function Zx(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function m3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=e3(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",mn,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&m3(r)}function v3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=SX++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(CX),this.nodes.forEach(kX),this.nodes.forEach(NX),this.nodes.forEach(IX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new dX)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new IE),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=k4(o)&&!mY(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;mn.read(()=>{p=window.innerWidth}),n(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=fX(m,250),b0.hasAnimatedSinceResize&&(b0.hasAnimatedSinceResize=!1,this.nodes.forEach(FD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||VX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!g3(this.targetLayout,b),A=!p&&m;if(this.options.layoutRoot||this.resumeFrom||A||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const D={...UE(_,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D),this.setAnimationOrigin(h,A)}else p||FD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ol(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(MX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&m3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(BD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(UD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(DX),this.nodes.forEach(TX),this.nodes.forEach(AX)):this.nodes.forEach(UD),this.clearAllSnapshots();const c=ni.now();_r.delta=Gs(0,1e3/60,c-_r.timestamp),_r.timestamp=c,_r.isProcessing=!0,Bx.update.process(_r),Bx.preRender.process(_r),Bx.render.process(_r),_r.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,GE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(RX),this.sharedNodes.forEach(PX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,mn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){mn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Gr(this.snapshot.measuredBox.x)&&!Gr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=zn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!p3(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Xl(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),zX(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return zn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(LX))){const{scroll:d}=this.root;d&&(qu(c.x,d.offset.x),qu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=zn();if(Pi(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Pi(c,o),qu(c.x,h.offset.x),qu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=zn();Pi(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Hu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Xl(h.latestValues)&&Hu(u,h.latestValues)}return Xl(this.latestValues)&&Hu(u,this.latestValues),u}removeTransform(o){const c=zn();Pi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Xl(d.latestValues))continue;__(d.latestValues)&&d.updateSnapshot();const h=zn(),p=d.measurePageBox();Pi(h,p),PD(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Xl(this.latestValues)&&PD(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==_r.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=_r.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),Dh(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Pi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=zn(),this.targetWithTransforms=zn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),HK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Pi(this.target,this.layout.layoutBox),K4(this.target,this.targetDelta)):Pi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),Dh(this.relativeTargetOrigin,this.target,m.target),Pi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||__(this.parent.latestValues)||Y4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===_r.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Pi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;aK(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=zn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(kD(this.prevProjectionDelta.x,this.projectionDelta.x),kD(this.prevProjectionDelta.y,this.projectionDelta.y)),Rh(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!LD(this.projectionDelta.x,this.prevProjectionDelta.x)||!LD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=$u(),this.projectionDelta=$u(),this.projectionDeltaWithTransform=$u()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=$u();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=zn(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,S=this.getStack(),T=!S||S.members.length<=1,A=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(jX));this.animationProgress=0;let D;this.mixTargetDelta=P=>{const M=P/1e3;GD(p.x,o.x,M),GD(p.y,o.y,M),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Dh(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),OX(this.relativeTarget,this.relativeTargetOrigin,m,M),D&&xX(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=zn()),Pi(D,this.relativeTarget)),w&&(this.animationValues=h,pX(h,d,this.latestValues,M,A,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(ol(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=mn.update(()=>{b0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=wd(0)),this.currentAnimation=cX(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(EX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&y3(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||zn();const p=Gr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=Gr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Pi(c,u),Hu(c,h),Rh(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new _X),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&Zx("z",o,d,this.animationValues);for(let h=0;h<Qx.length;h++)Zx(`rotate${Qx[h]}`,o,d,this.animationValues),Zx(`skew${Qx[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=y0(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=y0(c?.pointerEvents)||""),this.hasProjected&&!Xl(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=wX(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in op){if(h[_]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:T}=op[_],A=p==="none"?h[_]:w(h[_],d);if(S){const D=S.length;for(let P=0;P<D;P++)o[S[P]]=A}else T?this.options.visualElement.renderState.vars[_]=A:o[_]=A}this.options.layoutId&&(o.pointerEvents=d===this?y0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(BD),this.root.sharedNodes.clear()}}}function TX(n){n.updateLayout()}function AX(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?ji(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Gr(p);p.min=t[h].min,p.max=p.min+m}):y3(i,e.layoutBox,t)&&ji(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Gr(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const o=$u();Rh(o,t,e.layoutBox);const c=$u();a?Rh(c,n.applyTransform(r,!0),e.measuredBox):Rh(c,t,e.layoutBox);const u=!p3(o);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=zn();Dh(b,e.layoutBox,p.layoutBox);const _=zn();Dh(_,t,m.layoutBox),g3(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function CX(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function IX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function RX(n){n.clearSnapshot()}function BD(n){n.clearMeasurements()}function UD(n){n.isLayoutDirty=!1}function DX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function FD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function kX(n){n.resolveTargetDelta()}function NX(n){n.calcProjection()}function MX(n){n.resetSkewAndRotation()}function PX(n){n.removeLeadSnapshot()}function GD(n,e,t){n.translate=En(e.translate,0,t),n.scale=En(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function qD(n,e,t,r){n.min=En(e.min,t.min,r),n.max=En(e.max,t.max,r)}function OX(n,e,t,r){qD(n.x,e.x,t.x,r),qD(n.y,e.y,t.y,r)}function jX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const VX={duration:.45,ease:[.4,0,.1,1]},HD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),$D=HD("applewebkit/")&&!HD("chrome/")?Math.round:Gi;function YD(n){n.min=$D(n.min),n.max=$D(n.max)}function zX(n){YD(n.x),YD(n.y)}function y3(n,e,t){return n==="position"||n==="preserve-aspect"&&!qK(zD(e),zD(t),.2)}function LX(n){return n!==n.root&&n.scroll?.wasRoot}const BX=v3({attachResizeListener:(n,e)=>lp(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Jx={current:void 0},b3=v3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Jx.current){const n=new BX({});n.mount(window),n.setOptions({layoutScroll:!0}),Jx.current=n}return Jx.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),UX={pan:{Feature:aX},drag:{Feature:iX,ProjectionNode:b3,MeasureLayout:d3}};function KD(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&mn.postRender(()=>a(e,qp(e)))}class FX extends ml{mount(){const{current:e}=this.node;e&&(this.unmount=dY(e,(t,r)=>(KD(this.node,r,"Start"),i=>KD(this.node,i,"End"))))}unmount(){}}class GX extends ml{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Up(lp(this.node.current,"focus",()=>this.onFocus()),lp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function XD(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&mn.postRender(()=>a(e,qp(e)))}class qX extends ml{mount(){const{current:e}=this.node;e&&(this.unmount=gY(e,(t,r)=>(XD(this.node,r,"Start"),(i,{success:a})=>XD(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const I_=new WeakMap,e1=new WeakMap,HX=n=>{const e=I_.get(n.target);e&&e(n)},$X=n=>{n.forEach(HX)};function YX({root:n,...e}){const t=n||document;e1.has(t)||e1.set(t,{});const r=e1.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver($X,{root:n,...e})),r[i]}function KX(n,e,t){const r=YX(e);return I_.set(n,t),r.observe(n),()=>{I_.delete(n),r.unobserve(n)}}const XX={some:0,all:1};class WX extends ml{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:XX[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return KX(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(QX(e,t))&&this.startObserver()}unmount(){}}function QX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const ZX={inView:{Feature:WX},tap:{Feature:qX},focus:{Feature:GX},hover:{Feature:FX}},JX={layout:{ProjectionNode:b3,MeasureLayout:d3}},eW={...zK,...ZX,...UX,...JX},Nn=nK(eW,gK);function tW(n){n.values.forEach(e=>e.stop())}function R_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&eS(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{R_(a,e)})})}function nW(n,e){if(Array.isArray(e))return R_(n,e);if(typeof e=="string")return R_(n,[e]);eS(n,e)}function rW(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(r3(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{nW(r,t)})},stop(){n.forEach(t=>{tW(t)})},mount(){return()=>{e.stop()}}};return e}function iW(){const n=Qv(rW);return EE(n.mount,[]),n}const aW=iW,Lc=hw((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{n({isVisible:!1})}})),sW=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=Lc(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(ri,{children:t&&v.jsx(Nn.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-24 right-6 z-[110] max-w-xs",children:v.jsxs("div",{className:`rounded-lg shadow-lg p-3 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-xs font-medium whitespace-pre-line pr-2",children:n})}),v.jsxs("div",{className:"flex items-center gap-1 ml-2 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-2 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-bold transition-colors",children:[v.jsx(w9,{size:12,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-0.5 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(Ev,{size:14})})]})]})})})};class Ua extends U.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(Ju,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(zh,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(WL,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const oW=({onAddTransaction:n})=>{const e=Ys(),t=xa(),[r,i]=U.useState(!1),a=U.useRef(null),o=d=>t.pathname===d;U.useEffect(()=>{const d=h=>{a.current&&!a.current.contains(h.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),document.addEventListener("touchstart",d),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("touchstart",d)}},[r]);const c=[{path:"/reports",icon:v.jsx(bL,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(T0,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(_L,{className:"w-5 h-5"}),label:"Budget Breakdown"}],u=({path:d,icon:h,label:p})=>{const m=o(d);return v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(d)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${m?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${m?"scale-110":"group-hover:scale-105"}`,children:h}),v.jsx("span",{className:"sr-only",children:p}),m&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:[v.jsx(u,{path:"/",label:"Budget",icon:v.jsx(wv,{className:"w-6 h-6"})}),v.jsx(u,{path:"/transactions",label:"Transactions",icon:v.jsx(ZL,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:d=>{if(d.stopPropagation(),i(!1),n){n();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(gh,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:d=>{d.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(VL,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:d=>d.stopPropagation(),onTouchStart:d=>d.stopPropagation(),onTouchEnd:d=>d.stopPropagation(),children:v.jsx("div",{className:"p-2 space-y-1",children:c.map((d,h)=>v.jsxs("button",{onClick:p=>{p.stopPropagation(),e(d.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:d.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:d.label})]},h))})})]}),v.jsx(u,{path:"/settings",label:"Settings",icon:v.jsx(h9,{className:"w-6 h-6"})})]})})};function lW(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function cW(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function Ps(n,e){return function(t){t&&(n[e]=t)}}function x3(n,e,t){return function(r){r&&(n[e][t]=r)}}function WD(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function uW(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var dW="function",fW="object",hW="string",pW="number",nS="undefined",_3=typeof window!==nS,gW=typeof document!==nS&&document,mW=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Qn=1e-7,zm={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function vW(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function iv(n,e,t,r){return(n*r+e*t)/(t+r)}function ny(n){return typeof n===nS}function ya(n){return n&&typeof n===fW}function er(n){return Array.isArray(n)}function ii(n){return typeof n===hW}function Sd(n){return typeof n===pW}function rS(n){return typeof n===dW}function yW(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function w3(n,e,t,r,i){var a=iS(n,e,t);return a?t:bW(n,e,t+1,r,i)}function iS(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function bW(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!iS(n,e,d))return{value:d};var p=d,m=ai(i,function(b){var _=b.open;return _===h});if(m&&(p=w3(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=t;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function aS(n,e){var t=ii(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,o=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?o:c,d=t.openCloseCharacters,h=d===void 0?mW:d,p=h.map(function(C){var I=C.open,k=C.close;return I===k?I:I+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(C){return C&&C!=="undefined"}),w=_.length,S=[],T=[];function A(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var D=function(C){var I=_[C].trim(),k=C,z=ai(h,function(O){var J=O.open;return J===I}),L=ai(h,function(O){var J=O.close;return J===I});if(z){if(k=w3(z,_,C,w,h),k!==-1&&u)return A()&&a||(S.push(_.slice(C,k+1).join("")),C=k,a)?(P=C,"break"):(P=C,"continue")}else if(L&&!iS(L,_,C)){var B=vW(h);return B.splice(h.indexOf(L),1),{value:aS(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:B})}}else if(yW(I,i)&&!o)return A(),a?(P=C,"break"):(P=C,"continue");k===-1&&(k=w-1),T.push(_.slice(C,k+1).join("")),C=k,P=C},P,M=0;M<w;++M){var V=D(M);if(M=P,typeof V=="object")return V.value;if(V==="break")break}return T.length&&S.push(T.join("")),S}function cl(n){return aS(n,"")}function lc(n){return aS(n,",")}function E3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Hp(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function xW(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function x0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function cp(){return Date.now?Date.now():new Date().getTime()}function Hs(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function ai(n,e,t){var r=Hs(n,e);return r>-1?n[r]:t}var S3=(function(){var n=cp(),e=_3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=cp(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),_W=(function(){var n=_3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function $s(n){return Object.keys(n)}function wW(n){var e=$s(n);return e.map(function(t){return n[t]})}function nn(n,e){var t=Hp(n),r=t.value,i=t.unit;if(ya(e)){var a=e[i];if(a){if(rS(a))return a(r);if(zm[i])return zm[i](r,a)}}else if(i==="%")return r*e/100;return zm[i]?zm[i](r):r}function D_(n,e,t){return Math.max(e,Math.min(n,t))}function QD(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[ot(e[0],Qn),ot(e[0]/r,Qn)],[ot(e[1]*r,Qn),ot(e[1],Qn)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=ot(c,Qn);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function T3(n,e,t,r){if(!r)return n.map(function(b,_){return D_(b,e[_],t[_])});var i=n[0],a=n[1],o=r===!0?i/a:r,c=QD(n,e,!1,o),u=c[0],d=c[1],h=QD(n,t,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function EW(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function k_(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function Ln(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function SW(n){return[0,1].map(function(e){return k_(n.map(function(t){return t[e]}))})}function ZD(n){var e=SW(n),t=Ln(e,n[0]),r=Ln(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function Os(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function ot(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function JD(n,e){return n.forEach(function(t,r){n[r]=ot(n[r],e)}),n}function TW(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function A3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function C3(n,e){n.indexOf(e)===-1&&n.push(e)}function ar(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function I3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function R3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function xr(n,e,t,r){n.addEventListener(e,t,r)}function rr(n,e,t,r){n.removeEventListener(e,t,r)}function qd(n){return n?.ownerDocument||gW}function sS(n){return qd(n).documentElement}function vl(n){return qd(n).body}function tl(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function D3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function Hd(n){return ya(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var AW=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,o=i.indexOf(t),c=o===-1?i.length:o;i[c]=t,a[c]=r},n})(),CW=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),IW=typeof Map=="function",RW=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function DW(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],o=i[1],c=new RW;t[a]=c,r[o]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=t[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var kW=(function(){function n(t,r,i,a,o,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=DW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function $p(n,e,t){var r=IW?Map:t?CW:AW,i=t||function(A){return A},a=[],o=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],S=0,T=0;return u.forEach(function(A,D){h.set(A,D)}),d.forEach(function(A,D){p.set(A,D)}),u.forEach(function(A,D){var P=p.get(A);typeof P>"u"?(++T,o.push(D)):_[P]=T}),d.forEach(function(A,D){var P=h.get(A);typeof P>"u"?(a.push(D),++S):(c.push([P,D]),T=_[D]||0,m.push([P-T,D-S]),b.push(D===P),P!==D&&w.push([P,D]))}),o.reverse(),new kW(n,e,a,o,w,c,m,b)}var NW=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=$p(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),N_=function(n,e){return N_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},N_(n,e)};function Yp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");N_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $a=function(){return $a=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$a.apply(this,arguments)};function k3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function ek(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function tk(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function N3(n){var e=[];return n.forEach(function(t){e=e.concat(er(t)?N3(t):t)}),e}function t1(n,e){if(!e)return n;for(var t in e)ny(n[t])&&(n[t]=e[t]);return n}function av(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function nk(n){var e=n.className,t=k3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function rk(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function ry(n){if(!n)return null;var e=n.b;return Hd(e)?e:ry(n.c)}function M3(n){var e=n.parentNode;e&&e.removeChild(n)}function P3(n){n.forEach(function(e){e()})}function MW(){return this.constructor(this.props,this.context)}var oS=0,iy=(function(){function n(t,r,i,a,o,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,o){var c=this,u=c.d,d=wW(r).filter(function(_){return _.$_req}),h=N3(d.map(function(_){return _.$_subs})),p=ai(h,function(_){return _.d===u});if(c.b&&!ii(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var S=w.d;return _[0]?_[0].d===S&&_.push(w):S>u&&_.push(w),_},[]);return m.forEach(function(_){Kp(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return ii(i)||(c.ps=i.props,c.ref=i.ref),lS(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function O3(){return Object.__CROACT_CURRENT_INSTNACE__}function PW(){return oS}function OW(n){oS=n}function lS(n){return Object.__CROACT_CURRENT_INSTNACE__=n,oS=0,n}var cS=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=$a($a({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,o=Kp(a.c,[a],[a.o],i,a._cs,$a($a({},this.state),this.$_state),r);o&&(t&&i.push(t),P3(i),lS(null))},n})(),j3=(function(n){Yp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return av(this.props,r)||av(this.state,i)},e})(cS);function V3(n){var e=function(t){e.current=t};return e.current=n,e}function jW(n){return n._fr=!0,n}function VW(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new cS(e,t),a.constructor=n,n._fr?(r.fr=V3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=MW),a.$_p=r,a}var zW=(function(n){Yp(e,n);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,o,c,u,t1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(t1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=t1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=VW(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=$a($a({},i),b.$_cs);Kp(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(A){A()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(A){return A()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(iy);function LW(n,e,t){var r=uS(nk(n),nk(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in o)t.setAttribute(u,o[u][1]);for(var d in a)t.removeAttribute(d)}function BW(n,e,t){var r=uS(n,e),i=r.added,a=r.removed;for(var o in a)t.e(o,!0);for(var c in i)t.e(c)}function uS(n,e){var t=$s(n),r=$s(e),i=$p(t,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];o[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function UW(n,e,t){var r=t.style,i=uS(n,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=x0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=x0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=x0(u,"-");r.removeProperty(p)}}function FW(n){return n.replace(/^on/g,"").toLowerCase()}var GW=(function(n){Yp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,o=a._es,c=a.b,u=FW(r);i?(rr(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},xr(c,u,o[r]))},t.s=function(r){return av(this.ps,r)},t.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=ry(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=qd(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}Kp(c,c._ps,d.children,r,i);var w=c.b,S=rk(a),T=S[0],A=S[1],D=rk(d),P=D[0],M=D[1];return LW(T,P,w),BW(A,M,c),UW(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)rr(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||M3(a)},e})(iy);function up(n){if(!n||Hd(n))return n;var e=n.$_p._ps;return e.length?up(e[0].b):null}function z3(n){if(n){if(n.b&&Hd(n.b))return n;var e=n._ps;return e.length?z3(e[0]):null}}function ha(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=k3(i,["key","ref"]);return{type:n,key:a,ref:o,props:$a($a({},c),{children:A3(t).filter(function(u){return u!=null&&u!==!1})})}}var L3=(function(n){Yp(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(iy),qW=(function(n){Yp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,o=!a.b;if(o){var c=ry(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||qd(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},t.un=function(){M3(this.b)},e})(iy);function HW(n,e,t){var r=t.map(function(u){return ii(u)?null:u.key}),i=tk(e.map(function(u){return u.k})),a=tk(r),o=$p(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=up(p.b),b=up(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,ik(t[u],r[u],u,n))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=ii(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,ik(h,r[d],d,n)),!0):(p.i=d,!1)});return ek(ek([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function $W(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=up(t[i].b);if(a)return a}return null}function ik(n,e,t,r){var i=r.d+1;if(ii(n)||Sd(n))return new qW("text_".concat(n),i,e,t,r,null,{});var a=n.type,o=typeof a=="string"?GW:zW;return new o(a,i,e,t,r,n.ref,n.props)}function Kp(n,e,t,r,i,a,o){var c=HW(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,o)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=z3(p);m&&(m._sel=!0)}),n._hyd=null;var h=ry(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=up(m.b);if(b&&h!==b&&!b.parentNode){var _=$W(n,m);h.insertBefore(b,_)}}),d.length>0}function YW(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new L3(e));var a=[];return Kp(t,t._ps,n?[n]:[],a,r,void 0,void 0),P3(a),lS(null),i||(e.__CROACT__=t),t}function ak(n,e,t){return!t&&n&&(t=new L3(e.parentElement),t._hyd=[e],t._sel=!0),YW(n,e,t),t}function B3(n){var e=O3(),t=e._hs||(e._hs=[]),r=PW(),i=t[r];if(OW(r+1),i){if(!av(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function KW(n,e){var t=B3({func:n,deps:e});return t.value}function XW(n){return KW(function(){return V3(n)},[])}function U3(n,e,t){var r=O3(),i=B3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function WW(n,e,t){U3(function(){n?.(e())},t,!0)}function dS(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function F3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function G3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function fS(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function QW(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function ZW(n,e){var t=fS("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function M_(n){return n.replace(/_/g,".")}function dh(n,e){var t=null,r="-1";return dS(n,function(i){var a=fS("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=ZW(i.versionTest.toLowerCase(),e)||r),r=M_(r),!0)}),{preset:t,version:r}}function Lm(n,e){var t={brand:"",version:"-1"};return dS(n,function(r){var i=q3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function q3(n,e){return F3(n,function(t){var r=t.brand;return fS(""+e.test,r.toLowerCase())})}var H3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],$3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],P_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Y3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],K3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function X3(n){return!!dh(Y3,n).preset}function JW(n){var e=G3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:X3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=dh(H3,e),o=a.preset,c=a.version,u=dh(K3,e),d=u.preset,h=u.version,p=dh($3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=dh(P_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function eQ(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Lm(Y3,t).brand||X3(G3())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&dS(P_,function(m){return q3(t,m)});var u=Lm($3,t);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Lm(P_,t);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=F3(K3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Lm(H3,t);o.name=p.brand||o.name,o.version=p.brand&&n?n.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=M_(c.version),o.version=M_(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function tQ(n){return QW()?eQ():JW(n)}function nQ(n,e,t,r,i,a){for(var o=0;o<i;++o){var c=t+o*i,u=r+o*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function rQ(n,e,t,r,i){for(var a=0;a<i;++a){var o=t+a*i,c=r+a*i,u=n[o],d=e[o];n[o]=n[c],n[c]=u,e[o]=e[c],e[c]=d}}function iQ(n,e,t,r,i){for(var a=0;a<r;++a){var o=t+a*r;n[o]/=i,e[o]/=i}}function W3(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function rs(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=un(e),i=0;i<e;++i){var a=e*i+i;if(!ot(t[a],Qn)){for(var o=i+1;o<e;++o)if(t[e*i+o]){rQ(t,r,i,o,e);break}}if(!ot(t[a],Qn))return[];iQ(t,r,i,e,t[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=t[u];!ot(d,Qn)||i===o||nQ(t,r,c,i,e,-d)}}return r}function aQ(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function Q3(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function sQ(n,e){for(var t=un(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function kc(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function ba(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=un(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*t+o]=n[a*e+o];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function sv(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=un(n);return e.forEach(function(i){r=rn(r,i,n)}),r}function rn(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var o=0;o<t;++o)for(var c=0;c<a;++c){r[c*t+o]=0;for(var u=0;u<i;++u)r[c*t+o]+=n[u*t+o]*e[c*i+u]}return r}function Ot(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function Ke(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function oQ(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function Z3(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function Mr(n,e,t){t===void 0&&(t=e.length);var r=rn(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function lQ(n,e){return rn(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function cQ(n,e){return rn(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function uQ(n,e){return rn(n,Wp(e,4))}function Bm(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return rn(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function Xp(n,e){return Mr(Wp(e,3),kc(n,3))}function n1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return rn(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function sk(n,e){return rn(n,e,4)}function Wp(n,e){var t=Math.cos(n),r=Math.sin(n),i=un(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function un(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function hS(n,e){for(var t=un(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function Nc(n,e){for(var t=un(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function pS(n,e,t,r,i,a,o,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],S=i[0],T=i[1],A=a[0],D=a[1],P=o[0],M=o[1],V=c[0],C=c[1],I=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-S*u,-T*u,-A*h,-D*h,-P*m,-M*m,-V*_,-C*_,-S*d,-T*d,-A*p,-D*p,-P*b,-M*b,-V*w,-C*w],k=rs(I,8);if(!k.length)return[];var z=rn(k,[S,T,A,D,P,M,V,C],8);return z[8]=1,ba(aQ(z),3,4)}var kh=function(){return kh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},kh.apply(this,arguments)};function dQ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function dp(n,e){return e===void 0&&(e=0),Bu(Td(n,e))}function fQ(n,e){var t=Mr(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function Bu(n){var e=dQ();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function Td(n,e){e===void 0&&(e=0);var t=er(n)?n:cl(n);return t.map(function(r){var i=E3(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=ya(e)?kh(kh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=lc(o).map(function(O,J){return J===0&&"x%"in h?h["%"]=e["x%"]:J===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],nn(O,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],S=w===void 0?0:w;c=n1,d=[m,_,S]}else if(a==="translateY"){var T=ya(e)?kh({"%":e["y%"]},e):{"%":e},_=nn(o,T);c=n1,d=[0,_,0]}else if(a==="translateZ"){var S=parseFloat(o);c=n1,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var A=lc(o).map(function(O){return parseFloat(O)}),D=A[0],P=A[1],M=P===void 0?D:P,V=A[2],C=V===void 0?1:V;c=Bm,d=[D,M,C]}else if(a==="scaleX"){var D=parseFloat(o);c=Bm,d=[D,1,1]}else if(a==="scaleY"){var M=parseFloat(o);c=Bm,d=[1,M,1]}else if(a==="scaleZ"){var C=parseFloat(o);c=Bm,d=[1,1,C]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var I=Hp(o),k=I.unit,z=I.value,L=k==="rad"?z:z*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=uQ):a==="rotateX"?c=lQ:a==="rotateY"&&(c=cQ),d=L}else if(a==="matrix3d")c=sk,d=lc(o).map(function(O){return parseFloat(O)});else if(a==="matrix"){var B=lc(o).map(function(O){return parseFloat(O)});c=sk,d=[B[0],B[1],0,0,B[2],B[3],0,0,0,0,1,0,B[4],B[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var O_=function(n,e){return O_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},O_(n,e)};function hQ(n,e){O_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var J3=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),ej=(function(n){hQ(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,J3)||this}return e})(NW);function pQ(n,e){return $p(n,e,J3)}var j_=function(){return j_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},j_.apply(this,arguments)};function gQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var ay=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(ya(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(ya(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var o=Hs(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var o=!1;return r.eventType=t,r.stop=function(){o=!0},r.currentTarget=this,gQ(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!o},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var o=a[t];o.push(j_({listener:r},i))},n})();var V_=function(n,e){return V_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},V_(n,e)};function mQ(n,e){V_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Yu=function(){return Yu=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Yu.apply(this,arguments)};function vQ(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function ok(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function Um(n){if(n){if(ii(n))return document.querySelector(n)}else return null;if(rS(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var yQ=(function(n){mQ(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=Um(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag(Yu(Yu({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],_=m[1]-o[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?vQ:o;return c({container:Um(a),direction:r})},t._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=cp(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:Um(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll(Yu(Yu({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?ok:i,o=Um(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=ok(window,this._onScroll):this._unregister=a(o,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(ay);function bQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function ei(n){return ot(n,Qn)}function xQ(n,e){return n.every(function(t,r){return ei(t-e[r])===0})}function _Q(n,e){return!ei(n[0]-e[0])&&!ei(n[1]-e[1])}function tj(n){return n.length<3?0:Math.abs(EW(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function lk(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,o=Mc(n),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function Mc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function z_(n,e,t){var r=n[0],i=n[1],a=Mc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=ov(u[0],u[1]),h=L_(e),p=[];if(h.forEach(function(_){var w=ov(_[0],_[1]),S=_[0];if(xQ(d,w))p.push({pos:n,line:_,type:"line"});else{var T=nj(gS(d,w),[u,_]);T.forEach(function(A){_.some(function(D){return _Q(D,A)})?p.push({pos:A,line:_,type:"point"}):ei(S[1]-i)!==0&&p.push({pos:A,line:_,type:"intersection"})})}}),ai(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,S=_.type,T=_.line;if(!(w[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var A=ai(T,function(M){return M[1]!==i}),D=b[w[0]],P=A[1]>i?1:-1;D?D!==P&&++m:b[w[0]]=P}}}),m%2===1}function ov(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],o=i-t,c=a-r;Math.abs(o)<Qn&&(o=0),Math.abs(c)<Qn&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function gS(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],o=e[1],c=e[2],u=t===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,S=-(o*w+c)/a;h=[[S,w]]}else if(a===0){var w=-c/o,S=-(r*w+i)/t;h=[[S,w]]}else if(r===0){var S=-i/t,w=-(a*S+c)/o;h=[[S,w]]}else if(o===0){var S=-c/a,w=-(t*S+i)/r;h=[[S,w]]}else{var S=(r*c-o*i)/(o*t-r*a),w=-(t*S+i)/r;h=[[S,w]]}return h.map(function(T){return[T[0],T[1]]})}function nj(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],o=i[1];if(ei(a-n[1][0])){if(!ei(o-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(ei(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(ei(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=ei(m-_[0][0])&&0<=ei(_[0][1]-m)&&0<=ei(b-_[1][0])&&0<=ei(_[1][1]-b)})})),r.map(function(p){return[ei(p[0]),ei(p[1])]})}function L_(n){return bQ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function wQ(n,e){var t=n.slice(),r=e.slice();ZD(t)===-1&&t.reverse(),ZD(r)===-1&&r.reverse();var i=L_(t),a=L_(r),o=i.map(function(h){return ov(h[0],h[1])}),c=a.map(function(h){return ov(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var S=gS(h,_),T=nj(S,[m,a[w]]);b.push.apply(b,T.map(function(A){return{index1:p,index2:w,pos:A,type:"intersection"}}))}),b.sort(function(_,w){return Os(m[0],_.pos)-Os(m[0],w.pos)}),u.push.apply(u,b),z_(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(z_(h[1],t)){var m=!1,b=Hs(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Hs(u,function(_){var w=_.index1,S=_.index2;return w===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function EQ(n,e){var t=wQ(n,e);return t.map(function(r){var i=r.pos;return i})}function SQ(n,e){var t=EQ(n,e);return tj(t)}var B_=function(n,e){return B_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},B_(n,e)};function TQ(n,e){B_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Yn=function(){return Yn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Yn.apply(this,arguments)};function AQ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function r1(n){return AQ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function CQ(n){return n.touches&&n.touches.length>=2}function Fm(n){return n?n.touches?RQ(n.touches):[rj(n)]:[]}function IQ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function ck(n,e,t){var r=t.length,i=Nh(n,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=Nh(e,r),h=d.clientX,p=d.clientY,m=Nh(t,r),b=m.clientX,_=m.clientY,w=a-h,S=o-p,T=a-b,A=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:S,distX:T,distY:A}}function i1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function RQ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(rj(n[r]));return t}function rj(n){return{clientX:n.clientX,clientY:n.clientY}}function Nh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var a1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),r1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),r1(e)-r1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=ck(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],o=0;o<i;++o)a[o]=ck([e[o]],[t[o]],[r[o]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=Nh(e,this.length),i=Nh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),i1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),i1(e)/i1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),uk=["textarea","input"],DQ=(function(n){TQ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,S=w.container,T=w.pinchOutside,A=w.preventWheelClick,D=w.preventRightClick,P=w.preventDefault,M=w.checkInput,V=w.dragFocusedInput,C=w.preventClickEventOnDragStart,I=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,z=i._useTouch,L=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,A&&(m.which===2||m.button===1)||D&&(m.which===3||m.button===2))return i.stop(),!1;if(L){var B=i._window.document.activeElement,O=m.target;if(O){var J=O.tagName.toLowerCase(),K=uk.indexOf(J)>-1,H=O.isContentEditable;if(K||H){if(M||!V&&B===O)return!1;if(B&&(B===O||H&&B.isContentEditable&&B.contains(O)))if(V)O.blur();else return!1}else if((P||m.type==="touchstart")&&B){var Z=B.tagName.toLowerCase();(B.isContentEditable||uk.indexOf(Z)>-1)&&B.blur()}(C||I||k)&&xr(i._window,"click",i._onClick,!0)}i.clientStores=[new a1(Fm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=cp()-i.prevTime<200,i._isMouseEvent=IQ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var ne=i._preventMouseEvent||i.emit("dragStart",Yn(Yn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));ne===!1&&i.stop(),i._isMouseEvent&&i.flag&&P&&m.preventDefault()}if(!i.flag)return!1;var ue=0;if(L?(i._attchDragEvent(),z&&T&&(ue=setTimeout(function(){xr(S,"touchstart",i.onDragStart,{passive:!1})}))):z&&T&&rr(S,"touchstart",i.onDragStart),i.flag&&CQ(m)){if(clearTimeout(ue),L&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Fm(m),S=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",Yn(Yn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,A=b.preventClickEventByCondition,D=i.isDrag;(S||T||A)&&requestAnimationFrame(function(){i._allowClickEvent()}),!A&&!T&&S&&!D&&i._allowClickEvent(),i._useTouch&&_&&rr(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var P=m?.touches?Fm(m):[],M=P.length;M===0||!i.options.keepDragging?i.flag=!1:i._addStore(new a1(P));var V=i._getPosition(),C=cp(),I=!D&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=D||I?0:C,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",Yn({data:i.data,datas:i.data,isDouble:I,isDrag:D,isClick:!D,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},V)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){rr(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),o=a[0];i._window=D3(o)?o:tl(o),i.options=Yn({checkInput:!1,container:o&&!("document"in o)?tl(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){xr(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){xr(m,"mousedown",i.onDragStart),xr(m,"mousemove",i._passCallback)}),xr(u,"contextmenu",i._onContextMenu)),h&&xr(tl(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){xr(m,"touchstart",i.onDragStart,p),xr(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),Yn(Yn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),rr(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){rr(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){rr(a,"mousedown",t.onDragStart)}),rr(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){rr(a,"touchstart",t.onDragStart)}),rr(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new a1(Fm(t));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",Yn(Yn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Yn(Yn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",Yn(Yn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),Yn(Yn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return Yn(Yn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(xr(r,"dragover",this.onDrag,i),xr(t,"dragend",this.onDragEnd)),this._useMouse&&(xr(r,"mousemove",this.onDrag),xr(t,"mouseup",this.onDragEnd)),this._useTouch&&(xr(r,"touchmove",this.onDrag,i),xr(t,"touchend",this.onDragEnd,i),xr(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&(rr(r,"dragover",this.onDrag),rr(t,"dragend",this.onDragEnd)),this._useMouse&&(rr(r,"mousemove",this.onDrag),rr(t,"mouseup",this.onDragEnd)),this._useTouch&&(rr(r,"touchstart",this.onDragStart),rr(r,"touchmove",this.onDrag),rr(t,"touchend",this.onDragEnd),rr(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(ay);function kQ(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var NQ=kQ;function MQ(n){return NQ(n).toString(36)}function PQ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function OQ(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?lc(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function jQ(n,e,t,r,i){var a=qd(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",n),o.setAttribute("data-styled-count","1"),t.nonce&&o.setAttribute("nonce",t.nonce),o.innerHTML=OQ(n,e,t),(i||a.head||a.body).appendChild(o),o}function VQ(n){var e="rCS"+MQ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=PQ(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=jQ(e,n,r,t,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var U_=function(){return U_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},U_.apply(this,arguments)};function zQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function ij(n,e){var t=VQ(e),r=t.className;return jW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=zQ(i,["className","cspNonce"]),d=XW();return WW(a,function(){return d.current},[]),U3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),ha(n,U_({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var F_=function(n,e){return F_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},F_(n,e)};function Qp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");F_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Q=function(){return Q=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Q.apply(this,arguments)};function LQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function BQ(n,e,t,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function UQ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ee(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Ce(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Zp(n,e){return Q({events:[],props:[],name:n},e)}var FQ=["n","w","s","e"],mS=["n","w","s","e","nw","ne","sw","se"];function GQ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function qQ(n){var e=GQ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var $d=tQ(),aj=$d.browser.webkit,sj=aj&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),oj=$d.browser.name,lj=parseInt($d.browser.version,10),HQ=oj==="chrome",$Q=$d.browser.chromium,YQ=parseInt($d.browser.chromiumVersion,10)||0,KQ=HQ&&lj>=109||$Q&&YQ>=109,XQ=oj==="firefox",WQ=parseInt($d.browser.webkitVersion,10)>=612||lj>=15,vS="moveable-",QQ=mS.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),ZQ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(QQ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(qQ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(sj?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),JQ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],G_=1e-4,$r=1e-7,Gm=1e-9,q_=Math.pow(10,10),dk=-q_,eZ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},yS={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},cj={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},uj=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Jp(n,e,t,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return Q(Q({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var Ad=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),Q(Q({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function ad(n,e,t,r){var i=n.length===16,a=i?4:3,o=Uc(n,t,r,a),c=ee(o,4),u=ee(c[0],2),d=u[0],h=u[1],p=ee(c[1],2),m=p[0],b=p[1],_=ee(c[2],2),w=_[0],S=_[1],T=ee(c[3],2),A=T[0],D=T[1],P=ee(_n(n,e,a),2),M=P[0],V=P[1],C=Math.min(d,m,w,A),I=Math.min(h,b,S,D),k=Math.max(d,m,w,A),z=Math.max(h,b,S,D);d=d-C||0,m=m-C||0,w=w-C||0,A=A-C||0,h=h-I||0,b=b-I||0,S=S-I||0,D=D-I||0,M=M-C||0,V=V-I||0;var L=n[0],B=n[a+1],O=Ur(L*B);return{left:C,top:I,right:k,bottom:z,origin:[M,V],pos1:[d,h],pos2:[m,b],pos3:[w,S],pos4:[A,D],direction:O}}function dj(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=ee(Ke(Rd(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],S=ee(os({datas:i,distX:_,distY:w}),2),T=S[0],A=S[1];return[T,A]}function Bc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;t.is3d=o,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=rs(i,b),t.inverseBeforeMatrix=rs(a,b),t.absoluteOrigin=kc(Ot([c,u],d),b),t.startDragBeforeDist=Mr(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=Mr(t.inverseMatrix,t.absoluteOrigin,b)}function tZ(n){return ad(n.datas.beforeTransform,[50,50],100,100).direction}function sy(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=Hs(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):ai(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=CJ(o,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ce(Ce([],ee(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function oy(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function nZ(n){var e=n.datas,t=n.distX,r=n.distY,i=ee(hj({datas:e,distX:t,distY:r}),2),a=i[0],o=i[1],c=fj(e,sQ([a,o],4));return Mr(c,kc([0,0,0],4),4)}function fj(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,o=n.afterTransform2,c=n.targetAllTransform,u=t?rn(c,e,4):rn(e,c,4),d=rn(rs(t?a:r,4),u,4),h=rn(d,rs(t?o:i,4),4);return h}function hj(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return Ke(Mr(i,Ot(c,[t,r]),u),o)}function os(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,o=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return Ke(Mr(e?a:o,Ot(h,[r,i]),p),e?u:d)}function rZ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,o=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=o?4:3;return Ke(Mr(a,Ot(c,[r,i]),d),u)}function iZ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(o,c){var u=Hp(o),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function pj(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function aZ(n,e){return pj(e).map(function(t){return n[t]})}function s1(n,e){var t=(e+1)/2;return[iv(n[0][0],n[1][0],t,1-t),iv(n[0][1],n[1][1],t,1-t)]}function sr(n,e){var t=s1([n[0],n[1]],e[0]),r=s1([n[2],n[3]],e[0]);return s1([t,r],e[1])}function sZ(n,e,t,r,i,a){var o=Uc(e,t,r,i),c=sr(o,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function eg(n,e,t,r){return rn(n,Ph(e,r,t),r)}function oZ(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,o=n.is3d,c=o?4:3,u;if(ii(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=ba(dp(t),4,c):u=ba(rn(rn(d,dp([t]),4),h,4),4,c)}else u=t;return eg(a,u,i,c)}function lZ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,o=n.targetAllTransform,c=i?4:3;return eg(r,rn(o||a,hS(e,c),c),t,c)}function ly(n,e){var t=Yd(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=er(r)?r:cl(r),H_(n,e,i)},setTransformIndex:function(r){H_(n,e,r)}}}function cy(n,e,t){var r=Yd(e),i=r.startTransforms;H_(n,e,Hs(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function H_(n,e,t){var r=Yd(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var o=n.state,c=Td([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function bS(n,e){var t=Yd(n);t.nextTransforms=cl(e)}function Yd(n){return n.originalDatas.beforeRenderable}function lv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function qm(n){return(lv(n)||[]).join(" ")}function Hm(n){return Yd(n).nextStyle}function gj(n,e,t,r,i){bS(i,e);var a=Br.drag(n,Jp(i,n.state,t,r)),o=a?a.transform:e;return Q(Q({transform:e,drag:a},qr({transform:o},i)),{afterTransform:o})}function xS(n,e,t,r,i,a){var o=oZ(n.state,i,e,a),c=dZ(n,t,r,o);return c}function mj(n,e,t,r,i,a,o){var c=xS(n,e,t,i,a,o),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=Ke(r,c);return Ke(_,[m,b])}function cZ(n,e,t,r,i,a,o){var c=mj(n,e,t,r,i,a,o);return c}function uZ(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function dZ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],o/2*(1+e[1])+t[1]];return _n(r,d,u)}function fZ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return mj(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function hZ(n,e,t,r,i,a){var o=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,A=iZ(i,e,t,p,m,u),D=o?b:0,P=o?_:0,M=eg(d,S,A,T),V=sZ(r,M,e,t,T,w);return Ke(V,[D,P])}function pZ(n,e){return sr(Yi(n.state),e)}function gZ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function mZ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function vZ(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function vj(n,e,t){for(var r=n,i=[],a=sS(n)||vl(n),o=!t&&n===e||n===a,c=o,u=!1,d=3,h,p,m,b=!1,_=hp(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var S=si(r),T=S("position"),A=Uj(r),D=T==="fixed",P=vZ(S),M=oQ(pJ(A)),V=void 0,C=!1,I=!1,k=0,z=0,L=0,B=0,O={hasTransform:!1,fixedContainer:null};D&&(b=!0,O=bJ(r),_=O.fixedContainer);var J=M.length;!u&&(J===16||P.length)&&(u=!0,d=4,Q_(i),m&&(m=ba(m,3,4))),u&&J===9&&(M=ba(M,3,4));var K=yJ(r,n),H=K.tagName,Z=K.hasOffset,ne=K.isSVG,ue=K.origin,Y=K.targetOrigin,G=K.offset,$=ee(G,2),re=$[0],W=$[1];H==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:xJ(r,d)}),i.push({type:"offset",target:r,matrix:un(d)}));var oe=parseFloat(S("zoom"))||1;if(D)V=O.fixedContainer,C=!0;else{var he=hp(r,e,!1,!0,S),ye=he.offsetZoom;if(V=he.offsetParent,C=he.isEnd,I=he.isStatic,w*=ye,(he.isCustomElement||ye!==1)&&I)re-=V.offsetLeft,W-=V.offsetTop;else if(XQ||KQ){var Te=he.parentSlotElement;if(Te){for(var Me=V,We=0,de=0;Me&&mZ(Me);)We+=Me.offsetLeft,de+=Me.offsetTop,Me=Me.offsetParent;re-=We,W-=de}}}if(aj&&!WQ&&Z&&!ne&&I&&(T==="relative"||T==="static")&&(re-=V.offsetLeft,W-=V.offsetTop,o=o||C),D)Z&&O.hasTransform&&(L=V.clientLeft,B=V.clientTop);else if(Z&&_!==V&&(k=V.clientLeft,z=V.clientTop),Z&&V===a){var Se=Fj(r,!1);re+=Se[0],W+=Se[1]}if(i.push({type:"target",target:r,matrix:Ph(M,d,ue)}),P.length&&(i.push({type:"offset",target:r,matrix:un(d)}),i.push({type:"target",target:r,matrix:Ph(dp(P),d,ue)})),Z){var Be=r===n,Pe=Be?0:r.scrollLeft,Ge=Be?0:r.scrollTop;i.push({type:"offset",target:r,matrix:Nc([re-Pe+k-L,W-Ge+z-B],d)})}else i.push({type:"offset",target:r,origin:ue});if(oe!==1&&i.push({type:"zoom",target:r,matrix:Ph(hS([oe,oe],d),d,[0,0])}),m||(m=M),h||(h=ue),p||(p=Y),c||D)break;r=V,o=C,(!t||r===a)&&(c=o)}return m||(m=un(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var tc=null,nc=null,Ku=null;function Cd(n){n?(window.Map&&(tc=new Map,nc=new Map),Ku=[]):(tc=null,Ku=null,nc=null)}function yZ(n){var e=nc?.get(n);if(e)return e;var t=Oh(n,!0);return nc&&nc.set(n,t),t}function bZ(n,e){if(Ku){var t=ai(Ku,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=vj(n,e,!0);return Ku&&Ku.push([[n,e],r]),r}function si(n){var e=tc?.get(n);if(!e){var t=tl(n).getComputedStyle(n);if(!tc)return function(a){return t[a]};e={style:t,cached:{}},tc.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function pa(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},Q(Q({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function o1(n,e,t,r,i,a,o){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=pa(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,S){var T=m[S],A=T.state,D=A.gestos,P=w;if(c)P=new Ad(o).dragStart(r,w),b.push(P);else{if(D[o]||(D[o]=h.childGestos[S]),!D[o])return;P=Jp(w,A,r,d,a,o),b.push(P)}var M=e[t](T,Q(Q({},P),{parentFlag:!0}));return u&&(D[o]=null),M});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:b}}function js(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!t.match(/End$/g),c=pa(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,Q(Q({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function cv(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,o=r.datas.startPositions||Yi(e.state),c=sr(o,i),u=ee(Mr(Wp(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function yj(n,e,t,r){var i=n.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=Pc(n.props,e).zoom,d=Mh(o/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=Ur(c);return t.map(function(_){var w=_.data,S=_.classNames,T=_.dir,A=yS[T];if(!A||!h[T])return null;m[T]=!0;var D=(ot(d,15)+b*cj[T]+720)%180,P={};return $s(w).forEach(function(M){P["data-".concat(M)]=w[M]}),r.createElement("div",Q({className:He.apply(void 0,Ce(["control","direction",T,e],ee(S),!1)),"data-rotation":D,"data-direction":T},P,{key:"direction-".concat(T),style:hv.apply(void 0,Ce([o,u],ee(A.map(function(M){return a[M]})),!1))}))})}function bj(n,e,t,r){var i=Pc(n.props,t),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?mS:o;return Ce(Ce([],ee(c?Ej(n,r,t,u):[]),!1),ee(yj(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function fp(n,e,t,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=Ln(t,r),d=e?ot(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:He.apply(void 0,Ce(["line","direction",e?"edge":"",e],ee(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:hh(t,r,i,u)})}function xj(n,e,t,r,i){var a=t===!0?FQ:t;return a.map(function(o,c){var u=ee(yS[o],2),d=u[0],h=u[1];if(h!=null)return fp(n,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function _j(n){return function(e,t){var r=Pc(e.props,n).edge;return r&&(r===!0||r.length)?Ce(Ce([],ee(xj(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),ee(xZ(e,n,t)),!1):wj(e,n,t)}}function wj(n,e,t){return bj(n,mS,e,t)}function xZ(n,e,t){return bj(n,["nw","ne","sw","se"],e,t)}function Ej(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=Ur(u),m=c/Math.PI*180;return(r||$s(d)).map(function(b){var _=yS[b];if(!_)return null;var w=(ot(m,15)+p*cj[b]+720)%180,S=["around-control"];return t&&S.push("direction",t),e.createElement("div",{className:He.apply(void 0,Ce([],ee(S),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:hv.apply(void 0,Ce([c,h],ee(_.map(function(T){return o[T]})),!1))})})}function _S(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:fk(_,e,!0),horizontal:fk(_,t,!1)}}function uy(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",S=b.left,T=S===void 0?-1/0:S,A=b.top,D=A===void 0?-1/0:A,P=b.right,M=P===void 0?w?-1/0:1/0:P,V=b.bottom,C=V===void 0?w?-1/0:1/0:V;return w&&(M=a+p-d-M,C=i+m-h-C),{left:T+d-o,right:M+d-o,top:D+h-c,bottom:C+h-c}}function _Z(n,e,t){var r=uy(n),i=r.left,a=r.top,o=r.right,c=r.bottom,u=ee(t,2),d=u[0],h=u[1],p=ee(Ke(t,e),2),m=p[0],b=p[1];_e(m)<$r&&(m=0),_e(b)<$r&&(b=0);var _=b>0,w=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var A=b/m,D=t[1]-A*d,P=0,M=0,V=!1;w&&o<=d?(P=A*o+D,M=o,V=!0):!w&&d<=i&&(P=A*i+D,M=i,V=!0),V&&(P<a||P>c)&&(V=!1),V||(_&&c<=h?(P=c,M=(P-D)/A,V=!0):!_&&h<=a&&(P=a,M=(P-D)/A,V=!0)),V&&(S.isBound=!0,S.pos=M,S.offset=d-M,T.isBound=!0,T.pos=P,T.offset=h-P)}return{vertical:S,horizontal:T}}function fk(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ce([],ee(e),!1)),o=Math.max.apply(Math,Ce([],ee(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return _e(d.offset)-_e(u.offset)})}function hk(n,e,t){var r=t?n.map(function(i){return Xp(i,t)}):n;return r.some(function(i){return i[0]<e.left&&_e(i[0]-e.left)>.1||i[0]>e.right&&_e(i[0]-e.right)>.1||i[1]<e.top&&_e(i[1]-e.top)>.1||i[1]>e.bottom&&_e(i[1]-e.bottom)>.1})}function wZ(n,e,t){var r=$i(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return _e(a-n[t?0:1])-_e(o-n[t?0:1])}).map(function(a){return Ln([0,0],t?[a,e]:[e,a])})}function EZ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,o=uy(n),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!hk(t,w,0))return[];var S=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var A=ee(T,2),D=A[0],P=A[1];t.forEach(function(M){var V=Ln([0,0],M);S.push.apply(S,Ce([],ee(wZ(M,D,P).map(function(C){return a+C-V}).filter(function(C){return!hk(e,w,C)}).map(function(C){return ot(C*180/Math.PI,$r)})),!1))})}),S}var SZ=["left","right","center"],TZ=["top","bottom","middle"],pk={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},ul={start:"left",end:"right",center:"center"},dl={start:"top",end:"bottom",center:"middle"};function Xu(){return{left:!1,top:!1,right:!1,bottom:!1}}function Kd(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,o=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function wS(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function AZ(n,e){var t=wS(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function ES(n,e){var t=AZ(n,e),r=TZ.filter(function(a){return a in t}),i=SZ.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function CZ(n,e,t){var r=_n(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function IZ(n){var e=ee(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Qn&&(i=0),Math.abs(a)<Qn&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*t[0]-t[1]):(c=1,u=-t[1]):(o=-1,u=t[0]),[o,c,u].map(function(d){return ot(d,Qn)})}var Sj="snapRotationThreshold",Tj="snapRotationDegrees",Aj="snapHorizontalThreshold",Cj="snapVerticalThreshold";function dy(n,e,t,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=Rk(o,u[Aj],5),p=Rk(a,u[Cj],5);return Ij(n.state.guidelines,e,t,r,i,h,p,d)}function Ij(n,e,t,r,i,a,o,c){return{vertical:mk(n,"vertical",e,o*c[0],r),horizontal:mk(n,"horizontal",t,a*c[1],i)}}function RZ(n,e,t){var r=ee(t,2),i=r[0],a=r[1],o=ee(e,2),c=o[0],u=o[1],d=ee(Ke(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=pv(h),p=pv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var S=dy(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,A=S.horizontal;T.posInfos.filter(function(H){var Z=H.pos;return b?Z>=c:Z<=c}),A.posInfos.filter(function(H){var Z=H.pos;return m?Z>=u:Z<=u}),T.isSnap=T.posInfos.length>0,A.isSnap=A.posInfos.length>0;var D=$_(T),P=D.isSnap,M=D.guideline,V=$_(A),C=V.isSnap,I=V.guideline,k=C?I.pos[1]:0,z=P?M.pos[0]:0;if(h===0)C&&(w.isSnap=!0,w.pos=I.pos[1],w.offset=a-w.pos);else if(p===0)P&&(_.isSnap=!0,_.pos=z,_.offset=i-z);else{var L=p/h,B=t[1]-L*i,O=0,J=0,K=!1;P?(J=z,O=L*J+B,K=!0):C&&(O=k,J=(O-B)/L,K=!0),K&&(_.isSnap=!0,_.pos=J,_.offset=i-J,w.isSnap=!0,w.pos=O,w.offset=a-O)}return{vertical:_,horizontal:w}}function $o(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function gk(n,e,t,r){var i=ES(n.props.snapDirections,e),a=dy(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return $o(u)}),i.horizontalNames.map(function(u){return $o(u)}),t,r),o=$o(i.horizontalNames[a.horizontal.index]),c=$o(i.verticalNames[a.vertical.index]);return{vertical:Q(Q({},a.vertical),{direction:c}),horizontal:Q(Q({},a.horizontal),{direction:o})}}function $_(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:o}}function mk(n,e,t,r,i){var a,o;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var S=w.pos,T=p-S[u];return{offset:T,dist:_e(T),guideline:w,direction:b}}).filter(function(w){var S=w.guideline,T=w.dist,A=S.type;return!(A!==e||T>r)}).sort(function(w,S){return w.dist-S.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function DZ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ce([],ee(aZ([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return sr(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=dy(n,c,u,a.map(function(m){return $o(m[0])}),a.map(function(m){return $o(m[1])}),r,i),h=$o(a.map(function(m){return m[0]})[d.vertical.index]),p=$o(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:Q(Q({},d.vertical),{direction:h}),horizontal:Q(Q({},d.horizontal),{direction:p})}}function Rj(n,e){var t=_e(n.offset),r=_e(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<$r?1:r<$r?-1:t-r}function uv(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],o=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return Rj({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function kZ(n,e,t){var r=[];if(t)_e(e[0])!==1||_e(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=_e(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*n[0],-1]],[[e[0],0],[o*n[0],0]],[[e[0],1],[o*n[0],1]])})}else if(n[1]){var a=_e(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function Dj(n,e){var t=k_([e[0][0],e[1][0]]),r=k_([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function SS(n,e){var t=ee(e,2),r=t[0],i=t[1],a=i[0]-r[0],o=i[1]-r[1];_e(a)<$r&&(a=0),_e(o)<$r&&(o=0);var c,u;if(!a)c=r[0],u=n[0];else if(!o)c=r[1],u=n[1];else{var d=o/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function kj(n,e,t,r){return r===void 0&&(r=$r),n.every(function(i){var a=SS(i,e),o=a<=0;return o===t||_e(a)<=r})}function vk(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function NZ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(kj([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=Yo(t,o,b,i),T=Yo(t,o,w,i),A=Yo(t,o,m,a),D=Yo(t,o,_,a),P=S.isBound&&T.isBound,M=S.isBound||T.isBound,V=A.isBound&&D.isBound,C=A.isBound||D.isBound,I=Id(S.offset,T.offset),k=Id(A.offset,D.offset),z=[0,0],L=!1,B=!1;return _e(k)<_e(I)?(z=[I,0],L=M,B=P):(z=[0,k],L=C,B=V),{isAllBound:B,isVerticalBound:M,isHorizontalBound:C,isBound:L,offset:z}}function Yo(n,e,t,r,i,a){var o=ee(e,2),c=o[0],u=o[1],d=n[0],h=t[0],p=t[1],m=pv(p[1]-h[1]),b=pv(p[0]-h[0]),_=u,w=c,S=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var P=(h[1]-d[1])/S+d[0];return vk(P,h[0],p[0],r,i)}else{var A=h[1]-d[1],D=_e(A)<=(i||0);return{isBound:D,offset:D?A:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=S*(h[0]-d[0])+d[1];return vk(T,h[1],p[1],r,i)}else{var A=h[0]-d[0],D=_e(A)<=(i||0);return{isBound:D,offset:D?A:0}}}return{isBound:!1,offset:0}}function Nj(n,e,t){return e.map(function(r){var i=NZ(n,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=os({datas:t,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function MZ(n,e,t){var r,i=TS(n,e,[0,0],!1).map(function(m){return Q(Q({},m),{multiple:m.multiple.map(function(b){return _e(b)*2})})}),a=Nj(n,i,t),o=uv(a,0),c=uv(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=ee(rZ({datas:t,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function PZ(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function TS(n,e,t,r){var i=n.state,a=i.allMatrix,o=i.is3d,c=Uc(a,100,100,o?4:3),u=sr(c,[0,0]);return PZ(t,r).map(function(d){var h=ee(d,3),p=h[0],m=h[1],b=h[2],_=[sr(c,m),sr(c,b)],w=IZ(_),S=Dj(u,_),T=S.vertical,A=S.horizontal,D=SS(u,_)<=0;return{multiple:p,centerSign:D,verticalSign:T,horizontalSign:A,lineConstants:w,line:[sr(e,m),sr(e,b)]}})}function yk(n,e,t,r){var i=r?n.map(function(a){return Xp(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=SS(t,a)<=0;return!kj(e,a,o)})}function OZ(n){var e=ee(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return _e(t[0]);if(!a)return _e(t[1]);var o=a/i;return _e((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function jZ(n){var e=ee(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var o=a/i,c=-o*t[0]+t[1];return[-c/(o+1/o),c/(o*o+1)]}function VZ(n,e,t,r,i){var a=n.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],S=sr(t,[0,0]);if(!yk(t,w,S,0))return[];var T=[],A=w.map(function(D){return[$i(D),Ln([0,0],D)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(D){var P=Ln([0,0],jZ(D)),M=OZ(D);T.push.apply(T,Ce([],ee(A.filter(function(V){var C=ee(V,1),I=C[0];return I&&M<=I}).map(function(V){var C=ee(V,2),I=C[0],k=C[1],z=Math.acos(I?M/I:0),L=k+z,B=k-z;return[o+L-P,o+B-P]}).reduce(function(V,C){return V.push.apply(V,Ce([],ee(C),!1)),V},[]).filter(function(V){return!yk(e,w,S,V)}).map(function(V){return ot(V*180/Math.PI,$r)})),!1))}),T}function zZ(n){var e=n.props.innerBounds,t=Xu();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=sr(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],A=TS(n,u,[0,0],!1),D=[],P=[];return A.forEach(function(M){var V=M.line,C=M.lineConstants,I=Dj(d,V),k=I.horizontal,z=I.vertical,L=Yo(V,C,w,z,1,!0),B=Yo(V,C,T,z,1,!0),O=Yo(V,C,_,k,1,!0),J=Yo(V,C,S,k,1,!0);L.isBound&&!t.top&&(D.push(p),t.top=!0),B.isBound&&!t.bottom&&(D.push(p+b),t.bottom=!0),O.isBound&&!t.left&&(P.push(h),t.left=!0),J.isBound&&!t.right&&(P.push(h+m),t.right=!0)}),{boundMap:t,horizontal:D,vertical:P}}function LZ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(_e(i)<Qn&&(i=0),_e(a)<Qn&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var o=a/i,c=n[1]-o*n[0];if(r){var u=o*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/o;return[d-e[0],t]}}function Y_(n,e,t,r,i){var a=LZ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=Os(n,e),c=Os(a,n),u=Os(a,e),d=c>o||u>o,h=ee(os({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function dv(n,e){return n.isBound?n.offset:e.isSnap?$_(e).offset:0}function BZ(n,e,t,r,i){var a=ee(e,2),o=a[0],c=a[1],u=ee(t,2),d=u[0],h=u[1],p=ee(r,2),m=p[0],b=p[1],_=ee(i,2),w=_[0],S=_[1],T=-w,A=-S;if(n&&o&&c){T=0,A=0;var D=[];if(d&&h?D.push([0,S],[w,0]):d?D.push([w,0]):h?D.push([0,S]):m&&b?D.push([0,S],[w,0]):m?D.push([w,0]):b&&D.push([0,S]),D.length){D.sort(function(C,I){return $i(Ke([o,c],C))-$i(Ke([o,c],I))});var P=D[0];if(P[0]&&_e(o)>Qn)T=-P[0],A=c*_e(o+T)/_e(o)-c;else if(P[1]&&_e(c)>Qn){var M=c;A=-P[1],T=o*_e(c+A)/_e(M)-o}if(n&&h&&d)if(_e(T)>Qn&&_e(T)<_e(w)){var V=_e(w)/_e(T);T*=V,A*=V}else if(_e(A)>Qn&&_e(A)<_e(S)){var V=_e(S)/_e(A);T*=V,A*=V}else T=Id(-w,T),A=Id(-S,A)}}else T=o||d?-w:0,A=c||h?-S:0;return[T,A]}function UZ(n,e,t,r,i,a){if(!Kd(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=IS(a.absolutePoses,[e,t]),c=qi(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(J){return J[1]}),vertical:o.map(function(J){return J[0]})},b=wS(n.props.snapDirections),_=ES(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=fy(n,i,_,m),S=w.vertical,T=w.horizontal,A=MZ(n,o,a),D=A.vertical,P=A.horizontal,M=S.isSnap,V=T.isSnap,C=S.isBound||D.isBound,I=T.isBound||P.isBound,k=Id(S.offset,D.offset),z=Id(T.offset,P.offset),L=ee(BZ(r,[e,t],[C,I],[M,V],[k,z]),2),B=L[0],O=L[1];return[{isBound:C,isSnap:M,offset:B},{isBound:I,isSnap:V,offset:O}]}function fy(n,e,t,r){r===void 0&&(r=t);var i=_S(uy(n),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:dy(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=dv(a[0],u),p=dv(o[0],d),m=_e(h),b=_e(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function bk(n,e,t,r,i,a,o){o===void 0&&(o=[1,1]);var c=_S(e,t,r),u=c.horizontal,d=c.vertical,h=Ij(n,t,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=dv(u[0],p),_=dv(d[0],m),w=_e(b),S=_e(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:S,bounds:d,snap:m}}}function FZ(n,e,t,r){var i=Ln(n,e)/Math.PI*180,a=t.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function GZ(n,e,t,r,i,a){return t.map(function(o){var c=ee(o,2),u=c[0],d=c[1],h=sr(e,u),p=sr(e,d),m=r?qZ(n,h,p,i):fy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,S=b.isSnap,T=m.vertical,A=T.offset,D=T.isBound,P=T.isSnap,M=Ke(d,u);if(!A&&!_)return{isBound:D||w,isSnap:P||S,sign:M,offset:[0,0]};var V=FZ(h,p,m,r);if(!V)return{sign:M,isBound:!1,isSnap:!1,offset:[0,0]};var C=V==="vertical",I=[0,0];return!r&&_e(d[0])===1&&_e(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?I=os({datas:a,distX:-A,distY:-_}):I=Y_(h,p,-(C?A:_),C,a).offset,I=I.map(function(k,z){return k*(M[z]?2/M[z]:0)}),{sign:M,isBound:C?D:w,isSnap:C?P:S,offset:I}})}function xk(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function qZ(n,e,t,r){var i=_Z(n,e,t),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:RZ(n,e,t),u=c.horizontal,d=c.vertical,h=xk(a,u),p=xk(o,d),m=_e(h),b=_e(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function HZ(n,e,t,r,i){var a=[-t[0],-t[1]],o=n.state,c=o.width,u=o.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,S=w===void 0?-1/0:w,T=d.right,A=T===void 0?1/0:T,D=d.bottom,P=D===void 0?1/0:D;m.forEach(function(M){var V=M[0]!==a[0],C=M[1]!==a[1],I=sr(e,M),k=Ln(r,I)*360/Math.PI;if(C){var z=I.slice();(_e(k-360)<2||_e(k-180)<2)&&(z[1]=r[1]);var L=Y_(r,z,(r[1]<I[1]?P:S)-I[1],!1,i),B=ee(L.offset,2),O=B[1],J=L.isOutside;isNaN(O)||(p=u+(J?1:-1)*_e(O))}if(V){var z=I.slice();(_e(k-90)<2||_e(k-270)<2)&&(z[0]=r[0]);var K=Y_(r,z,(r[0]<I[0]?A:_)-I[0],!0,i),H=ee(K.offset,1),Z=H[0],ne=K.isOutside;isNaN(Z)||(h=c+(ne?1:-1)*_e(Z))}})}return{maxWidth:h,maxHeight:p}}var Br={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,o=n.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=$i(d),p=Ln(d,[0,0]);return[e.createElement("div",{className:He("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],Bc(n,e),cy(n,e,"translate"),uJ(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=gt(n,e,Q({set:function(h){t.startValue=h}},ly(n,e))),d=r||je(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){sy(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,S=t.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=n.props,A=T.parentMoveable,D=d?0:T.throttleDrag||h||0,P=r?0:T.throttleDragRotate||0,M=0,V=!1,C=!1,I=!1,k=!1;if(!r&&P>0&&(p||m)){var z=T.startDragRotate||0,L=ot(z+Ln([0,0],[p,m])*180/Math.PI,P)-z,B=m*Math.abs(Math.cos((L-90)/180*Math.PI)),O=p*Math.abs(Math.cos(L/180*Math.PI)),J=$i([O,B]);M=L*Math.PI/180,p=J*Math.cos(M),m=J*Math.sin(M)}if(!a&&!r&&!i){var K=ee(UZ(n,p,m,P,!c&&u||o,t),2),H=K[0],Z=K[1];V=H.isSnap,C=H.isBound,I=Z.isSnap,k=Z.isBound;var ne=H.offset,ue=Z.offset;p+=ne,m+=ue}var Y=Ot(hj({datas:t,distX:p,distY:m}),S),G=Ot(nZ({datas:t,distX:p,distY:m}),S);JD(G,$r),JD(Y,$r),P||(!V&&!C&&(G[0]=ot(G[0],D),Y[0]=ot(Y[0],D)),!I&&!k&&(G[1]=ot(G[1],D),Y[1]=ot(Y[1],D)));var $=Ke(Y,S),re=Ke(G,S),W=Ke(re,_),oe=Ke($,w);t.prevDist=re,t.prevBeforeDist=$,t.passDelta=W,t.passDist=re;var he=t.left+$[0],ye=t.top+$[1],Te=t.right-$[0],Me=t.bottom-$[1],We=oy(t,"translate(".concat(G[0],"px, ").concat(G[1],"px)"),"translate(".concat(re[0],"px, ").concat(re[1],"px)"));if(bS(e,We),n.state.dragInfo.dist=r?[0,0]:re,!(!r&&!A&&W.every(function(Ge){return!Ge})&&oe.some(function(Ge){return!Ge}))){var de=n.state,Se=de.width,Be=de.height,Pe=gt(n,e,Q({transform:We,dist:re,delta:W,translate:G,beforeDist:$,beforeDelta:oe,beforeTranslate:Y,left:he,top:ye,right:Te,bottom:Me,width:Se,height:Be,isPinch:a},qr({transform:We},e)));return!r&&je(n,"onDrag",Pe),Pe}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,Q(Q({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=xi(n,e,{});return!t&&je(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=o1(n,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=Q(Q({},c),{targets:n.props.targets,events:h}),m=je(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,Q(Q({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=o1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=Q({targets:n.props.targets,events:a},r);return je(n,"onDragGroup",o),o}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=o1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return je(n,"onDragGroupEnd",xi(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-t.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-t.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function Mj(n,e){var t=sr(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function $Z(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=_n(t,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function Pj(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=uZ(e,i,a),u=_n(t,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var _k=kS("resizable"),K_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:_j("resizable"),dragControlCondition:_k,viewClassName:DS("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=Yj(o,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||n.controlGesto,!i&&Bc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=ii(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function A(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Yi(n.state);function D(k){var z=Mj(u.startPositions,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function P(k){var z=Pj(n.state,k);u.fixedDirection=z.fixedDirection,u.fixedPosition=z.fixedPosition,u.fixedOffset=z.fixedOffset}function M(k){u.minSize=[nn("".concat(k[0]),0)||0,nn("".concat(k[1]),0)||0]}function V(k){var z=[k[0]||1/0,k[1]||1/0];(!Sd(z[0])||isFinite(z[0]))&&(z[0]=nn("".concat(z[0]),0)||1/0),(!Sd(z[1])||isFinite(z[1]))&&(z[1]=nn("".concat(z[1]),0)||1/0),u.maxSize=z}A(_/w),D(d||[-p[0],-p[1]]),u.setFixedDirection=D,u.setFixedPosition=P,u.setMin=M,u.setMax=V;var C=gt(n,e,{direction:p,startRatio:u.ratio,set:function(k){var z=ee(k,2),L=z[0],B=z[1];u.startWidth=L,u.startHeight=B},setMin:M,setMax:V,setRatio:A,setFixedDirection:D,setFixedPosition:P,setOrigin:function(k){u.transformOrigin=k},dragStart:Br.dragStart(n,new Ad().dragStart([0,0],e))}),I=h||je(n,"onResizeStart",C);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,I!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?C:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,S=r.startWidth,T=r.startHeight,A=r.prevWidth,D=r.prevHeight,P=r.minSize,M=r.maxSize,V=r.ratio,C=r.startOffsetWidth,I=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(b){var z=n.state.is3d,L=r.startOffsetMatrix,B=r.startTransformOrigin,O=z?4:3,J=dp(lv(e)),K=Math.sqrt(J.length);O!==K&&(J=ba(J,K,O));var H=eg(L,J,B,O),Z=Uc(H,C,I,O);r.startPositions=Z,r.nextTargetMatrix=J,r.nextAllMatrix=H}var ne=Pc(n.props,"resizable"),ue=ne.resizeFormat,Y=ne.throttleResize,G=Y===void 0?i?0:1:Y,$=ne.parentMoveable,re=ne.keepRatioFinally,W=r.direction,oe=W,he=0,ye=0;!W[0]&&!W[1]&&(oe=[1,1]);var Te=V&&(o??ne.keepRatio)||!1;function Me(){var ct=r.fixedDirection,Mt=Jj(oe,Te,r,e);he=Mt.distWidth,ye=Mt.distHeight;var an=oe[0]-ct[0]||Te?Math.max(C+he,$r):C,zt=oe[1]-ct[1]||Te?Math.max(I+ye,$r):I;return Te&&C&&I&&(k?zt=an/V:an=zt*V),[an,zt]}var We=ee(Me(),2),de=We[0],Se=We[1];m||(r.setFixedDirection(r.fixedDirection),je(n,"onBeforeResize",gt(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(ct){var Mt;return r.setFixedDirection(ct),Mt=ee(Me(),2),de=Mt[0],Se=Mt[1],[de,Se]},setFixedPosition:function(ct){var Mt;return r.setFixedPosition(ct),Mt=ee(Me(),2),de=Mt[0],Se=Mt[1],[de,Se]},boundingWidth:de,boundingHeight:Se,setSize:function(ct){var Mt;Mt=ee(ct,2),de=Mt[0],Se=Mt[1]}},!0)));var Be=c;c||(!i&&a?Be=pZ(n,[0,0]):Be=r.fixedPosition);var Pe=[0,0];a||(Pe=lJ(n,de,Se,W,Be,!d&&h,r)),u&&(!u[0]&&(Pe[0]=0),!u[1]&&(Pe[1]=0));function Ge(){var ct;ue&&(ct=ee(ue([de,Se]),2),de=ct[0],Se=ct[1]),de=ot(de,G),Se=ot(Se,G)}if(Te){oe[0]&&oe[1]&&Pe[0]&&Pe[1]&&(_e(Pe[0])>_e(Pe[1])?Pe[1]=0:Pe[0]=0);var Ue=!Pe[0]&&!Pe[1];Ue&&Ge(),oe[0]&&!oe[1]||Pe[0]&&!Pe[1]||Ue&&k?(de+=Pe[0],Se=de/V):(!oe[0]&&oe[1]||!Pe[0]&&Pe[1]||Ue&&!k)&&(Se+=Pe[1],de=Se*V)}else de+=Pe[0],Se+=Pe[1],de=Math.max(0,de),Se=Math.max(0,Se);t=ee(T3([de,Se],P,M,Te?V:!1),2),de=t[0],Se=t[1],Ge(),Te&&(p||re)&&(k?Se=de/V:de=Se*V),he=de-C,ye=Se-I;var we=[he-A,ye-D];r.prevWidth=he,r.prevHeight=ye;var Oe=hZ(n,de,Se,Be,w,r);if(!(!$&&we.every(function(ct){return!ct})&&Oe.every(function(ct){return!ct}))){var ke=Br.drag(n,Jp(e,n.state,Oe,!!a,!1,"draggable")),Ve=ke.transform,et=S+he,Tt=T+ye,Qe=gt(n,e,Q({width:et,height:Tt,offsetWidth:Math.round(de),offsetHeight:Math.round(Se),startRatio:V,boundingWidth:de,boundingHeight:Se,direction:W,dist:[he,ye],delta:we,isPinch:!!a,drag:ke},Xj({style:{width:"".concat(et,"px"),height:"".concat(Tt,"px")},transform:Ve},ke,e)));return!m&&je(n,"onResize",Qe),Qe}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,o=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=_e(p)>3,_=_e(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=xi(n,e,{});return!r&&je(n,"onResizeEnd",i),i}},dragGroupControlCondition:_k,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,Q(Q({},e),{isGroup:!0}));if(!r)return!1;var i=pa(n,"resizable",e),a=t.startOffsetWidth,o=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,S=w.minSize,T=w.startOffsetWidth,A=w.startOffsetHeight,D=a*(T?S[0]/T:0),P=o*(A?S[1]/A:0);b[0]=Math.max(b[0],D),b[1]=Math.max(b[1],P)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,S=w.maxSize,T=w.startOffsetWidth,A=w.startOffsetHeight,D=a*(T?S[0]/T:0),P=o*(A?S[1]/A:0);b[0]=Math.min(b[0],D),b[1]=Math.min(b[1],P)})}var d=js(n,this,"dragControlStart",e,function(b,_){return cv(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),cv(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=Q(Q({},r),{targets:n.props.targets,events:d.map(function(b){return Q(Q({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=je(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=Pc(n.props,"resizable");py(n,"onBeforeResize",function(b){je(n,"onBeforeResizeGroup",gt(n,e,Q(Q({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,Q(Q({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=t.fixedPosition,p=js(n,this,"dragControl",e,function(b,_){var w=ee(Mr(Wp(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),S=w[0],T=w[1];return Q(Q({},_),{parentDist:null,parentScale:d,dragClient:Ot(h,[S,T]),parentKeepRatio:u})}),m=Q({targets:r.targets,events:p},i);return je(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=js(n,this,"dragControlEnd",e),a=xi(n,e,{targets:n.props.targets,events:i});return je(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function l1(n,e,t,r,i){var a=n.props.groupable,o=n.state,c=o.is3d?4:3,u=e.origin,d=_n(n.state.rootMatrix,Ke([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=Ot([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=Ln(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Os(h,[t,r])}function _0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++o:a<n&&a<90&&n>270&&--o;var c=e*(o*360+n-r);return t.prevDeg=r+c,c}function c1(n,e,t,r){return _0(Ln(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function u1(n,e,t,r,i,a){var o=n.props.throttleRotate,c=o===void 0?0:o,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=oJ(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=ot(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function Oj(n,e,t){var r=ee(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(n==="none")return[];if(er(n))return n.map(function(S){return Oj(S,[i,a,o,c],t)[0]});var u=ee((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=Hj(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function X_(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(ar(t,He("rotation-control"))||n.props.rotateAroundControls&&ar(t,He("around-control"))||ar(t,He("control"))&&ar(t,He("rotatable")))return!0;var r=n.props.rotationTarget;return r?NS(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var YZ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,KZ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[YZ],viewClassName:function(n){return n.isDragging("rotatable")?He("view-rotation-dragging"):""},render:function(n,e){var t=Pc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,o=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=Oj(i,h,p),b=[];if(m.forEach(function(T,A){var D=ee(T,2),P=D[0],M=D[1];b.push(e.createElement("div",{key:"rotation".concat(A),className:He("rotation"),style:{transform:"translate(-50%) translate(".concat(P[0],"px, ").concat(P[1],"px) rotate(").concat(M,"rad)")}},e.createElement("div",{className:He("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:He("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=$s(u||{}),w={};_.forEach(function(T){u[T].forEach(function(A){w[A]=T})});var S=[];er(o)&&(S=o.map(function(T){var A=w[T];return{data:A?{resolve:A}:{},classNames:A?["move"]:[],dir:T}})),b.push.apply(b,Ce([],ee(yj(n,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ce([],ee(Ej(n,e)),!1)),b},dragControlCondition:X_,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,S=p.beforeDirection,T=p.targetTransform,A=p.moveableClientRect,D=p.offsetMatrix,P=p.targetMatrix,M=p.allMatrix,V=p.width,C=p.height;if(!h&&!m)return!1;var I=n.getRect();i.rect=I,i.transform=T,i.left=b,i.top=_;var k=function(oe){var he=Pj(n.state,oe);i.fixedDirection=he.fixedDirection,i.fixedOffset=he.fixedOffset,i.fixedPosition=he.fixedPosition,G&&G.setFixedPosition(oe)},z=function(oe){var he=$Z(n.state,oe);i.fixedDirection=he.fixedDirection,i.fixedOffset=he.fixedOffset,i.fixedPosition=he.fixedPosition,G&&G.setFixedDirection(oe)},L=a,B=o;if(h||d||u){var O=c||0;i.beforeInfo={origin:I.beforeOrigin,prevDeg:O,defaultDeg:O,prevSnapDeg:0,startDist:0},i.afterInfo=Q(Q({},i.beforeInfo),{origin:I.origin}),i.absoluteInfo=Q(Q({},i.beforeInfo),{origin:I.origin,startValue:O})}else{var J=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(J){var K=J.getAttribute("data-direction")||"",H=eZ[K];if(H){i.isControl=!0,i.isAroundControl=ar(J,He("around-control")),i.controlDirection=H;var Z=J.getAttribute("data-resolve");Z&&(i.resolveAble=Z);var ne=EJ(p.rootMatrix,p.renderPoses,A);t=ee(sr(ne,H),2),L=t[0],B=t[1]}}i.beforeInfo={origin:I.beforeOrigin},i.afterInfo={origin:I.origin},i.absoluteInfo={origin:I.origin,startValue:I.rotation};var ue=k;k=function(oe){var he=p.is3d?4:3,ye=ee(Ot(Q3(P,he),oe),2),Te=ye[0],Me=ye[1],We=Mr(D,kc([Te,Me],he)),de=Mr(M,kc([oe[0],oe[1]],he));ue(oe);var Se=p.posDelta;i.beforeInfo.origin=Ke(We,Se),i.afterInfo.origin=Ke(de,Se),i.absoluteInfo.origin=Ke(de,Se),l1(n,i.beforeInfo,L,B,A),l1(n,i.afterInfo,L,B,A),l1(n,i.absoluteInfo,L,B,A)},z=function(oe){var he=sr([[0,0],[V,0],[0,C],[V,C]],oe);k(he)}}i.startClientX=L,i.startClientY=B,i.direction=w,i.beforeDirection=S,i.startValue=0,i.datas={},cy(n,e,"rotate");var Y=!1,G=!1;if(i.isControl&&i.resolveAble){var $=i.resolveAble;$==="resizable"&&(G=K_.dragControlStart(n,Q(Q({},new Ad("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}G||(Y=Br.dragStart(n,new Ad().dragStart([0,0],e))),k(SJ(n));var re=gt(n,e,Q(Q({set:function(oe){i.startValue=oe*Math.PI/180},setFixedDirection:z,setFixedPosition:k},ly(n,e)),{dragStart:Y,resizeStart:G})),W=je(n,"onRotateStart",re);return i.isRotate=W!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?re:!1},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,A=a.startValue,D=a.rect,P=a.startClientX,M=a.startClientY;if(T){sy(n,e,"rotate");var V=tZ(e),C=b*V,I=n.props.parentMoveable,k=0,z,L,B=0,O,J,K=0,H,Z,ne=180/Math.PI*A,ue=S.startValue,Y=!1,G=P+o,$=M+c;if(!d&&"parentDist"in e){var re=e.parentDist;z=re,O=re,H=re}else h||d?(z=_0(u,b,_),O=_0(u,C,w),H=_0(u,C,S)):(z=c1(G,$,b,_),O=c1(G,$,C,w),H=c1(G,$,C,S),Y=!0);if(L=ne+z,J=ne+O,Z=ue+H,je(n,"onBeforeRotate",gt(n,e,{beforeRotation:L,rotation:J,absoluteRotation:Z,setRotation:function(Be){O=Be-ne,z=O,H=O}},!0)),t=ee(u1(n,D,_,z,ne,Y),3),k=t[0],z=t[1],L=t[2],r=ee(u1(n,D,w,O,ne,Y),3),B=r[0],O=r[1],J=r[2],i=ee(u1(n,D,S,H,ue,Y),3),K=i[0],H=i[1],Z=i[2],!(!K&&!B&&!k&&!I&&!m)){var W=oy(a,"rotate(".concat(J,"deg)"),"rotate(".concat(O,"deg)"));m&&(a.fixedPosition=xS(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var oe=fZ(n,O,a),he=Ke(Ot(p||[0,0],oe),a.prevInverseDist||[0,0]);a.prevInverseDist=oe,a.requestValue=null;var ye=gj(n,W,he,h,e),Te=ye,Me=Os([G,$],S.startAbsoluteOrigin)-S.startDist,We=void 0;if(a.resolveAble==="resizable"){var de=K_.dragControl(n,Q(Q({},Jp(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:Me}));de&&(We=de,Te=Xj(Te,de,e))}var Se=gt(n,e,Q(Q({delta:B,dist:O,rotate:J,rotation:J,beforeDist:z,beforeDelta:k,beforeRotate:L,beforeRotation:L,absoluteDist:H,absoluteDelta:K,absoluteRotate:Z,absoluteRotation:Z,isPinch:!!h,resize:We},ye),Te));return je(n,"onRotate",Se),Se}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=xi(n,e,{});return je(n,"onRotateEnd",r),r}},dragGroupControlCondition:X_,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=js(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,S=b.beforeOrigin,T=Ot(Ke([_,w],[i,a]),Ke(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,Q(Q({},m),{parentRotate:0})}),d=Q(Q({},c),{targets:n.props.targets,events:u}),h=je(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){py(n,"onBeforeRotate",function(d){je(n,"onBeforeRotateGroup",gt(n,e,Q(Q({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=js(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=ee(h.datas.groupClient,2),b=m[0],_=m[1],w=ee(Xp(p,o*i),2),S=w[0],T=w[1],A=[S-b,T-_];return h.datas.groupClient=[S,T],Q(Q({},h),{parentRotate:a,groupDelta:A})});n.rotation=i*r.beforeRotation;var u=Q({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return je(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=js(n,this,"dragControlEnd",e),a=xi(n,e,{targets:n.props.targets,events:i});return je(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function XZ(n,e){var t,r=n.direction,i=n.classNames,a=n.size,o=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function AS(n,e){return XZ(Q(Q({},n),{classNames:Ce([He("line","guideline",n.direction)],ee(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(ot(t,.1),"px")})}),e)}function wk(n,e,t,r,i,a,o,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,AS({key:"".concat(e,"TargetGuideline").concat(h),classNames:[He("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function Ek(n,e,t,r,i,a){var o=n.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?ul:dl,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,S=m.element,T=m.className,A=[-r[0]+_[0],-r[1]+_[1]];return AS({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[He("bold"),T]:[He("normal"),T],direction:e,posValue:A,sizeValue:w,zoom:c},a)})}function fh(n,e,t,r,i,a,o,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(M,V){return M}:_,S=d.zoom,T=e==="horizontal"?"X":"Y",A=e==="vertical"?"height":"width",D=Math.abs(i),P=b?parseFloat(D.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:He("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[A]="".concat(D,"px"),u)},AS({direction:e,classNames:[He(t),o],size:"100%",posValue:[0,0],sizeValue:D,zoom:S},c),c.createElement("div",{className:He("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},P>0?w(P,e):""))}function WZ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,o=i?ul:dl,c=t[o.start],u=t[o.end];return Wj(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var A=b.pos,D={element:S,rect:Q(Q({},T),(_={},_[o.end]=T[o.start],_))},P={element:S,rect:Q(Q({},T),(w={},w[o.start]=T[o.end],w))},M=[0,0],V=[0,0];M[i]=A[i],M[a]=A[a],V[i]=A[i],V[a]=A[a]+b.size,h.push({type:n,pos:M,size:0,elementRect:D,direction:"",elementDirection:"end"}),p.push({type:n,pos:V,size:0,elementRect:P,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function QZ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=WZ(c,u,r,a),m=d?dl:ul,b=d?ul:dl,_=r[m.start],w=r[m.end];p.forEach(function(S){var T=S.total,A=S.start,D=S.end,P=S.inner,M=t[h]+T[0].pos[h]-r[b.start],V=r;A.forEach(function(C){var I=C.elementRect.rect,k=V[m.start]-I[m.end];if(k>0){var z=[0,0];z[d]=t[d]+V[m.start]-_-k,z[h]=M,o.push(fh(n,c,"dashed",o.length,k,z,C.className,i))}V=I}),V=r,D.forEach(function(C){var I=C.elementRect.rect,k=I[m.start]-V[m.end];if(k>0){var z=[0,0];z[d]=t[d]+V[m.end]-_,z[h]=M,o.push(fh(n,c,"dashed",o.length,k,z,C.className,i))}V=I}),P.forEach(function(C){var I=C.elementRect.rect,k=_-I[m.start],z=I[m.end]-w,L=[0,0],B=[0,0];L[d]=t[d]-k,L[h]=M,B[d]=t[d]+w-_,B[h]=M,o.push(fh(n,c,"dashed",o.length,k,L,C.className,i)),o.push(fh(n,c,"dashed",o.length,z,B,C.className,i))})})}),o}function ZZ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?dl:ul,p=u?ul:dl,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(S){var T=S.gap,A=S.gapRects,D=Math.max.apply(Math,Ce([_],ee(A.map(function(V){var C=V.rect;return C[p.start]})),!1)),P=Math.min.apply(Math,Ce([w],ee(A.map(function(V){var C=V.rect;return C[p.end]})),!1)),M=(D+P)/2;D===P||M===(_+w)/2||A.forEach(function(V){var C=V.rect,I=V.className,k=[t[0],t[1]];if(C[h.end]<m)k[u]+=C[h.end]-m;else if(b<C[h.start])k[u]+=C[h.start]-m-T;else return;k[d]+=M-_,a.push(fh(n,u?"vertical":"horizontal","gap",a.length,T,k,I,i))})})}),a}function W_(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,S=b.verticalGuidelines,T=b.horizontalGuidelines,A=b.snapThreshold,D=A===void 0?5:A,P=b.maxSnapElementGuidelineDistance,M=P===void 0?1/0:P,V=b.isDisplayGridGuidelines,C=qi(Yi(n.state)),I=C.top,k=C.left,z=C.bottom,L=C.right,B={top:I,left:k,bottom:z,right:L,center:(k+L)/2,middle:(I+z)/2},O=nJ(n),J=Ce([],ee(O),!1),K=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(ue){return ue*D});w&&J.push.apply(J,Ce([],ee(JZ(n,B,K)),!1));var H=Q({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(J.push.apply(J,Ce([],ee(tJ(n,o?u:h,o?c:d,p,m,H,V)),!1)),a){var Z=i.left,ne=i.top;H.left+=Z,H.top+=ne,H.right+=Z,H.bottom+=ne}return J.push.apply(J,Ce([],ee(Vj(T||!1,S||!1,o?u:h,o?c:d,p,m,H)),!1)),J=J.filter(function(ue){var Y=ue.element,G=ue.elementRect,$=ue.type;if(!Y||!G)return!0;var re=G.rect;return jj(B,re,$,M)}),J}function JZ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=n.state.elementRects,d=[];return[["vertical",ul,dl],["horizontal",dl,ul]].forEach(function(h){var p=ee(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],S=e[b.end],T=e[b.center],A=e[_.start],D=e[_.end],P={left:t[0],top:t[1]};function M(I){var k=I.rect,z=P[b.start];return k[b.end]<w+z?w-k[b.end]:S-z<k[b.start]?k[b.start]-S:-1}var V=u.filter(function(I){var k=I.rect;return k[_.start]>D||k[_.end]<A?!1:M(I)>0}).sort(function(I,k){return M(I)-M(k)}),C=[];V.forEach(function(I){V.forEach(function(k){if(I!==k){var z=I.rect,L=k.rect,B=z[_.start],O=z[_.end],J=L[_.start],K=L[_.end];B>K||J>O||C.push([I,k])}})}),C.forEach(function(I){var k=ee(I,2),z=k[0],L=k[1],B=z.rect,O=L.rect,J=B[b.start],K=B[b.end],H=O[b.start],Z=O[b.end],ne=P[b.start],ue=0,Y=0,G=!1,$=!1,re=!1;if(K<=w&&S<=H){if($=!0,ue=(H-K-(S-w))/2,Y=K+ue+(S-w)/2,_e(Y-T)>ne)return}else if(K<H&&Z<w+ne){if(G=!0,ue=H-K,Y=Z+ue,_e(Y-w)>ne)return}else if(K<H&&S-ne<J){if(re=!0,ue=H-K,Y=J-ue,_e(Y-S)>ne)return}else return;ue&&jj(e,O,m,a)&&(ue>c||d.push({type:m,pos:m==="vertical"?[Y,0]:[0,Y],element:L.element,size:0,className:L.className,isStart:G,isCenter:$,isEnd:re,gap:ue,hide:!0,gapRects:[z,L],direction:"",elementDirection:""}))})}),d}function eJ(n,e,t,r){var i,a,o=n.props,c=n.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=n.getRect(),T=S.children,A=b.direction;if(T){var D=A.map(function(M,V){var C=V===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},I=C.snapSize,k=C.posName,z=C.sizeName,L=C.clientOffset;if(!I)return{dir:M,multiple:1,snapSize:I,snapOffset:0};var B=S[z],O=S[k],J=A3(T.map(function(G){return[G[k]-O,G[z],B-G[z]-G[k]+O]})).filter(function(G){return G}).sort(function(G,$){return G-$}),K=J[0],H=J.map(function(G){return ot(G/K,.1)*I}),Z=1,ne=ot(B/K,.1);for(Z=1;Z<=10&&!H.every(function(G){return G*Z%1===0});++Z);var ue=(-M+1)/2,Y=iv(O-L,O-L+B,ue,1-ue);return{multiple:ne*Z,dir:M,snapSize:I,snapOffset:Math.round(Y/I)}}),P=D.map(function(M){return M.multiple||1});c.snapThresholdInfo.multiples=P,c.snapThresholdInfo.offset=D.map(function(M){return M.snapOffset}),D.forEach(function(M,V){M.snapSize})}}else c.snapThresholdInfo=null}function tJ(n,e,t,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,S=[0,0];eJ(n,r,i,a);var T=u.snapThresholdInfo,A=h,D=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var P=function(V){b.push({type:"horizontal",pos:[_,ot(S[1]*D+V-i+w,.1)],className:He("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},M=0;M<=t*2;M+=m)P(M);for(var M=-m;M>=-t;M-=m)P(M)}if(h){for(var P=function(C){b.push({type:"vertical",pos:[ot(S[0]*A+C-r+_,.1),w],className:He("grid-guideline"),size:t,hide:!o,direction:"",grid:!0})},M=0;M<=e*2;M+=h)P(M);for(var M=-h;M>=-e;M-=h)P(M)}return b}function jj(n,e,t,r){return t==="horizontal"?_e(n.right-e.left)<=r||_e(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?_e(n.bottom-e.top)<=r||_e(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function nJ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return ya(m)&&"element"in m?Q(Q({},m),{element:ts(m.element,!0)}):{element:ts(m,!0)}}).filter(function(m){return m.element}),o=pQ(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=ee(m,2),_=b[0],w=b[1];d[w]=i[_]}),rJ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=wS(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,S=m.left,T=S===void 0?h.left:S,A=m.right,D=A===void 0?h.right:A,P=m.bottom,M=P===void 0?h.bottom:P,V=m.center,C=V===void 0?h.center:V,I=m.middle,k=I===void 0?h.middle:I,z=m.className,L=m.rect,B=ES({top:w,right:D,left:T,bottom:M,center:C,middle:k},L),O=B.horizontal,J=B.vertical,K=B.horizontalNames,H=B.verticalNames,Z=L.top,ne=L.left,ue=L.right-ne,Y=L.bottom-Z,G=[ue,Y];J.forEach(function($,re){p.push({type:"vertical",element:b,pos:[ot($,.1),Z],size:Y,sizes:G,className:z,elementRect:m,elementDirection:pk[H[re]]||H[re],direction:""})}),O.forEach(function($,re){p.push({type:"horizontal",element:b,pos:[ne,ot($,.1)],size:ue,sizes:G,className:z,elementRect:m,elementDirection:pk[K[re]]||K[re],direction:""})})}),p}function Sk(n,e){return n?n.map(function(t){var r=ya(t)?t:{pos:t},i=r.pos;return Sd(i)?r:Q(Q({},r),{pos:nn(i,e)})}):[]}function Vj(n,e,t,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=t+p-u,b=r+h-d;return Sk(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,ot(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),Sk(e,m).forEach(function(_){c.push({type:"vertical",pos:[ot(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function rJ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=ee(CZ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),S=w.left-h-m,T=w.top-p-b,A=T+w.height,D=S+w.width,P=ee(Rd(a,[S,T],u),2),M=P[0],V=P[1],C=ee(Rd(a,[D,A],u),2),I=C[0],k=C[1];return Q(Q({},_),{rect:{left:M,right:I,top:V,bottom:k,center:(M+I)/2,middle:(V+k)/2}})})}function $m(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var o=ts(r,!0);if(o){var c=Oh(o),u=Dk(e,[c.left-i.left,c.top-i.top]),d=Dk(e,[c.right-i.right,c.bottom-i.bottom]);a.left=ot(u[0],1e-5),a.top=ot(u[1],1e-5),a.right=ot(d[0],1e-5),a.bottom=ot(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=W_(n),e.enableSnap=!0,!0}function zj(n,e,t,r,i,a){var o=Uc(n,e,t,a?4:3),c=sr(o,r);return IS(o,Ke(i,c))}function Tk(n){return n?n/_e(n):0}function iJ(n,e,t,r,i,a){var o=a.fixedDirection,c=kZ(t,o,r),u=TS(n,e,t,r),d=Ce(Ce([],ee(GZ(n,e,c,r,i,a)),!1),ee(Nj(n,u,a)),!1),h=uv(d,0),p=uv(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function aJ(n,e,t,r,i,a,o,c,u){var d=sr(e,o),h=fy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(ot(m,G_)||ot(p,G_)){var b=ee(os({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],S=Math.min(i||1/0,t+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[S-t,T-r]}return[0,0]}function Lj(n,e,t,r,i,a,o,c){for(var u=Yi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=iJ(n,b,i,d,o,c),w=_.width,S=_.height,T=w.isBound,A=S.isBound,D=w.offset,P=S.offset;if(m===1&&(T||(D=0),A||(P=0)),m===0&&o&&!T&&!A)return[0,0];if(d){var M=_e(D)*(t?1/t:1),V=_e(P)*(r?1/r:1),C=T&&A?M<V:A||!T&&M<V;C?D=t*P/r:P=r*D/t}h+=D,p+=P}if(!d&&i[0]&&i[1]){var I=HZ(n,u,i,a,c),k=I.maxWidth,z=I.maxHeight,L=ee(aJ(n,e(h,p).map(function(J){return J.map(function(K){return ot(K,G_)})}),t+h,r+p,k,z,i,o,c),2),D=L[0],P=L[1];h+=D,p+=P}return[h,p]}function Mh(n){return n<0&&(n=n%360+360),n%=360,n}function sJ(n,e){e=Mh(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return _e(n-r)<_e(n-i)?r:i}function d1(n,e){n=Mh(n),e=Mh(e);var t=Mh(n-e);return Math.min(t,360-t)}function oJ(n,e,t,r){var i,a=n.props,o=(i=a[Sj])!==null&&i!==void 0?i:5,c=a[Tj];if(Kd(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(P){return Ke(P,m)}),w=_.map(function(P){return Xp(P,b)}),S=Ce(Ce([],ee(EZ(n,_,w,m,t)),!1),ee(VZ(n,_,w,m,t)),!1);S.sort(function(P,M){return _e(P-t)-_e(M-t)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:t}}if(c?.length&&o){var A=c.slice().sort(function(P,M){return d1(P,r)-d1(M,r)}),D=A[0];if(d1(D,r)<=o)return{isSnap:!0,dist:t+sJ(r,D)-r}}return{isSnap:!1,dist:t}}function lJ(n,e,t,r,i,a,o){if(!Kd(n,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return Lj(n,function(m,b){return zj(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,o)}function cJ(n,e,t,r,i){if(!Kd(n,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=Lj(n,function(p,m){return zj(lZ(i,Ot(e,[p/a,m/o])),a,o,u,c,d)},a,o,t,c,r,i);return[h[0]/a,h[1]/o]}function uJ(n,e){e.absolutePoses=Yi(n.state)}function Ak(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;ai(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return Q(Q({},r),{direction:i.direction})})}function Ck(n,e,t,r,i,a){var o=_S(uy(n,a),e,t),c=o.vertical,u=o.horizontal,d=Xu();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=zZ(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){Hs(r,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){Hs(i,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var dJ=kS("",["resizable","scalable"]),fJ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",Sj,Tj,Aj,Cj,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,o=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!Kd(n,""))return Qu(n,"boundMap",Xu(),function(W){return JSON.stringify(W)}),Qu(n,"innerBoundMap",Xu(),function(W){return JSON.stringify(W)}),[];t.guidelines=W_(n);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Yi(n.state),S=[],T=[],A=[],D=[],P=[],M=qi(w),V=M.width,C=M.height,I=M.top,k=M.left,z=M.bottom,L=M.right,B={left:k,right:L,top:I,bottom:z,center:(k+L)/2,middle:(I+z)/2},O=_.length>0,J=O?qi(_):{};if(!d.request){if(d.direction&&P.push(DZ(n,w,d.direction,p,p)),d.snap){var K=qi(w);d.center&&(K.middle=(K.top+K.bottom)/2,K.center=(K.left+K.right)/2),P.push(gk(n,K,p,p))}O&&(d.center&&(J.middle=(J.top+J.bottom)/2,J.center=(J.left+J.right)/2),P.push(gk(n,J,p,p))),P.forEach(function(W){var oe=W.vertical.posInfos,he=W.horizontal.posInfos;S.push.apply(S,Ce([],ee(oe.filter(function(ye){var Te=ye.guidelineInfos;return Te.some(function(Me){var We=Me.guideline;return!We.hide})}).map(function(ye){return{type:"snap",pos:ye.pos}})),!1)),T.push.apply(T,Ce([],ee(he.filter(function(ye){var Te=ye.guidelineInfos;return Te.some(function(Me){var We=Me.guideline;return!We.hide})}).map(function(ye){return{type:"snap",pos:ye.pos}})),!1)),A.push.apply(A,Ce([],ee(Ak(oe)),!1)),D.push.apply(D,Ce([],ee(Ak(he)),!1))})}var H=Ck(n,[k,L],[I,z],S,T),Z=H.boundMap,ne=H.innerBoundMap;O&&Ck(n,[J.left,J.right],[J.top,J.bottom],S,T,d.externalBounds);var ue=Ce(Ce([],ee(A),!1),ee(D),!1),Y=ue.filter(function(W){return W.element&&!W.gapRects}),G=ue.filter(function(W){return W.gapRects}).sort(function(W,oe){return W.gap-oe.gap});je(n,"onSnap",{guidelines:ue.filter(function(W){var oe=W.element;return!oe}),elements:Y,gaps:G},!0);var $=Qu(n,"boundMap",Z,function(W){return JSON.stringify(W)},Xu()),re=Qu(n,"innerBoundMap",ne,function(W){return JSON.stringify(W)},Xu());return(Z===$||ne===re)&&je(n,"onBound",{bounds:Z,innerBounds:ne},!0),Ce(Ce(Ce(Ce(Ce(Ce([],ee(QZ(n,Y,[m,b],B,e)),!1),ee(ZZ(n,G,[m,b],B,e)),!1),ee(Ek(n,"horizontal",D,[i,r],B,e)),!1),ee(Ek(n,"vertical",A,[i,r],B,e)),!1),ee(wk(n,"horizontal",T,m,r,V,0,e)),!1),ee(wk(n,"vertical",S,b,i,C,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},$m(n)},drag:function(n){var e=n.state;$m(n)||(e.guidelines=W_(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(dJ(n,e)||X_(n,e))return!0;if(!e.isRequest&&e.inputEvent)return ar(e.inputEvent.target,He("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,$m(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,$m(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function hJ(n,e){return[n[0]*e[0],n[1]*e[1]]}function He(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return lW.apply(void 0,Ce([vS],ee(n),!1))}function Bj(n){n()}function pJ(n){return!n||n==="none"?[1,0,0,1,0,0]:ya(n)?n:dp(n)}function Ph(n,e,t){return sv(e,Nc(t,e),n,Nc(t.map(function(r){return-r}),e))}function gJ(n,e,t){if(e==="%"){var r=CS(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function mJ(n){var e=vJ(RS(n,":before"));return e.map(function(t,r){var i=Hp(t),a=i.value,o=i.unit;return a*gJ(n,o,r===0)})}function fv(n){return n?n.split(" "):["0","0"]}function vJ(n){return fv(n.transformOrigin)}function Uj(n){var e=si(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function hp(n,e,t,r,i){var a,o,c=sS(n)||vl(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",S=1,T=parseFloat(i?.("zoom"))||1,A=i?.("position");d&&d!==c;){e===d&&(_=!0);var D=si(d),P=d.tagName.toLowerCase(),M=Uj(d),V=D("willChange"),C=parseFloat(D("zoom"))||1;if(w=D("position"),r&&C!==1){S=C;break}if(!t&&r&&T!==1&&A&&A!=="absolute"||P==="svg"||P==="foreignobject"||w!=="static"||M&&M!=="none"||V==="transform")break;var I=(o=n?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;I&&(u=!0,h=k);var z=k;if(z&&z.nodeType===11){d=z.host,b=!0,w=si(d)("position");break}d=z,w="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function yJ(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,o=si(n),c=ny(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=sj?mJ(n):fv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=ee(_J(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=fv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function Fj(n,e){var t=si(n),r=si(vl(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,o]}function Q_(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=ba(t,3,4))})}function bJ(n){for(var e=n.parentElement,t=!1,r=vl(n);e;){var i=RS(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function hy(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat(Z3(n,!e).join(","),")")}function CS(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function xJ(n,e){var t,r=CS(n),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var A=m===2?Math.max(d,u):Math.min(u,d);_[0]=A,_[1]=A,w[0]=(o-i)/2*S,w[1]=(c-a)/2*T}var D=hS(_,e);return t=ee(w,2),D[e*(e-1)]=t[0],D[e*(e-1)+1]=t[1],Ph(D,e,b)}function _J(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=si(n),a=i("transform-box")==="fill-box",o=n.getBBox(),c=CS(n.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function _n(n,e,t){return Mr(n,kc(e,t),t)}function Uc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return _n(n,i,r)})}function qi(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ce([],ee(e),!1)),i=Math.min.apply(Math,Ce([],ee(t),!1)),a=Math.max.apply(Math,Ce([],ee(e),!1)),o=Math.max.apply(Math,Ce([],ee(t),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function Ik(n,e,t,r){var i=Uc(n,e,t,r);return qi(i)}function wJ(n,e,t,r,i){var a,o=n.target,c=n.origin,u=e.matrix,d=qj(o),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===vl(t)&&(b=Fj(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],S=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,A=_.height,D=sv(r,i,u),P=Ik(D,h,p,r),M=P.left,V=P.top,C=P.width,I=P.height,k=_n(D,c,r),z=Ke(k,[M,V]),L=[w+z[0]*T/C,S+z[1]*A/I],B=[0,0],O=0;++O<10;){var J=rs(i,r);a=ee(Ke(_n(J,L,r),_n(J,k,r)),2),B[0]=a[0],B[1]=a[1];var K=sv(r,i,Nc(B,r),u),H=Ik(K,h,p,r),Z=H.left,ne=H.top,ue=Z-w,Y=ne-S;if(_e(ue)<2&&_e(Y)<2)break;L[0]-=ue,L[1]-=Y}return B.map(function(G){return Math.round(G)})}function EJ(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return _n(n,u,i)}),o=t.left,c=t.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function $i(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Gj(n,e){return $i([e[0]-n[0],e[1]-n[1]])}function hh(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=Ln(n,e));var i=Gj(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function hv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,o=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function Pc(n,e){var t=n[e];return ya(t)?Q(Q({},n),t):n}function qj(n){var e=n&&!ny(n.offsetWidth),t=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,S=1/0,T=1/0,A=0,D=0,P=!1;if(n)if(!e&&n.ownerSVGElement){var M=n.getBBox();P=!0,t=M.width,r=M.height,o=t,c=r,u=t,d=r,i=t,a=r}else{var V=si(n),C=n.style,I=V("boxSizing")==="border-box",k=parseFloat(V("borderLeftWidth"))||0,z=parseFloat(V("borderRightWidth"))||0,L=parseFloat(V("borderTopWidth"))||0,B=parseFloat(V("borderBottomWidth"))||0,O=parseFloat(V("paddingLeft"))||0,J=parseFloat(V("paddingRight"))||0,K=parseFloat(V("paddingTop"))||0,H=parseFloat(V("paddingBottom"))||0,Z=O+J,ne=K+H,ue=k+z,Y=L+B,G=Z+ue,$=ne+Y,re=V("position"),W=0,oe=0;if("clientLeft"in n){var he=null;if(re==="absolute"){var ye=hp(n,vl(n));he=ye.offsetParent}else he=n.parentElement;if(he){var Te=si(he);W=parseFloat(Te("width")),oe=parseFloat(Te("height"))}}h=Math.max(Z,nn(V("minWidth"),W)||0),p=Math.max(ne,nn(V("minHeight"),oe)||0),_=nn(V("maxWidth"),W),w=nn(V("maxHeight"),oe),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),A=nn(C.width,0)||0,D=nn(C.height,0)||0,o=parseFloat(V("width"))||0,c=parseFloat(V("height"))||0,u=_e(o-A)<1?D_(h,A||o,_):o,d=_e(c-D)<1?D_(p,D||c,w):c,t=u,r=d,i=u,a=d,I?(S=_,T=w,m=h,b=p,u=t-G,d=r-$):(S=_+G,T=w+$,m=h+G,b=p+$,t=u+G,r=d+$),i=u+Z,a=d+ne}return{svg:P,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:A,inlineCSSHeight:D,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function Hj(n,e){return Ln(e>0?n[0]:n[1],e>0?n[1]:n[0])}function Ym(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function $j(n,e){var t=n===vl(n)||n===sS(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=si(n)("overflow")!=="visible",Q(Q({},e),r)}function f1(n,e,t,r){var i=n.left,a=n.right,o=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return t&&r?$j(t,h):h}function Oh(n,e){var t=0,r=0,i=0,a=0;if(n){var o=n.getBoundingClientRect();t=o.left,r=o.top,i=o.width,a=o.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?$j(n,c):c}function SJ(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?MS(r,a,o):u}function Yj(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=Kj(a,r)}return i}function Kj(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function IS(n,e){return[Ot(e,n[0]),Ot(e,n[1]),Ot(e,n[2]),Ot(e,n[3])]}function Yi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,o=n.pos4;return IS([r,i,a,o],[e,t])}function Z_(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Wu(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&Z_(n,e),r?.unset(),n[t]=null}function qr(n,e){if(e){var t=Yd(e);t.nextStyle=Q(Q({},t.nextStyle),n)}return{style:n,cssText:$s(n).map(function(r){return"".concat(x0(r,"-"),": ").concat(n[r],";")}).join("")}}function Xj(n,e,t){var r=e.afterTransform||e.transform;return Q(Q({},qr(Q(Q(Q({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function gt(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=Q(Q({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function xi(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),Q(Q({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function py(n,e,t){n._emitter.on(e,t)}function je(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function RS(n,e){return tl(n).getComputedStyle(n,e)}function Km(n,e,t){var r={},i={};return n.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function J_(n,e){return n===e||n==null&&e==null}function Rk(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!ny(i))return i}return n[t]}function Wj(n,e){var t=[],r=[];return n.forEach(function(i,a){var o=e(i,a,n),c=r.indexOf(o),u=t[c]||[];c===-1&&(r.push(o),t.push(u)),u.push(i)}),t}function TJ(n,e){var t=[],r={};return n.forEach(function(i,a){var o=e(i,a,n),c=r[o];c||(c=[],r[o]=c,t.push(c)),c.push(i)}),t}function Qj(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Id(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return _e(r)-_e(t)}),n[0]}function Rd(n,e,t){return Mr(rs(n,t),kc(e,t),t)}function AJ(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=ee(Rd(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function Oi(n,e,t,r){if(!t[0]&&!t[1])return e;var i=_n(n,[Tk(t[0]||1),0],r),a=_n(n,[0,Tk(t[1]||1)],r),o=_n(n,[t[0]/$i(i),t[1]/$i(a)],r);return Ot(e,o)}function ua(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function pv(n){return _e(n)<=$r?0:n}function DS(n){return function(e){if(!e.isDragging(n))return"";var t=gZ(e,n),r=t.deg;return r?He("view-control-rotation".concat(r)):""}}function kS(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return ar(i,He("direction"))&&(!n||ar(i,He(n)))}}function CJ(n,e,t){var r,i=Td(n,{"x%":function(M){return M/100*e.offsetWidth},"y%":function(M){return M/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),o=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:Td([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],S=Bu(h),T=Bu(p),A=Bu(b),D=Bu(_),P=rn(S,A,4);return{transforms:n,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:Bu(w),afterFunctionMatrix:A,afterFunctionMatrix2:D,allFunctionMatrix:P,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function IJ(n){return!n||!ya(n)||Hd(n)?!1:er(n)||"length"in n}function ts(n,e){return n?Hd(n)?n:ii(n)?e?document.querySelector(n):n:rS(n)?n():D3(n)?n:"current"in n?n.current:n:null}function NS(n,e){if(!n)return[];var t=IJ(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return ii(i)&&e?Ce(Ce([],ee(r),!1),ee([].slice.call(document.querySelectorAll(i))),!1):(er(i)?r.push(NS(i,e)):r.push(ts(i,e)),r)},[])}function RJ(n,e,t){var r=Ln(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function Dk(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=rs(t,i);return r||(a=ba(a,3,4)),a[12]=0,a[13]=0,a[14]=0,fQ(a,e)}function Zj(n,e,t,r,i){var a=ee(n,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=Ln([0,0],e),p=Ln([0,0],r),m=$i(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*o,w=r[1]*c,S=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var A=0;_e(S-T)<Math.PI/2||_e(S-T)>Math.PI/2*3||(T+=Math.PI),A=S-T,A>Math.PI*2?A-=Math.PI*2:A>Math.PI?A=2*Math.PI-A:A<-Math.PI&&(A=-2*Math.PI-A);var D=$i([_+e[0],w+e[1]])*Math.cos(A);u=D*Math.sin(T)-_,d=D*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function Jj(n,e,t,r){var i,a=t.ratio,o=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,S=t.fixedDirection,T=[0,1].map(function(C){return _e(n[C]-S[C])}),A=[0,1].map(function(C){var I=T[C];return I!==0&&(I=2/I),I});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(Sd(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(b){var D=o*T[0],P=c*T[1],M=$i([D,P]);u=b/M*D*A[0],d=b/M*P*A[1]}else{var V=os({datas:t,distX:h,distY:p});V=A.map(function(C,I){return V[I]*C}),i=ee(Zj([o,c],V,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function ew(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=ee(n.split(" "),2),r=t[0],i=t[1],a=ew(r||""),o=ew(i||""),c=Q(Q({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function MS(n,e,t){var r=ew(n,!0),i=r.x,a=r.y;return[nn(i,e)||0,nn(a,t)||0]}function DJ(n,e,t){var r=n.map(function(a){return Ke(a,e)}),i=r.map(function(a){return Xp(a,t)});return{prev:r,next:i,result:i.map(function(a){return Ot(a,e)})}}function e5(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=er(t),o=er(i);return a&&o?e5(t,i):!a&&!o?t===i:!1})}function Qu(n,e,t,r,i){var a=n._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=t,t;return o===t||r(o)===r(t)?o:(a[e]=t,t)}function Ur(n){return n>=0?1:-1}function _e(n){return Math.abs(n)}function h1(n,e){return TW(n).map(function(t){return e(t)})}function t5(n){return Sd(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var kJ=Zp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=n.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=gt(n,e,{});r&&(m.targets=r);var b=je(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var S=Q(Q({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,S)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=gt(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");je(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,Q(Q({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=xi(n,e,{isDrag:r});a&&(u.targets=a),je(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,Q(Q({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,Q(Q({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,Q(Q({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,Q(Q({},e),{targets:n.props.targets}))}}),kk=kS("scalable"),NJ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:_j("scalable"),dragControlCondition:kk,viewClassName:DS("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=Yj(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Bc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];cy(n,e,"scale"),t.isWidth=w;function S(V){t.ratio=V&&isFinite(V)?V:0}t.startPositions=Yi(n.state);function T(V){var C=Mj(t.startPositions,V);t.fixedDirection=C.fixedDirection,t.fixedPosition=C.fixedPosition,t.fixedOffset=C.fixedOffset}t.setFixedDirection=T,S(Os(m,b)/Os(b,_)),T([-o[0],-o[1]]);var A=function(V){t.minScaleSize=V},D=function(V){t.maxScaleSize=V};A([-1/0,-1/0]),D([1/0,1/0]);var P=gt(n,e,Q(Q({direction:o,set:function(V){t.startValue=V},setRatio:S,setFixedDirection:T,setMinScaleSize:A,setMaxScaleSize:D},ly(n,e)),{dragStart:Br.dragStart(n,new Ad().dragStart([0,0],e))})),M=je(n,"onScaleStart",P);return t.startFixedDirection=t.fixedDirection,M!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:o}),t.isScale?P:!1},dragControl:function(n,e){sy(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,S=t.isWidth,T=t.ratio;if(!_)return!1;var A=n.props,D=A.throttleScale,P=A.parentMoveable,M=p;!p[0]&&!p[1]&&(M=[1,1]);var V=T&&(r??A.keepRatio)||!1,C=n.state,I=[w[0],w[1]];function k(){var de=Jj(M,V,t,e),Se=de.distWidth,Be=de.distHeight,Pe=m?(m+Se)/m:1,Ge=b?(b+Be)/b:1;w[0]||(I[0]=Se/m),w[1]||(I[1]=Be/b);var Ue=(M[0]||V?Pe:1)*I[0],we=(M[1]||V?Ge:1)*I[1];return Ue===0&&(Ue=Ur(h[0])*Gm),we===0&&(we=Ur(h[1])*Gm),[Ue,we]}var z=k();if(!a&&n.props.groupable){var L=C.snapRenderInfo||{},B=L.direction;er(B)&&(B[0]||B[1])&&(C.snapRenderInfo={direction:p,request:e.isRequest})}je(n,"onBeforeScale",gt(n,e,{scale:z,setFixedDirection:function(de){return t.setFixedDirection(de),z=k(),z},startFixedDirection:t.startFixedDirection,setScale:function(de){z=de}},!0));var O=[z[0]/I[0],z[1]/I[1]],J=o,K=[0,0],H=Ur(O[0]*O[1]),Z=!o&&!i&&a;if(Z||d?J=xS(n,t.targetAllTransform,[0,0],[0,0],t):o||(J=t.fixedPosition),a||(K=cJ(n,O,p,!u&&c,t)),V){M[0]&&M[1]&&K[0]&&K[1]&&(Math.abs(K[0]*m)>Math.abs(K[1]*b)?K[1]=0:K[0]=0);var ne=!K[0]&&!K[1];if(ne&&(S?O[0]=ot(O[0]*I[0],D)/I[0]:O[1]=ot(O[1]*I[1],D)/I[1]),M[0]&&!M[1]||K[0]&&!K[1]||ne&&S){O[0]+=K[0];var ue=m*O[0]*I[0]/T;O[1]=Ur(H*O[0])*_e(ue/b/I[1])}else if(!M[0]&&M[1]||!K[0]&&K[1]||ne&&!S){O[1]+=K[1];var Y=b*O[1]*I[1]*T;O[0]=Ur(H*O[1])*_e(Y/m/I[0])}}else O[0]+=K[0],O[1]+=K[1],K[0]||(O[0]=ot(O[0]*I[0],D)/I[0]),K[1]||(O[1]=ot(O[1]*I[1],D)/I[1]);O[0]===0&&(O[0]=Ur(h[0])*Gm),O[1]===0&&(O[1]=Ur(h[1])*Gm),z=hJ(O,[I[0],I[1]]);var G=[m,b],$=[m*z[0],b*z[1]];$=T3($,t.minScaleSize,t.maxScaleSize,V?T:!1),z=h1(2,function(de){return G[de]?$[de]/G[de]:$[de]}),O=h1(2,function(de){return z[de]/I[de]});var re=h1(2,function(de){return h[de]?O[de]/h[de]:O[de]}),W="scale(".concat(O.join(", "),")"),oe="scale(".concat(z.join(", "),")"),he=oy(t,oe,W),ye=!w[0]||!w[1],Te=cZ(n,ye?oe:W,t.fixedDirection,J,t.fixedOffset,t,ye),Me=Z?Te:Ke(Te,t.prevInverseDist||[0,0]);if(t.prevDist=O,t.prevInverseDist=Te,z[0]===h[0]&&z[1]===h[1]&&Me.every(function(de){return!de})&&!P&&!Z)return!1;var We=gt(n,e,Q({offsetWidth:m,offsetHeight:b,direction:p,scale:z,dist:O,delta:re,isPinch:!!a},gj(n,he,Me,a,e)));return je(n,"onScale",We),We},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=xi(n,e,{});return je(n,"onScaleEnd",r),r},dragGroupControlCondition:kk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=pa(n,"resizable",e);t.moveableScale=n.scale;var a=js(n,this,"dragControlStart",e,function(d,h){return cv(n,d,t,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),cv(n,h.moveable,t,i[p])})};t.setFixedDirection=o;var c=Q(Q({},r),{targets:n.props.targets,events:a,setFixedDirection:o}),u=je(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){py(n,"onBeforeScale",function(h){je(n,"onBeforeScaleGroup",gt(n,e,Q(Q({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var o=n.props.keepRatio,c=t.fixedPosition,u=js(n,this,"dragControl",e,function(h,p){var m=ee(Mr(Wp(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return Q(Q({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:Ot(c,[b,_])})}),d=Q({targets:n.props.targets,events:u},r);return je(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=js(n,this,"dragControlEnd",e),a=xi(n,e,{targets:n.props.targets,events:i});return je(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function jo(n,e){return n.map(function(t,r){return iv(t,e[r],1,2)})}function Nk(n,e,t){var r=Ln(n,e),i=Ln(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function MJ(n,e){var t=Nk(n[0],n[1],n[2]),r=Nk(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var PJ={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:DS("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,o=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=jo(u,d),b=jo(d,u),_=jo(u,h),w=jo(h,u),S=jo(h,p),T=jo(p,h),A=jo(d,p),D=jo(p,d);return Ce([e.createElement("div",{className:He("line"),key:"middeLine1",style:hh(m,S,o)}),e.createElement("div",{className:He("line"),key:"middeLine2",style:hh(b,T,o)}),e.createElement("div",{className:He("line"),key:"middeLine3",style:hh(_,A,o)}),e.createElement("div",{className:He("line"),key:"middeLine4",style:hh(w,D,o)})],ee(wj(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return ar(t,He("direction"))&&ar(t,He("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,o=Kj(a,t);if(!o||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:ba(p,3,4),t.targetInverseMatrix=W3(rs(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(A){return Ke(A,u)}),t.nextPoses=t.poses.map(function(A){var D=ee(A,2),P=D[0],M=D[1];return Mr(t.warpTargetMatrix,[P,M,0,1],4)}),t.startValue=un(4),t.prevMatrix=un(4),t.absolutePoses=Yi(c),t.posIndexes=pj(o),Bc(n,e),cy(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=gt(n,e,Q({set:function(A){t.startValue=A}},ly(n,e))),T=je(n,"onWarpStart",S);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(sy(n,e,"matrix3d"),Kd(n,"warpable")){var b=p.map(function(k){return m[k]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=fy(n,r,{horizontal:b.map(function(k){return k[1]+a}),vertical:b.map(function(k){return k[0]+i})}),w=_.horizontal,S=_.vertical;a-=w.offset,i-=S.offset}var T=os({datas:t,distX:i,distY:a},!0),A=t.nextPoses.slice();if(p.forEach(function(k){A[k]=Ot(A[k],T)}),!JQ.every(function(k){return MJ(k.map(function(z){return h[z]}),k.map(function(z){return A[z]}))}))return!1;var D=pS(h[0],h[2],h[1],h[3],A[0],A[2],A[1],A[3]);if(!D.length)return!1;var P=rn(o,D,4),M=fj(t,P,!0),V=rn(rs(c,4),M,4);t.prevMatrix=M;var C=rn(d,M,4),I=oy(t,"matrix3d(".concat(C.join(", "),")"),"matrix3d(".concat(M.join(", "),")"));return bS(e,I),je(n,"onWarp",gt(n,e,Q({delta:V,matrix:C,dist:M,multiply:rn,transform:I},qr({transform:I},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,je(n,"onWarpEnd",xi(n,e,{})),r):!1}},OJ=He("area-pieces"),Xm=He("area-piece"),n5=He("avoid"),jJ=He("view-dragging");function p1(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;R3(e,n5),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Mk(n){return n.createElement("div",{key:"area_pieces",className:OJ},n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}),n.createElement("div",{className:Xm}))}var r5={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,o=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?He("area","pass"):He("area");if(a)return[e.createElement("div",{key:"area",ref:Ps(n,"areaElement"),className:p}),Mk(e)];if(!r||!i)return[];var m=pS([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?hy(m,!0):"none";return[e.createElement("div",{key:"area",ref:Ps(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),Mk(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var o=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=qi(d),w=_.left,S=_.top,T=_.width,A=_.height,D=p?4:3,P=ee(Rd(h,[r-m,i-b],D),2),M=P[0],V=P[1];M-=w,V-=S;var C=[{left:w,top:S,width:T,height:V-10},{left:w,top:S,width:M-10,height:A},{left:w,top:S+V+10,width:T,height:A-V-10},{left:w+M+10,top:S,width:T-M-10,height:A}],I=[].slice.call(o.nextElementSibling.children);C.forEach(function(k,z){I[z].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),I3(o,n5),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,p1(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||p1(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){p1(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&S3(function(){e.disableNativeEvent=!1})}},VJ=Zp("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,o=n.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,_=o.offsetWidth,w=o.offsetHeight,S;if(!a&&d&&i){var T=ee(MS(i,_,w),2),A=T[0],D=T[1],P=p?4:3,M=_n(h,[A,D],P);S=hv(u,r,Ke(M,[m,b]))}else S=hv(u,r,c);return[e.createElement("div",{className:He("control","origin"),style:S,key:"beforeOrigin"})]}});function zJ(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var LJ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,o=new yQ,c=ts(i,!0);e.datas.dragScroll=o,n.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=gt(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),je(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),o.dragStart(e,Q({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?zJ:h,m=r.scrollOptions;return t.drag(e,Q({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,Q(Q({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,Q(Q({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,Q(Q({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,Q(Q({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,Q(Q({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,Q(Q({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,Q(Q({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},i5={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},BJ=Zp("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=t5(t.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(S,T){var A=ee(S,2),D=A[0],P=A[1],M=_[D],V=_[P],C=d[D],I=d[P],k=pS([0,0],[100,0],[0,100],[100,100],M,V,C,I);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:He("padding"),style:{transform:hy(k,!0)}})})}}),Pk=["nw","ne","se","sw"];function Wm(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var UJ=[1,2,5,6],FJ=[0,3,4,7],rc=[1,-1,-1,1],ic=[1,1,-1,-1];function PS(n,e,t,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(ua(S,r,e)),S}else{var S=Math.max(0,b===1?w[0]-i:o-w[0]);return u.push(ua(S,t,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function a5(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function s5(n,e,t,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,S=_.length,T=S>0,A=ee(b,4),D=A[0],P=D===void 0?"0px":D,M=A[1],V=M===void 0?P:M,C=A[2],I=C===void 0?P:C,k=A[3],z=k===void 0?V:k,L=ee(_,4),B=L[0],O=B===void 0?P:B,J=L[1],K=J===void 0?T?O:V:J,H=L[2],Z=H===void 0?T?O:I:H,ne=L[3],ue=ne===void 0?T?K:z:ne,Y=[P,V,I,z].map(function(he){return nn(he,e)}),G=[O,K,Z,ue].map(function(he){return nn(he,t)}),$=Y.slice(),re=G.slice();c=ee(Wm([$[0],$[1]],e),2),$[0]=c[0],$[1]=c[1],u=ee(Wm([$[3],$[2]],e),2),$[3]=u[0],$[2]=u[1],d=ee(Wm([re[0],re[3]],t),2),re[0]=d[0],re[3]=d[1],h=ee(Wm([re[1],re[2]],t),2),re[1]=h[0],re[2]=h[1];var W=o?$:$.slice(0,Math.max(a[0],w)),oe=o?re:re.slice(0,Math.max(a[1],S));return Ce(Ce([],ee(W.map(function(he,ye){var Te=Pk[ye];return{virtual:ye>=w,horizontal:rc[ye],vertical:0,pos:[r+he,i+(ic[ye]===-1?t:0)],sub:!0,raw:Y[ye],direction:Te}})),!1),ee(oe.map(function(he,ye){var Te=Pk[ye];return{virtual:ye>=S,horizontal:0,vertical:ic[ye],pos:[r+(rc[ye]===-1?e:0),i+he],sub:!0,raw:G[ye],direction:Te}})),!1)}function GJ(n,e,t,r,i){i===void 0&&(i=e.length);var a=a5(n.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function qJ(n,e,t,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=a5(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=rc[r]===1?a-d:c-a,w=m[1];w<=r;++w){var S=ic[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:rc[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:rc[w],vertical:0,pos:[T,S]}),e.splice(t+w,0,[T,S]),w===0)break}else if(i>-1){var A=ic[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var D=[d+A,h];n.push({horizontal:rc[0],vertical:0,pos:D}),e.push(D)}for(var P=b[0],w=b[1];w<=i;++w){var T=rc[w]===1?d:c,S=0;if(i===w?S=o:w===0?S=h+A:ic[w]===1?S=e[t+P][1]:ic[w]===-1&&(S=u-(e[t+P][1]-h)),n.push({horizontal:0,vertical:ic[w],pos:[T,S]}),e.push([T,S]),w===0)break}}}function HJ(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var $J=[[0,-1,"n"],[1,0,"e"]],YJ=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function OS(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(V){return"".concat(ua(V[0],a,r)," ").concat(ua(V[1],o,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(V){return"".concat(V,"px")});var S=[m,a-b,o-w,_].map(function(V,C){return ua(V,C%2?a:o,r)});if(t.length>8){var T=ee(Ke(t[4],t[0]),2),A=T[0],D=T[1];S.push.apply(S,Ce(["round"],ee(PS(d.slice(8).map(function(V,C){return Q(Q({},V),{pos:t[C]})}),r,A,D,_,m,b,w).styles),!1))}return S}else if(p||u==="ellipse"){var P=t[0],M=ua(_e(t[1][1]-P[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[M]:[ua(_e(t[2][0]-P[0]),a,r),M];return S.push("at",ua(P[0],a,r),ua(P[1],o,r)),S}}function gv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return YJ.map(function(o){var c=ee(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:_e(d),horizontal:_e(u),direction:h,pos:[p,m]}})}function o5(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[_e(e[1]-e[0]),_e(t[1]-t[0])]}function Ok(n,e,t,r,i){var a,o,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=si(n),S=w("clipPath");_=S!=="none"?S:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=E3(_),A=T.prefix,D=A===void 0?_:A,P=T.value,M=P===void 0?"":P,V=D==="circle",C=" ";if(D==="polygon"){var I=lc(M||"0% 0%, 100% 0%, 100% 100%, 0% 100%");C=",";var k=I.map(function(et){var Tt=ee(et.split(" "),2),Qe=Tt[0],ct=Tt[1];return{vertical:1,horizontal:1,pos:[nn(Qe,e),nn(ct,t)]}}),z=Mc(k.map(function(et){return et.pos}));return{type:D,clipText:_,poses:k,splitter:C,left:z.minX,right:z.maxX,top:z.minY,bottom:z.maxY}}else if(V||D==="ellipse"){var L="",B="",O=0,J=0,I=cl(M);if(V){var K="";a=ee(I,4),o=a[0],K=o===void 0?"50%":o,c=a[2],L=c===void 0?"50%":c,u=a[3],B=u===void 0?"50%":u,O=nn(K,Math.sqrt((e*e+t*t)/2)),J=O}else{var H="",Z="";d=ee(I,5),h=d[0],H=h===void 0?"50%":h,p=d[1],Z=p===void 0?"50%":p,m=d[3],L=m===void 0?"50%":m,b=d[4],B=b===void 0?"50%":b,O=nn(H,e),J=nn(Z,t)}var ne=[nn(L,e),nn(B,t)],k=Ce([{vertical:1,horizontal:1,pos:ne,direction:"nesw"}],ee($J.slice(0,V?1:2).map(function(Qe){return{vertical:_e(Qe[1]),horizontal:Qe[0],direction:Qe[2],sub:!0,pos:[ne[0]+Qe[0]*O,ne[1]+Qe[1]*J]}})),!1);return{type:D,clipText:_,radiusX:O,radiusY:J,left:ne[0]-O,top:ne[1]-J,right:ne[0]+O,bottom:ne[1]+J,poses:k,splitter:C}}else if(D==="inset"){var I=cl(M||"0 0 0 0"),ue=I.indexOf("round"),Y=(ue>-1?I.slice(0,ue):I).length,G=I.slice(Y+1),$=ee(I.slice(0,Y),4),re=$[0],W=$[1],oe=W===void 0?re:W,he=$[2],ye=he===void 0?re:he,Te=$[3],Me=Te===void 0?oe:Te,We=ee([re,ye].map(function(Qe){return nn(Qe,t)}),2),de=We[0],Se=We[1],Be=ee([Me,oe].map(function(Qe){return nn(Qe,e)}),2),Pe=Be[0],Ge=Be[1],Ue=e-Ge,we=t-Se,Oe=s5(G,Ue-Pe,we-de,Pe,de),k=Ce(Ce([],ee(gv(de,Ue,we,Pe)),!1),ee(Oe),!1);return{type:"inset",clipText:_,poses:k,top:de,left:Pe,right:Ue,bottom:we,radius:G,splitter:C}}else if(D==="rect"){var I=lc(M||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));C=",";var ke=ee(I.map(function(an){var zt=Hp(an).value;return zt}),4),Ve=ke[0],Ge=ke[1],Se=ke[2],Pe=ke[3],k=gv(Ve,Ge,Se,Pe);return{type:"rect",clipText:_,poses:k,top:Ve,right:Ge,bottom:Se,left:Pe,values:I,splitter:C}}}}}function KJ(n,e,t,r,i){var a=n[e],o=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(O){return O==="w"||O==="e"}),p=d.filter(function(O){return O==="n"||O==="s"}),m=h[0],b=p[0];u[e]=t;var _=ee(o5(n),2),w=_[0],S=_[1],T=w&&S?w/S:0;if(T&&i){var A=(e+4)%8,D=n[A].pos,P=[0,0];o.indexOf("w")>-1?P[0]=-1:o.indexOf("e")>-1&&(P[0]=1),o.indexOf("n")>-1?P[1]=-1:o.indexOf("s")>-1&&(P[1]=1);var M=Zj([w,S],t,T,P,!0),V=w+M[0],C=S+M[1],I=D[1],k=D[1],z=D[0],L=D[0];P[0]===-1?z=L-V:P[0]===1?L=z+V:(z=z-V/2,L=L+V/2),P[1]===-1?I=k-C:(P[1]===1||(I=k-C/2),k=I+C);var B=gv(I,L,k,z);n.forEach(function(O,J){u[J][0]=B[J].pos[0]-O.pos[0],u[J][1]=B[J].pos[1]-O.pos[1]})}else n.forEach(function(O,J){var K=O.direction;K&&(K.indexOf(m)>-1&&(u[J][0]=t[0]),K.indexOf(b)>-1&&(u[J][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else o&&!c?d.forEach(function(O){var J=O==="n"||O==="s";n.forEach(function(K,H){var Z=K.direction,ne=K.horizontal,ue=K.vertical;!Z||Z.indexOf(O)===-1||(u[H]=[J||!ne?0:t[0],!J||!ue?0:t[1]])})}):u[e]=t;return u}function XJ(n,e){var t=ee(dj(n,e),2),r=t[0],i=t[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(A){return A.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=UJ.indexOf(c),_=FJ.indexOf(c),w=h.length;if(qJ(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var S=OS(n,o,m),T="".concat(d,"(").concat(S.join(p),")");je(n,"onClip",gt(n,e,Q({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},qr({clipPath:T},e))))}function WJ(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(GJ(c,d,i,8,h),h===c.length))return}else return;var p=OS(n,r,d),m="".concat(o,"(").concat(p.join(u),")");je(n,"onClip",gt(n,e,Q({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},qr({clipPath:m},e))))}var QJ={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,o=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,S=u.pos1,T=u.pos2,A=u.pos3,D=u.pos4,P=u.clipPathState,M=u.snapBoundInfos,V=u.rotation;if(!d||c)return[];var C=Ok(d,h,p,i||"inset",P||r);if(!C)return[];var I=b?4:3,k=C.type,z=C.poses,L=z.map(function(Ge){var Ue=_n(m,Ge.pos,I);return[Ue[0]-_,Ue[1]-w]}),B=[],O=[],J=k==="rect",K=k==="inset",H=k==="polygon";if(J||K||H){var Z=K?L.slice(0,8):L;O=Z.map(function(Ge,Ue){var we=Ue===0?Z[Z.length-1]:Z[Ue-1],Oe=Ln(we,Ge),ke=Gj(we,Ge);return e.createElement("div",{key:"clipLine".concat(Ue),className:He("line","clip-line","snap-control"),"data-clip-index":Ue,style:{width:"".concat(ke,"px"),transform:"translate(".concat(we[0],"px, ").concat(we[1],"px) rotate(").concat(Oe,"rad) scaleY(").concat(o,")")}})})}if(B=L.map(function(Ge,Ue){return e.createElement("div",{key:"clipControl".concat(Ue),className:He("control","clip-control","snap-control"),"data-clip-index":Ue,style:{transform:"translate(".concat(Ge[0],"px, ").concat(Ge[1],"px) rotate(").concat(V,"rad) scale(").concat(o,")")}})}),K&&B.push.apply(B,Ce([],ee(L.slice(8).map(function(Ge,Ue){return e.createElement("div",{key:"clipRadiusControl".concat(Ue),className:He("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Ue,style:{transform:"translate(".concat(Ge[0],"px, ").concat(Ge[1],"px) rotate(").concat(V,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var ne=C.left,ue=C.top,Y=C.radiusX,G=C.radiusY,$=ee(Ke(_n(m,[ne,ue],I),_n(m,[0,0],I)),2),re=$[0],W=$[1],oe="none";if(!a){for(var he=Math.max(10,Y/5,G/5),ye=[],Te=0;Te<=he;++Te){var Me=Math.PI*2/he*Te;ye.push([Y+(Y-o)*Math.cos(Me),G+(G-o)*Math.sin(Me)])}ye.push([Y,-2]),ye.push([-2,-2]),ye.push([-2,G*2+2]),ye.push([Y*2+2,G*2+2]),ye.push([Y*2+2,-2]),ye.push([Y,-2]),oe="polygon(".concat(ye.map(function(Ge){return"".concat(Ge[0],"px ").concat(Ge[1],"px")}).join(", "),")")}B.push(e.createElement("div",{key:"clipEllipse",className:He("clip-ellipse","snap-control"),style:{width:"".concat(Y*2,"px"),height:"".concat(G*2,"px"),clipPath:oe,transform:"translate(".concat(-_+re,"px, ").concat(-w+W,"px) ").concat(hy(m))}}))}if(a){var We=qi(Ce([S,T,A,D],ee(L),!1)),de=We.width,Se=We.height,Be=We.left,Pe=We.top;if(H||J||K){var ye=K?L.slice(0,8):L;B.push(e.createElement("div",{key:"clipArea",className:He("clip-area","snap-control"),style:{width:"".concat(de,"px"),height:"".concat(Se,"px"),transform:"translate(".concat(Be,"px, ").concat(Pe,"px)"),clipPath:"polygon(".concat(ye.map(function(Ue){return"".concat(Ue[0]-Be,"px ").concat(Ue[1]-Pe,"px")}).join(", "),")")}}))}}return M&&["vertical","horizontal"].forEach(function(Ge){var Ue=M[Ge],we=Ge==="horizontal";Ue.isSnap&&O.push.apply(O,Ce([],ee(Ue.snap.posInfos.map(function(Oe,ke){var Ve=Oe.pos,et=Ke(_n(m,we?[0,Ve]:[Ve,0],I),[_,w]),Tt=Ke(_n(m,we?[h,Ve]:[Ve,p],I),[_,w]);return fp(e,"",et,Tt,o,"clip".concat(Ge,"snap").concat(ke),"guideline")})),!1)),Ue.isBound&&O.push.apply(O,Ce([],ee(Ue.bounds.map(function(Oe,ke){var Ve=Oe.pos,et=Ke(_n(m,we?[0,Ve]:[Ve,0],I),[_,w]),Tt=Ke(_n(m,we?[h,Ve]:[Ve,p],I),[_,w]);return fp(e,"",et,Tt,o,"clip".concat(Ge,"bounds").concat(ke),"guideline","bounds","bold")})),!1))}),Ce(Ce([],ee(B),!1),ee(O),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,Q(Q({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,o=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=Ok(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,S=je(n,"onClipStart",gt(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,Bc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=Pc(n.props,"clippable"),w=_.keepRatio,S=0,T=0,A=o.draggable,D=os(e);c&&A?(t=ee(A.prevBeforeDist,2),S=t[0],T=t[1]):(r=ee(D,2),S=r[0],T=r[1]);var P=[S,T],M=n.state,V=M.width,C=M.height,I=!p&&!d&&!h,k=b.type,z=b.poses,L=b.splitter,B=z.map(function(tt){return tt.pos});I&&(S=-S,T=-T);var O=!d||z[m].direction==="nesw",J=k==="inset"||k==="rect",K=z.map(function(){return[0,0]});if(d&&!O){var H=z[m],Z=H.horizontal,ne=H.vertical,ue=[S*_e(Z),T*_e(ne)];K=KJ(z,m,ue,J,w)}else O&&(K=B.map(function(){return[S,T]}));var Y=B.map(function(tt,Pt){return Ot(tt,K[Pt])}),G=Ce([],ee(Y),!1);M.snapBoundInfos=null;var $=b.type==="circle",re=b.type==="ellipse";if($||re){var W=qi(Y),oe=_e(W.bottom-W.top),he=_e(re?W.right-W.left:oe),ye=Y[0][1]+oe,Te=Y[0][0]-he,Me=Y[0][0]+he;$&&(G.push([Me,W.bottom]),K.push([1,0])),G.push([W.left,ye]),K.push([0,1]),G.push([Te,W.bottom]),K.push([1,0])}var We=Vj((_.clipHorizontalGuidelines||[]).map(function(tt){return nn("".concat(tt),C)}),(_.clipVerticalGuidelines||[]).map(function(tt){return nn("".concat(tt),V)}),V,C),de=[],Se=[];if($||re)de=[G[4][0],G[2][0]],Se=[G[1][1],G[3][1]];else if(J){var Be=[G[0],G[2],G[4],G[6]],Pe=[K[0],K[2],K[4],K[6]];de=Be.filter(function(tt,Pt){return Pe[Pt][0]}).map(function(tt){return tt[0]}),Se=Be.filter(function(tt,Pt){return Pe[Pt][1]}).map(function(tt){return tt[1]})}else de=G.filter(function(tt,Pt){return K[Pt][0]}).map(function(tt){return tt[0]}),Se=G.filter(function(tt,Pt){return K[Pt][1]}).map(function(tt){return tt[1]});var Ge=[0,0],Ue=bk(We,_.clipTargetBounds&&{left:0,top:0,right:V,bottom:C},de,Se,5,5),we=Ue.horizontal,Oe=Ue.vertical,ke=we.offset,Ve=Oe.offset;if(we.isBound&&(Ge[1]+=ke),Oe.isBound&&(Ge[0]+=Ve),(re||$)&&K[0][0]===0&&K[0][1]===0){var W=qi(Y),et=W.bottom-W.top,Tt=re?W.right-W.left:et,Qe=Oe.isBound?_e(Ve):Oe.snapIndex===0?-Ve:Ve,ct=we.isBound?_e(ke):we.snapIndex===0?-ke:ke;Tt-=Qe,et-=ct,$&&(et=Rj(Oe,we)>0?et:Tt,Tt=et);var Mt=G[0];G[1][1]=Mt[1]-et,G[2][0]=Mt[0]+Tt,G[3][1]=Mt[1]+et,G[4][0]=Mt[0]-Tt}else if(J&&w&&d){var an=ee(o5(z),2),zt=an[0],yn=an[1],Tr=zt&&yn?zt/yn:0,_i=z[m],Xi=_i.direction||"",_a=G[1][1],ye=G[5][1],Te=G[7][0],Me=G[3][0];_e(ke)<=_e(Ve)?ke=Ur(ke)*_e(Ve)/Tr:Ve=Ur(Ve)*_e(ke)*Tr,Xi.indexOf("w")>-1?Te-=Ve:Xi.indexOf("e")>-1?Me-=Ve:(Te+=Ve/2,Me-=Ve/2),Xi.indexOf("n")>-1?_a-=ke:Xi.indexOf("s")>-1?ye-=ke:(_a+=ke/2,ye-=ke/2);var Or=gv(_a,Me,ye,Te);G.forEach(function(Gt,_t){var ft;ft=ee(Or[_t].pos,2),Gt[0]=ft[0],Gt[1]=ft[1]})}else G.forEach(function(tt,Pt){var Dt=K[Pt];Dt[0]&&(tt[0]-=Ve),Dt[1]&&(tt[1]-=ke)});var Tn=OS(n,b,Y),ur="".concat(k,"(").concat(Tn.join(L),")");if(M.clipPathState=ur,$||re)de=[G[4][0],G[2][0]],Se=[G[1][1],G[3][1]];else if(J){var Be=[G[0],G[2],G[4],G[6]];de=Be.map(function(Pt){return Pt[0]}),Se=Be.map(function(Pt){return Pt[1]})}else de=G.map(function(tt){return tt[0]}),Se=G.map(function(tt){return tt[1]});if(M.snapBoundInfos=bk(We,_.clipTargetBounds&&{left:0,top:0,right:V,bottom:C},de,Se,1,1),A){var Ne=M.is3d,wt=M.allMatrix,An=Ne?4:3,ut=Ge;c&&(ut=[P[0]+Ge[0]-D[0],P[1]+Ge[1]-D[1]]),A.deltaOffset=rn(wt,[ut[0],ut[1],0,0],An)}return je(n,"onClip",gt(n,e,Q({clipEventType:"changed",clipType:k,poses:Y,clipStyle:ur,clipStyles:Tn,distX:S,distY:T},qr((i={},i[k==="rect"?"clip":"clipPath"]=ur,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(je(n,"onClipEnd",xi(n,e,{})),i&&(c?WJ(n,e):a&&XJ(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},ZJ={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":ar(e.inputEvent.target,He("origin"))},dragControlStart:function(n,e){var t=e.datas;Bc(n,e);var r=gt(n,e,{dragStart:Br.dragStart(n,new Ad().dragStart([0,0],e))}),i=je(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=ee(os(e),2),o=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,S=b?4:3,T=[o,c];if(i){var A=e.distOrigin;(A[0]||A[1])&&(T=A)}var D=Ot(t.startOrigin,T),P=Ot(t.startTargetOrigin,T),M=Ke(T,t.prevOrigin),V=eg(p,m,D,S),C=n.getRect(),I=qi(Uc(V,d,h,S)),k=[C.left-I.left,C.top-I.top];t.prevOrigin=T;var z=[ua(P[0],d,w),ua(P[1],h,w)].join(" "),L=Br.drag(n,Jp(e,n.state,k,!!r)),B=gt(n,e,Q(Q({width:d,height:h,origin:D,dist:T,delta:M,transformOrigin:z,drag:L},qr({transformOrigin:z,transform:L.transform},e)),{afterTransform:L.transform}));return je(n,"onDragOrigin",B),B},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(je(n,"onDragOriginEnd",xi(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function JJ(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!n[o].virtual)){var c=n[o];eee(n,o),o<4?c.pos[0]=t:c.pos[1]=r}}function eee(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function tee(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function jk(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=cl(n),s5(a,e,t,0,0,r,i)}function Vk(n,e,t,r,i){var a=n.state,o=a.width,c=a.height,u=PS(i,n.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=HJ(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var S=gt(n,e,Q({horizontals:b,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:t},qr({borderRadius:w},e)));return je(n,"onRound",S),S}function zk(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],o=n.getTargets()[0];o&&(a?.props.target===o?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=RS(o).borderRadius,r.borderRadius=i))}return i}var nee={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?He("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,o=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,S=p.zoom,T=p.roundPadding,A=T===void 0?0:T,D=p.isDisplayShadowRoundControls,P=p.groupable;if(!r)return null;var M=h||zk(n),V=c?4:3,C=jk(M,i,a,b,!0);if(!C)return null;var I=0,k=0,z=P?[0,0]:[u,d];return C.map(function(L,B){var O=L.horizontal,J=L.vertical,K=L.direction||"",H=Ce([],ee(L.pos),!1);k+=Math.abs(O),I+=Math.abs(J),O&&K.indexOf("n")>-1&&(H[1]-=A),J&&K.indexOf("w")>-1&&(H[0]-=A),O&&K.indexOf("s")>-1&&(H[1]+=A),J&&K.indexOf("e")>-1&&(H[0]+=A);var Z=Ke(_n(o,H,V),z),ne=D&&D!=="horizontal",ue=L.vertical?I<=w[1]&&(ne||!L.virtual):k<=w[0]&&(D||!L.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(B),className:He("control","border-radius",L.vertical?"vertical":"",L.virtual?"virtual":""),"data-radius-index":B,style:{display:ue?"block":"none",transform:"translate(".concat(Z[0],"px, ").concat(Z[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=gt(n,e,{}),m=je(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Bc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,S=w===void 0?[0,0]:w,T=n.state,A=T.width,D=T.height;r.isRound=!0,r.prevDist=[0,0];var P=zk(n),M=jk(P||"",A,D,S,!0)||[];return r.controlPoses=M,T.borderRadiusState=PS(M,_,A,D).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=ee(os(e),2),o=a[0],c=a[1],u=[o,c],d=Ke(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],S=w.vertical,T=w.horizontal,A=r.map(function(P){var M=P.horizontal,V=P.vertical,C=[M*T*u[0],V*S*u[1]];if(M){if(p[0]===1)return C;if(p[0]<4&&M!==T)return C}else{if(p[1]===0)return C[1]=V*T*u[0]/b*_,C;if(S){if(p[1]===1)return C;if(p[1]<4&&V!==S)return C}}return[0,0]});A[i]=u;var D=r.map(function(P,M){return Q(Q({},P),{pos:Ot(P.pos,A[M])})});return i<4?D.slice(0,i+1).forEach(function(P){P.virtual=!1}):D.slice(4,i+1).forEach(function(P){P.virtual=!1}),t.prevDist=[o,c],Vk(n,e,u,d,D)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var A=T.virtual;return A}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))tee(d,o);else if(c&&(m===!0||m==="line")){var b=ee(dj(n,e),2),_=b[0],w=b[1];JJ(d,u,_,w)}h!==d.filter(function(T){var A=T.virtual;return A}).length&&Vk(n,e,[0,0],[0,0],d)}var S=xi(n,e,{});return je(n,"onRoundEnd",S),t.borderRadiusState="",S},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=pa(n,"roundable",e),o=Q({targets:n.props.targets,events:a.map(function(c,u){return Q(Q({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return je(n,"onRoundGroupStart",o),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=pa(n,"roundable",e),o=Q({targets:n.props.targets,events:a.map(function(c,u){return Q(Q(Q({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),qr({borderRadius:t.borderRadius},c))})},t);return je(n,"onRoundGroup",o),o},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=pa(n,"roundable",e);py(n,"onRound",function(c){var u=Q({targets:n.props.targets,events:i.map(function(d,h){return Q(Q(Q({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),qr({borderRadius:c.borderRadius},d))})},c);je(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var o=Q({targets:n.props.targets,events:i.map(function(c,u){var d;return Q(Q({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return je(n,"onRoundGroupEnd",o),o},unset:function(n){n.state.borderRadiusState=""}};function ree(n,e){var t=e?4:3,r=un(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var l5={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(Z3(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=ree(c,r)?[]:cl(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return gt(n,e,{setTransform:function(t){e.datas.startTransforms=er(t)?t:cl(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return gt(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),je(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),je(n,"onBeforeRender",gt(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),je(n,"onBeforeRenderEnd",gt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.setTransform(u,o),t.resetStyle(o),t.fillDragStartParams(u,o)});je(n,"onBeforeRenderGroupStart",gt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.resetStyle(o),t.fillDragParams(u,o)});je(n,"onBeforeRenderGroup",gt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),je(n,"onBeforeRenderGroupEnd",gt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},c5={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){je(n,"onRenderStart",gt(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){je(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){je(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){je(n,"onRenderGroupStart",gt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragParams(u,o)});je(n,"onRenderGroup",gt(n,e,Q(Q({isPinch:!!e.isPinch,targets:n.props.targets,transform:qm(e),transformObject:{}},qr(Hm(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=pa(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragEndParams(u,o)});je(n,"onRenderGroupEnd",gt(n,e,Q({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:qm(e)},qr(Hm(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return Td(lv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),gt(n,e,Q({isPinch:!!e.isPinch,transformObject:t,transform:qm(e)},qr(Hm(e))))},fillDragEndParams:function(n,e){var t={};return Td(lv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),gt(n,e,Q({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:qm(e)},qr(Hm(e))))}};function jh(n,e,t,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ce([],ee(e),!1);if(p){var _=a.requestAble;b.some(function(B){return B.name===_})||b.push.apply(b,Ce([],ee(n.props.ables.filter(function(B){return B.name===_})),!1))}if(!b.length||b.every(function(B){return B.dragRelation}))return!1;var w=a.inputEvent,S;u&&w&&(S=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,A=function(){var B;T=!0,(B=a.stop)===null||B===void 0||B.call(a)},D=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());D&&n.updateRect(i,!0,!1);var P=a.datas,M=m?"controlGesto":"targetGesto",V=n[M],C=function(B,O,J){if(!(O in B)||V!==n[M])return!1;var K=B.name,H=P[K]||(P[K]={});if(c&&(H.isEventStart=!J||!B[J]||B[J](n,a)),!H.isEventStart)return!1;var Z=B[O](n,Q(Q({},a),{stop:A,datas:H,originalDatas:P,inputTarget:S}));return n._emitter.off(),c&&Z===!1&&(H.isEventStart=!1),Z};D&&b.forEach(function(B){B.unset&&B.unset(n)}),C(l5,"drag".concat(r).concat(i));var I=0,k=0;t.forEach(function(B){if(T)return!1;var O="".concat(B).concat(r).concat(i),J="".concat(B).concat(r,"Condition");i===""&&!p&&AJ(n.state,a);var K=b.filter(function(ne){return ne[O]});K=K.filter(function(ne,ue){return ne.name&&K.indexOf(ne)===ue});var H=K.filter(function(ne){return C(ne,O,J)}),Z=H.length;T&&++I,Z&&++k,!T&&c&&K.length&&!Z&&(I+=K.filter(function(ne){var ue=ne.name,Y=P[ue];return Y.isEventStart?ne.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&C(c5,"drag".concat(r).concat(i));var z=V!==n[M]||I===t.length;if((u||T||z)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(B){B.state.gestos={}}),b.forEach(function(B){B.unset&&B.unset(n)})),c&&!z&&!p&&k&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||z)return!1;if(!c&&k&&!o||u){var L=n.props.flushSync||Bj;L(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&jh(n,e,t,r,i+"After",a),!0}function jS(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,o=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||ar(a,"moveable-area")||ar(a,"moveable-padding")||ar(a,"moveable-edgeDraggable")}}function u5(n,e,t){var r=n.controlBox,i=[],a=n.props,o=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=jS(n);return f5(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function d5(n,e){var t=n.controlBox,r=[];r.push(t);var i=jS(n,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===t)return!0;var u=i(o,c);return!u};return f5(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function f5(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",o=n.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,_=b===void 0?!0:b,w=o.preventRightClick,S=w===void 0?!0:w,T=o.preventWheelClick,A=T===void 0?!0:T,D=o.dragContainer,P=ts(D,!0),M={preventDefault:_,preventRightClick:S,preventWheelClick:A,container:P||tl(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(I){return n.controlBox.contains(I.target)},checkInput:a?p:!1,dragFocusedInput:m},V=new DQ(e,M),C=r==="Control";return["drag","pinch"].forEach(function(I){["Start","","End"].forEach(function(k){V.on("".concat(I).concat(k),function(z){var L,B=z.eventType,O=I==="drag"&&z.isPinch;if(i[B]&&!i[B](z)){z.stop();return}if(!O){var J=I==="drag"?[I]:["drag",I],K=Ce([],ee(n[t]),!1),H=jh(n,K,J,r,k,z);H?(n.props.stopPropagation||k==="Start"&&C)&&((L=z?.inputEvent)===null||L===void 0||L.stopPropagation()):z.stop()}})})}),V}var iee=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function aee(n,e,t,r){var i;t===void 0&&(t=e);var a=vj(n,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=bZ(p,t),w=_.matrixes,S=_.is3d,T=_.offsetContainer,A=_.zoom,D=r,P=4,M=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,V=u,C=un(P),I=un(P),k=un(P),z=un(P),L=o.length,B=w.map(function(ue){return Q(Q({},ue),{matrix:ue.matrix?Ce([],ee(ue.matrix),!1):void 0})}).reverse();o.reverse(),!c&&D&&(V=ba(V,3,4),Q_(o)),!S&&D&&Q_(B),B.forEach(function(ue){I=rn(I,ue.matrix,P)});var O=t||vl(n),J=((i=B[0])===null||i===void 0?void 0:i.target)||hp(O,O,!0).offsetParent,K=B.slice(1).reduce(function(ue,Y){return rn(ue,Y.matrix,P)},un(P));o.forEach(function(ue,Y){if(L-2===Y&&(k=C.slice()),L-1===Y&&(z=C.slice()),!ue.matrix){var G=o[Y+1],$=wJ(ue,G,J,P,rn(K,C,P));ue.matrix=Nc($,P)}C=rn(C,ue.matrix,P)});var H=!M&&c;V||(V=un(H?4:3));var Z=hy(M&&V.length===16?ba(V,4,3):V,H),ne=I;return I=W3(I,P,P),{hasZoom:b!==1||A!==1,hasFixed:m,matrixes:o,rootMatrix:I,originalRootMatrix:ne,beforeMatrix:k,offsetMatrix:z,allMatrix:C,targetMatrix:V,targetTransform:Z,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:D,offsetContainer:p,offsetRootContainer:T}}function see(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,o=0,c={},u=qj(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=aee(n,e,t,r),h=ad(d.allMatrix,d.transformOrigin,i,a);c=Q(Q({},d),h);var p=ad(d.allMatrix,[50,50],100,100);o=Hj([p.pos1,p.pos2],p.direction)}var m=4;return Q(Q(Q({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:un(m),rootMatrix:un(m),beforeMatrix:un(m),offsetMatrix:un(m),allMatrix:un(m),targetMatrix:un(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function tw(n,e,t,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=Ym(),d=Ym(),h=Ym(),p=Ym(),m=[0,0],b={},_=see(e,t,i,!0);if(e){var w=si(e);a.forEach(function(B){b[B]=w(B)});var S=_.is3d?4:3,T=ad(_.offsetMatrix,Ot(_.transformOrigin,Q3(_.targetMatrix,S)),_.width,_.height);o=T.direction,c=Ot(T.origin,[T.left-_.left,T.top-_.top]),p=Oh(_.offsetRootContainer);var A=hp(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var D=ad(rn(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),P=ad(_.originalRootMatrix,fv(si(A)("transformOrigin")).map(function(B){return parseFloat(B)}),A.offsetWidth,A.offsetHeight);if(u=f1(D,p),h=f1(P,p,A,!0),n){var M=D.left,V=D.top;d=f1({left:M,top:V,bottom:V,right:V},p)}}else{u=Oh(e),h=yZ(A),n&&(d=Oh(n));var C=h.left,I=h.top,k=h.clientLeft,z=h.clientTop,L=[u.left-C,u.top-I];m=Ke(Rd(_.rootMatrix,L,4),[k+_.left,z+_.top])}}return Q({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function Lk(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=Mc([e,t,r,i]),o=[a.minX,a.minY],c=Ke(n.origin,o);return e=Ke(e,o),t=Ke(t,o),r=Ke(r,o),i=Ke(i,o),Q(Q({},n),{left:n.left,top:n.top,posDelta:o,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var Dd=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=Q({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},tw(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new ay,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}_W(t._observerId),t._observerId=S3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,o=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=ee(i||[0,0],2),w=_[0],S=_[1],T=r.left,A=r.top,D=r.target,P=r.direction,M=r.hasFixed,V=r.offsetDelta,C=t.targets,I=this.isDragging(),k={};this.getEnabledAbles().forEach(function(K){k["data-able-".concat(K.name.toLowerCase())]=!0});var z=this._getAbleClassName(),L=C&&C.length&&(D||p)||o||!this._hasFirstTarget&&this.state.isPersisted,B=this.controlBox||this.props.firstRenderState||this.props.persistData,O=[T-w,A-S];!p&&t.useAccuratePosition&&(O[0]+=V[0],O[1]+=V[1]);var J={position:M?"fixed":"absolute",display:L?"block":"none",visibility:B?"visible":"hidden",transform:"translate3d(".concat(O[0],"px, ").concat(O[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(J["--moveable-line-padding"]=m),b&&(J["--moveable-control-padding"]=b),ha(h,Q({cspNonce:u,ref:Ps(this,"controlBox"),className:"".concat(He("control-box",P===-1?"reverse":"",I?"dragging":"")," ").concat(z," ").concat(a)},k,{onClick:this._onPreventClick,style:J}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Wu(this,!1),Wu(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return ai(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(vS)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&jS(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(Hd(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=Q({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,S=lk([a,o,u,c],d),T=SQ(S,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),A=tj(S);return!T||!A?0:Math.min(100,T/A*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?z_([t,r],lk([o,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Cd(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=tw(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=Lk(a.persistData);for(var _ in b)m[_]=b[_]}o&&Cd(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!t)return!0;var c=o.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=Yi(this.state),i=ee(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=qi(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,S=[t.left,t.top],T=Ot(S,t.origin),A=Ot(S,t.beforeOrigin),D=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:A,origin:T,transformOrigin:D,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&Z_(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&Z_(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return RJ(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=ai(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ce([],ee(c[b]),!1),S={request:function(T){return jh(a,w,["drag"],_,"",Q(Q({},p.request(T)),{requestAble:t,isRequest:!0}),m),S},requestEnd:function(){return jh(a,w,["drag"],_,"End",Q(Q({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),S}};return jh(a,w,["drag"],_,"Start",Q(Q({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,o=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,S=r.zoom||1;if(!i&&S<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=t5(i||{}),A=T.left,D=T.top,P=T.bottom,M=T.right,V=u?4:3,C=[];w?C=o:this.controlBox&&r.groupable?C=a:C=Ot(a,[b,_]);var I=sv(V,Nc(C.map(function(J){return-J}),V),c,Nc(o,V)),k=Oi(I,d,[-A,-D],V),z=Oi(I,h,[M,-D],V),L=Oi(I,p,[-A,P],V),B=Oi(I,m,[M,P],V);t.renderPoses=[k,z,L,B],t.renderLines=[[k,z],[z,B],[B,L],[L,k]];{var O=S/2;t.renderLines=[[Oi(I,d,[-A-O,-D],V),Oi(I,h,[M+O,-D],V)],[Oi(I,h,[M,-D-O],V),Oi(I,m,[M,P+O],V)],[Oi(I,m,[M+O,P],V),Oi(I,p,[-A-O,P],V)],[Oi(I,p,[-A,P+O],V),Oi(I,d,[-A,-D-O],V)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!J_(c,r),h=d||!J_(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=ij(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=Lk(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=Km(o,[c,u],a),p=Km(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:ha};return this.renderState={},TJ(Qj(Km(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(t,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],ee(r),!1),ee(c),!1)},Ce([],ee(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Wu(this,!1),this.updateState({gestos:{}})),r||Wu(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=u5(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=d5(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=ts(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:ha};return u.renderLines.map(function(h,p){return fp(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=$s(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=Km(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new iee(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=ts(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=ts(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ce(Ce([],ee(this._getAbleViewClassNames()),!1),[this.isDragging()?jJ:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=Wj(t.filter(Boolean),function(d){return d}).map(function(d){var h=ee(d,1),p=h[0];return p}),a=this._viewClassNames,o=$p(a,i),c=o.removed,u=o.added;c.forEach(function(d){R3(r,a[d])}),u.forEach(function(d){I3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat(He("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,o=tl(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,o=a.target,c=tl(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=UQ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Bj,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(j3),VS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Qu(n,"parentPosition",[o,c],function(_){return _.join(",")}),b=Qu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ce(Ce([],ee(i.map(function(_,w){return e.createElement(Dd,{key:"moveable"+w,ref:x3(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),ee(Qj(h.map(function(_,w){var S=_.pos1,T=_.pos2,A=_.pos3,D=_.pos4,P=[S,T,A,D];return[[0,1],[1,3],[3,2],[2,0]].map(function(M,V){var C=ee(M,2),I=C[0],k=C[1];return fp(e,"",Ke(P[I],m),Ke(P[k],m),d,"group-rect-".concat(w,"-").concat(V))})}))),!1)}},oee=Zp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),o=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||o)){var c=t.contains(i);je(n,"onClick",gt(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Hs(i,function(u){return u.contains(r)}),c=a>-1),je(n,"onClickGroup",gt(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Pu(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),Q(Q({},n),{datas:e})}var lee=Zp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?xj(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&ar(i,He("direction"))&&ar(i,He("edge"))&&ar(i,He("edgeDraggable"))},dragStart:function(n,e){return Br.dragStart(n,Pu(e))},drag:function(n,e){return Br.drag(n,Pu(e))},dragEnd:function(n,e){return Br.dragEnd(n,Pu(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&ar(i,He("direction"))&&ar(i,He("line"))},dragGroupStart:function(n,e){return Br.dragGroupStart(n,Pu(e))},dragGroup:function(n,e){return Br.dragGroup(n,Pu(e))},dragGroupEnd:function(n,e){return Br.dragGroupEnd(n,Pu(e))},unset:function(n){return Br.unset(n)}}),h5={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},zS=[l5,i5,fJ,kJ,Br,lee,K_,NJ,PJ,KZ,LJ,BJ,VJ,ZJ,QJ,nee,VS,h5,oee,r5,c5],cee=zS.reduce(function(n,e){return(e.events||[]).forEach(function(t){C3(n,t)}),n},[]),uee=zS.reduce(function(n,e){return(e.props||[]).forEach(function(t){C3(n,t)}),n},[]);function Bk(n,e){var t=ee(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Qm(n,e){var t=ee(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function Uk(n,e){return Math.max.apply(Math,Ce([],ee(n.map(function(t){var r=ee(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function Fk(n,e){return Math.min.apply(Math,Ce([],ee(n.map(function(t){var r=ee(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function dee(n,e){var t,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=ot(e,$r);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[q_,dk],S=[[0,0],[0,0]],T=[q_,dk],A=[[0,0],[0,0]];n.forEach(function(re){re.forEach(function(W){var oe=Bk([-b,1,0],W),he=Bk([-_,1,0],W);w[0]>oe&&(S[0]=W,w[0]=oe),w[1]<oe&&(S[1]=W,w[1]=oe),T[0]>he&&(A[0]=W,T[0]=he),T[1]<he&&(A[1]=W,T[1]=he)})});var D=ee(S,2),P=D[0],M=D[1],V=ee(A,2),C=V[0],I=V[1],k=[-b,1,Qm([-b,1],P)],z=[-b,1,Qm([-b,1],M)],L=[-_,1,Qm([-_,1],C)],B=[-_,1,Qm([-_,1],I)];t=ee([[k,L],[k,B],[z,L],[z,B]].map(function(re){var W=ee(re,2),oe=W[0],he=W[1];return gS(oe,he)[0]}),4),a=t[0],o=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var O=Fk(n,0),J=Fk(n,1),K=Uk(n,0),H=Uk(n,1);if(a=[O,J],o=[K,J],c=[O,H],u=[K,H],d=K-O,h=H-J,p%180){var Z=[c,a,u,o];r=ee(Z,4),a=r[0],o=r[1],c=r[2],u=r[3],d=H-J,h=K-O}}if(p%360>180){var Z=[u,c,o,a];i=ee(Z,4),a=i[0],o=i[1],c=i[2],u=i[3]}var ne=Mc([a,o,c,u]),ue=ne.minX,Y=ne.minY,G=ne.maxX,$=ne.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:ue,minY:Y,maxX:G,maxY:$,rotation:e}}function p5(n,e){var t=e.map(function(r){if(er(r)){var i=p5(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=ai(n,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&er(t[0])?t[0]:t}var fee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new ej,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Cd(!0),this.moveables.forEach(function(Te){Te.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(Te){return{finded:!1,manager:Te}}),p=this.props.targetGroups||[],m=p5(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ce([],ee(h.filter(function(Te){var Me=Te.finded;return!Me}).map(function(Te){var Me=Te.manager;return Me})),!1));var _=[],w=!r||t!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function A(Te,Me,We){var de=Te.map(function(Oe){if(er(Oe)){var ke=A(Oe,Me),Ve=[ke.pos1,ke.pos2,ke.pos3,ke.pos4];return _.push(ke),{poses:Ve,rotation:ke.rotation}}else return{poses:Yi(Oe.state),rotation:Oe.getRotation()}}),Se=de.map(function(Oe){var ke=Oe.rotation;return ke}),Be=0,Pe=Se[0],Ge=Se.every(function(Oe){return Math.abs(Pe-Oe)<.1});w?Be=!b&&Ge?Pe:S:Be=!b&&!We&&Ge?Pe:Me;var Ue=de.map(function(Oe){var ke=Oe.poses;return ke}),we=dee(Ue,Be);return we}var D=A(m,this.rotation,!0);w&&(this.rotation=D.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var P=this.transformOrigin,M=this.rotation,V=this.scale,C=D.width,I=D.height,k=D.minX,z=D.minY,L=DJ([[0,0],[C,0],[0,I],[C,I]],MS(P,C,I),this.rotation/180*Math.PI),B=Mc(L.result),O=B.minX,J=B.minY,K=" rotate(".concat(M,"deg)")+" scale(".concat(Ur(V[0]),", ").concat(Ur(V[1]),")"),H="translate(".concat(-O,"px, ").concat(-J,"px)").concat(K);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(z,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(P,";")+"width:".concat(C,"px;height:").concat(I,"px;")+"transform: ".concat(H),o.width=C,o.height=I;var Z=this.getContainer(),ne=tw(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||Z,[]),ue=[ne.left,ne.top],Y=ee(Yi(ne),4),G=Y[0],$=Y[1],re=Y[2],W=Y[3],oe=Mc([G,$,re,W]),he=[oe.minX,oe.minY],ye=Ur(V[0]*V[1]);ne.pos1=Ke(G,he),ne.pos2=Ke($,he),ne.pos3=Ke(re,he),ne.pos4=Ke(W,he),ne.left=k-ne.left+he[0],ne.top=z-ne.top+he[1],ne.origin=Ke(Ot(ue,ne.origin),he),ne.beforeOrigin=Ke(Ot(ue,ne.beforeOrigin),he),ne.originalBeforeOrigin=Ot(ue,ne.originalBeforeOrigin),ne.transformOrigin=Ke(Ot(ue,ne.transformOrigin),he),d.style.transform="translate(".concat(-O-he[0],"px, ").concat(-J-he[1],"px)")+K,Cd(),this.updateState(Q(Q({},ne),{posDelta:he,direction:ye,beforeDirection:ye}),i)},e.prototype.getRect=function(){return Q(Q({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],ee(r),!1),ee(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ce([],ee(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ce(Ce([],ee(this.props.ables),!1),[VS],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=ts(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Wu(this,!1),Wu(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=u5(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=d5(this,"GroupControl")));var m=!J_(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!e5(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=Q(Q({},Dd.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Dd),hee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),ha(o,{cspNonce:a,ref:Ps(this,"controlBox"),className:He("control-box")},u.map(function(m,b){var _,w,S=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return ha(Dd,Q({key:"moveable"+b,ref:x3(t,"moveables",b)},i,S,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Cd(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Cd()},e.prototype.getRect=function(){return Q(Q({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,Q(Q({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=ai(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ce([],ee(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Dd);function g5(n,e){var t=[];return n.forEach(function(r){if(r){if(ii(r)){e[r]&&t.push.apply(t,Ce([],ee(e[r]),!1));return}er(r)?t.push.apply(t,Ce([],ee(g5(r,e)),!1)):t.push(r)}}),t}function m5(n,e){var t=[];return n.forEach(function(r){if(r){if(ii(r)){e[r]&&t.push.apply(t,Ce([],ee(e[r]),!1));return}er(r)?t.push(m5(r,e)):t.push(r)}}),t}function v5(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?er(t)&&er(i)?v5(t,i):!0:!1})}var pee=(function(n){Qp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new ej,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){t[c]=!0})});var i=$s(t).join(`
`);this.defaultStyled=ij("div",cW(vS,ZQ+i))},e.getTotalAbles=function(){return Ce([i5,VS,h5,r5],ee(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=LQ(i,["ables","props"]),u=ee(this._updateRefs(!0),2),d=u[0],h=u[1],p=g5(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ce(Ce([],ee(b),!1),ee(a||[]),!1),w=Q(Q(Q({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,A=c.persistData;if(A?.children&&(m=!0),c.individualGroupable)return ha(hee,Q({key:"individual-group",ref:Ps(this,"moveable")},w,{target:null,targets:p}));if(m){var D=m5(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var P=T.props.target;P&&p.indexOf(P)>-1&&(S=Q({},T.state))}return ha(fee,Q({key:"group",ref:Ps(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:D,firstRenderState:S}))}else{var M=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var V=T.moveables||[],C=ai(V,function(I){return I.props.target===M});C&&(S=Q({},C.state))}return ha(Dd,Q({key:"single",ref:Ps(this,"moveable")},w,{target:M,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=NS(this.props.target||this.props.targets),a=typeof document<"u",o=v5(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(ii(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else er(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&o]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=ee(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,BQ([uW(uj)],e.prototype,"moveable",void 0),e})(j3),gee=(function(n){Qp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=zS,e})(pee),nw=function(n,e){return nw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},nw(n,e)};function LS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");nw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var pp=function(){return pp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},pp.apply(this,arguments)};function mee(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var vee=(function(n){LS(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return ha(gee,pp({ref:Ps(this,"moveable")},this.state))},e})(cS),yee=uee,bee=uj,xee=cee,_ee=(function(n){LS(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=pp({},i),c={};xee.forEach(function(h){c[xW("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=qd(r).createElement("div"),r.appendChild(u)),a.containerProvider=ak(ha(vee,pp({ref:Ps(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return er(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;ak(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=mee([WD(bee,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),WD(yee,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(ay),Gk=(function(n){LS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(_ee),cc=(n=>(n.Mouse="mouse",n.Touch="touch",n.Pointer="pointer",n))(cc||{}),ph=(n=>(n.CancelledByMovement="cancelled-by-movement",n.CancelledByRelease="cancelled-by-release",n.CancelledOutsideElement="cancelled-outside-element",n))(ph||{});const wee=["mousedown","mousemove","mouseup","mouseleave","mouseout"],Eee=["touchstart","touchmove","touchend","touchcancel"],See=["pointerdown","pointermove","pointerup","pointerleave","pointerout"];function Tee(n){return typeof n=="object"&&n!==null&&"pageX"in n&&typeof n.pageX=="number"&&"pageY"in n&&typeof n.pageY=="number"}function Aee(n){var e;return wee.includes((e=n?.nativeEvent)==null?void 0:e.type)}function y5(n){var e;return Eee.includes((e=n?.nativeEvent)==null?void 0:e.type)||"touches"in n}function Cee(n){const{nativeEvent:e}=n;return e?See.includes(e?.type)||"pointerId"in e:!1}function g1(n){return Aee(n)||y5(n)||Cee(n)}function qk(n){var e;const t=y5(n)?(e=n?.touches)==null?void 0:e[0]:n;return Tee(t)?{x:t.pageX,y:t.pageY}:null}function Iee(n){return{target:n.target,currentTarget:n.currentTarget,nativeEvent:n,persist:()=>{}}}function b5(n,{threshold:e=400,captureEvent:t=!1,detect:r=cc.Pointer,cancelOnMovement:i=!1,cancelOutsideElement:a=!0,filterEvents:o,onStart:c,onMove:u,onFinish:d,onCancel:h}={}){const p=U.useRef(!1),m=U.useRef(!1),b=U.useRef(),_=U.useRef(),w=U.useRef(n),S=U.useRef(null),T=U.useCallback(M=>V=>{m.current||g1(V)&&(o!==void 0&&!o(V)||(t&&V.persist(),c?.(V,{context:M}),S.current=qk(V),m.current=!0,b.current=V.currentTarget,_.current=setTimeout(()=>{w.current&&(w.current(V,{context:M}),p.current=!0)},e)))},[t,o,c,e]),A=U.useCallback(M=>(V,C)=>{g1(V)&&m.current&&(S.current=null,t&&V.persist(),p.current?d?.(V,{context:M}):m.current&&h?.(V,{context:M,reason:C??ph.CancelledByRelease}),p.current=!1,m.current=!1,_.current!==void 0&&clearTimeout(_.current))},[t,d,h]),D=U.useCallback(M=>V=>{if(g1(V)&&(u?.(V,{context:M}),i!==!1&&S.current)){const C=qk(V);if(C){const I=i===!0?25:i,k={x:Math.abs(C.x-S.current.x),y:Math.abs(C.y-S.current.y)};(k.x>I||k.y>I)&&A(M)(V,ph.CancelledByMovement)}}},[A,i,u]),P=U.useCallback(M=>{if(n===null)return{};switch(r){case cc.Mouse:{const V={onMouseDown:T(M),onMouseMove:D(M),onMouseUp:A(M)};return a&&(V.onMouseLeave=C=>{A(M)(C,ph.CancelledOutsideElement)}),V}case cc.Touch:return{onTouchStart:T(M),onTouchMove:D(M),onTouchEnd:A(M)};case cc.Pointer:{const V={onPointerDown:T(M),onPointerMove:D(M),onPointerUp:A(M)};return a&&(V.onPointerLeave=C=>A(M)(C,ph.CancelledOutsideElement)),V}}},[n,A,a,r,D,T]);return U.useEffect(()=>{function M(V){const C=Iee(V);A()(C)}return window.addEventListener("mouseup",M),window.addEventListener("touchend",M),window.addEventListener("pointerup",M),()=>{window.removeEventListener("mouseup",M),window.removeEventListener("touchend",M),window.removeEventListener("pointerup",M)}},[A]),U.useEffect(()=>()=>{_.current!==void 0&&clearTimeout(_.current)},[]),U.useEffect(()=>{w.current=n},[n]),P}const x5=()=>{if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.getElementById("ios-haptic-trigger");e&&e.click()}else typeof navigator<"u"&&navigator.vibrate&&navigator.vibrate(50)},mv=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,Wl=n=>mv(n).toISOString(),Ree=n=>{const e=mv(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},Dee=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},BS=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=Wl(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||Ree(r),description:e.description||"",merchant:e.merchant||void 0,type:Dee(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class uc{static instance;static getInstance(){return uc.instance||(uc.instance=new uc),uc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(t.allocations,t.incomeSources)},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=Ft(vt,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=vH(vt);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Vi(vt,"users",e,"envelopes"),a=(await Fa(t)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Vi(vt,"users",e,"transactions"),r=Fs(t,_d("date","desc")),a=(await Fa(r)).docs.map(o=>{const c={id:o.id,...o.data()};return BS(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Vi(vt,"users",e.userId,"envelopes"),r=Ft(t),i=yt.now(),a={...e,createdAt:i,lastUpdated:i};ca(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Wl(i),lastUpdated:Wl(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=Ft(vt,"users",e,"envelopes",t.id);ca(r,{...t,lastUpdated:yt.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{const r=Ft(vt,"users",e,"envelopes",t),i=Fs(Vi(vt,"users",e,"transactions"),fH("envelopeId","==",t)),o=(await Fa(i)).docs.map(c=>Ga(c.ref));await Promise.all([Ga(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=Ft(vt,"users",e,"envelopes",i.id);return ca(a,{orderIndex:i.orderIndex,lastUpdated:yt.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Vi(vt,"users",e.userId,"transactions"),r=Ft(t),i=yt.now();if(e.paymentMethod){const u={...e.paymentMethod};u.last4===void 0&&delete u.last4,e.paymentMethod=u}const o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};ca(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{if(console.log(" BudgetService.updateTransaction called for transaction:",t.id),t.paymentMethod){const a={...t.paymentMethod};a.last4===void 0&&delete a.last4,t.paymentMethod=a}const r=Object.fromEntries(Object.entries(t).filter(([a,o])=>o!==void 0)),i=Ft(vt,"users",e,"transactions",t.id);ca(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=Ft(vt,"users",e,"transactions",t);Ga(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=Ft(vt,"users",e.userId,"monthlyBudgets",e.month),r=yt.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};Ba(t,{incomeSources:mH(a),updatedAt:r}).catch(c=>{c.code==="not-found"?ca(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Wl(r),updatedAt:Wl(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=Ft(vt,"users",e,"monthlyBudgets",r);Vx(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:yt.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});Ba(a,{incomeSources:d,updatedAt:yt.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=Ft(vt,"users",e,"monthlyBudgets",r);Vx(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);Ba(i,{incomeSources:u,updatedAt:yt.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=Ft(vt,"users",e.userId,"monthlyBudgets",e.month),r=yt.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};Ba(t,i).catch(o=>{o.code==="not-found"?ca(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Wl(r),updatedAt:Wl(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=Ft(vt,"users",e,"monthlyBudgets",r),o={updatedAt:yt.now()};i.budgetedAmount!==void 0&&(o[`allocations.${t}`]=Number(i.budgetedAmount)),Ba(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=Ft(vt,"users",e,"monthlyBudgets",r);Ba(i,{[`allocations.${t}`]:jR(),updatedAt:yt.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=Ft(vt,"users",e,"monthlyBudgets",t),i=await Vx(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Vi(vt,"users",e,"envelopeAllocations"),o=await Fa(a),c=[],u=new Set;for(const b of o.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>Ga(Ft(vt,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Vi(vt,"users",e,"monthlyBudgets"),h=await Fa(d);for(const b of h.docs){const w=b.data().allocations||{},S={};let T=!1;Object.keys(w).forEach(A=>{i.has(A)||(S[`allocations.${A}`]=jR(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${A}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${A}`))}),T&&(S.updatedAt=yt.now(),await Ba(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>Ga(Ft(vt,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=Ft(vt,"users",e,"monthlyBudgets",t);return Lp(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,t){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),t&&Object.keys(t).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=t?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Vi(vt,"users",e,r),a=await Fa(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Ga(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const US=uc.getInstance(),m1=n=>Vi(vt,"users",n,"transactions"),kee={subscribeToTransactions:(n,e)=>{const t=Fs(m1(n),_d("date","desc"));return Lp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=Fs(m1(n),_d("date","desc")),r=(await Fa(e)).docs.map(i=>{const a={id:i.id,...i.data()};return BS(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await Wv(m1(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=Ft(vt,"users",n,"transactions",e);return await Ba(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=Ft(vt,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await Ga(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},v1=n=>Vi(vt,"users",n,"envelopes"),Nee={subscribeToEnvelopes:(n,e)=>{const t=Fs(v1(n),_d("orderIndex","asc"));return Lp(t,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=v1(n),i=(await Fa(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await Wv(v1(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=Ft(vt,"users",n,"envelopes",e.id);return await ca(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=Ft(vt,"users",n,"envelopes",e);return await Ba(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=Ft(vt,"users",n,"envelopes",e);await Ga(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},y1=n=>Vi(vt,"users",n,"distributionTemplates"),Mee={subscribeToDistributionTemplates:(n,e)=>{const t=Fs(y1(n),_d("lastUsed","desc"));return Lp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=Fs(y1(n),_d("lastUsed","desc"));return(await Fa(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await Wv(y1(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=Ft(vt,"users",n,"distributionTemplates",e.id);return await ca(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=Ft(vt,"users",n,"distributionTemplates",e);return await Ba(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=Ft(vt,"users",n,"distributionTemplates",e);await Ga(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},b1=n=>Vi(vt,"users",n,"appSettings"),_5={subscribeToAppSettings:(n,e)=>{const t=Fs(b1(n),MR(1));return Lp(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async n=>{const e=Fs(b1(n),MR(1)),t=await Fa(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await Wv(b1(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=Ft(vt,"users",n,"appSettings",e.id);return await ca(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=Ft(vt,"users",n,"appSettings",e);return await ca(r,t,{merge:!0})},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=Ft(vt,"users",n,"appSettings",e);await Ga(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},Hk=Object.freeze(Object.defineProperty({__proto__:null,AppSettingsService:_5},Symbol.toStringTag,{value:"Module"})),Pee=n=>BS(n),Oee=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig}),$k=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=Nee.subscribeToEnvelopes(e,u=>{console.log(" Real-time sync: Envelopes updated",u.length);const d=u.map(Oee),h=n.getState(),p=new Set(h.envelopes.map(_=>_.id)),m=new Set(d.map(_=>_.id)),b=[...d.filter(_=>p.has(_.id)),...h.envelopes.filter(_=>!m.has(_.id))];n.setState({envelopes:b})}),i=kee.subscribeToTransactions(e,u=>{console.log(" Real-time sync: Transactions updated",u.length);const d=u.map(Pee),h=n.getState(),p=new Set(h.transactions.map(_=>`${_.id}-${_.month}`)),m=new Set(d.map(_=>`${_.id}-${_.month}`)),b=[...d.filter(_=>p.has(`${_.id}-${_.month}`)),...h.transactions.filter(_=>!m.has(`${_.id}-${_.month}`))];n.setState({transactions:b})}),a=Mee.subscribeToDistributionTemplates(e,u=>{console.log(" Real-time sync: Templates updated from Firebase",u.length)}),o=_5.subscribeToAppSettings(e,u=>{console.log(" Real-time sync: Settings updated",u?"found":"null");const d=n.getState();if(u){const h={...d.appSettings,...u,paymentSources:u.paymentSources??d.appSettings?.paymentSources??[]};n.setState({appSettings:h})}else console.log(" Firebase settings null, preserving local state")}),c=US.subscribeToMonthlyBudget(e,t,u=>{console.log(` Real-time sync: Monthly budget updated (${u.incomeSources.length} sources, ${u.allocations.length} allocations)`);const d=n.getState();n.setState({incomeSources:{...d.incomeSources,[t]:u.incomeSources},allocations:{...d.allocations,[t]:u.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,templates:a,settings:o,monthlyBudget:c},console.log(" Real-time subscriptions active - cross-device sync enabled")},jee=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),$k(e,r())),t.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),$k(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=US.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},Vee=()=>fa.getState().currentUser?.id||"",Vn=uc.getInstance(),Wn=hw()(j9(wN((n,e)=>({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isOnboardingActive:!1,isOnboardingCompleted:typeof localStorage<"u"?localStorage.getItem("onboardingCompleted")==="true":!1,isLoading:!1,error:null,setIsOnboardingActive:t=>{n({isOnboardingActive:t})},completeOnboarding:()=>{n({isOnboardingCompleted:!0,isOnboardingActive:!1}),localStorage.setItem("onboardingCompleted","true")},resetOnboarding:()=>{n({isOnboardingCompleted:!1,isOnboardingActive:!0}),localStorage.removeItem("onboardingCompleted")},clearMonthData:async t=>{try{n({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${t}`);const i=(await tn(()=>Promise.resolve().then(()=>pn),[]).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await tn(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-8y0iLH-T.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,t),await e().init(),console.log(` Cleared month data for ${t}`),n({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async t=>{try{const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await Vn.getMonthData(i.id,t),o=e();n({incomeSources:{...o.incomeSources,[t]:a.incomeSources},allocations:{...o.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${t} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,o,c]=await Promise.all([Vn.getEnvelopes(i.id),Vn.getTransactions(i.id),Vn.getMonthData(i.id,t.currentMonth)]);n({envelopes:a,transactions:o,incomeSources:{...t.incomeSources,[t.currentMonth]:c.incomeSources},allocations:{...t.allocations,[t.currentMonth]:c.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.incomeSources.length} income sources, ${c.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},o=await Vn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Vn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(o=>o.id===t.id?t:o),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Vn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(o=>o.id!==t),transactions:a.transactions.filter(o=>o.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){n({isLoading:!1});return}const u=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await Vn.reorderEnvelopes(u.id,o),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:o},u=await Vn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:o};await Vn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Vn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(o=>o.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await Vn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===t),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await Vn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await Vn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",fontSize:t.fontSize??r.appSettings?.fontSize??"medium",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,paymentSources:t.paymentSources??r.appSettings?.paymentSources??[]};(t.userId||r.appSettings?.userId)&&(i.userId=t.userId??r.appSettings?.userId),i.paymentSources&&(i.paymentSources=i.paymentSources.map(c=>{const u={...c};return u.last4===void 0&&delete u.last4,u}));const o=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(o){const{AppSettingsService:c}=await tn(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Hk);return{AppSettingsService:u}},void 0);await c.updateAppSettings(o.id,i.id,i)}n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(i){const{AppSettingsService:o}=await tn(async()=>{const{AppSettingsService:u}=await Promise.resolve().then(()=>Hk);return{AppSettingsService:u}},void 0),c=await o.getAppSettings(i.id);if(c){n({appSettings:c}),console.log(" Loaded app settings from Firestore");return}}const a={id:"default",theme:"system",fontSize:"medium",enableMoveableReorder:!0,paymentSources:[]};i&&(a.userId=i.id),n({appSettings:a}),console.log(" Initialized default app settings")}catch(t){console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"})}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await Vn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const o=await Vn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Vn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Vn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,o]=t.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`,h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...S}=_;await e().addIncomeSource(t,S)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>{const w=e().envelopes.find(S=>S.id===_.envelopeId);return!!w&&!w.isPiggybank});if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,S=_.piggybankConfig?.paused??!1;if(!S&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${S}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===t);if(!c){console.error(` setEnvelopeAllocation: Envelope ${t} not found in store! Aborting.`),n({isLoading:!1});return}const u=!!c.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await Vn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,o=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await Vn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await tn(()=>Promise.resolve().then(()=>pn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await Vn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],incomeSources:{},allocations:{},isLoading:!1,error:null})}}),{name:"budget-storage"})));jee({useBudgetStore:Wn,useAuthStore:fa,getCurrentUserId:Vee});var Zu=9e15,yl=1e9,rw="0123456789abcdef",vv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",yv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",iw={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Zu,maxE:Zu,crypto:!1},w5,ks,it=!0,gy="[DecimalError] ",fl=gy+"Invalid argument: ",E5=gy+"Precision limit exceeded",S5=gy+"crypto unavailable",T5="[object Decimal]",Pr=Math.floor,ir=Math.pow,zee=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Lee=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Bee=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,A5=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ga=1e7,Je=7,Uee=9007199254740991,Fee=vv.length-1,aw=yv.length-1,Ee={toStringTag:T5};Ee.absoluteValue=Ee.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),$e(n)};Ee.ceil=function(){return $e(new this.constructor(this),this.e+1,2)};Ee.clampedTo=Ee.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(fl+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};Ee.comparedTo=Ee.cmp=function(n){var e,t,r,i,a=this,o=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};Ee.cosine=Ee.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Je,r.rounding=1,t=Gee(r,k5(r,t)),r.precision=n,r.rounding=e,$e(ks==2||ks==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};Ee.cubeRoot=Ee.cbrt=function(){var n,e,t,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(it=!1,a=h.s*ir(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=Sr(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=ir(t,1/3),n=Pr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),o=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=on(d.plus(h).times(c),d.plus(u),o+2,1),Sr(c.d).slice(0,o)===(t=Sr(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&($e(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&($e(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return it=!0,$e(r,n,p.rounding,e)};Ee.decimalPlaces=Ee.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-Pr(this.e/Je))*Je,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};Ee.dividedBy=Ee.div=function(n){return on(this,new this.constructor(n))};Ee.dividedToIntegerBy=Ee.divToInt=function(n){var e=this,t=e.constructor;return $e(on(e,new t(n),0,1,1),t.precision,t.rounding)};Ee.equals=Ee.eq=function(n){return this.cmp(n)===0};Ee.floor=function(){return $e(new this.constructor(this),this.e+1,3)};Ee.greaterThan=Ee.gt=function(n){return this.cmp(n)>0};Ee.greaterThanOrEqualTo=Ee.gte=function(n){var e=this.cmp(n);return e==1||e===0};Ee.hyperbolicCosine=Ee.cosh=function(){var n,e,t,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/vy(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=kd(o,1,a.times(e),new o(1),!0);for(var u,d=n,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return $e(a,o.precision=t,o.rounding=r,!0)};Ee.hyperbolicSine=Ee.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=kd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/vy(5,n)),i=kd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);n--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=t,$e(i,e,t,!0)};Ee.hyperbolicTangent=Ee.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,on(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};Ee.inverseCosine=Ee.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?Ya(e,r,i):new e(0):new e(NaN):n.isZero()?Ya(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};Ee.inverseHyperbolicCosine=Ee.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,it=!1,t=t.times(t).minus(1).sqrt().plus(t),it=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};Ee.inverseHyperbolicSine=Ee.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,it=!1,t=t.times(t).plus(1).sqrt().plus(t),it=!0,r.precision=n,r.rounding=e,t.ln())};Ee.inverseHyperbolicTangent=Ee.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?$e(new a(i),n,e,!0):(a.precision=t=r-i.e,i=on(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};Ee.inverseSine=Ee.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=Ya(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};Ee.inverseTangent=Ee.atan=function(){var n,e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=aw)return o=Ya(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=aw)return o=Ya(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/Je+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(it=!1,e=Math.ceil(c/Je),r=1,u=d.times(d),o=new h(d),i=d;n!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(n=e;o.d[n]===a.d[n]&&n--;);return t&&(o=o.times(2<<t-1)),it=!0,$e(o,h.precision=p,h.rounding=m,!0)};Ee.isFinite=function(){return!!this.d};Ee.isInteger=Ee.isInt=function(){return!!this.d&&Pr(this.e/Je)>this.d.length-2};Ee.isNaN=function(){return!this.s};Ee.isNegative=Ee.isNeg=function(){return this.s<0};Ee.isPositive=Ee.isPos=function(){return this.s>0};Ee.isZero=function(){return!!this.d&&this.d[0]===0};Ee.lessThan=Ee.lt=function(n){return this.cmp(n)<0};Ee.lessThanOrEqualTo=Ee.lte=function(n){return this.cmp(n)<1};Ee.logarithm=Ee.log=function(n){var e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(it=!1,c=p+b,o=Ko(d,c),r=e?bv(h,c+10):Ko(n,c),u=on(o,r,c,1),gp(u.d,i=p,m))do if(c+=10,o=Ko(d,c),r=e?bv(h,c+10):Ko(n,c),u=on(o,r,c,1),!a){+Sr(u.d).slice(i+1,i+15)+1==1e14&&(u=$e(u,p+1,0));break}while(gp(u.d,i+=10,m));return it=!0,$e(u,p,m)};Ee.minus=Ee.sub=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return it?$e(n,c,u):n}if(t=Pr(n.e/Je),h=Pr(b.e/Je),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,t=h,o=d.length),r=Math.max(Math.ceil(c/Je),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=ga-1;--d[i],d[r]+=ga}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=my(d,t),it?$e(n,c,u):n):new _(u===3?-0:0)};Ee.modulo=Ee.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?$e(new r(t),r.precision,r.rounding):(it=!1,r.modulo==9?(e=on(t,n.abs(),0,3,1),e.s*=n.s):e=on(t,n,0,r.modulo,1),e=e.times(n),it=!0,t.minus(e))};Ee.naturalExponential=Ee.exp=function(){return sw(this)};Ee.naturalLogarithm=Ee.ln=function(){return Ko(this)};Ee.negated=Ee.neg=function(){var n=new this.constructor(this);return n.s=-n.s,$e(n)};Ee.plus=Ee.add=function(n){var e,t,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),it?$e(n,c,u):n;if(a=Pr(p.e/Je),r=Pr(n.e/Je),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,o=h.length):(t=h,r=a,o=d.length),a=Math.ceil(c/Je),o=a>o?a+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/ga|0,d[i]%=ga;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return n.d=d,n.e=my(d,r),it?$e(n,c,u):n};Ee.precision=Ee.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(fl+n);return t.d?(e=C5(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};Ee.round=function(){var n=this,e=n.constructor;return $e(new e(n),n.e+1,e.rounding)};Ee.sine=Ee.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Je,r.rounding=1,t=Hee(r,k5(r,t)),r.precision=n,r.rounding=e,$e(ks>2?t.neg():t,n,e,!0)):new r(NaN)};Ee.squareRoot=Ee.sqrt=function(){var n,e,t,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(it=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=Sr(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=Pr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(on(o,a,t+2,1)).times(.5),Sr(a.d).slice(0,t)===(e=Sr(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&($e(a,u+1,0),a.times(a).eq(o))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&($e(r,u+1,1),n=!r.times(r).eq(o));break}return it=!0,$e(r,u,h.rounding,n)};Ee.tangent=Ee.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=on(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,$e(ks==2||ks==4?t.neg():t,n,e,!0)):new r(NaN)};Ee.times=Ee.mul=function(n){var e,t,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=Pr(h.e/Je)+Pr(n.e/Je),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%ga|0,e=c/ga|0;a[i]=(a[i]+e)%ga|0}for(;!a[--o];)a.pop();return e?++t:a.shift(),n.d=a,n.e=my(a,t),it?$e(n,p.precision,p.rounding):n};Ee.toBinary=function(n,e){return FS(this,2,n,e)};Ee.toDecimalPlaces=Ee.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(oi(n,0,yl),e===void 0?e=r.rounding:oi(e,0,8),$e(t,n+t.e+1,e))};Ee.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=is(r,!0):(oi(n,0,yl),e===void 0?e=i.rounding:oi(e,0,8),r=$e(new i(r),n+1,e),t=is(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};Ee.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=is(i):(oi(n,0,yl),e===void 0?e=a.rounding:oi(e,0,8),r=$e(new a(i),n+i.e+1,e),t=is(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};Ee.toFraction=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=C5(_)-b.e-1,o=a%Je,e.d[0]=ir(10,o<0?Je+o:o),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(fl+c);n=c.gt(e)?a>0?e:d:c}for(it=!1,c=new w(Sr(_)),h=w.precision,w.precision=a=_.length*Je*2;p=on(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=on(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=on(d,r,a,1).minus(b).abs().cmp(on(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,it=!0,m};Ee.toHexadecimal=Ee.toHex=function(n,e){return FS(this,16,n,e)};Ee.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:oi(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(it=!1,t=on(t,n,0,e,1).times(n),it=!0,$e(t)):(n.s=t.s,t=n),t};Ee.toNumber=function(){return+this};Ee.toOctal=function(n,e){return FS(this,8,n,e)};Ee.toPower=Ee.pow=function(n){var e,t,r,i,a,o,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u(ir(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return $e(c,r,a);if(e=Pr(n.e/Je),e>=n.d.length-1&&(t=d<0?-d:d)<=Uee)return i=I5(u,c,t,r),n.s<0?new u(1).div(i):$e(i,r,a);if(o=c.s,o<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return t=ir(+c,d),e=t==0||!isFinite(t)?Pr(d*(Math.log("0."+Sr(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(it=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=sw(n.times(Ko(c,r+t)),r),i.d&&(i=$e(i,r+5,1),gp(i.d,r,a)&&(e=r+10,i=$e(sw(n.times(Ko(c,e+t)),e),e+5,1),+Sr(i.d).slice(r+1,r+15)+1==1e14&&(i=$e(i,r+1,0)))),i.s=o,it=!0,u.rounding=a,$e(i,r,a))};Ee.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=is(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(oi(n,1,yl),e===void 0?e=i.rounding:oi(e,0,8),r=$e(new i(r),n,e),t=is(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};Ee.toSignificantDigits=Ee.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(oi(n,1,yl),e===void 0?e=r.rounding:oi(e,0,8)),$e(new r(t),n,e)};Ee.toString=function(){var n=this,e=n.constructor,t=is(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};Ee.truncated=Ee.trunc=function(){return $e(new this.constructor(this),this.e+1,1)};Ee.valueOf=Ee.toJSON=function(){var n=this,e=n.constructor,t=is(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function Sr(n){var e,t,r,i=n.length-1,a="",o=n[0];if(i>0){for(a+=o,e=1;e<i;e++)r=n[e]+"",t=Je-r.length,t&&(a+=Lo(t)),a+=r;o=n[e],r=o+"",t=Je-r.length,t&&(a+=Lo(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function oi(n,e,t){if(n!==~~n||n<e||n>t)throw Error(fl+n)}function gp(n,e,t,r){var i,a,o,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=Je,i=0):(i=Math.ceil((e+1)/Je),e%=Je),a=ir(10,Je-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):o=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==ir(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||t<4)&&c==9999||!r&&t>3&&c==4999):o=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==ir(10,e-3)-1,o}function w0(n,e,t){for(var r,i=[0],a,o=0,c=n.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=rw.indexOf(n.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function Gee(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/vy(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=kd(n,1,e.times(i),new n(1));for(var a=t;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=t,e}var on=(function(){function n(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,_,w,S,T,A,D,P,M,V,C,I,k,z,L,B,O=r.constructor,J=r.s==i.s?1:-1,K=r.d,H=i.d;if(!K||!K[0]||!H||!H[0])return new O(!r.s||!i.s||(K?H&&K[0]==H[0]:!H)?NaN:K&&K[0]==0||!H?J*0:J/0);for(u?(b=1,h=r.e-i.e):(u=ga,b=Je,h=Pr(r.e/b)-Pr(i.e/b)),L=H.length,k=K.length,T=new O(J),A=T.d=[],p=0;H[p]==(K[p]||0);p++);if(H[p]>(K[p]||0)&&h--,a==null?(V=a=O.precision,o=O.rounding):c?V=a+(r.e-i.e)+1:V=a,V<0)A.push(1),_=!0;else{if(V=V/b+2|0,p=0,L==1){for(m=0,H=H[0],V++;(p<k||m)&&V--;p++)C=m*u+(K[p]||0),A[p]=C/H|0,m=C%H|0;_=m||p<k}else{for(m=u/(H[0]+1)|0,m>1&&(H=n(H,m,u),K=n(K,m,u),L=H.length,k=K.length),I=L,D=K.slice(0,L),P=D.length;P<L;)D[P++]=0;B=H.slice(),B.unshift(0),z=H[0],H[1]>=u/2&&++z;do m=0,d=e(H,D,L,P),d<0?(M=D[0],L!=P&&(M=M*u+(D[1]||0)),m=M/z|0,m>1?(m>=u&&(m=u-1),w=n(H,m,u),S=w.length,P=D.length,d=e(w,D,S,P),d==1&&(m--,t(w,L<S?B:H,S,u))):(m==0&&(d=m=1),w=H.slice()),S=w.length,S<P&&w.unshift(0),t(D,w,P,u),d==-1&&(P=D.length,d=e(H,D,L,P),d<1&&(m++,t(D,L<P?B:H,P,u))),P=D.length):d===0&&(m++,D=[0]),A[p++]=m,d&&D[0]?D[P++]=K[I]||0:(D=[K[I]],P=1);while((I++<k||D[0]!==void 0)&&V--);_=D[0]!==void 0}A[0]||A.shift()}if(b==1)T.e=h,w5=_;else{for(p=1,m=A[0];m>=10;m/=10)p++;T.e=p+h*b-1,$e(T,c?a+T.e+1:a,o,_)}return T}})();function $e(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Je,o=e,h=p[m=0],u=h/ir(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/Je),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Je,o=a-Je+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Je,o=a-Je+i,u=o<0?0:h/ir(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%ir(10,i-o-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?o>0?h/ir(10,i-o):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=ir(10,(Je-e%Je)%Je),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=ir(10,Je-a),p[m]=o>0?(h/ir(10,i-o)%ir(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(n.e++,p[0]==ga&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=ga)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return it&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function is(n,e,t){if(!n.isFinite())return D5(n);var r,i=n.e,a=Sr(n.d),o=a.length;return e?(t&&(r=t-o)>0?a=a.charAt(0)+"."+a.slice(1)+Lo(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+Lo(-i-1)+a,t&&(r=t-o)>0&&(a+=Lo(r))):i>=o?(a+=Lo(i+1-o),t&&(r=t-i-1)>0&&(a=a+"."+Lo(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(a+="."),a+=Lo(r))),a}function my(n,e){var t=n[0];for(e*=Je;t>=10;t/=10)e++;return e}function bv(n,e,t){if(e>Fee)throw it=!0,t&&(n.precision=t),Error(E5);return $e(new n(vv),e,1,!0)}function Ya(n,e,t){if(e>aw)throw Error(E5);return $e(new n(yv),e,t,!0)}function C5(n){var e=n.length-1,t=e*Je+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Lo(n){for(var e="";n--;)e+="0";return e}function I5(n,e,t,r){var i,a=new n(1),o=Math.ceil(r/Je+4);for(it=!1;;){if(t%2&&(a=a.times(e),Kk(a.d,o)&&(i=!0)),t=Pr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),Kk(e.d,o)}return it=!0,a}function Yk(n){return n.d[n.d.length-1]&1}function R5(n,e,t){for(var r,i,a=new n(e[0]),o=0;++o<e.length;){if(i=new n(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function sw(n,e){var t,r,i,a,o,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(it=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log(ir(2,p))/Math.LN10*2+5|0,u+=r,t=a=o=new m(1),m.precision=u;;){if(a=$e(a.times(n),u,1),t=t.times(++h),c=o.plus(on(a,t,u,1)),Sr(c.d).slice(0,u)===Sr(o.d).slice(0,u)){for(i=p;i--;)o=$e(o.times(o),u,1);if(e==null)if(d<3&&gp(o.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return $e(o,m.precision=_,b,it=!0);else return m.precision=_,o}o=c}}function Ko(n,e){var t,r,i,a,o,c,u,d,h,p,m,b=1,_=10,w=n,S=w.d,T=w.constructor,A=T.rounding,D=T.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(e==null?(it=!1,h=D):h=e,T.precision=h+=_,t=Sr(S),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=Sr(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=bv(T,h+2,D).times(a+""),w=Ko(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=D,e==null?$e(w,D,A,it=!0):w;for(p=w,u=o=w=on(w.minus(1),w.plus(1),h,1),m=$e(w.times(w),h,1),i=3;;){if(o=$e(o.times(m),h,1),d=u.plus(on(o,new T(i),h,1)),Sr(d.d).slice(0,h)===Sr(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(bv(T,h+2,D).times(a+""))),u=on(u,new T(b),h,1),e==null)if(gp(u.d,h-_,A,c))T.precision=h+=_,d=o=w=on(p.minus(1),p.plus(1),h,1),m=$e(w.times(w),h,1),i=c=1;else return $e(u,T.precision=D,A,it=!0);else return T.precision=D,u;u=d,i+=2}}function D5(n){return String(n.s*n.s/0)}function E0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Je,t<0&&(r+=Je),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Je;r<i;)n.d.push(+e.slice(r,r+=Je));e=e.slice(r),r=Je-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),it&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function qee(n,e){var t,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),A5.test(e))return E0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(Lee.test(e))t=16,e=e.toLowerCase();else if(zee.test(e))t=2;else if(Bee.test(e))t=8;else throw Error(fl+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=n.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=I5(r,new r(t),a,a*2)),d=w0(e,t,ga),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=my(d,h),n.d=d,it=!1,o&&(n=on(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?ir(2,u):Nd.pow(2,u))),it=!0,n)}function Hee(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:kd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/vy(5,t)),e=kd(n,2,e,e);for(var i,a=new n(5),o=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function kd(n,e,t,r,i){var a,o,c,u,d=n.precision,h=Math.ceil(d/Je);for(it=!1,u=t.times(t),c=new n(r);;){if(o=on(c.times(u),new n(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=on(o.times(u),new n(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return it=!0,o.d.length=h+1,o}function vy(n,e){for(var t=n;--e;)t*=n;return t}function k5(n,e){var t,r=e.s<0,i=Ya(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return ks=r?4:1,e;if(t=e.divToInt(i),t.isZero())ks=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return ks=Yk(t)?r?2:3:r?4:1,e;ks=Yk(t)?r?1:4:r?3:2}return e.minus(i).abs()}function FS(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?(oi(t,1,yl),r===void 0?r=b.rounding:oi(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=D5(n);else{for(h=is(n),o=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=w0(is(m),10,i),m.e=m.d.length),p=w0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(n=new b(n),n.d=p,n.e=a,n=on(n,m,t,r,0,i),p=n.d,a=n.e,d=w5),o=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(n.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=rw.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=w0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=rw.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function Kk(n,e){if(n.length>e)return n.length=e,!0}function $ee(n){return new this(n).abs()}function Yee(n){return new this(n).acos()}function Kee(n){return new this(n).acosh()}function Xee(n,e){return new this(n).plus(e)}function Wee(n){return new this(n).asin()}function Qee(n){return new this(n).asinh()}function Zee(n){return new this(n).atan()}function Jee(n){return new this(n).atanh()}function ete(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=Ya(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?Ya(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=Ya(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(on(n,e,a,1)),e=Ya(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(on(n,e,a,1)),t}function tte(n){return new this(n).cbrt()}function nte(n){return $e(n=new this(n),n.e+1,2)}function rte(n,e,t){return new this(n).clamp(e,t)}function ite(n){if(!n||typeof n!="object")throw Error(gy+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,yl,"rounding",0,8,"toExpNeg",-Zu,0,"toExpPos",0,Zu,"maxE",0,Zu,"minE",-Zu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=iw[t]),(r=n[t])!==void 0)if(Pr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(fl+t+": "+r);if(t="crypto",i&&(this[t]=iw[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(S5);else this[t]=!1;else throw Error(fl+t+": "+r);return this}function ate(n){return new this(n).cos()}function ste(n){return new this(n).cosh()}function N5(n){var e,t,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,Xk(a)){d.s=a.s,it?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;it?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return E0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),A5.test(a)?E0(d,a):qee(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,E0(d,a.toString());throw Error(fl+a)}if(i.prototype=Ee,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=ite,i.clone=N5,i.isDecimal=Xk,i.abs=$ee,i.acos=Yee,i.acosh=Kee,i.add=Xee,i.asin=Wee,i.asinh=Qee,i.atan=Zee,i.atanh=Jee,i.atan2=ete,i.cbrt=tte,i.ceil=nte,i.clamp=rte,i.cos=ate,i.cosh=ste,i.div=ote,i.exp=lte,i.floor=cte,i.hypot=ute,i.ln=dte,i.log=fte,i.log10=pte,i.log2=hte,i.max=gte,i.min=mte,i.mod=vte,i.mul=yte,i.pow=bte,i.random=xte,i.round=_te,i.sign=wte,i.sin=Ete,i.sinh=Ste,i.sqrt=Tte,i.sub=Ate,i.sum=Cte,i.tan=Ite,i.tanh=Rte,i.trunc=Dte,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function ote(n,e){return new this(n).div(e)}function lte(n){return new this(n).exp()}function cte(n){return $e(n=new this(n),n.e+1,3)}function ute(){var n,e,t=new this(0);for(it=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return it=!0,new this(1/0);t=e}return it=!0,t.sqrt()}function Xk(n){return n instanceof Nd||n&&n.toStringTag===T5||!1}function dte(n){return new this(n).ln()}function fte(n,e){return new this(n).log(e)}function hte(n){return new this(n).log(2)}function pte(n){return new this(n).log(10)}function gte(){return R5(this,arguments,-1)}function mte(){return R5(this,arguments,1)}function vte(n,e){return new this(n).mod(e)}function yte(n,e){return new this(n).mul(e)}function bte(n,e){return new this(n).pow(e)}function xte(n){var e,t,r,i,a=0,o=new this(1),c=[];if(n===void 0?n=this.precision:oi(n,1,yl),r=Math.ceil(n/Je),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(S5);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=Je,r&&n&&(i=ir(10,Je-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=Je)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Je&&(t-=Je-r)}return o.e=t,o.d=c,o}function _te(n){return $e(n=new this(n),n.e+1,this.rounding)}function wte(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function Ete(n){return new this(n).sin()}function Ste(n){return new this(n).sinh()}function Tte(n){return new this(n).sqrt()}function Ate(n,e){return new this(n).sub(e)}function Cte(){var n=0,e=arguments,t=new this(e[n]);for(it=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return it=!0,$e(t,this.precision,this.rounding)}function Ite(n){return new this(n).tan()}function Rte(n){return new this(n).tanh()}function Dte(n){return $e(n=new this(n),n.e+1,1)}Ee[Symbol.for("nodejs.util.inspect.custom")]=Ee.toString;Ee[Symbol.toStringTag]="Decimal";var Nd=Ee.constructor=N5(iw);vv=new Nd(vv);yv=new Nd(yv);const Wk=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},kte=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=Wn(),{currentUser:o}=fa(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=Wn(),{showToast:_}=Lc(),[w,S]=U.useState(!1),T=U.useRef(null),[A,D]=U.useState(!1),P=!A||r||b,[M,V]=U.useState([]),C=U.useRef([]),[I,k]=U.useState([]),z=U.useRef([]),L=U.useCallback(re=>{if(n.find(he=>he.id===re)?.isPiggybank){const he=Wn.getState().getEnvelopeBalance(re);return new Nd(he)}const oe=Wn.getState().getEnvelopeBalance(re,c);return new Nd(oe)},[n,c]);U.useEffect(()=>{const re=n.filter(W=>{if(!W.isPiggybank||!W.isActive)return!1;if(W.createdAt)try{const oe=Wk(W.createdAt);if(!oe)return console.error(` Invalid creation date for piggybank ${W.name}:`,W.createdAt),!1;const he=`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`;return c>=he}catch(oe){return console.error(` Error processing piggybank ${W.name}:`,oe,{createdAt:W.createdAt,typeofCreatedAt:typeof W.createdAt}),!1}return!0}).sort((W,oe)=>{const he=W.orderIndex??0,ye=oe.orderIndex??0;return he-ye});k(re),z.current=re},[n,c]);const B=I,O=M;U.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),t(),D(!0),()=>{T.current&&clearTimeout(T.current)}),[]),U.useEffect(()=>{A&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[A,r,b]),U.useEffect(()=>{const re=n.filter(W=>{if(W.isPiggybank||W.isActive===!1)return!1;const he=(d[c]||[]).some(Te=>Te.envelopeId===W.id),ye=e.some(Te=>Te.envelopeId===W.id&&(Te.month===c||Te.date.startsWith(c)));return he||ye}).sort((W,oe)=>{const he=W.orderIndex??0,ye=oe.orderIndex??0;return he-ye});V(re),C.current=re},[n,d,c,e]);const J=(u[c]||[]).reduce((re,W)=>re+W.amount,0),K=(d[c]||[]).filter(re=>O.some(W=>W.id===re.envelopeId)||B.some(W=>W.id===re.envelopeId)).reduce((re,W)=>re+W.budgetedAmount,0),H=J-K,Z=U.useCallback(async re=>{if(!re.length)return;const W=re.map(oe=>oe.id);try{await a(W)}catch(oe){console.error("Failed to persist envelope order:",oe),_("Failed to save envelope order","error")}},[a,_]),ne=U.useCallback(async re=>{await Z(re)},[Z]),ue=U.useCallback(re=>{h(c,re.id).catch(console.error),_(`Deleted "${re.name}"`,"neutral")},[h,c,_]),Y=U.useCallback(async re=>{try{const W=re||c;console.log(" Copying to month:",W),await m(W),_("Previous month budget copied","success")}catch(W){console.error("Error copying previous month:",W),_("Failed to copy previous month","error")}},[m,_,c]),G=U.useCallback(async()=>{if(!o||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await Wn.getState().clearMonthData(c),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(re){console.error("Error clearing month data:",re),_("Failed to clear month data","error")}},[o,c,_]),$=U.useCallback(async(re,W)=>{try{await p(re,W),setTimeout(()=>{const oe=Wn.getState(),he=oe.currentMonth,ye=oe.incomeSources[he]||[],Te=oe.allocations[he]||[],Me=new Set(oe.envelopes.filter(Be=>{if(Be.isPiggybank){if(!Be.isActive)return!1;if(Be.createdAt){const Pe=Wk(Be.createdAt);if(!Pe)return!1;const Ge=`${Pe.getFullYear()}-${String(Pe.getMonth()+1).padStart(2,"0")}`;return he>=Ge}return!0}return Be.isActive!==!1}).map(Be=>Be.id)),We=Te.filter(Be=>Me.has(Be.envelopeId)),de=ye.reduce((Be,Pe)=>Be+Pe.amount,0),Se=We.reduce((Be,Pe)=>Be+Pe.budgetedAmount,0);de-Se<-.005?_(`You can't spend more than you make.
You're not in Congress!`,"error"):Math.abs(de-Se)<.005&&de>0&&_("Every dollar has a job ","success")},100)}catch(oe){console.error("Failed to set allocation:",oe),_("Failed to update budget","error")}},[p,_]);return{visibleEnvelopes:O,piggybanks:B,incomeSources:u,availableToBudget:H,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:P,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:L,fetchData:t,reorderEnvelopes:ne,deleteIncomeSource:ue,clearMonthData:G,copyFromPreviousMonth:Y,setEnvelopeAllocation:$,localOrderRef:C,setLocalEnvelopes:V,localPiggybankOrderRef:z,setLocalPiggybanks:k}},Nte=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(_)<.005,A=_<-.005,D=w>0?S/w*100:0;let P="text-gray-900 dark:text-white",M="bg-green-500",V="Left to Budget",C=w>0?Math.min(D,100):0,I=!0;return w===0?(V="Add income to start budgeting",C=0,I=!1,P="text-gray-500 dark:text-zinc-500"):T?(P="text-green-600 dark:text-emerald-400",M="bg-green-500",V="Perfect! Every dollar has a job ",C=100,I=!1):A&&(P="text-red-600 dark:text-red-400",M="bg-red-500",V="You're not in Congress! Try again.",C=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${P}`,children:V}),I&&v.jsxs("span",{className:`text-sm font-bold truncate ${P}`,children:[A?"-":"","$",Math.abs(_).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${M}`,style:{width:`${C}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(TL,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(As,{size:20})})]}),t&&v.jsx("div",{className:"px-1",children:h()})]})},yy=({children:n,onDelete:e,threshold:t=-100,disabled:r=!1})=>{const i=aW(),[a,o]=U.useState(!1),c=U.useRef(0),u=()=>{r||(o(!0),c.current=Date.now())},d=async(h,p)=>{if(r)return;const m=p.offset.x,b=p.velocity.x;if(setTimeout(()=>o(!1),100),m<t||m<-50&&b<-500){const _=e();_===!1?i.start({x:0}):_ instanceof Promise&&_.then(w=>{w===!1&&i.start({x:0})})}else i.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(C1,{className:"text-white w-6 h-6"})}),v.jsx(Nn.div,{drag:r?!1:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:u,onDragEnd:d,animate:i,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${a?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:a?"none":"auto"},children:n})]})},Mte=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=Wn(),{showToast:c}=Lc(),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(!1);U.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Nn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(Nn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const S=w.target.value.replace(/\D/g,"");if(!S){p("");return}const A=(parseInt(S,10)/100).toFixed(2);p(A)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},Pte=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),o=i(n);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(vL,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(Lh,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},Ote="/personal-budget-pwa/icon-512.png",x1="/personal-budget-pwa/images/budget-balanced.png",jte=({currentMonth:n,onComplete:e})=>{const[t,r]=U.useState(0),[i,a]=U.useState(0),[o,c]=U.useState(2500);U.useEffect(()=>{if(console.log("Animation effect triggered:",{currentStep:t,animationKey:i}),t===3){console.log("Starting animation from $2500 to $0"),c(2500);const T=2e3,A=20,D=T/A,P=2500/A;let M=0;const V=setInterval(()=>{M++;const C=Math.max(0,2500-P*M);console.log("Phase 1 - Animation step:",M,"New amount:",C),c(C),M>=A&&(clearInterval(V),console.log("Phase 1 completed - Perfect budget reached"),setTimeout(()=>{console.log("Starting Phase 2 - Over budget demonstration");let I=0;const k=10,z=200,L=500/k,B=setInterval(()=>{I++;const O=-(L*I);console.log("Phase 2 - Over budget step:",I,"Over budget amount:",O),c(O),I>=k&&(clearInterval(B),console.log("Animation completed - Over budget scenario demonstrated"))},z)},1e3))},D);return()=>{console.log("Cleaning up animation timers"),clearInterval(V)}}},[i,t]);const d=(T=>{const[A,D]=T.split("-");return new Date(parseInt(A),parseInt(D)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(n),h=[{icon:Lh,title:"Welcome to Dollars At Work!",description:`Let's set up your budget for ${d}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Dollars At Work helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:I2,title:"Step 1: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Cs,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Cs,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Cs,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(gh,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:wv,title:"Step 2: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are categories for your expenses. Common examples:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Cs,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," - Food and household items"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Cs,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," - Housing costs"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Cs,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Transportation"})," - Gas, car payment, transit"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Cs,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Entertainment"})," - Fun money"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Scroll down to "Spending Envelopes"'}),' and tap "Create New Envelope" to add your categories.']})})]}),color:"purple"},{icon:T0,title:"Step 3: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4 relative",children:[v.jsx("button",{onClick:()=>a(T=>T+1),className:"absolute top-2 right-2 p-1.5 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800 rounded-lg transition-colors",title:"Replay animation",children:v.jsx(c9,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Left to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200 mb-3",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-xs text-blue-700 dark:text-blue-300 font-medium",children:[v.jsx("span",{children:"Left to Budget"}),v.jsxs("span",{className:`font-bold ${o<0?"text-red-600 dark:text-red-400":""}`,children:["$",o.toFixed(2)]})]}),v.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 overflow-hidden",children:v.jsx(Nn.div,{className:`h-full rounded-full ${o<0?"bg-red-500":"bg-green-500"}`,initial:{width:"0%"},animate:{width:o<0?"100%":`${(2500-o)/2500*100}%`},transition:{duration:.3,ease:"easeInOut"}})}),v.jsxs(Nn.div,{className:`text-xs font-medium text-center mt-1 ${o===0?"text-green-600 dark:text-emerald-400":o<0?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"}`,initial:{opacity:0},animate:{opacity:1},transition:{delay:2,duration:.5},children:[o===0&&"Perfect! Every dollar has a job ",o<0&&"You're not in Congress! Try again.",o>0&&"Keep allocating until you reach $0"]})]},i)]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:yc,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(m9,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(I2,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(T0,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:x1,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of Dollars At Work:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Create spending envelopes"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Allocate until Left to Budget = $0"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Track spending and adjust as needed"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green",useCustomIcon:!0}],p=h[t],m=p.useCustomIcon?x1:p.icon,b=t===h.length-1,_=t===0,S={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[p.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(ri,{mode:"wait",children:v.jsxs(Nn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 pb-2",children:v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:p.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:p.description})]}),v.jsx("div",{className:"flex flex-col items-center mx-4",children:t===0?v.jsx("img",{src:Ote,alt:"Dollars At Work",className:`w-20 h-20 ${S.text}`}):p.useCustomIcon?v.jsx("img",{src:x1,alt:"Budget Balanced",className:`w-32 h-32 ${S.text}`}):v.jsx("div",{className:`${S.bg} p-3 rounded-xl`,children:v.jsx(m,{className:`w-8 h-8 ${S.text}`})})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400 whitespace-nowrap",children:["Step ",t+1," of ",h.length]})]})}),v.jsx("div",{className:"px-6 pb-6 pt-2",children:p.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:h.map((T,A)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A===t?`w-8 ${S.button}`:A<t?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},A))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!_&&v.jsxs("button",{onClick:()=>r(T=>T-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(sd,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{b?e():r(T=>T+1)},className:`${_?"flex-1":"flex-[2]"} py-3 px-4 ${S.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2`,children:b?v.jsxs(v.Fragment,{children:[v.jsx(Lh,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(gL,{className:"w-5 h-5"})]})})]})]},t)})})})},Vte=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onLongPressTrigger:c})=>{const u=b5(k=>{x5(),c(k,n.id)},{threshold:500,cancelOnMovement:25,detect:cc.Touch}),d=n.piggybankConfig?.targetAmount,h=n.piggybankConfig?.monthlyContribution??0,p=n.piggybankConfig?.color||"#3B82F6",m=n.piggybankConfig?.paused||!1,b=typeof e=="number"?e:e.toNumber(),_=(k,z=1)=>{const L=k.replace("#",""),B=parseInt(L,16),O=B>>16&255,J=B>>8&255,K=B&255;return`rgba(${O}, ${J}, ${K}, ${z})`},w=`linear-gradient(135deg, ${_(p,.14)} 0%, ${_(p,.05)} 100%)`,S=_(p,.4),T=U.useRef(null),[A,D]=U.useState(!1),P=d&&d>0?Math.min(b/d*100,100):0,M=d&&b>=d;U.useEffect(()=>{a&&a!==n.id&&D(!1)},[a,n.id]),U.useEffect(()=>{a===n.id&&(D(!0),o&&o(n.id))},[a,n.id,o]),U.useEffect(()=>{if(!a&&A){const k=setTimeout(()=>{D(!1)},300);return()=>clearTimeout(k)}},[a,A]);const V=k=>{if(A||i){k.preventDefault(),k.stopPropagation();return}t(n.id)},C=a===n.id,I=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:k=>c(k,n.id),children:v.jsx(xN,{size:20})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center justify-between gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[v.jsx("div",{className:"w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center",style:{backgroundColor:`${p}20`},children:v.jsx(yc,{size:16,style:{color:p}})}),v.jsxs("div",{className:"min-w-0",children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx(T0,{size:10,style:{color:p}}),v.jsxs("span",{className:"text-[10px] text-gray-500 dark:text-zinc-400 font-medium",children:["$",h.toFixed(2),"/mo"]}),m&&v.jsxs("span",{className:"text-[10px] text-orange-600 dark:text-orange-400 font-bold ml-1 flex items-center gap-0.5",children:[v.jsx(i9,{size:8})," PAUSED"]})]})]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"text-sm font-bold text-gray-900 dark:text-white leading-none",children:["$",b.toFixed(2)]}),v.jsxs("div",{className:"text-[10px] text-gray-400 dark:text-zinc-500 mt-1",children:["of $",d?.toFixed(0)||"0"]})]})]}),d&&d>0&&v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800/50 rounded-full h-1 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${P}%`,backgroundColor:p}})}),M&&!d&&v.jsx("div",{className:"text-[10px] text-green-600 dark:text-green-400 font-bold mt-1",children:" GOAL REACHED"})]})]});return v.jsx(Nn.div,{...u(),layout:!C,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:k=>{r&&r(k),T.current=k},onClick:V,style:{background:w,borderColor:S,boxShadow:C?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",zIndex:C?50:1,scale:C?1.02:1},className:"rounded-xl py-2 px-3 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99] group",children:I})},nh=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},Qk=12,Zk=(n,e,t)=>Math.min(Math.max(n,e),t),zte=({env:n,budgetedAmount:e,remainingBalance:t,navigate:r,transactions:i,currentMonth:a,setMoveableRef:o,isReorderingActive:c,activelyDraggingId:u,onItemDragStart:d,onLongPressTrigger:h})=>{const p=!!n.isPiggybank,m=n.piggybankConfig?.color||"#3B82F6",b=p?`linear-gradient(135deg, ${nh(m,.18)} 0%, ${nh(m,.08)} 100%)`:void 0,_=p?nh(m,.5):void 0,w=U.useRef(null),[S,T]=U.useState(!1),A=b5(B=>{x5(),h(B,n.id)},{threshold:500,cancelOnMovement:25,detect:cc.Touch}),D=i.filter(B=>B.envelopeId===n.id&&B.month===a),P=D.filter(B=>B.type==="Expense"),M=D.filter(B=>B.type==="Income"),V=P.reduce((B,O)=>B+(O.amount||0),0),C=M.reduce((B,O)=>B+(O.amount||0),0),I=Math.max(0,V/C*100),k=B=>{if(S||c){B.preventDefault(),B.stopPropagation();return}r(`/envelope/${n.id}`)};U.useEffect(()=>{u&&u!==n.id&&T(!1)},[u,n.id]),U.useEffect(()=>{u===n.id&&(T(!0),d(n.id))},[u,n.id,d]),U.useEffect(()=>{if(!u&&S){const B=setTimeout(()=>{T(!1)},300);return()=>clearTimeout(B)}},[u,S]);const z=v.jsxs("div",{className:"flex items-center gap-3 w-full",children:[v.jsx("div",{className:"hidden md:flex items-center justify-center p-1 text-gray-400 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing transition-all duration-200",onMouseDown:B=>h(B,n.id),children:v.jsx(xN,{size:20})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[p&&v.jsx("span",{className:"w-6 h-6 rounded-full flex items-center justify-center border",style:{borderColor:nh(m,.4),backgroundColor:nh(m,.15),color:m},children:v.jsx(yc,{size:12})}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white leading-tight",children:n.name}),v.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"text-xs font-medium text-gray-700 dark:text-zinc-300",children:["$",e.toFixed(2)]})]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsxs("span",{className:`text-sm font-bold leading-none ${(typeof t=="number"?t:t.toNumber())<0||100-I<=5?"text-red-500":I>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]}),v.jsx("span",{className:"text-[10px] text-gray-400 dark:text-zinc-500 block uppercase tracking-wider mt-0.5",children:"Remaining"})]})]}),e>0&&v.jsx("div",{className:"mt-1.5",onClick:B=>B.stopPropagation(),children:v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700/50 rounded-full h-0.5 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-I<=5?"bg-red-500":I>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-I,2)}%`}})})})]})]}),L=u===n.id;return v.jsx(Nn.div,{...A(),layout:!L,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":n.id,ref:B=>{o(n.id)(B),w.current=B},onClick:k,style:{boxShadow:L?"0 18px 45px rgba(15,23,42,0.35)":"0 1px 2px rgba(15,23,42,0.08)",background:b,borderColor:_,cursor:L?"grabbing":"pointer",zIndex:L?50:1,scale:L?1.02:1},className:`py-2 px-3 rounded-xl active:scale-[0.99] transition-all select-none border group ${p?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:z})},Lte=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,reorderEnvelopes:p,deleteIncomeSource:m,copyFromPreviousMonth:b,localOrderRef:_,setLocalEnvelopes:w,localPiggybankOrderRef:S,setLocalPiggybanks:T}=kte(),{setMonth:A,setIsOnboardingActive:D,isOnboardingCompleted:P,completeOnboarding:M,isOnboardingActive:V}=Wn(),{showToast:C}=Lc(),I=Ys(),[k,z]=U.useState(!1),[L,B]=U.useState("add"),[O,J]=U.useState(null),[K,H]=U.useState(!1),[Z,ne]=U.useState(!1),[ue,Y]=U.useState(V),G=U.useRef(null),$=U.useRef(null),[re,W]=U.useState(0);U.useLayoutEffect(()=>{if(ue)return;const Ne=$.current;if(!Ne)return;const wt=()=>W(Ne.getBoundingClientRect().height);wt();const An=new ResizeObserver(()=>wt());return An.observe(Ne),window.addEventListener("resize",wt),()=>{window.removeEventListener("resize",wt),An.disconnect()}},[ue,i,t,a,n,e,r]),U.useEffect(()=>(D(ue),()=>D(!1)),[ue,D]),U.useEffect(()=>{if(!u&&!c){const Ne=setTimeout(()=>{if(ue)return;if(P){Y(!1);const ut=(t[i]||[]).length===0&&(a[i]||[]).length===0,tt=Object.keys(t).some(Pt=>(t[Pt]||[]).length>0)||Object.keys(a).some(Pt=>(a[Pt]||[]).length>0);ne(!!(ut&&tt));return}const wt=(t[i]||[]).length===0&&(a[i]||[]).length===0,An=Object.keys(t).some(ut=>(t[ut]||[]).length>0)||Object.keys(a).some(ut=>(a[ut]||[]).length>0);wt?An?(ne(!0),Y(!1)):(Y(!0),ne(!1)):(ne(!1),Y(!1))},500);return()=>clearTimeout(Ne)}},[u,c,i,t,a,P]);const oe=U.useCallback(Ne=>wt=>{wt?ye.current[Ne]=wt:delete ye.current[Ne]},[]),he=U.useCallback(Ne=>wt=>{wt?Se.current[Ne]=wt:delete Se.current[Ne]},[]),ye=U.useRef({}),Te=U.useRef({}),[Me,We]=U.useState(null),de=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),Se=U.useRef({}),Be=U.useRef({}),Pe=U.useRef(null),[Ge,Ue]=U.useState(null),we=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),[Oe,ke]=U.useState(!1),Ve=U.useRef(null),et=U.useRef(!1);U.useEffect(()=>{ke(!1),et.current=!1,We(null),Ue(null)},[]);const Tt=U.useRef(Oe);U.useEffect(()=>{Tt.current=Oe},[Oe]);const Qe=U.useCallback(()=>ke(!0),[]),ct=U.useCallback(()=>{ke(!1),et.current=!1,_.current.length&&p(_.current)},[p]),Mt=U.useCallback(Ne=>{},[]),an=U.useCallback(Ne=>{Tt.current||I(`/envelope/${Ne}`)},[I]),zt=U.useCallback((Ne,wt)=>{const An=Te.current[wt]||Be.current[wt];if(An){et.current=!0;const ut=Ne.nativeEvent||Ne;An.dragStart(ut)}},[]),yn=U.useCallback(()=>ke(!0),[]),Tr=U.useCallback(()=>{ke(!1),et.current=!1,S.current.length&&p(S.current)},[p]);U.useEffect(()=>{const Ne=()=>{Object.values(Be.current).forEach(ut=>ut?.destroy()),Be.current={}};if(ue){Ne();return}if(!e.length)return;const wt=()=>{e.forEach(ut=>{const tt=Se.current[ut.id];if(!tt)return;const Pt=Be.current[ut.id];if(Pt){Pt.target=tt;return}const Dt=new Gk(Pe.current,{target:tt,draggable:!0,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!1,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Dt.on("dragStart",_t=>{if(!et.current){_t.stop();return}const ft=_t.inputEvent.target;if(ft.closest(".js-budget-target")||ft.tagName==="INPUT"){C("Lock envelope order to edit budget","neutral"),_t.stop();return}const bn=S.current.findIndex(xn=>xn.id===ut.id),Xt=_t.target,bt=Xt.getBoundingClientRect().height+Qk;Ue(ut.id),we.current={activeId:ut.id,startIndex:bn,currentIndex:bn,itemHeight:bt},Xt&&(Xt.style.transition="none",Xt.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",Xt.style.zIndex="20"),yn()});let Gt=null;Dt.on("drag",_t=>{const ft=_t.target;Gt!==null&&cancelAnimationFrame(Gt),Gt=requestAnimationFrame(()=>{const bn=we.current;if(bn.activeId!==ut.id)return;const Xt=_t.beforeTranslate[1];ft.style.transform=`translateY(${Xt}px)`,ft.style.transition="none";const{itemHeight:Wt,startIndex:bt}=bn;if(!Wt)return;const xn=Math.round(Xt/Wt),Mn=Zk(bt+xn,0,S.current.length-1);Mn!==bn.currentIndex&&(bn.currentIndex=Mn,S.current.forEach((Wi,jr)=>{if(Wi.id===ut.id)return;const Vr=Se.current[Wi.id];if(!Vr)return;let tr=0;bt<Mn?jr>bt&&jr<=Mn&&(tr=-Wt):bt>Mn&&jr>=Mn&&jr<bt&&(tr=Wt),Vr.style.transform=tr?`translateY(${tr}px)`:"",Vr.style.transition="transform 0.2s ease"})),Gt=null})}),Dt.on("dragEnd",_t=>{Gt!==null&&(cancelAnimationFrame(Gt),Gt=null);const ft=_t.target,bn=we.current,{startIndex:Xt,currentIndex:Wt}=bn;if(ft.style.transform="",ft.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",ft.style.boxShadow="",S.current.forEach(bt=>{if(bt.id===ut.id)return;const xn=Se.current[bt.id];xn&&(xn.style.transform="",xn.style.transition="")}),Xt!==Wt){const bt=[...S.current],[xn]=bt.splice(Xt,1);bt.splice(Wt,0,xn),S.current=bt,T(bt)}setTimeout(()=>{ft.style.zIndex="",ft.style.transition="",Ue(null)},300),we.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},Tr()}),Dt.on("click",_t=>{const ft=_t.inputEvent.target;ft.closest(".js-budget-target")||ft.tagName==="INPUT"||ft.tagName==="BUTTON"||an(ut.id)}),Be.current[ut.id]=Dt})},An=window.setTimeout(wt,80);return()=>{clearTimeout(An),Ne()}},[e,yn,Tr,an,ue]),U.useEffect(()=>{const Ne=()=>{Object.values(Te.current).forEach(ut=>ut?.destroy()),Te.current={}};if(ue){Ne();return}if(!n.length)return;const wt=()=>{n.forEach(ut=>{const tt=ye.current[ut.id];if(!tt)return;const Pt=Te.current[ut.id];if(Pt){Pt.target=tt;return}const Dt=new Gk(Ve.current,{target:tt,draggable:!0,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!1,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Dt.on("dragStart",_t=>{if(!et.current){_t.stop();return}const ft=_t.inputEvent.target;if(ft.closest(".js-budget-target")||ft.tagName==="INPUT"){_t.stop();return}const bn=_.current.findIndex(xn=>xn.id===ut.id),Xt=_t.target,bt=Xt.getBoundingClientRect().height+Qk;We(ut.id),de.current={activeId:ut.id,startIndex:bn,currentIndex:bn,itemHeight:bt},Xt&&(Xt.style.transition="none",Xt.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",Xt.style.zIndex="20"),Qe()});let Gt=null;Dt.on("drag",_t=>{const ft=_t.target;Gt!==null&&cancelAnimationFrame(Gt),Gt=requestAnimationFrame(()=>{const bn=de.current;if(bn.activeId!==ut.id)return;const Xt=_t.beforeTranslate[1];ft.style.transform=`translateY(${Xt}px)`,ft.style.transition="none";const{itemHeight:Wt,startIndex:bt}=bn;if(!Wt)return;const xn=Math.round(Xt/Wt),Mn=Zk(bt+xn,0,_.current.length-1);Mn!==bn.currentIndex&&(bn.currentIndex=Mn,_.current.forEach((Wi,jr)=>{if(Wi.id===ut.id)return;const Vr=ye.current[Wi.id];if(!Vr)return;let tr=0;bt<Mn?jr>bt&&jr<=Mn&&(tr=-Wt):bt>Mn&&jr>=Mn&&jr<bt&&(tr=Wt),Vr.style.transform=tr?`translateY(${tr}px)`:"",Vr.style.transition="transform 0.2s ease"})),Gt=null})}),Dt.on("dragEnd",_t=>{Gt!==null&&(cancelAnimationFrame(Gt),Gt=null);const ft=_t.target,bn=de.current,{startIndex:Xt,currentIndex:Wt}=bn;if(ft.style.transform="",ft.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",ft.style.boxShadow="",_.current.forEach(bt=>{if(bt.id===ut.id)return;const xn=ye.current[bt.id];xn&&(xn.style.transform="",xn.style.transition="")}),Xt!==Wt){const bt=[..._.current],[xn]=bt.splice(Xt,1);bt.splice(Wt,0,xn),_.current=bt,w(bt)}setTimeout(()=>{ft.style.zIndex="",ft.style.transition="",We(null)},300),de.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},ct()}),Dt.on("click",()=>{const _t=window.event?.target;_t&&(_t.closest(".js-budget-target")||_t.tagName==="INPUT")||an(ut.id)}),Te.current[ut.id]=Dt})},An=window.setTimeout(wt,80);return()=>{clearTimeout(An),Ne()}},[n,Qe,ct,an,ue]);const _i=()=>{B("add"),J(null),z(!0)},Xi=Ne=>{G.current&&clearTimeout(G.current),!K&&(B("edit"),J(Ne),z(!0))},_a=Ne=>{G.current&&clearTimeout(G.current),H(!0),m(Ne),setTimeout(()=>H(!1),500)},Or=()=>{z(!1),J(null)},Tn=async()=>{ne(!1),await b(i)},ur=()=>{M(),Y(!1)};return u?v.jsx(UO,{message:d?"Still loading... This is normal on slow connections":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .moveable-control { display: none !important; }
        .moveable-origin { display: none !important; }
        .moveable-line { display: none !important; }
      `}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[!ue&&v.jsx("header",{ref:$,className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(Nte,{currentMonth:i,onMonthChange:Ne=>{ne(!1),A(Ne)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((Ne,wt)=>Ne+wt.amount,0),totalAllocated:(a[i]||[]).filter(Ne=>n.some(wt=>wt.id===Ne.envelopeId)||e.some(wt=>wt.id===Ne.envelopeId)).reduce((Ne,wt)=>Ne+wt.budgetedAmount,0)}})}),v.jsxs("div",{className:"pb-[calc(8rem+env(safe-area-inset-bottom))] px-4 max-w-4xl mx-auto space-y-4",style:ue?void 0:{paddingTop:Math.max(0,re+16)},children:[ue?v.jsx(jte,{currentMonth:i,onComplete:ur}):Z?v.jsx(Pte,{currentMonth:i,onCopy:Tn}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"flex justify-between items-center mb-4",children:v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Income Sources"})}),(t[i]||[]).length===0?v.jsx("div",{className:"text-center py-6",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm",children:"No income sources yet. Add your monthly income."})}):v.jsx("div",{className:"space-y-3",children:v.jsx(ri,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(Ne=>v.jsx(Nn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{onDelete:()=>_a(Ne),children:v.jsxs("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>Xi(Ne),children:[v.jsx("div",{className:"flex-1",children:v.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:Ne.name})}),v.jsxs("p",{className:"text-sm font-semibold text-green-600 dark:text-emerald-400",children:["$",Ne.amount.toFixed(2)]})]})})},Ne.id))})}),v.jsx("div",{className:"flex justify-end mt-4",children:v.jsx("button",{onClick:_i,className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-zinc-800",children:v.jsx(gh,{size:24})})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"flex justify-between items-center mb-4",children:v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Spending Envelopes"})}),n.length===0?v.jsxs("div",{className:"text-center py-6",children:[v.jsx(wv,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:n.length===0?"No envelopes added to this month. Copy from previous month or add new ones.":"No envelopes yet. Create one to get started."}),v.jsx("button",{onClick:()=>I("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]}):v.jsx("div",{ref:Ve,children:v.jsx(ri,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:n.map(Ne=>{const An=(a[i]||[]).find(tt=>tt.envelopeId===Ne.id)?.budgetedAmount||0,ut=h(Ne.id);return v.jsx(zte,{env:Ne,budgetedAmount:An,remainingBalance:ut,navigate:I,transactions:o,currentMonth:i,setMoveableRef:oe,isReorderingActive:Oe,activelyDraggingId:Me,onItemDragStart:Mt,onLongPressTrigger:zt},Ne.id)})})})}),v.jsx("div",{className:"flex justify-end mt-4",children:v.jsx("button",{onClick:()=>I("/add-envelope"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-zinc-800",title:"Create New Envelope",children:v.jsx(gh,{size:24})})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"flex justify-between items-center mb-4",children:v.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[v.jsx(yc,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Piggybanks"]})}),e.length>0?v.jsx("div",{ref:Pe,className:"relative",children:v.jsx(ri,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:e.map(Ne=>v.jsx(Vte,{piggybank:Ne,balance:h(Ne.id),onNavigate:wt=>I(`/envelope/${wt}`),setMoveableRef:he(Ne.id),isReorderingActive:Oe,activelyDraggingId:Ge,onItemDragStart:()=>{},onLongPressTrigger:zt},Ne.id))})})}):v.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-zinc-400",children:[v.jsx(yc,{size:48,className:"mx-auto mb-3 opacity-30"}),v.jsx("p",{className:"text-sm",children:"No piggybanks yet"}),v.jsx("p",{className:"text-xs mt-1",children:"Click the + button below to create your first piggybank"})]}),v.jsx("div",{className:"flex justify-end mt-4",children:v.jsx("button",{onClick:()=>I("/add-envelope?type=piggybank"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors p-2 rounded-full hover:bg-gray-100 dark:hover:bg-zinc-800",title:"Create New Piggybank",children:v.jsx(gh,{size:24})})})]})]}),v.jsx(Mte,{isVisible:k,onClose:Or,mode:L,initialIncomeSource:O})]})]})]})},Bte=[],M5=({selectedCard:n,onCardSelect:e,initialCards:t=Bte,disabled:r=!1,isUserSelected:i=!1})=>{const a=Wn(L=>L.appSettings),o=Wn(L=>L.updateAppSettings),[c,u]=U.useState(t.length>0?t[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[d,h]=U.useState(!1),[p,m]=U.useState(!1),[b,_]=U.useState(t),[w,S]=U.useState(null),[T,A]=U.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"});U.useEffect(()=>{a?.paymentSources&&(_(a.paymentSources),a.paymentSources.length>0&&!n&&u(a.paymentSources[0]))},[a,n]);const D=n||c;U.useEffect(()=>{!n&&e&&b.length>0&&e(b[0])},[n,e,b]);const P=L=>{r||(L.id==="add-new"?m(!0):(u(L),e?.(L),h(!1)))},M=()=>{r||h(!d)},V=L=>{r||S(L)},C=async()=>{if(w&&!r){const L=b.filter(B=>B.id!==w.id);if(_(L),D?.id===w.id){const B=L.length>0?L[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"};u(B),e?.(B)}S(null),h(!1);try{await o({paymentSources:L})}catch(B){console.error("Failed to delete card from app settings:",B),_(b),alert("Failed to delete card. Please try again.");return}}},I=()=>{S(null)},k=async()=>{if(r)return;const L=!["Cash","Venmo"].includes(T.network);if(L&&(T.last4.length!==4||!/^\d{4}$/.test(T.last4))){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!T.name.trim()){alert("Please enter a name");return}const B={id:`custom-${Date.now()}`,name:T.name.trim(),network:T.network,last4:L?T.last4:void 0,color:T.color},O=[...b,B];_(O),u(B),e?.(B),m(!1),h(!1);try{await o({paymentSources:O})}catch(J){console.error("Failed to save card to app settings:",J),_(b),u(D),alert("Failed to save card. Please try again.");return}A({name:"",network:"Visa",last4:"",color:"#3b82f6"})},z=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:M,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:D.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:D.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(D.network)?D.network==="Cash"?"$$$":"@":` ${D.last4||""}`})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:D.name}),v.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Cash","Venmo"].includes(D.network)?D.network:`(...${D.last4})`})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:d?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),d&&v.jsx("div",{className:"card-stack-dropdown",children:v.jsx("div",{className:"card-stack",children:v.jsx(ri,{initial:!1,mode:"popLayout",children:[...b,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((L,B)=>{const O=D.id===L.id,J=L.id==="add-new",K=["Cash","Venmo"].includes(L.network);return v.jsx(Nn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{onDelete:()=>!J&&!r&&V(L),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${O?"selected":""} ${J?"add-new-card":""}`,onClick:()=>P(L),style:{backgroundColor:J?"#f3f4f6":L.color,color:J?"#374151":L.color==="#e3e3e3"?"#000":"#fff",zIndex:b.length-B},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:J?"":L.network}),O&&!J&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:L.name}),v.jsx("div",{className:"card-number",children:J?"":K?L.network==="Cash"?"$$$":"@":` ${L.last4}`})]}),J&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},L.id)})})})})]}),p&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Payment Method"}),v.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Name"}),v.jsx("input",{type:"text",value:T.name,onChange:L=>A({...T,name:L.target.value}),placeholder:"e.g., Wallet Cash, My Venmo",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),v.jsxs("select",{value:T.network,onChange:L=>A({...T,network:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"}),v.jsx("option",{value:"Cash",children:"Cash"}),v.jsx("option",{value:"Venmo",children:"Venmo"})]})]}),!["Cash","Venmo"].includes(T.network)&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:T.last4,onChange:L=>A({...T,last4:L.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:z.map(L=>v.jsx("button",{type:"button",onClick:()=>A({...T,color:L}),className:`w-full h-10 rounded-lg border-2 transition-all ${T.color===L?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:L}},L))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsx("span",{className:"text-left text-[9px] leading-none",children:["Cash","Venmo"].includes(T.network)?T.network==="Cash"?"$$$":"@":` ${T.last4||"0000"}`})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:k,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add"})]})]})]})}),w&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:w.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"button",onClick:C,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},P5=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=Wn(),[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState(""),[w,S]=U.useState(new Date().toISOString().split("T")[0]),[T,A]=U.useState(null);U.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),A(i.paymentMethod||null);try{const C=new Date(i.date);isNaN(C.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(C.toISOString().split("T")[0])}catch(C){console.error("Error parsing transaction date:",C),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),S(new Date().toISOString().split("T")[0])},[n,t,i]);const D=async C=>{C.preventDefault();const I=parseFloat(d);if(isNaN(I)||I<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:I,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),z=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(z!==u){const L=`This transaction date (${z}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(L))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},P=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},M=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",V=t==="add"?"text-green-500":"text-red-500";return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Nn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(Nn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:M}),v.jsx("button",{onClick:D,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0||i?.isAutomatic,children:i?.isAutomatic?"":"Save"})]}),v.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${V}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:C=>{const I=C.target.value.replace(/\D/g,"");if(!I){h("");return}const z=(parseInt(I,10)/100).toFixed(2);h(z)},onKeyDown:C=>{(C.key==="e"||C.key==="E"||C.key==="+"||C.key==="-")&&C.preventDefault()},placeholder:"0.00",autoFocus:!0,disabled:i?.isAutomatic,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${V} placeholder-gray-700 ${i?.isAutomatic?"cursor-not-allowed opacity-80":""}`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:C=>m(C.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),!i?.isAutomatic&&v.jsx(M5,{selectedCard:T,onCardSelect:A}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:C=>_(C.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none",disabled:i?.isAutomatic})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const C=new Date(w);return`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(Ju,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:w,onChange:C=>{console.log("Date changed to:",C.target.value),S(C.target.value)},required:!0,disabled:i?.isAutomatic,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark] disabled:opacity-80"})]}),t==="edit"&&!i?.isAutomatic&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:P,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(_N,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},Ute=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=Wn(),[a,o]=U.useState(""),[c,u]=U.useState(""),[d,h]=U.useState(""),[p,m]=U.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==t.id);U.useEffect(()=>{if(!n)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[n]);const _=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(S=>S.id===a);return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Nn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(Nn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>v.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const D=(parseInt(T,10)/100).toFixed(2);u(D)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},Fte=({isOpen:n,onClose:e,onSave:t,existingPiggybank:r})=>{const[i,a]=U.useState(""),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState("#3B82F6"),[m,b]=U.useState("piggy-bank"),[_,w]=U.useState(!1),[S,T]=U.useState(!1);U.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),w(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),w(!1))},[r,n]);const A=async P=>{if(P.preventDefault(),!(!i.trim()||!u)){T(!0);try{const M={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:_}};o&&parseFloat(o)>0&&(M.piggybankConfig.targetAmount=parseFloat(o)),r&&(M.id=r.id,M.currentBalance=r.currentBalance,M.lastUpdated=new Date().toISOString(),M.isActive=r.isActive,M.orderIndex=r.orderIndex,M.userId=r.userId),await t(M),e()}catch(M){console.error("Error saving piggybank:",M),alert("Failed to save piggybank")}finally{T(!1)}}},D=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Nn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(Nn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(yc,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(Ev,{size:24})})]}),v.jsxs("form",{onSubmit:A,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:P=>a(P.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:P=>{const M=P.target.value.replace(/\D/g,"");if(!M){d("");return}const C=(parseInt(M,10)/100).toFixed(2);d(C)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:P=>{const M=P.target.value.replace(/\D/g,"");if(!M){c("");return}const C=(parseInt(M,10)/100).toFixed(2);c(C)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:_,onChange:P=>w(P.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:D.map(P=>v.jsx("button",{type:"button",onClick:()=>p(P.value),className:`w-full aspect-square rounded-lg transition-all ${h===P.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:P.value},title:P.label},P.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:S,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||S,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!S?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:S?"Saving...":r?"Update":"Create"})]})]})]})]})})},Gte=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},qte=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},O5=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:Gte(n.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",qte(n.amount)]}),t?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?v.jsx(Cs,{className:"text-green-500",size:20}):v.jsx(C2,{className:"text-gray-400",size:20})}):v.jsx("span",{children:n.reconciled?v.jsx(Cs,{className:"text-green-500",size:20}):v.jsx(C2,{className:"text-gray-400",size:20})})]})]})},_1=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Hte=()=>{const{id:n}=c6(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p,allocations:m,incomeSources:b,setEnvelopeAllocation:_,updatePiggybankContribution:w,updateEnvelope:S}=Wn(),{showToast:T}=Lc(),A=Ys(),D=xa(),[P,M]=U.useState(!1),[V,C]=U.useState(!1),[I,k]=U.useState(!1),[z,L]=U.useState(null),[B,O]=U.useState(!1),[J,K]=U.useState(!1),[H,Z]=U.useState(""),ne=U.useRef(null),ue=U.useRef(!1);U.useEffect(()=>{e.length===0&&r()},[]);const Y=e.find(de=>de.id===n),G=async de=>{if(Y)try{const Se={...Y,...de,id:Y.id,userId:Y.userId,currentBalance:Y.currentBalance,lastUpdated:new Date().toISOString(),isActive:Y.isActive,orderIndex:Y.orderIndex};await S(Se),T("Piggybank updated successfully","success"),O(!1)}catch(Se){console.error("Failed to update piggybank:",Se),T("Failed to update piggybank","error")}},$=Y?.isPiggybank?Y.piggybankConfig?.monthlyContribution||0:m[p]?.find(de=>de.envelopeId===n)?.budgetedAmount||0;U.useEffect(()=>{J&&(Z($.toString()),setTimeout(()=>{ne.current?.focus(),ne.current?.select()},50))},[J,$]);const re=de=>{const Se=(b[p]||[]).reduce((Ue,we)=>Ue+we.amount,0),Be=m[p]||[];let Ge=Be.map(Ue=>Y&&Ue.envelopeId===Y.id&&de!==void 0?{...Ue,budgetedAmount:de}:Ue).filter(Ue=>{const we=e.find(Oe=>Oe.id===Ue.envelopeId);return we?we.isActive!==!1:!1}).reduce((Ue,we)=>Ue+we.budgetedAmount,0);return de!==void 0&&Y&&(Be.some(we=>we.envelopeId===Y.id)||(Ge+=de)),Se-Ge},oe=J?re(parseFloat(H)||0):re(),he=async()=>{if(!Y||ue.current)return;const de=parseFloat(H);if(isNaN(de)||de<0){T("Please enter a valid positive number","error");return}ue.current=!0;try{Y.isPiggybank?await w(Y.id,de):await _(Y.id,de),K(!1)}catch(Se){console.error("Failed to save budget:",Se),T("Failed to update budget","error")}finally{ue.current=!1}};if(!Y)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(Y.isPiggybank){const de=t.filter(Se=>Se.envelopeId===Y.id);console.log(" Piggybank:",Y.name),console.log(" Created at:",Y.createdAt),console.log(" Transactions:",de.map(Se=>({date:Se.date,description:Se.description,amount:Se.amount})))}const ye=t.filter(de=>de.envelopeId===Y.id).filter(de=>{if(de.description==="Budgeted"||de.description==="Piggybank Contribution")return!1;if(Y.isPiggybank){if(!Y.createdAt)return!0;const Se=mv(Y.createdAt).toISOString().split("T")[0];return mv(de.date).toISOString().split("T")[0]>=Se}return de.month===p||!de.month}).sort((de,Se)=>new Date(Se.date).getTime()-new Date(de.date).getTime()),Te=()=>{D.state?.fromGlobalFAB?A("/"):A(-1)},Me=()=>{n&&(a(n),A(-1))},We=de=>{const Se={...de,reconciled:!de.reconciled};c(Se)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{if(Y.isPiggybank)O(!0);else{const de=prompt("Rename envelope:",Y.name);de&&de.trim()&&n&&o(n,de)}},className:"text-blue-600 dark:text-blue-400 font-medium",children:Y.isPiggybank?"Edit":"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:Y.name}),v.jsx("button",{onClick:Te,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsxs("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const de=Y.isPiggybank?h(Y.id):h(Y.id,p);return console.log(`Debug: Envelope ${Y.name} Balance:`,de),v.jsx("span",{className:`text-xl font-bold ${de<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:_1(de)})})()]}),v.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-zinc-400",children:Y.isPiggybank?"Monthly Contribution":"Budgeted This Month"}),J?v.jsx("form",{onSubmit:de=>{de.preventDefault(),he()},className:"flex items-center gap-2",children:v.jsx("input",{ref:ne,type:"number",step:"0.01",value:H,onChange:de=>Z(de.target.value),onBlur:he,className:"w-24 px-2 py-1 text-right font-semibold bg-gray-100 dark:bg-zinc-800 rounded border border-blue-500 focus:outline-none"})}):v.jsx("div",{onClick:()=>K(!0),className:"px-2 py-1 -mr-2 rounded hover:bg-gray-100 dark:hover:bg-zinc-800 cursor-pointer transition-colors",children:v.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:_1($)})})]}),v.jsxs("div",{className:`mt-3 py-1.5 px-3 rounded-md flex justify-between items-center text-xs font-medium transition-colors ${oe<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":oe===0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:[v.jsx("span",{children:"Left to Budget:"}),v.jsx("span",{children:_1(oe)})]})]})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>M(!0),children:[v.jsx(DL,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>C(!0),children:[v.jsx(IL,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>k(!0),children:[v.jsx(hL,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:ye.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(ri,{initial:!1,mode:"popLayout",children:ye.map(de=>v.jsx(Nn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{disabled:de.isAutomatic,onDelete:()=>{if(!de.id)return;const Se={...de};u(de.id),T("Transaction deleted","neutral",()=>d(Se))},children:v.jsx(O5,{transaction:de,onReconcile:()=>We(de),onEdit:()=>{de.isAutomatic||L(de)}})})},de.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const de=Y.isPiggybank?`Are you sure you want to delete "${Y.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${Y.name}" from ${p}? This will delete all transactions for this month only.`;confirm(de)&&Me()},children:[v.jsx(_N,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(P5,{isVisible:P||V||!!z,onClose:()=>{M(!1),C(!1),L(null)},mode:P?"add":V?"spend":"edit",currentEnvelope:Y,initialTransaction:z}),v.jsx(Ute,{isVisible:I,onClose:()=>k(!1),sourceEnvelope:Y}),v.jsx(Fte,{isOpen:B,onClose:()=>O(!1),onSave:G,existingPiggybank:Y})]})},$te=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=U.useState("confirm"),b=S=>{const[T,A]=S.split("-");return new Date(parseInt(T),parseInt(A)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},_=()=>{p==="confirm"?m("final_confirm"):p==="final_confirm"&&t()},w=()=>{m("confirm"),e()};return v.jsx(ri,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Nn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:w,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(Nn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",b(r)]}),v.jsx("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:p==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})})]}):v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4",children:v.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),v.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-2",children:"Are you absolutely sure?"}),v.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["This action cannot be undone. All budget data and transactions for ",v.jsx("strong",{children:b(r)})," will be permanently removed."]})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:w,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:_,disabled:h,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":p==="confirm"?"Continue":"Yes, Start Fresh"})]})]})]})})},Yte=()=>{const n=Ys(),e=U.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:_,resetOnboarding:w}=Wn(),{deleteAccount:S,currentUser:T,logout:A}=fa(),[D,P]=U.useState(null),[M,V]=U.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[C,I]=U.useState(!1),[k,z]=U.useState(""),[L,B]=U.useState(!1),[O,J]=U.useState(!1),[K,H]=U.useState(null),[Z,ne]=U.useState(!1),[ue,Y]=U.useState(!1),G=978307200,$=c?.theme??"system",re=c?.fontSize??"medium";U.useEffect(()=>{c||d().catch(we=>{console.error("Failed to initialize app settings:",we)})},[d,c]);const W=(we,Oe)=>{P({type:we,text:Oe}),setTimeout(()=>P(null),3500)},oe=U.useMemo(()=>{const we=t.length,Oe=r.length,ke=m?p[m]||[]:[],Ve=Object.values(h).reduce((an,zt)=>an+zt.length,0),et=ke.length,Tt=t.reduce((an,zt)=>{const yn=o(zt.id);return an+(typeof yn=="number"?yn:0)},0),Qe=0,ct=r.reduce((an,zt)=>{let yn=0;if(typeof zt.date=="string"){const Tr=Date.parse(zt.date);yn=Number.isNaN(Tr)?0:Tr}else typeof zt.date=="number"&&(yn=zt.date<2e9?(zt.date+G)*1e3:zt.date);return Math.max(an,yn)},0),Mt=Qe||ct?new Date(Math.max(Qe,ct)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:we,transactionCount:Oe,incomeSourceCount:Ve,allocationCount:et,totalBalance:Tt,lastUpdated:Mt}},[t,r,h,p,m]),he=()=>{try{console.log(" Creating backup...");const we={appVersion:"1.6.4",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(Tt=>({...Tt,currentBalance:(()=>{const Qe=o(Tt.id);return typeof Qe=="number"?Qe:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},Oe=new Blob([JSON.stringify(we,null,2)],{type:"application/json"}),ke=URL.createObjectURL(Oe),Ve=document.createElement("a");Ve.href=ke,Ve.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Ve),Ve.click(),document.body.removeChild(Ve),URL.revokeObjectURL(ke);const et=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",et),V(et),H({success:!0,message:"Backup downloaded successfully."})}catch(we){console.error(we),H({success:!1,message:"Failed to create backup file.",onRetry:he})}},ye=()=>{J(!0),H(null);try{const we=["Date","Merchant","Payment Method","Notes","Amount","Type","Envelope","Reconciled"],Oe=r.filter(Qe=>Qe.description!=="Budgeted"&&Qe.description!=="Piggybank Contribution").map(Qe=>{const ct=t.find(_i=>_i.id===Qe.envelopeId)?.name||"Unknown",Mt=(Qe.merchant||"").replace(/"/g,'""'),an=(Qe.description||"").replace(/"/g,'""');let zt="";Qe.paymentMethod&&(zt=`${Qe.paymentMethod.name} (...${Qe.paymentMethod.last4})`);const yn=zt.replace(/"/g,'""');let Tr="Invalid Date";if(Qe.date){if(typeof Qe.date=="string")Tr=Qe.date.split("T")[0];else if(typeof Qe.date=="number"){const _i=Qe.date<2e9?(Qe.date+G)*1e3:Qe.date;Tr=new Date(_i).toISOString().split("T")[0]}}return[Tr,`"${Mt}"`,`"${yn}"`,`"${an}"`,Qe.amount.toFixed(2),Qe.type,`"${ct}"`,Qe.reconciled?"Yes":"No"].join(",")}),ke=[we.join(","),...Oe].join(`
`),Ve=new Blob([ke],{type:"text/csv;charset=utf-8;"}),et=URL.createObjectURL(Ve),Tt=document.createElement("a");Tt.href=et,Tt.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Tt),Tt.click(),document.body.removeChild(Tt),URL.revokeObjectURL(et),H({success:!0,message:"Transactions CSV exported successfully."})}catch(we){console.error(we),H({success:!1,message:"Failed to export CSV. Please try again.",onRetry:ye})}finally{J(!1)}},Te=()=>{e.current?.click()},Me=we=>{const Oe=we.target.files?.[0];if(!Oe)return;const ke=new FileReader;ke.onload=async Ve=>{try{const et=JSON.parse(Ve.target?.result),Tt=await a(et);if(!Tt.success){W("error",Tt.message);return}if(et.appSettings?.theme)try{await u({theme:et.appSettings.theme})}catch(Qe){console.error("Failed to update imported settings:",Qe)}W("success",`Loaded ${et.envelopes?.length??0} envelopes, ${et.transactions?.length??0} transactions.`)}catch(et){console.error(et),W("error","Invalid backup file. Please verify the JSON.")}},ke.readAsText(Oe),we.target.value=""},We=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),W("success","All data has been permanently deleted."),n("/")}catch(we){console.error("Reset failed:",we),W("error","Failed to delete all data. Some data may remain.")}},de=async()=>{if(!k.trim()){W("error","Please enter your password to confirm account deletion.");return}I(!0);try{await i(),await S(k)?W("success","Your account has been permanently deleted."):W("error","Failed to delete account. Please try again.")}catch(we){console.error("Account deletion failed:",we),W("error","Failed to delete account. Please try again.")}finally{I(!1),B(!1),z("")}},Se=async()=>{if(!T){W("error","You must be logged in to clean up data.");return}ne(!0);try{const we=await US.cleanupOrphanedData(T.id),Oe=we.orphanedAllocationsDeleted+we.orphanedTransactionsDeleted;Oe>0?W("success",`Cleaned ${Oe} orphaned items: ${we.orphanedAllocationsDeleted} allocations and ${we.orphanedTransactionsDeleted} transactions.`):W("success","No orphaned data found. Your database is already clean!")}catch(we){console.error("Cleanup failed:",we),W("error","Failed to clean up orphaned data. Please try again.")}finally{ne(!1)}},Be=()=>{Y(!0)},Pe=async()=>{Y(!1),await b(m),W("success","Month data has been reset.")},Ge=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{_(),A(),n("/")}catch(we){console.error("Logout failed:",we)}},Ue=T?.displayName?.charAt(0)?.toUpperCase()||T?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[D&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${D.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[D.type==="success"?v.jsx(T1,{size:18}):v.jsx(C1,{size:18}),D.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:Ue}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:T?.displayName||T?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:T?.email}),v.jsxs("button",{onClick:Ge,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(t9,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(R2,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:oe.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 space-y-4",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[$==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),$==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),$==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:$})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(we=>v.jsx("button",{onClick:async()=>{try{await u({theme:we.value})}catch(Oe){console.error("Failed to update theme setting:",Oe)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${$===we.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:we.label},we.value))})]}),v.jsx("div",{className:"h-px bg-gray-100 dark:bg-zinc-800"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-gray-500 text-lg",children:"Aa"}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Font Size"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:re})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"A",value:"small",sizeClass:"text-xs"},{label:"A",value:"medium",sizeClass:"text-base"},{label:"A",value:"large",sizeClass:"text-xl"}].map(we=>v.jsx("button",{onClick:async()=>{try{await u({fontSize:we.value})}catch(Oe){console.error("Failed to update font size setting:",Oe)}},className:`flex-1 py-2 rounded-lg font-medium border transition-colors flex items-center justify-center ${re===we.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:v.jsx("span",{className:we.sizeClass,children:we.label})},we.value))})]})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Help & Guide"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:v.jsxs("button",{onClick:()=>{w(),n("/")},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Lh,{className:"text-purple-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restart Onboarding Guide"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"View the welcome tutorial again"})]})]}),v.jsx(As,{className:"text-gray-400",size:18})]})})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:he,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(R2,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",M]})]})]}),v.jsx(As,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Te,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(S9,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(As,{className:"text-gray-400",size:18})]}),v.jsx("div",{className:"p-4",children:v.jsxs("button",{onClick:ye,disabled:O,className:"w-full flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed rounded-xl border border-gray-100 dark:border-zinc-800 px-4 py-3 bg-white dark:bg-zinc-900",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[O?v.jsx(D2,{className:"text-blue-500 animate-spin",size:20}):v.jsx(GL,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:O?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(As,{className:"text-gray-400",size:18})]})}),v.jsx("input",{type:"file",ref:e,onChange:Me,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:Be,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(zh,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(As,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Se,disabled:Z,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[Z?v.jsx(D2,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(Lh,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:Z?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(As,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:We,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(C1,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(As,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>B(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Ju,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(As,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.6.4"," (PWA)"]}),"        "]}),K&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[K.success?v.jsx(T1,{className:"text-green-500",size:24}):v.jsx(Ju,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:K.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:K.message}),v.jsxs("div",{className:"flex gap-2",children:[K.onRetry&&v.jsx("button",{onClick:()=>{H(null),K.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>H(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx($te,{isVisible:ue,onClose:()=>Y(!1),onConfirm:Pe,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((we,Oe)=>we+Oe.amount,0),allocationCount:(p[m]||[]).filter(we=>t.some(Oe=>Oe.id===we.envelopeId)).length,totalAllocated:(p[m]||[]).filter(we=>t.some(Oe=>Oe.id===we.envelopeId)).reduce((we,Oe)=>we+Oe.budgetedAmount,0),transactionCount:r.filter(we=>we.month===m).length,totalTransactionAmount:r.filter(we=>we.month===m).reduce((we,Oe)=>we+Oe.amount,0)}),L&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(Ju,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:k,onChange:we=>z(we.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{B(!1),z("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:de,disabled:C||!k.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:C?"Deleting...":"Delete Account"})]})]})})]})]})},Kte=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t}=Wn(),{showToast:r}=Lc(),i=Ys(),[a]=eL(),[o,c]=U.useState(""),u=a.get("type")==="piggybank",[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState("#3B82F6"),[w,S]=U.useState(!1),T=async A=>{if(A.preventDefault(),!o.trim()||w)return;S(!0);const D=Wn.getState().envelopes,M=(D.length>0?Math.max(...D.map(k=>k.orderIndex??0)):-1)+1,V=u?new Date(`${t}-01T00:00:00`):new Date,C={name:o,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:V.toISOString(),isActive:!0,orderIndex:M};if(u){C.isPiggybank=!0;const k={monthlyContribution:parseFloat(p||"0"),color:b,icon:"piggy-bank"};d&&parseFloat(d)>0&&(k.targetAmount=parseFloat(d)),C.piggybankConfig=k}n(C).then(k=>{if(k){const z=u?parseFloat(p||"0"):0;e(k,z).catch(L=>console.error("Failed to create allocation:",L)),setTimeout(()=>{i("/")},50)}}).catch(k=>{console.error("Failed to create envelope:",k),r(k.message||"Failed to create envelope","error"),S(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>i("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(sd,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:u?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:u?v.jsx(yc,{size:40}):v.jsx(HL,{size:40})})}),v.jsxs("form",{onSubmit:T,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:u?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:o,onChange:A=>c(A.target.value),placeholder:u?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),u&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:p,onChange:A=>m(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:u})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:d,onChange:A=>h(A.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(A=>v.jsx("button",{type:"button",onClick:()=>_(A.value),className:`w-full aspect-square rounded-lg transition-all ${b===A.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:A.value},title:A.label},A.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>i("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!o.trim()||u&&!p||w,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${o.trim()&&(!u||p)&&!w?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:w?"Creating...":u?"Create Piggybank":"Create Envelope"})]})]})]})})]})},Xte=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=U.useState([]),[a,o]=U.useState({}),[c,u]=U.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(S=>S!==_):[...w,_])},h=(_,w)=>{o(S=>({...S,[_]:w}))};U.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),U.useEffect(()=>{const _=Object.values(a).reduce((w,S)=>w+(S||0),0);u(e-_),t(a)},[a,e,t]),U.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return v.jsxs("div",{className:"space-y-3",children:[r.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&v.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},j5=({onClose:n,onSaved:e})=>{const t=Ys(),{envelopes:r,addTransaction:i,currentMonth:a}=Wn(),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(()=>{const K=new Date;return new Date(K.getTime()-K.getTimezoneOffset()*6e4).toISOString().split("T")[0]}),[_,w]=U.useState("expense"),[S,T]=U.useState({}),[A,D]=U.useState(null),[P,M]=U.useState(!1),V=()=>{if(n){n();return}t(-1)},C=K=>{D(K),A&&M(!0)},I=Object.keys(S).length>0,k=Object.values(S).reduce((K,H)=>K+(H||0),0),z=Math.abs(k-parseFloat(o||"0"))<.01,L=o&&parseFloat(o)>0&&I&&z,B=async K=>{if(K.preventDefault(),!L)return;const[H,Z,ne]=m.split("-").map(Number),ue=new Date(H,Z-1,ne,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",ue.toISOString());try{const[Y,G]=m.split("-").map(Number),$=`${Y}-${G.toString().padStart(2,"0")}`;if($!==a){const W=`This transaction date (${$}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(W))return}const re=Object.entries(S).filter(([W,oe])=>oe>0);Promise.all(re.map(([W,oe])=>i({amount:oe,description:h,merchant:u||void 0,date:ue.toISOString(),envelopeId:W,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:A||void 0}).catch(he=>console.error("Failed to create transaction:",he)))).catch(W=>console.error("Failed to create transactions:",W)),e&&e(),n?n():t("/")}catch(Y){console.error("Error saving transaction:",Y),alert("Failed to save transaction: "+(Y instanceof Error?Y.message:"Unknown error"))}},O=[...r].filter(K=>K.isActive!==!1).sort((K,H)=>{const Z=K.orderIndex??0,ne=H.orderIndex??0;return Z!==ne?Z-ne:K.name.localeCompare(H.name)}),J=_==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"h-screen overflow-y-auto bg-gray-50 dark:bg-black overscroll-contain",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-20 flex items-center justify-between",children:[v.jsx("button",{onClick:V,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:B,disabled:!L,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:B,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${J}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:o,onChange:K=>{const H=K.target.value.replace(/\D/g,"");if(!H){c("");return}const ne=(parseInt(H,10)/100).toFixed(2);c(ne)},onKeyDown:K=>{(K.key==="e"||K.key==="E"||K.key==="+"||K.key==="-")&&K.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${J} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:u,onChange:K=>d(K.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(M5,{selectedCard:A,onCardSelect:C,isUserSelected:P}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:h,onChange:K=>p(K.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[K,H]=m.split("-").map(Number);return`${K}-${H.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(Ju,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:m,onChange:K=>b(K.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(Xte,{envelopes:O,transactionAmount:parseFloat(o)||0,onSplitChange:T})})]})})]})},Wte=()=>{const n=Ys(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o,appSettings:c}=Wn(),{showToast:u}=Lc(),[d,h]=U.useState(!1),[p,m]=U.useState(""),[b,_]=U.useState("all"),[w,S]=U.useState("All"),[T,A]=U.useState(!1),[D,P]=U.useState("all"),[M,V]=U.useState(!1),[C,I]=U.useState("all"),[k,z]=U.useState(!1),[L,B]=U.useState(()=>{const Y=new Date;return Y.setMonth(Y.getMonth()-1),Y.toISOString().split("T")[0]}),[O,J]=U.useState(()=>new Date().toISOString().split("T")[0]),[K,H]=U.useState(null),Z=U.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:M,currentMonth:o,transactionMonths:e.map($=>({id:$.id,month:$.month,date:$.date,description:$.description}))});let Y=e;return M||(Y=e.filter($=>$.month===o||!$.month),console.log(" After month filter:",{remaining:Y.length,currentMonth:o,filteredTransactions:Y.map($=>({id:$.id,description:$.description,month:$.month,matchesCurrentMonth:$.month===o}))})),Y.map($=>{if(!$)return null;let re=$.date;if(typeof $.date=="number"){const oe=($.date+978307200)*1e3;re=new Date(oe).toISOString()}else if(!$.date||typeof $.date!="string")return null;return{...$,date:re}}).filter(Boolean).filter($=>{if($.description==="Budgeted"||$.description==="Piggybank Contribution")return!1;if(p){const W=p.toLowerCase(),oe=t.find(Te=>Te.id===$.envelopeId)?.name.toLowerCase()||"",he=$.amount.toFixed(2);if(!($.description.toLowerCase().includes(W)||oe.includes(W)||he.includes(W)))return!1}if(b!=="all"&&$.envelopeId!==b||w!=="All"&&$.type!==w||C!=="all"&&(!$.paymentMethod||$.paymentMethod.id!==C)||!$.date||typeof $.date!="string")return!1;const re=$.date.split("T")[0];return!(k&&(re<L||re>O)||D!=="all"&&new Date(re).getMonth()!==parseInt(D)||T&&!$.reconciled)}).sort(($,re)=>new Date(re.date).getTime()-new Date($.date).getTime())},[e,t,p,b,w,C,L,O,T,M,o,k]);console.log(" Final filtered transactions:",{count:Z.length,transactions:Z.map(Y=>({id:Y.id,description:Y.description,amount:Y.amount,date:Y.date,month:Y.month,type:Y.type}))});const ne=K?t.find(Y=>Y.id===K.envelopeId):null,ue=Y=>{const G={...Y,reconciled:!Y.reconciled};r(G)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(sd,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>h(!d),className:`p-2 rounded-full transition-colors ${d?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(YL,{size:20,className:d?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>V(!M),className:`text-sm px-3 py-1 rounded-md ${M?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:M?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"relative",children:[v.jsx(d9,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:Y=>m(Y.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),p&&v.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(Ev,{size:16})})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${d?"max-h-[600px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:C,onChange:Y=>I(Y.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),c?.paymentSources?.map(Y=>v.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:b,onChange:Y=>_(Y.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),t.sort((Y,G)=>Y.name.localeCompare(G.name)).map(Y=>v.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map(Y=>v.jsx("button",{onClick:()=>S(Y),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${w===Y?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:Y},Y))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:D,onChange:Y=>P(Y.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},(Y,G)=>G).map(Y=>v.jsx("option",{value:Y,children:new Date(2022,Y).toLocaleString("default",{month:"long"})},Y))]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Range"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"text-xs text-gray-600 dark:text-zinc-400",children:"Enable"}),v.jsx("button",{onClick:()=>z(!k),className:`w-9 h-5 rounded-full transition-colors relative ${k?"bg-blue-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${k?"translate-x-4":"translate-x-0"}`})})]})]}),v.jsxs("div",{className:`grid grid-cols-2 gap-4 transition-opacity ${k?"opacity-100":"opacity-50 pointer-events-none"}`,children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:L,onChange:Y=>B(Y.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-[10px] font-medium text-gray-500 dark:text-zinc-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:O,onChange:Y=>J(Y.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>A(!T),className:`w-11 h-6 rounded-full transition-colors relative ${T?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${T?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>V(!M),className:`w-11 h-6 rounded-full transition-colors relative ${M?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${M?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:Z.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(ri,{initial:!1,mode:"popLayout",children:Z.map(Y=>{const G=t.find($=>$.id===Y.envelopeId);return v.jsx(Nn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(yy,{disabled:Y.isAutomatic,onDelete:()=>{if(!Y.id)return;const $={...Y};i(Y.id),u("Transaction deleted","neutral",()=>a($))},children:v.jsx(O5,{transaction:Y,envelopeName:G?.name||"Unknown Envelope",onReconcile:()=>ue(Y),onEdit:()=>{Y.isAutomatic||(G?H(Y):alert("Cannot edit: Envelope deleted."))}})})},Y.id)})})})}),v.jsx(P5,{isVisible:!!K&&!!ne,onClose:()=>H(null),mode:"edit",currentEnvelope:ne||{},initialTransaction:K})]})},Hl=({children:n})=>v.jsx(Nn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),Qte=()=>{const n=xa();return v.jsx(ri,{mode:"wait",children:v.jsxs(S6,{location:n,children:[v.jsx(Vo,{path:"/",element:v.jsx(Hl,{children:v.jsx(Ua,{children:v.jsx(Lte,{})})})}),v.jsx(Vo,{path:"/envelope/:id",element:v.jsx(Hl,{children:v.jsx(Ua,{children:v.jsx(Hte,{})})})}),v.jsx(Vo,{path:"/add-envelope",element:v.jsx(Hl,{children:v.jsx(Ua,{children:v.jsx(Kte,{})})})}),v.jsx(Vo,{path:"/add-transaction",element:v.jsx(Hl,{children:v.jsx(Ua,{children:v.jsx(j5,{})})})}),v.jsx(Vo,{path:"/transactions",element:v.jsx(Hl,{children:v.jsx(Ua,{children:v.jsx(Wte,{})})})}),v.jsx(Vo,{path:"/settings",element:v.jsx(Hl,{children:v.jsx(Ua,{children:v.jsx(Yte,{})})})}),v.jsx(Vo,{path:"/verify-email",element:v.jsx(Hl,{children:v.jsx(Ua,{children:v.jsx(BO,{})})})})]},n.pathname)})};function Zte(){const[n,e]=U.useState(!0),[t,r]=U.useState(!1),{appSettings:i,isOnboardingActive:a}=Wn(),{isAuthenticated:o,isInitialized:c,initializeAuth:u,lastAuthTime:d,offlineGracePeriod:h,currentUser:p}=fa();if(U.useEffect(()=>{const _=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(_)},[]),U.useEffect(()=>u(),[u]),U.useEffect(()=>{const _=document.documentElement,w=window.matchMedia("(prefers-color-scheme: dark)"),S=()=>{const T=i?.theme??"system",A=w.matches;T==="dark"||T==="system"&&A?_.classList.add("dark"):_.classList.remove("dark")};if(S(),i?.theme==="system")return w.addEventListener("change",S),()=>w.removeEventListener("change",S)},[i]),U.useEffect(()=>{const _=document.documentElement;switch(i?.fontSize??"medium"){case"small":_.style.fontSize="87.5%";break;case"large":_.style.fontSize="112.5%";break;default:_.style.fontSize="100%"}},[i?.fontSize]),n||!c)return v.jsx(UO,{message:"Initializing Personal Budget..."});if(!o)return p?v.jsx(Ua,{children:v.jsx(BO,{})}):v.jsx(Ua,{children:v.jsx(wH,{})});const b=typeof navigator<"u"&&!navigator.onLine&&o&&d&&Date.now()-d<h;return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"fixed opacity-0 pointer-events-none -z-50",children:v.jsx("label",{id:"ios-haptic-trigger",htmlFor:"ios-haptic-checkbox",children:v.jsx("input",{type:"checkbox",id:"ios-haptic-checkbox",switch:"true"})})}),v.jsxs(Ua,{children:[b&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((h-(Date.now()-d))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(X6,{children:[v.jsx(Qte,{}),t&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(j5,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),!a&&v.jsx(oW,{onAddTransaction:()=>r(!0)})]}),v.jsx(sW,{})]})]})}Az({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});Ez.createRoot(document.getElementById("root")).render(v.jsx(U.StrictMode,{children:v.jsx(Zte,{})}));export{yt as T,vt as a,mH as b,jR as c,Ft as d,Vi as e,Fa as f,Vx as g,Ga as h,Lp as o,Fs as q,ca as s,Wl as t,Ba as u,fH as w};
