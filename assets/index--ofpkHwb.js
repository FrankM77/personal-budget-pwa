(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function r6(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ux={exports:{}},$f={};var r2;function i6(){if(r2)return $f;r2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return $f.Fragment=e,$f.jsx=t,$f.jsxs=t,$f}var i2;function a6(){return i2||(i2=1,ux.exports=i6()),ux.exports}var v=a6(),dx={exports:{}},ht={};var a2;function s6(){if(a2)return ht;a2=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),m=Symbol.iterator;function b(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(G,Y,ne){this.props=G,this.context=Y,this.refs=S,this.updater=ne||_}T.prototype.isReactComponent={},T.prototype.setState=function(G,Y){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,Y,"setState")},T.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function C(){}C.prototype=T.prototype;function D(G,Y,ne){this.props=G,this.context=Y,this.refs=S,this.updater=ne||_}var M=D.prototype=new C;M.constructor=D,w(M,T.prototype),M.isPureReactComponent=!0;var j=Array.isArray;function z(){}var A={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(G,Y,ne){var te=ne.ref;return{$$typeof:n,type:G,key:Y,ref:te!==void 0?te:null,props:ne}}function V(G,Y){return k(G.type,Y,G.props)}function B(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function L(G){var Y={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ne){return Y[ne]})}var P=/\/+/g;function Z(G,Y){return typeof G=="object"&&G!==null&&G.key!=null?L(""+G.key):Y.toString(36)}function K(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(z,z):(G.status="pending",G.then(function(Y){G.status==="pending"&&(G.status="fulfilled",G.value=Y)},function(Y){G.status==="pending"&&(G.status="rejected",G.reason=Y)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function H(G,Y,ne,te,ce){var fe=typeof G;(fe==="undefined"||fe==="boolean")&&(G=null);var ye=!1;if(G===null)ye=!0;else switch(fe){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(G.$$typeof){case n:case e:ye=!0;break;case h:return ye=G._init,H(ye(G._payload),Y,ne,te,ce)}}if(ye)return ce=ce(G),ye=te===""?"."+Z(G,0):te,j(ce)?(ne="",ye!=null&&(ne=ye.replace(P,"$&/")+"/"),H(ce,Y,ne,"",function(Se){return Se})):ce!=null&&(B(ce)&&(ce=V(ce,ne+(ce.key==null||G&&G.key===ce.key?"":(""+ce.key).replace(P,"$&/")+"/")+ye)),Y.push(ce)),1;ye=0;var Ae=te===""?".":te+":";if(j(G))for(var Pe=0;Pe<G.length;Pe++)te=G[Pe],fe=Ae+Z(te,Pe),ye+=H(te,Y,ne,fe,ce);else if(Pe=b(G),typeof Pe=="function")for(G=Pe.call(G),Pe=0;!(te=G.next()).done;)te=te.value,fe=Ae+Z(te,Pe++),ye+=H(te,Y,ne,fe,ce);else if(fe==="object"){if(typeof G.then=="function")return H(K(G),Y,ne,te,ce);throw Y=String(G),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return ye}function $(G,Y,ne){if(G==null)return G;var te=[],ce=0;return H(G,te,"","",function(fe){return Y.call(ne,fe,ce++)}),te}function Q(G){if(G._status===-1){var Y=G._result;Y=Y(),Y.then(function(ne){(G._status===0||G._status===-1)&&(G._status=1,G._result=ne)},function(ne){(G._status===0||G._status===-1)&&(G._status=2,G._result=ne)}),G._status===-1&&(G._status=0,G._result=Y)}if(G._status===1)return G._result.default;throw G._result}var re=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},ue={map:$,forEach:function(G,Y,ne){$(G,function(){Y.apply(this,arguments)},ne)},count:function(G){var Y=0;return $(G,function(){Y++}),Y},toArray:function(G){return $(G,function(Y){return Y})||[]},only:function(G){if(!B(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return ht.Activity=p,ht.Children=ue,ht.Component=T,ht.Fragment=t,ht.Profiler=i,ht.PureComponent=D,ht.StrictMode=r,ht.Suspense=u,ht.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ht.__COMPILER_RUNTIME={__proto__:null,c:function(G){return A.H.useMemoCache(G)}},ht.cache=function(G){return function(){return G.apply(null,arguments)}},ht.cacheSignal=function(){return null},ht.cloneElement=function(G,Y,ne){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var te=w({},G.props),ce=G.key;if(Y!=null)for(fe in Y.key!==void 0&&(ce=""+Y.key),Y)!I.call(Y,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&Y.ref===void 0||(te[fe]=Y[fe]);var fe=arguments.length-2;if(fe===1)te.children=ne;else if(1<fe){for(var ye=Array(fe),Ae=0;Ae<fe;Ae++)ye[Ae]=arguments[Ae+2];te.children=ye}return k(G.type,ce,te)},ht.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},ht.createElement=function(G,Y,ne){var te,ce={},fe=null;if(Y!=null)for(te in Y.key!==void 0&&(fe=""+Y.key),Y)I.call(Y,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(ce[te]=Y[te]);var ye=arguments.length-2;if(ye===1)ce.children=ne;else if(1<ye){for(var Ae=Array(ye),Pe=0;Pe<ye;Pe++)Ae[Pe]=arguments[Pe+2];ce.children=Ae}if(G&&G.defaultProps)for(te in ye=G.defaultProps,ye)ce[te]===void 0&&(ce[te]=ye[te]);return k(G,fe,ce)},ht.createRef=function(){return{current:null}},ht.forwardRef=function(G){return{$$typeof:c,render:G}},ht.isValidElement=B,ht.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:Q}},ht.memo=function(G,Y){return{$$typeof:d,type:G,compare:Y===void 0?null:Y}},ht.startTransition=function(G){var Y=A.T,ne={};A.T=ne;try{var te=G(),ce=A.S;ce!==null&&ce(ne,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(z,re)}catch(fe){re(fe)}finally{Y!==null&&ne.types!==null&&(Y.types=ne.types),A.T=Y}},ht.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ht.use=function(G){return A.H.use(G)},ht.useActionState=function(G,Y,ne){return A.H.useActionState(G,Y,ne)},ht.useCallback=function(G,Y){return A.H.useCallback(G,Y)},ht.useContext=function(G){return A.H.useContext(G)},ht.useDebugValue=function(){},ht.useDeferredValue=function(G,Y){return A.H.useDeferredValue(G,Y)},ht.useEffect=function(G,Y){return A.H.useEffect(G,Y)},ht.useEffectEvent=function(G){return A.H.useEffectEvent(G)},ht.useId=function(){return A.H.useId()},ht.useImperativeHandle=function(G,Y,ne){return A.H.useImperativeHandle(G,Y,ne)},ht.useInsertionEffect=function(G,Y){return A.H.useInsertionEffect(G,Y)},ht.useLayoutEffect=function(G,Y){return A.H.useLayoutEffect(G,Y)},ht.useMemo=function(G,Y){return A.H.useMemo(G,Y)},ht.useOptimistic=function(G,Y){return A.H.useOptimistic(G,Y)},ht.useReducer=function(G,Y,ne){return A.H.useReducer(G,Y,ne)},ht.useRef=function(G){return A.H.useRef(G)},ht.useState=function(G){return A.H.useState(G)},ht.useSyncExternalStore=function(G,Y,ne){return A.H.useSyncExternalStore(G,Y,ne)},ht.useTransition=function(){return A.H.useTransition()},ht.version="19.2.0",ht}var s2;function tw(){return s2||(s2=1,dx.exports=s6()),dx.exports}var U=tw();const xm=r6(U);var fx={exports:{}},Yf={},hx={exports:{}},px={};var o2;function o6(){return o2||(o2=1,(function(n){function e(H,$){var Q=H.length;H.push($);e:for(;0<Q;){var re=Q-1>>>1,ue=H[re];if(0<i(ue,$))H[re]=$,H[Q]=ue,Q=re;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var $=H[0],Q=H.pop();if(Q!==$){H[0]=Q;e:for(var re=0,ue=H.length,G=ue>>>1;re<G;){var Y=2*(re+1)-1,ne=H[Y],te=Y+1,ce=H[te];if(0>i(ne,Q))te<ue&&0>i(ce,ne)?(H[re]=ce,H[te]=Q,re=te):(H[re]=ne,H[Y]=Q,re=Y);else if(te<ue&&0>i(ce,Q))H[re]=ce,H[te]=Q,re=te;else break e}}return $}function i(H,$){var Q=H.sortIndex-$.sortIndex;return Q!==0?Q:H.id-$.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,m=3,b=!1,_=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function M(H){for(var $=t(d);$!==null;){if($.callback===null)r(d);else if($.startTime<=H)r(d),$.sortIndex=$.expirationTime,e(u,$);else break;$=t(d)}}function j(H){if(w=!1,M(H),!_)if(t(u)!==null)_=!0,z||(z=!0,L());else{var $=t(d);$!==null&&K(j,$.startTime-H)}}var z=!1,A=-1,I=5,k=-1;function V(){return S?!0:!(n.unstable_now()-k<I)}function B(){if(S=!1,z){var H=n.unstable_now();k=H;var $=!0;try{e:{_=!1,w&&(w=!1,C(A),A=-1),b=!0;var Q=m;try{t:{for(M(H),p=t(u);p!==null&&!(p.expirationTime>H&&V());){var re=p.callback;if(typeof re=="function"){p.callback=null,m=p.priorityLevel;var ue=re(p.expirationTime<=H);if(H=n.unstable_now(),typeof ue=="function"){p.callback=ue,M(H),$=!0;break t}p===t(u)&&r(u),M(H)}else r(u);p=t(u)}if(p!==null)$=!0;else{var G=t(d);G!==null&&K(j,G.startTime-H),$=!1}}break e}finally{p=null,m=Q,b=!1}$=void 0}}finally{$?L():z=!1}}}var L;if(typeof D=="function")L=function(){D(B)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,Z=P.port2;P.port1.onmessage=B,L=function(){Z.postMessage(null)}}else L=function(){T(B,0)};function K(H,$){A=T(function(){H(n.unstable_now())},$)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(H){switch(m){case 1:case 2:case 3:var $=3;break;default:$=m}var Q=m;m=$;try{return H()}finally{m=Q}},n.unstable_requestPaint=function(){S=!0},n.unstable_runWithPriority=function(H,$){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var Q=m;m=H;try{return $()}finally{m=Q}},n.unstable_scheduleCallback=function(H,$,Q){var re=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?re+Q:re):Q=re,H){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=Q+ue,H={id:h++,callback:$,priorityLevel:H,startTime:Q,expirationTime:ue,sortIndex:-1},Q>re?(H.sortIndex=Q,e(d,H),t(u)===null&&H===t(d)&&(w?(C(A),A=-1):w=!0,K(j,Q-re))):(H.sortIndex=ue,e(u,H),_||b||(_=!0,z||(z=!0,L()))),H},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(H){var $=m;return function(){var Q=m;m=$;try{return H.apply(this,arguments)}finally{m=Q}}}})(px)),px}var l2;function l6(){return l2||(l2=1,hx.exports=o6()),hx.exports}var gx={exports:{}},Er={};var c2;function c6(){if(c2)return Er;c2=1;var n=tw();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,d,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:d,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Er.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Er.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(u,d,null,h)},Er.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},Er.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Er.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Er.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:b}):h==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Er.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Er.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,p=c(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Er.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Er.requestFormReset=function(u){r.d.r(u)},Er.unstable_batchedUpdates=function(u,d){return u(d)},Er.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},Er.useFormStatus=function(){return o.H.useHostTransitionStatus()},Er.version="19.2.0",Er}var u2;function u6(){if(u2)return gx.exports;u2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gx.exports=c6(),gx.exports}var d2;function d6(){if(d2)return Yf;d2=1;var n=l6(),e=tw(),t=u6();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(a(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,g=l;;){var x=f.return;if(x===null)break;var E=x.alternate;if(E===null){if(g=x.return,g!==null){f=g;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===f)return u(x),s;if(E===g)return u(x),l;E=E.sibling}throw Error(r(188))}if(f.return!==g.return)f=x,g=E;else{for(var N=!1,F=x.child;F;){if(F===f){N=!0,f=x,g=E;break}if(F===g){N=!0,g=x,f=E;break}F=F.sibling}if(!N){for(F=E.child;F;){if(F===f){N=!0,f=E,g=x;break}if(F===g){N=!0,g=E,f=x;break}F=F.sibling}if(!N)throw Error(r(189))}}if(f.alternate!==g)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),D=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function L(s){return s===null||typeof s!="object"?null:(s=B&&s[B]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function Z(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case j:return"Suspense";case z:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case D:return s.displayName||"Context";case C:return(s._context.displayName||"Context")+".Consumer";case M:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:Z(s.type)||"Memo";case I:l=s._payload,s=s._init;try{return Z(s(l))}catch{}}return null}var K=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},re=[],ue=-1;function G(s){return{current:s}}function Y(s){0>ue||(s.current=re[ue],re[ue]=null,ue--)}function ne(s,l){ue++,re[ue]=s.current,s.current=l}var te=G(null),ce=G(null),fe=G(null),ye=G(null);function Ae(s,l){switch(ne(fe,l),ne(ce,s),ne(te,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?AC(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=AC(l),s=CC(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Y(te),ne(te,s)}function Pe(){Y(te),Y(ce),Y(fe)}function Se(s){s.memoizedState!==null&&ne(ye,s);var l=te.current,f=CC(l,s.type);l!==f&&(ne(ce,s),ne(te,f))}function we(s){ce.current===s&&(Y(te),Y(ce)),ye.current===s&&(Y(ye),Ff._currentValue=Q)}var ke,nt;function Ue(s){if(ke===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);ke=l&&l[1]||"",nt=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ke+s+nt}var Ee=!1;function Ne(s,l){if(!s||Ee)return"";Ee=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(pe){var de=pe}Reflect.construct(s,[],be)}else{try{be.call()}catch(pe){de=pe}s.call(be.prototype)}}else{try{throw Error()}catch(pe){de=pe}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(pe){if(pe&&de&&typeof pe.stack=="string")return[pe.stack,de.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=g.DetermineComponentFrameRoot(),N=E[0],F=E[1];if(N&&F){var X=N.split(`
`),le=F.split(`
`);for(x=g=0;g<X.length&&!X[g].includes("DetermineComponentFrameRoot");)g++;for(;x<le.length&&!le[x].includes("DetermineComponentFrameRoot");)x++;if(g===X.length||x===le.length)for(g=X.length-1,x=le.length-1;1<=g&&0<=x&&X[g]!==le[x];)x--;for(;1<=g&&0<=x;g--,x--)if(X[g]!==le[x]){if(g!==1||x!==1)do if(g--,x--,0>x||X[g]!==le[x]){var me=`
`+X[g].replace(" at new "," at ");return s.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",s.displayName)),me}while(1<=g&&0<=x);break}}}finally{Ee=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Ue(f):""}function Je(s,l){switch(s.tag){case 26:case 27:case 5:return Ue(s.type);case 16:return Ue("Lazy");case 13:return s.child!==l&&l!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return Ne(s.type,!1);case 11:return Ne(s.type.render,!1);case 1:return Ne(s.type,!0);case 31:return Ue("Activity");default:return""}}function rt(s){try{var l="",f=null;do l+=Je(s,f),f=s,s=s.return;while(s);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var De=Object.prototype.hasOwnProperty,je=n.unstable_scheduleCallback,We=n.unstable_cancelCallback,tn=n.unstable_shouldYield,Yt=n.unstable_requestPaint,st=n.unstable_now,at=n.unstable_getCurrentPriorityLevel,Kt=n.unstable_ImmediatePriority,Vn=n.unstable_UserBlockingPriority,ii=n.unstable_NormalPriority,Qs=n.unstable_LowPriority,Zs=n.unstable_IdlePriority,Yi=n.log,ya=n.unstable_setDisableYieldValue,Nr=null,_n=null;function ze(s){if(typeof Yi=="function"&&ya(s),_n&&typeof _n.setStrictMode=="function")try{_n.setStrictMode(Nr,s)}catch{}}var Oe=Math.clz32?Math.clz32:At,ur=Math.log,pt=Math.LN2;function At(s){return s>>>=0,s===0?32:31-(ur(s)/pt|0)|0}var lt=256,Et=262144,qe=4194304;function kt(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ct(s,l,f){var g=s.pendingLanes;if(g===0)return 0;var x=0,E=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var F=g&134217727;return F!==0?(g=F&~E,g!==0?x=kt(g):(N&=F,N!==0?x=kt(N):f||(f=F&~s,f!==0&&(x=kt(f))))):(F=g&~E,F!==0?x=kt(F):N!==0?x=kt(N):f||(f=g&~s,f!==0&&(x=kt(f)))),x===0?0:l!==0&&l!==x&&(l&E)===0&&(E=x&-x,f=l&-l,E>=f||E===32&&(f&4194048)!==0)?l:x}function Nt(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function nn(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wn(){var s=qe;return qe<<=1,(qe&62914560)===0&&(qe=4194304),s}function gt(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function rn(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function dr(s,l,f,g,x,E){var N=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var F=s.entanglements,X=s.expirationTimes,le=s.hiddenUpdates;for(f=N&~f;0<f;){var me=31-Oe(f),be=1<<me;F[me]=0,X[me]=-1;var de=le[me];if(de!==null)for(le[me]=null,me=0;me<de.length;me++){var pe=de[me];pe!==null&&(pe.lane&=-536870913)}f&=~be}g!==0&&ai(s,g,0),E!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=E&~(N&~l))}function ai(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var g=31-Oe(l);s.entangledLanes|=l,s.entanglements[g]=s.entanglements[g]|1073741824|f&261930}function Mr(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var g=31-Oe(f),x=1<<g;x&l|s[g]&l&&(s[g]|=l),f&=~x}}function si(s,l){var f=l&-l;return f=(f&42)!==0?1:fr(f),(f&(s.suspendedLanes|l))!==0?0:f}function fr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ss(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Zp(){var s=$.p;return s!==0?s:(s=window.event,s===void 0?32:WC(s.type))}function Ki(s,l){var f=$.p;try{return $.p=s,l()}finally{$.p=f}}var Xi=Math.random().toString(36).slice(2),jn="__reactFiber$"+Xi,sr="__reactProps$"+Xi,ba="__reactContainer$"+Xi,Uc="__reactEvents$"+Xi,my="__reactListeners$"+Xi,Jp="__reactHandles$"+Xi,eg="__reactResources$"+Xi,xa="__reactMarker$"+Xi;function Fc(s){delete s[jn],delete s[sr],delete s[Uc],delete s[my],delete s[Jp]}function _a(s){var l=s[jn];if(l)return l;for(var f=s.parentNode;f;){if(l=f[ba]||f[jn]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=PC(s);s!==null;){if(f=s[jn])return f;s=PC(s)}return l}s=f,f=s.parentNode}return null}function xi(s){if(s=s[jn]||s[ba]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function oi(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function wa(s){var l=s[eg];return l||(l=s[eg]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function zn(s){s[xa]=!0}var Kd=new Set,Xd={};function Ea(s,l){Sa(s,l),Sa(s+"Capture",l)}function Sa(s,l){for(Xd[s]=l,s=0;s<l.length;s++)Kd.add(l[s])}var Wd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qd={},Zd={};function tg(s){return De.call(Zd,s)?!0:De.call(Qd,s)?!1:Wd.test(s)?Zd[s]=!0:(Qd[s]=!0,!1)}function Gc(s,l,f){if(tg(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function li(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function Ln(s,l,f,g){if(g===null)s.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+g)}}function or(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Js(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Jd(s,l,f){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var x=g.get,E=g.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(N){f=""+N,E.call(this,N)}}),Object.defineProperty(s,l,{enumerable:g.enumerable}),{getValue:function(){return f},setValue:function(N){f=""+N},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Ft(s){if(!s._valueTracker){var l=Js(s)?"checked":"value";s._valueTracker=Jd(s,l,""+s[l])}}function xl(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return s&&(g=Js(s)?s.checked?"true":"false":s.value),s=g,s!==f?(l.setValue(s),!0):!1}function Ta(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var _l=/[\n"\\]/g;function Gr(s){return s.replace(_l,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function qc(s,l,f,g,x,E,N,F){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),l!=null?N==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+or(l)):s.value!==""+or(l)&&(s.value=""+or(l)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),l!=null?ef(s,N,or(l)):f!=null?ef(s,N,or(f)):g!=null&&s.removeAttribute("value"),x==null&&E!=null&&(s.defaultChecked=!!E),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+or(F):s.removeAttribute("name")}function ng(s,l,f,g,x,E,N,F){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){Ft(s);return}f=f!=null?""+or(f):"",l=l!=null?""+or(l):f,F||l===s.value||(s.value=l),s.defaultValue=l}g=g??x,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=F?s.checked:!!g,s.defaultChecked=!!g,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),Ft(s)}function ef(s,l,f){l==="number"&&Ta(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function eo(s,l,f,g){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&g&&(s[f].defaultSelected=!0)}else{for(f=""+or(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,g&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function rg(s,l,f){if(l!=null&&(l=""+or(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+or(f):""}function to(s,l,f,g){if(l==null){if(g!=null){if(f!=null)throw Error(r(92));if(K(g)){if(1<g.length)throw Error(r(93));g=g[0]}f=g}f==null&&(f=""),l=f}f=or(l),s.defaultValue=f,g=s.textContent,g===f&&g!==""&&g!==null&&(s.value=g),Ft(s)}function qr(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var ig=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tf(s,l,f){var g=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":g?s.setProperty(l,f):typeof f!="number"||f===0||ig.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function nf(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var x in l)g=l[x],l.hasOwnProperty(x)&&f[x]!==g&&tf(s,x,g)}else for(var E in l)l.hasOwnProperty(E)&&tf(s,E,l[E])}function Hc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ag=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),no=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $c(s){return no.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Wi(){}var rf=null;function _i(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ro=null,Aa=null;function wl(s){var l=xi(s);if(l&&(s=l.stateNode)){var f=s[sr]||null;e:switch(s=l.stateNode,l.type){case"input":if(qc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Gr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==s&&g.form===s.form){var x=g[sr]||null;if(!x)throw Error(r(90));qc(g,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<f.length;l++)g=f[l],g.form===s.form&&xl(g)}break e;case"textarea":rg(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&eo(s,!!f.multiple,l,!1)}}}var Yc=!1;function io(s,l,f){if(Yc)return s(l,f);Yc=!0;try{var g=s(l);return g}finally{if(Yc=!1,(ro!==null||Aa!==null)&&(Zg(),ro&&(l=ro,s=Aa,Aa=ro=null,wl(l),s)))for(l=0;l<s.length;l++)wl(s[l])}}function Qi(s,l){var f=s.stateNode;if(f===null)return null;var g=f[sr]||null;if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),El=!1;if(wi)try{var Xt={};Object.defineProperty(Xt,"passive",{get:function(){El=!0}}),window.addEventListener("test",Xt,Xt),window.removeEventListener("test",Xt,Xt)}catch{El=!1}var Ca=null,af=null,Sl=null;function sf(){if(Sl)return Sl;var s,l=af,f=l.length,g,x="value"in Ca?Ca.value:Ca.textContent,E=x.length;for(s=0;s<f&&l[s]===x[s];s++);var N=f-s;for(g=1;g<=N&&l[f-g]===x[E-g];g++);return Sl=x.slice(s,1<g?1-g:void 0)}function Tl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function os(){return!0}function Zi(){return!1}function hr(s){function l(f,g,x,E,N){this._reactName=f,this._targetInst=x,this.type=g,this.nativeEvent=E,this.target=N,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(f=s[F],this[F]=f?f(E):E[F]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?os:Zi,this.isPropagationStopped=Zi,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=os)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=os)},persist:function(){},isPersistent:os}),l}var ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ia=hr(ls),ao=p({},ls,{view:0,detail:0}),of=hr(ao),so,Kc,Ra,Xc=p({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ra&&(Ra&&s.type==="mousemove"?(so=s.screenX-Ra.screenX,Kc=s.screenY-Ra.screenY):Kc=so=0,Ra=s),so)},movementY:function(s){return"movementY"in s?s.movementY:Kc}}),lf=hr(Xc),Al=p({},Xc,{dataTransfer:0}),sg=hr(Al),og=p({},ao,{relatedTarget:0}),Cl=hr(og),cf=p({},ls,{animationName:0,elapsedTime:0,pseudoElement:0}),lg=hr(cf),Wc=p({},ls,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),cg=hr(Wc),ug=p({},ls,{data:0}),Da=hr(ug),dg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pg(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=hg[s])?!!l[s]:!1}function oo(){return pg}var Pr=p({},ao,{key:function(s){if(s.key){var l=dg[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Tl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?fg[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oo,charCode:function(s){return s.type==="keypress"?Tl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Tl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),gg=hr(Pr),mg=p({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cs=hr(mg),y=p({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oo}),R=hr(y),O=p({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=hr(O),se=p({},Xc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),he=hr(se),Re=p({},ls,{newState:0,oldState:0}),mt=hr(Re),Rn=[9,13,27,32],zt=wi&&"CompositionEvent"in window,dn=null;wi&&"documentMode"in document&&(dn=document.documentMode);var Ei=wi&&"TextEvent"in window&&!dn,ka=wi&&(!zt||dn&&8<dn&&11>=dn),Ji=" ",ea=!1;function Il(s,l){switch(s){case"keyup":return Rn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Zc=!1;function Cj(s,l){switch(s){case"compositionend":return Qc(l);case"keypress":return l.which!==32?null:(ea=!0,Ji);case"textInput":return s=l.data,s===Ji&&ea?null:s;default:return null}}function Ij(s,l){if(Zc)return s==="compositionend"||!zt&&Il(s,l)?(s=sf(),Sl=af=Ca=null,Zc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return ka&&l.locale!=="ko"?null:l.data;default:return null}}var Rj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!Rj[s.type]:l==="textarea"}function zS(s,l,f,g){ro?Aa?Aa.push(g):Aa=[g]:ro=g,l=am(l,"onChange"),0<l.length&&(f=new Ia("onChange","change",null,f,g),s.push({event:f,listeners:l}))}var uf=null,df=null;function Dj(s){xC(s,0)}function vg(s){var l=oi(s);if(xl(l))return s}function LS(s,l){if(s==="change")return l}var BS=!1;if(wi){var vy;if(wi){var yy="oninput"in document;if(!yy){var US=document.createElement("div");US.setAttribute("oninput","return;"),yy=typeof US.oninput=="function"}vy=yy}else vy=!1;BS=vy&&(!document.documentMode||9<document.documentMode)}function FS(){uf&&(uf.detachEvent("onpropertychange",GS),df=uf=null)}function GS(s){if(s.propertyName==="value"&&vg(df)){var l=[];zS(l,df,s,_i(s)),io(Dj,l)}}function kj(s,l,f){s==="focusin"?(FS(),uf=l,df=f,uf.attachEvent("onpropertychange",GS)):s==="focusout"&&FS()}function Nj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return vg(df)}function Mj(s,l){if(s==="click")return vg(l)}function Pj(s,l){if(s==="input"||s==="change")return vg(l)}function Oj(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ci=typeof Object.is=="function"?Object.is:Oj;function ff(s,l){if(ci(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var x=f[g];if(!De.call(l,x)||!ci(s[x],l[x]))return!1}return!0}function qS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function HS(s,l){var f=qS(s);s=0;for(var g;f;){if(f.nodeType===3){if(g=s+f.textContent.length,s<=l&&g>=l)return{node:f,offset:l-s};s=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=qS(f)}}function $S(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?$S(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function YS(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ta(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=Ta(s.document)}return l}function by(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var Vj=wi&&"documentMode"in document&&11>=document.documentMode,Jc=null,xy=null,hf=null,_y=!1;function KS(s,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;_y||Jc==null||Jc!==Ta(g)||(g=Jc,"selectionStart"in g&&by(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),hf&&ff(hf,g)||(hf=g,g=am(xy,"onSelect"),0<g.length&&(l=new Ia("onSelect","select",null,l,f),s.push({event:l,listeners:g}),l.target=Jc)))}function Rl(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var eu={animationend:Rl("Animation","AnimationEnd"),animationiteration:Rl("Animation","AnimationIteration"),animationstart:Rl("Animation","AnimationStart"),transitionrun:Rl("Transition","TransitionRun"),transitionstart:Rl("Transition","TransitionStart"),transitioncancel:Rl("Transition","TransitionCancel"),transitionend:Rl("Transition","TransitionEnd")},wy={},XS={};wi&&(XS=document.createElement("div").style,"AnimationEvent"in window||(delete eu.animationend.animation,delete eu.animationiteration.animation,delete eu.animationstart.animation),"TransitionEvent"in window||delete eu.transitionend.transition);function Dl(s){if(wy[s])return wy[s];if(!eu[s])return s;var l=eu[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in XS)return wy[s]=l[f];return s}var WS=Dl("animationend"),QS=Dl("animationiteration"),ZS=Dl("animationstart"),jj=Dl("transitionrun"),zj=Dl("transitionstart"),Lj=Dl("transitioncancel"),JS=Dl("transitionend"),eT=new Map,Ey="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ey.push("scrollEnd");function ta(s,l){eT.set(s,l),Ea(l,[s])}var yg=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Si=[],tu=0,Sy=0;function bg(){for(var s=tu,l=Sy=tu=0;l<s;){var f=Si[l];Si[l++]=null;var g=Si[l];Si[l++]=null;var x=Si[l];Si[l++]=null;var E=Si[l];if(Si[l++]=null,g!==null&&x!==null){var N=g.pending;N===null?x.next=x:(x.next=N.next,N.next=x),g.pending=x}E!==0&&tT(f,x,E)}}function xg(s,l,f,g){Si[tu++]=s,Si[tu++]=l,Si[tu++]=f,Si[tu++]=g,Sy|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function Ty(s,l,f,g){return xg(s,l,f,g),_g(s)}function kl(s,l){return xg(s,null,null,l),_g(s)}function tT(s,l,f){s.lanes|=f;var g=s.alternate;g!==null&&(g.lanes|=f);for(var x=!1,E=s.return;E!==null;)E.childLanes|=f,g=E.alternate,g!==null&&(g.childLanes|=f),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(x=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,x&&l!==null&&(x=31-Oe(f),s=E.hiddenUpdates,g=s[x],g===null?s[x]=[l]:g.push(l),l.lane=f|536870912),E):null}function _g(s){if(50<Of)throw Of=0,Pb=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var nu={};function Bj(s,l,f,g){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(s,l,f,g){return new Bj(s,l,f,g)}function Ay(s){return s=s.prototype,!(!s||!s.isReactComponent)}function us(s,l){var f=s.alternate;return f===null?(f=ui(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function nT(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function wg(s,l,f,g,x,E){var N=0;if(g=s,typeof s=="function")Ay(s)&&(N=1);else if(typeof s=="string")N=H5(s,f,te.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=ui(31,f,l,x),s.elementType=k,s.lanes=E,s;case w:return Nl(f.children,x,E,l);case S:N=8,x|=24;break;case T:return s=ui(12,f,l,x|2),s.elementType=T,s.lanes=E,s;case j:return s=ui(13,f,l,x),s.elementType=j,s.lanes=E,s;case z:return s=ui(19,f,l,x),s.elementType=z,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:N=10;break e;case C:N=9;break e;case M:N=11;break e;case A:N=14;break e;case I:N=16,g=null;break e}N=29,f=Error(r(130,s===null?"null":typeof s,"")),g=null}return l=ui(N,f,l,x),l.elementType=s,l.type=g,l.lanes=E,l}function Nl(s,l,f,g){return s=ui(7,s,g,l),s.lanes=f,s}function Cy(s,l,f){return s=ui(6,s,null,l),s.lanes=f,s}function rT(s){var l=ui(18,null,null,0);return l.stateNode=s,l}function Iy(s,l,f){return l=ui(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var iT=new WeakMap;function Ti(s,l){if(typeof s=="object"&&s!==null){var f=iT.get(s);return f!==void 0?f:(l={value:s,source:l,stack:rt(l)},iT.set(s,l),l)}return{value:s,source:l,stack:rt(l)}}var ru=[],iu=0,Eg=null,pf=0,Ai=[],Ci=0,lo=null,Na=1,Ma="";function ds(s,l){ru[iu++]=pf,ru[iu++]=Eg,Eg=s,pf=l}function aT(s,l,f){Ai[Ci++]=Na,Ai[Ci++]=Ma,Ai[Ci++]=lo,lo=s;var g=Na;s=Ma;var x=32-Oe(g)-1;g&=~(1<<x),f+=1;var E=32-Oe(l)+x;if(30<E){var N=x-x%5;E=(g&(1<<N)-1).toString(32),g>>=N,x-=N,Na=1<<32-Oe(l)+x|f<<x|g,Ma=E+s}else Na=1<<E|f<<x|g,Ma=s}function Ry(s){s.return!==null&&(ds(s,1),aT(s,1,0))}function Dy(s){for(;s===Eg;)Eg=ru[--iu],ru[iu]=null,pf=ru[--iu],ru[iu]=null;for(;s===lo;)lo=Ai[--Ci],Ai[Ci]=null,Ma=Ai[--Ci],Ai[Ci]=null,Na=Ai[--Ci],Ai[Ci]=null}function sT(s,l){Ai[Ci++]=Na,Ai[Ci++]=Ma,Ai[Ci++]=lo,Na=l.id,Ma=l.overflow,lo=s}var pr=null,on=null,Mt=!1,co=null,Ii=!1,ky=Error(r(519));function uo(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gf(Ti(l,s)),ky}function oT(s){var l=s.stateNode,f=s.type,g=s.memoizedProps;switch(l[jn]=s,l[sr]=g,f){case"dialog":Tt("cancel",l),Tt("close",l);break;case"iframe":case"object":case"embed":Tt("load",l);break;case"video":case"audio":for(f=0;f<jf.length;f++)Tt(jf[f],l);break;case"source":Tt("error",l);break;case"img":case"image":case"link":Tt("error",l),Tt("load",l);break;case"details":Tt("toggle",l);break;case"input":Tt("invalid",l),ng(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Tt("invalid",l);break;case"textarea":Tt("invalid",l),to(l,g.value,g.defaultValue,g.children)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||g.suppressHydrationWarning===!0||SC(l.textContent,f)?(g.popover!=null&&(Tt("beforetoggle",l),Tt("toggle",l)),g.onScroll!=null&&Tt("scroll",l),g.onScrollEnd!=null&&Tt("scrollend",l),g.onClick!=null&&(l.onclick=Wi),l=!0):l=!1,l||uo(s,!0)}function lT(s){for(pr=s.return;pr;)switch(pr.tag){case 5:case 31:case 13:Ii=!1;return;case 27:case 3:Ii=!0;return;default:pr=pr.return}}function au(s){if(s!==pr)return!1;if(!Mt)return lT(s),Mt=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Xb(s.type,s.memoizedProps)),f=!f),f&&on&&uo(s),lT(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));on=MC(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));on=MC(s)}else l===27?(l=on,To(s.type)?(s=ex,ex=null,on=s):on=l):on=pr?Di(s.stateNode.nextSibling):null;return!0}function Ml(){on=pr=null,Mt=!1}function Ny(){var s=co;return s!==null&&(Kr===null?Kr=s:Kr.push.apply(Kr,s),co=null),s}function gf(s){co===null?co=[s]:co.push(s)}var My=G(null),Pl=null,fs=null;function fo(s,l,f){ne(My,l._currentValue),l._currentValue=f}function hs(s){s._currentValue=My.current,Y(My)}function Py(s,l,f){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===f)break;s=s.return}}function Oy(s,l,f,g){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var E=x.dependencies;if(E!==null){var N=x.child;E=E.firstContext;e:for(;E!==null;){var F=E;E=x;for(var X=0;X<l.length;X++)if(F.context===l[X]){E.lanes|=f,F=E.alternate,F!==null&&(F.lanes|=f),Py(E.return,f,s),g||(N=null);break e}E=F.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(r(341));N.lanes|=f,E=N.alternate,E!==null&&(E.lanes|=f),Py(N,f,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function su(s,l,f,g){s=null;for(var x=l,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var F=x.type;ci(x.pendingProps.value,N.value)||(s!==null?s.push(F):s=[F])}}else if(x===ye.current){if(N=x.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Ff):s=[Ff])}x=x.return}s!==null&&Oy(l,s,f,g),l.flags|=262144}function Sg(s){for(s=s.firstContext;s!==null;){if(!ci(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ol(s){Pl=s,fs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function gr(s){return cT(Pl,s)}function Tg(s,l){return Pl===null&&Ol(s),cT(s,l)}function cT(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},fs===null){if(s===null)throw Error(r(308));fs=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else fs=fs.next=l;return f}var Uj=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,g){s.push(g)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},Fj=n.unstable_scheduleCallback,Gj=n.unstable_NormalPriority,Bn={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vy(){return{controller:new Uj,data:new Map,refCount:0}}function mf(s){s.refCount--,s.refCount===0&&Fj(Gj,function(){s.controller.abort()})}var vf=null,jy=0,ou=0,lu=null;function qj(s,l){if(vf===null){var f=vf=[];jy=0,ou=Bb(),lu={status:"pending",value:void 0,then:function(g){f.push(g)}}}return jy++,l.then(uT,uT),l}function uT(){if(--jy===0&&vf!==null){lu!==null&&(lu.status="fulfilled");var s=vf;vf=null,ou=0,lu=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function Hj(s,l){var f=[],g={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return s.then(function(){g.status="fulfilled",g.value=l;for(var x=0;x<f.length;x++)(0,f[x])(l)},function(x){for(g.status="rejected",g.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),g}var dT=H.S;H.S=function(s,l){KA=st(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&qj(s,l),dT!==null&&dT(s,l)};var Vl=G(null);function zy(){var s=Vl.current;return s!==null?s:an.pooledCache}function Ag(s,l){l===null?ne(Vl,Vl.current):ne(Vl,l.pool)}function fT(){var s=zy();return s===null?null:{parent:Bn._currentValue,pool:s}}var cu=Error(r(460)),Ly=Error(r(474)),Cg=Error(r(542)),Ig={then:function(){}};function hT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function pT(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Wi,Wi),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,mT(s),s;default:if(typeof l.status=="string")l.then(Wi,Wi);else{if(s=an,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(g){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=g}},function(g){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,mT(s),s}throw zl=l,cu}}function jl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(zl=f,cu):f}}var zl=null;function gT(){if(zl===null)throw Error(r(459));var s=zl;return zl=null,s}function mT(s){if(s===cu||s===Cg)throw Error(r(483))}var uu=null,yf=0;function Rg(s){var l=yf;return yf+=1,uu===null&&(uu=[]),pT(uu,s,l)}function bf(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Dg(s,l){throw l.$$typeof===m?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function vT(s){function l(ie,ee){if(s){var oe=ie.deletions;oe===null?(ie.deletions=[ee],ie.flags|=16):oe.push(ee)}}function f(ie,ee){if(!s)return null;for(;ee!==null;)l(ie,ee),ee=ee.sibling;return null}function g(ie){for(var ee=new Map;ie!==null;)ie.key!==null?ee.set(ie.key,ie):ee.set(ie.index,ie),ie=ie.sibling;return ee}function x(ie,ee){return ie=us(ie,ee),ie.index=0,ie.sibling=null,ie}function E(ie,ee,oe){return ie.index=oe,s?(oe=ie.alternate,oe!==null?(oe=oe.index,oe<ee?(ie.flags|=67108866,ee):oe):(ie.flags|=67108866,ee)):(ie.flags|=1048576,ee)}function N(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function F(ie,ee,oe,ve){return ee===null||ee.tag!==6?(ee=Cy(oe,ie.mode,ve),ee.return=ie,ee):(ee=x(ee,oe),ee.return=ie,ee)}function X(ie,ee,oe,ve){var Ye=oe.type;return Ye===w?me(ie,ee,oe.props.children,ve,oe.key):ee!==null&&(ee.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&jl(Ye)===ee.type)?(ee=x(ee,oe.props),bf(ee,oe),ee.return=ie,ee):(ee=wg(oe.type,oe.key,oe.props,null,ie.mode,ve),bf(ee,oe),ee.return=ie,ee)}function le(ie,ee,oe,ve){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=Iy(oe,ie.mode,ve),ee.return=ie,ee):(ee=x(ee,oe.children||[]),ee.return=ie,ee)}function me(ie,ee,oe,ve,Ye){return ee===null||ee.tag!==7?(ee=Nl(oe,ie.mode,ve,Ye),ee.return=ie,ee):(ee=x(ee,oe),ee.return=ie,ee)}function be(ie,ee,oe){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=Cy(""+ee,ie.mode,oe),ee.return=ie,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case b:return oe=wg(ee.type,ee.key,ee.props,null,ie.mode,oe),bf(oe,ee),oe.return=ie,oe;case _:return ee=Iy(ee,ie.mode,oe),ee.return=ie,ee;case I:return ee=jl(ee),be(ie,ee,oe)}if(K(ee)||L(ee))return ee=Nl(ee,ie.mode,oe,null),ee.return=ie,ee;if(typeof ee.then=="function")return be(ie,Rg(ee),oe);if(ee.$$typeof===D)return be(ie,Tg(ie,ee),oe);Dg(ie,ee)}return null}function de(ie,ee,oe,ve){var Ye=ee!==null?ee.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Ye!==null?null:F(ie,ee,""+oe,ve);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case b:return oe.key===Ye?X(ie,ee,oe,ve):null;case _:return oe.key===Ye?le(ie,ee,oe,ve):null;case I:return oe=jl(oe),de(ie,ee,oe,ve)}if(K(oe)||L(oe))return Ye!==null?null:me(ie,ee,oe,ve,null);if(typeof oe.then=="function")return de(ie,ee,Rg(oe),ve);if(oe.$$typeof===D)return de(ie,ee,Tg(ie,oe),ve);Dg(ie,oe)}return null}function pe(ie,ee,oe,ve,Ye){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return ie=ie.get(oe)||null,F(ee,ie,""+ve,Ye);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case b:return ie=ie.get(ve.key===null?oe:ve.key)||null,X(ee,ie,ve,Ye);case _:return ie=ie.get(ve.key===null?oe:ve.key)||null,le(ee,ie,ve,Ye);case I:return ve=jl(ve),pe(ie,ee,oe,ve,Ye)}if(K(ve)||L(ve))return ie=ie.get(oe)||null,me(ee,ie,ve,Ye,null);if(typeof ve.then=="function")return pe(ie,ee,oe,Rg(ve),Ye);if(ve.$$typeof===D)return pe(ie,ee,oe,Tg(ee,ve),Ye);Dg(ee,ve)}return null}function Le(ie,ee,oe,ve){for(var Ye=null,Vt=null,Fe=ee,bt=ee=0,It=null;Fe!==null&&bt<oe.length;bt++){Fe.index>bt?(It=Fe,Fe=null):It=Fe.sibling;var jt=de(ie,Fe,oe[bt],ve);if(jt===null){Fe===null&&(Fe=It);break}s&&Fe&&jt.alternate===null&&l(ie,Fe),ee=E(jt,ee,bt),Vt===null?Ye=jt:Vt.sibling=jt,Vt=jt,Fe=It}if(bt===oe.length)return f(ie,Fe),Mt&&ds(ie,bt),Ye;if(Fe===null){for(;bt<oe.length;bt++)Fe=be(ie,oe[bt],ve),Fe!==null&&(ee=E(Fe,ee,bt),Vt===null?Ye=Fe:Vt.sibling=Fe,Vt=Fe);return Mt&&ds(ie,bt),Ye}for(Fe=g(Fe);bt<oe.length;bt++)It=pe(Fe,ie,bt,oe[bt],ve),It!==null&&(s&&It.alternate!==null&&Fe.delete(It.key===null?bt:It.key),ee=E(It,ee,bt),Vt===null?Ye=It:Vt.sibling=It,Vt=It);return s&&Fe.forEach(function(Do){return l(ie,Do)}),Mt&&ds(ie,bt),Ye}function Qe(ie,ee,oe,ve){if(oe==null)throw Error(r(151));for(var Ye=null,Vt=null,Fe=ee,bt=ee=0,It=null,jt=oe.next();Fe!==null&&!jt.done;bt++,jt=oe.next()){Fe.index>bt?(It=Fe,Fe=null):It=Fe.sibling;var Do=de(ie,Fe,jt.value,ve);if(Do===null){Fe===null&&(Fe=It);break}s&&Fe&&Do.alternate===null&&l(ie,Fe),ee=E(Do,ee,bt),Vt===null?Ye=Do:Vt.sibling=Do,Vt=Do,Fe=It}if(jt.done)return f(ie,Fe),Mt&&ds(ie,bt),Ye;if(Fe===null){for(;!jt.done;bt++,jt=oe.next())jt=be(ie,jt.value,ve),jt!==null&&(ee=E(jt,ee,bt),Vt===null?Ye=jt:Vt.sibling=jt,Vt=jt);return Mt&&ds(ie,bt),Ye}for(Fe=g(Fe);!jt.done;bt++,jt=oe.next())jt=pe(Fe,ie,bt,jt.value,ve),jt!==null&&(s&&jt.alternate!==null&&Fe.delete(jt.key===null?bt:jt.key),ee=E(jt,ee,bt),Vt===null?Ye=jt:Vt.sibling=jt,Vt=jt);return s&&Fe.forEach(function(n6){return l(ie,n6)}),Mt&&ds(ie,bt),Ye}function Zt(ie,ee,oe,ve){if(typeof oe=="object"&&oe!==null&&oe.type===w&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case b:e:{for(var Ye=oe.key;ee!==null;){if(ee.key===Ye){if(Ye=oe.type,Ye===w){if(ee.tag===7){f(ie,ee.sibling),ve=x(ee,oe.props.children),ve.return=ie,ie=ve;break e}}else if(ee.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===I&&jl(Ye)===ee.type){f(ie,ee.sibling),ve=x(ee,oe.props),bf(ve,oe),ve.return=ie,ie=ve;break e}f(ie,ee);break}else l(ie,ee);ee=ee.sibling}oe.type===w?(ve=Nl(oe.props.children,ie.mode,ve,oe.key),ve.return=ie,ie=ve):(ve=wg(oe.type,oe.key,oe.props,null,ie.mode,ve),bf(ve,oe),ve.return=ie,ie=ve)}return N(ie);case _:e:{for(Ye=oe.key;ee!==null;){if(ee.key===Ye)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){f(ie,ee.sibling),ve=x(ee,oe.children||[]),ve.return=ie,ie=ve;break e}else{f(ie,ee);break}else l(ie,ee);ee=ee.sibling}ve=Iy(oe,ie.mode,ve),ve.return=ie,ie=ve}return N(ie);case I:return oe=jl(oe),Zt(ie,ee,oe,ve)}if(K(oe))return Le(ie,ee,oe,ve);if(L(oe)){if(Ye=L(oe),typeof Ye!="function")throw Error(r(150));return oe=Ye.call(oe),Qe(ie,ee,oe,ve)}if(typeof oe.then=="function")return Zt(ie,ee,Rg(oe),ve);if(oe.$$typeof===D)return Zt(ie,ee,Tg(ie,oe),ve);Dg(ie,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ee!==null&&ee.tag===6?(f(ie,ee.sibling),ve=x(ee,oe),ve.return=ie,ie=ve):(f(ie,ee),ve=Cy(oe,ie.mode,ve),ve.return=ie,ie=ve),N(ie)):f(ie,ee)}return function(ie,ee,oe,ve){try{yf=0;var Ye=Zt(ie,ee,oe,ve);return uu=null,Ye}catch(Fe){if(Fe===cu||Fe===Cg)throw Fe;var Vt=ui(29,Fe,null,ie.mode);return Vt.lanes=ve,Vt.return=ie,Vt}finally{}}}var Ll=vT(!0),yT=vT(!1),ho=!1;function By(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uy(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function po(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function go(s,l,f){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(Lt&2)!==0){var x=g.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),g.pending=l,l=_g(s),tT(s,null,f),l}return xg(s,g,l,f),_g(s)}function xf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Mr(s,f)}}function Fy(s,l){var f=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var x=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var N={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?x=E=N:E=E.next=N,f=f.next}while(f!==null);E===null?x=E=l:E=E.next=l}else x=E=l;f={baseState:g.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:g.shared,callbacks:g.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Gy=!1;function _f(){if(Gy){var s=lu;if(s!==null)throw s}}function wf(s,l,f,g){Gy=!1;var x=s.updateQueue;ho=!1;var E=x.firstBaseUpdate,N=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var X=F,le=X.next;X.next=null,N===null?E=le:N.next=le,N=X;var me=s.alternate;me!==null&&(me=me.updateQueue,F=me.lastBaseUpdate,F!==N&&(F===null?me.firstBaseUpdate=le:F.next=le,me.lastBaseUpdate=X))}if(E!==null){var be=x.baseState;N=0,me=le=X=null,F=E;do{var de=F.lane&-536870913,pe=de!==F.lane;if(pe?(Ct&de)===de:(g&de)===de){de!==0&&de===ou&&(Gy=!0),me!==null&&(me=me.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var Le=s,Qe=F;de=l;var Zt=f;switch(Qe.tag){case 1:if(Le=Qe.payload,typeof Le=="function"){be=Le.call(Zt,be,de);break e}be=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Qe.payload,de=typeof Le=="function"?Le.call(Zt,be,de):Le,de==null)break e;be=p({},be,de);break e;case 2:ho=!0}}de=F.callback,de!==null&&(s.flags|=64,pe&&(s.flags|=8192),pe=x.callbacks,pe===null?x.callbacks=[de]:pe.push(de))}else pe={lane:de,tag:F.tag,payload:F.payload,callback:F.callback,next:null},me===null?(le=me=pe,X=be):me=me.next=pe,N|=de;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;pe=F,F=pe.next,pe.next=null,x.lastBaseUpdate=pe,x.shared.pending=null}}while(!0);me===null&&(X=be),x.baseState=X,x.firstBaseUpdate=le,x.lastBaseUpdate=me,E===null&&(x.shared.lanes=0),xo|=N,s.lanes=N,s.memoizedState=be}}function bT(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function xT(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)bT(f[s],l)}var du=G(null),kg=G(0);function _T(s,l){s=ws,ne(kg,s),ne(du,l),ws=s|l.baseLanes}function qy(){ne(kg,ws),ne(du,du.current)}function Hy(){ws=kg.current,Y(du),Y(kg)}var di=G(null),Ri=null;function mo(s){var l=s.alternate;ne(Dn,Dn.current&1),ne(di,s),Ri===null&&(l===null||du.current!==null||l.memoizedState!==null)&&(Ri=s)}function $y(s){ne(Dn,Dn.current),ne(di,s),Ri===null&&(Ri=s)}function wT(s){s.tag===22?(ne(Dn,Dn.current),ne(di,s),Ri===null&&(Ri=s)):vo()}function vo(){ne(Dn,Dn.current),ne(di,di.current)}function fi(s){Y(di),Ri===s&&(Ri=null),Y(Dn)}var Dn=G(0);function Ng(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Zb(f)||Jb(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ps=0,vt=null,Wt=null,Un=null,Mg=!1,fu=!1,Bl=!1,Pg=0,Ef=0,hu=null,$j=0;function En(){throw Error(r(321))}function Yy(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!ci(s[f],l[f]))return!1;return!0}function Ky(s,l,f,g,x,E){return ps=E,vt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,H.H=s===null||s.memoizedState===null?aA:cb,Bl=!1,E=f(g,x),Bl=!1,fu&&(E=ST(l,f,g,x)),ET(s),E}function ET(s){H.H=Af;var l=Wt!==null&&Wt.next!==null;if(ps=0,Un=Wt=vt=null,Mg=!1,Ef=0,hu=null,l)throw Error(r(300));s===null||Fn||(s=s.dependencies,s!==null&&Sg(s)&&(Fn=!0))}function ST(s,l,f,g){vt=s;var x=0;do{if(fu&&(hu=null),Ef=0,fu=!1,25<=x)throw Error(r(301));if(x+=1,Un=Wt=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}H.H=sA,E=l(f,g)}while(fu);return E}function Yj(){var s=H.H,l=s.useState()[0];return l=typeof l.then=="function"?Sf(l):l,s=s.useState()[0],(Wt!==null?Wt.memoizedState:null)!==s&&(vt.flags|=1024),l}function Xy(){var s=Pg!==0;return Pg=0,s}function Wy(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function Qy(s){if(Mg){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Mg=!1}ps=0,Un=Wt=vt=null,fu=!1,Ef=Pg=0,hu=null}function Or(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?vt.memoizedState=Un=s:Un=Un.next=s,Un}function kn(){if(Wt===null){var s=vt.alternate;s=s!==null?s.memoizedState:null}else s=Wt.next;var l=Un===null?vt.memoizedState:Un.next;if(l!==null)Un=l,Wt=s;else{if(s===null)throw vt.alternate===null?Error(r(467)):Error(r(310));Wt=s,s={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Un===null?vt.memoizedState=Un=s:Un=Un.next=s}return Un}function Og(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sf(s){var l=Ef;return Ef+=1,hu===null&&(hu=[]),s=pT(hu,s,l),l=vt,(Un===null?l.memoizedState:Un.next)===null&&(l=l.alternate,H.H=l===null||l.memoizedState===null?aA:cb),s}function Vg(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Sf(s);if(s.$$typeof===D)return gr(s)}throw Error(r(438,String(s)))}function Zy(s){var l=null,f=vt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var g=vt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Og(),vt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),g=0;g<s;g++)f[g]=V;return l.index++,f}function gs(s,l){return typeof l=="function"?l(s):l}function jg(s){var l=kn();return Jy(l,Wt,s)}function Jy(s,l,f){var g=s.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=f;var x=s.baseQueue,E=g.pending;if(E!==null){if(x!==null){var N=x.next;x.next=E.next,E.next=N}l.baseQueue=x=E,g.pending=null}if(E=s.baseState,x===null)s.memoizedState=E;else{l=x.next;var F=N=null,X=null,le=l,me=!1;do{var be=le.lane&-536870913;if(be!==le.lane?(Ct&be)===be:(ps&be)===be){var de=le.revertLane;if(de===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),be===ou&&(me=!0);else if((ps&de)===de){le=le.next,de===ou&&(me=!0);continue}else be={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},X===null?(F=X=be,N=E):X=X.next=be,vt.lanes|=de,xo|=de;be=le.action,Bl&&f(E,be),E=le.hasEagerState?le.eagerState:f(E,be)}else de={lane:be,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},X===null?(F=X=de,N=E):X=X.next=de,vt.lanes|=be,xo|=be;le=le.next}while(le!==null&&le!==l);if(X===null?N=E:X.next=F,!ci(E,s.memoizedState)&&(Fn=!0,me&&(f=lu,f!==null)))throw f;s.memoizedState=E,s.baseState=N,s.baseQueue=X,g.lastRenderedState=E}return x===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function eb(s){var l=kn(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var g=f.dispatch,x=f.pending,E=l.memoizedState;if(x!==null){f.pending=null;var N=x=x.next;do E=s(E,N.action),N=N.next;while(N!==x);ci(E,l.memoizedState)||(Fn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,g]}function TT(s,l,f){var g=vt,x=kn(),E=Mt;if(E){if(f===void 0)throw Error(r(407));f=f()}else f=l();var N=!ci((Wt||x).memoizedState,f);if(N&&(x.memoizedState=f,Fn=!0),x=x.queue,rb(IT.bind(null,g,x,s),[s]),x.getSnapshot!==l||N||Un!==null&&Un.memoizedState.tag&1){if(g.flags|=2048,pu(9,{destroy:void 0},CT.bind(null,g,x,f,l),null),an===null)throw Error(r(349));E||(ps&127)!==0||AT(g,l,f)}return f}function AT(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=vt.updateQueue,l===null?(l=Og(),vt.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function CT(s,l,f,g){l.value=f,l.getSnapshot=g,RT(l)&&DT(s)}function IT(s,l,f){return f(function(){RT(l)&&DT(s)})}function RT(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!ci(s,f)}catch{return!0}}function DT(s){var l=kl(s,2);l!==null&&Xr(l,s,2)}function tb(s){var l=Or();if(typeof s=="function"){var f=s;if(s=f(),Bl){ze(!0);try{f()}finally{ze(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:s},l}function kT(s,l,f,g){return s.baseState=f,Jy(s,Wt,typeof g=="function"?g:gs)}function Kj(s,l,f,g,x){if(Bg(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){E.listeners.push(N)}};H.T!==null?f(!0):E.isTransition=!1,g(E),f=l.pending,f===null?(E.next=l.pending=E,NT(l,E)):(E.next=f.next,l.pending=f.next=E)}}function NT(s,l){var f=l.action,g=l.payload,x=s.state;if(l.isTransition){var E=H.T,N={};H.T=N;try{var F=f(x,g),X=H.S;X!==null&&X(N,F),MT(s,l,F)}catch(le){nb(s,l,le)}finally{E!==null&&N.types!==null&&(E.types=N.types),H.T=E}}else try{E=f(x,g),MT(s,l,E)}catch(le){nb(s,l,le)}}function MT(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){PT(s,l,g)},function(g){return nb(s,l,g)}):PT(s,l,f)}function PT(s,l,f){l.status="fulfilled",l.value=f,OT(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,NT(s,f)))}function nb(s,l,f){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=f,OT(l),l=l.next;while(l!==g)}s.action=null}function OT(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function VT(s,l){return l}function jT(s,l){if(Mt){var f=an.formState;if(f!==null){e:{var g=vt;if(Mt){if(on){t:{for(var x=on,E=Ii;x.nodeType!==8;){if(!E){x=null;break t}if(x=Di(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){on=Di(x.nextSibling),g=x.data==="F!";break e}}uo(g)}g=!1}g&&(l=f[0])}}return f=Or(),f.memoizedState=f.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:VT,lastRenderedState:l},f.queue=g,f=nA.bind(null,vt,g),g.dispatch=f,g=tb(!1),E=lb.bind(null,vt,!1,g.queue),g=Or(),x={state:l,dispatch:null,action:s,pending:null},g.queue=x,f=Kj.bind(null,vt,x,E,f),x.dispatch=f,g.memoizedState=s,[l,f,!1]}function zT(s){var l=kn();return LT(l,Wt,s)}function LT(s,l,f){if(l=Jy(s,l,VT)[0],s=jg(gs)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=Sf(l)}catch(N){throw N===cu?Cg:N}else g=l;l=kn();var x=l.queue,E=x.dispatch;return f!==l.memoizedState&&(vt.flags|=2048,pu(9,{destroy:void 0},Xj.bind(null,x,f),null)),[g,E,s]}function Xj(s,l){s.action=l}function BT(s){var l=kn(),f=Wt;if(f!==null)return LT(l,f,s);kn(),l=l.memoizedState,f=kn();var g=f.queue.dispatch;return f.memoizedState=s,[l,g,!1]}function pu(s,l,f,g){return s={tag:s,create:f,deps:g,inst:l,next:null},l=vt.updateQueue,l===null&&(l=Og(),vt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(g=f.next,f.next=s,s.next=g,l.lastEffect=s),s}function UT(){return kn().memoizedState}function zg(s,l,f,g){var x=Or();vt.flags|=s,x.memoizedState=pu(1|l,{destroy:void 0},f,g===void 0?null:g)}function Lg(s,l,f,g){var x=kn();g=g===void 0?null:g;var E=x.memoizedState.inst;Wt!==null&&g!==null&&Yy(g,Wt.memoizedState.deps)?x.memoizedState=pu(l,E,f,g):(vt.flags|=s,x.memoizedState=pu(1|l,E,f,g))}function FT(s,l){zg(8390656,8,s,l)}function rb(s,l){Lg(2048,8,s,l)}function Wj(s){vt.flags|=4;var l=vt.updateQueue;if(l===null)l=Og(),vt.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function GT(s){var l=kn().memoizedState;return Wj({ref:l,nextImpl:s}),function(){if((Lt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function qT(s,l){return Lg(4,2,s,l)}function HT(s,l){return Lg(4,4,s,l)}function $T(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function YT(s,l,f){f=f!=null?f.concat([s]):null,Lg(4,4,$T.bind(null,l,s),f)}function ib(){}function KT(s,l){var f=kn();l=l===void 0?null:l;var g=f.memoizedState;return l!==null&&Yy(l,g[1])?g[0]:(f.memoizedState=[s,l],s)}function XT(s,l){var f=kn();l=l===void 0?null:l;var g=f.memoizedState;if(l!==null&&Yy(l,g[1]))return g[0];if(g=s(),Bl){ze(!0);try{s()}finally{ze(!1)}}return f.memoizedState=[g,l],g}function ab(s,l,f){return f===void 0||(ps&1073741824)!==0&&(Ct&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=WA(),vt.lanes|=s,xo|=s,f)}function WT(s,l,f,g){return ci(f,l)?f:du.current!==null?(s=ab(s,f,g),ci(s,l)||(Fn=!0),s):(ps&42)===0||(ps&1073741824)!==0&&(Ct&261930)===0?(Fn=!0,s.memoizedState=f):(s=WA(),vt.lanes|=s,xo|=s,l)}function QT(s,l,f,g,x){var E=$.p;$.p=E!==0&&8>E?E:8;var N=H.T,F={};H.T=F,lb(s,!1,l,f);try{var X=x(),le=H.S;if(le!==null&&le(F,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var me=Hj(X,g);Tf(s,l,me,gi(s))}else Tf(s,l,g,gi(s))}catch(be){Tf(s,l,{then:function(){},status:"rejected",reason:be},gi())}finally{$.p=E,N!==null&&F.types!==null&&(N.types=F.types),H.T=N}}function Qj(){}function sb(s,l,f,g){if(s.tag!==5)throw Error(r(476));var x=ZT(s).queue;QT(s,x,l,Q,f===null?Qj:function(){return JT(s),f(g)})}function ZT(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:Q},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function JT(s){var l=ZT(s);l.next===null&&(l=s.alternate.memoizedState),Tf(s,l.next.queue,{},gi())}function ob(){return gr(Ff)}function eA(){return kn().memoizedState}function tA(){return kn().memoizedState}function Zj(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=gi();s=po(f);var g=go(l,s,f);g!==null&&(Xr(g,l,f),xf(g,l,f)),l={cache:Vy()},s.payload=l;return}l=l.return}}function Jj(s,l,f){var g=gi();f={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Bg(s)?rA(l,f):(f=Ty(s,l,f,g),f!==null&&(Xr(f,s,g),iA(f,l,g)))}function nA(s,l,f){var g=gi();Tf(s,l,f,g)}function Tf(s,l,f,g){var x={lane:g,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Bg(s))rA(l,x);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var N=l.lastRenderedState,F=E(N,f);if(x.hasEagerState=!0,x.eagerState=F,ci(F,N))return xg(s,l,x,0),an===null&&bg(),!1}catch{}finally{}if(f=Ty(s,l,x,g),f!==null)return Xr(f,s,g),iA(f,l,g),!0}return!1}function lb(s,l,f,g){if(g={lane:2,revertLane:Bb(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Bg(s)){if(l)throw Error(r(479))}else l=Ty(s,f,g,2),l!==null&&Xr(l,s,2)}function Bg(s){var l=s.alternate;return s===vt||l!==null&&l===vt}function rA(s,l){fu=Mg=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function iA(s,l,f){if((f&4194048)!==0){var g=l.lanes;g&=s.pendingLanes,f|=g,l.lanes=f,Mr(s,f)}}var Af={readContext:gr,use:Vg,useCallback:En,useContext:En,useEffect:En,useImperativeHandle:En,useLayoutEffect:En,useInsertionEffect:En,useMemo:En,useReducer:En,useRef:En,useState:En,useDebugValue:En,useDeferredValue:En,useTransition:En,useSyncExternalStore:En,useId:En,useHostTransitionStatus:En,useFormState:En,useActionState:En,useOptimistic:En,useMemoCache:En,useCacheRefresh:En};Af.useEffectEvent=En;var aA={readContext:gr,use:Vg,useCallback:function(s,l){return Or().memoizedState=[s,l===void 0?null:l],s},useContext:gr,useEffect:FT,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,zg(4194308,4,$T.bind(null,l,s),f)},useLayoutEffect:function(s,l){return zg(4194308,4,s,l)},useInsertionEffect:function(s,l){zg(4,2,s,l)},useMemo:function(s,l){var f=Or();l=l===void 0?null:l;var g=s();if(Bl){ze(!0);try{s()}finally{ze(!1)}}return f.memoizedState=[g,l],g},useReducer:function(s,l,f){var g=Or();if(f!==void 0){var x=f(l);if(Bl){ze(!0);try{f(l)}finally{ze(!1)}}}else x=l;return g.memoizedState=g.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},g.queue=s,s=s.dispatch=Jj.bind(null,vt,s),[g.memoizedState,s]},useRef:function(s){var l=Or();return s={current:s},l.memoizedState=s},useState:function(s){s=tb(s);var l=s.queue,f=nA.bind(null,vt,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:ib,useDeferredValue:function(s,l){var f=Or();return ab(f,s,l)},useTransition:function(){var s=tb(!1);return s=QT.bind(null,vt,s.queue,!0,!1),Or().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var g=vt,x=Or();if(Mt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),an===null)throw Error(r(349));(Ct&127)!==0||AT(g,l,f)}x.memoizedState=f;var E={value:f,getSnapshot:l};return x.queue=E,FT(IT.bind(null,g,E,s),[s]),g.flags|=2048,pu(9,{destroy:void 0},CT.bind(null,g,E,f,l),null),f},useId:function(){var s=Or(),l=an.identifierPrefix;if(Mt){var f=Ma,g=Na;f=(g&~(1<<32-Oe(g)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Pg++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=$j++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:ob,useFormState:jT,useActionState:jT,useOptimistic:function(s){var l=Or();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=lb.bind(null,vt,!0,f),f.dispatch=l,[s,l]},useMemoCache:Zy,useCacheRefresh:function(){return Or().memoizedState=Zj.bind(null,vt)},useEffectEvent:function(s){var l=Or(),f={impl:s};return l.memoizedState=f,function(){if((Lt&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},cb={readContext:gr,use:Vg,useCallback:KT,useContext:gr,useEffect:rb,useImperativeHandle:YT,useInsertionEffect:qT,useLayoutEffect:HT,useMemo:XT,useReducer:jg,useRef:UT,useState:function(){return jg(gs)},useDebugValue:ib,useDeferredValue:function(s,l){var f=kn();return WT(f,Wt.memoizedState,s,l)},useTransition:function(){var s=jg(gs)[0],l=kn().memoizedState;return[typeof s=="boolean"?s:Sf(s),l]},useSyncExternalStore:TT,useId:eA,useHostTransitionStatus:ob,useFormState:zT,useActionState:zT,useOptimistic:function(s,l){var f=kn();return kT(f,Wt,s,l)},useMemoCache:Zy,useCacheRefresh:tA};cb.useEffectEvent=GT;var sA={readContext:gr,use:Vg,useCallback:KT,useContext:gr,useEffect:rb,useImperativeHandle:YT,useInsertionEffect:qT,useLayoutEffect:HT,useMemo:XT,useReducer:eb,useRef:UT,useState:function(){return eb(gs)},useDebugValue:ib,useDeferredValue:function(s,l){var f=kn();return Wt===null?ab(f,s,l):WT(f,Wt.memoizedState,s,l)},useTransition:function(){var s=eb(gs)[0],l=kn().memoizedState;return[typeof s=="boolean"?s:Sf(s),l]},useSyncExternalStore:TT,useId:eA,useHostTransitionStatus:ob,useFormState:BT,useActionState:BT,useOptimistic:function(s,l){var f=kn();return Wt!==null?kT(f,Wt,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Zy,useCacheRefresh:tA};sA.useEffectEvent=GT;function ub(s,l,f,g){l=s.memoizedState,f=f(g,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var db={enqueueSetState:function(s,l,f){s=s._reactInternals;var g=gi(),x=po(g);x.payload=l,f!=null&&(x.callback=f),l=go(s,x,g),l!==null&&(Xr(l,s,g),xf(l,s,g))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var g=gi(),x=po(g);x.tag=1,x.payload=l,f!=null&&(x.callback=f),l=go(s,x,g),l!==null&&(Xr(l,s,g),xf(l,s,g))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=gi(),g=po(f);g.tag=2,l!=null&&(g.callback=l),l=go(s,g,f),l!==null&&(Xr(l,s,f),xf(l,s,f))}};function oA(s,l,f,g,x,E,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,N):l.prototype&&l.prototype.isPureReactComponent?!ff(f,g)||!ff(x,E):!0}function lA(s,l,f,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==s&&db.enqueueReplaceState(l,l.state,null)}function Ul(s,l){var f=l;if("ref"in l){f={};for(var g in l)g!=="ref"&&(f[g]=l[g])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var x in s)f[x]===void 0&&(f[x]=s[x])}return f}function cA(s){yg(s)}function uA(s){console.error(s)}function dA(s){yg(s)}function Ug(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function fA(s,l,f){try{var g=s.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function fb(s,l,f){return f=po(f),f.tag=3,f.payload={element:null},f.callback=function(){Ug(s,l)},f}function hA(s){return s=po(s),s.tag=3,s}function pA(s,l,f,g){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var E=g.value;s.payload=function(){return x(E)},s.callback=function(){fA(l,f,g)}}var N=f.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){fA(l,f,g),typeof x!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var F=g.stack;this.componentDidCatch(g.value,{componentStack:F!==null?F:""})})}function e5(s,l,f,g,x){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=f.alternate,l!==null&&su(l,f,x,!0),f=di.current,f!==null){switch(f.tag){case 31:case 13:return Ri===null?Jg():f.alternate===null&&Sn===0&&(Sn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,g===Ig?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([g]):l.add(g),jb(s,g,x)),!1;case 22:return f.flags|=65536,g===Ig?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([g]):f.add(g)),jb(s,g,x)),!1}throw Error(r(435,f.tag))}return jb(s,g,x),Jg(),!1}if(Mt)return l=di.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,g!==ky&&(s=Error(r(422),{cause:g}),gf(Ti(s,f)))):(g!==ky&&(l=Error(r(423),{cause:g}),gf(Ti(l,f))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,g=Ti(g,f),x=fb(s.stateNode,g,x),Fy(s,x),Sn!==4&&(Sn=2)),!1;var E=Error(r(520),{cause:g});if(E=Ti(E,f),Pf===null?Pf=[E]:Pf.push(E),Sn!==4&&(Sn=2),l===null)return!0;g=Ti(g,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=x&-x,f.lanes|=s,s=fb(f.stateNode,g,s),Fy(f,s),!1;case 1:if(l=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(_o===null||!_o.has(E))))return f.flags|=65536,x&=-x,f.lanes|=x,x=hA(x),pA(x,s,f,g),Fy(f,x),!1}f=f.return}while(f!==null);return!1}var hb=Error(r(461)),Fn=!1;function mr(s,l,f,g){l.child=s===null?yT(l,null,f,g):Ll(l,s.child,f,g)}function gA(s,l,f,g,x){f=f.render;var E=l.ref;if("ref"in g){var N={};for(var F in g)F!=="ref"&&(N[F]=g[F])}else N=g;return Ol(l),g=Ky(s,l,f,N,E,x),F=Xy(),s!==null&&!Fn?(Wy(s,l,x),ms(s,l,x)):(Mt&&F&&Ry(l),l.flags|=1,mr(s,l,g,x),l.child)}function mA(s,l,f,g,x){if(s===null){var E=f.type;return typeof E=="function"&&!Ay(E)&&E.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=E,vA(s,l,E,g,x)):(s=wg(f.type,null,g,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!_b(s,x)){var N=E.memoizedProps;if(f=f.compare,f=f!==null?f:ff,f(N,g)&&s.ref===l.ref)return ms(s,l,x)}return l.flags|=1,s=us(E,g),s.ref=l.ref,s.return=l,l.child=s}function vA(s,l,f,g,x){if(s!==null){var E=s.memoizedProps;if(ff(E,g)&&s.ref===l.ref)if(Fn=!1,l.pendingProps=g=E,_b(s,x))(s.flags&131072)!==0&&(Fn=!0);else return l.lanes=s.lanes,ms(s,l,x)}return pb(s,l,f,g,x)}function yA(s,l,f,g){var x=g.children,E=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,s!==null){for(g=l.child=s.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;g=x&~E}else g=0,l.child=null;return bA(s,l,E,f,g)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Ag(l,E!==null?E.cachePool:null),E!==null?_T(l,E):qy(),wT(l);else return g=l.lanes=536870912,bA(s,l,E!==null?E.baseLanes|f:f,f,g)}else E!==null?(Ag(l,E.cachePool),_T(l,E),vo(),l.memoizedState=null):(s!==null&&Ag(l,null),qy(),vo());return mr(s,l,x,f),l.child}function Cf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function bA(s,l,f,g,x){var E=zy();return E=E===null?null:{parent:Bn._currentValue,pool:E},l.memoizedState={baseLanes:f,cachePool:E},s!==null&&Ag(l,null),qy(),wT(l),s!==null&&su(s,l,g,!0),l.childLanes=x,null}function Fg(s,l){return l=qg({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function xA(s,l,f){return Ll(l,s.child,null,f),s=Fg(l,l.pendingProps),s.flags|=2,fi(l),l.memoizedState=null,s}function t5(s,l,f){var g=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Mt){if(g.mode==="hidden")return s=Fg(l,g),l.lanes=536870912,Cf(null,s);if($y(l),(s=on)?(s=NC(s,Ii),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:lo!==null?{id:Na,overflow:Ma}:null,retryLane:536870912,hydrationErrors:null},f=rT(s),f.return=l,l.child=f,pr=l,on=null)):s=null,s===null)throw uo(l);return l.lanes=536870912,null}return Fg(l,g)}var E=s.memoizedState;if(E!==null){var N=E.dehydrated;if($y(l),x)if(l.flags&256)l.flags&=-257,l=xA(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Fn||su(s,l,f,!1),x=(f&s.childLanes)!==0,Fn||x){if(g=an,g!==null&&(N=si(g,f),N!==0&&N!==E.retryLane))throw E.retryLane=N,kl(s,N),Xr(g,s,N),hb;Jg(),l=xA(s,l,f)}else s=E.treeContext,on=Di(N.nextSibling),pr=l,Mt=!0,co=null,Ii=!1,s!==null&&sT(l,s),l=Fg(l,g),l.flags|=4096;return l}return s=us(s.child,{mode:g.mode,children:g.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Gg(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function pb(s,l,f,g,x){return Ol(l),f=Ky(s,l,f,g,void 0,x),g=Xy(),s!==null&&!Fn?(Wy(s,l,x),ms(s,l,x)):(Mt&&g&&Ry(l),l.flags|=1,mr(s,l,f,x),l.child)}function _A(s,l,f,g,x,E){return Ol(l),l.updateQueue=null,f=ST(l,g,f,x),ET(s),g=Xy(),s!==null&&!Fn?(Wy(s,l,E),ms(s,l,E)):(Mt&&g&&Ry(l),l.flags|=1,mr(s,l,f,E),l.child)}function wA(s,l,f,g,x){if(Ol(l),l.stateNode===null){var E=nu,N=f.contextType;typeof N=="object"&&N!==null&&(E=gr(N)),E=new f(g,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=db,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=g,E.state=l.memoizedState,E.refs={},By(l),N=f.contextType,E.context=typeof N=="object"&&N!==null?gr(N):nu,E.state=l.memoizedState,N=f.getDerivedStateFromProps,typeof N=="function"&&(ub(l,f,N,g),E.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(N=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),N!==E.state&&db.enqueueReplaceState(E,E.state,null),wf(l,g,E,x),_f(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(s===null){E=l.stateNode;var F=l.memoizedProps,X=Ul(f,F);E.props=X;var le=E.context,me=f.contextType;N=nu,typeof me=="object"&&me!==null&&(N=gr(me));var be=f.getDerivedStateFromProps;me=typeof be=="function"||typeof E.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,me||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F||le!==N)&&lA(l,E,g,N),ho=!1;var de=l.memoizedState;E.state=de,wf(l,g,E,x),_f(),le=l.memoizedState,F||de!==le||ho?(typeof be=="function"&&(ub(l,f,be,g),le=l.memoizedState),(X=ho||oA(l,f,X,g,de,le,N))?(me||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=le),E.props=g,E.state=le,E.context=N,g=X):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{E=l.stateNode,Uy(s,l),N=l.memoizedProps,me=Ul(f,N),E.props=me,be=l.pendingProps,de=E.context,le=f.contextType,X=nu,typeof le=="object"&&le!==null&&(X=gr(le)),F=f.getDerivedStateFromProps,(le=typeof F=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(N!==be||de!==X)&&lA(l,E,g,X),ho=!1,de=l.memoizedState,E.state=de,wf(l,g,E,x),_f();var pe=l.memoizedState;N!==be||de!==pe||ho||s!==null&&s.dependencies!==null&&Sg(s.dependencies)?(typeof F=="function"&&(ub(l,f,F,g),pe=l.memoizedState),(me=ho||oA(l,f,me,g,de,pe,X)||s!==null&&s.dependencies!==null&&Sg(s.dependencies))?(le||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(g,pe,X),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(g,pe,X)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=pe),E.props=g,E.state=pe,E.context=X,g=me):(typeof E.componentDidUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&de===s.memoizedState||(l.flags|=1024),g=!1)}return E=g,Gg(s,l),g=(l.flags&128)!==0,E||g?(E=l.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&g?(l.child=Ll(l,s.child,null,x),l.child=Ll(l,null,f,x)):mr(s,l,f,x),l.memoizedState=E.state,s=l.child):s=ms(s,l,x),s}function EA(s,l,f,g){return Ml(),l.flags|=256,mr(s,l,f,g),l.child}var gb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function mb(s){return{baseLanes:s,cachePool:fT()}}function vb(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=pi),s}function SA(s,l,f){var g=l.pendingProps,x=!1,E=(l.flags&128)!==0,N;if((N=E)||(N=s!==null&&s.memoizedState===null?!1:(Dn.current&2)!==0),N&&(x=!0,l.flags&=-129),N=(l.flags&32)!==0,l.flags&=-33,s===null){if(Mt){if(x?mo(l):vo(),(s=on)?(s=NC(s,Ii),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:lo!==null?{id:Na,overflow:Ma}:null,retryLane:536870912,hydrationErrors:null},f=rT(s),f.return=l,l.child=f,pr=l,on=null)):s=null,s===null)throw uo(l);return Jb(s)?l.lanes=32:l.lanes=536870912,null}var F=g.children;return g=g.fallback,x?(vo(),x=l.mode,F=qg({mode:"hidden",children:F},x),g=Nl(g,x,f,null),F.return=l,g.return=l,F.sibling=g,l.child=F,g=l.child,g.memoizedState=mb(f),g.childLanes=vb(s,N,f),l.memoizedState=gb,Cf(null,g)):(mo(l),yb(l,F))}var X=s.memoizedState;if(X!==null&&(F=X.dehydrated,F!==null)){if(E)l.flags&256?(mo(l),l.flags&=-257,l=bb(s,l,f)):l.memoizedState!==null?(vo(),l.child=s.child,l.flags|=128,l=null):(vo(),F=g.fallback,x=l.mode,g=qg({mode:"visible",children:g.children},x),F=Nl(F,x,f,null),F.flags|=2,g.return=l,F.return=l,g.sibling=F,l.child=g,Ll(l,s.child,null,f),g=l.child,g.memoizedState=mb(f),g.childLanes=vb(s,N,f),l.memoizedState=gb,l=Cf(null,g));else if(mo(l),Jb(F)){if(N=F.nextSibling&&F.nextSibling.dataset,N)var le=N.dgst;N=le,g=Error(r(419)),g.stack="",g.digest=N,gf({value:g,source:null,stack:null}),l=bb(s,l,f)}else if(Fn||su(s,l,f,!1),N=(f&s.childLanes)!==0,Fn||N){if(N=an,N!==null&&(g=si(N,f),g!==0&&g!==X.retryLane))throw X.retryLane=g,kl(s,g),Xr(N,s,g),hb;Zb(F)||Jg(),l=bb(s,l,f)}else Zb(F)?(l.flags|=192,l.child=s.child,l=null):(s=X.treeContext,on=Di(F.nextSibling),pr=l,Mt=!0,co=null,Ii=!1,s!==null&&sT(l,s),l=yb(l,g.children),l.flags|=4096);return l}return x?(vo(),F=g.fallback,x=l.mode,X=s.child,le=X.sibling,g=us(X,{mode:"hidden",children:g.children}),g.subtreeFlags=X.subtreeFlags&65011712,le!==null?F=us(le,F):(F=Nl(F,x,f,null),F.flags|=2),F.return=l,g.return=l,g.sibling=F,l.child=g,Cf(null,g),g=l.child,F=s.child.memoizedState,F===null?F=mb(f):(x=F.cachePool,x!==null?(X=Bn._currentValue,x=x.parent!==X?{parent:X,pool:X}:x):x=fT(),F={baseLanes:F.baseLanes|f,cachePool:x}),g.memoizedState=F,g.childLanes=vb(s,N,f),l.memoizedState=gb,Cf(s.child,g)):(mo(l),f=s.child,s=f.sibling,f=us(f,{mode:"visible",children:g.children}),f.return=l,f.sibling=null,s!==null&&(N=l.deletions,N===null?(l.deletions=[s],l.flags|=16):N.push(s)),l.child=f,l.memoizedState=null,f)}function yb(s,l){return l=qg({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function qg(s,l){return s=ui(22,s,null,l),s.lanes=0,s}function bb(s,l,f){return Ll(l,s.child,null,f),s=yb(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function TA(s,l,f){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Py(s.return,l,f)}function xb(s,l,f,g,x,E){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:x,treeForkCount:E}:(N.isBackwards=l,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=f,N.tailMode=x,N.treeForkCount=E)}function AA(s,l,f){var g=l.pendingProps,x=g.revealOrder,E=g.tail;g=g.children;var N=Dn.current,F=(N&2)!==0;if(F?(N=N&1|2,l.flags|=128):N&=1,ne(Dn,N),mr(s,l,g,f),g=Mt?pf:0,!F&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&TA(s,f,l);else if(s.tag===19)TA(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&Ng(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),xb(l,!1,x,f,E,g);break;case"backwards":case"unstable_legacy-backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Ng(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}xb(l,!0,f,null,E,g);break;case"together":xb(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function ms(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),xo|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(su(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=us(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=us(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function _b(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Sg(s)))}function n5(s,l,f){switch(l.tag){case 3:Ae(l,l.stateNode.containerInfo),fo(l,Bn,s.memoizedState.cache),Ml();break;case 27:case 5:Se(l);break;case 4:Ae(l,l.stateNode.containerInfo);break;case 10:fo(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,$y(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(mo(l),l.flags|=128,null):(f&l.child.childLanes)!==0?SA(s,l,f):(mo(l),s=ms(s,l,f),s!==null?s.sibling:null);mo(l);break;case 19:var x=(s.flags&128)!==0;if(g=(f&l.childLanes)!==0,g||(su(s,l,f,!1),g=(f&l.childLanes)!==0),x){if(g)return AA(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ne(Dn,Dn.current),g)break;return null;case 22:return l.lanes=0,yA(s,l,f,l.pendingProps);case 24:fo(l,Bn,s.memoizedState.cache)}return ms(s,l,f)}function CA(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Fn=!0;else{if(!_b(s,f)&&(l.flags&128)===0)return Fn=!1,n5(s,l,f);Fn=(s.flags&131072)!==0}else Fn=!1,Mt&&(l.flags&1048576)!==0&&aT(l,pf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(s=jl(l.elementType),l.type=s,typeof s=="function")Ay(s)?(g=Ul(s,g),l.tag=1,l=wA(null,l,s,g,f)):(l.tag=0,l=pb(null,l,s,g,f));else{if(s!=null){var x=s.$$typeof;if(x===M){l.tag=11,l=gA(null,l,s,g,f);break e}else if(x===A){l.tag=14,l=mA(null,l,s,g,f);break e}}throw l=Z(s)||s,Error(r(306,l,""))}}return l;case 0:return pb(s,l,l.type,l.pendingProps,f);case 1:return g=l.type,x=Ul(g,l.pendingProps),wA(s,l,g,x,f);case 3:e:{if(Ae(l,l.stateNode.containerInfo),s===null)throw Error(r(387));g=l.pendingProps;var E=l.memoizedState;x=E.element,Uy(s,l),wf(l,g,null,f);var N=l.memoizedState;if(g=N.cache,fo(l,Bn,g),g!==E.cache&&Oy(l,[Bn],f,!0),_f(),g=N.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:N.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=EA(s,l,g,f);break e}else if(g!==x){x=Ti(Error(r(424)),l),gf(x),l=EA(s,l,g,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(on=Di(s.firstChild),pr=l,Mt=!0,co=null,Ii=!0,f=yT(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Ml(),g===x){l=ms(s,l,f);break e}mr(s,l,g,f)}l=l.child}return l;case 26:return Gg(s,l),s===null?(f=zC(l.type,null,l.pendingProps,null))?l.memoizedState=f:Mt||(f=l.type,s=l.pendingProps,g=sm(fe.current).createElement(f),g[jn]=l,g[sr]=s,vr(g,f,s),zn(g),l.stateNode=g):l.memoizedState=zC(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Se(l),s===null&&Mt&&(g=l.stateNode=OC(l.type,l.pendingProps,fe.current),pr=l,Ii=!0,x=on,To(l.type)?(ex=x,on=Di(g.firstChild)):on=x),mr(s,l,l.pendingProps.children,f),Gg(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Mt&&((x=g=on)&&(g=N5(g,l.type,l.pendingProps,Ii),g!==null?(l.stateNode=g,pr=l,on=Di(g.firstChild),Ii=!1,x=!0):x=!1),x||uo(l)),Se(l),x=l.type,E=l.pendingProps,N=s!==null?s.memoizedProps:null,g=E.children,Xb(x,E)?g=null:N!==null&&Xb(x,N)&&(l.flags|=32),l.memoizedState!==null&&(x=Ky(s,l,Yj,null,null,f),Ff._currentValue=x),Gg(s,l),mr(s,l,g,f),l.child;case 6:return s===null&&Mt&&((s=f=on)&&(f=M5(f,l.pendingProps,Ii),f!==null?(l.stateNode=f,pr=l,on=null,s=!0):s=!1),s||uo(l)),null;case 13:return SA(s,l,f);case 4:return Ae(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=Ll(l,null,g,f):mr(s,l,g,f),l.child;case 11:return gA(s,l,l.type,l.pendingProps,f);case 7:return mr(s,l,l.pendingProps,f),l.child;case 8:return mr(s,l,l.pendingProps.children,f),l.child;case 12:return mr(s,l,l.pendingProps.children,f),l.child;case 10:return g=l.pendingProps,fo(l,l.type,g.value),mr(s,l,g.children,f),l.child;case 9:return x=l.type._context,g=l.pendingProps.children,Ol(l),x=gr(x),g=g(x),l.flags|=1,mr(s,l,g,f),l.child;case 14:return mA(s,l,l.type,l.pendingProps,f);case 15:return vA(s,l,l.type,l.pendingProps,f);case 19:return AA(s,l,f);case 31:return t5(s,l,f);case 22:return yA(s,l,f,l.pendingProps);case 24:return Ol(l),g=gr(Bn),s===null?(x=zy(),x===null&&(x=an,E=Vy(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=f),x=E),l.memoizedState={parent:g,cache:x},By(l),fo(l,Bn,x)):((s.lanes&f)!==0&&(Uy(s,l),wf(l,null,null,f),_f()),x=s.memoizedState,E=l.memoizedState,x.parent!==g?(x={parent:g,cache:g},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),fo(l,Bn,g)):(g=E.cache,fo(l,Bn,g),g!==x.cache&&Oy(l,[Bn],f,!0))),mr(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function vs(s){s.flags|=4}function wb(s,l,f,g,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(eC())s.flags|=8192;else throw zl=Ig,Ly}else s.flags&=-16777217}function IA(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!GC(l))if(eC())s.flags|=8192;else throw zl=Ig,Ly}function Hg(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?wn():536870912,s.lanes|=l,yu|=l)}function If(s,l){if(!Mt)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function ln(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,g=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags&65011712,g|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,g|=x.subtreeFlags,g|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=g,s.childLanes=f,l}function r5(s,l,f){var g=l.pendingProps;switch(Dy(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(l),null;case 1:return ln(l),null;case 3:return f=l.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),hs(Bn),Pe(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(au(l)?vs(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ny())),ln(l),null;case 26:var x=l.type,E=l.memoizedState;return s===null?(vs(l),E!==null?(ln(l),IA(l,E)):(ln(l),wb(l,x,null,g,f))):E?E!==s.memoizedState?(vs(l),ln(l),IA(l,E)):(ln(l),l.flags&=-16777217):(s=s.memoizedProps,s!==g&&vs(l),ln(l),wb(l,x,s,g,f)),null;case 27:if(we(l),f=fe.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&vs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return ln(l),null}s=te.current,au(l)?oT(l):(s=OC(x,g,f),l.stateNode=s,vs(l))}return ln(l),null;case 5:if(we(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==g&&vs(l);else{if(!g){if(l.stateNode===null)throw Error(r(166));return ln(l),null}if(E=te.current,au(l))oT(l);else{var N=sm(fe.current);switch(E){case 1:E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=N.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof g.is=="string"?N.createElement("select",{is:g.is}):N.createElement("select"),g.multiple?E.multiple=!0:g.size&&(E.size=g.size);break;default:E=typeof g.is=="string"?N.createElement(x,{is:g.is}):N.createElement(x)}}E[jn]=l,E[sr]=g;e:for(N=l.child;N!==null;){if(N.tag===5||N.tag===6)E.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===l)break e;for(;N.sibling===null;){if(N.return===null||N.return===l)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}l.stateNode=E;e:switch(vr(E,x,g),x){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&vs(l)}}return ln(l),wb(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==g&&vs(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(s=fe.current,au(l)){if(s=l.stateNode,f=l.memoizedProps,g=null,x=pr,x!==null)switch(x.tag){case 27:case 5:g=x.memoizedProps}s[jn]=l,s=!!(s.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||SC(s.nodeValue,f)),s||uo(l,!0)}else s=sm(s).createTextNode(g),s[jn]=l,l.stateNode=s}return ln(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(g=au(l),f!==null){if(s===null){if(!g)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[jn]=l}else Ml(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;ln(l),s=!1}else f=Ny(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(fi(l),l):(fi(l),null);if((l.flags&128)!==0)throw Error(r(558))}return ln(l),null;case 13:if(g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=au(l),g!==null&&g.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[jn]=l}else Ml(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;ln(l),x=!1}else x=Ny(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(fi(l),l):(fi(l),null)}return fi(l),(l.flags&128)!==0?(l.lanes=f,l):(f=g!==null,s=s!==null&&s.memoizedState!==null,f&&(g=l.child,x=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(x=g.alternate.memoizedState.cachePool.pool),E=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(E=g.memoizedState.cachePool.pool),E!==x&&(g.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Hg(l,l.updateQueue),ln(l),null);case 4:return Pe(),s===null&&qb(l.stateNode.containerInfo),ln(l),null;case 10:return hs(l.type),ln(l),null;case 19:if(Y(Dn),g=l.memoizedState,g===null)return ln(l),null;if(x=(l.flags&128)!==0,E=g.rendering,E===null)if(x)If(g,!1);else{if(Sn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Ng(s),E!==null){for(l.flags|=128,If(g,!1),s=E.updateQueue,l.updateQueue=s,Hg(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)nT(f,s),f=f.sibling;return ne(Dn,Dn.current&1|2),Mt&&ds(l,g.treeForkCount),l.child}s=s.sibling}g.tail!==null&&st()>Wg&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304)}else{if(!x)if(s=Ng(E),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Hg(l,s),If(g,!0),g.tail===null&&g.tailMode==="hidden"&&!E.alternate&&!Mt)return ln(l),null}else 2*st()-g.renderingStartTime>Wg&&f!==536870912&&(l.flags|=128,x=!0,If(g,!1),l.lanes=4194304);g.isBackwards?(E.sibling=l.child,l.child=E):(s=g.last,s!==null?s.sibling=E:l.child=E,g.last=E)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=st(),s.sibling=null,f=Dn.current,ne(Dn,x?f&1|2:f&1),Mt&&ds(l,g.treeForkCount),s):(ln(l),null);case 22:case 23:return fi(l),Hy(),g=l.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(f&536870912)!==0&&(l.flags&128)===0&&(ln(l),l.subtreeFlags&6&&(l.flags|=8192)):ln(l),f=l.updateQueue,f!==null&&Hg(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==f&&(l.flags|=2048),s!==null&&Y(Vl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),hs(Bn),ln(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function i5(s,l){switch(Dy(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return hs(Bn),Pe(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return we(l),null;case 31:if(l.memoizedState!==null){if(fi(l),l.alternate===null)throw Error(r(340));Ml()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(fi(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Ml()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Y(Dn),null;case 4:return Pe(),null;case 10:return hs(l.type),null;case 22:case 23:return fi(l),Hy(),s!==null&&Y(Vl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return hs(Bn),null;case 25:return null;default:return null}}function RA(s,l){switch(Dy(l),l.tag){case 3:hs(Bn),Pe();break;case 26:case 27:case 5:we(l);break;case 4:Pe();break;case 31:l.memoizedState!==null&&fi(l);break;case 13:fi(l);break;case 19:Y(Dn);break;case 10:hs(l.type);break;case 22:case 23:fi(l),Hy(),s!==null&&Y(Vl);break;case 24:hs(Bn)}}function Rf(s,l){try{var f=l.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&s)===s){g=void 0;var E=f.create,N=f.inst;g=E(),N.destroy=g}f=f.next}while(f!==x)}}catch(F){qt(l,l.return,F)}}function yo(s,l,f){try{var g=l.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var E=x.next;g=E;do{if((g.tag&s)===s){var N=g.inst,F=N.destroy;if(F!==void 0){N.destroy=void 0,x=l;var X=f,le=F;try{le()}catch(me){qt(x,X,me)}}}g=g.next}while(g!==E)}}catch(me){qt(l,l.return,me)}}function DA(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{xT(l,f)}catch(g){qt(s,s.return,g)}}}function kA(s,l,f){f.props=Ul(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(g){qt(s,l,g)}}function Df(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof f=="function"?s.refCleanup=f(g):f.current=g}}catch(x){qt(s,l,x)}}function Pa(s,l){var f=s.ref,g=s.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(x){qt(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){qt(s,l,x)}else f.current=null}function NA(s){var l=s.type,f=s.memoizedProps,g=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break e;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(x){qt(s,s.return,x)}}function Eb(s,l,f){try{var g=s.stateNode;A5(g,s.type,f,l),g[sr]=l}catch(x){qt(s,s.return,x)}}function MA(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&To(s.type)||s.tag===4}function Sb(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||MA(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&To(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Tb(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Wi));else if(g!==4&&(g===27&&To(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(Tb(s,l,f),s=s.sibling;s!==null;)Tb(s,l,f),s=s.sibling}function $g(s,l,f){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(g!==4&&(g===27&&To(s.type)&&(f=s.stateNode),s=s.child,s!==null))for($g(s,l,f),s=s.sibling;s!==null;)$g(s,l,f),s=s.sibling}function PA(s){var l=s.stateNode,f=s.memoizedProps;try{for(var g=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);vr(l,g,f),l[jn]=s,l[sr]=f}catch(E){qt(s,s.return,E)}}var ys=!1,Gn=!1,Ab=!1,OA=typeof WeakSet=="function"?WeakSet:Set,lr=null;function a5(s,l){if(s=s.containerInfo,Yb=hm,s=YS(s),by(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var x=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var N=0,F=-1,X=-1,le=0,me=0,be=s,de=null;t:for(;;){for(var pe;be!==f||x!==0&&be.nodeType!==3||(F=N+x),be!==E||g!==0&&be.nodeType!==3||(X=N+g),be.nodeType===3&&(N+=be.nodeValue.length),(pe=be.firstChild)!==null;)de=be,be=pe;for(;;){if(be===s)break t;if(de===f&&++le===x&&(F=N),de===E&&++me===g&&(X=N),(pe=be.nextSibling)!==null)break;be=de,de=be.parentNode}be=pe}f=F===-1||X===-1?null:{start:F,end:X}}else f=null}f=f||{start:0,end:0}}else f=null;for(Kb={focusedElem:s,selectionRange:f},hm=!1,lr=l;lr!==null;)if(l=lr,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,lr=s;else for(;lr!==null;){switch(l=lr,E=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)x=s[f],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,f=l,x=E.memoizedProps,E=E.memoizedState,g=f.stateNode;try{var Le=Ul(f.type,x);s=g.getSnapshotBeforeUpdate(Le,E),g.__reactInternalSnapshotBeforeUpdate=s}catch(Qe){qt(f,f.return,Qe)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)Qb(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Qb(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,lr=s;break}lr=l.return}}function VA(s,l,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:xs(s,f),g&4&&Rf(5,f);break;case 1:if(xs(s,f),g&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(N){qt(f,f.return,N)}else{var x=Ul(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(N){qt(f,f.return,N)}}g&64&&DA(f),g&512&&Df(f,f.return);break;case 3:if(xs(s,f),g&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{xT(s,l)}catch(N){qt(f,f.return,N)}}break;case 27:l===null&&g&4&&PA(f);case 26:case 5:xs(s,f),l===null&&g&4&&NA(f),g&512&&Df(f,f.return);break;case 12:xs(s,f);break;case 31:xs(s,f),g&4&&LA(s,f);break;case 13:xs(s,f),g&4&&BA(s,f),g&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=p5.bind(null,f),P5(s,f))));break;case 22:if(g=f.memoizedState!==null||ys,!g){l=l!==null&&l.memoizedState!==null||Gn,x=ys;var E=Gn;ys=g,(Gn=l)&&!E?_s(s,f,(f.subtreeFlags&8772)!==0):xs(s,f),ys=x,Gn=E}break;case 30:break;default:xs(s,f)}}function jA(s){var l=s.alternate;l!==null&&(s.alternate=null,jA(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Fc(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var fn=null,Hr=!1;function bs(s,l,f){for(f=f.child;f!==null;)zA(s,l,f),f=f.sibling}function zA(s,l,f){if(_n&&typeof _n.onCommitFiberUnmount=="function")try{_n.onCommitFiberUnmount(Nr,f)}catch{}switch(f.tag){case 26:Gn||Pa(f,l),bs(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Gn||Pa(f,l);var g=fn,x=Hr;To(f.type)&&(fn=f.stateNode,Hr=!1),bs(s,l,f),Lf(f.stateNode),fn=g,Hr=x;break;case 5:Gn||Pa(f,l);case 6:if(g=fn,x=Hr,fn=null,bs(s,l,f),fn=g,Hr=x,fn!==null)if(Hr)try{(fn.nodeType===9?fn.body:fn.nodeName==="HTML"?fn.ownerDocument.body:fn).removeChild(f.stateNode)}catch(E){qt(f,l,E)}else try{fn.removeChild(f.stateNode)}catch(E){qt(f,l,E)}break;case 18:fn!==null&&(Hr?(s=fn,DC(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Au(s)):DC(fn,f.stateNode));break;case 4:g=fn,x=Hr,fn=f.stateNode.containerInfo,Hr=!0,bs(s,l,f),fn=g,Hr=x;break;case 0:case 11:case 14:case 15:yo(2,f,l),Gn||yo(4,f,l),bs(s,l,f);break;case 1:Gn||(Pa(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"&&kA(f,l,g)),bs(s,l,f);break;case 21:bs(s,l,f);break;case 22:Gn=(g=Gn)||f.memoizedState!==null,bs(s,l,f),Gn=g;break;default:bs(s,l,f)}}function LA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Au(s)}catch(f){qt(l,l.return,f)}}}function BA(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Au(s)}catch(f){qt(l,l.return,f)}}function s5(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new OA),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new OA),l;default:throw Error(r(435,s.tag))}}function Yg(s,l){var f=s5(s);l.forEach(function(g){if(!f.has(g)){f.add(g);var x=g5.bind(null,s,g);g.then(x,x)}})}function $r(s,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var x=f[g],E=s,N=l,F=N;e:for(;F!==null;){switch(F.tag){case 27:if(To(F.type)){fn=F.stateNode,Hr=!1;break e}break;case 5:fn=F.stateNode,Hr=!1;break e;case 3:case 4:fn=F.stateNode.containerInfo,Hr=!0;break e}F=F.return}if(fn===null)throw Error(r(160));zA(E,N,x),fn=null,Hr=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)UA(l,s),l=l.sibling}var na=null;function UA(s,l){var f=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:$r(l,s),Yr(s),g&4&&(yo(3,s,s.return),Rf(3,s),yo(5,s,s.return));break;case 1:$r(l,s),Yr(s),g&512&&(Gn||f===null||Pa(f,f.return)),g&64&&ys&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var x=na;if($r(l,s),Yr(s),g&512&&(Gn||f===null||Pa(f,f.return)),g&4){var E=f!==null?f.memoizedState:null;if(g=s.memoizedState,f===null)if(g===null)if(s.stateNode===null){e:{g=s.type,f=s.memoizedProps,x=x.ownerDocument||x;t:switch(g){case"title":E=x.getElementsByTagName("title")[0],(!E||E[xa]||E[jn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(g),x.head.insertBefore(E,x.querySelector("head > title"))),vr(E,g,f),E[jn]=s,zn(E),g=E;break e;case"link":var N=UC("link","href",x).get(g+(f.href||""));if(N){for(var F=0;F<N.length;F++)if(E=N[F],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){N.splice(F,1);break t}}E=x.createElement(g),vr(E,g,f),x.head.appendChild(E);break;case"meta":if(N=UC("meta","content",x).get(g+(f.content||""))){for(F=0;F<N.length;F++)if(E=N[F],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){N.splice(F,1);break t}}E=x.createElement(g),vr(E,g,f),x.head.appendChild(E);break;default:throw Error(r(468,g))}E[jn]=s,zn(E),g=E}s.stateNode=g}else FC(x,s.type,s.stateNode);else s.stateNode=BC(x,g,s.memoizedProps);else E!==g?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,g===null?FC(x,s.type,s.stateNode):BC(x,g,s.memoizedProps)):g===null&&s.stateNode!==null&&Eb(s,s.memoizedProps,f.memoizedProps)}break;case 27:$r(l,s),Yr(s),g&512&&(Gn||f===null||Pa(f,f.return)),f!==null&&g&4&&Eb(s,s.memoizedProps,f.memoizedProps);break;case 5:if($r(l,s),Yr(s),g&512&&(Gn||f===null||Pa(f,f.return)),s.flags&32){x=s.stateNode;try{qr(x,"")}catch(Le){qt(s,s.return,Le)}}g&4&&s.stateNode!=null&&(x=s.memoizedProps,Eb(s,x,f!==null?f.memoizedProps:x)),g&1024&&(Ab=!0);break;case 6:if($r(l,s),Yr(s),g&4){if(s.stateNode===null)throw Error(r(162));g=s.memoizedProps,f=s.stateNode;try{f.nodeValue=g}catch(Le){qt(s,s.return,Le)}}break;case 3:if(cm=null,x=na,na=om(l.containerInfo),$r(l,s),na=x,Yr(s),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Au(l.containerInfo)}catch(Le){qt(s,s.return,Le)}Ab&&(Ab=!1,FA(s));break;case 4:g=na,na=om(s.stateNode.containerInfo),$r(l,s),Yr(s),na=g;break;case 12:$r(l,s),Yr(s);break;case 31:$r(l,s),Yr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Yg(s,g)));break;case 13:$r(l,s),Yr(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Xg=st()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Yg(s,g)));break;case 22:x=s.memoizedState!==null;var X=f!==null&&f.memoizedState!==null,le=ys,me=Gn;if(ys=le||x,Gn=me||X,$r(l,s),Gn=me,ys=le,Yr(s),g&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(f===null||X||ys||Gn||Fl(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){X=f=l;try{if(E=X.stateNode,x)N=E.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{F=X.stateNode;var be=X.memoizedProps.style,de=be!=null&&be.hasOwnProperty("display")?be.display:null;F.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(Le){qt(X,X.return,Le)}}}else if(l.tag===6){if(f===null){X=l;try{X.stateNode.nodeValue=x?"":X.memoizedProps}catch(Le){qt(X,X.return,Le)}}}else if(l.tag===18){if(f===null){X=l;try{var pe=X.stateNode;x?kC(pe,!0):kC(X.stateNode,!1)}catch(Le){qt(X,X.return,Le)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=s.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Yg(s,f))));break;case 19:$r(l,s),Yr(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Yg(s,g)));break;case 30:break;case 21:break;default:$r(l,s),Yr(s)}}function Yr(s){var l=s.flags;if(l&2){try{for(var f,g=s.return;g!==null;){if(MA(g)){f=g;break}g=g.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,E=Sb(s);$g(s,E,x);break;case 5:var N=f.stateNode;f.flags&32&&(qr(N,""),f.flags&=-33);var F=Sb(s);$g(s,F,N);break;case 3:case 4:var X=f.stateNode.containerInfo,le=Sb(s);Tb(s,le,X);break;default:throw Error(r(161))}}catch(me){qt(s,s.return,me)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function FA(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;FA(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function xs(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)VA(s,l.alternate,l),l=l.sibling}function Fl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:yo(4,l,l.return),Fl(l);break;case 1:Pa(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&kA(l,l.return,f),Fl(l);break;case 27:Lf(l.stateNode);case 26:case 5:Pa(l,l.return),Fl(l);break;case 22:l.memoizedState===null&&Fl(l);break;case 30:Fl(l);break;default:Fl(l)}s=s.sibling}}function _s(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,x=s,E=l,N=E.flags;switch(E.tag){case 0:case 11:case 15:_s(x,E,f),Rf(4,E);break;case 1:if(_s(x,E,f),g=E,x=g.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(le){qt(g,g.return,le)}if(g=E,x=g.updateQueue,x!==null){var F=g.stateNode;try{var X=x.shared.hiddenCallbacks;if(X!==null)for(x.shared.hiddenCallbacks=null,x=0;x<X.length;x++)bT(X[x],F)}catch(le){qt(g,g.return,le)}}f&&N&64&&DA(E),Df(E,E.return);break;case 27:PA(E);case 26:case 5:_s(x,E,f),f&&g===null&&N&4&&NA(E),Df(E,E.return);break;case 12:_s(x,E,f);break;case 31:_s(x,E,f),f&&N&4&&LA(x,E);break;case 13:_s(x,E,f),f&&N&4&&BA(x,E);break;case 22:E.memoizedState===null&&_s(x,E,f),Df(E,E.return);break;case 30:break;default:_s(x,E,f)}l=l.sibling}}function Cb(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&mf(f))}function Ib(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s))}function ra(s,l,f,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)GA(s,l,f,g),l=l.sibling}function GA(s,l,f,g){var x=l.flags;switch(l.tag){case 0:case 11:case 15:ra(s,l,f,g),x&2048&&Rf(9,l);break;case 1:ra(s,l,f,g);break;case 3:ra(s,l,f,g),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&mf(s)));break;case 12:if(x&2048){ra(s,l,f,g),s=l.stateNode;try{var E=l.memoizedProps,N=E.id,F=E.onPostCommit;typeof F=="function"&&F(N,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(X){qt(l,l.return,X)}}else ra(s,l,f,g);break;case 31:ra(s,l,f,g);break;case 13:ra(s,l,f,g);break;case 23:break;case 22:E=l.stateNode,N=l.alternate,l.memoizedState!==null?E._visibility&2?ra(s,l,f,g):kf(s,l):E._visibility&2?ra(s,l,f,g):(E._visibility|=2,gu(s,l,f,g,(l.subtreeFlags&10256)!==0||!1)),x&2048&&Cb(N,l);break;case 24:ra(s,l,f,g),x&2048&&Ib(l.alternate,l);break;default:ra(s,l,f,g)}}function gu(s,l,f,g,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=s,N=l,F=f,X=g,le=N.flags;switch(N.tag){case 0:case 11:case 15:gu(E,N,F,X,x),Rf(8,N);break;case 23:break;case 22:var me=N.stateNode;N.memoizedState!==null?me._visibility&2?gu(E,N,F,X,x):kf(E,N):(me._visibility|=2,gu(E,N,F,X,x)),x&&le&2048&&Cb(N.alternate,N);break;case 24:gu(E,N,F,X,x),x&&le&2048&&Ib(N.alternate,N);break;default:gu(E,N,F,X,x)}l=l.sibling}}function kf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,g=l,x=g.flags;switch(g.tag){case 22:kf(f,g),x&2048&&Cb(g.alternate,g);break;case 24:kf(f,g),x&2048&&Ib(g.alternate,g);break;default:kf(f,g)}l=l.sibling}}var Nf=8192;function mu(s,l,f){if(s.subtreeFlags&Nf)for(s=s.child;s!==null;)qA(s,l,f),s=s.sibling}function qA(s,l,f){switch(s.tag){case 26:mu(s,l,f),s.flags&Nf&&s.memoizedState!==null&&$5(f,na,s.memoizedState,s.memoizedProps);break;case 5:mu(s,l,f);break;case 3:case 4:var g=na;na=om(s.stateNode.containerInfo),mu(s,l,f),na=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Nf,Nf=16777216,mu(s,l,f),Nf=g):mu(s,l,f));break;default:mu(s,l,f)}}function HA(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Mf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];lr=g,YA(g,s)}HA(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)$A(s),s=s.sibling}function $A(s){switch(s.tag){case 0:case 11:case 15:Mf(s),s.flags&2048&&yo(9,s,s.return);break;case 3:Mf(s);break;case 12:Mf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Kg(s)):Mf(s);break;default:Mf(s)}}function Kg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var g=l[f];lr=g,YA(g,s)}HA(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:yo(8,l,l.return),Kg(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Kg(l));break;default:Kg(l)}s=s.sibling}}function YA(s,l){for(;lr!==null;){var f=lr;switch(f.tag){case 0:case 11:case 15:yo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:mf(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,lr=g;else e:for(f=s;lr!==null;){g=lr;var x=g.sibling,E=g.return;if(jA(g),g===f){lr=null;break e}if(x!==null){x.return=E,lr=x;break e}lr=E}}}var o5={getCacheForType:function(s){var l=gr(Bn),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return gr(Bn).controller.signal}},l5=typeof WeakMap=="function"?WeakMap:Map,Lt=0,an=null,St=null,Ct=0,Gt=0,hi=null,bo=!1,vu=!1,Rb=!1,ws=0,Sn=0,xo=0,Gl=0,Db=0,pi=0,yu=0,Pf=null,Kr=null,kb=!1,Xg=0,KA=0,Wg=1/0,Qg=null,_o=null,Zn=0,wo=null,bu=null,Es=0,Nb=0,Mb=null,XA=null,Of=0,Pb=null;function gi(){return(Lt&2)!==0&&Ct!==0?Ct&-Ct:H.T!==null?Bb():Zp()}function WA(){if(pi===0)if((Ct&536870912)===0||Mt){var s=Et;Et<<=1,(Et&3932160)===0&&(Et=262144),pi=s}else pi=536870912;return s=di.current,s!==null&&(s.flags|=32),pi}function Xr(s,l,f){(s===an&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)&&(xu(s,0),Eo(s,Ct,pi,!1)),rn(s,f),((Lt&2)===0||s!==an)&&(s===an&&((Lt&2)===0&&(Gl|=f),Sn===4&&Eo(s,Ct,pi,!1)),Oa(s))}function QA(s,l,f){if((Lt&6)!==0)throw Error(r(327));var g=!f&&(l&127)===0&&(l&s.expiredLanes)===0||Nt(s,l),x=g?d5(s,l):Vb(s,l,!0),E=g;do{if(x===0){vu&&!g&&Eo(s,l,0,!1);break}else{if(f=s.current.alternate,E&&!c5(f)){x=Vb(s,l,!1),E=!1;continue}if(x===2){if(E=l,s.errorRecoveryDisabledLanes&E)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){l=N;e:{var F=s;x=Pf;var X=F.current.memoizedState.isDehydrated;if(X&&(xu(F,N).flags|=256),N=Vb(F,N,!1),N!==2){if(Rb&&!X){F.errorRecoveryDisabledLanes|=E,Gl|=E,x=4;break e}E=Kr,Kr=x,E!==null&&(Kr===null?Kr=E:Kr.push.apply(Kr,E))}x=N}if(E=!1,x!==2)continue}}if(x===1){xu(s,0),Eo(s,l,0,!0);break}e:{switch(g=s,E=x,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:Eo(g,l,pi,!bo);break e;case 2:Kr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(x=Xg+300-st(),10<x)){if(Eo(g,l,pi,!bo),ct(g,0,!0)!==0)break e;Es=l,g.timeoutHandle=IC(ZA.bind(null,g,f,Kr,Qg,kb,l,pi,Gl,yu,bo,E,"Throttled",-0,0),x);break e}ZA(g,f,Kr,Qg,kb,l,pi,Gl,yu,bo,E,null,-0,0)}}break}while(!0);Oa(s)}function ZA(s,l,f,g,x,E,N,F,X,le,me,be,de,pe){if(s.timeoutHandle=-1,be=l.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Wi},qA(l,E,be);var Le=(E&62914560)===E?Xg-st():(E&4194048)===E?KA-st():0;if(Le=Y5(be,Le),Le!==null){Es=E,s.cancelPendingCommit=Le(sC.bind(null,s,l,E,f,g,x,N,F,X,me,be,null,de,pe)),Eo(s,E,N,!le);return}}sC(s,l,E,f,g,x,N,F,X)}function c5(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var x=f[g],E=x.getSnapshot;x=x.value;try{if(!ci(E(),x))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Eo(s,l,f,g){l&=~Db,l&=~Gl,s.suspendedLanes|=l,s.pingedLanes&=~l,g&&(s.warmLanes|=l),g=s.expirationTimes;for(var x=l;0<x;){var E=31-Oe(x),N=1<<E;g[E]=-1,x&=~N}f!==0&&ai(s,f,l)}function Zg(){return(Lt&6)===0?(Vf(0),!1):!0}function Ob(){if(St!==null){if(Gt===0)var s=St.return;else s=St,fs=Pl=null,Qy(s),uu=null,yf=0,s=St;for(;s!==null;)RA(s.alternate,s),s=s.return;St=null}}function xu(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,R5(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Es=0,Ob(),an=s,St=f=us(s.current,null),Ct=l,Gt=0,hi=null,bo=!1,vu=Nt(s,l),Rb=!1,yu=pi=Db=Gl=xo=Sn=0,Kr=Pf=null,kb=!1,(l&8)!==0&&(l|=l&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=l;0<g;){var x=31-Oe(g),E=1<<x;l|=s[x],g&=~E}return ws=l,bg(),f}function JA(s,l){vt=null,H.H=Af,l===cu||l===Cg?(l=gT(),Gt=3):l===Ly?(l=gT(),Gt=4):Gt=l===hb?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,hi=l,St===null&&(Sn=1,Ug(s,Ti(l,s.current)))}function eC(){var s=di.current;return s===null?!0:(Ct&4194048)===Ct?Ri===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?s===Ri:!1}function tC(){var s=H.H;return H.H=Af,s===null?Af:s}function nC(){var s=H.A;return H.A=o5,s}function Jg(){Sn=4,bo||(Ct&4194048)!==Ct&&di.current!==null||(vu=!0),(xo&134217727)===0&&(Gl&134217727)===0||an===null||Eo(an,Ct,pi,!1)}function Vb(s,l,f){var g=Lt;Lt|=2;var x=tC(),E=nC();(an!==s||Ct!==l)&&(Qg=null,xu(s,l)),l=!1;var N=Sn;e:do try{if(Gt!==0&&St!==null){var F=St,X=hi;switch(Gt){case 8:Ob(),N=6;break e;case 3:case 2:case 9:case 6:di.current===null&&(l=!0);var le=Gt;if(Gt=0,hi=null,_u(s,F,X,le),f&&vu){N=0;break e}break;default:le=Gt,Gt=0,hi=null,_u(s,F,X,le)}}u5(),N=Sn;break}catch(me){JA(s,me)}while(!0);return l&&s.shellSuspendCounter++,fs=Pl=null,Lt=g,H.H=x,H.A=E,St===null&&(an=null,Ct=0,bg()),N}function u5(){for(;St!==null;)rC(St)}function d5(s,l){var f=Lt;Lt|=2;var g=tC(),x=nC();an!==s||Ct!==l?(Qg=null,Wg=st()+500,xu(s,l)):vu=Nt(s,l);e:do try{if(Gt!==0&&St!==null){l=St;var E=hi;t:switch(Gt){case 1:Gt=0,hi=null,_u(s,l,E,1);break;case 2:case 9:if(hT(E)){Gt=0,hi=null,iC(l);break}l=function(){Gt!==2&&Gt!==9||an!==s||(Gt=7),Oa(s)},E.then(l,l);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:hT(E)?(Gt=0,hi=null,iC(l)):(Gt=0,hi=null,_u(s,l,E,7));break;case 5:var N=null;switch(St.tag){case 26:N=St.memoizedState;case 5:case 27:var F=St;if(N?GC(N):F.stateNode.complete){Gt=0,hi=null;var X=F.sibling;if(X!==null)St=X;else{var le=F.return;le!==null?(St=le,em(le)):St=null}break t}}Gt=0,hi=null,_u(s,l,E,5);break;case 6:Gt=0,hi=null,_u(s,l,E,6);break;case 8:Ob(),Sn=6;break e;default:throw Error(r(462))}}f5();break}catch(me){JA(s,me)}while(!0);return fs=Pl=null,H.H=g,H.A=x,Lt=f,St!==null?0:(an=null,Ct=0,bg(),Sn)}function f5(){for(;St!==null&&!tn();)rC(St)}function rC(s){var l=CA(s.alternate,s,ws);s.memoizedProps=s.pendingProps,l===null?em(s):St=l}function iC(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=_A(f,l,l.pendingProps,l.type,void 0,Ct);break;case 11:l=_A(f,l,l.pendingProps,l.type.render,l.ref,Ct);break;case 5:Qy(l);default:RA(f,l),l=St=nT(l,ws),l=CA(f,l,ws)}s.memoizedProps=s.pendingProps,l===null?em(s):St=l}function _u(s,l,f,g){fs=Pl=null,Qy(l),uu=null,yf=0;var x=l.return;try{if(e5(s,x,l,f,Ct)){Sn=1,Ug(s,Ti(f,s.current)),St=null;return}}catch(E){if(x!==null)throw St=x,E;Sn=1,Ug(s,Ti(f,s.current)),St=null;return}l.flags&32768?(Mt||g===1?s=!0:vu||(Ct&536870912)!==0?s=!1:(bo=s=!0,(g===2||g===9||g===3||g===6)&&(g=di.current,g!==null&&g.tag===13&&(g.flags|=16384))),aC(l,s)):em(l)}function em(s){var l=s;do{if((l.flags&32768)!==0){aC(l,bo);return}s=l.return;var f=r5(l.alternate,l,ws);if(f!==null){St=f;return}if(l=l.sibling,l!==null){St=l;return}St=l=s}while(l!==null);Sn===0&&(Sn=5)}function aC(s,l){do{var f=i5(s.alternate,s);if(f!==null){f.flags&=32767,St=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){St=s;return}St=s=f}while(s!==null);Sn=6,St=null}function sC(s,l,f,g,x,E,N,F,X){s.cancelPendingCommit=null;do tm();while(Zn!==0);if((Lt&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Sy,dr(s,f,E,N,F,X),s===an&&(St=an=null,Ct=0),bu=l,wo=s,Es=f,Nb=E,Mb=x,XA=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,m5(ii,function(){return dC(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=H.T,H.T=null,x=$.p,$.p=2,N=Lt,Lt|=4;try{a5(s,l,f)}finally{Lt=N,$.p=x,H.T=g}}Zn=1,oC(),lC(),cC()}}function oC(){if(Zn===1){Zn=0;var s=wo,l=bu,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=H.T,H.T=null;var g=$.p;$.p=2;var x=Lt;Lt|=4;try{UA(l,s);var E=Kb,N=YS(s.containerInfo),F=E.focusedElem,X=E.selectionRange;if(N!==F&&F&&F.ownerDocument&&$S(F.ownerDocument.documentElement,F)){if(X!==null&&by(F)){var le=X.start,me=X.end;if(me===void 0&&(me=le),"selectionStart"in F)F.selectionStart=le,F.selectionEnd=Math.min(me,F.value.length);else{var be=F.ownerDocument||document,de=be&&be.defaultView||window;if(de.getSelection){var pe=de.getSelection(),Le=F.textContent.length,Qe=Math.min(X.start,Le),Zt=X.end===void 0?Qe:Math.min(X.end,Le);!pe.extend&&Qe>Zt&&(N=Zt,Zt=Qe,Qe=N);var ie=HS(F,Qe),ee=HS(F,Zt);if(ie&&ee&&(pe.rangeCount!==1||pe.anchorNode!==ie.node||pe.anchorOffset!==ie.offset||pe.focusNode!==ee.node||pe.focusOffset!==ee.offset)){var oe=be.createRange();oe.setStart(ie.node,ie.offset),pe.removeAllRanges(),Qe>Zt?(pe.addRange(oe),pe.extend(ee.node,ee.offset)):(oe.setEnd(ee.node,ee.offset),pe.addRange(oe))}}}}for(be=[],pe=F;pe=pe.parentNode;)pe.nodeType===1&&be.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<be.length;F++){var ve=be[F];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}hm=!!Yb,Kb=Yb=null}finally{Lt=x,$.p=g,H.T=f}}s.current=l,Zn=2}}function lC(){if(Zn===2){Zn=0;var s=wo,l=bu,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=H.T,H.T=null;var g=$.p;$.p=2;var x=Lt;Lt|=4;try{VA(s,l.alternate,l)}finally{Lt=x,$.p=g,H.T=f}}Zn=3}}function cC(){if(Zn===4||Zn===3){Zn=0,Yt();var s=wo,l=bu,f=Es,g=XA;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Zn=5:(Zn=0,bu=wo=null,uC(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(_o=null),ss(f),l=l.stateNode,_n&&typeof _n.onCommitFiberRoot=="function")try{_n.onCommitFiberRoot(Nr,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=H.T,x=$.p,$.p=2,H.T=null;try{for(var E=s.onRecoverableError,N=0;N<g.length;N++){var F=g[N];E(F.value,{componentStack:F.stack})}}finally{H.T=l,$.p=x}}(Es&3)!==0&&tm(),Oa(s),x=s.pendingLanes,(f&261930)!==0&&(x&42)!==0?s===Pb?Of++:(Of=0,Pb=s):Of=0,Vf(0)}}function uC(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,mf(l)))}function tm(){return oC(),lC(),cC(),dC()}function dC(){if(Zn!==5)return!1;var s=wo,l=Nb;Nb=0;var f=ss(Es),g=H.T,x=$.p;try{$.p=32>f?32:f,H.T=null,f=Mb,Mb=null;var E=wo,N=Es;if(Zn=0,bu=wo=null,Es=0,(Lt&6)!==0)throw Error(r(331));var F=Lt;if(Lt|=4,$A(E.current),GA(E,E.current,N,f),Lt=F,Vf(0,!1),_n&&typeof _n.onPostCommitFiberRoot=="function")try{_n.onPostCommitFiberRoot(Nr,E)}catch{}return!0}finally{$.p=x,H.T=g,uC(s,l)}}function fC(s,l,f){l=Ti(f,l),l=fb(s.stateNode,l,2),s=go(s,l,2),s!==null&&(rn(s,2),Oa(s))}function qt(s,l,f){if(s.tag===3)fC(s,s,f);else for(;l!==null;){if(l.tag===3){fC(l,s,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(_o===null||!_o.has(g))){s=Ti(f,s),f=hA(2),g=go(l,f,2),g!==null&&(pA(f,g,l,s),rn(g,2),Oa(g));break}}l=l.return}}function jb(s,l,f){var g=s.pingCache;if(g===null){g=s.pingCache=new l5;var x=new Set;g.set(l,x)}else x=g.get(l),x===void 0&&(x=new Set,g.set(l,x));x.has(f)||(Rb=!0,x.add(f),s=h5.bind(null,s,l,f),l.then(s,s))}function h5(s,l,f){var g=s.pingCache;g!==null&&g.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,an===s&&(Ct&f)===f&&(Sn===4||Sn===3&&(Ct&62914560)===Ct&&300>st()-Xg?(Lt&2)===0&&xu(s,0):Db|=f,yu===Ct&&(yu=0)),Oa(s)}function hC(s,l){l===0&&(l=wn()),s=kl(s,l),s!==null&&(rn(s,l),Oa(s))}function p5(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),hC(s,f)}function g5(s,l){var f=0;switch(s.tag){case 31:case 13:var g=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(l),hC(s,f)}function m5(s,l){return je(s,l)}var nm=null,wu=null,zb=!1,rm=!1,Lb=!1,So=0;function Oa(s){s!==wu&&s.next===null&&(wu===null?nm=wu=s:wu=wu.next=s),rm=!0,zb||(zb=!0,y5())}function Vf(s,l){if(!Lb&&rm){Lb=!0;do for(var f=!1,g=nm;g!==null;){if(s!==0){var x=g.pendingLanes;if(x===0)var E=0;else{var N=g.suspendedLanes,F=g.pingedLanes;E=(1<<31-Oe(42|s)+1)-1,E&=x&~(N&~F),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,vC(g,E))}else E=Ct,E=ct(g,g===an?E:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(E&3)===0||Nt(g,E)||(f=!0,vC(g,E));g=g.next}while(f);Lb=!1}}function v5(){pC()}function pC(){rm=zb=!1;var s=0;So!==0&&I5()&&(s=So);for(var l=st(),f=null,g=nm;g!==null;){var x=g.next,E=gC(g,l);E===0?(g.next=null,f===null?nm=x:f.next=x,x===null&&(wu=f)):(f=g,(s!==0||(E&3)!==0)&&(rm=!0)),g=x}Zn!==0&&Zn!==5||Vf(s),So!==0&&(So=0)}function gC(s,l){for(var f=s.suspendedLanes,g=s.pingedLanes,x=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var N=31-Oe(E),F=1<<N,X=x[N];X===-1?((F&f)===0||(F&g)!==0)&&(x[N]=nn(F,l)):X<=l&&(s.expiredLanes|=F),E&=~F}if(l=an,f=Ct,f=ct(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,f===0||s===l&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&We(g),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||Nt(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(g!==null&&We(g),ss(f)){case 2:case 8:f=Vn;break;case 32:f=ii;break;case 268435456:f=Zs;break;default:f=ii}return g=mC.bind(null,s),f=je(f,g),s.callbackPriority=l,s.callbackNode=f,l}return g!==null&&g!==null&&We(g),s.callbackPriority=2,s.callbackNode=null,2}function mC(s,l){if(Zn!==0&&Zn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(tm()&&s.callbackNode!==f)return null;var g=Ct;return g=ct(s,s===an?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(QA(s,g,l),gC(s,st()),s.callbackNode!=null&&s.callbackNode===f?mC.bind(null,s):null)}function vC(s,l){if(tm())return null;QA(s,l,!0)}function y5(){D5(function(){(Lt&6)!==0?je(Kt,v5):pC()})}function Bb(){if(So===0){var s=ou;s===0&&(s=lt,lt<<=1,(lt&261888)===0&&(lt=256)),So=s}return So}function yC(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$c(""+s)}function bC(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function b5(s,l,f,g,x){if(l==="submit"&&f&&f.stateNode===x){var E=yC((x[sr]||null).action),N=g.submitter;N&&(l=(l=N[sr]||null)?yC(l.formAction):N.getAttribute("formAction"),l!==null&&(E=l,N=null));var F=new Ia("action","action",null,g,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(So!==0){var X=N?bC(x,N):new FormData(x);sb(f,{pending:!0,data:X,method:x.method,action:E},null,X)}}else typeof E=="function"&&(F.preventDefault(),X=N?bC(x,N):new FormData(x),sb(f,{pending:!0,data:X,method:x.method,action:E},E,X))},currentTarget:x}]})}}for(var Ub=0;Ub<Ey.length;Ub++){var Fb=Ey[Ub],x5=Fb.toLowerCase(),_5=Fb[0].toUpperCase()+Fb.slice(1);ta(x5,"on"+_5)}ta(WS,"onAnimationEnd"),ta(QS,"onAnimationIteration"),ta(ZS,"onAnimationStart"),ta("dblclick","onDoubleClick"),ta("focusin","onFocus"),ta("focusout","onBlur"),ta(jj,"onTransitionRun"),ta(zj,"onTransitionStart"),ta(Lj,"onTransitionCancel"),ta(JS,"onTransitionEnd"),Sa("onMouseEnter",["mouseout","mouseover"]),Sa("onMouseLeave",["mouseout","mouseover"]),Sa("onPointerEnter",["pointerout","pointerover"]),Sa("onPointerLeave",["pointerout","pointerover"]),Ea("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ea("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ea("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ea("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ea("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ea("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w5=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(jf));function xC(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var g=s[f],x=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var N=g.length-1;0<=N;N--){var F=g[N],X=F.instance,le=F.currentTarget;if(F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=le;try{E(x)}catch(me){yg(me)}x.currentTarget=null,E=X}else for(N=0;N<g.length;N++){if(F=g[N],X=F.instance,le=F.currentTarget,F=F.listener,X!==E&&x.isPropagationStopped())break e;E=F,x.currentTarget=le;try{E(x)}catch(me){yg(me)}x.currentTarget=null,E=X}}}}function Tt(s,l){var f=l[Uc];f===void 0&&(f=l[Uc]=new Set);var g=s+"__bubble";f.has(g)||(_C(l,s,2,!1),f.add(g))}function Gb(s,l,f){var g=0;l&&(g|=4),_C(f,s,g,l)}var im="_reactListening"+Math.random().toString(36).slice(2);function qb(s){if(!s[im]){s[im]=!0,Kd.forEach(function(f){f!=="selectionchange"&&(w5.has(f)||Gb(f,!1,s),Gb(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[im]||(l[im]=!0,Gb("selectionchange",!1,l))}}function _C(s,l,f,g){switch(WC(l)){case 2:var x=W5;break;case 8:x=Q5;break;default:x=ax}f=x.bind(null,l,f,s),x=void 0,!El||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),g?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Hb(s,l,f,g,x){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var F=g.stateNode.containerInfo;if(F===x)break;if(N===4)for(N=g.return;N!==null;){var X=N.tag;if((X===3||X===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;F!==null;){if(N=_a(F),N===null)return;if(X=N.tag,X===5||X===6||X===26||X===27){g=E=N;continue e}F=F.parentNode}}g=g.return}io(function(){var le=E,me=_i(f),be=[];e:{var de=eT.get(s);if(de!==void 0){var pe=Ia,Le=s;switch(s){case"keypress":if(Tl(f)===0)break e;case"keydown":case"keyup":pe=gg;break;case"focusin":Le="focus",pe=Cl;break;case"focusout":Le="blur",pe=Cl;break;case"beforeblur":case"afterblur":pe=Cl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=lf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=sg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=R;break;case WS:case QS:case ZS:pe=lg;break;case JS:pe=q;break;case"scroll":case"scrollend":pe=of;break;case"wheel":pe=he;break;case"copy":case"cut":case"paste":pe=cg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=cs;break;case"toggle":case"beforetoggle":pe=mt}var Qe=(l&4)!==0,Zt=!Qe&&(s==="scroll"||s==="scrollend"),ie=Qe?de!==null?de+"Capture":null:de;Qe=[];for(var ee=le,oe;ee!==null;){var ve=ee;if(oe=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||oe===null||ie===null||(ve=Qi(ee,ie),ve!=null&&Qe.push(zf(ee,ve,oe))),Zt)break;ee=ee.return}0<Qe.length&&(de=new pe(de,Le,null,f,me),be.push({event:de,listeners:Qe}))}}if((l&7)===0){e:{if(de=s==="mouseover"||s==="pointerover",pe=s==="mouseout"||s==="pointerout",de&&f!==rf&&(Le=f.relatedTarget||f.fromElement)&&(_a(Le)||Le[ba]))break e;if((pe||de)&&(de=me.window===me?me:(de=me.ownerDocument)?de.defaultView||de.parentWindow:window,pe?(Le=f.relatedTarget||f.toElement,pe=le,Le=Le?_a(Le):null,Le!==null&&(Zt=a(Le),Qe=Le.tag,Le!==Zt||Qe!==5&&Qe!==27&&Qe!==6)&&(Le=null)):(pe=null,Le=le),pe!==Le)){if(Qe=lf,ve="onMouseLeave",ie="onMouseEnter",ee="mouse",(s==="pointerout"||s==="pointerover")&&(Qe=cs,ve="onPointerLeave",ie="onPointerEnter",ee="pointer"),Zt=pe==null?de:oi(pe),oe=Le==null?de:oi(Le),de=new Qe(ve,ee+"leave",pe,f,me),de.target=Zt,de.relatedTarget=oe,ve=null,_a(me)===le&&(Qe=new Qe(ie,ee+"enter",Le,f,me),Qe.target=oe,Qe.relatedTarget=Zt,ve=Qe),Zt=ve,pe&&Le)t:{for(Qe=E5,ie=pe,ee=Le,oe=0,ve=ie;ve;ve=Qe(ve))oe++;ve=0;for(var Ye=ee;Ye;Ye=Qe(Ye))ve++;for(;0<oe-ve;)ie=Qe(ie),oe--;for(;0<ve-oe;)ee=Qe(ee),ve--;for(;oe--;){if(ie===ee||ee!==null&&ie===ee.alternate){Qe=ie;break t}ie=Qe(ie),ee=Qe(ee)}Qe=null}else Qe=null;pe!==null&&wC(be,de,pe,Qe,!1),Le!==null&&Zt!==null&&wC(be,Zt,Le,Qe,!0)}}e:{if(de=le?oi(le):window,pe=de.nodeName&&de.nodeName.toLowerCase(),pe==="select"||pe==="input"&&de.type==="file")var Vt=LS;else if(jS(de))if(BS)Vt=Pj;else{Vt=Nj;var Fe=kj}else pe=de.nodeName,!pe||pe.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?le&&Hc(le.elementType)&&(Vt=LS):Vt=Mj;if(Vt&&(Vt=Vt(s,le))){zS(be,Vt,f,me);break e}Fe&&Fe(s,de,le),s==="focusout"&&le&&de.type==="number"&&le.memoizedProps.value!=null&&ef(de,"number",de.value)}switch(Fe=le?oi(le):window,s){case"focusin":(jS(Fe)||Fe.contentEditable==="true")&&(Jc=Fe,xy=le,hf=null);break;case"focusout":hf=xy=Jc=null;break;case"mousedown":_y=!0;break;case"contextmenu":case"mouseup":case"dragend":_y=!1,KS(be,f,me);break;case"selectionchange":if(Vj)break;case"keydown":case"keyup":KS(be,f,me)}var bt;if(zt)e:{switch(s){case"compositionstart":var It="onCompositionStart";break e;case"compositionend":It="onCompositionEnd";break e;case"compositionupdate":It="onCompositionUpdate";break e}It=void 0}else Zc?Il(s,f)&&(It="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(It="onCompositionStart");It&&(ka&&f.locale!=="ko"&&(Zc||It!=="onCompositionStart"?It==="onCompositionEnd"&&Zc&&(bt=sf()):(Ca=me,af="value"in Ca?Ca.value:Ca.textContent,Zc=!0)),Fe=am(le,It),0<Fe.length&&(It=new Da(It,s,null,f,me),be.push({event:It,listeners:Fe}),bt?It.data=bt:(bt=Qc(f),bt!==null&&(It.data=bt)))),(bt=Ei?Cj(s,f):Ij(s,f))&&(It=am(le,"onBeforeInput"),0<It.length&&(Fe=new Da("onBeforeInput","beforeinput",null,f,me),be.push({event:Fe,listeners:It}),Fe.data=bt)),b5(be,s,le,f,me)}xC(be,l)})}function zf(s,l,f){return{instance:s,listener:l,currentTarget:f}}function am(s,l){for(var f=l+"Capture",g=[];s!==null;){var x=s,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=Qi(s,f),x!=null&&g.unshift(zf(s,x,E)),x=Qi(s,l),x!=null&&g.push(zf(s,x,E))),s.tag===3)return g;s=s.return}return[]}function E5(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function wC(s,l,f,g,x){for(var E=l._reactName,N=[];f!==null&&f!==g;){var F=f,X=F.alternate,le=F.stateNode;if(F=F.tag,X!==null&&X===g)break;F!==5&&F!==26&&F!==27||le===null||(X=le,x?(le=Qi(f,E),le!=null&&N.unshift(zf(f,le,X))):x||(le=Qi(f,E),le!=null&&N.push(zf(f,le,X)))),f=f.return}N.length!==0&&s.push({event:l,listeners:N})}var S5=/\r\n?/g,T5=/\u0000|\uFFFD/g;function EC(s){return(typeof s=="string"?s:""+s).replace(S5,`
`).replace(T5,"")}function SC(s,l){return l=EC(l),EC(s)===l}function Qt(s,l,f,g,x,E){switch(f){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||qr(s,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&qr(s,""+g);break;case"className":li(s,"class",g);break;case"tabIndex":li(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":li(s,f,g);break;case"style":nf(s,g,E);break;case"data":if(l!=="object"){li(s,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(l!=="input"&&Qt(s,l,"name",x.name,x,null),Qt(s,l,"formEncType",x.formEncType,x,null),Qt(s,l,"formMethod",x.formMethod,x,null),Qt(s,l,"formTarget",x.formTarget,x,null)):(Qt(s,l,"encType",x.encType,x,null),Qt(s,l,"method",x.method,x,null),Qt(s,l,"target",x.target,x,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(f);break}g=$c(""+g),s.setAttribute(f,g);break;case"onClick":g!=null&&(s.onclick=Wi);break;case"onScroll":g!=null&&Tt("scroll",s);break;case"onScrollEnd":g!=null&&Tt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}f=$c(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""+g):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":g===!0?s.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(f,g):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(f,g):s.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(f):s.setAttribute(f,g);break;case"popover":Tt("beforetoggle",s),Tt("toggle",s),Gc(s,"popover",g);break;case"xlinkActuate":Ln(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Ln(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Ln(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Ln(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Ln(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Ln(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Ln(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Ln(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Ln(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Gc(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=ag.get(f)||f,Gc(s,f,g))}}function $b(s,l,f,g,x,E){switch(f){case"style":nf(s,g,E);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(f=g.__html,f!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof g=="string"?qr(s,g):(typeof g=="number"||typeof g=="bigint")&&qr(s,""+g);break;case"onScroll":g!=null&&Tt("scroll",s);break;case"onScrollEnd":g!=null&&Tt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Wi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xd.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),l=f.slice(2,x?f.length-7:void 0),E=s[sr]||null,E=E!=null?E[f]:null,typeof E=="function"&&s.removeEventListener(l,E,x),typeof g=="function")){typeof E!="function"&&E!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,g,x);break e}f in s?s[f]=g:g===!0?s.setAttribute(f,""):Gc(s,f,g)}}}function vr(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Tt("error",s),Tt("load",s);var g=!1,x=!1,E;for(E in f)if(f.hasOwnProperty(E)){var N=f[E];if(N!=null)switch(E){case"src":g=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Qt(s,l,E,N,f,null)}}x&&Qt(s,l,"srcSet",f.srcSet,f,null),g&&Qt(s,l,"src",f.src,f,null);return;case"input":Tt("invalid",s);var F=E=N=x=null,X=null,le=null;for(g in f)if(f.hasOwnProperty(g)){var me=f[g];if(me!=null)switch(g){case"name":x=me;break;case"type":N=me;break;case"checked":X=me;break;case"defaultChecked":le=me;break;case"value":E=me;break;case"defaultValue":F=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,l));break;default:Qt(s,l,g,me,f,null)}}ng(s,E,F,X,le,N,x,!1);return;case"select":Tt("invalid",s),g=N=E=null;for(x in f)if(f.hasOwnProperty(x)&&(F=f[x],F!=null))switch(x){case"value":E=F;break;case"defaultValue":N=F;break;case"multiple":g=F;default:Qt(s,l,x,F,f,null)}l=E,f=N,s.multiple=!!g,l!=null?eo(s,!!g,l,!1):f!=null&&eo(s,!!g,f,!0);return;case"textarea":Tt("invalid",s),E=x=g=null;for(N in f)if(f.hasOwnProperty(N)&&(F=f[N],F!=null))switch(N){case"value":g=F;break;case"defaultValue":x=F;break;case"children":E=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(91));break;default:Qt(s,l,N,F,f,null)}to(s,g,x,E);return;case"option":for(X in f)if(f.hasOwnProperty(X)&&(g=f[X],g!=null))switch(X){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Qt(s,l,X,g,f,null)}return;case"dialog":Tt("beforetoggle",s),Tt("toggle",s),Tt("cancel",s),Tt("close",s);break;case"iframe":case"object":Tt("load",s);break;case"video":case"audio":for(g=0;g<jf.length;g++)Tt(jf[g],s);break;case"image":Tt("error",s),Tt("load",s);break;case"details":Tt("toggle",s);break;case"embed":case"source":case"link":Tt("error",s),Tt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in f)if(f.hasOwnProperty(le)&&(g=f[le],g!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Qt(s,l,le,g,f,null)}return;default:if(Hc(l)){for(me in f)f.hasOwnProperty(me)&&(g=f[me],g!==void 0&&$b(s,l,me,g,f,void 0));return}}for(F in f)f.hasOwnProperty(F)&&(g=f[F],g!=null&&Qt(s,l,F,g,f,null))}function A5(s,l,f,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,N=null,F=null,X=null,le=null,me=null;for(pe in f){var be=f[pe];if(f.hasOwnProperty(pe)&&be!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":X=be;default:g.hasOwnProperty(pe)||Qt(s,l,pe,null,g,be)}}for(var de in g){var pe=g[de];if(be=f[de],g.hasOwnProperty(de)&&(pe!=null||be!=null))switch(de){case"type":E=pe;break;case"name":x=pe;break;case"checked":le=pe;break;case"defaultChecked":me=pe;break;case"value":N=pe;break;case"defaultValue":F=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,l));break;default:pe!==be&&Qt(s,l,de,pe,g,be)}}qc(s,N,F,X,le,me,E,x);return;case"select":pe=N=F=de=null;for(E in f)if(X=f[E],f.hasOwnProperty(E)&&X!=null)switch(E){case"value":break;case"multiple":pe=X;default:g.hasOwnProperty(E)||Qt(s,l,E,null,g,X)}for(x in g)if(E=g[x],X=f[x],g.hasOwnProperty(x)&&(E!=null||X!=null))switch(x){case"value":de=E;break;case"defaultValue":F=E;break;case"multiple":N=E;default:E!==X&&Qt(s,l,x,E,g,X)}l=F,f=N,g=pe,de!=null?eo(s,!!f,de,!1):!!g!=!!f&&(l!=null?eo(s,!!f,l,!0):eo(s,!!f,f?[]:"",!1));return;case"textarea":pe=de=null;for(F in f)if(x=f[F],f.hasOwnProperty(F)&&x!=null&&!g.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:Qt(s,l,F,null,g,x)}for(N in g)if(x=g[N],E=f[N],g.hasOwnProperty(N)&&(x!=null||E!=null))switch(N){case"value":de=x;break;case"defaultValue":pe=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==E&&Qt(s,l,N,x,g,E)}rg(s,de,pe);return;case"option":for(var Le in f)if(de=f[Le],f.hasOwnProperty(Le)&&de!=null&&!g.hasOwnProperty(Le))switch(Le){case"selected":s.selected=!1;break;default:Qt(s,l,Le,null,g,de)}for(X in g)if(de=g[X],pe=f[X],g.hasOwnProperty(X)&&de!==pe&&(de!=null||pe!=null))switch(X){case"selected":s.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:Qt(s,l,X,de,g,pe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in f)de=f[Qe],f.hasOwnProperty(Qe)&&de!=null&&!g.hasOwnProperty(Qe)&&Qt(s,l,Qe,null,g,de);for(le in g)if(de=g[le],pe=f[le],g.hasOwnProperty(le)&&de!==pe&&(de!=null||pe!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,l));break;default:Qt(s,l,le,de,g,pe)}return;default:if(Hc(l)){for(var Zt in f)de=f[Zt],f.hasOwnProperty(Zt)&&de!==void 0&&!g.hasOwnProperty(Zt)&&$b(s,l,Zt,void 0,g,de);for(me in g)de=g[me],pe=f[me],!g.hasOwnProperty(me)||de===pe||de===void 0&&pe===void 0||$b(s,l,me,de,g,pe);return}}for(var ie in f)de=f[ie],f.hasOwnProperty(ie)&&de!=null&&!g.hasOwnProperty(ie)&&Qt(s,l,ie,null,g,de);for(be in g)de=g[be],pe=f[be],!g.hasOwnProperty(be)||de===pe||de==null&&pe==null||Qt(s,l,be,de,g,pe)}function TC(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function C5(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),g=0;g<f.length;g++){var x=f[g],E=x.transferSize,N=x.initiatorType,F=x.duration;if(E&&F&&TC(N)){for(N=0,F=x.responseEnd,g+=1;g<f.length;g++){var X=f[g],le=X.startTime;if(le>F)break;var me=X.transferSize,be=X.initiatorType;me&&TC(be)&&(X=X.responseEnd,N+=me*(X<F?1:(F-le)/(X-le)))}if(--g,l+=8*(E+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Yb=null,Kb=null;function sm(s){return s.nodeType===9?s:s.ownerDocument}function AC(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function CC(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Xb(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Wb=null;function I5(){var s=window.event;return s&&s.type==="popstate"?s===Wb?!1:(Wb=s,!0):(Wb=null,!1)}var IC=typeof setTimeout=="function"?setTimeout:void 0,R5=typeof clearTimeout=="function"?clearTimeout:void 0,RC=typeof Promise=="function"?Promise:void 0,D5=typeof queueMicrotask=="function"?queueMicrotask:typeof RC<"u"?function(s){return RC.resolve(null).then(s).catch(k5)}:IC;function k5(s){setTimeout(function(){throw s})}function To(s){return s==="head"}function DC(s,l){var f=l,g=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"||f==="/&"){if(g===0){s.removeChild(x),Au(l);return}g--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")g++;else if(f==="html")Lf(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,Lf(f);for(var E=f.firstChild;E;){var N=E.nextSibling,F=E.nodeName;E[xa]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=N}}else f==="body"&&Lf(s.ownerDocument.body);f=x}while(f);Au(l)}function kC(s,l){var f=s;s=0;do{var g=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),g&&g.nodeType===8)if(f=g.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=g}while(f)}function Qb(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Qb(f),Fc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function N5(s,l,f,g){for(;s.nodeType===1;){var x=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[xa])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Di(s.nextSibling),s===null)break}return null}function M5(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=Di(s.nextSibling),s===null))return null;return s}function NC(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Di(s.nextSibling),s===null))return null;return s}function Zb(s){return s.data==="$?"||s.data==="$~"}function Jb(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function P5(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var g=function(){l(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Di(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var ex=null;function MC(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return Di(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function PC(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function OC(s,l,f){switch(l=sm(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Lf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Fc(s)}var ki=new Map,VC=new Set;function om(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ss=$.d;$.d={f:O5,r:V5,D:j5,C:z5,L:L5,m:B5,X:F5,S:U5,M:G5};function O5(){var s=Ss.f(),l=Zg();return s||l}function V5(s){var l=xi(s);l!==null&&l.tag===5&&l.type==="form"?JT(l):Ss.r(s)}var Eu=typeof document>"u"?null:document;function jC(s,l,f){var g=Eu;if(g&&typeof l=="string"&&l){var x=Gr(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),VC.has(x)||(VC.add(x),s={rel:s,crossOrigin:f,href:l},g.querySelector(x)===null&&(l=g.createElement("link"),vr(l,"link",s),zn(l),g.head.appendChild(l)))}}function j5(s){Ss.D(s),jC("dns-prefetch",s,null)}function z5(s,l){Ss.C(s,l),jC("preconnect",s,l)}function L5(s,l,f){Ss.L(s,l,f);var g=Eu;if(g&&s&&l){var x='link[rel="preload"][as="'+Gr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+Gr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+Gr(f.imageSizes)+'"]')):x+='[href="'+Gr(s)+'"]';var E=x;switch(l){case"style":E=Su(s);break;case"script":E=Tu(s)}ki.has(E)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),ki.set(E,s),g.querySelector(x)!==null||l==="style"&&g.querySelector(Bf(E))||l==="script"&&g.querySelector(Uf(E))||(l=g.createElement("link"),vr(l,"link",s),zn(l),g.head.appendChild(l)))}}function B5(s,l){Ss.m(s,l);var f=Eu;if(f&&s){var g=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+Gr(g)+'"][href="'+Gr(s)+'"]',E=x;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Tu(s)}if(!ki.has(E)&&(s=p({rel:"modulepreload",href:s},l),ki.set(E,s),f.querySelector(x)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Uf(E)))return}g=f.createElement("link"),vr(g,"link",s),zn(g),f.head.appendChild(g)}}}function U5(s,l,f){Ss.S(s,l,f);var g=Eu;if(g&&s){var x=wa(g).hoistableStyles,E=Su(s);l=l||"default";var N=x.get(E);if(!N){var F={loading:0,preload:null};if(N=g.querySelector(Bf(E)))F.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=ki.get(E))&&tx(s,f);var X=N=g.createElement("link");zn(X),vr(X,"link",s),X._p=new Promise(function(le,me){X.onload=le,X.onerror=me}),X.addEventListener("load",function(){F.loading|=1}),X.addEventListener("error",function(){F.loading|=2}),F.loading|=4,lm(N,l,g)}N={type:"stylesheet",instance:N,count:1,state:F},x.set(E,N)}}}function F5(s,l){Ss.X(s,l);var f=Eu;if(f&&s){var g=wa(f).hoistableScripts,x=Tu(s),E=g.get(x);E||(E=f.querySelector(Uf(x)),E||(s=p({src:s,async:!0},l),(l=ki.get(x))&&nx(s,l),E=f.createElement("script"),zn(E),vr(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function G5(s,l){Ss.M(s,l);var f=Eu;if(f&&s){var g=wa(f).hoistableScripts,x=Tu(s),E=g.get(x);E||(E=f.querySelector(Uf(x)),E||(s=p({src:s,async:!0,type:"module"},l),(l=ki.get(x))&&nx(s,l),E=f.createElement("script"),zn(E),vr(E,"link",s),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},g.set(x,E))}}function zC(s,l,f,g){var x=(x=fe.current)?om(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Su(f.href),f=wa(x).hoistableStyles,g=f.get(l),g||(g={type:"style",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=Su(f.href);var E=wa(x).hoistableStyles,N=E.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,N),(E=x.querySelector(Bf(s)))&&!E._p&&(N.instance=E,N.state.loading=5),ki.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},ki.set(s,f),E||q5(x,s,f,N.state))),l&&g===null)throw Error(r(528,""));return N}if(l&&g!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Tu(f),f=wa(x).hoistableScripts,g=f.get(l),g||(g={type:"script",instance:null,count:0,state:null},f.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Su(s){return'href="'+Gr(s)+'"'}function Bf(s){return'link[rel="stylesheet"]['+s+"]"}function LC(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function q5(s,l,f,g){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=s.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),vr(l,"link",f),zn(l),s.head.appendChild(l))}function Tu(s){return'[src="'+Gr(s)+'"]'}function Uf(s){return"script[async]"+s}function BC(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var g=s.querySelector('style[data-href~="'+Gr(f.href)+'"]');if(g)return l.instance=g,zn(g),g;var x=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),zn(g),vr(g,"style",x),lm(g,f.precedence,s),l.instance=g;case"stylesheet":x=Su(f.href);var E=s.querySelector(Bf(x));if(E)return l.state.loading|=4,l.instance=E,zn(E),E;g=LC(f),(x=ki.get(x))&&tx(g,x),E=(s.ownerDocument||s).createElement("link"),zn(E);var N=E;return N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),vr(E,"link",g),l.state.loading|=4,lm(E,f.precedence,s),l.instance=E;case"script":return E=Tu(f.src),(x=s.querySelector(Uf(E)))?(l.instance=x,zn(x),x):(g=f,(x=ki.get(E))&&(g=p({},f),nx(g,x)),s=s.ownerDocument||s,x=s.createElement("script"),zn(x),vr(x,"link",g),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,lm(g,f.precedence,s));return l.instance}function lm(s,l,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=g.length?g[g.length-1]:null,E=x,N=0;N<g.length;N++){var F=g[N];if(F.dataset.precedence===l)E=F;else if(E!==x)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function tx(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function nx(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var cm=null;function UC(s,l,f){if(cm===null){var g=new Map,x=cm=new Map;x.set(f,g)}else x=cm,g=x.get(f),g||(g=new Map,x.set(f,g));if(g.has(s))return g;for(g.set(s,null),f=f.getElementsByTagName(s),x=0;x<f.length;x++){var E=f[x];if(!(E[xa]||E[jn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var N=E.getAttribute(l)||"";N=s+N;var F=g.get(N);F?F.push(E):g.set(N,[E])}}return g}function FC(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function H5(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function GC(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function $5(s,l,f,g){if(f.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var x=Su(g.href),E=l.querySelector(Bf(x));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=um.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=E,zn(E);return}E=l.ownerDocument||l,g=LC(g),(x=ki.get(x))&&tx(g,x),E=E.createElement("link"),zn(E);var N=E;N._p=new Promise(function(F,X){N.onload=F,N.onerror=X}),vr(E,"link",g),f.instance=E}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=um.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var rx=0;function Y5(s,l){return s.stylesheets&&s.count===0&&fm(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var g=setTimeout(function(){if(s.stylesheets&&fm(s,s.stylesheets),s.unsuspend){var E=s.unsuspend;s.unsuspend=null,E()}},6e4+l);0<s.imgBytes&&rx===0&&(rx=62500*C5());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&fm(s,s.stylesheets),s.unsuspend)){var E=s.unsuspend;s.unsuspend=null,E()}},(s.imgBytes>rx?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(x)}}:null}function um(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var dm=null;function fm(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,dm=new Map,l.forEach(K5,s),dm=null,um.call(s))}function K5(s,l){if(!(l.state.loading&4)){var f=dm.get(s);if(f)var g=f.get(null);else{f=new Map,dm.set(s,f);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var N=x[E];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(f.set(N.dataset.precedence,N),g=N)}g&&f.set(null,g)}x=l.instance,N=x.getAttribute("data-precedence"),E=f.get(N)||g,E===g&&f.set(null,x),f.set(N,x),this.count++,g=um.bind(this),x.addEventListener("load",g),x.addEventListener("error",g),E?E.parentNode.insertBefore(x,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var Ff={$$typeof:D,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function X5(s,l,f,g,x,E,N,F,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.hiddenUpdates=gt(null),this.identifierPrefix=g,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function qC(s,l,f,g,x,E,N,F,X,le,me,be){return s=new X5(s,l,f,N,X,le,me,be,F),l=1,E===!0&&(l|=24),E=ui(3,null,null,l),s.current=E,E.stateNode=s,l=Vy(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:g,isDehydrated:f,cache:l},By(E),s}function HC(s){return s?(s=nu,s):nu}function $C(s,l,f,g,x,E){x=HC(x),g.context===null?g.context=x:g.pendingContext=x,g=po(l),g.payload={element:f},E=E===void 0?null:E,E!==null&&(g.callback=E),f=go(s,g,l),f!==null&&(Xr(f,s,l),xf(f,s,l))}function YC(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function ix(s,l){YC(s,l),(s=s.alternate)&&YC(s,l)}function KC(s){if(s.tag===13||s.tag===31){var l=kl(s,67108864);l!==null&&Xr(l,s,67108864),ix(s,67108864)}}function XC(s){if(s.tag===13||s.tag===31){var l=gi();l=fr(l);var f=kl(s,l);f!==null&&Xr(f,s,l),ix(s,l)}}var hm=!0;function W5(s,l,f,g){var x=H.T;H.T=null;var E=$.p;try{$.p=2,ax(s,l,f,g)}finally{$.p=E,H.T=x}}function Q5(s,l,f,g){var x=H.T;H.T=null;var E=$.p;try{$.p=8,ax(s,l,f,g)}finally{$.p=E,H.T=x}}function ax(s,l,f,g){if(hm){var x=sx(g);if(x===null)Hb(s,l,g,pm,f),QC(s,g);else if(J5(x,s,l,f,g))g.stopPropagation();else if(QC(s,g),l&4&&-1<Z5.indexOf(s)){for(;x!==null;){var E=xi(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var N=kt(E.pendingLanes);if(N!==0){var F=E;for(F.pendingLanes|=2,F.entangledLanes|=2;N;){var X=1<<31-Oe(N);F.entanglements[1]|=X,N&=~X}Oa(E),(Lt&6)===0&&(Wg=st()+500,Vf(0))}}break;case 31:case 13:F=kl(E,2),F!==null&&Xr(F,E,2),Zg(),ix(E,2)}if(E=sx(g),E===null&&Hb(s,l,g,pm,f),E===x)break;x=E}x!==null&&g.stopPropagation()}else Hb(s,l,g,null,f)}}function sx(s){return s=_i(s),ox(s)}var pm=null;function ox(s){if(pm=null,s=_a(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return pm=s,null}function WC(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(at()){case Kt:return 2;case Vn:return 8;case ii:case Qs:return 32;case Zs:return 268435456;default:return 32}default:return 32}}var lx=!1,Ao=null,Co=null,Io=null,Gf=new Map,qf=new Map,Ro=[],Z5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function QC(s,l){switch(s){case"focusin":case"focusout":Ao=null;break;case"dragenter":case"dragleave":Co=null;break;case"mouseover":case"mouseout":Io=null;break;case"pointerover":case"pointerout":Gf.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":qf.delete(l.pointerId)}}function Hf(s,l,f,g,x,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:E,targetContainers:[x]},l!==null&&(l=xi(l),l!==null&&KC(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function J5(s,l,f,g,x){switch(l){case"focusin":return Ao=Hf(Ao,s,l,f,g,x),!0;case"dragenter":return Co=Hf(Co,s,l,f,g,x),!0;case"mouseover":return Io=Hf(Io,s,l,f,g,x),!0;case"pointerover":var E=x.pointerId;return Gf.set(E,Hf(Gf.get(E)||null,s,l,f,g,x)),!0;case"gotpointercapture":return E=x.pointerId,qf.set(E,Hf(qf.get(E)||null,s,l,f,g,x)),!0}return!1}function ZC(s){var l=_a(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Ki(s.priority,function(){XC(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Ki(s.priority,function(){XC(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function gm(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=sx(s.nativeEvent);if(f===null){f=s.nativeEvent;var g=new f.constructor(f.type,f);rf=g,f.target.dispatchEvent(g),rf=null}else return l=xi(f),l!==null&&KC(l),s.blockedOn=f,!1;l.shift()}return!0}function JC(s,l,f){gm(s)&&f.delete(l)}function e6(){lx=!1,Ao!==null&&gm(Ao)&&(Ao=null),Co!==null&&gm(Co)&&(Co=null),Io!==null&&gm(Io)&&(Io=null),Gf.forEach(JC),qf.forEach(JC)}function mm(s,l){s.blockedOn===l&&(s.blockedOn=null,lx||(lx=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,e6)))}var vm=null;function e2(s){vm!==s&&(vm=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){vm===s&&(vm=null);for(var l=0;l<s.length;l+=3){var f=s[l],g=s[l+1],x=s[l+2];if(typeof g!="function"){if(ox(g||f)===null)continue;break}var E=xi(f);E!==null&&(s.splice(l,3),l-=3,sb(E,{pending:!0,data:x,method:f.method,action:g},g,x))}}))}function Au(s){function l(X){return mm(X,s)}Ao!==null&&mm(Ao,s),Co!==null&&mm(Co,s),Io!==null&&mm(Io,s),Gf.forEach(l),qf.forEach(l);for(var f=0;f<Ro.length;f++){var g=Ro[f];g.blockedOn===s&&(g.blockedOn=null)}for(;0<Ro.length&&(f=Ro[0],f.blockedOn===null);)ZC(f),f.blockedOn===null&&Ro.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var x=f[g],E=f[g+1],N=x[sr]||null;if(typeof E=="function")N||e2(f);else if(N){var F=null;if(E&&E.hasAttribute("formAction")){if(x=E,N=E[sr]||null)F=N.formAction;else if(ox(x)!==null)continue}else F=N.action;typeof F=="function"?f[g+1]=F:(f.splice(g,3),g-=3),e2(f)}}}function t2(){function s(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),g||setTimeout(f,20)}function f(){if(!g&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function cx(s){this._internalRoot=s}ym.prototype.render=cx.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,g=gi();$C(f,g,s,l,null,null)},ym.prototype.unmount=cx.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;$C(s.current,2,null,s,null,null),Zg(),l[ba]=null}};function ym(s){this._internalRoot=s}ym.prototype.unstable_scheduleHydration=function(s){if(s){var l=Zp();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Ro.length&&l!==0&&l<Ro[f].priority;f++);Ro.splice(f,0,s),f===0&&ZC(s)}};var n2=e.version;if(n2!=="19.2.0")throw Error(r(527,n2,"19.2.0"));$.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var t6={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bm.isDisabled&&bm.supportsFiber)try{Nr=bm.inject(t6),_n=bm}catch{}}return Yf.createRoot=function(s,l){if(!i(s))throw Error(r(299));var f=!1,g="",x=cA,E=uA,N=dA;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=qC(s,1,!1,null,null,f,g,null,x,E,N,t2),s[ba]=l.current,qb(s),new cx(l)},Yf.hydrateRoot=function(s,l,f){if(!i(s))throw Error(r(299));var g=!1,x="",E=cA,N=uA,F=dA,X=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(N=f.onCaughtError),f.onRecoverableError!==void 0&&(F=f.onRecoverableError),f.formState!==void 0&&(X=f.formState)),l=qC(s,1,!0,l,f??null,g,x,X,E,N,F,t2),l.context=HC(null),f=l.current,g=gi(),g=fr(g),x=po(g),x.callback=null,go(f,x,g),f=g,l.current.lanes=f,rn(l,f),Oa(l),s[ba]=l.current,qb(s),new ym(l)},Yf.version="19.2.0",Yf}var f2;function f6(){if(f2)return fx.exports;f2=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),fx.exports=d6(),fx.exports}var h6=f6();const p6="modulepreload",g6=function(n){return"/personal-budget-pwa/"+n},h2={},hn=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(t.map(d=>{if(d=g6(d),d in h2)return;h2[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":p6,h||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((b,_)=>{m.addEventListener("load",b),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function m6(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:i,onRegisteredSW:a,onRegisterError:o}=n;let c,u;const d=async(p=!0)=>{await u};async function h(){if("serviceWorker"in navigator){if(c=await hn(async()=>{const{Workbox:p}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/personal-budget-pwa/sw.js",{scope:"/personal-budget-pwa/",type:"classic"})).catch(p=>{o?.(p)}),!c)return;c.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),c.addEventListener("installed",p=>{p.isUpdate||r?.()}),c.register({immediate:e}).then(p=>{a?a("/personal-budget-pwa/sw.js",p):i?.(p)}).catch(p=>{o?.(p)})}}return u=h(),d}var p2="popstate";function v6(n={}){function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Oc(i.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),m1("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof a=="string"?a:Oh(a))}function r(i,a){Gi(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return b6(e,t,r,n)}function xn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Gi(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function y6(){return Math.random().toString(36).substring(2,10)}function g2(n,e){return{usr:n.state,key:n.key,idx:e}}function m1(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Oc(e):e,state:t,key:e&&e.key||r||y6()}}function Oh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Oc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function b6(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,c="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){c="POP";let S=h(),T=S==null?null:S-d;d=S,u&&u({action:c,location:w.location,delta:T})}function m(S,T){c="PUSH";let C=m1(w.location,S,T);t&&t(C,S),d=h()+1;let D=g2(C,d),M=w.createHref(C);try{o.pushState(D,"",M)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(M)}a&&u&&u({action:c,location:w.location,delta:1})}function b(S,T){c="REPLACE";let C=m1(w.location,S,T);t&&t(C,S),d=h();let D=g2(C,d),M=w.createHref(C);o.replaceState(D,"",M),a&&u&&u({action:c,location:w.location,delta:0})}function _(S){return x6(S)}let w={get action(){return c},get location(){return n(i,o)},listen(S){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(p2,p),u=S,()=>{i.removeEventListener(p2,p),u=null}},createHref(S){return e(i,S)},createURL:_,encodeLocation(S){let T=_(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:b,go(S){return o.go(S)}};return w}function x6(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),xn(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Oh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function qk(n,e,t="/"){return _6(n,e,t,!1)}function _6(n,e,t,r){let i=typeof e=="string"?Oc(e):e,a=Ps(i.pathname||"/",t);if(a==null)return null;let o=Hk(n);w6(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=M6(a);c=k6(o[u],d,r)}return c}function Hk(n,e=[],t=[],r="",i=!1){let a=(o,c,u=i,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;xn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Rs([r,h.relativePath]),m=t.concat(h);o.children&&o.children.length>0&&(xn(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Hk(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:R6(p,o.index),routesMeta:m})};return n.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))a(o,c);else for(let u of $k(o.path))a(o,c,!0,u)}),e}function $k(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=$k(r.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function w6(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:D6(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var E6=/^:[\w-]+$/,S6=3,T6=2,A6=1,C6=10,I6=-2,m2=n=>n==="*";function R6(n,e){let t=n.split("/"),r=t.length;return t.some(m2)&&(r+=I6),e&&(r+=T6),t.filter(i=>!m2(i)).reduce((i,a)=>i+(E6.test(a)?S6:a===""?A6:C6),r)}function D6(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function k6(n,e,t=!1){let{routesMeta:r}=n,i={},a="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=_0({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&t&&!r[r.length-1].route.index&&(p=_0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Rs([a,p.pathname]),pathnameBase:j6(Rs([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Rs([a,p.pathnameBase]))}return o}function _0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=N6(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let _=c[m]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return p&&!b?d[h]=void 0:d[h]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function N6(n,e=!1,t=!0){Gi(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function M6(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gi(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Ps(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var P6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function O6(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Oc(n):n,a;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?a=v2(t.substring(1),"/"):a=v2(t,e)):a=e,{pathname:a,search:z6(r),hash:L6(i)}}function v2(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function mx(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function V6(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Yk(n){let e=V6(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Kk(n,e,t,r=!1){let i;typeof n=="string"?i=Oc(n):(i={...n},xn(!i.pathname||!i.pathname.includes("?"),mx("?","pathname","search",i)),xn(!i.pathname||!i.pathname.includes("#"),mx("#","pathname","hash",i)),xn(!i.search||!i.search.includes("#"),mx("#","search","hash",i)));let a=n===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=O6(i,c),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Rs=n=>n.join("/").replace(/\/\/+/g,"/"),j6=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),z6=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,L6=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,B6=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function U6(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function F6(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Xk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Wk(n,e){let t=n;if(typeof t!="string"||!P6.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(Xk)try{let a=new URL(window.location.href),o=t.startsWith("//")?new URL(a.protocol+t):new URL(t),c=Ps(o.pathname,e);o.origin===a.origin&&c!=null?t=c+o.search+o.hash:i=!0}catch{Gi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Qk=["POST","PUT","PATCH","DELETE"];new Set(Qk);var G6=["GET",...Qk];new Set(G6);var Nd=U.createContext(null);Nd.displayName="DataRouter";var vv=U.createContext(null);vv.displayName="DataRouterState";var q6=U.createContext(!1),Zk=U.createContext({isTransitioning:!1});Zk.displayName="ViewTransition";var H6=U.createContext(new Map);H6.displayName="Fetchers";var $6=U.createContext(null);$6.displayName="Await";var $i=U.createContext(null);$i.displayName="Navigation";var hp=U.createContext(null);hp.displayName="Location";var rs=U.createContext({outlet:null,matches:[],isDataRoute:!1});rs.displayName="Route";var nw=U.createContext(null);nw.displayName="RouteError";var Jk="REACT_ROUTER_ERROR",Y6="REDIRECT",K6="ROUTE_ERROR_RESPONSE";function X6(n){if(n.startsWith(`${Jk}:${Y6}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function W6(n){if(n.startsWith(`${Jk}:${K6}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new B6(e.status,e.statusText,e.data)}catch{}}function Q6(n,{relative:e}={}){xn(pp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext($i),{hash:i,pathname:a,search:o}=gp(n,{relative:e}),c=a;return t!=="/"&&(c=a==="/"?t:Rs([t,a])),r.createHref({pathname:c,search:o,hash:i})}function pp(){return U.useContext(hp)!=null}function va(){return xn(pp(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(hp).location}var eN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function tN(n){U.useContext($i).static||U.useLayoutEffect(n)}function qs(){let{isDataRoute:n}=U.useContext(rs);return n?dz():Z6()}function Z6(){xn(pp(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Nd),{basename:e,navigator:t}=U.useContext($i),{matches:r}=U.useContext(rs),{pathname:i}=va(),a=JSON.stringify(Yk(r)),o=U.useRef(!1);return tN(()=>{o.current=!0}),U.useCallback((u,d={})=>{if(Gi(o.current,eN),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=Kk(u,JSON.parse(a),i,d.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Rs([e,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[e,t,a,i,n])}U.createContext(null);function J6(){let{matches:n}=U.useContext(rs),e=n[n.length-1];return e?e.params:{}}function gp(n,{relative:e}={}){let{matches:t}=U.useContext(rs),{pathname:r}=va(),i=JSON.stringify(Yk(t));return U.useMemo(()=>Kk(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function ez(n,e){return nN(n,e)}function nN(n,e,t,r,i){xn(pp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext($i),{matches:o}=U.useContext(rs),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let C=p&&p.path||"";iN(d,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let m=va(),b;if(e){let C=typeof e=="string"?Oc(e):e;xn(h==="/"||C.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=m;let _=b.pathname||"/",w=_;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=qk(n,{pathname:w});Gi(p||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Gi(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=az(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:Rs([h,a.encodeLocation?a.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Rs([h,a.encodeLocation?a.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),o,t,r,i);return e&&T?U.createElement(hp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function tz(){let n=uz(),e=U6(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:i},t):null,o)}var nz=U.createElement(tz,null),rN=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=W6(n.digest);t&&(n=t)}let e=n!==void 0?U.createElement(rs.Provider,{value:this.props.routeContext},U.createElement(nw.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?U.createElement(rz,{error:n},e):e}};rN.contextType=q6;var vx=new WeakMap;function rz({children:n,error:e}){let{basename:t}=U.useContext($i);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=X6(e.digest);if(r){let i=vx.get(e);if(i)throw i;let a=Wk(r.location,t);if(Xk&&!vx.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw vx.set(e,o),o}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return n}function iz({routeContext:n,match:e,children:t}){let r=U.useContext(Nd);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(rs.Provider,{value:n},t)}function az(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=t?.errors;if(o!=null){let h=a.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);xn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:b}=t,_=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!b||b[p.route.id]===void 0);if(p.route.lazy||_){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let d=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:F6(t.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let b,_=!1,w=null,S=null;t&&(b=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||nz,c&&(u<0&&m===0?(iN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,S=null):u===m&&(_=!0,S=p.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,m+1)),C=()=>{let D;return b?D=w:_?D=S:p.route.Component?D=U.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=h,U.createElement(iz,{match:p,routeContext:{outlet:h,matches:T,isDataRoute:t!=null},children:D})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?U.createElement(rN,{location:t.location,revalidation:t.revalidation,component:w,error:b,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):C()},null)}function rw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sz(n){let e=U.useContext(Nd);return xn(e,rw(n)),e}function oz(n){let e=U.useContext(vv);return xn(e,rw(n)),e}function lz(n){let e=U.useContext(rs);return xn(e,rw(n)),e}function iw(n){let e=lz(n),t=e.matches[e.matches.length-1];return xn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function cz(){return iw("useRouteId")}function uz(){let n=U.useContext(nw),e=oz("useRouteError"),t=iw("useRouteError");return n!==void 0?n:e.errors?.[t]}function dz(){let{router:n}=sz("useNavigate"),e=iw("useNavigate"),t=U.useRef(!1);return tN(()=>{t.current=!0}),U.useCallback(async(i,a={})=>{Gi(t.current,eN),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...a}))},[n,e])}var y2={};function iN(n,e,t){!e&&!y2[n]&&(y2[n]=!0,Gi(!1,t))}U.memo(fz);function fz({routes:n,future:e,state:t,onError:r}){return nN(n,void 0,t,r,e)}function jo(n){xn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function hz({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:o}){xn(!pp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:o,future:{}}),[c,i,a,o]);typeof t=="string"&&(t=Oc(t));let{pathname:d="/",search:h="",hash:p="",state:m=null,key:b="default"}=t,_=U.useMemo(()=>{let w=Ps(d,c);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:b},navigationType:r}},[c,d,h,p,m,b,r]);return Gi(_!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement($i.Provider,{value:u},U.createElement(hp.Provider,{children:e,value:_}))}function pz({children:n,location:e}){return ez(v1(n),e)}function v1(n,e=[]){let t=[];return U.Children.forEach(n,(r,i)=>{if(!U.isValidElement(r))return;let a=[...e,i];if(r.type===U.Fragment){t.push.apply(t,v1(r.props.children,a));return}xn(r.type===jo,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=v1(r.props.children,a)),t.push(o)}),t}var Xm="get",Wm="application/x-www-form-urlencoded";function yv(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function gz(n){return yv(n)&&n.tagName.toLowerCase()==="button"}function mz(n){return yv(n)&&n.tagName.toLowerCase()==="form"}function vz(n){return yv(n)&&n.tagName.toLowerCase()==="input"}function yz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function bz(n,e){return n.button===0&&(!e||e==="_self")&&!yz(n)}function y1(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(i=>[t,i]):[[t,r]])},[]))}function xz(n,e){let t=y1(n);return e&&e.forEach((r,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}var _m=null;function _z(){if(_m===null)try{new FormData(document.createElement("form"),0),_m=!1}catch{_m=!0}return _m}var wz=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function yx(n){return n!=null&&!wz.has(n)?(Gi(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Wm}"`),null):n}function Ez(n,e){let t,r,i,a,o;if(mz(n)){let c=n.getAttribute("action");r=c?Ps(c,e):null,t=n.getAttribute("method")||Xm,i=yx(n.getAttribute("enctype"))||Wm,a=new FormData(n)}else if(gz(n)||vz(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||c.getAttribute("action");if(r=u?Ps(u,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||Xm,i=yx(n.getAttribute("formenctype"))||yx(c.getAttribute("enctype"))||Wm,a=new FormData(c,n),!_z()){let{name:d,type:h,value:p}=n;if(h==="image"){let m=d?`${d}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else d&&a.append(d,p)}}else{if(yv(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Xm,r=null,i=Wm,o=n}return a&&i==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function aw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Sz(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Ps(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function Tz(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Az(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Cz(n,e,t){let r=await Promise.all(n.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await Tz(a,t);return o.links?o.links():[]}return[]}));return kz(r.flat(1).filter(Az).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function b2(n,e,t,r,i,a){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):a==="data"?e.filter((u,d)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function Iz(n,e,{includeHydrateFallback:t}={}){return Rz(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function Rz(n){return[...new Set(n)]}function Dz(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function kz(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let a=JSON.stringify(Dz(i));return t.has(a)||(t.add(a),r.push({key:a,link:i})),r},[])}function aN(){let n=U.useContext(Nd);return aw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Nz(){let n=U.useContext(vv);return aw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var sw=U.createContext(void 0);sw.displayName="FrameworkContext";function sN(){let n=U.useContext(sw);return aw(n,"You must render this element inside a <HydratedRouter> element"),n}function Mz(n,e){let t=U.useContext(sw),[r,i]=U.useState(!1),[a,o]=U.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let w=T=>{T.forEach(C=>{o(C.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[n]),U.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{i(!0)},_=()=>{i(!1),o(!1)};return t?n!=="intent"?[a,m,{}]:[a,m,{onFocus:Kf(c,b),onBlur:Kf(u,_),onMouseEnter:Kf(d,b),onMouseLeave:Kf(h,_),onTouchStart:Kf(p,b)}]:[!1,m,{}]}function Kf(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Pz({page:n,...e}){let{router:t}=aN(),r=U.useMemo(()=>qk(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(Vz,{page:n,matches:r,...e}):null}function Oz(n){let{manifest:e,routeModules:t}=sN(),[r,i]=U.useState([]);return U.useEffect(()=>{let a=!1;return Cz(n,e,t).then(o=>{a||i(o)}),()=>{a=!0}},[n,e,t]),r}function Vz({page:n,matches:e,...t}){let r=va(),{future:i,manifest:a,routeModules:o}=sN(),{basename:c}=aN(),{loaderData:u,matches:d}=Nz(),h=U.useMemo(()=>b2(n,e,d,a,r,"data"),[n,e,d,a,r]),p=U.useMemo(()=>b2(n,e,d,a,r,"assets"),[n,e,d,a,r]),m=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,S=!1;if(e.forEach(C=>{let D=a.routes[C.route.id];!D||!D.hasLoader||(!h.some(M=>M.route.id===C.route.id)&&C.route.id in u&&o[C.route.id]?.shouldRevalidate||D.hasClientLoader?S=!0:w.add(C.route.id))}),w.size===0)return[];let T=Sz(n,c,i.unstable_trailingSlashAwareDataRequests,"data");return S&&w.size>0&&T.searchParams.set("_routes",e.filter(C=>w.has(C.route.id)).map(C=>C.route.id).join(",")),[T.pathname+T.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,n,o]),b=U.useMemo(()=>Iz(p,a),[p,a]),_=Oz(p);return U.createElement(U.Fragment,null,m.map(w=>U.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>U.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),_.map(({key:w,link:S})=>U.createElement("link",{key:w,nonce:t.nonce,...S,crossOrigin:S.crossOrigin??t.crossOrigin})))}function jz(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var zz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{zz&&(window.__reactRouterVersion="7.13.0")}catch{}function Lz({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=U.useRef();i.current==null&&(i.current=v6({window:r,v5Compat:!0}));let a=i.current,[o,c]=U.useState({action:a.action,location:a.location}),u=U.useCallback(d=>{t===!1?c(d):U.startTransition(()=>c(d))},[t]);return U.useLayoutEffect(()=>a.listen(u),[a,u]),U.createElement(hz,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a,unstable_useTransitions:t})}var oN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lN=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_){let{basename:w,unstable_useTransitions:S}=U.useContext($i),T=typeof d=="string"&&oN.test(d),C=Wk(d,w);d=C.to;let D=Q6(d,{relative:i}),[M,j,z]=Mz(r,b),A=Gz(d,{replace:o,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:S});function I(V){e&&e(V),V.defaultPrevented||A(V)}let k=U.createElement("a",{...b,...z,href:C.absoluteURL||D,onClick:C.isExternal||a?e:I,ref:jz(_,j),target:u,"data-discover":!T&&t==="render"?"true":void 0});return M&&!T?U.createElement(U.Fragment,null,k,U.createElement(Pz,{page:D})):k});lN.displayName="Link";var Bz=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...d},h){let p=gp(o,{relative:d.relative}),m=va(),b=U.useContext(vv),{navigator:_,basename:w}=U.useContext($i),S=b!=null&&Xz(p)&&c===!0,T=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,C=m.pathname,D=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;t||(C=C.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&w&&(D=Ps(D,w)||D);const M=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let j=C===T||!i&&C.startsWith(T)&&C.charAt(M)==="/",z=D!=null&&(D===T||!i&&D.startsWith(T)&&D.charAt(T.length)==="/"),A={isActive:j,isPending:z,isTransitioning:S},I=j?e:void 0,k;typeof r=="function"?k=r(A):k=[r,j?"active":null,z?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(A):a;return U.createElement(lN,{...d,"aria-current":I,className:k,ref:h,style:V,to:o,viewTransition:c},typeof u=="function"?u(A):u)});Bz.displayName="NavLink";var Uz=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:a,method:o=Xm,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...b},_)=>{let{unstable_useTransitions:w}=U.useContext($i),S=Yz(),T=Kz(c,{relative:d}),C=o.toLowerCase()==="get"?"get":"post",D=typeof c=="string"&&oN.test(c),M=j=>{if(u&&u(j),j.defaultPrevented)return;j.preventDefault();let z=j.nativeEvent.submitter,A=z?.getAttribute("formmethod")||o,I=()=>S(z||j.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:i,state:a,relative:d,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});w&&t!==!1?U.startTransition(()=>I()):I()};return U.createElement("form",{ref:_,method:C,action:T,onSubmit:r?u:M,...b,"data-discover":!D&&n==="render"?"true":void 0})});Uz.displayName="Form";function Fz(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cN(n){let e=U.useContext(Nd);return xn(e,Fz(n)),e}function Gz(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=qs(),h=va(),p=gp(n,{relative:a});return U.useCallback(m=>{if(bz(m,e)){m.preventDefault();let b=t!==void 0?t:Oh(h)===Oh(p),_=()=>d(n,{replace:b,state:r,preventScrollReset:i,relative:a,viewTransition:o,unstable_defaultShouldRevalidate:c});u?U.startTransition(()=>_()):_()}},[h,d,p,t,r,e,n,i,a,o,c,u])}function qz(n){Gi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=U.useRef(y1(n)),t=U.useRef(!1),r=va(),i=U.useMemo(()=>xz(r.search,t.current?null:e.current),[r.search]),a=qs(),o=U.useCallback((c,u)=>{const d=y1(typeof c=="function"?c(new URLSearchParams(i)):c);t.current=!0,a("?"+d,u)},[a,i]);return[i,o]}var Hz=0,$z=()=>`__${String(++Hz)}__`;function Yz(){let{router:n}=cN("useSubmit"),{basename:e}=U.useContext($i),t=cz(),r=n.fetch,i=n.navigate;return U.useCallback(async(a,o={})=>{let{action:c,method:u,encType:d,formData:h,body:p}=Ez(a,e);if(o.navigate===!1){let m=o.fetcherKey||$z();await r(m,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await i(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:h,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,e,t])}function Kz(n,{relative:e}={}){let{basename:t}=U.useContext($i),r=U.useContext(rs);xn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...gp(n||".",{relative:e})},o=va();if(n==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Rs([t,a.pathname])),Oh(a)}function Xz(n,{relative:e}={}){let t=U.useContext(Zk);xn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=cN("useViewTransitionState"),i=gp(n,{relative:e});if(!t.isTransitioning)return!1;let a=Ps(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Ps(t.nextLocation.pathname,r)||t.nextLocation.pathname;return _0(i.pathname,o)!=null||_0(i.pathname,a)!=null}const Wz=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Qz=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),x2=n=>{const e=Qz(n);return e.charAt(0).toUpperCase()+e.slice(1)},uN=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),Zz=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Jz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const eL=U.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},u)=>U.createElement("svg",{ref:u,...Jz,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:uN("lucide",i),...!a&&!Zz(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>U.createElement(d,h)),...Array.isArray(a)?a:[a]]));const tt=(n,e)=>{const t=U.forwardRef(({className:r,...i},a)=>U.createElement(eL,{ref:a,iconNode:e,className:uN(`lucide-${Wz(x2(n))}`,`lucide-${n}`,r),...i}));return t.displayName=x2(n),t};const tL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ad=tt("arrow-left",tL);const nL=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],rL=tt("arrow-right-left",nL);const iL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],aL=tt("arrow-right",iL);const sL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],oL=tt("calendar",sL);const lL=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],cL=tt("chart-column",lL);const uL=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],dL=tt("chart-pie",uL);const fL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],hL=tt("check",fL);const pL=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],dN=tt("chevron-down",pL);const gL=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],mL=tt("chevron-left",gL);const vL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],zo=tt("chevron-right",vL);const yL=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],fN=tt("chevron-up",yL);const bL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],xL=tt("circle-arrow-down",bL);const _L=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],wL=tt("circle-arrow-up",_L);const EL=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],b1=tt("circle-check-big",EL);const SL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Va=tt("circle-check",SL);const TL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],_2=tt("circle",TL);const AL=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],w2=tt("dollar-sign",AL);const CL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],E2=tt("download",CL);const IL=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],hN=tt("ellipsis",IL);const RL=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],DL=tt("eye-off",RL);const kL=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],NL=tt("eye",kL);const ML=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],PL=tt("file-text",ML);const OL=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],VL=tt("folder-plus",OL);const jL=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],zL=tt("funnel",jL);const LL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],BL=tt("house",LL);const UL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],FL=tt("list",UL);const GL=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],qL=tt("loader-circle",GL);const HL=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],S2=tt("loader",HL);const $L=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],YL=tt("lock-open",$L);const KL=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],XL=tt("lock",KL);const WL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],QL=tt("log-out",WL);const ZL=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],x1=tt("mail",ZL);const JL=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],e9=tt("pause",JL);const t9=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],yc=tt("piggy-bank",t9);const n9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],hh=tt("plus",n9);const r9=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Vh=tt("refresh-cw",r9);const i9=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],a9=tt("search",i9);const s9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],o9=tt("settings",s9);const l9=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],w0=tt("sparkles",l9);const c9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],u9=tt("target",c9);const d9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_1=tt("trash-2",d9);const f9=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],pN=tt("trash",f9);const h9=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],E0=tt("trending-up",h9);const p9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Zu=tt("triangle-alert",p9);const g9=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],m9=tt("undo-2",g9);const v9=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],y9=tt("upload",v9);const b9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],x9=tt("user-plus",b9);const _9=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],bv=tt("wallet",_9);const w9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],xv=tt("x",w9),T2=n=>{let e;const t=new Set,r=(d,h)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const m=e;e=h??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,m))}},i=()=>e,c={setState:r,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d))},u=e=n(r,i,c);return c},E9=(n=>n?T2(n):T2),S9=n=>n;function T9(n,e=S9){const t=xm.useSyncExternalStore(n.subscribe,xm.useCallback(()=>e(n.getState()),[n,e]),xm.useCallback(()=>e(n.getInitialState()),[n,e]));return xm.useDebugValue(t),t}const A2=n=>{const e=E9(n),t=r=>T9(e,r);return Object.assign(t,e),t},ow=(n=>n?A2(n):A2),C2={BASE_URL:"/personal-budget-pwa/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",VITE_FIREBASE_APP_ID:"1:137454342284:web:ab8b52955e6f0ffd42aba9",VITE_FIREBASE_AUTH_DOMAIN:"personal-budget-pwa-5defb.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-BCLXBQHT9L",VITE_FIREBASE_MESSAGING_SENDER_ID:"137454342284",VITE_FIREBASE_PROJECT_ID:"personal-budget-pwa-5defb",VITE_FIREBASE_STORAGE_BUCKET:"personal-budget-pwa-5defb.firebasestorage.app"},jh=new Map,wm=n=>{const e=jh.get(n);return e?Object.fromEntries(Object.entries(e.stores).map(([t,r])=>[t,r.getState()])):{}},A9=(n,e,t)=>{if(n===void 0)return{type:"untracked",connection:e.connect(t)};const r=jh.get(t.name);if(r)return{type:"tracked",store:n,...r};const i={connection:e.connect(t),stores:{}};return jh.set(t.name,i),{type:"tracked",store:n,...i}},C9=(n,e)=>{if(e===void 0)return;const t=jh.get(n);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&jh.delete(n))},I9=n=>{var e,t;if(!n)return;const r=n.split(`
`),i=r.findIndex(o=>o.includes("api.setState"));if(i<0)return;const a=((e=r[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},R9=(n,e={})=>(t,r,i)=>{const{enabled:a,anonymousActionType:o,store:c,...u}=e;let d;try{d=(a??(C2?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return n(t,r,i);const{connection:h,...p}=A9(c,d,u);let m=!0;i.setState=((w,S,T)=>{const C=t(w,S);if(!m)return C;const D=T===void 0?{type:o||I9(new Error().stack)||"anonymous"}:typeof T=="string"?{type:T}:T;return c===void 0?(h?.send(D,r()),C):(h?.send({...D,type:`${c}/${D.type}`},{...wm(u.name),[c]:i.getState()}),C)}),i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),C9(u.name,c)}};const b=(...w)=>{const S=m;m=!1,t(...w),m=S},_=n(i.setState,r,i);if(p.type==="untracked"?h?.init(_):(p.stores[p.store]=i,h?.init(Object.fromEntries(Object.entries(p.stores).map(([w,S])=>[w,w===p.store?_:S.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const S=i.dispatch;i.dispatch=(...T)=>{(C2?"production":void 0)!=="production"&&T[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),S(...T)}}return h.subscribe(w=>{var S;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return bx(w.payload,T=>{if(T.type==="__setState"){if(c===void 0){b(T.state);return}Object.keys(T.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const C=T.state[c];if(C==null)return;JSON.stringify(i.getState())!==JSON.stringify(C)&&b(C);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(T)});case"DISPATCH":switch(w.payload.type){case"RESET":return b(_),c===void 0?h?.init(i.getState()):h?.init(wm(u.name));case"COMMIT":if(c===void 0){h?.init(i.getState());return}return h?.init(wm(u.name));case"ROLLBACK":return bx(w.state,T=>{if(c===void 0){b(T),h?.init(i.getState());return}b(T[c]),h?.init(wm(u.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return bx(w.state,T=>{if(c===void 0){b(T);return}JSON.stringify(i.getState())!==JSON.stringify(T[c])&&b(T[c])});case"IMPORT_STATE":{const{nextLiftedState:T}=w.payload,C=(S=T.computedStates.slice(-1)[0])==null?void 0:S.state;if(!C)return;b(c===void 0?C:C[c]),h?.send(null,T);return}case"PAUSE_RECORDING":return m=!m}return}}),_},D9=R9,bx=(n,e)=>{let t;try{t=JSON.parse(n)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}t!==void 0&&e(t)};function k9(n,e){let t;try{t=n()}catch{return}return{getItem:i=>{var a;const o=u=>u===null?null:JSON.parse(u,void 0),c=(a=t.getItem(i))!=null?a:null;return c instanceof Promise?c.then(o):o(c)},setItem:(i,a)=>t.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>t.removeItem(i)}}const w1=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return w1(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return w1(r)(t)}}}},N9=(n,e)=>(t,r,i)=>{let a={storage:k9(()=>localStorage),partialize:w=>w,version:0,merge:(w,S)=>({...S,...w}),...e},o=!1;const c=new Set,u=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,i);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,S)=>(p(w,S),h());const m=n((...w)=>(t(...w),h()),r,i);i.getInitialState=()=>m;let b;const _=()=>{var w,S;if(!d)return;o=!1,c.forEach(C=>{var D;return C((D=r())!=null?D:m)});const T=((S=a.onRehydrateStorage)==null?void 0:S.call(a,(w=r())!=null?w:m))||void 0;return w1(d.getItem.bind(d))(a.name).then(C=>{if(C)if(typeof C.version=="number"&&C.version!==a.version){if(a.migrate){const D=a.migrate(C.state,C.version);return D instanceof Promise?D.then(M=>[!0,M]):[!0,D]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,C.state];return[!1,void 0]}).then(C=>{var D;const[M,j]=C;if(b=a.merge(j,(D=r())!=null?D:m),t(b,!0),M)return h()}).then(()=>{T?.(b,void 0),b=r(),o=!0,u.forEach(C=>C(b))}).catch(C=>{T?.(void 0,C)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},a.skipHydration||_(),b||m},gN=N9,M9=()=>{};var I2={};const mN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},P9=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const a=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},vN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,h=a>>2,p=(a&3)<<4|c>>4;let m=(c&15)<<2|d>>6,b=d&63;u||(b=64,o||(m=64)),r.push(t[h],t[p],t[m],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(mN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):P9(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||c==null||d==null||p==null)throw new O9;const m=a<<2|c>>4;if(r.push(m),d!==64){const b=c<<4&240|d>>2;if(r.push(b),p!==64){const _=d<<6&192|p;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class O9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const V9=function(n){const e=mN(n);return vN.encodeByteArray(e,!0)},S0=function(n){return V9(n).replace(/\./g,"")},yN=function(n){try{return vN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function bN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const j9=()=>bN().__FIREBASE_DEFAULTS__,z9=()=>{if(typeof process>"u"||typeof I2>"u")return;const n=I2.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},L9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&yN(n[1]);return e&&JSON.parse(e)},_v=()=>{try{return M9()||j9()||z9()||L9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},xN=n=>_v()?.emulatorHosts?.[n],B9=n=>{const e=xN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},_N=()=>_v()?.config,wN=n=>_v()?.[`_${n}`];class U9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Md(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function EN(n){return(await fetch(n,{credentials:"include"})).ok}function F9(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[S0(JSON.stringify(t)),S0(JSON.stringify(o)),""].join(".")}const ph={};function G9(){const n={prod:[],emulator:[]};for(const e of Object.keys(ph))ph[e]?n.emulator.push(e):n.prod.push(e);return n}function q9(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let R2=!1;function SN(n,e){if(typeof window>"u"||typeof document>"u"||!Md(window.location.host)||ph[n]===e||ph[n]||R2)return;ph[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",a=G9().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,b){m.setAttribute("width","24"),m.setAttribute("id",b),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{R2=!0,o()},m}function h(m,b){m.setAttribute("id",b),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=q9(r),b=t("text"),_=document.getElementById(b)||document.createElement("span"),w=t("learnmore"),S=document.getElementById(w)||document.createElement("a"),T=t("preprendIcon"),C=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const D=m.element;c(D),h(S,w);const M=d();u(C,T),D.append(C,_,S,M),document.body.appendChild(D)}a?(_.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function ir(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ir())}function TN(){const n=_v()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Y9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function K9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function X9(){const n=ir();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function AN(){return!TN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function CN(){return!TN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function IN(){try{return typeof indexedDB=="object"}catch{return!1}}function W9(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const Q9="FirebaseError";class Hs extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Q9,Object.setPrototypeOf(this,Hs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mp.prototype.create)}}class mp{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?Z9(a,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Hs(i,c,r)}}function Z9(n,e){return n.replace(J9,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const J9=/\{\$([^}]+)}/g;function eB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function rl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],o=e[i];if(D2(a)&&D2(o)){if(!rl(a,o))return!1}else if(a!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function D2(n){return n!==null&&typeof n=="object"}function vp(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function nh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function rh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function tB(n,e){const t=new nB(n,e);return t.subscribe.bind(t)}class nB{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");rB(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=xx),i.error===void 0&&(i.error=xx),i.complete===void 0&&(i.complete=xx);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function xx(){}function un(n){return n&&n._delegate?n._delegate:n}let bc=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};const Yl="[DEFAULT]";let iB=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new U9;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sB(e))try{this.getOrInitializeService({instanceIdentifier:Yl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=Yl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yl){return this.instances.has(e)}getOptions(e=Yl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);r===c&&o.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aB(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yl){return this.component?this.component.multipleInstances?e:Yl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function aB(n){return n===Yl?void 0:n}function sB(n){return n.instantiationMode==="EAGER"}class oB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new iB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Rt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Rt||(Rt={}));const lB={debug:Rt.DEBUG,verbose:Rt.VERBOSE,info:Rt.INFO,warn:Rt.WARN,error:Rt.ERROR,silent:Rt.SILENT},cB=Rt.INFO,uB={[Rt.DEBUG]:"log",[Rt.VERBOSE]:"log",[Rt.INFO]:"info",[Rt.WARN]:"warn",[Rt.ERROR]:"error"},dB=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=uB[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lw{constructor(e){this.name=e,this._logLevel=cB,this._logHandler=dB,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Rt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Rt.DEBUG,...e),this._logHandler(this,Rt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Rt.VERBOSE,...e),this._logHandler(this,Rt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Rt.INFO,...e),this._logHandler(this,Rt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Rt.WARN,...e),this._logHandler(this,Rt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Rt.ERROR,...e),this._logHandler(this,Rt.ERROR,...e)}}const fB=(n,e)=>e.some(t=>n instanceof t);let k2,N2;function hB(){return k2||(k2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pB(){return N2||(N2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RN=new WeakMap,E1=new WeakMap,DN=new WeakMap,_x=new WeakMap,cw=new WeakMap;function gB(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",o)},a=()=>{t(Wo(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&RN.set(t,n)}).catch(()=>{}),cw.set(e,n),e}function mB(n){if(E1.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",o),n.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",o),n.addEventListener("abort",o)});E1.set(n,e)}let S1={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return E1.get(n);if(e==="objectStoreNames")return n.objectStoreNames||DN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function vB(n){S1=n(S1)}function yB(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(wx(this),e,...t);return DN.set(r,e.sort?e.sort():[e]),Wo(r)}:pB().includes(n)?function(...e){return n.apply(wx(this),e),Wo(RN.get(this))}:function(...e){return Wo(n.apply(wx(this),e))}}function bB(n){return typeof n=="function"?yB(n):(n instanceof IDBTransaction&&mB(n),fB(n,hB())?new Proxy(n,S1):n)}function Wo(n){if(n instanceof IDBRequest)return gB(n);if(_x.has(n))return _x.get(n);const e=bB(n);return e!==n&&(_x.set(n,e),cw.set(e,n)),e}const wx=n=>cw.get(n);function xB(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const o=indexedDB.open(n,e),c=Wo(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Wo(o.result),u.oldVersion,u.newVersion,Wo(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const _B=["get","getKey","getAll","getAllKeys","count"],wB=["put","add","delete","clear"],Ex=new Map;function M2(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ex.get(e))return Ex.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=wB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||_B.includes(t)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[t](...c),i&&u.done]))[0]};return Ex.set(e,a),a}vB(n=>({...n,get:(e,t,r)=>M2(e,t)||n.get(e,t,r),has:(e,t)=>!!M2(e,t)||n.has(e,t)}));class EB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(SB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function SB(n){return n.getComponent()?.type==="VERSION"}const T1="@firebase/app",P2="0.14.6";const Os=new lw("@firebase/app"),TB="@firebase/app-compat",AB="@firebase/analytics-compat",CB="@firebase/analytics",IB="@firebase/app-check-compat",RB="@firebase/app-check",DB="@firebase/auth",kB="@firebase/auth-compat",NB="@firebase/database",MB="@firebase/data-connect",PB="@firebase/database-compat",OB="@firebase/functions",VB="@firebase/functions-compat",jB="@firebase/installations",zB="@firebase/installations-compat",LB="@firebase/messaging",BB="@firebase/messaging-compat",UB="@firebase/performance",FB="@firebase/performance-compat",GB="@firebase/remote-config",qB="@firebase/remote-config-compat",HB="@firebase/storage",$B="@firebase/storage-compat",YB="@firebase/firestore",KB="@firebase/ai",XB="@firebase/firestore-compat",WB="firebase",QB="12.6.0";const A1="[DEFAULT]",ZB={[T1]:"fire-core",[TB]:"fire-core-compat",[CB]:"fire-analytics",[AB]:"fire-analytics-compat",[RB]:"fire-app-check",[IB]:"fire-app-check-compat",[DB]:"fire-auth",[kB]:"fire-auth-compat",[NB]:"fire-rtdb",[MB]:"fire-data-connect",[PB]:"fire-rtdb-compat",[OB]:"fire-fn",[VB]:"fire-fn-compat",[jB]:"fire-iid",[zB]:"fire-iid-compat",[LB]:"fire-fcm",[BB]:"fire-fcm-compat",[UB]:"fire-perf",[FB]:"fire-perf-compat",[GB]:"fire-rc",[qB]:"fire-rc-compat",[HB]:"fire-gcs",[$B]:"fire-gcs-compat",[YB]:"fire-fst",[XB]:"fire-fst-compat",[KB]:"fire-vertex","fire-js":"fire-js",[WB]:"fire-js-all"};const T0=new Map,JB=new Map,C1=new Map;function O2(n,e){try{n.container.addComponent(e)}catch(t){Os.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function sd(n){const e=n.name;if(C1.has(e))return Os.debug(`There were multiple attempts to register component ${e}.`),!1;C1.set(e,n);for(const t of T0.values())O2(t,n);for(const t of JB.values())O2(t,n);return!0}function uw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Vi(n){return n==null?!1:n.settings!==void 0}const eU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qo=new mp("app","Firebase",eU);class tU{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qo.create("app-deleted",{appName:this._name})}}const Pd=QB;function kN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:A1,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Qo.create("bad-app-name",{appName:String(i)});if(t||(t=_N()),!t)throw Qo.create("no-options");const a=T0.get(i);if(a){if(rl(t,a.options)&&rl(r,a.config))return a;throw Qo.create("duplicate-app",{appName:i})}const o=new oB(i);for(const u of C1.values())o.addComponent(u);const c=new tU(t,r,o);return T0.set(i,c),c}function NN(n=A1){const e=T0.get(n);if(!e&&n===A1&&_N())return kN();if(!e)throw Qo.create("no-app",{appName:n});return e}function Zo(n,e,t){let r=ZB[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Os.warn(o.join(" "));return}sd(new bc(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const nU="firebase-heartbeat-database",rU=1,zh="firebase-heartbeat-store";let Sx=null;function MN(){return Sx||(Sx=xB(nU,rU,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qo.create("idb-open",{originalErrorMessage:n.message})})),Sx}async function iU(n){try{const t=(await MN()).transaction(zh),r=await t.objectStore(zh).get(PN(n));return await t.done,r}catch(e){if(e instanceof Hs)Os.warn(e.message);else{const t=Qo.create("idb-get",{originalErrorMessage:e?.message});Os.warn(t.message)}}}async function V2(n,e){try{const r=(await MN()).transaction(zh,"readwrite");await r.objectStore(zh).put(e,PN(n)),await r.done}catch(t){if(t instanceof Hs)Os.warn(t.message);else{const r=Qo.create("idb-set",{originalErrorMessage:t?.message});Os.warn(r.message)}}}function PN(n){return`${n.name}!${n.options.appId}`}const aU=1024,sU=30;class oU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new cU(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=j2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>sU){const i=uU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Os.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=j2(),{heartbeatsToSend:t,unsentEntries:r}=lU(this._heartbeatsCache.heartbeats),i=S0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Os.warn(e),""}}}function j2(){return new Date().toISOString().substring(0,10)}function lU(n,e=aU){const t=[];let r=n.slice();for(const i of n){const a=t.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),z2(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),z2(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class cU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return IN()?W9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await iU(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function z2(n){return S0(JSON.stringify({version:2,heartbeats:n})).length}function uU(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function dU(n){sd(new bc("platform-logger",e=>new EB(e),"PRIVATE")),sd(new bc("heartbeat",e=>new oU(e),"PRIVATE")),Zo(T1,P2,n),Zo(T1,P2,"esm2020"),Zo("fire-js","")}dU("");function ON(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fU=ON,VN=new mp("auth","Firebase",ON());const A0=new lw("@firebase/auth");function hU(n,...e){A0.logLevel<=Rt.WARN&&A0.warn(`Auth (${Pd}): ${n}`,...e)}function Qm(n,...e){A0.logLevel<=Rt.ERROR&&A0.error(`Auth (${Pd}): ${n}`,...e)}function ha(n,...e){throw dw(n,...e)}function $a(n,...e){return dw(n,...e)}function jN(n,e,t){const r={...fU(),[e]:t};return new mp("auth","Firebase",r).create(e,{appName:n.name})}function Ds(n){return jN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return VN.create(n,...e)}function et(n,e,...t){if(!n)throw dw(e,...t)}function Ts(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Qm(e),new Error(e)}function Vs(n,e){n||Ts(e)}function I1(){return typeof self<"u"&&self.location?.href||""}function pU(){return L2()==="http:"||L2()==="https:"}function L2(){return typeof self<"u"&&self.location?.protocol||null}function gU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pU()||Y9()||"connection"in navigator)?navigator.onLine:!0}function mU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class yp{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vs(t>e,"Short delay should be less than long delay!"),this.isMobile=H9()||K9()}get(){return gU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function fw(n,e){Vs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class zN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ts("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ts("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ts("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const vU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const yU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bU=new yp(3e4,6e4);function $s(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function is(n,e,t,r,i={}){return LN(n,i,async()=>{let a={},o={};r&&(e==="GET"?o=r:a={body:JSON.stringify(r)});const c=vp({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:u,...a};return $9()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Md(n.emulatorConfig.host)&&(d.credentials="include"),zN.fetch()(await BN(n,n.config.apiHost,t,c),d)})}async function LN(n,e,t){n._canInitEmulator=!1;const r={...vU,...e};try{const i=new _U(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Em(n,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Em(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Em(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Em(n,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw jN(n,h,d);ha(n,h)}}catch(i){if(i instanceof Hs)throw i;ha(n,"network-request-failed",{message:String(i)})}}async function bp(n,e,t,r,i={}){const a=await is(n,e,t,r,i);return"mfaPendingCredential"in a&&ha(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function BN(n,e,t,r){const i=`${e}${t}?${r}`,a=n,o=a.config.emulator?fw(n.config,i):`${n.config.apiScheme}://${i}`;return yU.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function xU(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _U{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($a(this.auth,"network-request-failed")),bU.get())})}}function Em(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=$a(n,e,r);return i.customData._tokenResponse=t,i}function B2(n){return n!==void 0&&n.enterprise!==void 0}class wU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return xU(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function EU(n,e){return is(n,"GET","/v2/recaptchaConfig",$s(n,e))}async function SU(n,e){return is(n,"POST","/v1/accounts:delete",e)}async function C0(n,e){return is(n,"POST","/v1/accounts:lookup",e)}function gh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TU(n,e=!1){const t=un(n),r=await t.getIdToken(e),i=hw(r);et(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:gh(Tx(i.auth_time)),issuedAtTime:gh(Tx(i.iat)),expirationTime:gh(Tx(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Tx(n){return Number(n)*1e3}function hw(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Qm("JWT malformed, contained fewer than 3 sections"),null;try{const i=yN(t);return i?JSON.parse(i):(Qm("Failed to decode base64 JWT payload"),null)}catch(i){return Qm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function U2(n){const e=hw(n);return et(e,"internal-error"),et(typeof e.exp<"u","internal-error"),et(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function od(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Hs&&AU(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function AU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class CU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class R1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gh(this.lastLoginAt),this.creationTime=gh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function I0(n){const e=n.auth,t=await n.getIdToken(),r=await od(n,C0(e,{idToken:t}));et(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=i.providerUserInfo?.length?UN(i.providerUserInfo):[],o=RU(n.providerData,a),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new R1(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,h)}async function IU(n){const e=un(n);await I0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function RU(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function UN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function DU(n,e){const t=await LN(n,{},async()=>{const r=vp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,o=await BN(n,i,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Md(n.emulatorConfig.host)&&(u.credentials="include"),zN.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function kU(n,e){return is(n,"POST","/v2/accounts:revokeToken",$s(n,e))}class Ju{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){et(e.idToken,"internal-error"),et(typeof e.idToken<"u","internal-error"),et(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):U2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){et(e.length!==0,"internal-error");const t=U2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(et(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await DU(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,o=new Ju;return r&&(et(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(et(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(et(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ju,this.toJSON())}_performRefresh(){return Ts("not implemented")}}function ko(n,e){et(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class la{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new CU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new R1(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await od(this,this.stsTokenManager.getToken(this.auth,e));return et(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return TU(this,e)}reload(){return IU(this)}_assign(e){this!==e&&(et(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new la({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await I0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Vi(this.auth.app))return Promise.reject(Ds(this.auth));const e=await this.getIdToken();return await od(this,SU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,d=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:b,providerData:_,stsTokenManager:w}=t;et(p&&w,e,"internal-error");const S=Ju.fromJSON(this.name,w);et(typeof p=="string",e,"internal-error"),ko(r,e.name),ko(i,e.name),et(typeof m=="boolean",e,"internal-error"),et(typeof b=="boolean",e,"internal-error"),ko(a,e.name),ko(o,e.name),ko(c,e.name),ko(u,e.name),ko(d,e.name),ko(h,e.name);const T=new la({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:a,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:h});return _&&Array.isArray(_)&&(T.providerData=_.map(C=>({...C}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ju;i.updateFromServerResponse(t);const a=new la({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await I0(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];et(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?UN(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new Ju;c.updateFromIdToken(r);const u=new la({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new R1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,d),u}}const F2=new Map;function As(n){Vs(n instanceof Function,"Expected a class definition");let e=F2.get(n);return e?(Vs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,F2.set(n,e),e)}class FN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}FN.type="NONE";const G2=FN;function Zm(n,e,t){return`firebase:${n}:${e}:${t}`}class ed{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=Zm(this.userKey,i.apiKey,a),this.fullPersistenceKey=Zm("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await C0(this.auth,{idToken:e}).catch(()=>{});return t?la._fromGetAccountInfoResponse(this.auth,t,e):null}return la._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ed(As(G2),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let a=i[0]||As(G2);const o=Zm(r,e.config.apiKey,e.name);let c=null;for(const d of t)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await C0(e,{idToken:h}).catch(()=>{});if(!m)break;p=await la._fromGetAccountInfoResponse(e,m,h)}else p=la._fromJSON(e,h);d!==a&&(c=p),a=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new ed(a,e,r):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(t.map(async d=>{if(d!==a)try{await d._remove(o)}catch{}})),new ed(a,e,r))}}function q2(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($N(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(GN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(KN(e))return"Blackberry";if(XN(e))return"Webos";if(qN(e))return"Safari";if((e.includes("chrome/")||HN(e))&&!e.includes("edge/"))return"Chrome";if(YN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function GN(n=ir()){return/firefox\//i.test(n)}function qN(n=ir()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function HN(n=ir()){return/crios\//i.test(n)}function $N(n=ir()){return/iemobile/i.test(n)}function YN(n=ir()){return/android/i.test(n)}function KN(n=ir()){return/blackberry/i.test(n)}function XN(n=ir()){return/webos/i.test(n)}function pw(n=ir()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function NU(n=ir()){return pw(n)&&!!window.navigator?.standalone}function MU(){return X9()&&document.documentMode===10}function WN(n=ir()){return pw(n)||YN(n)||XN(n)||KN(n)||/windows phone/i.test(n)||$N(n)}function QN(n,e=[]){let t;switch(n){case"Browser":t=q2(ir());break;case"Worker":t=`${q2(ir())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pd}/${r}`}class PU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function OU(n,e={}){return is(n,"GET","/v2/passwordPolicy",$s(n,e))}const VU=6;class jU{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??VU,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class zU{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new H2(this),this.idTokenSubscription=new H2(this),this.beforeStateQueue=new PU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=VN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=As(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ed.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await C0(this,{idToken:e}),r=await la._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Vi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return et(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await I0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=mU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Vi(this.app))return Promise.reject(Ds(this));const t=e?un(e):null;return t&&et(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&et(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Vi(this.app)?Promise.reject(Ds(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Vi(this.app)?Promise.reject(Ds(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(As(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OU(this),t=new jU(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new mp("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await kU(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&As(e)||this._popupRedirectResolver;et(t,this,"argument-error"),this.redirectPersistenceManager=await ed.create(this,[As(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(et(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=QN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Vi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&hU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function pl(n){return un(n)}class H2{constructor(e){this.auth=e,this.observer=null,this.addObserver=tB(t=>this.observer=t)}get next(){return et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let wv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function LU(n){wv=n}function ZN(n){return wv.loadJS(n)}function BU(){return wv.recaptchaEnterpriseScript}function UU(){return wv.gapiScript}function FU(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class GU{constructor(){this.enterprise=new qU}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class qU{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const HU="recaptcha-enterprise",JN="NO_RECAPTCHA";class $U{constructor(e){this.type=HU,this.auth=pl(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{EU(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new wU(u);return a.tenantId==null?a._agentRecaptchaConfig=d:a._tenantRecaptchaConfigs[a.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;B2(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(d=>{o(d)}).catch(()=>{o(JN)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new GU().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{r(this.auth).then(c=>{if(!t&&B2(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=BU();u.length!==0&&(u+=c),ZN(u).then(()=>{i(c,a,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function $2(n,e,t,r=!1,i=!1){const a=new $U(n);let o;if(i)o=JN;else try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function R0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await $2(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await $2(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}function YU(n,e){const t=uw(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),a=t.getOptions();if(rl(a,e??{}))return i;ha(i,"already-initialized")}return t.initialize({options:e})}function KU(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(As);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function XU(n,e,t){const r=pl(n);et(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,a=eM(e),{host:o,port:c}=WU(e),u=c===null?"":`:${c}`,d={url:`${a}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){et(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),et(rl(d,r.config.emulator)&&rl(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Md(o)?(EN(`${a}//${o}${u}`),SN("Auth",!0)):QU()}function eM(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function WU(n){const e=eM(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:Y2(r.substr(a.length+1))}}else{const[a,o]=r.split(":");return{host:a,port:Y2(o)}}}function Y2(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function QU(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class gw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ts("not implemented")}_getIdTokenResponse(e){return Ts("not implemented")}_linkToIdToken(e,t){return Ts("not implemented")}_getReauthenticationResolver(e){return Ts("not implemented")}}async function ZU(n,e){return is(n,"POST","/v1/accounts:signUp",e)}async function JU(n,e){return bp(n,"POST","/v1/accounts:signInWithPassword",$s(n,e))}async function tM(n,e){return is(n,"POST","/v1/accounts:sendOobCode",$s(n,e))}async function e8(n,e){return tM(n,e)}async function t8(n,e){return tM(n,e)}async function n8(n,e){return bp(n,"POST","/v1/accounts:signInWithEmailLink",$s(n,e))}async function r8(n,e){return bp(n,"POST","/v1/accounts:signInWithEmailLink",$s(n,e))}class Lh extends gw{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Lh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Lh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return R0(e,t,"signInWithPassword",JU);case"emailLink":return n8(e,{email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return R0(e,r,"signUpPassword",ZU);case"emailLink":return r8(e,{idToken:t,email:this._email,oobCode:this._password});default:ha(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function td(n,e){return bp(n,"POST","/v1/accounts:signInWithIdp",$s(n,e))}const i8="http://localhost";class xc extends gw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new xc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ha("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const o=new xc(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return td(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,td(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,td(e,t)}buildRequest(){const e={requestUri:i8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=vp(t)}return e}}function a8(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function s8(n){const e=nh(rh(n)).link,t=e?nh(rh(e)).deep_link_id:null,r=nh(rh(n)).deep_link_id;return(r?nh(rh(r)).link:null)||r||t||e||n}class mw{constructor(e){const t=nh(rh(e)),r=t.apiKey??null,i=t.oobCode??null,a=a8(t.mode??null);et(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=s8(e);try{return new mw(t)}catch{return null}}}class Vc{constructor(){this.providerId=Vc.PROVIDER_ID}static credential(e,t){return Lh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=mw.parseLink(t);return et(r,"argument-error"),Lh._fromEmailAndCode(e,r.code,r.tenantId)}}Vc.PROVIDER_ID="password";Vc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Vc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class nM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xp extends nM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Uo extends xp{constructor(){super("facebook.com")}static credential(e){return xc._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";class Fo extends xp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return xc._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Fo.credential(t,r)}catch{return null}}}Fo.GOOGLE_SIGN_IN_METHOD="google.com";Fo.PROVIDER_ID="google.com";class Go extends xp{constructor(){super("github.com")}static credential(e){return xc._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Go.credential(e.oauthAccessToken)}catch{return null}}}Go.GITHUB_SIGN_IN_METHOD="github.com";Go.PROVIDER_ID="github.com";class qo extends xp{constructor(){super("twitter.com")}static credential(e,t){return xc._fromParams({providerId:qo.PROVIDER_ID,signInMethod:qo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qo.credentialFromTaggedObject(e)}static credentialFromError(e){return qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return qo.credential(t,r)}catch{return null}}}qo.TWITTER_SIGN_IN_METHOD="twitter.com";qo.PROVIDER_ID="twitter.com";async function o8(n,e){return bp(n,"POST","/v1/accounts:signUp",$s(n,e))}class _c{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await la._fromIdTokenResponse(e,r,i),o=K2(r);return new _c({user:a,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=K2(r);return new _c({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function K2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class D0 extends Hs{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,D0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new D0(e,t,r,i)}}function rM(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?D0._fromErrorAndOperation(n,a,e,r):a})}async function l8(n,e,t=!1){const r=await od(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return _c._forOperation(n,"link",r)}async function iM(n,e,t=!1){const{auth:r}=n;if(Vi(r.app))return Promise.reject(Ds(r));const i="reauthenticate";try{const a=await od(n,rM(r,i,e,n),t);et(a.idToken,r,"internal-error");const o=hw(a.idToken);et(o,r,"internal-error");const{sub:c}=o;return et(n.uid===c,r,"user-mismatch"),_c._forOperation(n,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&ha(r,"user-mismatch"),a}}async function aM(n,e,t=!1){if(Vi(n.app))return Promise.reject(Ds(n));const r="signIn",i=await rM(n,r,e),a=await _c._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function c8(n,e){return aM(pl(n),e)}async function u8(n,e){return iM(un(n),e)}async function sM(n){const e=pl(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function d8(n,e,t){const r=pl(n);await R0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",t8)}async function f8(n,e,t){if(Vi(n.app))return Promise.reject(Ds(n));const r=pl(n),o=await R0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",o8).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&sM(n),u}),c=await _c._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function h8(n,e,t){return Vi(n.app)?Promise.reject(Ds(n)):c8(un(n),Vc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&sM(n),r})}async function X2(n,e){const t=un(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:a}=await e8(t.auth,i);a!==n.email&&await n.reload()}async function p8(n,e){return is(n,"POST","/v1/accounts:update",e)}async function g8(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=un(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await od(r,p8(r.auth,a));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function m8(n,e,t,r){return un(n).onIdTokenChanged(e,t,r)}function v8(n,e,t){return un(n).beforeAuthStateChanged(e,t)}function y8(n,e,t,r){return un(n).onAuthStateChanged(e,t,r)}function W2(n){return un(n).signOut()}async function b8(n){return un(n).delete()}const k0="__sak";class oM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(k0,"1"),this.storage.removeItem(k0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const x8=1e3,_8=10;class lM extends oM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=WN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},a=this.storage.getItem(r);MU()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_8):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},x8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}lM.type="LOCAL";const w8=lM;class cM extends oM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}cM.type="SESSION";const uM=cM;function E8(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Ev{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Ev(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(t.origin,a)),u=await E8(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ev.receivers=[];function vw(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class S8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const d=vw("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(m.data.response);break;default:clearTimeout(h),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ya(){return window}function T8(n){Ya().location.href=n}function dM(){return typeof Ya().WorkerGlobalScope<"u"&&typeof Ya().importScripts=="function"}async function A8(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function C8(){return navigator?.serviceWorker?.controller||null}function I8(){return dM()?self:null}const fM="firebaseLocalStorageDb",R8=1,N0="firebaseLocalStorage",hM="fbase_key";class _p{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sv(n,e){return n.transaction([N0],e?"readwrite":"readonly").objectStore(N0)}function D8(){const n=indexedDB.deleteDatabase(fM);return new _p(n).toPromise()}function D1(){const n=indexedDB.open(fM,R8);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(N0,{keyPath:hM})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(N0)?e(r):(r.close(),await D8(),e(await D1()))})})}async function Q2(n,e,t){const r=Sv(n,!0).put({[hM]:e,value:t});return new _p(r).toPromise()}async function k8(n,e){const t=Sv(n,!1).get(e),r=await new _p(t).toPromise();return r===void 0?null:r.value}function Z2(n,e){const t=Sv(n,!0).delete(e);return new _p(t).toPromise()}const N8=800,M8=3;class pM{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await D1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>M8)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ev._getInstance(I8()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await A8(),!this.activeServiceWorker)return;this.sender=new S8(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||C8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await D1();return await Q2(e,k0,"1"),await Z2(e,k0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Q2(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>k8(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Z2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Sv(i,!1).getAll();return new _p(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),N8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pM.type="LOCAL";const P8=pM;new yp(3e4,6e4);function O8(n,e){return e?As(e):(et(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class yw extends gw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return td(e,this._buildIdpRequest())}_linkToIdToken(e,t){return td(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return td(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function V8(n){return aM(n.auth,new yw(n),n.bypassAuthState)}function j8(n){const{auth:e,user:t}=n;return et(t,e,"internal-error"),iM(t,new yw(n),n.bypassAuthState)}async function z8(n){const{auth:e,user:t}=n;return et(t,e,"internal-error"),l8(t,new yw(n),n.bypassAuthState)}class gM{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return V8;case"linkViaPopup":case"linkViaRedirect":return z8;case"reauthViaPopup":case"reauthViaRedirect":return j8;default:ha(this.auth,"internal-error")}}resolve(e){Vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const L8=new yp(2e3,1e4);class Bu extends gM{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,Bu.currentPopupAction&&Bu.currentPopupAction.cancel(),Bu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return et(e,this.auth,"internal-error"),e}async onExecution(){Vs(this.filter.length===1,"Popup operations only handle one event");const e=vw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($a(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject($a(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($a(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,L8.get())};e()}}Bu.currentPopupAction=null;const B8="pendingRedirect",Jm=new Map;class U8 extends gM{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Jm.get(this.auth._key());if(!e){try{const r=await F8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Jm.set(this.auth._key(),e)}return this.bypassAuthState||Jm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function F8(n,e){const t=H8(e),r=q8(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function G8(n,e){Jm.set(n._key(),e)}function q8(n){return As(n._redirectPersistence)}function H8(n){return Zm(B8,n.config.apiKey,n.name)}async function $8(n,e,t=!1){if(Vi(n.app))return Promise.reject(Ds(n));const r=pl(n),i=O8(r,e),o=await new U8(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const Y8=600*1e3;class K8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!X8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!mM(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError($a(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Y8&&this.cachedEventUids.clear(),this.cachedEventUids.has(J2(e))}saveEventToCache(e){this.cachedEventUids.add(J2(e)),this.lastProcessedEventTime=Date.now()}}function J2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function mM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function X8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mM(n);default:return!1}}async function W8(n,e={}){return is(n,"GET","/v1/projects",e)}const Q8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Z8=/^https?/;async function J8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await W8(n);for(const t of e)try{if(eF(t))return}catch{}ha(n,"unauthorized-domain")}function eF(n){const e=I1(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!Z8.test(t))return!1;if(Q8.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const tF=new yp(3e4,6e4);function eI(){const n=Ya().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function nF(n){return new Promise((e,t)=>{function r(){eI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eI(),t($a(n,"network-request-failed"))},timeout:tF.get()})}if(Ya().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ya().gapi?.load)r();else{const i=FU("iframefcb");return Ya()[i]=()=>{gapi.load?r():t($a(n,"network-request-failed"))},ZN(`${UU()}?onload=${i}`).catch(a=>t(a))}}).catch(e=>{throw e0=null,e})}let e0=null;function rF(n){return e0=e0||nF(n),e0}const iF=new yp(5e3,15e3),aF="__/auth/iframe",sF="emulator/auth/iframe",oF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},lF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cF(n){const e=n.config;et(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?fw(e,sF):`https://${n.config.authDomain}/${aF}`,r={apiKey:e.apiKey,appName:n.name,v:Pd},i=lF.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${vp(r).slice(1)}`}async function uF(n){const e=await rF(n),t=Ya().gapi;return et(t,n,"internal-error"),e.open({where:document.body,url:cF(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oF,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const o=$a(n,"network-request-failed"),c=Ya().setTimeout(()=>{a(o)},iF.get());function u(){Ya().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{a(o)})}))}const dF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fF=500,hF=600,pF="_blank",gF="http://localhost";class tI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mF(n,e,t,r=fF,i=hF){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...dF,width:r.toString(),height:i.toString(),top:a,left:o},d=ir().toLowerCase();t&&(c=HN(d)?pF:t),GN(d)&&(e=e||gF,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[b,_])=>`${m}${b}=${_},`,"");if(NU(d)&&c!=="_self")return vF(e||"",c),new tI(null);const p=window.open(e||"",c,h);et(p,n,"popup-blocked");try{p.focus()}catch{}return new tI(p)}function vF(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const yF="__/auth/handler",bF="emulator/auth/handler",xF=encodeURIComponent("fac");async function nI(n,e,t,r,i,a){et(n.config.authDomain,n,"auth-domain-config-required"),et(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Pd,eventId:i};if(e instanceof nM){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",eB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof xp){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await n._getAppCheckToken(),d=u?`#${xF}=${encodeURIComponent(u)}`:"";return`${_F(n)}?${vp(c).slice(1)}${d}`}function _F({config:n}){return n.emulator?fw(n,bF):`https://${n.authDomain}/${yF}`}const Ax="webStorageSupport";class wF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uM,this._completeRedirectFn=$8,this._overrideRedirectResult=G8}async _openPopup(e,t,r,i){Vs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await nI(e,t,r,I1(),i);return mF(e,a,vw())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await nI(e,t,r,I1(),i);return T8(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(Vs(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await uF(e),r=new K8(e);return t.register("authEvent",i=>(et(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ax,{type:Ax},i=>{const a=i?.[0]?.[Ax];a!==void 0&&t(!!a),ha(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=J8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return WN()||qN()||pw()}}const EF=wF;var rI="@firebase/auth",iI="1.11.1";class SF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function TF(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function AF(n){sd(new bc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;et(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:QN(n)},d=new zU(r,i,a,u);return KU(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),sd(new bc("auth-internal",e=>{const t=pl(e.getProvider("auth").getImmediate());return(r=>new SF(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zo(rI,iI,TF(n)),Zo(rI,iI,"esm2020")}const CF=300,IF=wN("authIdTokenMaxAge")||CF;let aI=null;const RF=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>IF)return;const i=t?.token;aI!==i&&(aI=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function DF(n=NN()){const e=uw(n,"auth");if(e.isInitialized())return e.getImmediate();const t=YU(n,{popupRedirectResolver:EF,persistence:[P8,w8,uM]}),r=wN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const o=RF(a.toString());v8(t,o,()=>o(t.currentUser)),m8(t,c=>o(c))}}const i=xN("auth");return i&&XU(t,`http://${i}`),t}function kF(){return document.getElementsByTagName("head")?.[0]??document}LU({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=$a("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",kF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});AF("Browser");var NF="firebase",MF="12.6.0";Zo(NF,MF,"app");var sI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Jo,vM;(function(){var n;function e(A,I){function k(){}k.prototype=I.prototype,A.F=I.prototype,A.prototype=new k,A.prototype.constructor=A,A.D=function(V,B,L){for(var P=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)P[Z-2]=arguments[Z];return I.prototype[B].apply(V,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,I,k){k||(k=0);const V=Array(16);if(typeof I=="string")for(var B=0;B<16;++B)V[B]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(B=0;B<16;++B)V[B]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=A.g[0],k=A.g[1],B=A.g[2];let L=A.g[3],P;P=I+(L^k&(B^L))+V[0]+3614090360&4294967295,I=k+(P<<7&4294967295|P>>>25),P=L+(B^I&(k^B))+V[1]+3905402710&4294967295,L=I+(P<<12&4294967295|P>>>20),P=B+(k^L&(I^k))+V[2]+606105819&4294967295,B=L+(P<<17&4294967295|P>>>15),P=k+(I^B&(L^I))+V[3]+3250441966&4294967295,k=B+(P<<22&4294967295|P>>>10),P=I+(L^k&(B^L))+V[4]+4118548399&4294967295,I=k+(P<<7&4294967295|P>>>25),P=L+(B^I&(k^B))+V[5]+1200080426&4294967295,L=I+(P<<12&4294967295|P>>>20),P=B+(k^L&(I^k))+V[6]+2821735955&4294967295,B=L+(P<<17&4294967295|P>>>15),P=k+(I^B&(L^I))+V[7]+4249261313&4294967295,k=B+(P<<22&4294967295|P>>>10),P=I+(L^k&(B^L))+V[8]+1770035416&4294967295,I=k+(P<<7&4294967295|P>>>25),P=L+(B^I&(k^B))+V[9]+2336552879&4294967295,L=I+(P<<12&4294967295|P>>>20),P=B+(k^L&(I^k))+V[10]+4294925233&4294967295,B=L+(P<<17&4294967295|P>>>15),P=k+(I^B&(L^I))+V[11]+2304563134&4294967295,k=B+(P<<22&4294967295|P>>>10),P=I+(L^k&(B^L))+V[12]+1804603682&4294967295,I=k+(P<<7&4294967295|P>>>25),P=L+(B^I&(k^B))+V[13]+4254626195&4294967295,L=I+(P<<12&4294967295|P>>>20),P=B+(k^L&(I^k))+V[14]+2792965006&4294967295,B=L+(P<<17&4294967295|P>>>15),P=k+(I^B&(L^I))+V[15]+1236535329&4294967295,k=B+(P<<22&4294967295|P>>>10),P=I+(B^L&(k^B))+V[1]+4129170786&4294967295,I=k+(P<<5&4294967295|P>>>27),P=L+(k^B&(I^k))+V[6]+3225465664&4294967295,L=I+(P<<9&4294967295|P>>>23),P=B+(I^k&(L^I))+V[11]+643717713&4294967295,B=L+(P<<14&4294967295|P>>>18),P=k+(L^I&(B^L))+V[0]+3921069994&4294967295,k=B+(P<<20&4294967295|P>>>12),P=I+(B^L&(k^B))+V[5]+3593408605&4294967295,I=k+(P<<5&4294967295|P>>>27),P=L+(k^B&(I^k))+V[10]+38016083&4294967295,L=I+(P<<9&4294967295|P>>>23),P=B+(I^k&(L^I))+V[15]+3634488961&4294967295,B=L+(P<<14&4294967295|P>>>18),P=k+(L^I&(B^L))+V[4]+3889429448&4294967295,k=B+(P<<20&4294967295|P>>>12),P=I+(B^L&(k^B))+V[9]+568446438&4294967295,I=k+(P<<5&4294967295|P>>>27),P=L+(k^B&(I^k))+V[14]+3275163606&4294967295,L=I+(P<<9&4294967295|P>>>23),P=B+(I^k&(L^I))+V[3]+4107603335&4294967295,B=L+(P<<14&4294967295|P>>>18),P=k+(L^I&(B^L))+V[8]+1163531501&4294967295,k=B+(P<<20&4294967295|P>>>12),P=I+(B^L&(k^B))+V[13]+2850285829&4294967295,I=k+(P<<5&4294967295|P>>>27),P=L+(k^B&(I^k))+V[2]+4243563512&4294967295,L=I+(P<<9&4294967295|P>>>23),P=B+(I^k&(L^I))+V[7]+1735328473&4294967295,B=L+(P<<14&4294967295|P>>>18),P=k+(L^I&(B^L))+V[12]+2368359562&4294967295,k=B+(P<<20&4294967295|P>>>12),P=I+(k^B^L)+V[5]+4294588738&4294967295,I=k+(P<<4&4294967295|P>>>28),P=L+(I^k^B)+V[8]+2272392833&4294967295,L=I+(P<<11&4294967295|P>>>21),P=B+(L^I^k)+V[11]+1839030562&4294967295,B=L+(P<<16&4294967295|P>>>16),P=k+(B^L^I)+V[14]+4259657740&4294967295,k=B+(P<<23&4294967295|P>>>9),P=I+(k^B^L)+V[1]+2763975236&4294967295,I=k+(P<<4&4294967295|P>>>28),P=L+(I^k^B)+V[4]+1272893353&4294967295,L=I+(P<<11&4294967295|P>>>21),P=B+(L^I^k)+V[7]+4139469664&4294967295,B=L+(P<<16&4294967295|P>>>16),P=k+(B^L^I)+V[10]+3200236656&4294967295,k=B+(P<<23&4294967295|P>>>9),P=I+(k^B^L)+V[13]+681279174&4294967295,I=k+(P<<4&4294967295|P>>>28),P=L+(I^k^B)+V[0]+3936430074&4294967295,L=I+(P<<11&4294967295|P>>>21),P=B+(L^I^k)+V[3]+3572445317&4294967295,B=L+(P<<16&4294967295|P>>>16),P=k+(B^L^I)+V[6]+76029189&4294967295,k=B+(P<<23&4294967295|P>>>9),P=I+(k^B^L)+V[9]+3654602809&4294967295,I=k+(P<<4&4294967295|P>>>28),P=L+(I^k^B)+V[12]+3873151461&4294967295,L=I+(P<<11&4294967295|P>>>21),P=B+(L^I^k)+V[15]+530742520&4294967295,B=L+(P<<16&4294967295|P>>>16),P=k+(B^L^I)+V[2]+3299628645&4294967295,k=B+(P<<23&4294967295|P>>>9),P=I+(B^(k|~L))+V[0]+4096336452&4294967295,I=k+(P<<6&4294967295|P>>>26),P=L+(k^(I|~B))+V[7]+1126891415&4294967295,L=I+(P<<10&4294967295|P>>>22),P=B+(I^(L|~k))+V[14]+2878612391&4294967295,B=L+(P<<15&4294967295|P>>>17),P=k+(L^(B|~I))+V[5]+4237533241&4294967295,k=B+(P<<21&4294967295|P>>>11),P=I+(B^(k|~L))+V[12]+1700485571&4294967295,I=k+(P<<6&4294967295|P>>>26),P=L+(k^(I|~B))+V[3]+2399980690&4294967295,L=I+(P<<10&4294967295|P>>>22),P=B+(I^(L|~k))+V[10]+4293915773&4294967295,B=L+(P<<15&4294967295|P>>>17),P=k+(L^(B|~I))+V[1]+2240044497&4294967295,k=B+(P<<21&4294967295|P>>>11),P=I+(B^(k|~L))+V[8]+1873313359&4294967295,I=k+(P<<6&4294967295|P>>>26),P=L+(k^(I|~B))+V[15]+4264355552&4294967295,L=I+(P<<10&4294967295|P>>>22),P=B+(I^(L|~k))+V[6]+2734768916&4294967295,B=L+(P<<15&4294967295|P>>>17),P=k+(L^(B|~I))+V[13]+1309151649&4294967295,k=B+(P<<21&4294967295|P>>>11),P=I+(B^(k|~L))+V[4]+4149444226&4294967295,I=k+(P<<6&4294967295|P>>>26),P=L+(k^(I|~B))+V[11]+3174756917&4294967295,L=I+(P<<10&4294967295|P>>>22),P=B+(I^(L|~k))+V[2]+718787259&4294967295,B=L+(P<<15&4294967295|P>>>17),P=k+(L^(B|~I))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+I&4294967295,A.g[1]=A.g[1]+(B+(P<<21&4294967295|P>>>11))&4294967295,A.g[2]=A.g[2]+B&4294967295,A.g[3]=A.g[3]+L&4294967295}r.prototype.v=function(A,I){I===void 0&&(I=A.length);const k=I-this.blockSize,V=this.C;let B=this.h,L=0;for(;L<I;){if(B==0)for(;L<=k;)i(this,A,L),L+=this.blockSize;if(typeof A=="string"){for(;L<I;)if(V[B++]=A.charCodeAt(L++),B==this.blockSize){i(this,V),B=0;break}}else for(;L<I;)if(V[B++]=A[L++],B==this.blockSize){i(this,V),B=0;break}}this.h=B,this.o+=I},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var I=1;I<A.length-8;++I)A[I]=0;I=this.o*8;for(var k=A.length-8;k<A.length;++k)A[k]=I&255,I/=256;for(this.v(A),A=Array(16),I=0,k=0;k<4;++k)for(let V=0;V<32;V+=8)A[I++]=this.g[k]>>>V&255;return A};function a(A,I){var k=c;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=I(A)}function o(A,I){this.h=I;const k=[];let V=!0;for(let B=A.length-1;B>=0;B--){const L=A[B]|0;V&&L==I||(k[B]=L,V=!1)}this.g=k}var c={};function u(A){return-128<=A&&A<128?a(A,function(I){return new o([I|0],I<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(A<0)return S(d(-A));const I=[];let k=1;for(let V=0;A>=k;V++)I[V]=A/k|0,k*=4294967296;return new o(I,0)}function h(A,I){if(A.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(A.charAt(0)=="-")return S(h(A.substring(1),I));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(I,8));let V=p;for(let L=0;L<A.length;L+=8){var B=Math.min(8,A.length-L);const P=parseInt(A.substring(L,L+B),I);B<8?(B=d(Math.pow(I,B)),V=V.j(B).add(d(P))):(V=V.j(k),V=V.add(d(P)))}return V}var p=u(0),m=u(1),b=u(16777216);n=o.prototype,n.m=function(){if(w(this))return-S(this).m();let A=0,I=1;for(let k=0;k<this.g.length;k++){const V=this.i(k);A+=(V>=0?V:4294967296+V)*I,I*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(_(this))return"0";if(w(this))return"-"+S(this).toString(A);const I=d(Math.pow(A,6));var k=this;let V="";for(;;){const B=M(k,I).g;k=T(k,B.j(I));let L=((k.g.length>0?k.g[0]:k.h)>>>0).toString(A);if(k=B,_(k))return L+V;for(;L.length<6;)L="0"+L;V=L+V}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function _(A){if(A.h!=0)return!1;for(let I=0;I<A.g.length;I++)if(A.g[I]!=0)return!1;return!0}function w(A){return A.h==-1}n.l=function(A){return A=T(this,A),w(A)?-1:_(A)?0:1};function S(A){const I=A.g.length,k=[];for(let V=0;V<I;V++)k[V]=~A.g[V];return new o(k,~A.h).add(m)}n.abs=function(){return w(this)?S(this):this},n.add=function(A){const I=Math.max(this.g.length,A.g.length),k=[];let V=0;for(let B=0;B<=I;B++){let L=V+(this.i(B)&65535)+(A.i(B)&65535),P=(L>>>16)+(this.i(B)>>>16)+(A.i(B)>>>16);V=P>>>16,L&=65535,P&=65535,k[B]=P<<16|L}return new o(k,k[k.length-1]&-2147483648?-1:0)};function T(A,I){return A.add(S(I))}n.j=function(A){if(_(this)||_(A))return p;if(w(this))return w(A)?S(this).j(S(A)):S(S(this).j(A));if(w(A))return S(this.j(S(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const I=this.g.length+A.g.length,k=[];for(var V=0;V<2*I;V++)k[V]=0;for(V=0;V<this.g.length;V++)for(let B=0;B<A.g.length;B++){const L=this.i(V)>>>16,P=this.i(V)&65535,Z=A.i(B)>>>16,K=A.i(B)&65535;k[2*V+2*B]+=P*K,C(k,2*V+2*B),k[2*V+2*B+1]+=L*K,C(k,2*V+2*B+1),k[2*V+2*B+1]+=P*Z,C(k,2*V+2*B+1),k[2*V+2*B+2]+=L*Z,C(k,2*V+2*B+2)}for(A=0;A<I;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=I;A<2*I;A++)k[A]=0;return new o(k,0)};function C(A,I){for(;(A[I]&65535)!=A[I];)A[I+1]+=A[I]>>>16,A[I]&=65535,I++}function D(A,I){this.g=A,this.h=I}function M(A,I){if(_(I))throw Error("division by zero");if(_(A))return new D(p,p);if(w(A))return I=M(S(A),I),new D(S(I.g),S(I.h));if(w(I))return I=M(A,S(I)),new D(S(I.g),I.h);if(A.g.length>30){if(w(A)||w(I))throw Error("slowDivide_ only works with positive integers.");for(var k=m,V=I;V.l(A)<=0;)k=j(k),V=j(V);var B=z(k,1),L=z(V,1);for(V=z(V,2),k=z(k,2);!_(V);){var P=L.add(V);P.l(A)<=0&&(B=B.add(k),L=P),V=z(V,1),k=z(k,1)}return I=T(A,B.j(I)),new D(B,I)}for(B=p;A.l(I)>=0;){for(k=Math.max(1,Math.floor(A.m()/I.m())),V=Math.ceil(Math.log(k)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),L=d(k),P=L.j(I);w(P)||P.l(A)>0;)k-=V,L=d(k),P=L.j(I);_(L)&&(L=m),B=B.add(L),A=T(A,P)}return new D(B,A)}n.B=function(A){return M(this,A).h},n.and=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<I;V++)k[V]=this.i(V)&A.i(V);return new o(k,this.h&A.h)},n.or=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<I;V++)k[V]=this.i(V)|A.i(V);return new o(k,this.h|A.h)},n.xor=function(A){const I=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<I;V++)k[V]=this.i(V)^A.i(V);return new o(k,this.h^A.h)};function j(A){const I=A.g.length+1,k=[];for(let V=0;V<I;V++)k[V]=A.i(V)<<1|A.i(V-1)>>>31;return new o(k,A.h)}function z(A,I){const k=I>>5;I%=32;const V=A.g.length-k,B=[];for(let L=0;L<V;L++)B[L]=I>0?A.i(L+k)>>>I|A.i(L+k+1)<<32-I:A.i(L+k);return new o(B,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,vM=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Jo=o}).apply(typeof sI<"u"?sI:typeof self<"u"?self:typeof window<"u"?window:{});var Sm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var yM,ih,bM,t0,k1,xM,_M,wM;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sm=="object"&&Sm];for(var R=0;R<y.length;++R){var O=y[R];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var r=t(this);function i(y,R){if(R)e:{var O=r;y=y.split(".");for(var q=0;q<y.length-1;q++){var se=y[q];if(!(se in O))break e;O=O[se]}y=y[y.length-1],q=O[y],R=R(q),R!=q&&R!=null&&e(O,y,{configurable:!0,writable:!0,value:R})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(R){var O=[],q;for(q in R)Object.prototype.hasOwnProperty.call(R,q)&&O.push([q,R[q]]);return O}});var a=a||{},o=this||self;function c(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function u(y,R,O){return y.call.apply(y.bind,arguments)}function d(y,R,O){return d=u,d.apply(null,arguments)}function h(y,R){var O=Array.prototype.slice.call(arguments,1);return function(){var q=O.slice();return q.push.apply(q,arguments),y.apply(this,q)}}function p(y,R){function O(){}O.prototype=R.prototype,y.Z=R.prototype,y.prototype=new O,y.prototype.constructor=y,y.Ob=function(q,se,he){for(var Re=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)Re[mt-2]=arguments[mt];return R.prototype[se].apply(q,Re)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function b(y){const R=y.length;if(R>0){const O=Array(R);for(let q=0;q<R;q++)O[q]=y[q];return O}return[]}function _(y,R){for(let q=1;q<arguments.length;q++){const se=arguments[q];var O=typeof se;if(O=O!="object"?O:se?Array.isArray(se)?"array":O:"null",O=="array"||O=="object"&&typeof se.length=="number"){O=y.length||0;const he=se.length||0;y.length=O+he;for(let Re=0;Re<he;Re++)y[O+Re]=se[Re]}else y.push(se)}}class w{constructor(R,O){this.i=R,this.j=O,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function S(y){o.setTimeout(()=>{throw y},0)}function T(){var y=A;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class C{constructor(){this.h=this.g=null}add(R,O){const q=D.get();q.set(R,O),this.h?this.h.next=q:this.g=q,this.h=q}}var D=new w(()=>new M,y=>y.reset());class M{constructor(){this.next=this.g=this.h=null}set(R,O){this.h=R,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let j,z=!1,A=new C,I=()=>{const y=Promise.resolve(void 0);j=()=>{y.then(k)}};function k(){for(var y;y=T();){try{y.h.call(y.g)}catch(O){S(O)}var R=D;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}z=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function B(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}B.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const O=()=>{};o.addEventListener("test",O,R),o.removeEventListener("test",O,R)}catch{}return y})();function P(y){return/^[\s\xa0]*$/.test(y)}function Z(y,R){B.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}p(Z,B),Z.prototype.init=function(y,R){const O=this.type=y.type,q=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(O=="mouseover"?R=y.fromElement:O=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&Z.Z.h.call(this)},Z.prototype.h=function(){Z.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),H=0;function $(y,R,O,q,se){this.listener=y,this.proxy=null,this.src=R,this.type=O,this.capture=!!q,this.ha=se,this.key=++H,this.da=this.fa=!1}function Q(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function re(y,R,O){for(const q in y)R.call(O,y[q],q,y)}function ue(y,R){for(const O in y)R.call(void 0,y[O],O,y)}function G(y){const R={};for(const O in y)R[O]=y[O];return R}const Y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(y,R){let O,q;for(let se=1;se<arguments.length;se++){q=arguments[se];for(O in q)y[O]=q[O];for(let he=0;he<Y.length;he++)O=Y[he],Object.prototype.hasOwnProperty.call(q,O)&&(y[O]=q[O])}}function te(y){this.src=y,this.g={},this.h=0}te.prototype.add=function(y,R,O,q,se){const he=y.toString();y=this.g[he],y||(y=this.g[he]=[],this.h++);const Re=fe(y,R,q,se);return Re>-1?(R=y[Re],O||(R.fa=!1)):(R=new $(R,this.src,he,!!q,se),R.fa=O,y.push(R)),R};function ce(y,R){const O=R.type;if(O in y.g){var q=y.g[O],se=Array.prototype.indexOf.call(q,R,void 0),he;(he=se>=0)&&Array.prototype.splice.call(q,se,1),he&&(Q(R),y.g[O].length==0&&(delete y.g[O],y.h--))}}function fe(y,R,O,q){for(let se=0;se<y.length;++se){const he=y[se];if(!he.da&&he.listener==R&&he.capture==!!O&&he.ha==q)return se}return-1}var ye="closure_lm_"+(Math.random()*1e6|0),Ae={};function Pe(y,R,O,q,se){if(Array.isArray(R)){for(let he=0;he<R.length;he++)Pe(y,R[he],O,q,se);return null}return O=rt(O),y&&y[K]?y.J(R,O,c(q)?!!q.capture:!1,se):Se(y,R,O,!1,q,se)}function Se(y,R,O,q,se,he){if(!R)throw Error("Invalid event type");const Re=c(se)?!!se.capture:!!se;let mt=Ne(y);if(mt||(y[ye]=mt=new te(y)),O=mt.add(R,O,q,Re,he),O.proxy)return O;if(q=we(),O.proxy=q,q.src=y,q.listener=O,y.addEventListener)L||(se=Re),se===void 0&&(se=!1),y.addEventListener(R.toString(),q,se);else if(y.attachEvent)y.attachEvent(Ue(R.toString()),q);else if(y.addListener&&y.removeListener)y.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return O}function we(){function y(O){return R.call(y.src,y.listener,O)}const R=Ee;return y}function ke(y,R,O,q,se){if(Array.isArray(R))for(var he=0;he<R.length;he++)ke(y,R[he],O,q,se);else q=c(q)?!!q.capture:!!q,O=rt(O),y&&y[K]?(y=y.i,he=String(R).toString(),he in y.g&&(R=y.g[he],O=fe(R,O,q,se),O>-1&&(Q(R[O]),Array.prototype.splice.call(R,O,1),R.length==0&&(delete y.g[he],y.h--)))):y&&(y=Ne(y))&&(R=y.g[R.toString()],y=-1,R&&(y=fe(R,O,q,se)),(O=y>-1?R[y]:null)&&nt(O))}function nt(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[K])ce(R.i,y);else{var O=y.type,q=y.proxy;R.removeEventListener?R.removeEventListener(O,q,y.capture):R.detachEvent?R.detachEvent(Ue(O),q):R.addListener&&R.removeListener&&R.removeListener(q),(O=Ne(R))?(ce(O,y),O.h==0&&(O.src=null,R[ye]=null)):Q(y)}}}function Ue(y){return y in Ae?Ae[y]:Ae[y]="on"+y}function Ee(y,R){if(y.da)y=!0;else{R=new Z(R,this);const O=y.listener,q=y.ha||y.src;y.fa&&nt(y),y=O.call(q,R)}return y}function Ne(y){return y=y[ye],y instanceof te?y:null}var Je="__closure_events_fn_"+(Math.random()*1e9>>>0);function rt(y){return typeof y=="function"?y:(y[Je]||(y[Je]=function(R){return y.handleEvent(R)}),y[Je])}function De(){V.call(this),this.i=new te(this),this.M=this,this.G=null}p(De,V),De.prototype[K]=!0,De.prototype.removeEventListener=function(y,R,O,q){ke(this,y,R,O,q)};function je(y,R){var O,q=y.G;if(q)for(O=[];q;q=q.G)O.push(q);if(y=y.M,q=R.type||R,typeof R=="string")R=new B(R,y);else if(R instanceof B)R.target=R.target||y;else{var se=R;R=new B(q,y),ne(R,se)}se=!0;let he,Re;if(O)for(Re=O.length-1;Re>=0;Re--)he=R.g=O[Re],se=We(he,q,!0,R)&&se;if(he=R.g=y,se=We(he,q,!0,R)&&se,se=We(he,q,!1,R)&&se,O)for(Re=0;Re<O.length;Re++)he=R.g=O[Re],se=We(he,q,!1,R)&&se}De.prototype.N=function(){if(De.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const O=y.g[R];for(let q=0;q<O.length;q++)Q(O[q]);delete y.g[R],y.h--}}this.G=null},De.prototype.J=function(y,R,O,q){return this.i.add(String(y),R,!1,O,q)},De.prototype.K=function(y,R,O,q){return this.i.add(String(y),R,!0,O,q)};function We(y,R,O,q){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let se=!0;for(let he=0;he<R.length;++he){const Re=R[he];if(Re&&!Re.da&&Re.capture==O){const mt=Re.listener,Rn=Re.ha||Re.src;Re.fa&&ce(y.i,Re),se=mt.call(Rn,q)!==!1&&se}}return se&&!q.defaultPrevented}function tn(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=d(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:o.setTimeout(y,R||0)}function Yt(y){y.g=tn(()=>{y.g=null,y.i&&(y.i=!1,Yt(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class st extends V{constructor(R,O){super(),this.m=R,this.l=O,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Yt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function at(y){V.call(this),this.h=y,this.g={}}p(at,V);var Kt=[];function Vn(y){re(y.g,function(R,O){this.g.hasOwnProperty(O)&&nt(R)},y),y.g={}}at.prototype.N=function(){at.Z.N.call(this),Vn(this)},at.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ii=o.JSON.stringify,Qs=o.JSON.parse,Zs=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Yi(){}function ya(){}var Nr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function _n(){B.call(this,"d")}p(_n,B);function ze(){B.call(this,"c")}p(ze,B);var Oe={},ur=null;function pt(){return ur=ur||new De}Oe.Ia="serverreachability";function At(y){B.call(this,Oe.Ia,y)}p(At,B);function lt(y){const R=pt();je(R,new At(R))}Oe.STAT_EVENT="statevent";function Et(y,R){B.call(this,Oe.STAT_EVENT,y),this.stat=R}p(Et,B);function qe(y){const R=pt();je(R,new Et(R,y))}Oe.Ja="timingevent";function kt(y,R){B.call(this,Oe.Ja,y),this.size=R}p(kt,B);function ct(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},R)}function Nt(){this.g=!0}Nt.prototype.ua=function(){this.g=!1};function nn(y,R,O,q,se,he){y.info(function(){if(y.g)if(he){var Re="",mt=he.split("&");for(let zt=0;zt<mt.length;zt++){var Rn=mt[zt].split("=");if(Rn.length>1){const dn=Rn[0];Rn=Rn[1];const Ei=dn.split("_");Re=Ei.length>=2&&Ei[1]=="type"?Re+(dn+"="+Rn+"&"):Re+(dn+"=redacted&")}}}else Re=null;else Re=he;return"XMLHTTP REQ ("+q+") [attempt "+se+"]: "+R+`
`+O+`
`+Re})}function wn(y,R,O,q,se,he,Re){y.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+se+"]: "+R+`
`+O+`
`+he+" "+Re})}function gt(y,R,O,q){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+dr(y,O)+(q?" "+q:"")})}function rn(y,R){y.info(function(){return"TIMEOUT: "+R})}Nt.prototype.info=function(){};function dr(y,R){if(!y.g)return R;if(!R)return null;try{const he=JSON.parse(R);if(he){for(y=0;y<he.length;y++)if(Array.isArray(he[y])){var O=he[y];if(!(O.length<2)){var q=O[1];if(Array.isArray(q)&&!(q.length<1)){var se=q[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Re=1;Re<q.length;Re++)q[Re]=""}}}}return ii(he)}catch{return R}}var ai={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Mr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},si;function fr(){}p(fr,Yi),fr.prototype.g=function(){return new XMLHttpRequest},si=new fr;function ss(y){return encodeURIComponent(String(y))}function Zp(y){var R=1;y=y.split(":");const O=[];for(;R>0&&y.length;)O.push(y.shift()),R--;return y.length&&O.push(y.join(":")),O}function Ki(y,R,O,q){this.j=y,this.i=R,this.l=O,this.S=q||1,this.V=new at(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Xi}function Xi(){this.i=null,this.g="",this.h=!1}var jn={},sr={};function ba(y,R,O){y.M=1,y.A=xl(Ln(R)),y.u=O,y.R=!0,Uc(y,null)}function Uc(y,R){y.F=Date.now(),xa(y),y.B=Ln(y.A);var O=y.B,q=y.S;Array.isArray(q)||(q=[String(q)]),Hc(O.i,"t",q),y.C=0,O=y.j.L,y.h=new Xi,y.g=hg(y.j,O?R:null,!y.u),y.P>0&&(y.O=new st(d(y.Y,y,y.g),y.P)),R=y.V,O=y.g,q=y.ba;var se="readystatechange";Array.isArray(se)||(se&&(Kt[0]=se.toString()),se=Kt);for(let he=0;he<se.length;he++){const Re=Pe(O,se[he],q||R.handleEvent,!1,R.h||R);if(!Re)break;R.g[Re.key]=Re}R=y.J?G(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),lt(),nn(y.i,y.v,y.B,y.l,y.S,y.u)}Ki.prototype.ba=function(y){y=y.target;const R=this.O;R&&Zi(y)==3?R.j():this.Y(y)},Ki.prototype.Y=function(y){try{if(y==this.g)e:{const mt=Zi(this.g),Rn=this.g.ya(),zt=this.g.ca();if(!(mt<3)&&(mt!=3||this.g&&(this.h.h||this.g.la()||hr(this.g)))){this.K||mt!=4||Rn==7||(Rn==8||zt<=0?lt(3):lt(2)),_a(this);var R=this.g.ca();this.X=R;var O=my(this);if(this.o=R==200,wn(this.i,this.v,this.B,this.l,this.S,mt,R),this.o){if(this.U&&!this.L){t:{if(this.g){var q,se=this.g;if((q=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(q)){var he=q;break t}}he=null}if(y=he)gt(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,wa(this,y);else{this.o=!1,this.m=3,qe(12),oi(this),xi(this);break e}}if(this.R){y=!0;let dn;for(;!this.K&&this.C<O.length;)if(dn=eg(this,O),dn==sr){mt==4&&(this.m=4,qe(14),y=!1),gt(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==jn){this.m=4,qe(15),gt(this.i,this.l,O,"[Invalid Chunk]"),y=!1;break}else gt(this.i,this.l,dn,null),wa(this,dn);if(Jp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||O.length!=0||this.h.h||(this.m=1,qe(16),y=!1),this.o=this.o&&y,!y)gt(this.i,this.l,O,"[Invalid Chunked Response]"),oi(this),xi(this);else if(O.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),cf(Re),Re.P=!0,qe(11))}}else gt(this.i,this.l,O,null),wa(this,O);mt==4&&oi(this),this.o&&!this.K&&(mt==4?cg(this.j,this):(this.o=!1,xa(this)))}else ls(this.g),R==400&&O.indexOf("Unknown SID")>0?(this.m=3,qe(12)):(this.m=0,qe(13)),oi(this),xi(this)}}}catch{}finally{}};function my(y){if(!Jp(y))return y.g.la();const R=hr(y.g);if(R==="")return"";let O="";const q=R.length,se=Zi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return oi(y),xi(y),"";y.h.i=new o.TextDecoder}for(let he=0;he<q;he++)y.h.h=!0,O+=y.h.i.decode(R[he],{stream:!(se&&he==q-1)});return R.length=0,y.h.g+=O,y.C=0,y.h.g}function Jp(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function eg(y,R){var O=y.C,q=R.indexOf(`
`,O);return q==-1?sr:(O=Number(R.substring(O,q)),isNaN(O)?jn:(q+=1,q+O>R.length?sr:(R=R.slice(q,q+O),y.C=q+O,R)))}Ki.prototype.cancel=function(){this.K=!0,oi(this)};function xa(y){y.T=Date.now()+y.H,Fc(y,y.H)}function Fc(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=ct(d(y.aa,y),R)}function _a(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Ki.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(rn(this.i,this.B),this.M!=2&&(lt(),qe(17)),oi(this),this.m=2,xi(this)):Fc(this,this.T-y)};function xi(y){y.j.I==0||y.K||cg(y.j,y)}function oi(y){_a(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,Vn(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function wa(y,R){try{var O=y.j;if(O.I!=0&&(O.g==y||Sa(O.h,y))){if(!y.L&&Sa(O.h,y)&&O.I==3){try{var q=O.Ba.g.parse(R)}catch{q=null}if(Array.isArray(q)&&q.length==3){var se=q;if(se[0]==0){e:if(!O.v){if(O.g)if(O.g.F+3e3<y.F)Wc(O),so(O);else break e;Cl(O),qe(18)}}else O.xa=se[1],0<O.xa-O.K&&se[2]<37500&&O.F&&O.A==0&&!O.C&&(O.C=ct(d(O.Va,O),6e3));Ea(O.h)<=1&&O.ta&&(O.ta=void 0)}else Da(O,11)}else if((y.L||O.g==y)&&Wc(O),!P(R))for(se=O.Ba.g.parse(R),R=0;R<se.length;R++){let zt=se[R];const dn=zt[0];if(!(dn<=O.K))if(O.K=dn,zt=zt[1],O.I==2)if(zt[0]=="c"){O.M=zt[1],O.ba=zt[2];const Ei=zt[3];Ei!=null&&(O.ka=Ei,O.j.info("VER="+O.ka));const ka=zt[4];ka!=null&&(O.za=ka,O.j.info("SVER="+O.za));const Ji=zt[5];Ji!=null&&typeof Ji=="number"&&Ji>0&&(q=1.5*Ji,O.O=q,O.j.info("backChannelRequestTimeoutMs_="+q)),q=O;const ea=y.g;if(ea){const Il=ea.g?ea.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Il){var he=q.h;he.g||Il.indexOf("spdy")==-1&&Il.indexOf("quic")==-1&&Il.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Wd(he,he.h),he.h=null))}if(q.G){const Qc=ea.g?ea.g.getResponseHeader("X-HTTP-Session-Id"):null;Qc&&(q.wa=Qc,Ft(q.J,q.G,Qc))}}O.I=3,O.l&&O.l.ra(),O.aa&&(O.T=Date.now()-y.F,O.j.info("Handshake RTT: "+O.T+"ms")),q=O;var Re=y;if(q.na=fg(q,q.L?q.ba:null,q.W),Re.L){Qd(q.h,Re);var mt=Re,Rn=q.O;Rn&&(mt.H=Rn),mt.D&&(_a(mt),xa(mt)),q.g=Re}else og(q);O.i.length>0&&Ra(O)}else zt[0]!="stop"&&zt[0]!="close"||Da(O,7);else O.I==3&&(zt[0]=="stop"||zt[0]=="close"?zt[0]=="stop"?Da(O,7):of(O):zt[0]!="noop"&&O.l&&O.l.qa(zt),O.A=0)}}lt(4)}catch{}}var zn=class{constructor(y,R){this.g=y,this.map=R}};function Kd(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xd(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Ea(y){return y.h?1:y.g?y.g.size:0}function Sa(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function Wd(y,R){y.g?y.g.add(R):y.h=R}function Qd(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}Kd.prototype.cancel=function(){if(this.i=Zd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Zd(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const O of y.g.values())R=R.concat(O.G);return R}return b(y.i)}var tg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gc(y,R){if(y){y=y.split("&");for(let O=0;O<y.length;O++){const q=y[O].indexOf("=");let se,he=null;q>=0?(se=y[O].substring(0,q),he=y[O].substring(q+1)):se=y[O],R(se,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function li(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof li?(this.l=y.l,or(this,y.j),this.o=y.o,this.g=y.g,Js(this,y.u),this.h=y.h,Jd(this,ag(y.i)),this.m=y.m):y&&(R=String(y).match(tg))?(this.l=!1,or(this,R[1]||"",!0),this.o=Ta(R[2]||""),this.g=Ta(R[3]||"",!0),Js(this,R[4]),this.h=Ta(R[5]||"",!0),Jd(this,R[6]||"",!0),this.m=Ta(R[7]||"")):(this.l=!1,this.i=new to(null,this.l))}li.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(_l(R,qc,!0),":");var O=this.g;return(O||R=="file")&&(y.push("//"),(R=this.o)&&y.push(_l(R,qc,!0),"@"),y.push(ss(O).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.u,O!=null&&y.push(":",String(O))),(O=this.h)&&(this.g&&O.charAt(0)!="/"&&y.push("/"),y.push(_l(O,O.charAt(0)=="/"?ef:ng,!0))),(O=this.i.toString())&&y.push("?",O),(O=this.m)&&y.push("#",_l(O,rg)),y.join("")},li.prototype.resolve=function(y){const R=Ln(this);let O=!!y.j;O?or(R,y.j):O=!!y.o,O?R.o=y.o:O=!!y.g,O?R.g=y.g:O=y.u!=null;var q=y.h;if(O)Js(R,y.u);else if(O=!!y.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var se=R.h.lastIndexOf("/");se!=-1&&(q=R.h.slice(0,se+1)+q)}if(se=q,se==".."||se==".")q="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){q=se.lastIndexOf("/",0)==0,se=se.split("/");const he=[];for(let Re=0;Re<se.length;){const mt=se[Re++];mt=="."?q&&Re==se.length&&he.push(""):mt==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),q&&Re==se.length&&he.push("")):(he.push(mt),q=!0)}q=he.join("/")}else q=se}return O?R.h=q:O=y.i.toString()!=="",O?Jd(R,ag(y.i)):O=!!y.m,O&&(R.m=y.m),R};function Ln(y){return new li(y)}function or(y,R,O){y.j=O?Ta(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function Js(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function Jd(y,R,O){R instanceof to?(y.i=R,$c(y.i,y.l)):(O||(R=_l(R,eo)),y.i=new to(R,y.l))}function Ft(y,R,O){y.i.set(R,O)}function xl(y){return Ft(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Ta(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function _l(y,R,O){return typeof y=="string"?(y=encodeURI(y).replace(R,Gr),O&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Gr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var qc=/[#\/\?@]/g,ng=/[#\?:]/g,ef=/[#\?]/g,eo=/[#\?@]/g,rg=/#/g;function to(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function qr(y){y.g||(y.g=new Map,y.h=0,y.i&&Gc(y.i,function(R,O){y.add(decodeURIComponent(R.replace(/\+/g," ")),O)}))}n=to.prototype,n.add=function(y,R){qr(this),this.i=null,y=no(this,y);let O=this.g.get(y);return O||this.g.set(y,O=[]),O.push(R),this.h+=1,this};function ig(y,R){qr(y),R=no(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function tf(y,R){return qr(y),R=no(y,R),y.g.has(R)}n.forEach=function(y,R){qr(this),this.g.forEach(function(O,q){O.forEach(function(se){y.call(R,se,q,this)},this)},this)};function nf(y,R){qr(y);let O=[];if(typeof R=="string")tf(y,R)&&(O=O.concat(y.g.get(no(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)O=O.concat(y[R]);return O}n.set=function(y,R){return qr(this),this.i=null,y=no(this,y),tf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},n.get=function(y,R){return y?(y=nf(this,y),y.length>0?String(y[0]):R):R};function Hc(y,R,O){ig(y,R),O.length>0&&(y.i=null,y.g.set(no(y,R),b(O)),y.h+=O.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let q=0;q<R.length;q++){var O=R[q];const se=ss(O);O=nf(this,O);for(let he=0;he<O.length;he++){let Re=se;O[he]!==""&&(Re+="="+ss(O[he])),y.push(Re)}}return this.i=y.join("&")};function ag(y){const R=new to;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function no(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function $c(y,R){R&&!y.j&&(qr(y),y.i=null,y.g.forEach(function(O,q){const se=q.toLowerCase();q!=se&&(ig(this,q),Hc(this,se,O))},y)),y.j=R}function Wi(y,R){const O=new Nt;if(o.Image){const q=new Image;q.onload=h(_i,O,"TestLoadImage: loaded",!0,R,q),q.onerror=h(_i,O,"TestLoadImage: error",!1,R,q),q.onabort=h(_i,O,"TestLoadImage: abort",!1,R,q),q.ontimeout=h(_i,O,"TestLoadImage: timeout",!1,R,q),o.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=y}else R(!1)}function rf(y,R){const O=new Nt,q=new AbortController,se=setTimeout(()=>{q.abort(),_i(O,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:q.signal}).then(he=>{clearTimeout(se),he.ok?_i(O,"TestPingServer: ok",!0,R):_i(O,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(se),_i(O,"TestPingServer: error",!1,R)})}function _i(y,R,O,q,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),q(O)}catch{}}function ro(){this.g=new Zs}function Aa(y){this.i=y.Sb||null,this.h=y.ab||!1}p(Aa,Yi),Aa.prototype.g=function(){return new wl(this.i,this.h)};function wl(y,R){De.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(wl,De),n=wl.prototype,n.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,Qi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||o).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,io(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Qi(this)),this.g&&(this.readyState=3,Qi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Yc(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Yc(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?io(this):Qi(this),this.readyState==3&&Yc(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,io(this))},n.Na=function(y){this.g&&(this.response=y,io(this))},n.ga=function(){this.g&&io(this)};function io(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Qi(y)}n.setRequestHeader=function(y,R){this.A.append(y,R)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var O=R.next();!O.done;)O=O.value,y.push(O[0]+": "+O[1]),O=R.next();return y.join(`\r
`)};function Qi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function wi(y){let R="";return re(y,function(O,q){R+=q,R+=":",R+=O,R+=`\r
`}),R}function El(y,R,O){e:{for(q in O){var q=!1;break e}q=!0}q||(O=wi(O),typeof y=="string"?O!=null&&ss(O):Ft(y,R,O))}function Xt(y){De.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Xt,De);var Ca=/^https?$/i,af=["POST","PUT"];n=Xt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,R,O,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():si.g(),this.g.onreadystatechange=m(d(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(he){Sl(this,he);return}if(y=O||"",O=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var se in q)O.set(se,q[se]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const he of q.keys())O.set(he,q.get(he));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(O.keys()).find(he=>he.toLowerCase()=="content-type"),se=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(af,R,void 0)>=0)||q||se||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Re]of O)this.g.setRequestHeader(he,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(he){Sl(this,he)}};function Sl(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,sf(y),os(y)}function sf(y){y.A||(y.A=!0,je(y,"complete"),je(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,je(this,"complete"),je(this,"abort"),os(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),os(this,!0)),Xt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Tl(this):this.Xa())},n.Xa=function(){Tl(this)};function Tl(y){if(y.h&&typeof a<"u"){if(y.v&&Zi(y)==4)setTimeout(y.Ca.bind(y),0);else if(je(y,"readystatechange"),Zi(y)==4){y.h=!1;try{const he=y.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var O;if(!(O=R)){var q;if(q=he===0){let Re=String(y.D).match(tg)[1]||null;!Re&&o.self&&o.self.location&&(Re=o.self.location.protocol.slice(0,-1)),q=!Ca.test(Re?Re.toLowerCase():"")}O=q}if(O)je(y,"complete"),je(y,"success");else{y.o=6;try{var se=Zi(y)>2?y.g.statusText:""}catch{se=""}y.l=se+" ["+y.ca()+"]",sf(y)}}finally{os(y)}}}}function os(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const O=y.g;y.g=null,R||je(y,"ready");try{O.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Zi(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Zi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),Qs(R)}};function hr(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function ls(y){const R={};y=(y.g&&Zi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<y.length;q++){if(P(y[q]))continue;var O=Zp(y[q]);const se=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const he=R[se]||[];R[se]=he,he.push(O)}ue(R,function(q){return q.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ia(y,R,O){return O&&O.internalChannelParams&&O.internalChannelParams[y]||R}function ao(y){this.za=0,this.i=[],this.j=new Nt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ia("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ia("baseRetryDelayMs",5e3,y),this.Za=Ia("retryDelaySeedMs",1e4,y),this.Ta=Ia("forwardChannelMaxRetries",2,y),this.va=Ia("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Kd(y&&y.concurrentRequestLimit),this.Ba=new ro,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ao.prototype,n.ka=8,n.I=1,n.connect=function(y,R,O,q){qe(0),this.W=y,this.H=R||{},O&&q!==void 0&&(this.H.OSID=O,this.H.OAID=q),this.F=this.X,this.J=fg(this,null,this.W),Ra(this)};function of(y){if(Kc(y),y.I==3){var R=y.V++,O=Ln(y.J);if(Ft(O,"SID",y.M),Ft(O,"RID",R),Ft(O,"TYPE","terminate"),Al(y,O),R=new Ki(y,y.j,R),R.M=2,R.A=xl(Ln(O)),O=!1,o.navigator&&o.navigator.sendBeacon)try{O=o.navigator.sendBeacon(R.A.toString(),"")}catch{}!O&&o.Image&&(new Image().src=R.A,O=!0),O||(R.g=hg(R.j,null),R.g.ea(R.A)),R.F=Date.now(),xa(R)}dg(y)}function so(y){y.g&&(cf(y),y.g.cancel(),y.g=null)}function Kc(y){so(y),y.v&&(o.clearTimeout(y.v),y.v=null),Wc(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function Ra(y){if(!Xd(y.h)&&!y.m){y.m=!0;var R=y.Ea;j||I(),z||(j(),z=!0),A.add(R,y),y.D=0}}function Xc(y,R){return Ea(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=ct(d(y.Ea,y,R),ug(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const se=new Ki(this,this.j,y);let he=this.o;if(this.U&&(he?(he=G(he),ne(he,this.U)):he=this.U),this.u!==null||this.R||(se.J=he,he=null),this.S)e:{for(var R=0,O=0;O<this.i.length;O++){t:{var q=this.i[O];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(R+=q,R>4096){R=O;break e}if(R===4096||O===this.i.length-1){R=O+1;break e}}R=1e3}else R=1e3;R=sg(this,se,R),O=Ln(this.J),Ft(O,"RID",y),Ft(O,"CVER",22),this.G&&Ft(O,"X-HTTP-Session-Id",this.G),Al(this,O),he&&(this.R?R="headers="+ss(wi(he))+"&"+R:this.u&&El(O,this.u,he)),Wd(this.h,se),this.Ra&&Ft(O,"TYPE","init"),this.S?(Ft(O,"$req",R),Ft(O,"SID","null"),se.U=!0,ba(se,O,null)):ba(se,O,R),this.I=2}}else this.I==3&&(y?lf(this,y):this.i.length==0||Xd(this.h)||lf(this))};function lf(y,R){var O;R?O=R.l:O=y.V++;const q=Ln(y.J);Ft(q,"SID",y.M),Ft(q,"RID",O),Ft(q,"AID",y.K),Al(y,q),y.u&&y.o&&El(q,y.u,y.o),O=new Ki(y,y.j,O,y.D+1),y.u===null&&(O.J=y.o),R&&(y.i=R.G.concat(y.i)),R=sg(y,O,1e3),O.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Wd(y.h,O),ba(O,q,R)}function Al(y,R){y.H&&re(y.H,function(O,q){Ft(R,q,O)}),y.l&&re({},function(O,q){Ft(R,q,O)})}function sg(y,R,O){O=Math.min(y.i.length,O);const q=y.l?d(y.l.Ka,y.l,y):null;e:{var se=y.i;let mt=-1;for(;;){const Rn=["count="+O];mt==-1?O>0?(mt=se[0].g,Rn.push("ofs="+mt)):mt=0:Rn.push("ofs="+mt);let zt=!0;for(let dn=0;dn<O;dn++){var he=se[dn].g;const Ei=se[dn].map;if(he-=mt,he<0)mt=Math.max(0,se[dn].g-100),zt=!1;else try{he="req"+he+"_"||"";try{var Re=Ei instanceof Map?Ei:Object.entries(Ei);for(const[ka,Ji]of Re){let ea=Ji;c(Ji)&&(ea=ii(Ji)),Rn.push(he+ka+"="+encodeURIComponent(ea))}}catch(ka){throw Rn.push(he+"type="+encodeURIComponent("_badmap")),ka}}catch{q&&q(Ei)}}if(zt){Re=Rn.join("&");break e}}Re=void 0}return y=y.i.splice(0,O),R.G=y,Re}function og(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;j||I(),z||(j(),z=!0),A.add(R,y),y.A=0}}function Cl(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=ct(d(y.Da,y),ug(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,lg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=ct(d(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qe(10),so(this),lg(this))};function cf(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function lg(y){y.g=new Ki(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=Ln(y.na);Ft(R,"RID","rpc"),Ft(R,"SID",y.M),Ft(R,"AID",y.K),Ft(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&Ft(R,"TO",y.ia),Ft(R,"TYPE","xmlhttp"),Al(y,R),y.u&&y.o&&El(R,y.u,y.o),y.O&&(y.g.H=y.O);var O=y.g;y=y.ba,O.M=1,O.A=xl(Ln(R)),O.u=null,O.R=!0,Uc(O,y)}n.Va=function(){this.C!=null&&(this.C=null,so(this),Cl(this),qe(19))};function Wc(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function cg(y,R){var O=null;if(y.g==R){Wc(y),cf(y),y.g=null;var q=2}else if(Sa(y.h,R))O=R.G,Qd(y.h,R),q=1;else return;if(y.I!=0){if(R.o)if(q==1){O=R.u?R.u.length:0,R=Date.now()-R.F;var se=y.D;q=pt(),je(q,new kt(q,O)),Ra(y)}else og(y);else if(se=R.m,se==3||se==0&&R.X>0||!(q==1&&Xc(y,R)||q==2&&Cl(y)))switch(O&&O.length>0&&(R=y.h,R.i=R.i.concat(O)),se){case 1:Da(y,5);break;case 4:Da(y,10);break;case 3:Da(y,6);break;default:Da(y,2)}}}function ug(y,R){let O=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(O*=2),O*R}function Da(y,R){if(y.j.info("Error code "+R),R==2){var O=d(y.bb,y),q=y.Ua;const se=!q;q=new li(q||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||or(q,"https"),xl(q),se?Wi(q.toString(),O):rf(q.toString(),O)}else qe(2);y.I=0,y.l&&y.l.pa(R),dg(y),Kc(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),qe(2)):(this.j.info("Failed to ping google.com"),qe(1))};function dg(y){if(y.I=0,y.ja=[],y.l){const R=Zd(y.h);(R.length!=0||y.i.length!=0)&&(_(y.ja,R),_(y.ja,y.i),y.h.i.length=0,b(y.i),y.i.length=0),y.l.oa()}}function fg(y,R,O){var q=O instanceof li?Ln(O):new li(O);if(q.g!="")R&&(q.g=R+"."+q.g),Js(q,q.u);else{var se=o.location;q=se.protocol,R=R?R+"."+se.hostname:se.hostname,se=+se.port;const he=new li(null);q&&or(he,q),R&&(he.g=R),se&&Js(he,se),O&&(he.h=O),q=he}return O=y.G,R=y.wa,O&&R&&Ft(q,O,R),Ft(q,"VER",y.ka),Al(y,q),q}function hg(y,R,O){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new Xt(new Aa({ab:O})):new Xt(y.ma),R.Fa(y.L),R}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function pg(){}n=pg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function oo(){}oo.prototype.g=function(y,R){return new Pr(y,R)};function Pr(y,R){De.call(this),this.g=new ao(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!P(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!P(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new cs(this)}p(Pr,De),Pr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Pr.prototype.close=function(){of(this.g)},Pr.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var O={};O.__data__=y,y=O}else this.v&&(O={},O.__data__=ii(y),y=O);R.i.push(new zn(R.Ya++,y)),R.I==3&&Ra(R)},Pr.prototype.N=function(){this.g.l=null,delete this.j,of(this.g),delete this.g,Pr.Z.N.call(this)};function gg(y){_n.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const O in R){y=O;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(gg,_n);function mg(){ze.call(this),this.status=1}p(mg,ze);function cs(y){this.g=y}p(cs,pg),cs.prototype.ra=function(){je(this.g,"a")},cs.prototype.qa=function(y){je(this.g,new gg(y))},cs.prototype.pa=function(y){je(this.g,new mg)},cs.prototype.oa=function(){je(this.g,"b")},oo.prototype.createWebChannel=oo.prototype.g,Pr.prototype.send=Pr.prototype.o,Pr.prototype.open=Pr.prototype.m,Pr.prototype.close=Pr.prototype.close,wM=function(){return new oo},_M=function(){return pt()},xM=Oe,k1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ai.NO_ERROR=0,ai.TIMEOUT=8,ai.HTTP_ERROR=6,t0=ai,Mr.COMPLETE="complete",bM=Mr,ya.EventType=Nr,Nr.OPEN="a",Nr.CLOSE="b",Nr.ERROR="c",Nr.MESSAGE="d",De.prototype.listen=De.prototype.J,ih=ya,Xt.prototype.listenOnce=Xt.prototype.K,Xt.prototype.getLastError=Xt.prototype.Ha,Xt.prototype.getLastErrorCode=Xt.prototype.ya,Xt.prototype.getStatus=Xt.prototype.ca,Xt.prototype.getResponseJson=Xt.prototype.La,Xt.prototype.getResponseText=Xt.prototype.la,Xt.prototype.send=Xt.prototype.ea,Xt.prototype.setWithCredentials=Xt.prototype.Fa,yM=Xt}).apply(typeof Sm<"u"?Sm:typeof self<"u"?self:typeof window<"u"?window:{});const oI="@firebase/firestore",lI="4.9.2";class xr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xr.UNAUTHENTICATED=new xr(null),xr.GOOGLE_CREDENTIALS=new xr("google-credentials-uid"),xr.FIRST_PARTY=new xr("first-party-uid"),xr.MOCK_USER=new xr("mock-user");let Od="12.3.0";const wc=new lw("@firebase/firestore");function Pu(){return wc.logLevel}function Te(n,...e){if(wc.logLevel<=Rt.DEBUG){const t=e.map(bw);wc.debug(`Firestore (${Od}): ${n}`,...t)}}function zr(n,...e){if(wc.logLevel<=Rt.ERROR){const t=e.map(bw);wc.error(`Firestore (${Od}): ${n}`,...t)}}function Ec(n,...e){if(wc.logLevel<=Rt.WARN){const t=e.map(bw);wc.warn(`Firestore (${Od}): ${n}`,...t)}}function bw(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Be(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,EM(n,r,t)}function EM(n,e,t){let r=`FIRESTORE (${Od}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw zr(r),new Error(r)}function Ge(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||EM(e,i,r)}function ft(n,e){return n}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends Hs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ka{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class SM{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(xr.UNAUTHENTICATED)))}shutdown(){}}class OF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class VF{constructor(e){this.t=e,this.currentUser=xr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ge(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let a=new Ka;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ka,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=a;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ka)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ge(typeof r.accessToken=="string",31837,{l:r}),new SM(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string",2055,{h:e}),new xr(e)}}class jF{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=xr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zF{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new jF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(xr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class cI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LF{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Vi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ge(this.o===void 0,3512);const r=a=>{a.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new cI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ge(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new cI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function BF(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class xw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=BF(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function ut(n,e){return n<e?-1:n>e?1:0}function N1(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return Cx(i)===Cx(a)?ut(i,a):Cx(i)?1:-1}return ut(n.length,e.length)}const UF=55296,FF=57343;function Cx(n){const e=n.charCodeAt(0);return e>=UF&&e<=FF}function ld(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function TM(n){return n+"\0"}const uI="__name__";class ja{constructor(e,t,r){t===void 0?t=0:t>e.length&&Be(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Be(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ja.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ja?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=ja.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return ut(e.length,t.length)}static compareSegments(e,t){const r=ja.isNumericId(e),i=ja.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?ja.extractNumericId(e).compare(ja.extractNumericId(t)):N1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Jo.fromString(e.substring(4,e.length-2))}}class Bt extends ja{construct(e,t,r){return new Bt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new Bt(t)}static emptyPath(){return new Bt([])}}const GF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yn extends ja{construct(e,t,r){return new yn(e,t,r)}static isValidIdentifier(e){return GF.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===uI}static keyField(){return new yn([uI])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ie(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ie(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(a(),i++)}if(a(),o)throw new Ie(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yn(t)}static emptyPath(){return new yn([])}}class Me{constructor(e){this.path=e}static fromPath(e){return new Me(Bt.fromString(e))}static fromName(e){return new Me(Bt.fromString(e).popFirst(5))}static empty(){return new Me(Bt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Bt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Bt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Me(new Bt(e.slice()))}}function AM(n,e,t){if(!t)throw new Ie(ge.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function qF(n,e,t,r){if(e===!0&&r===!0)throw new Ie(ge.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function dI(n){if(!Me.isDocumentKey(n))throw new Ie(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function fI(n){if(Me.isDocumentKey(n))throw new Ie(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function CM(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Tv(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Be(12329,{type:typeof n})}function Ir(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Tv(n);throw new Ie(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Kn(n,e){const t={typeString:n};return e&&(t.value=e),t}function wp(n,e){if(!CM(n))throw new Ie(ge.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Ie(ge.INVALID_ARGUMENT,t);return!0}const hI=-62135596800,pI=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*pI);return new _t(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<hI)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pI}_compareTo(e){return this.seconds===e.seconds?ut(this.nanoseconds,e.nanoseconds):ut(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wp(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-hI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:Kn("string",_t._jsonSchemaVersion),seconds:Kn("number"),nanoseconds:Kn("number")};class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new _t(0,0))}static max(){return new Xe(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Bh=-1;class M0{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function M1(n){return n.fields.find((e=>e.kind===2))}function Kl(n){return n.fields.filter((e=>e.kind!==2))}M0.UNKNOWN_ID=-1;class n0{constructor(e,t){this.fieldPath=e,this.kind=t}}class Uh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Uh(0,yi.min())}}function HF(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Xe.fromTimestamp(r===1e9?new _t(t+1,0):new _t(t,r));return new yi(i,Me.empty(),e)}function IM(n){return new yi(n.readTime,n.key,Bh)}class yi{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new yi(Xe.min(),Me.empty(),Bh)}static max(){return new yi(Xe.max(),Me.empty(),Bh)}}function _w(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Me.comparator(n.documentKey,e.documentKey),t!==0?t:ut(n.largestBatchId,e.largestBatchId))}const RM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function jc(n){if(n.code!==ge.FAILED_PRECONDITION||n.message!==RM)throw n;Te("LocalStore","Unexpectedly lost primary lease")}class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Be(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,r)=>{t(e)}))}static reject(e){return new ae(((t,r)=>{r(e)}))}static waitFor(e){return new ae(((t,r)=>{let i=0,a=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++a,o&&a===i&&t()}),(u=>r(u)))})),o=!0,a===i&&t()}))}static or(e){let t=ae.resolve(!1);for(const r of e)t=t.next((i=>i?ae.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new ae(((r,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const d=u;t(e[d]).next((h=>{o[d]=h,++c,c===a&&r(o)}),(h=>i(h)))}}))}static doWhile(e,t){return new ae(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}const mi="SimpleDb";class Av{static open(e,t,r,i){try{return new Av(t,e.transaction(i,r))}catch(a){throw new mh(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ka,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new mh(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=ww(r.target.error);this.S.reject(new mh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Te(mi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new YF(t)}}class el{static delete(e){return Te(mi,"Removing database:",e),Zl(bN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!IN())return!1;if(el.F())return!0;const e=ir(),t=el.M(e),r=0<t&&t<10,i=kM(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,el.M(ir())===12.2&&zr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Te(mi,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const o=a.target.result;t(o)},i.onblocked=()=>{r(new mh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const o=a.target.error;o.name==="VersionError"?r(new Ie(ge.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Ie(ge.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new mh(e,o))},i.onupgradeneeded=a=>{Te(mi,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const o=a.target.result;this.N.k(o,i.transaction,a.oldVersion,this.version).next((()=>{Te(mi,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const c=Av.open(this.db,e,a?"readonly":"readwrite",r),u=i(c).next((d=>(c.C(),d))).catch((d=>(c.abort(d),ae.reject(d)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){const u=c,d=u.name!=="FirebaseError"&&o<3;if(Te(mi,"Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function kM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class $F{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Zl(this.U.delete())}}class mh extends Ie{constructor(e,t){super(ge.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function gl(n){return n.name==="IndexedDbTransactionError"}class YF{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Te(mi,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Te(mi,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Zl(r)}add(e){return Te(mi,"ADD",this.store.name,e,e),Zl(this.store.add(e))}get(e){return Zl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Te(mi,"GET",this.store.name,e,t),t)))}delete(e){return Te(mi,"DELETE",this.store.name,e),Zl(this.store.delete(e))}count(){return Te(mi,"COUNT",this.store.name),Zl(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new ae(((o,c)=>{a.onerror=u=>{c(u.target.error)},a.onsuccess=u=>{o(u.target.result)}}))}{const a=this.cursor(r),o=[];return this.H(a,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new ae(((i,a)=>{r.onerror=o=>{a(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){Te(mi,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,((a,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}te(e){const t=this.cursor({});return new ae(((r,i)=>{t.onerror=a=>{const o=ww(a.target.error);i(o)},t.onsuccess=a=>{const o=a.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){const r=[];return new ae(((i,a)=>{e.onerror=o=>{a(o.target.error)},e.onsuccess=o=>{const c=o.target.result;if(!c)return void i();const u=new $F(c),d=t(c.primaryKey,c.value,u);if(d instanceof ae){const h=d.catch((p=>(u.done(),ae.reject(p))));r.push(h)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>ae.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Zl(n){return new ae(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=ww(r.target.error);t(i)}}))}let gI=!1;function ww(n){const e=el.M(ir());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gI||(gI=!0,setTimeout((()=>{throw r}),0)),r}}return n}const vh="IndexBackfiller";class KF{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Te(vh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Te(vh,`Documents written: ${t}`)}catch(t){gl(t)?Te(vh,"Ignoring IndexedDB error during index backfill: ",t):await jc(t)}await this.re(6e4)}))}}class XF{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return ae.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return Te(vh,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const o=a.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,a))).next((c=>(Te(vh,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const o=IM(a);_w(o,r)>0&&(r=o)})),new yi(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class zi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zi.ce=-1;const dc=-1;function Cv(n){return n==null}function Fh(n){return n===0&&1/n==-1/0}function WF(n){return typeof n=="number"&&Number.isInteger(n)&&!Fh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const P0="";function Rr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=mI(e)),e=QF(n.get(t),e);return mI(e)}function QF(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case P0:t+="";break;default:t+=a}}return t}function mI(n){return n+P0+""}function Fa(n){const e=n.length;if(Ge(e>=2,64408,{path:n}),e===2)return Ge(n.charAt(0)===P0&&n.charAt(1)==="",56145,{path:n}),Bt.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const o=n.indexOf(P0,a);switch((o<0||o>t)&&Be(50515,{path:n}),n.charAt(o+1)){case"":const c=n.substring(a,o);let u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(a,o),i+="\0";break;case"":i+=n.substring(a,o+1);break;default:Be(61167,{path:n})}a=o+2}return new Bt(r)}const Xl="remoteDocuments",Ep="owner",Cu="owner",Gh="mutationQueues",ZF="userId",aa="mutations",vI="batchId",sc="userMutationsIndex",yI=["userId","batchId"];function r0(n,e){return[n,Rr(e)]}function NM(n,e,t){return[n,Rr(e),t]}const JF={},cd="documentMutations",O0="remoteDocumentsV14",e7=["prefixPath","collectionGroup","readTime","documentId"],i0="documentKeyIndex",t7=["prefixPath","collectionGroup","documentId"],MM="collectionGroupIndex",n7=["collectionGroup","readTime","prefixPath","documentId"],qh="remoteDocumentGlobal",P1="remoteDocumentGlobalKey",ud="targets",PM="queryTargetsIndex",r7=["canonicalId","targetId"],dd="targetDocuments",i7=["targetId","path"],Ew="documentTargetsIndex",a7=["path","targetId"],V0="targetGlobalKey",fc="targetGlobal",Hh="collectionParents",s7=["collectionId","parent"],fd="clientMetadata",o7="clientId",Iv="bundles",l7="bundleId",Rv="namedQueries",c7="name",Sw="indexConfiguration",u7="indexId",O1="collectionGroupIndex",d7="collectionGroup",yh="indexState",f7=["indexId","uid"],OM="sequenceNumberIndex",h7=["uid","sequenceNumber"],bh="indexEntries",p7=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],VM="documentKeyIndex",g7=["indexId","uid","orderedDocumentKey"],Dv="documentOverlays",m7=["userId","collectionPath","documentId"],V1="collectionPathOverlayIndex",v7=["userId","collectionPath","largestBatchId"],jM="collectionGroupOverlayIndex",y7=["userId","collectionGroup","largestBatchId"],Tw="globals",b7="name",zM=[Gh,aa,cd,Xl,ud,Ep,fc,dd,fd,qh,Hh,Iv,Rv],x7=[...zM,Dv],LM=[Gh,aa,cd,O0,ud,Ep,fc,dd,fd,qh,Hh,Iv,Rv,Dv],BM=LM,Aw=[...BM,Sw,yh,bh],_7=Aw,UM=[...Aw,Tw],w7=UM;class j1 extends DM{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ar(n,e){const t=ft(n);return el.O(t.le,e)}function bI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ml(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function FM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class mn{constructor(e,t){this.comparator=e,this.root=t||_r.EMPTY}insert(e,t){return new mn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_r.BLACK,null,null))}remove(e){return new mn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_r.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tm(this.root,e,this.comparator,!0)}}class Tm{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _r{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??_r.RED,this.left=i??_r.EMPTY,this.right=a??_r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new _r(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return _r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return _r.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Be(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Be(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Be(27949);return e+(this.isRed()?0:1)}}_r.EMPTY=null,_r.RED=!0,_r.BLACK=!1;_r.EMPTY=new class{constructor(){this.size=0}get key(){throw Be(57766)}get value(){throw Be(16141)}get color(){throw Be(16727)}get left(){throw Be(29726)}get right(){throw Be(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new _r(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class $t{constructor(e){this.comparator=e,this.data=new mn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xI(this.data.getIterator())}getIteratorFrom(e){return new xI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof $t)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new $t(this.comparator);return t.data=e,t}}class xI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Iu(n){return n.hasNext()?n.getNext():void 0}class Qr{constructor(e){this.fields=e,e.sort(yn.comparator)}static empty(){return new Qr([])}unionWith(e){let t=new $t(yn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Qr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ld(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class GM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new GM("Invalid base64 string: "+a):a}})(e);return new Xn(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a})(e);return new Xn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ut(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const E7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function js(n){if(Ge(!!n,39018),typeof n=="string"){let e=0;const t=E7.exec(n);if(Ge(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pn(n.seconds),nanos:pn(n.nanos)}}function pn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zs(n){return typeof n=="string"?Xn.fromBase64String(n):Xn.fromUint8Array(n)}const qM="server_timestamp",HM="__type__",$M="__previous_value__",YM="__local_write_time__";function Cw(n){return(n?.mapValue?.fields||{})[HM]?.stringValue===qM}function kv(n){const e=n.mapValue.fields[$M];return Cw(e)?kv(e):e}function $h(n){const e=js(n.mapValue.fields[YM].timestampValue);return new _t(e.seconds,e.nanos)}class S7{constructor(e,t,r,i,a,o,c,u,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const j0="(default)";class Sc{constructor(e,t){this.projectId=e,this.database=t||j0}static empty(){return new Sc("","")}get isDefaultDatabase(){return this.database===j0}isEqual(e){return e instanceof Sc&&e.projectId===this.projectId&&e.database===this.database}}const Iw="__type__",KM="__max__",$o={mapValue:{fields:{__type__:{stringValue:KM}}}},Rw="__vector__",hd="value",a0={nullValue:"NULL_VALUE"};function il(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Cw(n)?4:XM(n)?9007199254740991:Nv(n)?10:11:Be(28295,{value:n})}function es(n,e){if(n===e)return!0;const t=il(n);if(t!==il(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return $h(n).isEqual($h(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=js(i.timestampValue),c=js(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return zs(i.bytesValue).isEqual(zs(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return pn(i.geoPointValue.latitude)===pn(a.geoPointValue.latitude)&&pn(i.geoPointValue.longitude)===pn(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return pn(i.integerValue)===pn(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=pn(i.doubleValue),c=pn(a.doubleValue);return o===c?Fh(o)===Fh(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return ld(n.arrayValue.values||[],e.arrayValue.values||[],es);case 10:case 11:return(function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(bI(o)!==bI(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!es(o[u],c[u])))return!1;return!0})(n,e);default:return Be(52216,{left:n})}}function Yh(n,e){return(n.values||[]).find((t=>es(t,e)))!==void 0}function al(n,e){if(n===e)return 0;const t=il(n),r=il(e);if(t!==r)return ut(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ut(n.booleanValue,e.booleanValue);case 2:return(function(a,o){const c=pn(a.integerValue||a.doubleValue),u=pn(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return _I(n.timestampValue,e.timestampValue);case 4:return _I($h(n),$h(e));case 5:return N1(n.stringValue,e.stringValue);case 6:return(function(a,o){const c=zs(a),u=zs(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(a,o){const c=a.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=ut(c[d],u[d]);if(h!==0)return h}return ut(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,o){const c=ut(pn(a.latitude),pn(o.latitude));return c!==0?c:ut(pn(a.longitude),pn(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return wI(n.arrayValue,e.arrayValue);case 10:return(function(a,o){const c=a.fields||{},u=o.fields||{},d=c[hd]?.arrayValue,h=u[hd]?.arrayValue,p=ut(d?.values?.length||0,h?.values?.length||0);return p!==0?p:wI(d,h)})(n.mapValue,e.mapValue);case 11:return(function(a,o){if(a===$o.mapValue&&o===$o.mapValue)return 0;if(a===$o.mapValue)return 1;if(o===$o.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=N1(u[p],h[p]);if(m!==0)return m;const b=al(c[u[p]],d[h[p]]);if(b!==0)return b}return ut(u.length,h.length)})(n.mapValue,e.mapValue);default:throw Be(23264,{he:t})}}function _I(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ut(n,e);const t=js(n),r=js(e),i=ut(t.seconds,r.seconds);return i!==0?i:ut(t.nanos,r.nanos)}function wI(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=al(t[i],r[i]);if(a)return a}return ut(t.length,r.length)}function pd(n){return z1(n)}function z1(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=js(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return zs(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Me.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=z1(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const o of r)a?a=!1:i+=",",i+=`${o}:${z1(t.fields[o])}`;return i+"}"})(n.mapValue):Be(61005,{value:n})}function s0(n){switch(il(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=kv(n);return e?16+s0(e):16;case 5:return 2*n.stringValue.length;case 6:return zs(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+s0(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ml(r.fields,((a,o)=>{i+=a.length+s0(o)})),i})(n.mapValue);default:throw Be(13486,{value:n})}}function Kh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function L1(n){return!!n&&"integerValue"in n}function Xh(n){return!!n&&"arrayValue"in n}function EI(n){return!!n&&"nullValue"in n}function SI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function o0(n){return!!n&&"mapValue"in n}function Nv(n){return(n?.mapValue?.fields||{})[Iw]?.stringValue===Rw}function xh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ml(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=xh(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=xh(n.arrayValue.values[t]);return e}return{...n}}function XM(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===KM}const WM={mapValue:{fields:{[Iw]:{stringValue:Rw},[hd]:{arrayValue:{}}}}};function T7(n){return"nullValue"in n?a0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Kh(Sc.empty(),Me.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Nv(n)?WM:{mapValue:{}}:Be(35942,{value:n})}function A7(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Kh(Sc.empty(),Me.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?WM:"mapValue"in n?Nv(n)?{mapValue:{}}:$o:Be(61959,{value:n})}function TI(n,e){const t=al(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function AI(n,e){const t=al(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Ar{constructor(e){this.value=e}static empty(){return new Ar({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!o0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xh(t)}setAll(e){let t=yn.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=xh(o):i.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());o0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return es(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];o0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ml(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Ar(xh(this.value))}}function QM(n){const e=[];return ml(n.fields,((t,r)=>{const i=new yn([t]);if(o0(r)){const a=QM(r.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)})),new Qr(e)}class Cn{constructor(e,t,r,i,a,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Cn(e,0,Xe.min(),Xe.min(),Xe.min(),Ar.empty(),0)}static newFoundDocument(e,t,r,i){return new Cn(e,1,t,Xe.min(),r,i,0)}static newNoDocument(e,t){return new Cn(e,2,t,Xe.min(),Xe.min(),Ar.empty(),0)}static newUnknownDocument(e,t){return new Cn(e,3,t,Xe.min(),Xe.min(),Ar.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ar.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ar.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class gd{constructor(e,t){this.position=e,this.inclusive=t}}function CI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],o=n.position[i];if(a.field.isKeyField()?r=Me.comparator(Me.fromName(o.referenceValue),t.key):r=al(o,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function II(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!es(n.position[t],e.position[t]))return!1;return!0}class Wh{constructor(e,t="asc"){this.field=e,this.dir=t}}function C7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ZM{}class Dt extends ZM{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new I7(e,t,r):t==="array-contains"?new k7(e,r):t==="in"?new iP(e,r):t==="not-in"?new N7(e,r):t==="array-contains-any"?new M7(e,r):new Dt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new R7(e,r):new D7(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(al(t,this.value)):t!==null&&il(this.value)===il(t)&&this.matchesComparison(al(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Be(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ht extends ZM{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ht(e,t)}matches(e){return md(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function md(n){return n.op==="and"}function B1(n){return n.op==="or"}function Dw(n){return JM(n)&&md(n)}function JM(n){for(const e of n.filters)if(e instanceof Ht)return!1;return!0}function U1(n){if(n instanceof Dt)return n.field.canonicalString()+n.op.toString()+pd(n.value);if(Dw(n))return n.filters.map((e=>U1(e))).join(",");{const e=n.filters.map((t=>U1(t))).join(",");return`${n.op}(${e})`}}function eP(n,e){return n instanceof Dt?(function(r,i){return i instanceof Dt&&r.op===i.op&&r.field.isEqual(i.field)&&es(r.value,i.value)})(n,e):n instanceof Ht?(function(r,i){return i instanceof Ht&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,o,c)=>a&&eP(o,i.filters[c])),!0):!1})(n,e):void Be(19439)}function tP(n,e){const t=n.filters.concat(e);return Ht.create(t,n.op)}function nP(n){return n instanceof Dt?(function(t){return`${t.field.canonicalString()} ${t.op} ${pd(t.value)}`})(n):n instanceof Ht?(function(t){return t.op.toString()+" {"+t.getFilters().map(nP).join(" ,")+"}"})(n):"Filter"}class I7 extends Dt{constructor(e,t,r){super(e,t,r),this.key=Me.fromName(r.referenceValue)}matches(e){const t=Me.comparator(e.key,this.key);return this.matchesComparison(t)}}class R7 extends Dt{constructor(e,t){super(e,"in",t),this.keys=rP("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class D7 extends Dt{constructor(e,t){super(e,"not-in",t),this.keys=rP("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function rP(n,e){return(e.arrayValue?.values||[]).map((t=>Me.fromName(t.referenceValue)))}class k7 extends Dt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Xh(t)&&Yh(t.arrayValue,this.value)}}class iP extends Dt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yh(this.value.arrayValue,t)}}class N7 extends Dt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yh(this.value.arrayValue,t)}}class M7 extends Dt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Xh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Yh(this.value.arrayValue,r)))}}class P7{constructor(e,t=null,r=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Te=null}}function F1(n,e=null,t=[],r=[],i=null,a=null,o=null){return new P7(n,e,t,r,i,a,o)}function Tc(n){const e=ft(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>U1(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Cv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>pd(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>pd(r))).join(",")),e.Te=t}return e.Te}function Sp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!C7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!eP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!II(n.startAt,e.startAt)&&II(n.endAt,e.endAt)}function z0(n){return Me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function L0(n,e){return n.filters.filter((t=>t instanceof Dt&&t.field.isEqual(e)))}function RI(n,e,t){let r=a0,i=!0;for(const a of L0(n,e)){let o=a0,c=!0;switch(a.op){case"<":case"<=":o=T7(a.value);break;case"==":case"in":case">=":o=a.value;break;case">":o=a.value,c=!1;break;case"!=":case"not-in":o=a0}TI({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];TI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function DI(n,e,t){let r=$o,i=!0;for(const a of L0(n,e)){let o=$o,c=!0;switch(a.op){case">=":case">":o=A7(a.value),c=!1;break;case"==":case"in":case"<=":o=a.value;break;case"<":o=a.value,c=!1;break;case"!=":case"not-in":o=$o}AI({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const o=t.position[a];AI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}class Vd{constructor(e,t=null,r=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function O7(n,e,t,r,i,a,o,c){return new Vd(n,e,t,r,i,a,o,c)}function Tp(n){return new Vd(n)}function kI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function aP(n){return n.collectionGroup!==null}function _h(n){const e=ft(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new $t(yn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((d=>{d.isInequality()&&(c=c.add(d.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Wh(a,r))})),t.has(yn.keyField().canonicalString())||e.Ie.push(new Wh(yn.keyField(),r))}return e.Ie}function Bi(n){const e=ft(n);return e.Ee||(e.Ee=V7(e,_h(n))),e.Ee}function V7(n,e){if(n.limitType==="F")return F1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Wh(i.field,a)}));const t=n.endAt?new gd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new gd(n.startAt.position,n.startAt.inclusive):null;return F1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function G1(n,e){const t=n.filters.concat([e]);return new Vd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function B0(n,e,t){return new Vd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Mv(n,e){return Sp(Bi(n),Bi(e))&&n.limitType===e.limitType}function sP(n){return`${Tc(Bi(n))}|lt:${n.limitType}`}function Ou(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>nP(i))).join(", ")}]`),Cv(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>pd(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>pd(i))).join(",")),`Target(${r})`})(Bi(n))}; limitType=${n.limitType})`}function Ap(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):Me.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of _h(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){const d=CI(o,c,u);return o.inclusive?d<=0:d<0})(r.startAt,_h(r),i)||r.endAt&&!(function(o,c,u){const d=CI(o,c,u);return o.inclusive?d>=0:d>0})(r.endAt,_h(r),i))})(n,e)}function j7(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function oP(n){return(e,t)=>{let r=!1;for(const i of _h(n)){const a=z7(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function z7(n,e,t){const r=n.field.isKeyField()?Me.comparator(e.key,t.key):(function(a,o,c){const u=o.data.field(a),d=c.data.field(a);return u!==null&&d!==null?al(u,d):Be(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Be(19790,{direction:n.dir})}}class Ys{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ml(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return FM(this.inner)}size(){return this.innerSize}}const L7=new mn(Me.comparator);function vi(){return L7}const lP=new mn(Me.comparator);function ah(...n){let e=lP;for(const t of n)e=e.insert(t.key,t);return e}function cP(n){let e=lP;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ga(){return wh()}function uP(){return wh()}function wh(){return new Ys((n=>n.toString()),((n,e)=>n.isEqual(e)))}const B7=new mn(Me.comparator),U7=new $t(Me.comparator);function wt(...n){let e=U7;for(const t of n)e=e.add(t);return e}const F7=new $t(ut);function G7(){return F7}function kw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fh(e)?"-0":e}}function dP(n){return{integerValue:""+n}}function q7(n,e){return WF(e)?dP(e):kw(n,e)}class Pv{constructor(){this._=void 0}}function H7(n,e,t){return n instanceof Qh?(function(i,a){const o={fields:{[HM]:{stringValue:qM},[YM]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Cw(a)&&(a=kv(a)),a&&(o.fields[$M]=a),{mapValue:o}})(t,e):n instanceof Ac?hP(n,e):n instanceof vd?pP(n,e):(function(i,a){const o=fP(i,a),c=NI(o)+NI(i.Ae);return L1(o)&&L1(i.Ae)?dP(c):kw(i.serializer,c)})(n,e)}function $7(n,e,t){return n instanceof Ac?hP(n,e):n instanceof vd?pP(n,e):t}function fP(n,e){return n instanceof Zh?(function(r){return L1(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Qh extends Pv{}class Ac extends Pv{constructor(e){super(),this.elements=e}}function hP(n,e){const t=gP(e);for(const r of n.elements)t.some((i=>es(i,r)))||t.push(r);return{arrayValue:{values:t}}}class vd extends Pv{constructor(e){super(),this.elements=e}}function pP(n,e){let t=gP(e);for(const r of n.elements)t=t.filter((i=>!es(i,r)));return{arrayValue:{values:t}}}class Zh extends Pv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function NI(n){return pn(n.integerValue||n.doubleValue)}function gP(n){return Xh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class mP{constructor(e,t){this.field=e,this.transform=t}}function Y7(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Ac&&i instanceof Ac||r instanceof vd&&i instanceof vd?ld(r.elements,i.elements,es):r instanceof Zh&&i instanceof Zh?es(r.Ae,i.Ae):r instanceof Qh&&i instanceof Qh})(n.transform,e.transform)}class K7{constructor(e,t){this.version=e,this.transformResults=t}}class rr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rr}static exists(e){return new rr(void 0,e)}static updateTime(e){return new rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function l0(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ov{}function vP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Cp(n.key,rr.none()):new jd(n.key,n.data,rr.none());{const t=n.data,r=Ar.empty();let i=new $t(yn.comparator);for(let a of e.fields)if(!i.has(a)){let o=t.field(a);o===null&&a.length>1&&(a=a.popLast(),o=t.field(a)),o===null?r.delete(a):r.set(a,o),i=i.add(a)}return new Ks(n.key,r,new Qr(i.toArray()),rr.none())}}function X7(n,e,t){n instanceof jd?(function(i,a,o){const c=i.value.clone(),u=PI(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Ks?(function(i,a,o){if(!l0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=PI(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(yP(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Eh(n,e,t,r){return n instanceof jd?(function(a,o,c,u){if(!l0(a.precondition,o))return c;const d=a.value.clone(),h=OI(a.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ks?(function(a,o,c,u){if(!l0(a.precondition,o))return c;const d=OI(a.fieldTransforms,u,o),h=o.data;return h.setAll(yP(a)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((p=>p.field)))})(n,e,t,r):(function(a,o,c){return l0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function W7(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=fP(r.transform,i||null);a!=null&&(t===null&&(t=Ar.empty()),t.set(r.field,a))}return t||null}function MI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ld(r,i,((a,o)=>Y7(a,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class jd extends Ov{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ks extends Ov{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function yP(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function PI(n,e,t){const r=new Map;Ge(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const a=n[i],o=a.transform,c=e.data.field(a.field);r.set(a.field,$7(o,c,t[i]))}return r}function OI(n,e,t){const r=new Map;for(const i of n){const a=i.transform,o=t.data.field(i.field);r.set(i.field,H7(a,o,e))}return r}class Cp extends Ov{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bP extends Ov{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Nw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&X7(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Eh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Eh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=uP();return this.mutations.forEach((i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=t.has(i.key)?null:c;const u=vP(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),wt())}isEqual(e){return this.batchId===e.batchId&&ld(this.mutations,e.mutations,((t,r)=>MI(t,r)))&&ld(this.baseMutations,e.baseMutations,((t,r)=>MI(t,r)))}}class Mw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ge(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return B7})();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new Mw(e,t,r,i)}}class Pw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Q7{constructor(e,t){this.count=e,this.unchangedNames=t}}var Hn,Pt;function Z7(n){switch(n){case ge.OK:return Be(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Be(15467,{code:n})}}function xP(n){if(n===void 0)return zr("GRPC error has no .code"),ge.UNKNOWN;switch(n){case Hn.OK:return ge.OK;case Hn.CANCELLED:return ge.CANCELLED;case Hn.UNKNOWN:return ge.UNKNOWN;case Hn.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case Hn.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case Hn.INTERNAL:return ge.INTERNAL;case Hn.UNAVAILABLE:return ge.UNAVAILABLE;case Hn.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case Hn.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case Hn.NOT_FOUND:return ge.NOT_FOUND;case Hn.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case Hn.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case Hn.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case Hn.ABORTED:return ge.ABORTED;case Hn.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case Hn.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case Hn.DATA_LOSS:return ge.DATA_LOSS;default:return Be(39323,{code:n})}}(Pt=Hn||(Hn={}))[Pt.OK=0]="OK",Pt[Pt.CANCELLED=1]="CANCELLED",Pt[Pt.UNKNOWN=2]="UNKNOWN",Pt[Pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pt[Pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pt[Pt.NOT_FOUND=5]="NOT_FOUND",Pt[Pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pt[Pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pt[Pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pt[Pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pt[Pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pt[Pt.ABORTED=10]="ABORTED",Pt[Pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pt[Pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pt[Pt.INTERNAL=13]="INTERNAL",Pt[Pt.UNAVAILABLE=14]="UNAVAILABLE",Pt[Pt.DATA_LOSS=15]="DATA_LOSS";function J7(){return new TextEncoder}const eG=new Jo([4294967295,4294967295],0);function VI(n){const e=J7().encode(n),t=new vM;return t.update(e),new Uint8Array(t.digest())}function jI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Jo([t,r],0),new Jo([i,a],0)]}class Ow{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new sh(`Invalid padding: ${t}`);if(r<0)throw new sh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new sh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Jo.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Jo.fromNumber(r)));return i.compare(eG)===1&&(i=new Jo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=VI(e),[r,i]=jI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);if(!this.we(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new Ow(a,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const t=VI(e),[r,i]=jI(t);for(let a=0;a<this.hashCount;a++){const o=this.ye(r,i,a);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class sh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Vv{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Ip.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Vv(Xe.min(),i,new mn(ut),vi(),wt())}}class Ip{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ip(r,t,wt(),wt(),wt())}}class c0{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class _P{constructor(e,t){this.targetId=e,this.Ce=t}}class wP{constructor(e,t,r=Xn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class zI{constructor(){this.ve=0,this.Fe=LI(),this.Me=Xn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=wt(),t=wt(),r=wt();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Be(38017,{changeType:a})}})),new Ip(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=LI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ge(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class tG{constructor(e){this.Ge=e,this.ze=new Map,this.je=vi(),this.Je=Am(),this.He=Am(),this.Ye=new mn(ut)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Be(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(z0(a))if(r===0){const o=new Me(a.path);this.et(t,o,Cn.newNoDocument(o,Xe.min()))}else Ge(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let o,c;try{o=zs(r).toUint8Array()}catch(u){if(u instanceof GM)return Ec("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Ow(o,i,a)}catch(u){return Ec(u instanceof sh?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,o)=>{const c=this.ot(o);if(c){if(a.current&&z0(c.target)){const u=new Me(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Cn.newNoDocument(u,e))}a.Be&&(t.set(o,a.ke()),a.qe())}}));let r=wt();this.He.forEach(((a,o)=>{let c=!0;o.forEachWhile((u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(a))})),this.je.forEach(((a,o)=>o.setReadTime(e)));const i=new Vv(e,t,this.Ye,this.je,r);return this.je=vi(),this.Je=Am(),this.He=Am(),this.Ye=new mn(ut),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new zI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new $t(ut),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new $t(ut),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Te("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new zI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Am(){return new mn(Me.comparator)}function LI(){return new mn(Me.comparator)}const nG={asc:"ASCENDING",desc:"DESCENDING"},rG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iG={and:"AND",or:"OR"};class aG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function q1(n,e){return n.useProto3Json||Cv(e)?e:{value:e}}function yd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function EP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function sG(n,e){return yd(n,e.toTimestamp())}function Ur(n){return Ge(!!n,49232),Xe.fromTimestamp((function(t){const r=js(t);return new _t(r.seconds,r.nanos)})(n))}function Vw(n,e){return H1(n,e).canonicalString()}function H1(n,e){const t=(function(i){return new Bt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function SP(n){const e=Bt.fromString(n);return Ge(MP(e),10190,{key:e.toString()}),e}function U0(n,e){return Vw(n.databaseId,e.path)}function hc(n,e){const t=SP(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Me(CP(t))}function TP(n,e){return Vw(n.databaseId,e)}function AP(n){const e=SP(n);return e.length===4?Bt.emptyPath():CP(e)}function $1(n){return new Bt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function CP(n){return Ge(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function BI(n,e,t){return{name:U0(n,e),fields:t.value.mapValue.fields}}function oG(n,e,t){const r=hc(n,e.name),i=Ur(e.updateTime),a=e.createTime?Ur(e.createTime):Xe.min(),o=new Ar({mapValue:{fields:e.fields}}),c=Cn.newFoundDocument(r,i,a,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function lG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Be(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(d,h){return d.useProto3Json?(Ge(h===void 0||typeof h=="string",58123),Xn.fromBase64String(h||"")):(Ge(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xn.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(d){const h=d.code===void 0?ge.UNKNOWN:xP(d.code);return new Ie(h,d.message||"")})(o);t=new wP(r,i,a,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=hc(n,r.document.name),a=Ur(r.document.updateTime),o=r.document.createTime?Ur(r.document.createTime):Xe.min(),c=new Ar({mapValue:{fields:r.document.fields}}),u=Cn.newFoundDocument(i,a,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];t=new c0(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=hc(n,r.document),a=r.readTime?Ur(r.readTime):Xe.min(),o=Cn.newNoDocument(i,a),c=r.removedTargetIds||[];t=new c0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=hc(n,r.document),a=r.removedTargetIds||[];t=new c0([],a,i,null)}else{if(!("filter"in e))return Be(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,o=new Q7(i,a),c=r.targetId;t=new _P(c,o)}}return t}function F0(n,e){let t;if(e instanceof jd)t={update:BI(n,e.key,e.value)};else if(e instanceof Cp)t={delete:U0(n,e.key)};else if(e instanceof Ks)t={update:BI(n,e.key,e.data),updateMask:pG(e.fieldMask)};else{if(!(e instanceof bP))return Be(16599,{Vt:e.type});t={verify:U0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,o){const c=o.transform;if(c instanceof Qh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ac)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof vd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Zh)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Be(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:sG(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Be(27497)})(n,e.precondition)),t}function Y1(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?rr.updateTime(Ur(a.updateTime)):a.exists!==void 0?rr.exists(a.exists):rr.none()})(e.currentDocument):rr.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)Ge(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new Qh;else if("appendMissingElements"in c){const h=c.appendMissingElements.values||[];u=new Ac(h)}else if("removeAllFromArray"in c){const h=c.removeAllFromArray.values||[];u=new vd(h)}else"increment"in c?u=new Zh(o,c.increment):Be(16584,{proto:c});const d=yn.fromServerFormat(c.fieldPath);return new mP(d,u)})(n,i))):[];if(e.update){e.update.name;const i=hc(n,e.update.name),a=new Ar({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(u){const d=u.fieldPaths||[];return new Qr(d.map((h=>yn.fromServerFormat(h))))})(e.updateMask);return new Ks(i,a,o,t,r)}return new jd(i,a,t,r)}if(e.delete){const i=hc(n,e.delete);return new Cp(i,t)}if(e.verify){const i=hc(n,e.verify);return new bP(i,t)}return Be(1463,{proto:e})}function cG(n,e){return n&&n.length>0?(Ge(e!==void 0,14353),n.map((t=>(function(i,a){let o=i.updateTime?Ur(i.updateTime):Ur(a);return o.isEqual(Xe.min())&&(o=Ur(a)),new K7(o,i.transformResults||[])})(t,e)))):[]}function IP(n,e){return{documents:[TP(n,e.path)]}}function RP(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=TP(n,i);const a=(function(d){if(d.length!==0)return NP(Ht.create(d,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const o=(function(d){if(d.length!==0)return d.map((h=>(function(m){return{field:Vu(m.field),direction:dG(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=q1(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function DP(n){let e=AP(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ge(r===1,65062);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let a=[];t.where&&(a=(function(p){const m=kP(p);return m instanceof Ht&&Dw(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map((m=>(function(_){return new Wh(ju(_.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(_.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,Cv(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){const m=!!p.before,b=p.values||[];return new gd(b,m)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){const m=!p.before,b=p.values||[];return new gd(b,m)})(t.endAt)),O7(e,i,o,a,c,"F",u,d)}function uG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Be(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function kP(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ju(t.unaryFilter.field);return Dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ju(t.unaryFilter.field);return Dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ju(t.unaryFilter.field);return Dt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ju(t.unaryFilter.field);return Dt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Be(61313);default:return Be(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Dt.create(ju(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Be(58110);default:return Be(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ht.create(t.compositeFilter.filters.map((r=>kP(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Be(1026)}})(t.compositeFilter.op))})(n):Be(30097,{filter:n})}function dG(n){return nG[n]}function fG(n){return rG[n]}function hG(n){return iG[n]}function Vu(n){return{fieldPath:n.canonicalString()}}function ju(n){return yn.fromServerFormat(n.fieldPath)}function NP(n){return n instanceof Dt?(function(t){if(t.op==="=="){if(SI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NAN"}};if(EI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(SI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NOT_NAN"}};if(EI(t.value))return{unaryFilter:{field:Vu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vu(t.field),op:fG(t.op),value:t.value}}})(n):n instanceof Ht?(function(t){const r=t.getFilters().map((i=>NP(i)));return r.length===1?r[0]:{compositeFilter:{op:hG(t.op),filters:r}}})(n):Be(54877,{filter:n})}function pG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function MP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Cs{constructor(e,t,r,i,a=Xe.min(),o=Xe.min(),c=Xn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PP{constructor(e){this.yt=e}}function gG(n,e){let t;if(e.document)t=oG(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Me.fromSegments(e.noDocument.path),i=Ic(e.noDocument.readTime);t=Cn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Be(56709);{const r=Me.fromSegments(e.unknownDocument.path),i=Ic(e.unknownDocument.version);t=Cn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new _t(i[0],i[1]);return Xe.fromTimestamp(a)})(e.readTime)),t}function UI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:G0(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,o){return{name:U0(a,o.key),fields:o.data.value.mapValue.fields,updateTime:yd(a,o.version.toTimestamp()),createTime:yd(a,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Cc(e.version)};else{if(!e.isUnknownDocument())return Be(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Cc(e.version)}}return r}function G0(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Cc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ic(n){const e=new _t(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function Jl(n,e){const t=(e.baseMutations||[]).map((a=>Y1(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const o=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>Y1(n.yt,a))),i=_t.fromMillis(e.localWriteTimeMs);return new Nw(e.batchId,i,t,r)}function oh(n){const e=Ic(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ic(n.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const o=a.documents.length;return Ge(o===1,1966,{count:o}),Bi(Tp(AP(a.documents[0])))})(n.query):(function(a){return Bi(DP(a))})(n.query),new Cs(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Xn.fromBase64String(n.resumeToken))}function OP(n,e){const t=Cc(e.snapshotVersion),r=Cc(e.lastLimboFreeSnapshotVersion);let i;i=z0(e.target)?IP(n.yt,e.target):RP(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Tc(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function VP(n){const e=DP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?B0(e,e.limit,"L"):e}function Ix(n,e){return new Pw(e.largestBatchId,Y1(n.yt,e.overlayMutation))}function FI(n,e){const t=e.path.lastSegment();return[n,Rr(e.path.popLast()),t]}function GI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Cc(r.readTime),documentKey:Rr(r.documentKey.path),largestBatchId:r.largestBatchId}}class mG{getBundleMetadata(e,t){return qI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Ic(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return qI(e).put((function(i){return{bundleId:i.id,createTime:Cc(Ur(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return HI(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:VP(a.bundledQuery),readTime:Ic(a.readTime)}})(r)}))}saveNamedQuery(e,t){return HI(e).put((function(i){return{name:i.name,readTime:Cc(Ur(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function qI(n){return ar(n,Iv)}function HI(n){return ar(n,Rv)}class jv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new jv(e,r)}getOverlay(e,t){return Xf(e).get(FI(this.userId,t)).next((r=>r?Ix(this.serializer,r):null))}getOverlays(e,t){const r=Ga();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,o)=>{const c=new Pw(t,o);i.push(this.St(e,c))})),ae.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((o=>i.add(Rr(o.getCollectionPath()))));const a=[];return i.forEach((o=>{const c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);a.push(Xf(e).Z(V1,c))})),ae.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Ga(),a=Rr(t),o=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Xf(e).J(V1,o).next((c=>{for(const u of c){const d=Ix(this.serializer,u);i.set(d.getKey(),d)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=Ga();let o;const c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xf(e).ee({index:jM,range:c},((u,d,h)=>{const p=Ix(this.serializer,d);a.size()<i||p.largestBatchId===o?(a.set(p.getKey(),p),o=p.largestBatchId):h.done()})).next((()=>a))}St(e,t){return Xf(e).put((function(i,a,o){const[c,u,d]=FI(a,o.mutation.key);return{userId:a,collectionPath:u,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:F0(i.yt,o.mutation)}})(this.serializer,this.userId,t))}}function Xf(n){return ar(n,Dv)}class vG{bt(e){return ar(e,Tw)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Xn.fromUint8Array(r):Xn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class ec{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(pn(e.integerValue));else if("doubleValue"in e){const r=pn(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Fh(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=js(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(zs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?XM(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Nv(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Be(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const i=hd,a=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(pn(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Me.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}ec.Kt=new ec;const Ru=255;function yG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function $I(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const o=yG(255&r[a]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}class bG{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),r=$I(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=$I(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Ru),this.sn(255)}_n(){this.an(Ru),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,a,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ru?(this.sn(Ru),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ru?(this.an(Ru),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class xG{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class _G{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Wf{constructor(){this.cn=new bG,this.ln=new xG(this.cn),this.hn=new _G(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class tc{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new tc(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:u0(this.En),directionalValue:u0(this.dn),orderedDocumentKey:u0(t),documentKey:r.path.toArray()}}Vn(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function No(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=YI(n.En,e.En),t!==0?t:(t=YI(n.dn,e.dn),t!==0?t:Me.comparator(n.In,e.In)))}function YI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function u0(n){return CN()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function KI(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class XI{constructor(e){this.mn=new $t(((t,r)=>yn.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Ge(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=M1(e);if(t!==void 0&&!this.wn(t))return!1;const r=Kl(e);let i=new Set,a=0,o=0;for(;a<r.length&&this.wn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.mn.size>0){const c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const u=r[a];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++a}for(;a<r.length;++a){const c=r[a];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new $t(yn.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new n0(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new n0(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new n0(r.field,r.dir==="asc"?0:1)));return new M0(M0.UNKNOWN_ID,this.collectionId,t,Uh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function jP(n){if(Ge(n instanceof Dt||n instanceof Ht,20012),n instanceof Dt){if(n instanceof iP){const t=n.value.arrayValue?.values?.map((r=>Dt.create(n.field,"==",r)))||[];return Ht.create(t,"or")}return n}const e=n.filters.map((t=>jP(t)));return Ht.create(e,n.op)}function wG(n){if(n.getFilters().length===0)return[];const e=W1(jP(n));return Ge(zP(e),7391),K1(e)||X1(e)?[e]:e.getFilters()}function K1(n){return n instanceof Dt}function X1(n){return n instanceof Ht&&Dw(n)}function zP(n){return K1(n)||X1(n)||(function(t){if(t instanceof Ht&&B1(t)){for(const r of t.getFilters())if(!K1(r)&&!X1(r))return!1;return!0}return!1})(n)}function W1(n){if(Ge(n instanceof Dt||n instanceof Ht,34018),n instanceof Dt)return n;if(n.filters.length===1)return W1(n.filters[0]);const e=n.filters.map((r=>W1(r)));let t=Ht.create(e,n.op);return t=q0(t),zP(t)?t:(Ge(t instanceof Ht,64498),Ge(md(t),40251),Ge(t.filters.length>1,57927),t.filters.reduce(((r,i)=>jw(r,i))))}function jw(n,e){let t;return Ge(n instanceof Dt||n instanceof Ht,38388),Ge(e instanceof Dt||e instanceof Ht,25473),t=n instanceof Dt?e instanceof Dt?(function(i,a){return Ht.create([i,a],"and")})(n,e):WI(n,e):e instanceof Dt?WI(e,n):(function(i,a){if(Ge(i.filters.length>0&&a.filters.length>0,48005),md(i)&&md(a))return tP(i,a.getFilters());const o=B1(i)?i:a,c=B1(i)?a:i,u=o.filters.map((d=>jw(d,c)));return Ht.create(u,"or")})(n,e),q0(t)}function WI(n,e){if(md(e))return tP(e,n.getFilters());{const t=e.filters.map((r=>jw(n,r)));return Ht.create(t,"or")}}function q0(n){if(Ge(n instanceof Dt||n instanceof Ht,11850),n instanceof Dt)return n;const e=n.getFilters();if(e.length===1)return q0(e[0]);if(JM(n))return n;const t=e.map((i=>q0(i))),r=[];return t.forEach((i=>{i instanceof Dt?r.push(i):i instanceof Ht&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Ht.create(r,n.op)}class EG{constructor(){this.Cn=new zw}addToCollectionParentIndex(e,t){return this.Cn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(yi.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(yi.min())}updateCollectionGroup(e,t,r){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class zw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new $t(Bt.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $t(Bt.comparator)).toArray()}}const QI="IndexedDbIndexManager",Cm=new Uint8Array(0);class SG{constructor(e,t){this.databaseId=t,this.vn=new zw,this.Fn=new Ys((r=>Tc(r)),((r,i)=>Sp(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Rr(i)};return ZI(e).put(a)}return ae.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[TM(t),""],!1,!0);return ZI(e).J(i).next((a=>{for(const o of a){if(o.collectionId!==t)break;r.push(Fa(o.parent))}return r}))}addFieldIndex(e,t){const r=Qf(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const o=ku(e);return a.next((c=>{o.put(GI(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=Qf(e),i=ku(e),a=Du(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Qf(e),r=Du(e),i=ku(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return ae.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new XI(r).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=Du(e);let i=!0;const a=new Map;return ae.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),a.set(o,c)})))).next((()=>{if(i){let o=wt();const c=[];return ae.forEach(a,((u,d)=>{Te(QI,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((M=>`${M.fieldPath}:${M.kind}`)).join(",")}`})(u)} to execute ${Tc(t)}`);const h=(function(D,M){const j=M1(M);if(j===void 0)return null;for(const z of L0(D,j.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(d,u),p=(function(D,M){const j=new Map;for(const z of Kl(M))for(const A of L0(D,z.fieldPath))switch(A.op){case"==":case"in":j.set(z.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return j.set(z.fieldPath.canonicalString(),A.value),Array.from(j.values())}return null})(d,u),m=(function(D,M){const j=[];let z=!0;for(const A of Kl(M)){const I=A.kind===0?RI(D,A.fieldPath,D.startAt):DI(D,A.fieldPath,D.startAt);j.push(I.value),z&&(z=I.inclusive)}return new gd(j,z)})(d,u),b=(function(D,M){const j=[];let z=!0;for(const A of Kl(M)){const I=A.kind===0?DI(D,A.fieldPath,D.endAt):RI(D,A.fieldPath,D.endAt);j.push(I.value),z&&(z=I.inclusive)}return new gd(j,z)})(d,u),_=this.On(u,d,m),w=this.On(u,d,b),S=this.Nn(u,d,p),T=this.Bn(u.indexId,h,_,m.inclusive,w,b.inclusive,S);return ae.forEach(T,(C=>r.Y(C,t.limit).next((D=>{D.forEach((M=>{const j=Me.fromSegments(M.documentKey);o.has(j)||(o=o.add(j),c.push(j))}))}))))})).next((()=>c))}return ae.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=wG(Ht.create(e.filters,"and")).map((r=>F1(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,a,o,c){const u=(t!=null?t.length:1)*Math.max(r.length,a.length),d=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){const m=t?this.Ln(t[p/d]):Cm,b=this.kn(e,m,r[p%d],i),_=this.qn(e,m,a[p%d],o),w=c.map((S=>this.kn(e,m,S,!0)));h.push(...this.createRange(b,_,w))}return h}kn(e,t,r,i){const a=new tc(e,Me.empty(),t,r);return i?a:a.An()}qn(e,t,r,i){const a=new tc(e,Me.empty(),t,r);return i?a.An():a}xn(e,t){const r=new XI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let o=null;for(const c of a)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2;const i=this.Mn(t);return ae.forEach(i,(a=>this.xn(e,a).next((o=>{o?r!==0&&o.fields.length<(function(u){let d=new $t(yn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){const r=new Wf;for(const i of Kl(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const o=r.Pn(i.kind);ec.Kt.Dt(a,o)}return r.un()}Ln(e){const t=new Wf;return ec.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Wf;return ec.Kt.Dt(Kh(this.databaseId,t),r.Pn((function(a){const o=Kl(a);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Wf);let a=0;for(const o of Kl(e)){const c=r[a++];for(const u of i)if(this.Un(t,o.fieldPath)&&Xh(c))i=this.Kn(i,o,c);else{const d=u.Pn(o.kind);ec.Kt.Dt(c,d)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const i=[...e],a=[];for(const o of r.arrayValue.values||[])for(const c of i){const u=new Wf;u.seed(c.un()),ec.Kt.Dt(o,u.Pn(t.kind)),a.push(u)}return a}Un(e,t){return!!e.filters.find((r=>r instanceof Dt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Qf(e),i=ku(e);return(t?r.J(O1,IDBKeyRange.bound(t,t)):r.J()).next((a=>{const o=[];return ae.forEach(a,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(h,p){const m=p?new Uh(p.sequenceNumber,new yi(Ic(p.readTime),new Me(Fa(p.documentKey)),p.largestBatchId)):Uh.empty(),b=h.fields.map((([_,w])=>new n0(yn.fromServerFormat(_),w)));return new M0(h.indexId,h.collectionGroup,b,m)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:ut(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=Qf(e),a=ku(e);return this.Gn(e).next((o=>i.J(O1,IDBKeyRange.bound(t,t)).next((c=>ae.forEach(c,(u=>a.put(GI(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){const r=new Map;return ae.forEach(t,((i,a)=>{const o=r.get(i.collectionGroup);return(o?ae.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),ae.forEach(c,(u=>this.zn(e,i,u).next((d=>{const h=this.jn(a,u);return d.isEqual(h)?ae.resolve():this.Jn(e,a,u,d,h)})))))))}))}Hn(e,t,r,i){return Du(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return Du(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const i=Du(e);let a=new $t(No);return i.ee({index:VM,range:IDBKeyRange.only([r.indexId,this.uid,u0(this.$n(r,t))])},((o,c)=>{a=a.add(new tc(r.indexId,t,KI(c.arrayValue),KI(c.directionalValue)))})).next((()=>a))}jn(e,t){let r=new $t(No);const i=this.Qn(t,e);if(i==null)return r;const a=M1(t);if(a!=null){const o=e.data.field(a.fieldPath);if(Xh(o))for(const c of o.arrayValue.values||[])r=r.add(new tc(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new tc(t.indexId,e.key,Cm,i));return r}Jn(e,t,r,i,a){Te(QI,"Updating index entries for document '%s'",t.key);const o=[];return(function(u,d,h,p,m){const b=u.getIterator(),_=d.getIterator();let w=Iu(b),S=Iu(_);for(;w||S;){let T=!1,C=!1;if(w&&S){const D=h(w,S);D<0?C=!0:D>0&&(T=!0)}else w!=null?C=!0:T=!0;T?(p(S),S=Iu(_)):C?(m(w),w=Iu(b)):(w=Iu(b),S=Iu(_))}})(i,a,No,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),ae.waitFor(o)}Gn(e){let t=1;return ku(e).ee({index:OM,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>No(o,c))).filter(((o,c,u)=>!c||No(o,u[c-1])!==0));const i=[];i.push(e);for(const o of r){const c=No(o,e),u=No(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);const a=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const c=i[o].Vn(this.uid,Cm,Me.empty()),u=i[o+1].Vn(this.uid,Cm,Me.empty());a.push(IDBKeyRange.bound(c,u))}return a}Zn(e,t){return No(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(JI)}getMinOffset(e,t){return ae.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||Be(44426))))).next(JI)}}function ZI(n){return ar(n,Hh)}function Du(n){return ar(n,bh)}function Qf(n){return ar(n,Sw)}function ku(n){return ar(n,yh)}function JI(n){Ge(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;_w(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new yi(e.readTime,e.documentKey,t)}const eR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},LP=41943040;class Tr{static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function BP(n,e,t){const r=n.store(aa),i=n.store(cd),a=[],o=IDBKeyRange.only(t.batchId);let c=0;const u=r.ee({range:o},((h,p,m)=>(c++,m.delete())));a.push(u.next((()=>{Ge(c===1,47070,{batchId:t.batchId})})));const d=[];for(const h of t.mutations){const p=NM(e,h.key.path,t.batchId);a.push(i.delete(p)),d.push(h.key)}return ae.waitFor(a).next((()=>d))}function H0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Be(14731);e=n.noDocument}return JSON.stringify(e).length}Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(LP,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);class zv{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){Ge(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new zv(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).ee({index:sc,range:r},((i,a,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=zu(e),o=Mo(e);return o.add({}).next((c=>{Ge(typeof c=="number",49019);const u=new Nw(c,t,r,i),d=(function(b,_,w){const S=w.baseMutations.map((C=>F0(b.yt,C))),T=w.mutations.map((C=>F0(b.yt,C)));return{userId:_,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:S,mutations:T}})(this.serializer,this.userId,u),h=[];let p=new $t(((m,b)=>ut(m.canonicalString(),b.canonicalString())));for(const m of i){const b=NM(this.userId,m.key.path,c);p=p.add(m.key.path.popLast()),h.push(o.put(d)),h.push(a.put(b,JF))}return p.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),ae.waitFor(h).next((()=>u))}))}lookupMutationBatch(e,t){return Mo(e).get(t).next((r=>r?(Ge(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Jl(this.serializer,r)):null))}er(e,t){return this.Xn[t]?ae.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Mo(e).ee({index:sc,range:i},((o,c,u)=>{c.userId===this.userId&&(Ge(c.batchId>=r,47524,{tr:r}),a=Jl(this.serializer,c)),u.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=dc;return Mo(e).ee({index:sc,range:t,reverse:!0},((i,a,o)=>{r=a.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,dc],[this.userId,Number.POSITIVE_INFINITY]);return Mo(e).J(sc,t).next((r=>r.map((i=>Jl(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=r0(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return zu(e).ee({range:i},((o,c,u)=>{const[d,h,p]=o,m=Fa(h);if(d===this.userId&&t.path.isEqual(m))return Mo(e).get(p).next((b=>{if(!b)throw Be(61480,{nr:o,batchId:p});Ge(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),a.push(Jl(this.serializer,b))}));u.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new $t(ut);const i=[];return t.forEach((a=>{const o=r0(this.userId,a.path),c=IDBKeyRange.lowerBound(o),u=zu(e).ee({range:c},((d,h,p)=>{const[m,b,_]=d,w=Fa(b);m===this.userId&&a.path.isEqual(w)?r=r.add(_):p.done()}));i.push(u)})),ae.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=r0(this.userId,r),o=IDBKeyRange.lowerBound(a);let c=new $t(ut);return zu(e).ee({range:o},((u,d,h)=>{const[p,m,b]=u,_=Fa(m);p===this.userId&&r.isPrefixOf(_)?_.length===i&&(c=c.add(b)):h.done()})).next((()=>this.rr(e,c)))}rr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(Mo(e).get(a).next((o=>{if(o===null)throw Be(35274,{batchId:a});Ge(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:a}),r.push(Jl(this.serializer,o))})))})),ae.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return BP(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ae.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ae.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return zu(e).ee({range:r},((a,o,c)=>{if(a[0]===this.userId){const u=Fa(a[1]);i.push(u)}else c.done()})).next((()=>{Ge(i.length===0,56720,{sr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return UP(e,this.userId,t)}_r(e){return FP(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:dc,lastStreamToken:""}))}}function UP(n,e,t){const r=r0(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let o=!1;return zu(n).ee({range:a,X:!0},((c,u,d)=>{const[h,p,m]=c;h===e&&p===i&&(o=!0),d.done()})).next((()=>o))}function Mo(n){return ar(n,aa)}function zu(n){return ar(n,cd)}function FP(n){return ar(n,Gh)}class Rc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Rc(0)}static cr(){return new Rc(-1)}}class TG{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const r=new Rc(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Xe.fromTimestamp(new _t(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Nu(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(Ge(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return Nu(e).ee(((o,c)=>{const u=oh(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,a.push(this.removeTargetData(e,u)))})).next((()=>ae.waitFor(a))).next((()=>i))}forEachTarget(e,t){return Nu(e).ee(((r,i)=>{const a=oh(i);t(a)}))}lr(e){return tR(e).get(V0).next((t=>(Ge(t!==null,2888),t)))}hr(e,t){return tR(e).put(V0,t)}Pr(e,t){return Nu(e).put(OP(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Tc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Nu(e).ee({range:i,index:PM},((o,c,u)=>{const d=oh(c);Sp(t,d.target)&&(a=d,u.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=Ho(e);return t.forEach((o=>{const c=Rr(o.path);i.push(a.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),ae.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ho(e);return ae.forEach(t,(a=>{const o=Rr(a.path);return ae.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Ho(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ho(e);let a=wt();return i.ee({range:r,X:!0},((o,c,u)=>{const d=Fa(o[1]),h=new Me(d);a=a.add(h)})).next((()=>a))}containsKey(e,t){const r=Rr(t.path),i=IDBKeyRange.bound([r],[TM(r)],!1,!0);let a=0;return Ho(e).ee({index:Ew,X:!0,range:i},(([o,c],u,d)=>{o!==0&&(a++,d.done())})).next((()=>a>0))}At(e,t){return Nu(e).get(t).next((r=>r?oh(r):null))}}function Nu(n){return ar(n,ud)}function tR(n){return ar(n,fc)}function Ho(n){return ar(n,dd)}const nR="LruGarbageCollector",AG=1048576;function rR([n,e],[t,r]){const i=ut(n,t);return i===0?ut(e,r):i}class CG{constructor(e){this.Ir=e,this.buffer=new $t(rR),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();rR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class GP{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(nR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){gl(t)?Te(nR,"Ignoring IndexedDB error during garbage collection: ",t):await jc(t)}await this.Vr(3e5)}))}}class IG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(zi.ce);const r=new CG(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(eR)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),eR):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,a,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i)))).next((p=>(r=p,c=Date.now(),this.removeTargets(e,r,t)))).next((p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((p=>(d=Date.now(),Pu()<=Rt.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:p}))))}}function qP(n,e){return new IG(n,e)}class RG{constructor(e,t){this.db=e,this.garbageCollector=qP(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return Im(e,r)}removeReference(e,t,r){return Im(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Im(e,t)}br(e,t){return(function(i,a){let o=!1;return FP(i).te((c=>UP(i,c,a).next((u=>(u&&(o=!0),ae.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Sr(e,((o,c)=>{if(c<=t){const u=this.br(e,o).next((d=>{if(!d)return a++,r.getEntry(e,o).next((()=>(r.removeEntry(o,Xe.min()),Ho(e).delete((function(p){return[0,Rr(p.path)]})(o)))))}));i.push(u)}})).next((()=>ae.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Im(e,t)}Sr(e,t){const r=Ho(e);let i,a=zi.ce;return r.ee({index:Ew},(([o,c],{path:u,sequenceNumber:d})=>{o===0?(a!==zi.ce&&t(new Me(Fa(i)),a),a=d,i=u):a=zi.ce})).next((()=>{a!==zi.ce&&t(new Me(Fa(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Im(n,e){return Ho(n).put((function(r,i){return{targetId:0,path:Rr(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class HP{constructor(){this.changes=new Ys((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Cn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ae.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class DG{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ql(e).put(r)}removeEntry(e,t,r){return ql(e).delete((function(a,o){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],G0(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Cn.newInvalidDocument(t);return ql(e).ee({index:i0,range:IDBKeyRange.only(Zf(t))},((i,a)=>{r=this.Cr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:Cn.newInvalidDocument(t)};return ql(e).ee({index:i0,range:IDBKeyRange.only(Zf(t))},((i,a)=>{r={document:this.Cr(t,a),size:H0(a)}})).next((()=>r))}getEntries(e,t){let r=vi();return this.Fr(e,t,((i,a)=>{const o=this.Cr(i,a);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=vi(),i=new mn(Me.comparator);return this.Fr(e,t,((a,o)=>{const c=this.Cr(a,o);r=r.insert(a,c),i=i.insert(a,H0(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return ae.resolve();let i=new $t(sR);t.forEach((u=>i=i.add(u)));const a=IDBKeyRange.bound(Zf(i.first()),Zf(i.last())),o=i.getIterator();let c=o.getNext();return ql(e).ee({index:i0,range:a},((u,d,h)=>{const p=Me.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;c&&sR(c,p)<0;)r(c,null),c=o.getNext();c&&c.isEqual(p)&&(r(c,d),c=o.hasNext()?o.getNext():null),c?h.j(Zf(c)):h.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const o=t.path,c=[o.popLast().toArray(),o.lastSegment(),G0(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ql(e).J(IDBKeyRange.bound(c,u,!0)).next((d=>{a?.incrementDocumentReadCount(d.length);let h=vi();for(const p of d){const m=this.Cr(Me.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Ap(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,r,i){let a=vi();const o=aR(t,r),c=aR(t,yi.max());return ql(e).ee({index:MM,range:IDBKeyRange.bound(o,c,!0)},((u,d,h)=>{const p=this.Cr(Me.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);a=a.insert(p.key,p),a.size===i&&h.done()})).next((()=>a))}newChangeBuffer(e){return new kG(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return iR(e).get(P1).next((t=>(Ge(!!t,20021),t)))}Dr(e,t){return iR(e).put(P1,t)}Cr(e,t){if(t){const r=gG(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return Cn.newInvalidDocument(e)}}function $P(n){return new DG(n)}class kG extends HP{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ys((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new $t(((a,o)=>ut(a.canonicalString(),o.canonicalString())));return this.changes.forEach(((a,o)=>{const c=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,c.readTime)),o.isValidDocument()){const u=UI(this.Nr.serializer,o);i=i.add(a.path.popLast());const d=H0(u);r+=d-c.size,t.push(this.Nr.addEntry(e,a,u))}else if(r-=c.size,this.trackRemovals){const u=UI(this.Nr.serializer,o.convertToNoDocument(Xe.min()));t.push(this.Nr.addEntry(e,a,u))}})),i.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,r)),ae.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((a,o)=>{this.Br.set(a,{size:o,readTime:r.get(a).readTime})})),r)))}}function iR(n){return ar(n,qh)}function ql(n){return ar(n,O0)}function Zf(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function aR(n,e){const t=e.documentKey.path.toArray();return[n,G0(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function sR(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=ut(t[a],r[a]),i)return i;return i=ut(t.length,r.length),i||(i=ut(t[t.length-2],r[r.length-2]),i||ut(t[t.length-1],r[r.length-1]))}class NG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YP{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Eh(r.mutation,i,Qr.empty(),_t.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,wt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=wt()){const i=Ga();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let o=ah();return a.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=Ga();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,wt())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let a=vi();const o=wh(),c=(function(){return wh()})();return t.forEach(((u,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Ks)?a=a.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Eh(h.mutation,d,h.mutation.getFieldMask(),_t.now())):o.set(d.key,Qr.empty())})),this.recalculateAndSaveOverlays(e,a).next((u=>(u.forEach(((d,h)=>o.set(d,h))),t.forEach(((d,h)=>c.set(d,new NG(h,o.get(d)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=wh();let i=new mn(((o,c)=>o-c)),a=wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const c of o)c.keys().forEach((u=>{const d=t.get(u);if(d===null)return;let h=r.get(u)||Qr.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(i.get(c.batchId)||wt()).add(u);i=i.insert(c.batchId,p)}))})).next((()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=uP();h.forEach((m=>{if(!a.has(m)){const b=vP(t.get(m),r.get(m));b!==null&&p.set(m,b),a=a.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return ae.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return Me.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):aP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ae.resolve(Ga());let c=Bh,u=a;return o.next((d=>ae.forEach(d,((h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),a.get(h)?ae.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{u=u.insert(h,m)}))))).next((()=>this.populateOverlays(e,d,a))).next((()=>this.computeViews(e,u,d,wt()))).next((h=>({batchId:c,changes:cP(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Me(t)).next((r=>{let i=ah();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let o=ah();return this.indexManager.getCollectionParents(e,a).next((c=>ae.forEach(c,(u=>{const d=(function(p,m){return new Vd(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((h=>{h.forEach(((p,m)=>{o=o.insert(p,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((o=>{a.forEach(((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Cn.newInvalidDocument(h)))}));let c=ah();return o.forEach(((u,d)=>{const h=a.get(u);h!==void 0&&Eh(h.mutation,d,Qr.empty(),_t.now()),Ap(t,d)&&(c=c.insert(u,d))})),c}))}}class MG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ur(i.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:VP(i.bundledQuery),readTime:Ur(i.readTime)}})(t)),ae.resolve()}}class PG{constructor(){this.overlays=new mn(Me.comparator),this.qr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ga();return ae.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.St(e,t,a)})),ae.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(r)),ae.resolve()}getOverlaysForCollection(e,t,r){const i=Ga(),a=t.length+1,o=new Me(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===a&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new mn(((d,h)=>d-h));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=a.get(d.largestBatchId);h===null&&(h=Ga(),a=a.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=Ga(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((d,h)=>c.set(d,h))),!(c.size()>=i)););return ae.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Pw(t,r));let a=this.qr.get(t);a===void 0&&(a=wt(),this.qr.set(t,a)),this.qr.set(t,a.add(r.key))}}class OG{constructor(){this.sessionToken=Xn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}class Lw{constructor(){this.Qr=new $t(cr.$r),this.Ur=new $t(cr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new cr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new cr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new Me(new Bt([])),r=new cr(t,e),i=new cr(t,e+1),a=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),a.push(o.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Me(new Bt([])),r=new cr(t,e),i=new cr(t,e+1);let a=wt();return this.Ur.forEachInRange([r,i],(o=>{a=a.add(o.key)})),a}containsKey(e){const t=new cr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class cr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Me.comparator(e.key,t.key)||ut(e.Yr,t.Yr)}static Kr(e,t){return ut(e.Yr,t.Yr)||Me.comparator(e.key,t.key)}}class VG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new $t(cr.$r)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Nw(a,t,r,i);this.mutationQueue.push(o);for(const c of i)this.Zr=this.Zr.add(new cr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,t){return ae.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),a=i<0?0:i;return ae.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?dc:this.tr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new cr(t,0),i=new cr(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([r,i],(o=>{const c=this.Xr(o.Yr);a.push(c)})),ae.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new $t(ut);return t.forEach((i=>{const a=new cr(i,0),o=new cr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,o],(c=>{r=r.add(c.Yr)}))})),ae.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;Me.isDocumentKey(a)||(a=a.child(""));const o=new cr(new Me(a),0);let c=new $t(ut);return this.Zr.forEachWhile((u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Yr)),!0)}),o),ae.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ge(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ae.forEach(t.mutations,(i=>{const a=new cr(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new cr(t,0),i=this.Zr.firstAfterOrEqual(r);return ae.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class jG{constructor(e){this.ri=e,this.docs=(function(){return new mn(Me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ae.resolve(r?r.document.mutableCopy():Cn.newInvalidDocument(t))}getEntries(e,t){let r=vi();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Cn.newInvalidDocument(i))})),ae.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=vi();const o=t.path,c=new Me(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||_w(IM(h),r)<=0||(i.has(h.key)||Ap(t,h))&&(a=a.insert(h.key,h.mutableCopy()))}return ae.resolve(a)}getAllFromCollectionGroup(e,t,r,i){Be(9500)}ii(e,t){return ae.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new zG(this)}getSize(e){return ae.resolve(this.size)}}class zG extends HP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),ae.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class LG{constructor(e){this.persistence=e,this.si=new Ys((t=>Tc(t)),Sp),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.oi=0,this._i=new Lw,this.targetCount=0,this.ai=Rc.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),ae.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Rc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.Pr(t),ae.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),ae.waitFor(a).next((()=>i))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return ae.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),ae.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((o=>{a.push(i.markPotentiallyOrphaned(e,o))})),ae.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return ae.resolve(r)}containsKey(e,t){return ae.resolve(this._i.containsKey(t))}}class Bw{constructor(e,t){this.ui={},this.overlays={},this.ci=new zi(0),this.li=!1,this.li=!0,this.hi=new OG,this.referenceDelegate=e(this),this.Pi=new LG(this),this.indexManager=new EG,this.remoteDocumentCache=(function(i){return new jG(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new PP(t),this.Ii=new MG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new PG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new VG(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Te("MemoryPersistence","Starting transaction:",e);const i=new BG(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((a=>this.referenceDelegate.di(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ai(e,t){return ae.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class BG extends DM{constructor(e){super(),this.currentSequenceNumber=e}}class Lv{constructor(e){this.persistence=e,this.Ri=new Lw,this.Vi=null}static mi(e){return new Lv(e)}get fi(){if(this.Vi)return this.Vi;throw Be(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),ae.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.fi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,(r=>{const i=Me.fromPath(r);return this.gi(e,i).next((a=>{a||t.removeEntry(i,Xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class $0{constructor(e,t){this.persistence=e,this.pi=new Ys((r=>Rr(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=qP(this,t)}static mi(e,t){return new $0(e,t)}Ei(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return ae.forEach(this.pi,((r,i)=>this.br(e,r,i).next((a=>a?ae.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,a.removeEntry(o,Xe.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=s0(e.data.value)),t}br(e,t,r){return ae.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return ae.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class UG{constructor(e){this.serializer=e}k(e,t,r,i){const a=new Av("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(Ep)})(e),(function(u){u.createObjectStore(Gh,{keyPath:ZF}),u.createObjectStore(aa,{keyPath:vI,autoIncrement:!0}).createIndex(sc,yI,{unique:!0}),u.createObjectStore(cd)})(e),oR(e),(function(u){u.createObjectStore(Xl)})(e));let o=ae.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(dd),u.deleteObjectStore(ud),u.deleteObjectStore(fc)})(e),oR(e)),o=o.next((()=>(function(u){const d=u.store(fc),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return d.put(V0,h)})(a)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,d){return d.store(aa).J().next((p=>{u.deleteObjectStore(aa),u.createObjectStore(aa,{keyPath:vI,autoIncrement:!0}).createIndex(sc,yI,{unique:!0});const m=d.store(aa),b=p.map((_=>m.put(_)));return ae.waitFor(b)}))})(e,a)))),o=o.next((()=>{(function(u){u.createObjectStore(fd,{keyPath:o7})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(a)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(qh)})(e),this.wi(a))))),r<7&&i>=7&&(o=o.next((()=>this.Si(a)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,a)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(a)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Iv,{keyPath:l7})})(e),(function(u){u.createObjectStore(Rv,{keyPath:c7})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){const d=u.createObjectStore(Dv,{keyPath:m7});d.createIndex(V1,v7,{unique:!1}),d.createIndex(jM,y7,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){const d=u.createObjectStore(O0,{keyPath:e7});d.createIndex(i0,t7),d.createIndex(MM,n7)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Xl)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,a)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Sw,{keyPath:u7,autoIncrement:!0}).createIndex(O1,d7,{unique:!1}),u.createObjectStore(yh,{keyPath:f7}).createIndex(OM,h7,{unique:!1}),u.createObjectStore(bh,{keyPath:p7}).createIndex(VM,g7,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(yh).clear()})).next((()=>{t.objectStore(bh).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Tw,{keyPath:b7})})(e)}))),r<18&&i>=18&&CN()&&(o=o.next((()=>{t.objectStore(yh).clear()})).next((()=>{t.objectStore(bh).clear()}))),o}wi(e){let t=0;return e.store(Xl).ee(((r,i)=>{t+=H0(i)})).next((()=>{const r={byteSize:t};return e.store(qh).put(P1,r)}))}yi(e){const t=e.store(Gh),r=e.store(aa);return t.J().next((i=>ae.forEach(i,(a=>{const o=IDBKeyRange.bound([a.userId,dc],[a.userId,a.lastAcknowledgedBatchId]);return r.J(sc,o).next((c=>ae.forEach(c,(u=>{Ge(u.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const d=Jl(this.serializer,u);return BP(e,a.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(dd),r=e.store(Xl);return e.store(fc).get(V0).next((i=>{const a=[];return r.ee(((o,c)=>{const u=new Bt(o),d=(function(p){return[0,Rr(p)]})(u);a.push(t.get(d).next((h=>h?ae.resolve():(p=>t.put({targetId:0,path:Rr(p),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>ae.waitFor(a)))}))}bi(e,t){e.createObjectStore(Hh,{keyPath:s7});const r=t.store(Hh),i=new zw,a=o=>{if(i.add(o)){const c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:Rr(u)})}};return t.store(Xl).ee({X:!0},((o,c)=>{const u=new Bt(o);return a(u.popLast())})).next((()=>t.store(cd).ee({X:!0},(([o,c,u],d)=>{const h=Fa(c);return a(h.popLast())}))))}Di(e){const t=e.store(ud);return t.ee(((r,i)=>{const a=oh(i),o=OP(this.serializer,a);return t.put(o)}))}Ci(e,t){const r=t.store(Xl),i=[];return r.ee(((a,o)=>{const c=t.store(O0),u=(function(p){return p.document?new Me(Bt.fromString(p.document.name).popFirst(5)):p.noDocument?Me.fromSegments(p.noDocument.path):p.unknownDocument?Me.fromSegments(p.unknownDocument.path):Be(36783)})(o).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(d))})).next((()=>ae.waitFor(i)))}Fi(e,t){const r=t.store(aa),i=$P(this.serializer),a=new Bw(Lv.mi,this.serializer.yt);return r.J().next((o=>{const c=new Map;return o.forEach((u=>{let d=c.get(u.userId)??wt();Jl(this.serializer,u).keys().forEach((h=>d=d.add(h))),c.set(u.userId,d)})),ae.forEach(c,((u,d)=>{const h=new xr(d),p=jv.wt(this.serializer,h),m=a.getIndexManager(h),b=zv.wt(h,this.serializer,m,a.referenceDelegate);return new YP(i,b,p,m).recalculateAndSaveOverlaysForDocumentKeys(new j1(t,zi.ce),u).next()}))}))}}function oR(n){n.createObjectStore(dd,{keyPath:i7}).createIndex(Ew,a7,{unique:!0}),n.createObjectStore(ud,{keyPath:"targetId"}).createIndex(PM,r7,{unique:!0}),n.createObjectStore(fc)}const Po="IndexedDbPersistence",Rx=18e5,Dx=5e3,kx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",FG="main";class Uw{constructor(e,t,r,i,a,o,c,u,d,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=a,this.window=o,this.document=c,this.xi=d,this.Oi=h,this.Ni=p,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Uw.v())throw new Ie(ge.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new RG(this,i),this.$i=t+FG,this.serializer=new PP(u),this.Ui=new el(this.$i,this.Ni,new UG(this.serializer)),this.hi=new vG,this.Pi=new TG(this.referenceDelegate,this.serializer),this.remoteDocumentCache=$P(this.serializer),this.Ii=new mG,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&zr(Po,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ie(ge.FAILED_PRECONDITION,kx);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new zi(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Rm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(gl(e))return Te(Po,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Te(Po,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Jf(e).get(Cu).next((t=>ae.resolve(this.es(t))))}ts(e){return Rm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Rx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=ar(t,fd);return r.J().next((i=>{const a=this.ss(i,Rx),o=i.filter((c=>a.indexOf(c)===-1));return ae.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ae.resolve(!0):Jf(e).get(Cu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Dx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ie(ge.FAILED_PRECONDITION,kx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Rm(e).J().next((r=>this.ss(r,Dx).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Te(Po,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Ep,fd],(e=>{const t=new j1(e,zi.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Rm(e).J().next((t=>this.ss(t,Rx).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return zv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new SG(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return jv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){Te(Po,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(u){return u===18?w7:u===17?UM:u===16?_7:u===15?Aw:u===14?BM:u===13?LM:u===12?x7:u===11?zM:void Be(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,a,(c=>(o=new j1(c,this.ci?this.ci.next():zi.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw zr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ie(ge.FAILED_PRECONDITION,RM);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return Jf(e).get(Cu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Dx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ie(ge.FAILED_PRECONDITION,kx)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Jf(e).put(Cu,t)}static v(){return el.v()}Zi(e){const t=Jf(e);return t.get(Cu).next((r=>this.es(r)?(Te(Po,"Releasing primary lease."),t.delete(Cu)):ae.resolve()))}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(zr(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;AN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Te(Po,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return zr(Po,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){zr("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Jf(n){return ar(n,Ep)}function Rm(n){return ar(n,fd)}function GG(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Fw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=wt(),i=wt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Fw(e,t.fromCache,r,i)}}class qG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class KP{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return AN()?8:kM(ir())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.ys(e,t).next((o=>{a.result=o})).next((()=>{if(!a.result)return this.ws(e,t,i,r).next((o=>{a.result=o}))})).next((()=>{if(a.result)return;const o=new qG;return this.Ss(e,t,o).next((c=>{if(a.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>a.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(Pu()<=Rt.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",Ou(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(Pu()<=Rt.DEBUG&&Te("QueryEngine","Query:",Ou(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Pu()<=Rt.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",Ou(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bi(t))):ae.resolve())}ys(e,t){if(kI(t))return ae.resolve(null);let r=Bi(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=B0(t,null,"F"),r=Bi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const o=wt(...a);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const d=this.Ds(t,c);return this.Cs(t,d,o,u.readTime)?this.ys(e,B0(t,null,"F")):this.vs(e,d,t,u)}))))})))))}ws(e,t,r,i){return kI(t)||i.isEqual(Xe.min())?ae.resolve(null):this.ps.getDocuments(e,r).next((a=>{const o=this.Ds(t,a);return this.Cs(t,o,r,i)?ae.resolve(null):(Pu()<=Rt.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ou(t)),this.vs(e,o,t,HF(i,Bh)).next((c=>c)))}))}Ds(e,t){let r=new $t(oP(e));return t.forEach(((i,a)=>{Ap(e,a)&&(r=r.add(a))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,t,r){return Pu()<=Rt.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",Ou(t)),this.ps.getDocumentsMatchingQuery(e,t,yi.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((o=>{a=a.insert(o.key,o)})),a)))}}const Gw="LocalStore",HG=3e8;class $G{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new mn(ut),this.xs=new Ys((a=>Tc(a)),Sp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function XP(n,e,t,r){return new $G(n,e,t,r)}async function WP(n,e){const t=ft(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const o=[],c=[];let u=wt();for(const d of i){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of a){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:c})))}))}))}function YG(n,e){const t=ft(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,d,h){const p=d.batch,m=p.keys();let b=ae.resolve();return m.forEach((_=>{b=b.next((()=>h.getEntry(u,_))).next((w=>{const S=d.docVersions.get(_);Ge(S!==null,48541),w.version.compareTo(S)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(u,p)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=wt();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function QP(n){const e=ft(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function KG(n,e){const t=ft(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((h,p)=>{const m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(a,h.removedDocuments,p).next((()=>t.Pi.addMatchingKeys(a,h.addedDocuments,p))));let b=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(Xn.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,r)),i=i.insert(p,b),(function(w,S,T){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=HG?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(m,b,h)&&c.push(t.Pi.updateTargetData(a,b))}));let u=vi(),d=wt();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,h))})),c.push(XG(a,o,e.documentUpdates).next((h=>{u=h.ks,d=h.qs}))),!r.isEqual(Xe.min())){const h=t.Pi.getLastRemoteSnapshotVersion(a).next((p=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,r)));c.push(h)}return ae.waitFor(c).next((()=>o.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,u,d))).next((()=>u))})).then((a=>(t.Ms=i,a)))}function XG(n,e,t){let r=wt(),i=wt();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let o=vi();return t.forEach(((c,u)=>{const d=a.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Xe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Te(Gw,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function WG(n,e){const t=ft(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=dc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function QG(n,e){const t=ft(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((a=>a?(i=a,ae.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new Cs(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Q1(n,e,t){const r=ft(n),i=r.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!gl(o))throw o;Te(Gw,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function lR(n,e,t){const r=ft(n);let i=Xe.min(),a=wt();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,d,h){const p=ft(u),m=p.xs.get(h);return m!==void 0?ae.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)})(r,o,Bi(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{a=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:Xe.min(),t?a:wt()))).next((c=>(ZG(r,j7(e),c),{documents:c,Qs:a})))))}function ZG(n,e,t){let r=n.Os.get(e)||Xe.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Os.set(e,r)}class cR{constructor(){this.activeTargetIds=G7()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZP{constructor(){this.Mo=new cR,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new cR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class JG{Oo(e){}shutdown(){}}const uR="ConnectivityMonitor";class dR{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(uR,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(uR,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Dm=null;function Z1(){return Dm===null?Dm=(function(){return 268435456+Math.round(2147483648*Math.random())})():Dm++,"0x"+Dm.toString(16)}const Nx="RestConnection",eq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class tq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===j0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,a){const o=Z1(),c=this.zo(e,t.toUriEncodedString());Te(Nx,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,a);const{host:d}=new URL(c),h=Md(d);return this.Jo(e,c,u,r,h).then((p=>(Te(Nx,`Received RPC '${e}' ${o}: `,p),p)),(p=>{throw Ec(Nx,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p}))}Ho(e,t,r,i,a,o){return this.Go(e,t,r,i,a)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Od})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}zo(e,t){const r=eq[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class nq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Sr="WebChannelConnection";class rq extends tq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,a){const o=Z1();return new Promise(((c,u)=>{const d=new yM;d.setWithCredentials(!0),d.listenOnce(bM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case t0.NO_ERROR:const p=d.getResponseJson();Te(Sr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case t0.TIMEOUT:Te(Sr,`RPC '${e}' ${o} timed out`),u(new Ie(ge.DEADLINE_EXCEEDED,"Request time out"));break;case t0.HTTP_ERROR:const m=d.getStatus();if(Te(Sr,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const _=b?.error;if(_&&_.status&&_.message){const w=(function(T){const C=T.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(C)>=0?C:ge.UNKNOWN})(_.status);u(new Ie(w,_.message))}else u(new Ie(ge.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Ie(ge.UNAVAILABLE,"Connection failed."));break;default:Be(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Te(Sr,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(i);Te(Sr,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)}))}T_(e,t,r){const i=Z1(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=wM(),c=_M(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const h=a.join("");Te(Sr,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let m=!1,b=!1;const _=new nq({Yo:S=>{b?Te(Sr,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Te(Sr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),Te(Sr,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),w=(S,T,C)=>{S.listen(T,(D=>{try{C(D)}catch(M){setTimeout((()=>{throw M}),0)}}))};return w(p,ih.EventType.OPEN,(()=>{b||(Te(Sr,`RPC '${e}' stream ${i} transport opened.`),_.o_())})),w(p,ih.EventType.CLOSE,(()=>{b||(b=!0,Te(Sr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(p))})),w(p,ih.EventType.ERROR,(S=>{b||(b=!0,Ec(Sr,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),_.a_(new Ie(ge.UNAVAILABLE,"The operation could not be completed")))})),w(p,ih.EventType.MESSAGE,(S=>{if(!b){const T=S.data[0];Ge(!!T,16349);const C=T,D=C?.error||C[0]?.error;if(D){Te(Sr,`RPC '${e}' stream ${i} received error:`,D);const M=D.status;let j=(function(I){const k=Hn[I];if(k!==void 0)return xP(k)})(M),z=D.message;j===void 0&&(j=ge.INTERNAL,z="Unknown error status: "+M+" with message "+D.message),b=!0,_.a_(new Ie(j,z)),p.close()}else Te(Sr,`RPC '${e}' stream ${i} received:`,T),_.u_(T)}})),w(c,xM.STAT_EVENT,(S=>{S.stat===k1.PROXY?Te(Sr,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===k1.NOPROXY&&Te(Sr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{_.__()}),0),_}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function iq(){return typeof window<"u"?window:null}function d0(){return typeof document<"u"?document:null}function Bv(n){return new aG(n,!0)}class JP{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const fR="PersistentStream";class eO{constructor(e,t,r,i,a,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new JP(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ge.RESOURCE_EXHAUSTED?(zr(t.toString()),zr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Ie(ge.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te(fR,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Te(fR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class aq extends eO{constructor(e,t,r,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=lG(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Xe.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?Xe.min():o.readTime?Ur(o.readTime):Xe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=$1(this.serializer),t.addTarget=(function(a,o){let c;const u=o.target;if(c=z0(u)?{documents:IP(a,u)}:{query:RP(a,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=EP(a,o.resumeToken);const d=q1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(Xe.min())>0){c.readTime=yd(a,o.snapshotVersion.toTimestamp());const d=q1(a,o.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);const r=uG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=$1(this.serializer),t.removeTarget=e,this.q_(t)}}class sq extends eO{constructor(e,t,r,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ge(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ge(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ge(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=cG(e.writeResults,e.commitTime),r=Ur(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=$1(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>F0(this.serializer,r)))};this.q_(t)}}class oq{}class lq extends oq{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Go(e,H1(t,r),i,a,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ie(ge.UNKNOWN,a.toString())}))}Ho(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,H1(t,r),i,o,c,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ie(ge.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class cq{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(zr(t),this.aa=!1):Te("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Dc="RemoteStore";class uq{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{zc(this)&&(Te(Dc,"Restarting streams for network reachability change."),await(async function(u){const d=ft(u);d.Ea.add(4),await Rp(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Uv(d)})(this))}))})),this.Ra=new cq(r,i)}}async function Uv(n){if(zc(n))for(const e of n.da)await e(!0)}async function Rp(n){for(const e of n.da)await e(!1)}function tO(n,e){const t=ft(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Yw(t)?$w(t):zd(t).O_()&&Hw(t,e))}function qw(n,e){const t=ft(n),r=zd(t);t.Ia.delete(e),r.O_()&&nO(t,e),t.Ia.size===0&&(r.O_()?r.L_():zc(t)&&t.Ra.set("Unknown"))}function Hw(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zd(n).Y_(e)}function nO(n,e){n.Va.Ue(e),zd(n).Z_(e)}function $w(n){n.Va=new tG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),zd(n).start(),n.Ra.ua()}function Yw(n){return zc(n)&&!zd(n).x_()&&n.Ia.size>0}function zc(n){return ft(n).Ea.size===0}function rO(n){n.Va=void 0}async function dq(n){n.Ra.set("Online")}async function fq(n){n.Ia.forEach(((e,t)=>{Hw(n,e)}))}async function hq(n,e){rO(n),Yw(n)?(n.Ra.ha(e),$w(n)):n.Ra.set("Unknown")}async function pq(n,e,t){if(n.Ra.set("Online"),e instanceof wP&&e.state===2&&e.cause)try{await(async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Te(Dc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Y0(n,r)}else if(e instanceof c0?n.Va.Ze(e):e instanceof _P?n.Va.st(e):n.Va.tt(e),!t.isEqual(Xe.min()))try{const r=await QP(n.localStore);t.compareTo(r)>=0&&await(function(a,o){const c=a.Va.Tt(o);return c.targetChanges.forEach(((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=a.Ia.get(d);h&&a.Ia.set(d,h.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,d)=>{const h=a.Ia.get(u);if(!h)return;a.Ia.set(u,h.withResumeToken(Xn.EMPTY_BYTE_STRING,h.snapshotVersion)),nO(a,u);const p=new Cs(h.target,u,d,h.sequenceNumber);Hw(a,p)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Te(Dc,"Failed to raise snapshot:",r),await Y0(n,r)}}async function Y0(n,e,t){if(!gl(e))throw e;n.Ea.add(1),await Rp(n),n.Ra.set("Offline"),t||(t=()=>QP(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Te(Dc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Uv(n)}))}function iO(n,e){return e().catch((t=>Y0(n,t,e)))}async function Dp(n){const e=ft(n),t=sl(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:dc;for(;gq(e);)try{const i=await WG(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,mq(e,i)}catch(i){await Y0(e,i)}aO(e)&&sO(e)}function gq(n){return zc(n)&&n.Ta.length<10}function mq(n,e){n.Ta.push(e);const t=sl(n);t.O_()&&t.X_&&t.ea(e.mutations)}function aO(n){return zc(n)&&!sl(n).x_()&&n.Ta.length>0}function sO(n){sl(n).start()}async function vq(n){sl(n).ra()}async function yq(n){const e=sl(n);for(const t of n.Ta)e.ea(t.mutations)}async function bq(n,e,t){const r=n.Ta.shift(),i=Mw.from(r,e,t);await iO(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Dp(n)}async function xq(n,e){e&&sl(n).X_&&await(async function(r,i){if((function(o){return Z7(o)&&o!==ge.ABORTED})(i.code)){const a=r.Ta.shift();sl(r).B_(),await iO(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Dp(r)}})(n,e),aO(n)&&sO(n)}async function hR(n,e){const t=ft(n);t.asyncQueue.verifyOperationInProgress(),Te(Dc,"RemoteStore received new credentials");const r=zc(t);t.Ea.add(3),await Rp(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Uv(t)}async function _q(n,e){const t=ft(n);e?(t.Ea.delete(2),await Uv(t)):e||(t.Ea.add(2),await Rp(t),t.Ra.set("Unknown"))}function zd(n){return n.ma||(n.ma=(function(t,r,i){const a=ft(t);return a.sa(),new aq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:dq.bind(null,n),t_:fq.bind(null,n),r_:hq.bind(null,n),H_:pq.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Yw(n)?$w(n):n.Ra.set("Unknown")):(await n.ma.stop(),rO(n))}))),n.ma}function sl(n){return n.fa||(n.fa=(function(t,r,i){const a=ft(t);return a.sa(),new sq(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:vq.bind(null,n),r_:xq.bind(null,n),ta:yq.bind(null,n),na:bq.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Dp(n)):(await n.fa.stop(),n.Ta.length>0&&(Te(Dc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Kw{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Ka,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const o=Date.now()+r,c=new Kw(e,t,o,i,a);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xw(n,e){if(zr("AsyncQueue",`${e}: ${n}`),gl(n))return new Ie(ge.UNAVAILABLE,`${e}: ${n}`);throw n}class nd{static emptySet(e){return new nd(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Me.comparator(t.key,r.key):(t,r)=>Me.comparator(t.key,r.key),this.keyedMap=ah(),this.sortedSet=new mn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof nd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new nd;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class pR{constructor(){this.ga=new mn(Me.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Be(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class bd{constructor(e,t,r,i,a,o,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,a){const o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new bd(e,t,nd.emptySet(t),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class wq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Eq{constructor(){this.queries=gR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=ft(t),a=i.queries;i.queries=gR(),a.forEach(((o,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new Ie(ge.ABORTED,"Firestore shutting down"))}}function gR(){return new Ys((n=>sP(n)),Mv)}async function Ww(n,e){const t=ft(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.ba()&&e.Da()&&(r=2):(a=new wq,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const c=Xw(o,`Initialization of query '${Ou(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&Zw(t)}async function Qw(n,e){const t=ft(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const o=a.Sa.indexOf(e);o>=0&&(a.Sa.splice(o,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Sq(n,e){const t=ft(n);let r=!1;for(const i of e){const a=i.query,o=t.queries.get(a);if(o){for(const c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&Zw(t)}function Tq(n,e,t){const r=ft(n),i=r.queries.get(e);if(i)for(const a of i.Sa)a.onError(t);r.queries.delete(e)}function Zw(n){n.Ca.forEach((e=>{e.next()}))}var J1,mR;(mR=J1||(J1={})).Ma="default",mR.Cache="cache";class Jw{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new bd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=bd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==J1.Cache}}class oO{constructor(e){this.key=e}}class lO{constructor(e){this.key=e}}class Aq{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=wt(),this.mutatedKeys=wt(),this.eu=oP(e),this.tu=new nd(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new pR,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((h,p)=>{const m=i.get(h),b=Ap(this.query,p)?p:null,_=!!m&&this.mutatedKeys.has(m.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let S=!1;m&&b?m.data.isEqual(b.data)?_!==w&&(r.track({type:3,doc:b}),S=!0):this.su(m,b)||(r.track({type:2,doc:b}),S=!0,(u&&this.eu(b,u)>0||d&&this.eu(b,d)<0)&&(c=!0)):!m&&b?(r.track({type:0,doc:b}),S=!0):m&&!b&&(r.track({type:1,doc:m}),S=!0,(u||d)&&(c=!0)),S&&(b?(o=o.add(b),a=w?a.add(h):a.delete(h)):(o=o.delete(h),a=a.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),a=a.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,p)=>(function(b,_){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Be(20277,{Rt:S})}};return w(b)-w(_)})(h.type,p.type)||this.eu(h.doc,p.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new bd(this.query,e.tu,a,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new pR,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=wt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new lO(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new oO(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=wt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return bd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const eE="SyncEngine";class Cq{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Iq{constructor(e){this.key=e,this.hu=!1}}class Rq{constructor(e,t,r,i,a,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ys((c=>sP(c)),Mv),this.Iu=new Map,this.Eu=new Set,this.du=new mn(Me.comparator),this.Au=new Map,this.Ru=new Lw,this.Vu={},this.mu=new Map,this.fu=Rc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Dq(n,e,t=!0){const r=pO(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await cO(r,e,t,!0),i}async function kq(n,e){const t=pO(n);await cO(t,e,!0,!1)}async function cO(n,e,t,r){const i=await QG(n.localStore,Bi(e)),a=i.targetId,o=n.sharedClientState.addLocalQueryTarget(a,t);let c;return r&&(c=await Nq(n,e,a,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&tO(n.remoteStore,i),c}async function Nq(n,e,t,r,i){n.pu=(p,m,b)=>(async function(w,S,T,C){let D=S.view.ru(T);D.Cs&&(D=await lR(w.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,D))));const M=C&&C.targetChanges.get(S.targetId),j=C&&C.targetMismatches.get(S.targetId)!=null,z=S.view.applyChanges(D,w.isPrimaryClient,M,j);return yR(w,S.targetId,z.au),z.snapshot})(n,p,m,b);const a=await lR(n.localStore,e,!0),o=new Aq(e,a.Qs),c=o.ru(a.documents),u=Ip.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(c,n.isPrimaryClient,u);yR(n,t,d.au);const h=new Cq(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function Mq(n,e,t){const r=ft(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((o=>!Mv(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Q1(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&qw(r.remoteStore,i.targetId),e_(r,i.targetId)})).catch(jc)):(e_(r,i.targetId),await Q1(r.localStore,i.targetId,!0))}async function Pq(n,e){const t=ft(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),qw(t.remoteStore,r.targetId))}async function Oq(n,e,t){const r=gO(n);try{const i=await(function(o,c){const u=ft(o),d=_t.now(),h=c.reduce(((b,_)=>b.add(_.key)),wt());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let _=vi(),w=wt();return u.Ns.getEntries(b,h).next((S=>{_=S,_.forEach(((T,C)=>{C.isValidDocument()||(w=w.add(T))}))})).next((()=>u.localDocuments.getOverlayedDocuments(b,_))).next((S=>{p=S;const T=[];for(const C of c){const D=W7(C,p.get(C.key).overlayedDocument);D!=null&&T.push(new Ks(C.key,D,QM(D.value.mapValue),rr.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,T,c)})).next((S=>{m=S;const T=S.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(b,S.batchId,T)}))})).then((()=>({batchId:m.batchId,changes:cP(p)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new mn(ut)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await kp(r,i.changes),await Dp(r.remoteStore)}catch(i){const a=Xw(i,"Failed to persist write");t.reject(a)}}async function uO(n,e){const t=ft(n);try{const r=await KG(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const o=t.Au.get(a);o&&(Ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ge(o.hu,14607):i.removedDocuments.size>0&&(Ge(o.hu,42227),o.hu=!1))})),await kp(t,r,e)}catch(r){await jc(r)}}function vR(n,e,t){const r=ft(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){const u=ft(o);u.onlineState=c;let d=!1;u.queries.forEach(((h,p)=>{for(const m of p.Sa)m.va(c)&&(d=!0)})),d&&Zw(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Vq(n,e,t){const r=ft(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let o=new mn(Me.comparator);o=o.insert(a,Cn.newNoDocument(a,Xe.min()));const c=wt().add(a),u=new Vv(Xe.min(),new Map,new mn(ut),o,c);await uO(r,u),r.du=r.du.remove(a),r.Au.delete(e),tE(r)}else await Q1(r.localStore,e,!1).then((()=>e_(r,e,t))).catch(jc)}async function jq(n,e){const t=ft(n),r=e.batch.batchId;try{const i=await YG(t.localStore,e);fO(t,r,null),dO(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await kp(t,i)}catch(i){await jc(i)}}async function zq(n,e,t){const r=ft(n);try{const i=await(function(o,c){const u=ft(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next((p=>(Ge(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p)))).next((()=>u.mutationQueue.performConsistencyCheck(d))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h))).next((()=>u.localDocuments.getDocuments(d,h)))}))})(r.localStore,e);fO(r,e,t),dO(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await kp(r,i)}catch(i){await jc(i)}}function dO(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function fO(n,e,t){const r=ft(n);let i=r.Vu[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function e_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||hO(n,r)}))}function hO(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(qw(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),tE(n))}function yR(n,e,t){for(const r of t)r instanceof oO?(n.Ru.addReference(r.key,e),Lq(n,r)):r instanceof lO?(Te(eE,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||hO(n,r.key)):Be(19791,{wu:r})}function Lq(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Te(eE,"New document in limbo: "+t),n.Eu.add(r),tE(n))}function tE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Me(Bt.fromString(e)),r=n.fu.next();n.Au.set(r,new Iq(t)),n.du=n.du.insert(t,r),tO(n.remoteStore,new Cs(Bi(Tp(t.path)),r,"TargetPurposeLimboResolution",zi.ce))}}async function kp(n,e,t){const r=ft(n),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const h=d?!d.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(d){i.push(d);const h=Fw.As(u.targetId,d);a.push(h)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,d){const h=ft(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>ae.forEach(d,(m=>ae.forEach(m.Es,(b=>h.persistence.referenceDelegate.addReference(p,m.targetId,b))).next((()=>ae.forEach(m.ds,(b=>h.persistence.referenceDelegate.removeReference(p,m.targetId,b)))))))))}catch(p){if(!gl(p))throw p;Te(Gw,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const b=h.Ms.get(m),_=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(_);h.Ms=h.Ms.insert(m,w)}}})(r.localStore,a))}async function Bq(n,e){const t=ft(n);if(!t.currentUser.isEqual(e)){Te(eE,"User change. New user:",e.toKey());const r=await WP(t.localStore,e);t.currentUser=e,(function(a,o){a.mu.forEach((c=>{c.forEach((u=>{u.reject(new Ie(ge.CANCELLED,o))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await kp(t,r.Ls)}}function Uq(n,e){const t=ft(n),r=t.Au.get(e);if(r&&r.hu)return wt().add(r.key);{let i=wt();const a=t.Iu.get(e);if(!a)return i;for(const o of a){const c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function pO(n){const e=ft(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=uO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Uq.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vq.bind(null,e),e.Pu.H_=Sq.bind(null,e.eventManager),e.Pu.yu=Tq.bind(null,e.eventManager),e}function gO(n){const e=ft(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jq.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zq.bind(null,e),e}class Jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bv(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return XP(this.persistence,new KP,e.initialUser,this.serializer)}Cu(e){return new Bw(Lv.mi,this.serializer)}Du(e){return new ZP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jh.provider={build:()=>new Jh};class Fq extends Jh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ge(this.persistence.referenceDelegate instanceof $0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new GP(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new Bw((r=>$0.mi(r,t)),this.serializer)}}class Gq extends Jh{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await gO(this.xu.syncEngine),await Dp(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return XP(this.persistence,new KP,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new GP(r,e.asyncQueue,t)}Mu(e,t){const r=new XF(t,this.persistence);return new KF(e.asyncQueue,r)}Cu(e){const t=GG(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new Uw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,iq(),d0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ZP}}class K0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>vR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Bq.bind(null,this.syncEngine),await _q(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Eq})()}createDatastore(e){const t=Bv(e.databaseInfo.databaseId),r=(function(a){return new rq(a)})(e.databaseInfo);return(function(a,o,c,u){return new lq(a,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,o,c){return new uq(r,i,a,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>vR(this.syncEngine,t,0)),(function(){return dR.v()?new dR:new JG})())}createSyncEngine(e,t){return(function(i,a,o,c,u,d,h){const p=new Rq(i,a,o,c,u,d);return h&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=ft(t);Te(Dc,"RemoteStore shutting down."),r.Ea.add(5),await Rp(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}K0.provider={build:()=>new K0};class nE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):zr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ol="FirestoreClient";class qq{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=xr.UNAUTHENTICATED,this.clientId=xw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async o=>{Te(ol,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(Te(ol,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ka;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Xw(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Mx(n,e){n.asyncQueue.verifyOperationInProgress(),Te(ol,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await WP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function bR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Hq(n);Te(ol,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>hR(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>hR(e.remoteStore,i))),n._onlineComponents=e}async function Hq(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Te(ol,"Using user provided OfflineComponentProvider");try{await Mx(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ge.FAILED_PRECONDITION||i.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Ec("Error using user provided cache. Falling back to memory cache: "+t),await Mx(n,new Jh)}}else Te(ol,"Using default OfflineComponentProvider"),await Mx(n,new Fq(void 0));return n._offlineComponents}async function mO(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Te(ol,"Using user provided OnlineComponentProvider"),await bR(n,n._uninitializedComponentsProvider._online)):(Te(ol,"Using default OnlineComponentProvider"),await bR(n,new K0))),n._onlineComponents}function $q(n){return mO(n).then((e=>e.syncEngine))}async function X0(n){const e=await mO(n),t=e.eventManager;return t.onListen=Dq.bind(null,e.syncEngine),t.onUnlisten=Mq.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=kq.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Pq.bind(null,e.syncEngine),t}function Yq(n,e,t={}){const r=new Ka;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new nE({next:m=>{h.Nu(),o.enqueueAndForget((()=>Qw(a,p)));const b=m.docs.has(c);!b&&m.fromCache?d.reject(new Ie(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&m.fromCache&&u&&u.source==="server"?d.reject(new Ie(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Jw(Tp(c.path),h,{includeMetadataChanges:!0,qa:!0});return Ww(a,p)})(await X0(n),n.asyncQueue,e,t,r))),r.promise}function Kq(n,e,t={}){const r=new Ka;return n.asyncQueue.enqueueAndForget((async()=>(function(a,o,c,u,d){const h=new nE({next:m=>{h.Nu(),o.enqueueAndForget((()=>Qw(a,p))),m.fromCache&&u.source==="server"?d.reject(new Ie(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new Jw(c,h,{includeMetadataChanges:!0,qa:!0});return Ww(a,p)})(await X0(n),n.asyncQueue,e,t,r))),r.promise}function vO(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const xR=new Map;const yO="firestore.googleapis.com",_R=!0;class wR{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yO,this.ssl=_R}else this.host=e.host,this.ssl=e.ssl??_R;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=LP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<AG)throw new Ie(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vO(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ie(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new PF;switch(r.type){case"firstParty":return new zF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ie(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=xR.get(t);r&&(Te("ComponentProvider","Removing Datastore"),xR.delete(t),r.terminate())})(this),Promise.resolve()}}function Xq(n,e,t,r={}){n=Ir(n,Fv);const i=Md(e),a=n._getSettings(),o={...a,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(EN(`https://${c}`),SN("Firestore",!0)),a.host!==yO&&a.host!==c&&Ec("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...a,host:c,ssl:i,emulatorOptions:r};if(!rl(u,o)&&(n._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=xr.MOCK_USER;else{d=F9(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ie(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new xr(p)}n._authCredentials=new OF(new SM(d,h))}}class Xs{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Xs(this.firestore,e,this._query)}}class In{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new In(this.firestore,e,this._key)}toJSON(){return{type:In._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(wp(t,In._jsonSchema))return new In(e,r||null,new Me(Bt.fromString(t.referencePath)))}}In._jsonSchemaVersion="firestore/documentReference/1.0",In._jsonSchema={type:Kn("string",In._jsonSchemaVersion),referencePath:Kn("string")};class tl extends Xs{constructor(e,t,r){super(e,t,Tp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new In(this.firestore,null,new Me(e))}withConverter(e){return new tl(this.firestore,e,this._path)}}function Oi(n,e,...t){if(n=un(n),AM("collection","path",e),n instanceof Fv){const r=Bt.fromString(e,...t);return fI(r),new tl(n,null,r)}{if(!(n instanceof In||n instanceof tl))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Bt.fromString(e,...t));return fI(r),new tl(n.firestore,null,r)}}function Ut(n,e,...t){if(n=un(n),arguments.length===1&&(e=xw.newId()),AM("doc","path",e),n instanceof Fv){const r=Bt.fromString(e,...t);return dI(r),new In(n,null,new Me(r))}{if(!(n instanceof In||n instanceof tl))throw new Ie(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Bt.fromString(e,...t));return dI(r),new In(n.firestore,n instanceof tl?n.converter:null,new Me(r))}}const ER="AsyncQueue";class SR{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new JP(this,"async_queue_retry"),this._c=()=>{const r=d0();r&&Te(ER,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=d0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=d0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ka;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!gl(e))throw e;Te(ER,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,zr("INTERNAL UNHANDLED ERROR: ",TR(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Kw.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&Be(47125,{Pc:TR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function TR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function AR(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}class pa extends Fv{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new SR,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new SR(e),this._firestoreClient=void 0,await e}}}function Wq(n,e){const t=typeof n=="object"?n:NN(),r=typeof n=="string"?n:j0,i=uw(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=B9("firestore");a&&Xq(i,...a)}return i}function Np(n){if(n._terminated)throw new Ie(ge.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bO(n),n._firestoreClient}function bO(n){const e=n._freezeSettings(),t=(function(i,a,o,c){return new S7(i,a,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,vO(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new qq(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}})(n._componentsProvider))}function Qq(n,e){Ec("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Zq(n,K0.provider,{build:r=>new Gq(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function Zq(n,e,t){if((n=Ir(n,pa))._firestoreClient||n._terminated)throw new Ie(ge.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ie(ge.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},bO(n)}class ji{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ji(Xn.fromBase64String(e))}catch(t){throw new Ie(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ji(Xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ji._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wp(e,ji._jsonSchema))return ji.fromBase64String(e.bytes)}}ji._jsonSchemaVersion="firestore/bytes/1.0",ji._jsonSchema={type:Kn("string",ji._jsonSchemaVersion),bytes:Kn("string")};class Mp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Gv{constructor(e){this._methodName=e}}class Xa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ut(this._lat,e._lat)||ut(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Xa._jsonSchemaVersion}}static fromJSON(e){if(wp(e,Xa._jsonSchema))return new Xa(e.latitude,e.longitude)}}Xa._jsonSchemaVersion="firestore/geoPoint/1.0",Xa._jsonSchema={type:Kn("string",Xa._jsonSchemaVersion),latitude:Kn("number"),longitude:Kn("number")};class Wa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Wa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wp(e,Wa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Wa(e.vectorValues);throw new Ie(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Wa._jsonSchemaVersion="firestore/vectorValue/1.0",Wa._jsonSchema={type:Kn("string",Wa._jsonSchemaVersion),vectorValues:Kn("object")};const Jq=/^__.*__$/;class eH{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ks(e,this.data,this.fieldMask,t,this.fieldTransforms):new jd(e,this.data,t,this.fieldTransforms)}}class xO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ks(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function _O(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Be(40011,{Ac:n})}}class qv{constructor(e,t,r,i,a,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return W0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(_O(this.Ac)&&Jq.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class tH{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Bv(e)}Cc(e,t,r,i=!1){return new qv({Ac:e,methodName:t,Dc:r,path:yn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pp(n){const e=n._freezeSettings(),t=Bv(n._databaseId);return new tH(n._databaseId,!!e.ignoreUndefinedProperties,t)}function rE(n,e,t,r,i,a={}){const o=n.Cc(a.merge||a.mergeFields?2:0,e,t,i);aE("Data must be an object, but it was:",o,r);const c=SO(r,o);let u,d;if(a.merge)u=new Qr(o.fieldMask),d=o.fieldTransforms;else if(a.mergeFields){const h=[];for(const p of a.mergeFields){const m=t_(e,p,t);if(!o.contains(m))throw new Ie(ge.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);AO(h,m)||h.push(m)}u=new Qr(h),d=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,d=o.fieldTransforms;return new eH(new Ar(c),u,d)}class Op extends Gv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Op}}function nH(n,e,t){return new qv({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class iE extends Gv{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=nH(this,e,!0),r=this.vc.map((a=>Ld(a,t))),i=new Ac(r);return new mP(e.path,i)}isEqual(e){return e instanceof iE&&rl(this.vc,e.vc)}}function wO(n,e,t,r){const i=n.Cc(1,e,t);aE("Data must be an object, but it was:",i,r);const a=[],o=Ar.empty();ml(r,((u,d)=>{const h=sE(e,u,t);d=un(d);const p=i.yc(h);if(d instanceof Op)a.push(h);else{const m=Ld(d,p);m!=null&&(a.push(h),o.set(h,m))}}));const c=new Qr(a);return new xO(o,c,i.fieldTransforms)}function EO(n,e,t,r,i,a){const o=n.Cc(1,e,t),c=[t_(e,r,t)],u=[i];if(a.length%2!=0)throw new Ie(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)c.push(t_(e,a[m])),u.push(a[m+1]);const d=[],h=Ar.empty();for(let m=c.length-1;m>=0;--m)if(!AO(d,c[m])){const b=c[m];let _=u[m];_=un(_);const w=o.yc(b);if(_ instanceof Op)d.push(b);else{const S=Ld(_,w);S!=null&&(d.push(b),h.set(b,S))}}const p=new Qr(d);return new xO(h,p,o.fieldTransforms)}function rH(n,e,t,r=!1){return Ld(t,n.Cc(r?4:3,e))}function Ld(n,e){if(TO(n=un(n)))return aE("Unsupported field value:",e,n),SO(n,e);if(n instanceof Gv)return(function(r,i){if(!_O(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const a=[];let o=0;for(const c of r){let u=Ld(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=un(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return q7(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=_t.fromDate(r);return{timestampValue:yd(i.serializer,a)}}if(r instanceof _t){const a=new _t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:yd(i.serializer,a)}}if(r instanceof Xa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ji)return{bytesValue:EP(i.serializer,r._byteString)};if(r instanceof In){const a=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(a))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Vw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Wa)return(function(o,c){return{mapValue:{fields:{[Iw]:{stringValue:Rw},[hd]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return kw(c.serializer,d)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Tv(r)}`)})(n,e)}function SO(n,e){const t={};return FM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ml(n,((r,i)=>{const a=Ld(i,e.mc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function TO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof _t||n instanceof Xa||n instanceof ji||n instanceof In||n instanceof Gv||n instanceof Wa)}function aE(n,e,t){if(!TO(t)||!CM(t)){const r=Tv(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function t_(n,e,t){if((e=un(e))instanceof Mp)return e._internalPath;if(typeof e=="string")return sE(n,e);throw W0("Field path arguments must be of type string or ",n,!1,void 0,t)}const iH=new RegExp("[~\\*/\\[\\]]");function sE(n,e,t){if(e.search(iH)>=0)throw W0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Mp(...e.split("."))._internalPath}catch{throw W0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function W0(n,e,t,r,i){const a=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Ie(ge.INVALID_ARGUMENT,c+n+u)}function AO(n,e){return n.some((t=>t.isEqual(e)))}class CO{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new In(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new aH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Hv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class aH extends CO{data(){return super.data()}}function Hv(n,e){return typeof e=="string"?sE(n,e):e instanceof Mp?e._internalPath:e._delegate._internalPath}function IO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class oE{}class lE extends oE{}function Ls(n,e,...t){let r=[];e instanceof oE&&r.push(e),r=r.concat(t),(function(a){const o=a.filter((u=>u instanceof cE)).length,c=a.filter((u=>u instanceof $v)).length;if(o>1||o>0&&c>0)throw new Ie(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class $v extends lE{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new $v(e,t,r)}_apply(e){const t=this._parse(e);return RO(e._query,t),new Xs(e.firestore,e.converter,G1(e._query,t))}_parse(e){const t=Pp(e.firestore);return(function(a,o,c,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){RR(p,h);const _=[];for(const w of p)_.push(IR(u,a,w));m={arrayValue:{values:_}}}else m=IR(u,a,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||RR(p,h),m=rH(c,o,p,h==="in"||h==="not-in");return Dt.create(d,h,m)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function sH(n,e,t){const r=e,i=Hv("where",n);return $v._create(i,r,t)}class cE extends oE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new cE(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)RO(o,u),o=G1(o,u)})(e._query,t),new Xs(e.firestore,e.converter,G1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class uE extends lE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new uE(e,t)}_apply(e){const t=(function(i,a,o){if(i.startAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Wh(a,o)})(e._query,this._field,this._direction);return new Xs(e.firestore,e.converter,(function(i,a){const o=i.explicitOrderBy.concat([a]);return new Vd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function xd(n,e="asc"){const t=e,r=Hv("orderBy",n);return uE._create(r,t)}class dE extends lE{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new dE(e,t,r)}_apply(e){return new Xs(e.firestore,e.converter,B0(e._query,this._limit,this._limitType))}}function CR(n){return dE._create("limit",n,"F")}function IR(n,e,t){if(typeof(t=un(t))=="string"){if(t==="")throw new Ie(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aP(e)&&t.indexOf("/")!==-1)throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Bt.fromString(t));if(!Me.isDocumentKey(r))throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Kh(n,new Me(r))}if(t instanceof In)return Kh(n,t._key);throw new Ie(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Tv(t)}.`)}function RR(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function RO(n,e){const t=(function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class oH{convertValue(e,t="none"){switch(il(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Be(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ml(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){const t=e.fields?.[hd].arrayValue?.values?.map((r=>pn(r.doubleValue)));return new Wa(t)}convertGeoPoint(e){return new Xa(pn(e.latitude),pn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=kv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp($h(e));default:return null}}convertTimestamp(e){const t=js(e);return new _t(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Bt.fromString(e);Ge(MP(r),9688,{name:e});const i=new Sc(r.get(1),r.get(3)),a=new Me(r.popFirst(5));return i.isEqual(t)||zr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function fE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class lh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pc extends CO{constructor(e,t,r,i,a,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new f0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Hv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=pc._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}pc._jsonSchemaVersion="firestore/documentSnapshot/1.0",pc._jsonSchema={type:Kn("string",pc._jsonSchemaVersion),bundleSource:Kn("string","DocumentSnapshot"),bundleName:Kn("string"),bundle:Kn("string")};class f0 extends pc{data(e={}){return super.data(e)}}class gc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new lh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new f0(this._firestore,this._userDataWriter,r.key,r,new lh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{const u=new f0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new lh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const u=new f0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new lh(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:lH(c.type),doc:u,oldIndex:d,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function lH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Be(61501,{type:n})}}function Px(n){n=Ir(n,In);const e=Ir(n.firestore,pa);return Yq(Np(e),n._key).then((t=>DO(e,n,t)))}gc._jsonSchemaVersion="firestore/querySnapshot/1.0",gc._jsonSchema={type:Kn("string",gc._jsonSchemaVersion),bundleSource:Kn("string","QuerySnapshot"),bundleName:Kn("string"),bundle:Kn("string")};class hE extends oH{constructor(e){super(),this.firestore=e}convertBytes(e){return new ji(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new In(this.firestore,null,t)}}function Ba(n){n=Ir(n,Xs);const e=Ir(n.firestore,pa),t=Np(e),r=new hE(e);return IO(n._query),Kq(t,n._query).then((i=>new gc(e,r,n,i)))}function za(n,e,t){n=Ir(n,In);const r=Ir(n.firestore,pa),i=fE(n.converter,e,t);return jp(r,[rE(Pp(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rr.none())])}function sa(n,e,t,...r){n=Ir(n,In);const i=Ir(n.firestore,pa),a=Pp(i);let o;return o=typeof(e=un(e))=="string"||e instanceof Mp?EO(a,"updateDoc",n._key,e,t,r):wO(a,"updateDoc",n._key,e),jp(i,[o.toMutation(n._key,rr.exists(!0))])}function Ua(n){return jp(Ir(n.firestore,pa),[new Cp(n._key,rr.none())])}function Yv(n,e){const t=Ir(n.firestore,pa),r=Ut(n),i=fE(n.converter,e);return jp(t,[rE(Pp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,rr.exists(!1))]).then((()=>r))}function Vp(n,...e){n=un(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||AR(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(AR(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let a,o,c;if(n instanceof In)o=Ir(n.firestore,pa),c=Tp(n._key.path),a={next:u=>{e[r]&&e[r](DO(o,n,u))},error:e[r+1],complete:e[r+2]};else{const u=Ir(n,Xs);o=Ir(u.firestore,pa),c=u._query;const d=new hE(o);a={next:h=>{e[r]&&e[r](new gc(o,d,u,h))},error:e[r+1],complete:e[r+2]},IO(n._query)}return(function(d,h,p,m){const b=new nE(m),_=new Jw(h,b,p);return d.asyncQueue.enqueueAndForget((async()=>Ww(await X0(d),_))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>Qw(await X0(d),_)))}})(Np(o),c,i,a)}function jp(n,e){return(function(r,i){const a=new Ka;return r.asyncQueue.enqueueAndForget((async()=>Oq(await $q(r),i,a))),a.promise})(Np(n),e)}function DO(n,e,t){const r=t.docs.get(e._key),i=new hE(n);return new pc(n,i,e._key,r,new lh(t.hasPendingWrites,t.fromCache),e.converter)}class cH{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Pp(e)}set(e,t,r){this._verifyNotCommitted();const i=Ox(e,this._firestore),a=fE(i.converter,t,r),o=rE(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,rr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Ox(e,this._firestore);let o;return o=typeof(t=un(t))=="string"||t instanceof Mp?EO(this._dataReader,"WriteBatch.update",a._key,t,r,i):wO(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,rr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Ox(e,this._firestore);return this._mutations=this._mutations.concat(new Cp(t._key,rr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ie(ge.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ox(n,e){if((n=un(n)).firestore!==e)throw new Ie(ge.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function DR(){return new Op("deleteField")}function uH(...n){return new iE("arrayUnion",n)}function dH(n){return Np(n=Ir(n,pa)),new cH(n,(e=>jp(n,e)))}(function(e,t=!0){(function(i){Od=i})(Pd),sd(new bc("firestore",((r,{instanceIdentifier:i,options:a})=>{const o=r.getProvider("app").getImmediate(),c=new pa(new VF(r.getProvider("auth-internal")),new LF(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ie(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sc(d.options.projectId,h)})(o,i),o);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Zo(oI,lI,e),Zo(oI,lI,"esm2020")})();const fH={apiKey:"AIzaSyDwUA0paVI6n01aENV5Q2aLwVz1DEDtNuA",authDomain:"personal-budget-pwa-5defb.firebaseapp.com",projectId:"personal-budget-pwa-5defb",storageBucket:"personal-budget-pwa-5defb.firebasestorage.app",messagingSenderId:"137454342284",appId:"1:137454342284:web:d7a8169fd53f437e42aba9"},kO=kN(fH),Oo=DF(kO),xt=Wq(kO);Qq(xt).catch(n=>{n.code==="failed-precondition"?console.warn(" Offline persistence failed: Multiple tabs open"):n.code==="unimplemented"?console.warn(" Offline persistence not available in this browser"):console.error(" Failed to enable offline persistence:",n)});const Vx=n=>({id:n.uid,username:n.email||n.uid,displayName:n.displayName||n.email?.split("@")[0]||"User",email:n.email||void 0}),ca=ow()(gN(n=>({currentUser:null,isAuthenticated:!1,loginError:null,isLoading:!1,isInitialized:!1,isInitializing:!0,lastAuthTime:null,offlineGracePeriod:10080*60*1e3,lastVerificationEmailSent:null,login:async(e,t)=>{n({isLoading:!0,loginError:null});try{const i=(await h8(Oo,e,t)).user;if(!i.emailVerified)return await W2(Oo),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:"Please verify your email address before signing in. Check your email for a verification link."}),console.log(` Login blocked: ${i.email} not verified`),!1;const a=Vx(i);return n({currentUser:a,isAuthenticated:!0,isLoading:!1,loginError:null,lastAuthTime:Date.now()}),console.log(` User logged in: ${a.email}`),!0}catch(r){console.error("Login error:",r),console.error("Error code:",r.code),console.error("Error message:",r.message);let i="Login failed. Please try again.";if(r.code)switch(r.code){case"auth/invalid-email":i="Invalid email address.";break;case"auth/user-disabled":i="This account has been disabled.";break;case"auth/user-not-found":i="No account found with this email.";break;case"auth/wrong-password":i="Incorrect password.";break;case"auth/too-many-requests":i="Too many failed attempts. Please try again later.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break;case"auth/invalid-credential":i="Invalid email or password.";break;default:console.warn(`Unhandled Firebase error code: ${r.code}`),i="Authentication failed. Please try again.";break}else console.warn("Non-Firebase error in login:",r),i="An unexpected error occurred. Please try again.";return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:i}),!1}},register:async(e,t,r)=>{n({isLoading:!0,loginError:null});try{const a=(await f8(Oo,e,t)).user;await g8(a,{displayName:r}),await X2(a);const o=Vx(a);return n({currentUser:o,isAuthenticated:!1,isLoading:!1,loginError:null,lastVerificationEmailSent:Date.now()}),console.log(` User registered: ${o.email}, verification email sent`),!0}catch(i){console.error("Registration error:",i);let a="Registration failed. Please try again.";switch(i.code){case"auth/email-already-in-use":a="An account with this email already exists.";break;case"auth/invalid-email":a="Invalid email address.";break;case"auth/weak-password":a="Password should be at least 6 characters.";break;case"auth/operation-not-allowed":a="Email/password accounts are not enabled.";break}return n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:a}),!1}},logout:async()=>{try{await W2(Oo),console.log(" User logged out")}catch(e){console.error("Logout error:",e)}},clearError:()=>{n({loginError:null})},sendPasswordReset:async e=>{n({isLoading:!0,loginError:null});try{return await d8(Oo,e),n({isLoading:!1}),!0}catch(t){console.error("Password reset error:",t);let r="Failed to send password reset email. Please try again.";switch(t.code){case"auth/user-not-found":r="No account found with this email.";break;case"auth/invalid-email":r="Invalid email address.";break;case"auth/too-many-requests":r="Too many attempts. Please try again later.";break}return n({isLoading:!1,loginError:r}),!1}},sendEmailVerification:async()=>{const e=Oo.currentUser;if(!e)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{return await X2(e),n({isLoading:!1,lastVerificationEmailSent:Date.now()}),console.log(` Verification email sent to: ${e.email}`),!0}catch(t){console.error("Email verification error:",t);let r="Failed to send verification email. Please try again.";switch(t.code){case"auth/too-many-requests":r="Too many verification emails sent. Please wait before trying again.";break}return n({isLoading:!1,loginError:r}),!1}},resendEmailVerification:async()=>{const e=ca.getState();if(e.lastVerificationEmailSent){const t=Date.now()-e.lastVerificationEmailSent,r=60*1e3;if(t<r){const i=Math.ceil((r-t)/1e3);return n({loginError:`Please wait ${i} seconds before requesting another verification email.`}),!1}}return e.sendEmailVerification()},deleteAccount:async e=>{const t=Oo.currentUser;if(!t||!t.email)return n({loginError:"No user is currently signed in."}),!1;n({isLoading:!0,loginError:null});try{const r=Vc.credential(t.email,e);return await u8(t,r),await b8(t),n({currentUser:null,isAuthenticated:!1,isLoading:!1,loginError:null,lastAuthTime:null}),console.log(` Account permanently deleted: ${t.email}`),!0}catch(r){console.error("Account deletion error:",r);let i="Failed to delete account. Please try again.";switch(r.code){case"auth/requires-recent-login":i="For security, please log out and log back in before deleting your account.";break;case"auth/wrong-password":i="Incorrect password. Please enter your current password.";break;case"auth/too-many-requests":i="Too many deletion attempts. Please wait before trying again.";break;case"auth/network-request-failed":i="Network error. Please check your connection and try again.";break}return n({isLoading:!1,loginError:i}),!1}},initializeAuth:()=>ca.getState().isInitialized?()=>{}:(n({isInitialized:!1}),y8(Oo,r=>{const i=Date.now(),a=ca.getState(),o=r?Vx(r):null,c=a.lastAuthTime&&i-a.lastAuthTime<a.offlineGracePeriod,d=typeof navigator<"u"&&!navigator.onLine&&a.isAuthenticated&&c&&!o,h=r?r.emailVerified:!0,p=r&&h||!!d,m=r?o:d?a.currentUser:null;n({currentUser:m,isAuthenticated:p,isInitialized:!0,isLoading:!1,loginError:null,lastAuthTime:r&&h?i:a.lastAuthTime}),m?console.log(` Auth state: User is signed in (${m.email})`,d?"(offline grace period)":h?"(verified)":"(unverified)"):console.log(" Auth state: User is signed out")}))}),{name:"auth-storage",partialize:n=>({isAuthenticated:n.isAuthenticated,currentUser:n.currentUser,lastAuthTime:n.lastAuthTime,offlineGracePeriod:n.offlineGracePeriod,lastVerificationEmailSent:n.lastVerificationEmailSent})})),Tn=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:ca},Symbol.toStringTag,{value:"Module"})),NO=[{id:"length",label:"Minimum 12 characters",regex:/^.{12,}$/},{id:"uppercase",label:"At least one uppercase letter (A-Z)",regex:/[A-Z]/},{id:"lowercase",label:"At least one lowercase letter (a-z)",regex:/[a-z]/},{id:"number",label:"At least one number (0-9)",regex:/\d/},{id:"special",label:"At least one special character (!@#$%^&*)",regex:/[!@#$%^&*]/}],hH=n=>{if(!n)return{score:0,level:"weak",color:"text-gray-400",label:"Enter password"};const r=NO.map(c=>({...c,met:c.regex.test(n)})).filter(c=>c.met).length;let i,a,o;return r<=1?(i="weak",a="text-red-500",o="Weak"):r<=3?(i="medium",a="text-yellow-500",o="Medium"):r===4?(i="strong",a="text-blue-500",o="Strong"):(i="very-strong",a="text-green-500",o="Very Strong"),{score:r,level:i,color:a,label:o}},pE=n=>{const e=NO.map(i=>({...i,met:i.regex.test(n)})),t=hH(n),r=e.every(i=>i.met);return{requirements:e,strength:t,isValid:r,isEmpty:!n.trim()}},pH=({password:n,className:e=""})=>{const{strength:t,isEmpty:r}=pE(n);return r?null:v.jsxs("div",{className:`flex items-center gap-2 ${e}`,children:[v.jsx("div",{className:"flex-1",children:v.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(i=>v.jsx("div",{className:`h-1 flex-1 rounded-full ${i<=t.score?t.score<=1?"bg-red-500":t.score<=3?"bg-yellow-500":t.score===4?"bg-blue-500":"bg-green-500":"bg-gray-200 dark:bg-gray-700"}`},i))})}),v.jsx("span",{className:`text-sm font-medium ${t.color}`,children:t.label})]})},gH=({password:n,className:e=""})=>{const{requirements:t,isEmpty:r}=pE(n);return r?null:v.jsx("div",{className:`space-y-1 ${e}`,children:t.map(i=>v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.met?v.jsx(hL,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):v.jsx(xv,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),v.jsx("span",{className:i.met?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400",children:i.label})]},i.id))})},mH=()=>{const[n,e]=U.useState(""),[t,r]=U.useState(""),[i,a]=U.useState(""),[o,c]=U.useState(!1),[u,d]=U.useState(!1),[h,p]=U.useState(!1),[m,b]=U.useState(!1),{login:_,register:w,sendPasswordReset:S,isLoading:T,loginError:C,clearError:D}=ca(),M=pE(t),j=async A=>{if(A.preventDefault(),D(),n.trim()&&t.trim())if(u){if(!i.trim()||!M.isValid)return;await w(n.trim(),t,i.trim())}else await _(n.trim(),t)},z=async A=>{A.preventDefault(),n.trim()&&await S(n.trim())&&b(!0)};return U.useEffect(()=>{e(""),r(""),a(""),b(!1)},[u,h]),v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsxs("div",{className:"flex flex-col items-center gap-3 mb-2",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"Personal Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"Personal Budget"})]}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Simple envelope budgeting for personal finance"})]})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:h?v.jsxs("form",{onSubmit:z,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-2",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset Password"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter your email and we'll send you a link to reset your password."})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(x1,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"reset-email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full pl-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"email"})]})]}),m?v.jsxs("div",{className:"text-center py-4",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:v.jsx(x1,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),v.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900 dark:text-white",children:"Check your email"}),v.jsxs("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["We've sent a password reset link to ",v.jsx("span",{className:"font-medium",children:n})]}),v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[v.jsx(ad,{className:"-ml-1 mr-2 h-4 w-4"}),"Back to login"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"submit",disabled:T||!n.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?"Sending...":"Send Reset Link"}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:[v.jsx(ad,{className:"inline-block h-4 w-4 -ml-1 mr-1"}),"Back to login"]})})]})]}):v.jsxs("form",{onSubmit:j,className:"space-y-6",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u?"Create Account":"Sign In"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:u?"Create a new account to get started":"Sign in to your account"})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),v.jsx("input",{id:"email",type:"email",value:n,onChange:A=>e(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your email",required:!0,disabled:T,autoComplete:"username"})]}),u&&v.jsxs("div",{children:[v.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Name"}),v.jsx("input",{id:"displayName",type:"text",value:i,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter your display name",required:!0,disabled:T})]}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),!u&&v.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-sm text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",disabled:T,children:"Forgot password?"})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{id:"password",type:o?"text":"password",value:t,onChange:A=>r(A.target.value),className:`w-full px-3 py-2 pr-10 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white ${u&&t&&!M.isValid?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"Enter your password",required:!0,disabled:T,autoComplete:u?"new-password":"current-password"}),v.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",disabled:T,children:o?v.jsx(DL,{className:"h-5 w-5"}):v.jsx(NL,{className:"h-5 w-5"})})]}),u&&t&&v.jsx("div",{className:"mt-2",children:v.jsx(pH,{password:t})}),u&&t&&v.jsx("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md",children:v.jsx(gH,{password:t})})]}),C&&v.jsxs("div",{className:"text-red-600 dark:text-red-400 text-sm text-center bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[C,C.includes("verify your email")&&v.jsx("div",{className:"mt-3",children:v.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Please check your email and click the verification link to continue."})})]}),v.jsx("button",{type:"submit",disabled:T||!n.trim()||!t.trim()||u&&!i.trim()||u&&!M.isValid,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed",children:T?u?"Creating Account...":"Signing in...":u?"Create Account":"Sign In"}),v.jsx("div",{className:"mt-6 text-center",children:v.jsxs("button",{type:"button",onClick:()=>{d(!u),p(!1)},className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",disabled:T,children:[v.jsx(x9,{className:"h-4 w-4"}),u?"Already have an account? Sign In":"Don't have an account? Sign Up"]})})]})})]})})},MO=()=>{const[n,e]=U.useState(!1),[t,r]=U.useState(!1),{currentUser:i,resendEmailVerification:a,logout:o,loginError:c}=ca();U.useEffect(()=>{i||console.warn("EmailVerificationView: No current user, this should not happen")},[i]);const u=async()=>{e(!0),r(!1);const h=await a();e(!1),h&&(r(!0),setTimeout(()=>r(!1),3e3))},d=async()=>{await o()};return i?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full space-y-8",children:[v.jsx("div",{className:"text-center",children:v.jsx("div",{className:"flex flex-col items-center gap-3 mb-2",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/personal-budget-pwa/icon-192.png",alt:"House Budget Logo",className:"w-10 h-10"}),v.jsx("h1",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400",children:"House Budget"})]})})}),v.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:v.jsx(x1,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your email"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["We've sent a verification link to"," ",v.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:i.email})]}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(b1,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),v.jsxs("div",{className:"text-left",children:[v.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:"What to do next:"}),v.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1 space-y-1",children:[v.jsx("li",{children:"1. Open your email inbox"}),v.jsx("li",{children:"2. Find the email from House Budget"}),v.jsx("li",{children:'3. Click the "Verify Email" link'}),v.jsx("li",{children:"4. Return here and sign in"})]})]})]})}),c&&v.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-md",children:c}),t&&v.jsx("div",{className:"text-green-600 dark:text-green-400 text-sm mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-md",children:"Verification email sent successfully!"}),v.jsx("button",{onClick:u,disabled:n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed mb-4 flex items-center justify-center gap-2",children:n?v.jsxs(v.Fragment,{children:[v.jsx(Vh,{className:"h-4 w-4 animate-spin"}),"Sending..."]}):v.jsxs(v.Fragment,{children:[v.jsx(Vh,{className:"h-4 w-4"}),"Resend verification email"]})}),v.jsxs("button",{onClick:d,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[v.jsx(ad,{className:"h-4 w-4"}),"Back to sign in"]})]})}),v.jsx("div",{className:"text-center",children:v.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Didn't receive the email? Check your spam folder or try resending."})})]})}):null},PO=({message:n="Loading your budget...",showTimeout:e=!1})=>v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col items-center justify-center px-4",children:[v.jsx("div",{className:"mb-8",children:v.jsxs("div",{className:"relative",children:[v.jsx(Vh,{size:48,className:"text-blue-500 animate-spin"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx(bv,{size:24,className:"text-blue-600 dark:text-blue-400"})})]})}),v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 max-w-md",children:"This may take a moment on slow connections. We're fetching your budget data securely."})]}),v.jsxs("div",{className:"mt-12 w-full max-w-md space-y-4",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"h-6 bg-gray-200 dark:bg-zinc-700 rounded w-24 animate-pulse"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"}),v.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]})]})}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsx("div",{className:"h-4 bg-gray-200 dark:bg-zinc-700 rounded w-32 mb-2 animate-pulse"}),v.jsx("div",{className:"h-8 bg-gray-200 dark:bg-zinc-700 rounded w-20 animate-pulse"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-28 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-12 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"h-5 bg-gray-200 dark:bg-zinc-700 rounded w-32 animate-pulse"}),v.jsx("div",{className:"h-6 w-6 bg-gray-200 dark:bg-zinc-700 rounded-full animate-pulse"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"}),v.jsx("div",{className:"h-16 bg-gray-100 dark:bg-zinc-800 rounded-xl animate-pulse"})]})]})]}),e&&v.jsx("div",{className:"mt-8 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-xl border border-amber-200 dark:border-amber-800 max-w-md",children:v.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200 text-center",children:"This is taking longer than usual. If you're on a very slow connection, this is normal. Your data will load shortly."})}),v.jsx("div",{className:"mt-8 w-full max-w-md",children:v.jsx("div",{className:"h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})})})]}),gE=U.createContext({});function Kv(n){const e=U.useRef(null);return e.current===null&&(e.current=n()),e.current}const mE=typeof window<"u",vE=mE?U.useLayoutEffect:U.useEffect,Xv=U.createContext(null);function yE(n,e){n.indexOf(e)===-1&&n.push(e)}function bE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Bs=(n,e,t)=>t>e?e:t<n?n:t;let xE=()=>{};const Us={},OO=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function VO(n){return typeof n=="object"&&n!==null}const jO=n=>/^0[^.\s]+$/u.test(n);function _E(n){let e;return()=>(e===void 0&&(e=n()),e)}const Ui=n=>n,vH=(n,e)=>t=>e(n(t)),zp=(...n)=>n.reduce(vH),ep=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class wE{constructor(){this.subscriptions=[]}add(e){return yE(this.subscriptions,e),()=>bE(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Qa=n=>n*1e3,Li=n=>n/1e3;function zO(n,e){return e?n*(1e3/e):0}const LO=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,yH=1e-7,bH=12;function xH(n,e,t,r,i){let a,o,c=0;do o=e+(t-e)/2,a=LO(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>yH&&++c<bH);return o}function Lp(n,e,t,r){if(n===e&&t===r)return Ui;const i=a=>xH(a,0,1,n,t);return a=>a===0||a===1?a:LO(i(a),e,r)}const BO=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,UO=n=>e=>1-n(1-e),FO=Lp(.33,1.53,.69,.99),EE=UO(FO),GO=BO(EE),qO=n=>(n*=2)<1?.5*EE(n):.5*(2-Math.pow(2,-10*(n-1))),SE=n=>1-Math.sin(Math.acos(n)),HO=UO(SE),$O=BO(SE),_H=Lp(.42,0,1,1),wH=Lp(0,0,.58,1),YO=Lp(.42,0,.58,1),EH=n=>Array.isArray(n)&&typeof n[0]!="number",KO=n=>Array.isArray(n)&&typeof n[0]=="number",SH={linear:Ui,easeIn:_H,easeInOut:YO,easeOut:wH,circIn:SE,circInOut:$O,circOut:HO,backIn:EE,backInOut:GO,backOut:FO,anticipate:qO},TH=n=>typeof n=="string",kR=n=>{if(KO(n)){xE(n.length===4);const[e,t,r,i]=n;return Lp(e,t,r,i)}else if(TH(n))return SH[n];return n},km=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function AH(n,e){let t=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(h){o.has(h)&&(d.schedule(h),n()),h(c)}const d={schedule:(h,p=!1,m=!1)=>{const _=m&&i?t:r;return p&&o.add(h),_.has(h)||_.add(h),h},cancel:h=>{r.delete(h),o.delete(h)},process:h=>{if(c=h,i){a=!0;return}i=!0,[t,r]=[r,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const CH=40;function XO(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=km.reduce((D,M)=>(D[M]=AH(a),D),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:h,update:p,preRender:m,render:b,postRender:_}=o,w=()=>{const D=Us.useManualTiming?i.timestamp:performance.now();t=!1,Us.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(D-i.timestamp,CH),1)),i.timestamp=D,i.isProcessing=!0,c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),b.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(w))},S=()=>{t=!0,r=!0,i.isProcessing||n(w)};return{schedule:km.reduce((D,M)=>{const j=o[M];return D[M]=(z,A=!1,I=!1)=>(t||S(),j.schedule(z,A,I)),D},{}),cancel:D=>{for(let M=0;M<km.length;M++)o[km[M]].cancel(D)},state:i,steps:o}}const{schedule:gn,cancel:ll,state:br,steps:jx}=XO(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ui,!0);let h0;function IH(){h0=void 0}const Zr={now:()=>(h0===void 0&&Zr.set(br.isProcessing||Us.useManualTiming?br.timestamp:performance.now()),h0),set:n=>{h0=n,queueMicrotask(IH)}},WO=n=>e=>typeof e=="string"&&e.startsWith(n),TE=WO("--"),RH=WO("var(--"),AE=n=>RH(n)?DH.test(n.split("/*")[0].trim()):!1,DH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Bd={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},tp={...Bd,transform:n=>Bs(0,1,n)},Nm={...Bd,default:1},Sh=n=>Math.round(n*1e5)/1e5,CE=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function kH(n){return n==null}const NH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,IE=(n,e)=>t=>!!(typeof t=="string"&&NH.test(t)&&t.startsWith(n)||e&&!kH(t)&&Object.prototype.hasOwnProperty.call(t,e)),QO=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,a,o,c]=r.match(CE);return{[n]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},MH=n=>Bs(0,255,n),zx={...Bd,transform:n=>Math.round(MH(n))},oc={test:IE("rgb","red"),parse:QO("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+zx.transform(n)+", "+zx.transform(e)+", "+zx.transform(t)+", "+Sh(tp.transform(r))+")"};function PH(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const n_={test:IE("#"),parse:PH,transform:oc.transform},Bp=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Lo=Bp("deg"),Za=Bp("%"),it=Bp("px"),OH=Bp("vh"),VH=Bp("vw"),NR={...Za,parse:n=>Za.parse(n)/100,transform:n=>Za.transform(n*100)},Uu={test:IE("hsl","hue"),parse:QO("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Za.transform(Sh(e))+", "+Za.transform(Sh(t))+", "+Sh(tp.transform(r))+")"},$n={test:n=>oc.test(n)||n_.test(n)||Uu.test(n),parse:n=>oc.test(n)?oc.parse(n):Uu.test(n)?Uu.parse(n):n_.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?oc.transform(n):Uu.transform(n),getAnimatableNone:n=>{const e=$n.parse(n);return e.alpha=0,$n.transform(e)}},jH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function zH(n){return isNaN(n)&&typeof n=="string"&&(n.match(CE)?.length||0)+(n.match(jH)?.length||0)>0}const ZO="number",JO="color",LH="var",BH="var(",MR="${}",UH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function np(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let a=0;const c=e.replace(UH,u=>($n.test(u)?(r.color.push(a),i.push(JO),t.push($n.parse(u))):u.startsWith(BH)?(r.var.push(a),i.push(LH),t.push(u)):(r.number.push(a),i.push(ZO),t.push(parseFloat(u))),++a,MR)).split(MR);return{values:t,split:c,indexes:r,types:i}}function e4(n){return np(n).values}function t4(n){const{split:e,types:t}=np(n),r=e.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=e[o],i[o]!==void 0){const c=t[o];c===ZO?a+=Sh(i[o]):c===JO?a+=$n.transform(i[o]):a+=i[o]}return a}}const FH=n=>typeof n=="number"?0:$n.test(n)?$n.getAnimatableNone(n):n;function GH(n){const e=e4(n);return t4(n)(e.map(FH))}const cl={test:zH,parse:e4,createTransformer:t4,getAnimatableNone:GH};function Lx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function qH({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=Lx(u,c,n+1/3),a=Lx(u,c,n),o=Lx(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function Q0(n,e){return t=>t>0?e:n}const bn=(n,e,t)=>n+(e-n)*t,Bx=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},HH=[n_,oc,Uu],$H=n=>HH.find(e=>e.test(n));function PR(n){const e=$H(n);if(!e)return!1;let t=e.parse(n);return e===Uu&&(t=qH(t)),t}const OR=(n,e)=>{const t=PR(n),r=PR(e);if(!t||!r)return Q0(n,e);const i={...t};return a=>(i.red=Bx(t.red,r.red,a),i.green=Bx(t.green,r.green,a),i.blue=Bx(t.blue,r.blue,a),i.alpha=bn(t.alpha,r.alpha,a),oc.transform(i))},r_=new Set(["none","hidden"]);function YH(n,e){return r_.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function KH(n,e){return t=>bn(n,e,t)}function RE(n){return typeof n=="number"?KH:typeof n=="string"?AE(n)?Q0:$n.test(n)?OR:QH:Array.isArray(n)?n4:typeof n=="object"?$n.test(n)?OR:XH:Q0}function n4(n,e){const t=[...n],r=t.length,i=n.map((a,o)=>RE(a)(a,e[o]));return a=>{for(let o=0;o<r;o++)t[o]=i[o](a);return t}}function XH(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=RE(n[i])(n[i],e[i]));return i=>{for(const a in r)t[a]=r[a](i);return t}}function WH(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=n.indexes[a][r[a]],c=n.values[o]??0;t[i]=c,r[a]++}return t}const QH=(n,e)=>{const t=cl.createTransformer(e),r=np(n),i=np(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?r_.has(n)&&!i.values.length||r_.has(e)&&!r.values.length?YH(n,e):zp(n4(WH(r,i),i.values),t):Q0(n,e)};function r4(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?bn(n,e,t):RE(n)(n,e)}const ZH=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>gn.update(e,t),stop:()=>ll(e),now:()=>br.isProcessing?br.timestamp:Zr.now()}},i4=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)r+=Math.round(n(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Z0=2e4;function DE(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<Z0;)e+=t,r=n.next(e);return e>=Z0?1/0:e}function JH(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(DE(r),Z0);return{type:"keyframes",ease:a=>r.next(i*a).value/e,duration:Li(i)}}const e$=5;function a4(n,e,t){const r=Math.max(e-e$,0);return zO(t-n(r),e-r)}const An={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ux=.001;function t$({duration:n=An.duration,bounce:e=An.bounce,velocity:t=An.velocity,mass:r=An.mass}){let i,a,o=1-e;o=Bs(An.minDamping,An.maxDamping,o),n=Bs(An.minDuration,An.maxDuration,Li(n)),o<1?(i=d=>{const h=d*o,p=h*n,m=h-t,b=i_(d,o),_=Math.exp(-p);return Ux-m/b*_},a=d=>{const p=d*o*n,m=p*t+t,b=Math.pow(o,2)*Math.pow(d,2)*n,_=Math.exp(-p),w=i_(Math.pow(d,2),o);return(-i(d)+Ux>0?-1:1)*((m-b)*_)/w}):(i=d=>{const h=Math.exp(-d*n),p=(d-t)*n+1;return-Ux+h*p},a=d=>{const h=Math.exp(-d*n),p=(t-d)*(n*n);return h*p});const c=5/n,u=r$(i,a,c);if(n=Qa(n),isNaN(u))return{stiffness:An.stiffness,damping:An.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:n}}}const n$=12;function r$(n,e,t){let r=t;for(let i=1;i<n$;i++)r=r-n(r)/e(r);return r}function i_(n,e){return n*Math.sqrt(1-e*e)}const i$=["duration","bounce"],a$=["stiffness","damping","mass"];function VR(n,e){return e.some(t=>n[t]!==void 0)}function s$(n){let e={velocity:An.velocity,stiffness:An.stiffness,damping:An.damping,mass:An.mass,isResolvedFromDuration:!1,...n};if(!VR(n,a$)&&VR(n,i$))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,a=2*Bs(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:An.mass,stiffness:i,damping:a}}else{const t=t$(n);e={...e,...t,mass:An.mass},e.isResolvedFromDuration=!0}return e}function J0(n=An.visualDuration,e=An.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:b}=s$({...t,velocity:-Li(t.velocity||0)}),_=m||0,w=d/(2*Math.sqrt(u*h)),S=o-a,T=Li(Math.sqrt(u/h)),C=Math.abs(S)<5;r||(r=C?An.restSpeed.granular:An.restSpeed.default),i||(i=C?An.restDelta.granular:An.restDelta.default);let D;if(w<1){const j=i_(T,w);D=z=>{const A=Math.exp(-w*T*z);return o-A*((_+w*T*S)/j*Math.sin(j*z)+S*Math.cos(j*z))}}else if(w===1)D=j=>o-Math.exp(-T*j)*(S+(_+T*S)*j);else{const j=T*Math.sqrt(w*w-1);D=z=>{const A=Math.exp(-w*T*z),I=Math.min(j*z,300);return o-A*((_+w*T*S)*Math.sinh(I)+j*S*Math.cosh(I))/j}}const M={calculatedDuration:b&&p||null,next:j=>{const z=D(j);if(b)c.done=j>=p;else{let A=j===0?_:0;w<1&&(A=j===0?Qa(_):a4(D,j,z));const I=Math.abs(A)<=r,k=Math.abs(o-z)<=i;c.done=I&&k}return c.value=c.done?o:z,c},toString:()=>{const j=Math.min(DE(M),Z0),z=i4(A=>M.next(j*A).value,j,30);return j+"ms "+z},toTransition:()=>{}};return M}J0.applyToOptions=n=>{const e=JH(n,100,J0);return n.ease=e.ease,n.duration=Qa(e.duration),n.type="keyframes",n};function a_({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:h}){const p=n[0],m={done:!1,value:p},b=I=>c!==void 0&&I<c||u!==void 0&&I>u,_=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let w=t*e;const S=p+w,T=o===void 0?S:o(S);T!==S&&(w=T-p);const C=I=>-w*Math.exp(-I/r),D=I=>T+C(I),M=I=>{const k=C(I),V=D(I);m.done=Math.abs(k)<=d,m.value=m.done?T:V};let j,z;const A=I=>{b(m.value)&&(j=I,z=J0({keyframes:[m.value,_(m.value)],velocity:a4(D,I,m.value),damping:i,stiffness:a,restDelta:d,restSpeed:h}))};return A(0),{calculatedDuration:null,next:I=>{let k=!1;return!z&&j===void 0&&(k=!0,M(I),A(I)),j!==void 0&&I>=j?z.next(I-j):(!k&&M(I),m)}}}function o$(n,e,t){const r=[],i=t||Us.mix||r4,a=n.length-1;for(let o=0;o<a;o++){let c=i(n[o],n[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ui:e;c=zp(u,c)}r.push(c)}return r}function l$(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const a=n.length;if(xE(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[a-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=o$(e,r,i),u=c.length,d=h=>{if(o&&h<n[0])return e[0];let p=0;if(u>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const m=ep(n[p],n[p+1],h);return c[p](m)};return t?h=>d(Bs(n[0],n[a-1],h)):d}function c$(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=ep(0,e,r);n.push(bn(t,1,i))}}function u$(n){const e=[0];return c$(e,n.length-1),e}function d$(n,e){return n.map(t=>t*e)}function f$(n,e){return n.map(()=>e||YO).splice(0,n.length-1)}function Th({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=EH(r)?r.map(kR):kR(r),a={done:!1,value:e[0]},o=d$(t&&t.length===e.length?t:u$(e),n),c=l$(o,e,{ease:Array.isArray(i)?i:f$(e,i)});return{calculatedDuration:n,next:u=>(a.value=c(u),a.done=u>=n,a)}}const h$=n=>n!==null;function kE(n,{repeat:e,repeatType:t="loop"},r,i=1){const a=n.filter(h$),c=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!c||r===void 0?a[c]:r}const p$={decay:a_,inertia:a_,tween:Th,keyframes:Th,spring:J0};function s4(n){typeof n.type=="string"&&(n.type=p$[n.type])}class NE{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const g$=n=>n/100;class ME extends NE{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==Zr.now()&&this.tick(Zr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;s4(e);const{type:t=Th,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:c}=e;const u=t||Th;u!==Th&&typeof c[0]!="number"&&(this.mixKeyframes=zp(g$,r4(c[0],c[1])),c=[0,100]);const d=u({...e,keyframes:c});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=DE(d));const{calculatedDuration:h}=d;this.calculatedDuration=h,this.resolvedDuration=h+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:h,repeat:p,repeatType:m,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:S}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const T=this.currentTime-d*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?T<0:T>i;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let D=this.currentTime,M=r;if(p){const I=Math.min(this.currentTime,i)/c;let k=Math.floor(I),V=I%1;!V&&I>=1&&(V=1),V===1&&k--,k=Math.min(k,p+1),!!(k%2)&&(m==="reverse"?(V=1-V,b&&(V-=b/c)):m==="mirror"&&(M=o)),D=Bs(0,1,V)*c}const j=C?{done:!1,value:h[0]}:M.next(D);a&&(j.value=a(j.value));let{done:z}=j;!C&&u!==null&&(z=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&z);return A&&_!==a_&&(j.value=kE(h,this.options,S,this.speed)),w&&w(j.value),A&&this.finish(),j}then(e,t){return this.finished.then(e,t)}get duration(){return Li(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Li(e)}get time(){return Li(this.currentTime)}set time(e){e=Qa(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Zr.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Li(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=ZH,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Zr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function m$(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const lc=n=>n*180/Math.PI,s_=n=>{const e=lc(Math.atan2(n[1],n[0]));return o_(e)},v$={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:s_,rotateZ:s_,skewX:n=>lc(Math.atan(n[1])),skewY:n=>lc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},o_=n=>(n=n%360,n<0&&(n+=360),n),jR=s_,zR=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),LR=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),y$={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:zR,scaleY:LR,scale:n=>(zR(n)+LR(n))/2,rotateX:n=>o_(lc(Math.atan2(n[6],n[5]))),rotateY:n=>o_(lc(Math.atan2(-n[2],n[0]))),rotateZ:jR,rotate:jR,skewX:n=>lc(Math.atan(n[4])),skewY:n=>lc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function l_(n){return n.includes("scale")?1:0}function c_(n,e){if(!n||n==="none")return l_(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=y$,i=t;else{const c=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=v$,i=c}if(!i)return l_(e);const a=r[e],o=i[1].split(",").map(x$);return typeof a=="function"?a(o):o[a]}const b$=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return c_(t,e)};function x$(n){return parseFloat(n.trim())}const Ud=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fd=new Set(Ud),BR=n=>n===Bd||n===it,_$=new Set(["x","y","z"]),w$=Ud.filter(n=>!_$.has(n));function E$(n){const e=[];return w$.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const mc={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>c_(e,"x"),y:(n,{transform:e})=>c_(e,"y")};mc.translateX=mc.x;mc.translateY=mc.y;const vc=new Set;let u_=!1,d_=!1,f_=!1;function o4(){if(d_){const n=Array.from(vc).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=E$(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}d_=!1,u_=!1,vc.forEach(n=>n.complete(f_)),vc.clear()}function l4(){vc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(d_=!0)})}function S$(){f_=!0,l4(),o4(),f_=!1}class PE{constructor(e,t,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(vc.add(this),u_||(u_=!0,gn.read(l4),gn.resolveKeyframes(o4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const c=r.readValue(t,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}m$(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),vc.delete(this)}cancel(){this.state==="scheduled"&&(vc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const T$=n=>n.startsWith("--");function A$(n,e,t){T$(e)?n.style.setProperty(e,t):n.style[e]=t}const C$=_E(()=>window.ScrollTimeline!==void 0),I$={};function R$(n,e){const t=_E(n);return()=>I$[e]??t()}const c4=R$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ch=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,UR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ch([0,.65,.55,1]),circOut:ch([.55,0,1,.45]),backIn:ch([.31,.01,.66,-.59]),backOut:ch([.33,1.53,.69,.99])};function u4(n,e){if(n)return typeof n=="function"?c4()?i4(n,e):"ease-out":KO(n)?ch(n):Array.isArray(n)?n.map(t=>u4(t,e)||UR.easeOut):UR[n]}function D$(n,e,t,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const h={[e]:t};u&&(h.offset=u);const p=u4(c,i);Array.isArray(p)&&(h.easing=p);const m={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),n.animate(h,m)}function d4(n){return typeof n=="function"&&"applyToOptions"in n}function k$({type:n,...e}){return d4(n)&&c4()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class N$ extends NE{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,xE(typeof e.type!="string");const d=k$(e);this.animation=D$(t,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const h=kE(i,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(h):A$(t,r,h),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Li(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Li(e)}get time(){return Li(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Qa(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&C$()?(this.animation.timeline=e,Ui):t(this)}}const f4={anticipate:qO,backInOut:GO,circInOut:$O};function M$(n){return n in f4}function P$(n){typeof n.ease=="string"&&M$(n.ease)&&(n.ease=f4[n.ease])}const FR=10;class O$ extends N${constructor(e){P$(e),s4(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const c=new ME({...o,autoplay:!1}),u=Qa(this.finishedTime??this.time);t.setWithVelocity(c.sample(u-FR).value,c.sample(u).value,FR),c.stop()}}const GR=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(cl.test(n)||n==="0")&&!n.startsWith("url("));function V$(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function j$(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=n[n.length-1],o=GR(i,e),c=GR(a,e);return!o||!c?!1:V$(n)||(t==="spring"||d4(t))&&r}function h_(n){n.duration=0,n.type="keyframes"}const z$=new Set(["opacity","clipPath","filter","transform"]),L$=_E(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function B$(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:a,type:o}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return L$()&&t&&z$.has(t)&&(t!=="transform"||!d)&&!u&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const U$=40;class F$ extends NE{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:h,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Zr.now();const m={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:d,element:h,...p},b=h?.KeyframeResolver||PE;this.keyframeResolver=new b(c,(_,w,S)=>this.onKeyframesResolved(_,w,m,!S),u,d,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:h}=r;this.resolvedAt=Zr.now(),j$(e,a,o,c)||((Us.instantAnimations||!u)&&h?.(kE(e,r,t)),e[0]=e[e.length-1],h_(r),r.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>U$?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},b=!d&&B$(m)?new O$({...m,element:m.motionValue.owner.current}):new ME(m);b.finished.then(()=>this.notifyFinished()).catch(Ui),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),S$()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const G$=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function q$(n){const e=G$.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function h4(n,e,t=1){const[r,i]=q$(n);if(!r)return;const a=window.getComputedStyle(e).getPropertyValue(r);if(a){const o=a.trim();return OO(o)?parseFloat(o):o}return AE(i)?h4(i,e,t+1):i}function OE(n,e){return n?.[e]??n?.default??n}const p4=new Set(["width","height","top","left","right","bottom",...Ud]),H$={test:n=>n==="auto",parse:n=>n},g4=n=>e=>e.test(n),m4=[Bd,it,Za,Lo,VH,OH,H$],qR=n=>m4.find(g4(n));function $$(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||jO(n):!0}const Y$=new Set(["brightness","contrast","saturate","opacity"]);function K$(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(CE)||[];if(!r)return n;const i=t.replace(r,"");let a=Y$.has(e)?1:0;return r!==t&&(a*=100),e+"("+a+i+")"}const X$=/\b([a-z-]*)\(.*?\)/gu,p_={...cl,getAnimatableNone:n=>{const e=n.match(X$);return e?e.map(K$).join(" "):n}},HR={...Bd,transform:Math.round},W$={rotate:Lo,rotateX:Lo,rotateY:Lo,rotateZ:Lo,scale:Nm,scaleX:Nm,scaleY:Nm,scaleZ:Nm,skew:Lo,skewX:Lo,skewY:Lo,distance:it,translateX:it,translateY:it,translateZ:it,x:it,y:it,z:it,perspective:it,transformPerspective:it,opacity:tp,originX:NR,originY:NR,originZ:it},VE={borderWidth:it,borderTopWidth:it,borderRightWidth:it,borderBottomWidth:it,borderLeftWidth:it,borderRadius:it,radius:it,borderTopLeftRadius:it,borderTopRightRadius:it,borderBottomRightRadius:it,borderBottomLeftRadius:it,width:it,maxWidth:it,height:it,maxHeight:it,top:it,right:it,bottom:it,left:it,padding:it,paddingTop:it,paddingRight:it,paddingBottom:it,paddingLeft:it,margin:it,marginTop:it,marginRight:it,marginBottom:it,marginLeft:it,backgroundPositionX:it,backgroundPositionY:it,...W$,zIndex:HR,fillOpacity:tp,strokeOpacity:tp,numOctaves:HR},Q$={...VE,color:$n,backgroundColor:$n,outlineColor:$n,fill:$n,stroke:$n,borderColor:$n,borderTopColor:$n,borderRightColor:$n,borderBottomColor:$n,borderLeftColor:$n,filter:p_,WebkitFilter:p_},v4=n=>Q$[n];function y4(n,e){let t=v4(n);return t!==p_&&(t=cl),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Z$=new Set(["auto","none","0"]);function J$(n,e,t){let r=0,i;for(;r<n.length&&!i;){const a=n[r];typeof a=="string"&&!Z$.has(a)&&np(a).values.length&&(i=n[r]),r++}if(i&&t)for(const a of e)n[a]=y4(t,i)}class eY extends PE{constructor(e,t,r,i,a){super(e,t,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),AE(d))){const h=h4(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!p4.has(r)||e.length!==2)return;const[i,a]=e,o=qR(i),c=qR(a);if(o!==c)if(BR(o)&&BR(c))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else mc[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||$$(e[i]))&&r.push(i);r.length&&J$(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=mc[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=mc[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function tY(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=t?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const b4=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function x4(n){return VO(n)&&"offsetHeight"in n}const $R=30,nY=n=>!isNaN(parseFloat(n));class rY{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=Zr.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Zr.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=nY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new wE);const r=this.events[e].add(t);return e==="change"?()=>{r(),gn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Zr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>$R)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,$R);return zO(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function _d(n,e){return new rY(n,e)}const{schedule:jE}=XO(queueMicrotask,!1),ia={x:!1,y:!1};function _4(){return ia.x||ia.y}function iY(n){return n==="x"||n==="y"?ia[n]?null:(ia[n]=!0,()=>{ia[n]=!1}):ia.x||ia.y?null:(ia.x=ia.y=!0,()=>{ia.x=ia.y=!1})}function w4(n,e){const t=tY(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function YR(n){return!(n.pointerType==="touch"||_4())}function aY(n,e,t={}){const[r,i,a]=w4(n,t),o=c=>{if(!YR(c))return;const{target:u}=c,d=e(u,c);if(typeof d!="function"||!u)return;const h=p=>{YR(p)&&(d(p),u.removeEventListener("pointerleave",h))};u.addEventListener("pointerleave",h,i)};return r.forEach(c=>{c.addEventListener("pointerenter",o,i)}),a}const E4=(n,e)=>e?n===e?!0:E4(n,e.parentElement):!1,zE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,sY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function oY(n){return sY.has(n.tagName)||n.tabIndex!==-1}const p0=new WeakSet;function KR(n){return e=>{e.key==="Enter"&&n(e)}}function Fx(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const lY=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=KR(()=>{if(p0.has(t))return;Fx(t,"down");const i=KR(()=>{Fx(t,"up")}),a=()=>Fx(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function XR(n){return zE(n)&&!_4()}function cY(n,e,t={}){const[r,i,a]=w4(n,t),o=c=>{const u=c.currentTarget;if(!XR(c))return;p0.add(u);const d=e(u,c),h=(b,_)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),p0.has(u)&&p0.delete(u),XR(b)&&typeof d=="function"&&d(b,{success:_})},p=b=>{h(b,u===window||u===document||t.useGlobalTarget||E4(u,b.target))},m=b=>{h(b,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return r.forEach(c=>{(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,i),x4(c)&&(c.addEventListener("focus",d=>lY(d,i)),!oY(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),a}function S4(n){return VO(n)&&"ownerSVGElement"in n}function uY(n){return S4(n)&&n.tagName==="svg"}const Cr=n=>!!(n&&n.getVelocity),dY=[...m4,$n,cl],fY=n=>dY.find(g4(n)),LE=U.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function WR(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function hY(...n){return e=>{let t=!1;const r=n.map(i=>{const a=WR(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<r.length;i++){const a=r[i];typeof a=="function"?a():WR(n[i],null)}}}}function pY(...n){return U.useCallback(hY(...n),n)}class gY extends U.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=t.offsetParent,i=x4(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function mY({children:n,isPresent:e,anchorX:t,root:r}){const i=U.useId(),a=U.useRef(null),o=U.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=U.useContext(LE),u=pY(a,n?.ref);return U.useInsertionEffect(()=>{const{width:d,height:h,top:p,left:m,right:b}=o.current;if(e||!a.current||!d||!h)return;const _=t==="left"?`left: ${m}`:`right: ${b}`;a.current.dataset.motionPopId=i;const w=document.createElement("style");c&&(w.nonce=c);const S=r??document.head;return S.appendChild(w),w.sheet&&w.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${h}px !important;
            ${_}px !important;
            top: ${p}px !important;
          }
        `),()=>{S.contains(w)&&S.removeChild(w)}},[e]),v.jsx(gY,{isPresent:e,childRef:a,sizeRef:o,children:U.cloneElement(n,{ref:u})})}const vY=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:c,root:u})=>{const d=Kv(yY),h=U.useId();let p=!0,m=U.useMemo(()=>(p=!1,{id:h,initial:e,isPresent:t,custom:i,onExitComplete:b=>{d.set(b,!0);for(const _ of d.values())if(!_)return;r&&r()},register:b=>(d.set(b,!1),()=>d.delete(b))}),[t,d,r]);return a&&p&&(m={...m}),U.useMemo(()=>{d.forEach((b,_)=>d.set(_,!1))},[t]),U.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),o==="popLayout"&&(n=v.jsx(mY,{isPresent:t,anchorX:c,root:u,children:n})),v.jsx(Xv.Provider,{value:m,children:n})};function yY(){return new Map}function T4(n=!0){const e=U.useContext(Xv);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=U.useId();U.useEffect(()=>{if(n)return i(a)},[n]);const o=U.useCallback(()=>n&&r&&r(a),[a,r,n]);return!t&&r?[!1,o]:[!0]}const Mm=n=>n.key||"";function QR(n){const e=[];return U.Children.forEach(n,t=>{U.isValidElement(t)&&e.push(t)}),e}const Jr=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,h]=T4(o),p=U.useMemo(()=>QR(n),[n]),m=o&&!d?[]:p.map(Mm),b=U.useRef(!0),_=U.useRef(p),w=Kv(()=>new Map),[S,T]=U.useState(p),[C,D]=U.useState(p);vE(()=>{b.current=!1,_.current=p;for(let z=0;z<C.length;z++){const A=Mm(C[z]);m.includes(A)?w.delete(A):w.get(A)!==!0&&w.set(A,!1)}},[C,m.length,m.join("-")]);const M=[];if(p!==S){let z=[...p];for(let A=0;A<C.length;A++){const I=C[A],k=Mm(I);m.includes(k)||(z.splice(A,0,I),M.push(I))}return a==="wait"&&M.length&&(z=M),D(QR(z)),T(p),null}const{forceRender:j}=U.useContext(gE);return v.jsx(v.Fragment,{children:C.map(z=>{const A=Mm(z),I=o&&!d?!1:p===C||m.includes(A),k=()=>{if(w.has(A))w.set(A,!0);else return;let V=!0;w.forEach(B=>{B||(V=!1)}),V&&(j?.(),D(_.current),o&&h?.(),r&&r())};return v.jsx(vY,{isPresent:I,initial:!b.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:I?void 0:k,anchorX:c,children:z},A)})})},A4=U.createContext({strict:!1}),ZR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},wd={};for(const n in ZR)wd[n]={isEnabled:e=>ZR[n].some(t=>!!e[t])};function bY(n){for(const e in n)wd[e]={...wd[e],...n[e]}}const xY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ev(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||xY.has(n)}let C4=n=>!ev(n);function _Y(n){typeof n=="function"&&(C4=e=>e.startsWith("on")?!ev(e):n(e))}try{_Y(require("@emotion/is-prop-valid").default)}catch{}function wY(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(C4(i)||t===!0&&ev(i)||!e&&!ev(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const Wv=U.createContext({});function Qv(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function rp(n){return typeof n=="string"||Array.isArray(n)}const BE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],UE=["initial",...BE];function Zv(n){return Qv(n.animate)||UE.some(e=>rp(n[e]))}function I4(n){return!!(Zv(n)||n.variants)}function EY(n,e){if(Zv(n)){const{initial:t,animate:r}=n;return{initial:t===!1||rp(t)?t:void 0,animate:rp(r)?r:void 0}}return n.inherit!==!1?e:{}}function SY(n){const{initial:e,animate:t}=EY(n,U.useContext(Wv));return U.useMemo(()=>({initial:e,animate:t}),[JR(e),JR(t)])}function JR(n){return Array.isArray(n)?n.join(" "):n}const ip={};function TY(n){for(const e in n)ip[e]=n[e],TE(e)&&(ip[e].isCSSVariable=!0)}function R4(n,{layout:e,layoutId:t}){return Fd.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!ip[n]||n==="opacity")}const AY={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},CY=Ud.length;function IY(n,e,t){let r="",i=!0;for(let a=0;a<CY;a++){const o=Ud[a],c=n[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const d=b4(c,VE[o]);if(!u){i=!1;const h=AY[o]||o;r+=`${h}(${d}) `}t&&(e[o]=d)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function FE(n,e,t){const{style:r,vars:i,transformOrigin:a}=n;let o=!1,c=!1;for(const u in e){const d=e[u];if(Fd.has(u)){o=!0;continue}else if(TE(u)){i[u]=d;continue}else{const h=b4(d,VE[u]);u.startsWith("origin")?(c=!0,a[u]=h):r[u]=h}}if(e.transform||(o||t?r.transform=IY(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:h=0}=a;r.transformOrigin=`${u} ${d} ${h}`}}const GE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function D4(n,e,t){for(const r in e)!Cr(e[r])&&!R4(r,t)&&(n[r]=e[r])}function RY({transformTemplate:n},e){return U.useMemo(()=>{const t=GE();return FE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function DY(n,e){const t=n.style||{},r={};return D4(r,t,n),Object.assign(r,RY(n,e)),r}function kY(n,e){const t={},r=DY(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const NY={offset:"stroke-dashoffset",array:"stroke-dasharray"},MY={offset:"strokeDashoffset",array:"strokeDasharray"};function PY(n,e,t=1,r=0,i=!0){n.pathLength=1;const a=i?NY:MY;n[a.offset]=it.transform(-r);const o=it.transform(e),c=it.transform(t);n[a.array]=`${o} ${c}`}function k4(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...c},u,d,h){if(FE(n,c,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:m}=n;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=h?.transformBox??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),r!==void 0&&(p.scale=r),i!==void 0&&PY(p,i,a,o,!1)}const N4=()=>({...GE(),attrs:{}}),M4=n=>typeof n=="string"&&n.toLowerCase()==="svg";function OY(n,e,t,r){const i=U.useMemo(()=>{const a=N4();return k4(a,e,M4(r),n.transformTemplate,n.style),{...a.attrs,style:{...a.style}}},[e]);if(n.style){const a={};D4(a,n.style,n),i.style={...a,...i.style}}return i}const VY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function qE(n){return typeof n!="string"||n.includes("-")?!1:!!(VY.indexOf(n)>-1||/[A-Z]/u.test(n))}function jY(n,e,t,{latestValues:r},i,a=!1){const c=(qE(n)?OY:kY)(e,r,i,n),u=wY(e,typeof n=="string",a),d=n!==U.Fragment?{...u,...c,ref:t}:{},{children:h}=e,p=U.useMemo(()=>Cr(h)?h.get():h,[h]);return U.createElement(n,{...d,children:p})}function eD(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function HE(n,e,t,r){if(typeof e=="function"){const[i,a]=eD(r);e=e(t!==void 0?t:n.custom,i,a)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,a]=eD(r);e=e(t!==void 0?t:n.custom,i,a)}return e}function g0(n){return Cr(n)?n.get():n}function zY({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:LY(t,r,i,n),renderState:e()}}function LY(n,e,t,r){const i={},a=r(n,{});for(const m in a)i[m]=g0(a[m]);let{initial:o,animate:c}=n;const u=Zv(n),d=I4(n);e&&d&&!u&&n.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?c:o;if(p&&typeof p!="boolean"&&!Qv(p)){const m=Array.isArray(p)?p:[p];for(let b=0;b<m.length;b++){const _=HE(n,m[b]);if(_){const{transitionEnd:w,transition:S,...T}=_;for(const C in T){let D=T[C];if(Array.isArray(D)){const M=h?D.length-1:0;D=D[M]}D!==null&&(i[C]=D)}for(const C in w)i[C]=w[C]}}}return i}const P4=n=>(e,t)=>{const r=U.useContext(Wv),i=U.useContext(Xv),a=()=>zY(n,e,r,i);return t?a():Kv(a)};function $E(n,e,t){const{style:r}=n,i={};for(const a in r)(Cr(r[a])||e.style&&Cr(e.style[a])||R4(a,n)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const BY=P4({scrapeMotionValuesFromProps:$E,createRenderState:GE});function O4(n,e,t){const r=$E(n,e,t);for(const i in n)if(Cr(n[i])||Cr(e[i])){const a=Ud.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=n[i]}return r}const UY=P4({scrapeMotionValuesFromProps:O4,createRenderState:N4}),FY=Symbol.for("motionComponentSymbol");function Fu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function GY(n,e,t){return U.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Fu(t)&&(t.current=r))},[e])}const YE=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),qY="framerAppearId",V4="data-"+YE(qY),j4=U.createContext({});function HY(n,e,t,r,i){const{visualElement:a}=U.useContext(Wv),o=U.useContext(A4),c=U.useContext(Xv),u=U.useContext(LE).reducedMotion,d=U.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,p=U.useContext(j4);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&$Y(d.current,t,i,p);const m=U.useRef(!1);U.useInsertionEffect(()=>{h&&m.current&&h.update(t,c)});const b=t[V4],_=U.useRef(!!b&&!window.MotionHandoffIsComplete?.(b)&&window.MotionHasOptimisedAnimation?.(b));return vE(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),_.current&&h.animationState&&h.animationState.animateChanges())}),U.useEffect(()=>{h&&(!_.current&&h.animationState&&h.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(b)}),_.current=!1),h.enteringChildren=void 0)}),h}function $Y(n,e,t,r){const{layoutId:i,layout:a,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:z4(n.parent)),n.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||c&&Fu(c),visualElement:n,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:h,layoutScroll:u,layoutRoot:d})}function z4(n){if(n)return n.options.allowProjection!==!1?n.projection:z4(n.parent)}function Gx(n,{forwardMotionProps:e=!1}={},t,r){t&&bY(t);const i=qE(n)?UY:BY;function a(c,u){let d;const h={...U.useContext(LE),...c,layoutId:YY(c)},{isStatic:p}=h,m=SY(c),b=i(c,p);if(!p&&mE){KY();const _=XY(h);d=_.MeasureLayout,m.visualElement=HY(n,b,h,r,_.ProjectionNode)}return v.jsxs(Wv.Provider,{value:m,children:[d&&m.visualElement?v.jsx(d,{visualElement:m.visualElement,...h}):null,jY(n,c,GY(b,m.visualElement,u),b,p,e)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=U.forwardRef(a);return o[FY]=n,o}function YY({layoutId:n}){const e=U.useContext(gE).id;return e&&n!==void 0?e+"-"+n:n}function KY(n,e){U.useContext(A4).strict}function XY(n){const{drag:e,layout:t}=wd;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function WY(n,e){if(typeof Proxy>"u")return Gx;const t=new Map,r=(a,o)=>Gx(a,o,n,e),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(t.has(o)||t.set(o,Gx(o,void 0,n,e)),t.get(o))})}function L4({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function QY({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function ZY(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function qx(n){return n===void 0||n===1}function g_({scale:n,scaleX:e,scaleY:t}){return!qx(n)||!qx(e)||!qx(t)}function Wl(n){return g_(n)||B4(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function B4(n){return tD(n.x)||tD(n.y)}function tD(n){return n&&n!=="0%"}function tv(n,e,t){const r=n-t,i=e*r;return t+i}function nD(n,e,t,r,i){return i!==void 0&&(n=tv(n,i,r)),tv(n,t,r)+e}function m_(n,e=0,t=1,r,i){n.min=nD(n.min,e,t,r,i),n.max=nD(n.max,e,t,r,i)}function U4(n,{x:e,y:t}){m_(n.x,e.translate,e.scale,e.originPoint),m_(n.y,t.translate,t.scale,t.originPoint)}const rD=.999999999999,iD=1.0000000000001;function JY(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let c=0;c<i;c++){a=t[c],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&qu(n,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,U4(n,o)),r&&Wl(a.latestValues)&&qu(n,a.latestValues))}e.x<iD&&e.x>rD&&(e.x=1),e.y<iD&&e.y>rD&&(e.y=1)}function Gu(n,e){n.min=n.min+e,n.max=n.max+e}function aD(n,e,t,r,i=.5){const a=bn(n.min,n.max,i);m_(n,e,t,a,r)}function qu(n,e){aD(n.x,e.x,e.scaleX,e.scale,e.originX),aD(n.y,e.y,e.scaleY,e.scale,e.originY)}function F4(n,e){return L4(ZY(n.getBoundingClientRect(),e))}function eK(n,e,t){const r=F4(n,t),{scroll:i}=e;return i&&(Gu(r.x,i.offset.x),Gu(r.y,i.offset.y)),r}const sD=()=>({translate:0,scale:1,origin:0,originPoint:0}),Hu=()=>({x:sD(),y:sD()}),oD=()=>({min:0,max:0}),Mn=()=>({x:oD(),y:oD()}),v_={current:null},G4={current:!1};function tK(){if(G4.current=!0,!!mE)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>v_.current=n.matches;n.addEventListener("change",e),e()}else v_.current=!1}const nK=new WeakMap;function rK(n,e,t){for(const r in e){const i=e[r],a=t[r];if(Cr(i))n.addValue(r,i);else if(Cr(a))n.addValue(r,_d(i,{owner:n}));else if(a!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,_d(o!==void 0?o:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const lD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class iK{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=PE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Zr.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,gn.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=Zv(t),this.isVariantNode=I4(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const b=p[m];u[m]!==void 0&&Cr(b)&&b.set(u[m])}}mount(e){this.current=e,nK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),G4.current||tK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:v_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ll(this.notifyUpdate),ll(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Fd.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&gn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in wd){const t=wd[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Mn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<lD.length;r++){const i=lD[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=rK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=_d(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(OO(r)||jO(r))?r=parseFloat(r):!fY(r)&&cl.test(t)&&(r=y4(e,t)),this.setBaseTarget(e,Cr(r)?r.get():r)),Cr(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=HE(this.props,t,this.presenceContext?.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Cr(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new wE),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){jE.render(this.render)}}class q4 extends iK{constructor(){super(...arguments),this.KeyframeResolver=eY}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Cr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function H4(n,{style:e,vars:t},r,i){const a=n.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,r);for(o in t)a.setProperty(o,t[o])}function aK(n){return window.getComputedStyle(n)}class sK extends q4{constructor(){super(...arguments),this.type="html",this.renderInstance=H4}readValueFromInstance(e,t){if(Fd.has(t))return this.projection?.isProjecting?l_(t):b$(e,t);{const r=aK(e),i=(TE(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return F4(e,t)}build(e,t,r){FE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return $E(e,t,r)}}const $4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function oK(n,e,t,r){H4(n,e,void 0,r);for(const i in e.attrs)n.setAttribute($4.has(i)?i:YE(i),e.attrs[i])}class lK extends q4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Mn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Fd.has(t)){const r=v4(t);return r&&r.default||0}return t=$4.has(t)?t:YE(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return O4(e,t,r)}build(e,t,r){k4(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){oK(e,t,r,i)}mount(e){this.isSVGTag=M4(e.tagName),super.mount(e)}}const cK=(n,e)=>qE(n)?new lK(e):new sK(e,{allowProjection:n!==U.Fragment});function rd(n,e,t){const r=n.getProps();return HE(r,e,t!==void 0?t:r.custom,n)}const y_=n=>Array.isArray(n);function uK(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,_d(t))}function dK(n){return y_(n)?n[n.length-1]||0:n}function KE(n,e){const t=rd(n,e);let{transitionEnd:r={},transition:i={},...a}=t||{};a={...a,...r};for(const o in a){const c=dK(a[o]);uK(n,o,c)}}function fK(n){return!!(Cr(n)&&n.add)}function b_(n,e){const t=n.getValue("willChange");if(fK(t))return t.add(e);if(!t&&Us.WillChange){const r=new Us.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function Y4(n){return n.props[V4]}const hK=n=>n!==null;function pK(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(hK),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const gK={type:"spring",stiffness:500,damping:25,restSpeed:10},mK=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),vK={type:"keyframes",duration:.8},yK={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},bK=(n,{keyframes:e})=>e.length>2?vK:Fd.has(n)?n.startsWith("scale")?mK(e[1]):gK:yK;function xK({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:c,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const XE=(n,e,t,r={},i,a)=>o=>{const c=OE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Qa(u);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:a?void 0:i};xK(c)||Object.assign(h,bK(n,h)),h.duration&&(h.duration=Qa(h.duration)),h.repeatDelay&&(h.repeatDelay=Qa(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h_(h),h.delay===0&&(p=!0)),(Us.instantAnimations||Us.skipAnimations)&&(p=!0,h_(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,p&&!a&&e.get()!==void 0){const m=pK(h.keyframes,c);if(m!==void 0){gn.update(()=>{h.onUpdate(m),h.onComplete()});return}}return c.isSync?new ME(h):new F$(h)};function _K({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function K4(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:a=n.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(a=r);const u=[],d=i&&n.animationState&&n.animationState.getState()[i];for(const h in c){const p=n.getValue(h,n.latestValues[h]??null),m=c[h];if(m===void 0||d&&_K(d,h))continue;const b={delay:t,...OE(a||{},h)},_=p.get();if(_!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=Y4(n);if(T){const C=window.MotionHandoffAnimation(T,h,gn);C!==null&&(b.startTime=C,w=!0)}}b_(n,h),p.start(XE(h,p,m,n.shouldReduceMotion&&p4.has(h)?{type:!1}:b,n,w));const S=p.animation;S&&u.push(S)}return o&&Promise.all(u).then(()=>{gn.update(()=>{o&&KE(n,o)})}),u}function X4(n,e,t,r=0,i=1){const a=Array.from(n).sort((d,h)=>d.sortNodePosition(h)).indexOf(e),o=n.size,c=(o-1)*r;return typeof t=="function"?t(a,o):i===1?a*r:c-a*r}function x_(n,e,t={}){const r=rd(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const a=r?()=>Promise.all(K4(n,r,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return wK(n,e,u,d,h,p,t)}:()=>Promise.resolve(),{when:c}=i;if(c){const[u,d]=c==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(t.delay)])}function wK(n,e,t=0,r=0,i=0,a=1,o){const c=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),c.push(x_(u,e,{...o,delay:t+(typeof r=="function"?0:r)+X4(n.variantChildren,u,r,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(c)}function W4(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(a=>x_(n,a,t));r=Promise.all(i)}else if(typeof e=="string")r=x_(n,e,t);else{const i=typeof e=="function"?rd(n,e,t.custom):e;r=Promise.all(K4(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function Q4(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const EK=UE.length;function Z4(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?Z4(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<EK;t++){const r=UE[t],i=n.props[r];(rp(i)||i===!1)&&(e[r]=i)}return e}const SK=[...BE].reverse(),TK=BE.length;function AK(n){return e=>Promise.all(e.map(({animation:t,options:r})=>W4(n,t,r)))}function CK(n){let e=AK(n),t=cD(),r=!0;const i=u=>(d,h)=>{const p=rd(n,h,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:m,transitionEnd:b,..._}=p;d={...d,..._,...b}}return d};function a(u){e=u(n)}function o(u){const{props:d}=n,h=Z4(n.parent)||{},p=[],m=new Set;let b={},_=1/0;for(let S=0;S<TK;S++){const T=SK[S],C=t[T],D=d[T]!==void 0?d[T]:h[T],M=rp(D),j=T===u?C.isActive:null;j===!1&&(_=S);let z=D===h[T]&&D!==d[T]&&M;if(z&&r&&n.manuallyAnimateOnMount&&(z=!1),C.protectedKeys={...b},!C.isActive&&j===null||!D&&!C.prevProp||Qv(D)||typeof D=="boolean")continue;const A=IK(C.prevProp,D);let I=A||T===u&&C.isActive&&!z&&M||S>_&&M,k=!1;const V=Array.isArray(D)?D:[D];let B=V.reduce(i(T),{});j===!1&&(B={});const{prevResolvedValues:L={}}=C,P={...L,...B},Z=$=>{I=!0,m.has($)&&(k=!0,m.delete($)),C.needsAnimating[$]=!0;const Q=n.getValue($);Q&&(Q.liveStyle=!1)};for(const $ in P){const Q=B[$],re=L[$];if(b.hasOwnProperty($))continue;let ue=!1;y_(Q)&&y_(re)?ue=!Q4(Q,re):ue=Q!==re,ue?Q!=null?Z($):m.add($):Q!==void 0&&m.has($)?Z($):C.protectedKeys[$]=!0}C.prevProp=D,C.prevResolvedValues=B,C.isActive&&(b={...b,...B}),r&&n.blockInitialAnimation&&(I=!1);const K=z&&A;I&&(!K||k)&&p.push(...V.map($=>{const Q={type:T};if(typeof $=="string"&&r&&!K&&n.manuallyAnimateOnMount&&n.parent){const{parent:re}=n,ue=rd(re,$);if(re.enteringChildren&&ue){const{delayChildren:G}=ue.transition||{};Q.delay=X4(re.enteringChildren,n,G)}}return{animation:$,options:Q}}))}if(m.size){const S={};if(typeof d.initial!="boolean"){const T=rd(n,Array.isArray(d.initial)?d.initial[0]:d.initial);T&&T.transition&&(S.transition=T.transition)}m.forEach(T=>{const C=n.getBaseTarget(T),D=n.getValue(T);D&&(D.liveStyle=!0),S[T]=C??null}),p.push({animation:S})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(p):Promise.resolve()}function c(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),t[u].isActive=d;const h=o(u);for(const p in t)t[p].protectedKeys={};return h}return{animateChanges:o,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=cD()}}}function IK(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!Q4(e,n):!1}function Hl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function cD(){return{animate:Hl(!0),whileInView:Hl(),whileHover:Hl(),whileTap:Hl(),whileDrag:Hl(),whileFocus:Hl(),exit:Hl()}}class vl{constructor(e){this.isMounted=!1,this.node=e}update(){}}class RK extends vl{constructor(e){super(e),e.animationState||(e.animationState=CK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Qv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let DK=0;class kK extends vl{constructor(){super(...arguments),this.id=DK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const NK={animation:{Feature:RK},exit:{Feature:kK}};function ap(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Up(n){return{point:{x:n.pageX,y:n.pageY}}}const MK=n=>e=>zE(e)&&n(e,Up(e));function Ah(n,e,t,r){return ap(n,e,MK(t),r)}const J4=1e-4,PK=1-J4,OK=1+J4,e3=.01,VK=0-e3,jK=0+e3;function Lr(n){return n.max-n.min}function zK(n,e,t){return Math.abs(n-e)<=t}function uD(n,e,t,r=.5){n.origin=r,n.originPoint=bn(e.min,e.max,n.origin),n.scale=Lr(t)/Lr(e),n.translate=bn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=PK&&n.scale<=OK||isNaN(n.scale))&&(n.scale=1),(n.translate>=VK&&n.translate<=jK||isNaN(n.translate))&&(n.translate=0)}function Ch(n,e,t,r){uD(n.x,e.x,t.x,r?r.originX:void 0),uD(n.y,e.y,t.y,r?r.originY:void 0)}function dD(n,e,t){n.min=t.min+e.min,n.max=n.min+Lr(e)}function LK(n,e,t){dD(n.x,e.x,t.x),dD(n.y,e.y,t.y)}function fD(n,e,t){n.min=e.min-t.min,n.max=n.min+Lr(e)}function Ih(n,e,t){fD(n.x,e.x,t.x),fD(n.y,e.y,t.y)}function Pi(n){return[n("x"),n("y")]}const t3=({current:n})=>n?n.ownerDocument.defaultView:null,hD=(n,e)=>Math.abs(n-e);function BK(n,e){const t=hD(n.x,e.x),r=hD(n.y,e.y);return Math.sqrt(t**2+r**2)}class n3{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=$x(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=BK(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=m,{timestamp:S}=br;this.history.push({...w,timestamp:S});const{onStart:T,onMove:C}=this.handlers;b||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,m)},this.handlePointerMove=(m,b)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Hx(b,this.transformPagePoint),gn.update(this.updatePoint,!0)},this.handlePointerUp=(m,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=$x(m.type==="pointercancel"?this.lastMoveEventInfo:Hx(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),w&&w(m,T)},!zE(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const c=Up(e),u=Hx(c,this.transformPagePoint),{point:d}=u,{timestamp:h}=br;this.history=[{...d,timestamp:h}];const{onSessionStart:p}=t;p&&p(e,$x(u,this.history)),this.removeListeners=zp(Ah(this.contextWindow,"pointermove",this.handlePointerMove),Ah(this.contextWindow,"pointerup",this.handlePointerUp),Ah(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ll(this.updatePoint)}}function Hx(n,e){return e?{point:e(n.point)}:n}function pD(n,e){return{x:n.x-e.x,y:n.y-e.y}}function $x({point:n},e){return{point:n,delta:pD(n,r3(e)),offset:pD(n,UK(e)),velocity:FK(e,.1)}}function UK(n){return n[0]}function r3(n){return n[n.length-1]}function FK(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=r3(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>Qa(e)));)t--;if(!r)return{x:0,y:0};const a=Li(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function GK(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?bn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?bn(t,n,r.max):Math.min(n,t)),n}function gD(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function qK(n,{top:e,left:t,bottom:r,right:i}){return{x:gD(n.x,t,i),y:gD(n.y,e,r)}}function mD(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function HK(n,e){return{x:mD(n.x,e.x),y:mD(n.y,e.y)}}function $K(n,e){let t=.5;const r=Lr(n),i=Lr(e);return i>r?t=ep(e.min,e.max-r,n.min):r>i&&(t=ep(n.min,n.max-i,e.min)),Bs(0,1,t)}function YK(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const __=.35;function KK(n=__){return n===!1?n=0:n===!0&&(n=__),{x:vD(n,"left","right"),y:vD(n,"top","bottom")}}function vD(n,e,t){return{min:yD(n,e),max:yD(n,t)}}function yD(n,e){return typeof n=="number"?n:n[e]||0}const XK=new WeakMap;class WK{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Mn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Up(p).point)},o=(p,m)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=iY(b),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Pi(T=>{let C=this.getAxisMotionValue(T).get()||0;if(Za.test(C)){const{projection:D}=this.visualElement;if(D&&D.layout){const M=D.layout.layoutBox[T];M&&(C=Lr(M)*(parseFloat(C)/100))}}this.originPoint[T]=C}),w&&gn.postRender(()=>w(p,m)),b_(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},c=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:S}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=QK(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),S&&S(p,m)},u=(p,m)=>{this.latestPointerEvent=p,this.latestPanInfo=m,this.stop(p,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Pi(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:h}=this.getProps();this.panSession=new n3(e,{onSessionStart:a,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:r,contextWindow:t3(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&gn.postRender(()=>c(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Pm(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=GK(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Fu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=qK(r.layoutBox,e):this.constraints=!1,this.elastic=KK(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Pi(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=YK(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=eK(r,i.root,this.visualElement.getTransformPagePoint());let o=HK(i.layout.layoutBox,a);if(t){const c=t(QY(o));this.hasMutatedConstraints=!!c,c&&(o=L4(c))}return o}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=Pi(h=>{if(!Pm(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,b=i?40:1e7,_={type:"inertia",velocity:r?e[h]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(h,_)});return Promise.all(d).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return b_(this.visualElement,e),r.start(XE(e,r,0,t,this.visualElement,!1))}stopAnimation(){Pi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Pi(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Pi(t=>{const{drag:r}=this.getProps();if(!Pm(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:c}=i.layout.layoutBox[t];a.set(e[t]-bn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Fu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Pi(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();i[o]=$K({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Pi(o=>{if(!Pm(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(bn(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;XK.set(this.visualElement,this);const e=this.visualElement.current,t=Ah(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();Fu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),gn.read(r);const o=ap(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Pi(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=__,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:c}}}function Pm(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function QK(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class ZK extends vl{constructor(e){super(e),this.removeGroupControls=Ui,this.removeListeners=Ui,this.controls=new WK(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ui}unmount(){this.removeGroupControls(),this.removeListeners()}}const bD=n=>(e,t)=>{n&&gn.postRender(()=>n(e,t))};class JK extends vl{constructor(){super(...arguments),this.removePointerDownListener=Ui}onPointerDown(e){this.session=new n3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:t3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:bD(e),onStart:bD(t),onMove:r,onEnd:(a,o)=>{delete this.session,i&&gn.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Ah(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const m0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function xD(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const eh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(it.test(n))n=parseFloat(n);else return n;const t=xD(n,e.target.x),r=xD(n,e.target.y);return`${t}% ${r}%`}},eX={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=cl.parse(n);if(i.length>5)return r;const a=cl.createTransformer(n),o=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=c,i[1+o]/=u;const d=bn(c,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let Yx=!1;class tX extends U.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=e;TY(nX),a&&(t.group&&t.group.add(a),r&&r.register&&i&&r.register(a),Yx&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),m0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,Yx=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||gn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),jE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;Yx=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function i3(n){const[e,t]=T4(),r=U.useContext(gE);return v.jsx(tX,{...n,layoutGroup:r,switchLayoutGroup:U.useContext(j4),isPresent:e,safeToRemove:t})}const nX={borderRadius:{...eh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:eh,borderTopRightRadius:eh,borderBottomLeftRadius:eh,borderBottomRightRadius:eh,boxShadow:eX};function rX(n,e,t){const r=Cr(n)?n:_d(n);return r.start(XE("",r,e,t)),r.animation}const iX=(n,e)=>n.depth-e.depth;class aX{constructor(){this.children=[],this.isDirty=!1}add(e){yE(this.children,e),this.isDirty=!0}remove(e){bE(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(iX),this.isDirty=!1,this.children.forEach(e)}}function sX(n,e){const t=Zr.now(),r=({timestamp:i})=>{const a=i-t;a>=e&&(ll(r),n(a-e))};return gn.setup(r,!0),()=>ll(r)}const a3=["TopLeft","TopRight","BottomLeft","BottomRight"],oX=a3.length,_D=n=>typeof n=="string"?parseFloat(n):n,wD=n=>typeof n=="number"||it.test(n);function lX(n,e,t,r,i,a){i?(n.opacity=bn(0,t.opacity??1,cX(r)),n.opacityExit=bn(e.opacity??1,0,uX(r))):a&&(n.opacity=bn(e.opacity??1,t.opacity??1,r));for(let o=0;o<oX;o++){const c=`border${a3[o]}Radius`;let u=ED(e,c),d=ED(t,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||wD(u)===wD(d)?(n[c]=Math.max(bn(_D(u),_D(d),r),0),(Za.test(d)||Za.test(u))&&(n[c]+="%")):n[c]=d}(e.rotate||t.rotate)&&(n.rotate=bn(e.rotate||0,t.rotate||0,r))}function ED(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const cX=s3(0,.5,HO),uX=s3(.5,.95,Ui);function s3(n,e,t){return r=>r<n?0:r>e?1:t(ep(n,e,r))}function SD(n,e){n.min=e.min,n.max=e.max}function Ni(n,e){SD(n.x,e.x),SD(n.y,e.y)}function TD(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function AD(n,e,t,r,i){return n-=e,n=tv(n,1/t,r),i!==void 0&&(n=tv(n,1/i,r)),n}function dX(n,e=0,t=1,r=.5,i,a=n,o=n){if(Za.test(e)&&(e=parseFloat(e),e=bn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=bn(a.min,a.max,r);n===a&&(c-=e),n.min=AD(n.min,e,t,c,i),n.max=AD(n.max,e,t,c,i)}function CD(n,e,[t,r,i],a,o){dX(n,e[t],e[r],e[i],e.scale,a,o)}const fX=["x","scaleX","originX"],hX=["y","scaleY","originY"];function ID(n,e,t,r){CD(n.x,e,fX,t?t.x:void 0,r?r.x:void 0),CD(n.y,e,hX,t?t.y:void 0,r?r.y:void 0)}function RD(n){return n.translate===0&&n.scale===1}function o3(n){return RD(n.x)&&RD(n.y)}function DD(n,e){return n.min===e.min&&n.max===e.max}function pX(n,e){return DD(n.x,e.x)&&DD(n.y,e.y)}function kD(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function l3(n,e){return kD(n.x,e.x)&&kD(n.y,e.y)}function ND(n){return Lr(n.x)/Lr(n.y)}function MD(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class gX{constructor(){this.members=[]}add(e){yE(this.members,e),e.scheduleRender()}remove(e){if(bE(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function mX(n,e,t){let r="";const i=n.x.translate/e.x,a=n.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:b,skewY:_}=t;d&&(r=`perspective(${d}px) ${r}`),h&&(r+=`rotate(${h}deg) `),p&&(r+=`rotateX(${p}deg) `),m&&(r+=`rotateY(${m}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Kx=["","X","Y","Z"],vX=1e3;let yX=0;function Xx(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function c3(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=Y4(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",gn,!(i||a))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&c3(r)}function u3({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},c=e?.()){this.id=yX++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(_X),this.nodes.forEach(TX),this.nodes.forEach(AX),this.nodes.forEach(wX)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new aX)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new wE),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=S4(o)&&!uY(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),n){let h,p=0;const m=()=>this.root.updateBlockedByResize=!1;gn.read(()=>{p=window.innerWidth}),n(o,()=>{const b=window.innerWidth;b!==p&&(p=b,this.root.updateBlockedByResize=!0,h&&h(),h=sX(m,250),m0.hasAnimatedSinceResize&&(m0.hasAnimatedSinceResize=!1,this.nodes.forEach(VD)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||d.getDefaultTransition()||kX,{onLayoutAnimationStart:w,onLayoutAnimationComplete:S}=d.getProps(),T=!this.targetLayout||!l3(this.targetLayout,b),C=!p&&m;if(this.options.layoutRoot||this.resumeFrom||C||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const D={...OE(_,"layout"),onPlay:w,onComplete:S};(d.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D),this.setAnimationOrigin(h,C)}else p||VD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ll(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(CX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&c3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(PD);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(OD);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(SX),this.nodes.forEach(bX),this.nodes.forEach(xX)):this.nodes.forEach(OD),this.clearAllSnapshots();const c=Zr.now();br.delta=Bs(0,1e3/60,c-br.timestamp),br.timestamp=c,br.isProcessing=!0,jx.update.process(br),jx.preRender.process(br),jx.render.process(br),br.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,jE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(EX),this.sharedNodes.forEach(IX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Lr(this.snapshot.measuredBox.x)&&!Lr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Mn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!o3(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Wl(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),NX(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Mn();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(MX))){const{scroll:d}=this.root;d&&(Gu(c.x,d.offset.x),Gu(c.y,d.offset.y))}return c}removeElementScroll(o){const c=Mn();if(Ni(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:p}=d;d!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&Ni(c,o),Gu(c.x,h.offset.x),Gu(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const u=Mn();Ni(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&qu(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Wl(h.latestValues)&&qu(u,h.latestValues)}return Wl(this.latestValues)&&qu(u,this.latestValues),u}removeTransform(o){const c=Mn();Ni(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Wl(d.latestValues))continue;g_(d.latestValues)&&d.updateSnapshot();const h=Mn(),p=d.measurePageBox();Ni(h,p),ID(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return Wl(this.latestValues)&&ID(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==br.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=br.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Mn(),this.relativeTargetOrigin=Mn(),Ih(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ni(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Mn(),this.targetWithTransforms=Mn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),LK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ni(this.target,this.layout.layoutBox),U4(this.target,this.targetDelta)):Ni(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Mn(),this.relativeTargetOrigin=Mn(),Ih(this.relativeTargetOrigin,this.target,m.target),Ni(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||g_(this.parent.latestValues)||B4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===br.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Ni(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;JY(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Mn());const{target:b}=o;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(TD(this.prevProjectionDelta.x,this.projectionDelta.x),TD(this.prevProjectionDelta.y,this.projectionDelta.y)),Ch(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!MD(this.projectionDelta.x,this.prevProjectionDelta.x)||!MD(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Hu(),this.projectionDelta=Hu(),this.projectionDeltaWithTransform=Hu()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=Hu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Mn(),b=u?u.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,S=this.getStack(),T=!S||S.members.length<=1,C=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(DX));this.animationProgress=0;let D;this.mixTargetDelta=M=>{const j=M/1e3;jD(p.x,o.x,j),jD(p.y,o.y,j),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ih(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),RX(this.relativeTarget,this.relativeTargetOrigin,m,j),D&&pX(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=Mn()),Ni(D,this.relativeTarget)),w&&(this.animationValues=h,lX(h,d,this.latestValues,j,C,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=j},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(ll(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gn.update(()=>{m0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=_d(0)),this.currentAnimation=rX(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(vX),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:h}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&d3(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Mn();const p=Lr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=Lr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}Ni(c,u),qu(c,h),Ch(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new gX),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&Xx("z",o,d,this.animationValues);for(let h=0;h<Kx.length;h++)Xx(`rotate${Kx[h]}`,o,d,this.animationValues),Xx(`skew${Kx[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=g0(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=g0(c?.pointerEvents)||""),this.hasProjected&&!Wl(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=mX(this.projectionDeltaWithTransform,this.treeScale,h);u&&(p=u(h,p)),o.transform=p;const{x:m,y:b}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?o.opacity=d===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const _ in ip){if(h[_]===void 0)continue;const{correct:w,applyTo:S,isCSSVariable:T}=ip[_],C=p==="none"?h[_]:w(h[_],d);if(S){const D=S.length;for(let M=0;M<D;M++)o[S[M]]=C}else T?this.options.visualElement.renderState.vars[_]=C:o[_]=C}this.options.layoutId&&(o.pointerEvents=d===this?g0(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(PD),this.root.sharedNodes.clear()}}}function bX(n){n.updateLayout()}function xX(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:i}=n.options,a=e.source!==n.layout.source;i==="size"?Pi(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Lr(p);p.min=t[h].min,p.max=p.min+m}):d3(i,e.layoutBox,t)&&Pi(h=>{const p=a?e.measuredBox[h]:e.layoutBox[h],m=Lr(t[h]);p.max=p.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+m)});const o=Hu();Ch(o,t,e.layoutBox);const c=Hu();a?Ch(c,n.applyTransform(r,!0),e.measuredBox):Ch(c,t,e.layoutBox);const u=!o3(o);let d=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const b=Mn();Ih(b,e.layoutBox,p.layoutBox);const _=Mn();Ih(_,t,m.layoutBox),l3(b,_)||(d=!0),h.options.layoutRoot&&(n.relativeTarget=_,n.relativeTargetOrigin=b,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function _X(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function wX(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function EX(n){n.clearSnapshot()}function PD(n){n.clearMeasurements()}function OD(n){n.isLayoutDirty=!1}function SX(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function VD(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function TX(n){n.resolveTargetDelta()}function AX(n){n.calcProjection()}function CX(n){n.resetSkewAndRotation()}function IX(n){n.removeLeadSnapshot()}function jD(n,e,t){n.translate=bn(e.translate,0,t),n.scale=bn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function zD(n,e,t,r){n.min=bn(e.min,t.min,r),n.max=bn(e.max,t.max,r)}function RX(n,e,t,r){zD(n.x,e.x,t.x,r),zD(n.y,e.y,t.y,r)}function DX(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const kX={duration:.45,ease:[.4,0,.1,1]},LD=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),BD=LD("applewebkit/")&&!LD("chrome/")?Math.round:Ui;function UD(n){n.min=BD(n.min),n.max=BD(n.max)}function NX(n){UD(n.x),UD(n.y)}function d3(n,e,t){return n==="position"||n==="preserve-aspect"&&!zK(ND(e),ND(t),.2)}function MX(n){return n!==n.root&&n.scroll?.wasRoot}const PX=u3({attachResizeListener:(n,e)=>ap(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Wx={current:void 0},f3=u3({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Wx.current){const n=new PX({});n.mount(window),n.setOptions({layoutScroll:!0}),Wx.current=n}return Wx.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),OX={pan:{Feature:JK},drag:{Feature:ZK,ProjectionNode:f3,MeasureLayout:i3}};function FD(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=r[i];a&&gn.postRender(()=>a(e,Up(e)))}class VX extends vl{mount(){const{current:e}=this.node;e&&(this.unmount=aY(e,(t,r)=>(FD(this.node,r,"Start"),i=>FD(this.node,i,"End"))))}unmount(){}}class jX extends vl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zp(ap(this.node.current,"focus",()=>this.onFocus()),ap(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function GD(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=r[i];a&&gn.postRender(()=>a(e,Up(e)))}class zX extends vl{mount(){const{current:e}=this.node;e&&(this.unmount=cY(e,(t,r)=>(GD(this.node,r,"Start"),(i,{success:a})=>GD(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const w_=new WeakMap,Qx=new WeakMap,LX=n=>{const e=w_.get(n.target);e&&e(n)},BX=n=>{n.forEach(LX)};function UX({root:n,...e}){const t=n||document;Qx.has(t)||Qx.set(t,{});const r=Qx.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(BX,{root:n,...e})),r[i]}function FX(n,e,t){const r=UX(e);return w_.set(n,t),r.observe(n),()=>{w_.delete(n),r.unobserve(n)}}const GX={some:0,all:1};class qX extends vl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:GX[i]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return FX(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(HX(e,t))&&this.startObserver()}unmount(){}}function HX({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const $X={inView:{Feature:qX},tap:{Feature:zX},focus:{Feature:jX},hover:{Feature:VX}},YX={layout:{ProjectionNode:f3,MeasureLayout:i3}},KX={...NK,...$X,...OX,...YX},Wn=WY(KX,cK);function XX(n){n.values.forEach(e=>e.stop())}function E_(n,e){[...e].reverse().forEach(r=>{const i=n.getVariant(r);i&&KE(n,i),n.variantChildren&&n.variantChildren.forEach(a=>{E_(a,e)})})}function WX(n,e){if(Array.isArray(e))return E_(n,e);if(typeof e=="string")return E_(n,[e]);KE(n,e)}function QX(){const n=new Set,e={subscribe(t){return n.add(t),()=>void n.delete(t)},start(t,r){const i=[];return n.forEach(a=>{i.push(W4(a,t,{transitionOverride:r}))}),Promise.all(i)},set(t){return n.forEach(r=>{WX(r,t)})},stop(){n.forEach(t=>{XX(t)})},mount(){return()=>{e.stop()}}};return e}function ZX(){const n=Kv(QX);return vE(n.mount,[]),n}const JX=ZX,Ws=ow((n,e)=>({message:"",type:"neutral",isVisible:!1,undoAction:void 0,showToast:(t,r="neutral",i)=>{n({message:t,type:r,isVisible:!0,undoAction:i}),setTimeout(()=>{e().hideToast()},2e3)},hideToast:()=>{n({isVisible:!1})}})),eW=()=>{const{message:n,type:e,isVisible:t,undoAction:r,hideToast:i}=Ws(),a=()=>{switch(e){case"success":return"bg-green-500 dark:bg-green-600 text-white";case"error":return"bg-red-500 dark:bg-red-600 text-white";case"neutral":default:return"bg-gray-800 dark:bg-gray-900 text-white border border-gray-200 dark:border-gray-700"}};return v.jsx(Jr,{children:t&&v.jsx(Wn.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed top-4 left-4 right-4 z-[150] mt-[calc(env(safe-area-inset-top)+8px)]",children:v.jsxs("div",{className:`rounded-xl shadow-lg p-4 flex items-center justify-between ${a()}`,children:[v.jsx("div",{className:"flex items-center flex-1 min-w-0",children:v.jsx("span",{className:"text-sm font-medium whitespace-pre-line pr-2",children:n})}),v.jsxs("div",{className:"flex items-center gap-2 ml-3 flex-shrink-0",children:[r&&v.jsxs("button",{onClick:()=>{r(),i()},className:"px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg text-xs font-bold transition-colors",children:[v.jsx(m9,{size:14,className:"inline mr-1"}),"Undo"]}),v.jsx("button",{onClick:i,className:"p-1 hover:bg-black/10 dark:hover:bg-white/10 rounded-full transition-colors",children:v.jsx(xv,{size:16})})]})]})})})};class La extends U.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){this.props.resetKeys&&this.props.resetOnPropsChange&&this.props.resetKeys.some((r,i)=>r!==e.resetKeys?.[i])&&this.state.hasError&&this.resetErrorBoundary()}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:v.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[v.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 dark:bg-red-900/30 rounded-full",children:v.jsx(Zu,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white text-center mb-2",children:"Something went wrong"}),v.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6",children:"We're sorry, but something unexpected happened. You can try refreshing or going back to the home screen."}),!1,v.jsxs("div",{className:"flex flex-col gap-3",children:[v.jsxs("button",{onClick:this.resetErrorBoundary,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:[v.jsx(Vh,{className:"h-4 w-4"}),"Try Again"]}),v.jsxs("button",{onClick:()=>window.location.href="/#/",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-medium rounded-md transition-colors",children:[v.jsx(BL,{className:"h-4 w-4"}),"Go to Home"]})]})]})}):this.props.children}}const h3=n=>n?n instanceof Date?n:typeof n=="string"?new Date(n):typeof n=="number"?new Date(n):n?.toDate&&typeof n.toDate=="function"?n.toDate():new Date:new Date,Ql=n=>h3(n).toISOString(),tW=n=>{const e=h3(n);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},nW=n=>{const e=n.toLowerCase();return e==="income"?"Income":e==="expense"?"Expense":e==="transfer"?"Transfer":"Expense"},WE=n=>{const e=n;let t=0;typeof e.amount=="number"?t=e.amount:typeof e.amount=="string"&&(t=parseFloat(e.amount)),isNaN(t)&&(t=0);const r=Ql(e.date);return{id:e.id||"",userId:e.userId||"",envelopeId:e.envelopeId||"",amount:t,date:r,month:e.month||tW(r),description:e.description||"",merchant:e.merchant||void 0,type:nW(e.type||"expense"),reconciled:e.reconciled??!1,transferId:e.transferId||void 0,isAutomatic:e.isAutomatic||void 0,paymentMethod:e.paymentMethod?typeof e.paymentMethod=="string"?{id:e.paymentMethod,name:e.paymentMethod,network:"Visa",last4:"****",color:"#000000"}:e.paymentMethod:void 0}};class cc{static instance;static getInstance(){return cc.instance||(cc.instance=new cc),cc.instance}async restoreUserData(e,t){try{console.log(" BudgetService.restoreUserData: STARTING RESTORE for user:",e),await this.deleteAllUserData(e);const r=[{name:"envelopes",data:t.envelopes||[]},{name:"transactions",data:t.transactions||[]},{name:"envelopeAllocations",data:t.allocations?Object.values(t.allocations).flat():[]},{name:"monthlyBudgets",data:this.prepareMonthlyBudgetsData(t.allocations,t.incomeSources)},{name:"appSettings",data:t.appSettings?[t.appSettings]:[]}],i=[];for(const{name:o,data:c}of r)if(Array.isArray(c))for(const u of c){if(!u.id&&o!=="monthlyBudgets")continue;const d={...u,userId:e};let h=u.id;o==="monthlyBudgets"&&u.month&&(h=u.month);const p=Ut(xt,"users",e,o,h);i.push({ref:p,data:d})}console.log(` Prepared ${i.length} items for restoration.`);const a=450;for(let o=0;o<i.length;o+=a){const c=dH(xt);i.slice(o,o+a).forEach(d=>{c.set(d.ref,d.data)}),console.log(` Committing batch ${Math.floor(o/a)+1}/${Math.ceil(i.length/a)}...`),await c.commit()}console.log(" Restore completed successfully.")}catch(r){throw console.error(" BudgetService.restoreUserData failed:",r),new Error(`Failed to restore user data: ${r instanceof Error?r.message:"Unknown error"}`)}}async getEnvelopes(e){try{console.log(" BudgetService.getEnvelopes called for user:",e);const t=Oi(xt,"users",e,"envelopes"),a=(await Ba(t)).docs.map((o,c)=>({id:o.id,...o.data(),orderIndex:o.data().orderIndex??c})).sort((o,c)=>{const u=o.orderIndex??0,d=c.orderIndex??0;return u-d});return console.log(" Fetched envelopes:",a.length),a}catch(t){throw console.error(" BudgetService.getEnvelopes failed:",t),new Error(`Failed to fetch envelopes: ${t instanceof Error?t.message:"Unknown error"}`)}}async getTransactions(e){try{console.log(" BudgetService.getTransactions: Fetching for user",e);const t=Oi(xt,"users",e,"transactions"),r=Ls(t,xd("date","desc")),a=(await Ba(r)).docs.map(o=>{const c={id:o.id,...o.data()};return WE(c)});return console.log(` Fetched ${a.length} transactions`),a}catch(t){throw console.error(" BudgetService.getTransactions failed:",t),new Error(`Failed to fetch transactions: ${t instanceof Error?t.message:"Unknown error"}`)}}async createEnvelope(e){try{console.log(" BudgetService.createEnvelope called for user:",e.userId);const t=Oi(xt,"users",e.userId,"envelopes"),r=Ut(t),i=_t.now(),a={...e,createdAt:i,lastUpdated:i};za(r,a).catch(c=>console.error("Create env failed",c));const o={...e,id:r.id,createdAt:Ql(i),lastUpdated:Ql(i)};return console.log(" Created envelope (optimistic):",o.id),o}catch(t){throw console.error(" BudgetService.createEnvelope failed:",t),new Error(`Failed to create envelope: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelope(e,t){try{console.log(" BudgetService.updateEnvelope called for envelope:",t.id);const r=Ut(xt,"users",e,"envelopes",t.id);za(r,{...t,lastUpdated:_t.now()},{merge:!0}).catch(i=>console.error("Update env failed",i)),console.log(" Updated envelope (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateEnvelope failed:",r),new Error(`Failed to update envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteEnvelope(e,t){try{const r=Ut(xt,"users",e,"envelopes",t),i=Ls(Oi(xt,"users",e,"transactions"),sH("envelopeId","==",t)),o=(await Ba(i)).docs.map(c=>Ua(c.ref));await Promise.all([Ua(r),...o]),console.log(" Deleted envelope and associated transactions from Firestore:",t)}catch(r){throw console.error(" BudgetService.deleteEnvelope failed:",r),new Error(`Failed to delete envelope: ${r instanceof Error?r.message:"Unknown error"}`)}}async reorderEnvelopes(e,t){try{console.log(" BudgetService.reorderEnvelopes called for user:",e);const r=t.map(i=>{const a=Ut(xt,"users",e,"envelopes",i.id);return za(a,{orderIndex:i.orderIndex,lastUpdated:_t.now()},{merge:!0})});Promise.all(r).catch(i=>console.error("Reorder env failed",i)),console.log(" Reordered envelopes (optimistic)")}catch(r){throw console.error(" BudgetService.reorderEnvelopes failed:",r),new Error(`Failed to reorder envelopes: ${r instanceof Error?r.message:"Unknown error"}`)}}async createTransaction(e){try{console.log(" BudgetService.createTransaction called for user:",e.userId);const t=Oi(xt,"users",e.userId,"transactions"),r=Ut(t),i=_t.now(),o={...Object.fromEntries(Object.entries(e).filter(([u,d])=>d!==void 0)),createdAt:i};za(r,o).catch(u=>console.error("Create tx failed",u));const c={...e,id:r.id};return console.log(" Created transaction (optimistic):",c.id),c}catch(t){throw console.error(" BudgetService.createTransaction failed:",t),new Error(`Failed to create transaction: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateTransaction(e,t){try{console.log(" BudgetService.updateTransaction called for transaction:",t.id);const r=Object.fromEntries(Object.entries(t).filter(([a,o])=>o!==void 0)),i=Ut(xt,"users",e,"transactions",t.id);za(i,r,{merge:!0}).catch(a=>console.error("Update tx failed",a)),console.log(" Updated transaction (optimistic):",t.id)}catch(r){throw console.error(" BudgetService.updateTransaction failed:",r),new Error(`Failed to update transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async deleteTransaction(e,t){try{console.log(" BudgetService.deleteTransaction called for transaction:",t);const r=Ut(xt,"users",e,"transactions",t);Ua(r).catch(i=>console.error("Delete tx failed",i)),console.log(" Deleted transaction (optimistic):",t)}catch(r){throw console.error(" BudgetService.deleteTransaction failed:",r),new Error(`Failed to delete transaction: ${r instanceof Error?r.message:"Unknown error"}`)}}async createIncomeSource(e){try{console.log(" BudgetService.createIncomeSource (Embedded) called for user:",e.userId);const t=Ut(xt,"users",e.userId,"monthlyBudgets",e.month),r=_t.now(),i=`inc_${r.toMillis()}_${Math.random().toString(36).substring(2,9)}`,a={...e,id:i,amount:Number(e.amount),createdAt:r,updatedAt:r};sa(t,{incomeSources:uH(a),updatedAt:r}).catch(c=>{c.code==="not-found"?za(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[a],allocations:{},totalIncome:0,availableToBudget:0}).catch(u=>console.error("Failed to create monthly budget doc",u)):console.error("Create income failed",c)});const o={...e,id:i,amount:Number(e.amount),createdAt:Ql(r),updatedAt:Ql(r)};return console.log(" Created income source (optimistic/embedded):",o.id),o}catch(t){throw console.error(" BudgetService.createIncomeSource failed:",t),new Error(`Failed to create income source: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateIncomeSource(e,t,r,i){try{console.log(" BudgetService.updateIncomeSource (Embedded) called for source:",t);const a=Ut(xt,"users",e,"monthlyBudgets",r);Px(a).then(o=>{if(!o.exists())return;const d=(o.data().incomeSources||[]).map(h=>{if(h.id===t){const p={...h,...i,updatedAt:_t.now()};return i.amount!==void 0&&(p.amount=Number(i.amount)),p}return h});sa(a,{incomeSources:d,updatedAt:_t.now()})}).catch(o=>console.error("Update income failed",o)),console.log(" Updated income source (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateIncomeSource failed:",a),a}}async deleteIncomeSource(e,t,r){try{console.log(" BudgetService.deleteIncomeSource (Embedded) called for source:",t);const i=Ut(xt,"users",e,"monthlyBudgets",r);Px(i).then(a=>{if(!a.exists())return;const u=(a.data().incomeSources||[]).filter(d=>d.id!==t);sa(i,{incomeSources:u,updatedAt:_t.now()})}).catch(a=>console.error("Delete income failed",a)),console.log(" Deleted income source (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteIncomeSource failed:",i),new Error(`Failed to delete income source: ${i instanceof Error?i.message:"Unknown error"}`)}}async createEnvelopeAllocation(e){try{console.log(" BudgetService.createEnvelopeAllocation (Embedded) called for user:",e.userId);const t=Ut(xt,"users",e.userId,"monthlyBudgets",e.month),r=_t.now(),i={[`allocations.${e.envelopeId}`]:Number(e.budgetedAmount),updatedAt:r};sa(t,i).catch(o=>{o.code==="not-found"?za(t,{id:`${e.userId}_${e.month}`,userId:e.userId,month:e.month,createdAt:r,updatedAt:r,incomeSources:[],allocations:{[e.envelopeId]:Number(e.budgetedAmount)},totalIncome:0,availableToBudget:0}).catch(c=>console.error("Failed to create monthly budget doc",c)):console.error("Create allocation failed",o)});const a={...e,id:e.envelopeId,createdAt:Ql(r),updatedAt:Ql(r)};return console.log(" Created allocation (optimistic/embedded):",a.id),a}catch(t){throw console.error(" BudgetService.createEnvelopeAllocation failed:",t),new Error(`Failed to create envelope allocation: ${t instanceof Error?t.message:"Unknown error"}`)}}async updateEnvelopeAllocation(e,t,r,i){try{console.log(" BudgetService.updateEnvelopeAllocation (Embedded) called for envelope:",t);const a=Ut(xt,"users",e,"monthlyBudgets",r),o={updatedAt:_t.now()};i.budgetedAmount!==void 0&&(o[`allocations.${t}`]=Number(i.budgetedAmount)),sa(a,o).catch(c=>console.error("Update allocation failed",c)),console.log(" Updated allocation (optimistic/embedded):",t)}catch(a){throw console.error(" BudgetService.updateEnvelopeAllocation failed:",a),new Error(`Failed to update envelope allocation: ${a instanceof Error?a.message:"Unknown error"}`)}}async deleteEnvelopeAllocation(e,t,r){try{console.log(" BudgetService.deleteEnvelopeAllocation (Embedded) called for envelope:",t);const i=Ut(xt,"users",e,"monthlyBudgets",r);sa(i,{[`allocations.${t}`]:DR(),updatedAt:_t.now()}).catch(a=>console.error("Delete allocation failed",a)),console.log(" Deleted allocation (optimistic/embedded):",t)}catch(i){throw console.error(" BudgetService.deleteEnvelopeAllocation failed:",i),new Error(`Failed to delete envelope allocation: ${i instanceof Error?i.message:"Unknown error"}`)}}async getMonthData(e,t){try{console.log(` BudgetService.getMonthData (Embedded): Fetching for user ${e}, month ${t}`);const r=Ut(xt,"users",e,"monthlyBudgets",t),i=await Px(r);if(!i.exists())return console.log(` No budget data found for ${t}, returning empty defaults.`),{incomeSources:[],allocations:[]};const a=i.data(),o=(a.incomeSources||[]).map(d=>({...d,amount:Number(d.amount),createdAt:d.createdAt?.toDate?d.createdAt.toDate().toISOString():d.createdAt||new Date().toISOString(),updatedAt:d.updatedAt?.toDate?d.updatedAt.toDate().toISOString():d.updatedAt||new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime()),c=a.allocations||{},u=Object.entries(c).map(([d,h])=>({id:d,userId:e,envelopeId:d,month:t,budgetedAmount:Number(h),createdAt:a.createdAt?.toDate?a.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((d,h)=>new Date(d.createdAt).getTime()-new Date(h.createdAt).getTime());return console.log(` Fetched ${o.length} income sources and ${u.length} allocations for ${t}`),{incomeSources:o,allocations:u}}catch(r){throw console.error(" BudgetService.getMonthData failed:",r),new Error(`Failed to fetch month data: ${r instanceof Error?r.message:"Unknown error"}`)}}async cleanupOrphanedData(e){try{console.log(" BudgetService.cleanupOrphanedData: Starting cleanup for user:",e);const t={orphanedAllocationsDeleted:0,orphanedTransactionsDeleted:0,details:{deletedAllocationIds:[],deletedTransactionIds:[],monthsProcessed:[]}},r=await this.getEnvelopes(e),i=new Set(r.map(b=>b.id));console.log(` Found ${r.length} existing envelopes`);const a=Oi(xt,"users",e,"envelopeAllocations"),o=await Ba(a),c=[],u=new Set;for(const b of o.docs){const _=b.data();u.add(_.month),i.has(_.envelopeId)||(c.push(b.id),console.log(` Found orphaned allocation: ${b.id} for envelope ${_.envelopeId} in month ${_.month}`))}if(c.length>0){const b=c.map(_=>Ua(Ut(xt,"users",e,"envelopeAllocations",_)));await Promise.all(b),t.orphanedAllocationsDeleted+=c.length,t.details.deletedAllocationIds.push(...c),console.log(` Deleted ${c.length} orphaned allocations (legacy)`)}const d=Oi(xt,"users",e,"monthlyBudgets"),h=await Ba(d);for(const b of h.docs){const w=b.data().allocations||{},S={};let T=!1;Object.keys(w).forEach(C=>{i.has(C)||(S[`allocations.${C}`]=DR(),T=!0,console.log(` Found orphaned embedded allocation in ${b.id} for envelope ${C}`),t.orphanedAllocationsDeleted++,t.details.deletedAllocationIds.push(`${b.id}_${C}`))}),T&&(S.updatedAt=_t.now(),await sa(b.ref,S),u.add(b.id))}const p=await this.getTransactions(e),m=[];for(const b of p)i.has(b.envelopeId)||(m.push(b.id),console.log(` Found orphaned transaction: ${b.id} for envelope ${b.envelopeId}`));if(m.length>0){const b=m.map(_=>Ua(Ut(xt,"users",e,"transactions",_)));await Promise.all(b),t.orphanedTransactionsDeleted=m.length,t.details.deletedTransactionIds=m,console.log(` Deleted ${m.length} orphaned transactions`)}return t.details.monthsProcessed=Array.from(u),console.log(" Cleanup completed:",{orphanedAllocationsDeleted:t.orphanedAllocationsDeleted,orphanedTransactionsDeleted:t.orphanedTransactionsDeleted,monthsProcessed:t.details.monthsProcessed.length}),t}catch(t){throw console.error(" BudgetService.cleanupOrphanedData failed:",t),new Error(`Failed to cleanup orphaned data: ${t instanceof Error?t.message:"Unknown error"}`)}}subscribeToMonthlyBudget(e,t,r){const i=Ut(xt,"users",e,"monthlyBudgets",t);return Vp(i,a=>{if(!a.exists()){r({incomeSources:[],allocations:[]});return}const o=a.data(),c=(o.incomeSources||[]).map(h=>({...h,amount:Number(h.amount),createdAt:h.createdAt?.toDate?h.createdAt.toDate().toISOString():h.createdAt||new Date().toISOString(),updatedAt:h.updatedAt?.toDate?h.updatedAt.toDate().toISOString():h.updatedAt||new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime()),u=o.allocations||{},d=Object.entries(u).map(([h,p])=>({id:h,userId:e,envelopeId:h,month:t,budgetedAmount:Number(p),createdAt:o.createdAt?.toDate?o.createdAt.toDate().toISOString():new Date().toISOString(),updatedAt:o.updatedAt?.toDate?o.updatedAt.toDate().toISOString():new Date().toISOString()})).sort((h,p)=>new Date(h.createdAt).getTime()-new Date(p.createdAt).getTime());r({incomeSources:c,allocations:d})})}prepareMonthlyBudgetsData(e,t){const r=[],i=new Set;return e&&Object.keys(e).forEach(a=>i.add(a)),t&&Object.keys(t).forEach(a=>i.add(a)),i.forEach(a=>{const o=e?.[a]||[],c=t?.[a]||[],u={};o.forEach(h=>{u[h.envelopeId]=h.budgetedAmount});const d={month:a,userId:"",incomeSources:c,allocations:u,totalIncome:c.reduce((h,p)=>h+Number(p.amount||0),0),availableToBudget:c.reduce((h,p)=>h+Number(p.amount||0),0)-o.reduce((h,p)=>h+Number(p.budgetedAmount||0),0),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r.push(d)}),r}async deleteAllUserData(e){try{console.log(" BudgetService.deleteAllUserData: STARTING DELETION for user:",e);const t=["envelopes","transactions","incomeSources","envelopeAllocations","monthlyBudgets","appSettings"];for(const r of t){console.log(` Deleting collection: ${r}...`);const i=Oi(xt,"users",e,r),a=await Ba(i);if(a.empty){console.log("   (Empty collection)");continue}const o=a.docs.map(c=>Ua(c.ref));await Promise.all(o),console.log(`    Deleted ${a.size} documents from ${r}`)}console.log(" All user data deleted successfully.")}catch(t){throw console.error(" BudgetService.deleteAllUserData failed:",t),new Error(`Failed to delete all user data: ${t instanceof Error?t.message:"Unknown error"}`)}}}const QE=cc.getInstance(),Zx=n=>Oi(xt,"users",n,"transactions"),rW={subscribeToTransactions:(n,e)=>{const t=Ls(Zx(n),xd("date","desc"));return Vp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllTransactions:async n=>{console.log(` TransactionService.getAllTransactions: Fetching for user ${n}`);const e=Ls(Zx(n),xd("date","desc")),r=(await Ba(e)).docs.map(i=>{const a={id:i.id,...i.data()};return WE(a)});return console.log(` Fetched ${r.length} transactions:`,r.map(i=>({id:i.id,description:i.description,month:i.month}))),r},addTransaction:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create transaction");console.log(` TransactionService.addTransaction: Adding transaction for user ${e}:`,r),console.log(` Original transaction had temp ID: ${t}`);try{console.log(" About to call addDoc with:",r);const i=await Yv(Zx(e),r);console.log(" addDoc succeeded, docRef:",i),console.log(` Document ID: ${i.id}`),console.log(` Document path: ${i.path}`);const a={id:i.id,...r,userId:e};return console.log(" Final result object:",a),a}catch(i){throw console.error(" addDoc failed:",i),console.error("Error message:",i.message),i}},updateTransaction:async(n,e,t)=>{const r=Ut(xt,"users",n,"transactions",e);return await sa(r,t)},deleteTransaction:async(n,e)=>{console.log(` TransactionService.deleteTransaction: Deleting transaction ${e} for user ${n}`);try{const t=Ut(xt,"users",n,"transactions",e);console.log(` Deleting document at path: ${t.path}`),await Ua(t),console.log(` TransactionService.deleteTransaction: Successfully deleted transaction ${e}`)}catch(t){throw console.error(` TransactionService.deleteTransaction: Failed to delete transaction ${e}:`,t),console.error("Error message:",t.message),t}}},Jx=n=>Oi(xt,"users",n,"envelopes"),iW={subscribeToEnvelopes:(n,e)=>{const t=Ls(Jx(n),xd("orderIndex","asc"));return Vp(t,i=>{const a=i.docs.map(o=>{const c=o.data();return{id:o.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated}});e(a)})},getAllEnvelopes:async n=>{try{console.log(" EnvelopeService.getAllEnvelopes called for user:",n);const e=Jx(n),i=(await Ba(e)).docs.map((a,o)=>{const c=a.data();return{id:a.id,...c,createdAt:c.createdAt?.toDate?.()?c.createdAt.toDate().toISOString():c.createdAt,lastUpdated:c.lastUpdated?.toDate?.()?c.lastUpdated.toDate().toISOString():c.lastUpdated,orderIndex:c.orderIndex??o}}).sort((a,o)=>{const c=a.orderIndex??0,u=o.orderIndex??0;return c-u});return console.log(" Fetched envelopes:",i.length),i}catch(e){return console.error(" EnvelopeService.getAllEnvelopes failed:",e),[]}},createEnvelope:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create envelope");try{return{id:(await Yv(Jx(e),r)).id,...r,userId:e}}catch(i){throw console.error(" Envelope addDoc failed:",i),i}},saveEnvelope:async(n,e)=>{if(!e.id)throw new Error("Envelope ID is required for save operation");const t=Ut(xt,"users",n,"envelopes",e.id);return await za(t,e,{merge:!0})},updateBalance:async(n,e,t)=>{const r=Ut(xt,"users",n,"envelopes",e);return await sa(r,{currentBalance:t,lastUpdated:new Date().toISOString()})},deleteEnvelope:async(n,e)=>{console.log(` EnvelopeService.deleteEnvelope: Deleting envelope ${e} for user ${n}`);const t=Ut(xt,"users",n,"envelopes",e);await Ua(t),console.log(` EnvelopeService.deleteEnvelope: Successfully deleted envelope ${e}`)}},e1=n=>Oi(xt,"users",n,"distributionTemplates"),aW={subscribeToDistributionTemplates:(n,e)=>{const t=Ls(e1(n),xd("lastUsed","desc"));return Vp(t,i=>{const a=i.docs.map(o=>({id:o.id,...o.data()}));e(a)})},getAllDistributionTemplates:async n=>{const e=Ls(e1(n),xd("lastUsed","desc"));return(await Ba(e)).docs.map(r=>({id:r.id,...r.data()}))},createDistributionTemplate:async n=>{const{userId:e,id:t,...r}=n;if(!e)throw new Error("User ID is required to create distribution template");console.log(` DistributionTemplateService.createDistributionTemplate: Adding template for user ${e}:`,r);try{const i=await Yv(e1(e),r);console.log(" Template addDoc succeeded, docRef:",i);const a={id:i.id,...r,userId:e};return console.log(" Final template result object:",a),a}catch(i){throw console.error(" Template addDoc failed:",i),i}},saveDistributionTemplate:async(n,e)=>{const t=Ut(xt,"users",n,"distributionTemplates",e.id);return await za(t,e,{merge:!0})},updateDistributionTemplate:async(n,e,t)=>{const r=Ut(xt,"users",n,"distributionTemplates",e);return await sa(r,t)},deleteDistributionTemplate:async(n,e)=>{console.log(` DistributionTemplateService.deleteDistributionTemplate: Deleting template ${e} for user ${n}`);const t=Ut(xt,"users",n,"distributionTemplates",e);await Ua(t),console.log(` DistributionTemplateService.deleteDistributionTemplate: Successfully deleted template ${e}`)}},t1=n=>Oi(xt,"users",n,"appSettings"),sW={subscribeToAppSettings:(n,e)=>{const t=Ls(t1(n),CR(1));return Vp(t,i=>{if(i.empty){e(null);return}const a=i.docs.map(o=>({id:o.id,...o.data()}))[0];e(a)})},getAppSettings:async n=>{const e=Ls(t1(n),CR(1)),t=await Ba(e);if(t.empty)return null;const r=t.docs[0];return{id:r.id,...r.data()}},createAppSettings:async n=>{const{userId:e,...t}=n;if(!e)throw new Error("User ID is required to create app settings");console.log(` AppSettingsService.createAppSettings: Creating settings for user ${e}:`,t);try{const r=await Yv(t1(e),t);console.log(" Settings addDoc succeeded, docRef:",r);const i={id:r.id,...t,userId:e};return console.log(" Final settings result object:",i),i}catch(r){throw console.error(" Settings addDoc failed:",r),r}},saveAppSettings:async(n,e)=>{const t=Ut(xt,"users",n,"appSettings",e.id);return await za(t,e,{merge:!0})},updateAppSettings:async(n,e,t)=>{const r=Ut(xt,"users",n,"appSettings",e);return await sa(r,t)},deleteAppSettings:async(n,e)=>{console.log(` AppSettingsService.deleteAppSettings: Deleting settings ${e} for user ${n}`);const t=Ut(xt,"users",n,"appSettings",e);await Ua(t),console.log(` AppSettingsService.deleteAppSettings: Successfully deleted settings ${e}`)}},oW=n=>WE(n),lW=n=>({id:n.id,name:n.name||"",currentBalance:n.currentBalance||0,lastUpdated:n.lastUpdated?.toDate?.()?n.lastUpdated.toDate().toISOString():n.lastUpdated,isActive:n.isActive??!0,orderIndex:n.orderIndex??0,userId:n.userId||void 0,createdAt:n.createdAt?.toDate?.()?n.createdAt.toDate().toISOString():n.createdAt,isPiggybank:n.isPiggybank,piggybankConfig:n.piggybankConfig}),qD=(n,e)=>{if(window.__firebaseUnsubscribers){console.log(" Real-time subscriptions already active, skipping setup");return}console.log(" Setting up real-time Firebase subscriptions...");const t=n.getState().currentMonth;console.log(" Current month for subscriptions:",t);const r=iW.subscribeToEnvelopes(e,u=>{console.log(" Real-time sync: Envelopes updated",u.length);const d=u.map(lW),h=n.getState(),p=new Set(h.envelopes.map(_=>_.id)),m=new Set(d.map(_=>_.id)),b=[...d.filter(_=>p.has(_.id)),...h.envelopes.filter(_=>!m.has(_.id))];n.setState({envelopes:b})}),i=rW.subscribeToTransactions(e,u=>{console.log(" Real-time sync: Transactions updated",u.length);const d=u.map(oW),h=n.getState(),p=new Set(h.transactions.map(_=>`${_.id}-${_.month}`)),m=new Set(d.map(_=>`${_.id}-${_.month}`)),b=[...d.filter(_=>p.has(`${_.id}-${_.month}`)),...h.transactions.filter(_=>!m.has(`${_.id}-${_.month}`))];n.setState({transactions:b})}),a=aW.subscribeToDistributionTemplates(e,u=>{console.log(" Real-time sync: Templates updated from Firebase",u.length)}),o=sW.subscribeToAppSettings(e,u=>{console.log(" Real-time sync: Settings updated",u?"found":"null"),n.setState({appSettings:u})}),c=QE.subscribeToMonthlyBudget(e,t,u=>{console.log(` Real-time sync: Monthly budget updated (${u.incomeSources.length} sources, ${u.allocations.length} allocations)`);const d=n.getState();n.setState({incomeSources:{...d.incomeSources,[t]:u.incomeSources},allocations:{...d.allocations,[t]:u.allocations}})});window.__firebaseUnsubscribers={envelopes:r,transactions:i,templates:a,settings:o,monthlyBudget:c},console.log(" Real-time subscriptions active - cross-device sync enabled")},cW=n=>{const{useBudgetStore:e,useAuthStore:t,getCurrentUserId:r}=n;if(typeof window>"u")return;window.addEventListener("online",async()=>{console.log(" Browser online event detected"),e.setState({isOnline:!0})}),window.addEventListener("offline",()=>{console.log(" Browser offline event detected"),e.setState({isOnline:!1})}),e.setState({isOnline:navigator.onLine});const i=t.getState();i.isAuthenticated&&i.currentUser&&(console.log(" User already authenticated on app load, setting up real-time subscriptions"),qD(e,r())),t.subscribe(o=>{if(o.isAuthenticated&&o.currentUser)console.log(" User authenticated, setting up real-time subscriptions"),qD(e,r());else if(!o.isAuthenticated&&!o.isLoading){if(console.log(" User logged out, clearing data and unsubscribing"),window.__firebaseUnsubscribers){const c=window.__firebaseUnsubscribers;c.envelopes&&c.envelopes(),c.transactions&&c.transactions(),c.templates&&c.templates(),c.settings&&c.settings(),c.monthlyBudget&&c.monthlyBudget(),delete window.__firebaseUnsubscribers,console.log(" Cleaned up Firebase subscriptions")}e.getState().handleUserLogout()}});let a=e.getState().currentMonth;e.subscribe(o=>{if(o.currentMonth!==a&&o.isAuthenticated){console.log(" Month changed from",a,"to",o.currentMonth),a=o.currentMonth;const c=r();if(c&&window.__firebaseUnsubscribers){const u=window.__firebaseUnsubscribers;u.monthlyBudget&&u.monthlyBudget(),console.log(" Unsubscribed from old month data"),u.monthlyBudget=QE.subscribeToMonthlyBudget(c,o.currentMonth,d=>{console.log(" Real-time sync: Monthly budget updated for new month");const h=e.getState();e.setState({incomeSources:{...h.incomeSources,[o.currentMonth]:d.incomeSources},allocations:{...h.allocations,[o.currentMonth]:d.allocations}})}),console.log(" Subscribed to monthly data for new month:",o.currentMonth)}}})},uW=()=>ca.getState().currentUser?.id||"",Nn=cc.getInstance(),Pn=ow()(D9(gN((n,e)=>({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},currentMonth:new Date().toISOString().slice(0,7),isOnline:typeof navigator<"u"?navigator.onLine:!0,isReorderUnlocked:typeof localStorage<"u"?localStorage.getItem("envelopeReorderUnlocked")==="true":!1,isLoading:!1,error:null,toggleReorderUnlocked:()=>{const t=!e().isReorderUnlocked;n({isReorderUnlocked:t}),localStorage.setItem("envelopeReorderUnlocked",String(t))},clearMonthData:async t=>{try{n({isLoading:!0,error:null}),console.log(` Clearing all data for month: ${t}`);const i=(await hn(()=>Promise.resolve().then(()=>Tn),[]).then(o=>o.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const{monthlyBudgetService:a}=await hn(async()=>{const{monthlyBudgetService:o}=await import("./MonthlyBudgetService-CN4UGbjp.js");return{monthlyBudgetService:o}},[]);await a.clearMonthData(i.id,t),await e().init(),console.log(` Cleared month data for ${t}`),n({isLoading:!1})}catch(r){throw console.error(" clearMonthData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to clear month data"}),r}},fetchMonthData:async t=>{try{const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping month data fetch");return}console.log(`Fetching month data for: ${t}`);const a=await Nn.getMonthData(i.id,t),o=e();n({incomeSources:{...o.incomeSources,[t]:a.incomeSources},allocations:{...o.allocations,[t]:a.allocations}}),console.log(` Fetched month data for ${t}`),(async()=>{const u=e(),d=u.allocations[t]||[],h=u.transactions.filter(m=>m.month===t);let p=0;for(const m of d){const b=u.envelopes.find(w=>w.id===m.envelopeId);if(b?.isPiggybank)continue;const _=h.find(w=>w.envelopeId===m.envelopeId&&(w.description==="Monthly Budget Allocation"||w.description==="Monthly Allocation"||w.description==="Budgeted"||w.description==="Piggybank Contribution"));_?_.amount!==m.budgetedAmount&&(console.log(` Repairing mismatch for envelope ${b?.name||m.envelopeId}: Alloc ${m.budgetedAmount} vs Tx ${_.amount}`),await u.updateTransaction({..._,amount:m.budgetedAmount}),p++):m.budgetedAmount>0&&(console.log(` Repairing missing transaction for envelope ${b?.name||m.envelopeId}`),await u.addTransaction({description:"Budgeted",amount:m.budgetedAmount,envelopeId:m.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0}),p++)}p>0&&console.log(` Repaired ${p} allocation discrepancies for ${t}`)})().catch(u=>console.error("Verification failed:",u))}catch(r){console.error(` Failed to fetch month data for ${t}:`,r)}},removeEnvelopeFromMonth:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(` Removing envelope ${t} from month ${r}`);const i=e(),a=i.allocations[r]?.find(c=>c.envelopeId===t);a?await e().deleteEnvelopeAllocation(a.id):console.log(` No allocation found for envelope ${t} in ${r}`);const o=i.transactions.filter(c=>c.envelopeId===t&&(c.month===r||c.date.startsWith(r)));o.length>0&&(console.log(` Deleting ${o.length} transactions for envelope ${t} in ${r}`),await Promise.all(o.map(c=>e().deleteTransaction(c.id)))),n({isLoading:!1}),console.log(` Removed envelope ${t} from month ${r}`)}catch(i){throw console.error(" removeEnvelopeFromMonth failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to remove envelope from month"}),i}},setMonth:async t=>{n({currentMonth:t});const r=e();(r.incomeSources[t]===void 0||r.allocations[t]===void 0)&&(console.log(`Month ${t} data missing in store, fetching...`),n({isLoading:!0}),await e().fetchMonthData(t),n({isLoading:!1}))},init:async()=>{console.log("BudgetStore initializing...");const t=e();try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i){console.log("No user logged in, skipping data fetch"),n({isLoading:!1});return}console.log(`Fetching data for user: ${i.id}, month: ${t.currentMonth}`);const[a,o,c]=await Promise.all([Nn.getEnvelopes(i.id),Nn.getTransactions(i.id),Nn.getMonthData(i.id,t.currentMonth)]);n({envelopes:a,transactions:o,incomeSources:{...t.incomeSources,[t.currentMonth]:c.incomeSources},allocations:{...t.allocations,[t.currentMonth]:c.allocations},isLoading:!1,error:null}),console.log(` BudgetStore initialized: ${a.length} envelopes, ${o.length} transactions, ${c.incomeSources.length} income sources, ${c.allocations.length} allocations`)}catch(r){console.error(" BudgetStore initialization failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to initialize budget data"})}},addEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a={...t,userId:i.id},o=await Nn.createEnvelope(a);return n(c=>c.envelopes.some(d=>d.id===o.id)?{isLoading:!1}:{envelopes:[...c.envelopes,o],isLoading:!1}),console.log(" Added envelope:",o.id),o.id}catch(r){throw console.error(" addEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add envelope"}),r}},updateEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Nn.updateEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.map(o=>o.id===t.id?t:o),isLoading:!1})),console.log(" Updated envelope:",t.id)}catch(r){throw console.error(" updateEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update envelope"}),r}},deleteEnvelope:async t=>{try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Nn.deleteEnvelope(i.id,t),n(a=>({envelopes:a.envelopes.filter(o=>o.id!==t),transactions:a.transactions.filter(o=>o.envelopeId!==t),isLoading:!1})),console.log(" Deleted envelope:",t)}catch(r){throw console.error(" deleteEnvelope failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope"}),r}},reorderEnvelopes:async t=>{try{n({isLoading:!0,error:null});const r=e(),i=new Map;t.forEach((d,h)=>{i.set(d,h)});const a=r.envelopes.map(d=>{if(!i.has(d.id))return d;const h=i.get(d.id);return d.orderIndex===h?d:{...d,orderIndex:h}}),o=a.filter((d,h)=>d!==r.envelopes[h]);if(!o.length){n({isLoading:!1});return}const u=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!u)throw new Error("No authenticated user found");await Nn.reorderEnvelopes(u.id,o),n({envelopes:a,isLoading:!1}),console.log(" Reordered envelopes")}catch(r){throw console.error(" reorderEnvelopes failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to reorder envelopes"}),r}},addTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,userId:i.id,month:o},u=await Nn.createTransaction(c);n(d=>d.transactions.some(p=>p.id===u.id)?{isLoading:!1}:{transactions:[...d.transactions,u],isLoading:!1}),console.log(" Added transaction:",u.id)}catch(r){throw console.error(" addTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to add transaction"}),r}},updateTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=new Date(t.date),o=t.month||`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,c={...t,month:o};await Nn.updateTransaction(i.id,c),n(u=>({transactions:u.transactions.map(d=>d.id===t.id?c:d),isLoading:!1})),console.log(" Updated transaction:",t.id)}catch(r){throw console.error(" updateTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update transaction"}),r}},deleteTransaction:async t=>{try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");await Nn.deleteTransaction(i.id,t),n(a=>({transactions:a.transactions.filter(o=>o.id!==t),isLoading:!1})),console.log(" Deleted transaction:",t)}catch(r){throw console.error(" deleteTransaction failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete transaction"}),r}},restoreTransaction:async t=>{await e().updateTransaction(t)},transferFunds:async(t,r,i,a,o)=>{try{const c=o?typeof o=="string"?o:o.toISOString():new Date().toISOString(),u=`transfer-${Date.now()}-${Math.random()}`;await e().addTransaction({description:`Transfer to ${e().envelopes.find(d=>d.id===r)?.name||"envelope"}`,amount:i,envelopeId:t,date:c,type:"Expense",transferId:u,reconciled:!1}),await e().addTransaction({description:`Transfer from ${e().envelopes.find(d=>d.id===t)?.name||"envelope"}`,amount:i,envelopeId:r,date:c,type:"Income",transferId:u,reconciled:!1}),console.log(" Transfer completed")}catch(c){throw console.error(" transferFunds failed:",c),c}},fetchData:async()=>{await e().init()},renameEnvelope:async(t,r)=>{try{n({isLoading:!0,error:null});const a=e().envelopes.find(d=>d.id===t);if(!a)throw new Error("Envelope not found");n(d=>({envelopes:d.envelopes.map(h=>h.id===t?{...h,name:r}:h),isLoading:!0}));const c=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(d=>d.useAuthStore.getState())).currentUser;if(!c)throw new Error("No authenticated user found");const u={...a,name:r};await Nn.updateEnvelope(c.id,u),n({isLoading:!1}),console.log(" Renamed envelope:",t)}catch(i){throw console.error(" renameEnvelope failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to rename envelope"}),i}},getEnvelopeBalance:(t,r)=>{const i=e(),a=i.envelopes.find(o=>o.id===t);if(!a)return console.log(` getEnvelopeBalance: Envelope ${t} not found`),0;if(a.isPiggybank){const o=i.transactions.filter(p=>p.envelopeId===t),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}if(r){const o=i.transactions.filter(p=>p.envelopeId===t&&p.month===r),c=o.filter(p=>p.type==="Expense"),u=o.filter(p=>p.type==="Income"),d=c.reduce((p,m)=>p+(m.amount||0),0);return u.reduce((p,m)=>p+(m.amount||0),0)-d}return console.warn(` getEnvelopeBalance: Month not provided for non-piggybank envelope ${t}. Returning 0.`),0},resetData:async()=>{console.log(" Resetting all data"),n({isLoading:!0});try{const r=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(i=>i.useAuthStore.getState())).currentUser;r?(console.log(" Deleting all data from Firestore for user:",r.id),await Nn.deleteAllUserData(r.id)):console.warn(" No user logged in, only clearing local state"),n({envelopes:[],transactions:[],appSettings:null,incomeSources:{},allocations:{},isLoading:!1,error:null}),console.log(" Reset data complete")}catch(t){throw console.error(" resetData failed:",t),n({isLoading:!1,error:t instanceof Error?t.message:"Failed to reset data"}),t}},importData:async t=>{try{if(n({isLoading:!0,error:null}),!t||typeof t!="object")throw new Error("Invalid data format");const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(a=>a.useAuthStore.getState())).currentUser;if(!i)throw new Error("You must be logged in to restore data.");return console.log(" Starting Time Machine Restore for user:",i.id),await Nn.restoreUserData(i.id,t),console.log(" Reloading app state from cloud..."),await e().init(),n({isLoading:!1}),{success:!0,message:"Data restored successfully from backup."}}catch(r){return console.error(" importData failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to import data"}),{success:!1,message:r instanceof Error?r.message:"Import failed"}}},updateAppSettings:async t=>{try{n({isLoading:!0,error:null});const r=e(),i={id:r.appSettings?.id||"default",theme:t.theme??r.appSettings?.theme??"system",enableMoveableReorder:t.enableMoveableReorder??r.appSettings?.enableMoveableReorder??!0,userId:t.userId??r.appSettings?.userId};n({appSettings:i,isLoading:!1}),console.log(" Updated app settings")}catch(r){throw console.error(" updateAppSettings failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to update settings"}),r}},initializeAppSettings:async()=>{try{if(e().appSettings)return;n({appSettings:{id:"default",theme:"system",enableMoveableReorder:!0}}),console.log(" Initialized app settings")}catch(t){throw console.error(" initializeAppSettings failed:",t),n({error:t instanceof Error?t.message:"Failed to initialize settings"}),t}},updatePiggybankContribution:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating piggybank contribution:",{envelopeId:t,newAmount:r});const a=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(u=>u.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().envelopes.find(u=>u.id===t&&u.isPiggybank);if(!o)throw new Error("Piggybank not found");const c={...o,lastUpdated:new Date().toISOString(),piggybankConfig:{monthlyContribution:r,targetAmount:o.piggybankConfig?.targetAmount,color:o.piggybankConfig?.color,icon:o.piggybankConfig?.icon,paused:o.piggybankConfig?.paused??!1}};if(console.log(" Updating envelope in Firestore:",c),await Nn.updateEnvelope(a.id,c),console.log(" Envelope updated successfully"),n(u=>({envelopes:u.envelopes.map(d=>d.id===t?c:d),isLoading:!1})),!o.piggybankConfig?.paused)try{await e().setEnvelopeAllocation(t,r),setTimeout(()=>{e().transactions.find(d=>d.envelopeId===t&&(d.description==="Monthly Allocation"||d.description==="Piggybank Contribution"))||console.warn(" Piggybank contribution transaction not found after update")},1e3)}catch(u){console.error(" Failed to update piggybank contribution:",u)}console.log(" Piggybank contribution updated successfully")}catch(i){throw console.error(" updatePiggybankContribution failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update piggybank contribution"}),i}},addIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");console.log(" Adding income source:",{month:t,source:r});const o=await Nn.createIncomeSource({...r,userId:a.id,month:t});n(c=>{const u=c.incomeSources[t]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{incomeSources:{...c.incomeSources,[t]:[...u,o]},isLoading:!1}}),console.log(" Added income source:",o.id)}catch(i){throw console.error(" addIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to add income source"}),i}},updateIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Updating income source:",{month:t,sourceId:r.id}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.map(c=>c.id===r.id?{...r,updatedAt:new Date().toISOString()}:c)||[]},isLoading:!1}));const a=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Nn.updateIncomeSource(a.id,r.id,t,r),console.log(" Updated income source:",r.id)}catch(i){throw console.error(" updateIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update income source"}),i}},deleteIncomeSource:async(t,r)=>{try{n({isLoading:!0,error:null}),console.log(" Deleting income source:",{month:t,sourceId:r}),n(o=>({incomeSources:{...o.incomeSources,[t]:o.incomeSources[t]?.filter(c=>c.id!==r)||[]},isLoading:!1}));const a=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(o=>o.useAuthStore.getState())).currentUser;if(!a)return;await Nn.deleteIncomeSource(a.id,r,t),console.log(" Deleted income source:",r)}catch(i){throw console.error(" deleteIncomeSource failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to delete income source"}),i}},copyPreviousMonthAllocations:async t=>{try{n({isLoading:!0,error:null});const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(_=>_.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");console.log(" Copying allocations from previous month:",t);const[a,o]=t.split("-").map(Number);let c=a,u=o-1;u<1&&(c=a-1,u=12);const d=`${c}-${String(u).padStart(2,"0")}`,h=e().incomeSources[d]||[];if(console.log(` Found ${h.length} income sources from ${d}`),h.length>0){for(const _ of h){const{id:w,...S}=_;await e().addIncomeSource(t,S)}console.log(` Copied ${h.length} income sources to ${t}`)}const p=e().allocations[d]||[];console.log(` Found ${p.length} allocations from ${d}`);const m=p.filter(_=>!e().envelopes.find(S=>S.id===_.envelopeId)?.isPiggybank);if(m.length>0){for(const _ of m)await e().createEnvelopeAllocation({envelopeId:_.envelopeId,budgetedAmount:_.budgetedAmount,userId:i.id,month:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),_.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:_.budgetedAmount,envelopeId:_.envelopeId,type:"Income",month:t,date:`${t}-01T00:00:00`,reconciled:!1,isAutomatic:!0});console.log(` Copied ${m.length} regular allocations to ${t}`)}const b=e().envelopes.filter(_=>_.isPiggybank);console.log(` Processing ${b.length} piggybanks for ${t}`);for(const _ of b){const w=_.piggybankConfig?.monthlyContribution,S=_.piggybankConfig?.paused??!1;if(!S&&w&&w>0)try{console.log(` Setting piggybank allocation for ${_.name}: ${w}`),await e().setEnvelopeAllocation(_.id,w)}catch(T){console.error(` Failed to set allocation for piggybank ${_.name}:`,T)}else console.log(` Skipping piggybank ${_.name} (paused=${S}, contribution=${w})`)}n({isLoading:!1}),console.log(` Complete monthly setup copied to ${t}`)}catch(r){throw console.error(" copyPreviousMonthAllocations failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to copy allocations"}),r}},setEnvelopeAllocation:async(t,r)=>{try{n({isLoading:!0,error:null});const a=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!a)throw new Error("No authenticated user found");const o=e().currentMonth,c=e().envelopes.find(h=>h.id===t),u=c?.isPiggybank;console.log(` setEnvelopeAllocation called: envelopeId=${t}, amount=${r}, currentMonth=${o}, isPiggybank=${u}`);const d=e().allocations[o]?.find(h=>h.envelopeId===t);if(d?await e().updateEnvelopeAllocation(d.id,{budgetedAmount:r}):await e().createEnvelopeAllocation({envelopeId:t,budgetedAmount:r,userId:a.id,month:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),u&&r>0&&!c?.piggybankConfig?.paused){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));if(h){const p={...h,amount:r,description:"Piggybank Contribution"};await e().updateTransaction(p)}else{const p={description:"Piggybank Contribution",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}if(!u&&r>0){const h=e().transactions.find(p=>p.envelopeId===t&&p.month===o&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));if(h){const p={...h,amount:r,description:"Budgeted"};await e().updateTransaction(p)}else{const p={description:"Budgeted",amount:r,envelopeId:t,type:"Income",month:o,date:`${o}-01T00:00:00`,reconciled:!1,isAutomatic:!0};await e().addTransaction(p)}}console.log(" Envelope allocation set successfully")}catch(i){throw console.error(" setEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to set envelope allocation"}),i}},createEnvelopeAllocation:async t=>{try{const i=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!i)throw new Error("No authenticated user found");const a=e().currentMonth,o=await Nn.createEnvelopeAllocation({envelopeId:t.envelopeId,budgetedAmount:t.budgetedAmount,userId:i.id,month:a});n(c=>{const u=c.allocations[a]||[];return u.some(h=>h.id===o.id)?{isLoading:!1}:{allocations:{...c.allocations,[a]:[...u,o]},isLoading:!1}}),console.log(" Created envelope allocation:",o.id)}catch(r){throw console.error(" createEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to create envelope allocation"}),r}},updateEnvelopeAllocation:async(t,r)=>{try{console.log(" Updating envelope allocation:",{id:t,updates:r});const i=e().currentMonth,o=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(h=>h.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");const c=e().allocations[i]?.find(h=>h.id===t);if(!c)throw new Error("Allocation not found");const u=e().envelopes.find(h=>h.id===c.envelopeId),d=u?.isPiggybank;if(await Nn.updateEnvelopeAllocation(o.id,c.envelopeId,i,{budgetedAmount:r.budgetedAmount}),n(h=>({allocations:{...h.allocations,[i]:h.allocations[i]?.map(p=>p.id===t?{...p,...r,updatedAt:new Date().toISOString()}:p)||[]},isLoading:!1})),d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Allocation"||p.description==="Piggybank Contribution"));h?r.budgetedAmount>0&&!u?.piggybankConfig?.paused?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Piggybank Contribution"}):(r.budgetedAmount===0||u?.piggybankConfig?.paused)&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&!u?.piggybankConfig?.paused&&await e().addTransaction({description:"Piggybank Contribution",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}if(!d&&r.budgetedAmount!==void 0){const h=e().transactions.find(p=>p.envelopeId===c.envelopeId&&p.month===i&&(p.description==="Monthly Budget Allocation"||p.description==="Budgeted"));h?r.budgetedAmount>0?await e().updateTransaction({...h,amount:r.budgetedAmount,description:"Budgeted"}):r.budgetedAmount===0&&await e().deleteTransaction(h.id):r.budgetedAmount>0&&await e().addTransaction({description:"Budgeted",amount:r.budgetedAmount,envelopeId:c.envelopeId,type:"Income",month:i,date:`${i}-01T00:00:00`,reconciled:!1,isAutomatic:!0})}console.log(" Updated envelope allocation:",t)}catch(i){throw console.error(" updateEnvelopeAllocation failed:",i),n({isLoading:!1,error:i instanceof Error?i.message:"Failed to update envelope allocation"}),i}},deleteEnvelopeAllocation:async t=>{try{console.log(" Deleting envelope allocation:",t);const r=e().currentMonth,i=e().allocations[r]?.find(c=>c.id===t);if(!i){console.warn("Allocation not found in store, skipping delete");return}const o=(await hn(()=>Promise.resolve().then(()=>Tn),void 0).then(c=>c.useAuthStore.getState())).currentUser;if(!o)throw new Error("No authenticated user found");await Nn.deleteEnvelopeAllocation(o.id,i.envelopeId,r),n(c=>({allocations:{...c.allocations,[r]:c.allocations[r]?.filter(u=>u.id!==t)||[]},isLoading:!1})),console.log(" Deleted envelope allocation:",t)}catch(r){throw console.error(" deleteEnvelopeAllocation failed:",r),n({isLoading:!1,error:r instanceof Error?r.message:"Failed to delete envelope allocation"}),r}},refreshAvailableToBudget:async()=>{try{const t=e().currentMonth,r=e().allocations[t]||[],i=e().incomeSources[t]||[],a=r.reduce((u,d)=>u+d.budgetedAmount,0);return i.reduce((u,d)=>u+d.amount,0)-a}catch(t){throw console.error(" refreshAvailableToBudget failed:",t),n({error:t instanceof Error?t.message:"Failed to refresh available to budget"}),t}},updateOnlineStatus:async()=>{try{const t=typeof navigator<"u"?navigator.onLine:!0;n({isOnline:t}),console.log(" Online status updated:",t)}catch(t){console.error(" Failed to update online status:",t)}},handleUserLogout:()=>{console.log(" Clearing user data on logout"),n({envelopes:[],transactions:[],incomeSources:{},allocations:{},isLoading:!1,error:null})}}),{name:"budget-storage"})));cW({useBudgetStore:Pn,useAuthStore:ca,getCurrentUserId:uW});const dW=({onAddTransaction:n})=>{const e=qs(),t=va(),[r,i]=U.useState(!1),a=U.useRef(null),{isReorderUnlocked:o,toggleReorderUnlocked:c}=Pn(),u=p=>t.pathname===p;U.useEffect(()=>{const p=m=>{a.current&&!a.current.contains(m.target)&&i(!1)};if(r)return document.addEventListener("mousedown",p),document.addEventListener("touchstart",p),()=>{document.removeEventListener("mousedown",p),document.removeEventListener("touchstart",p)}},[r]);const d=[{path:"/reports",icon:v.jsx(cL,{className:"w-5 h-5"}),label:"Reports"},{path:"/analytics",icon:v.jsx(E0,{className:"w-5 h-5"}),label:"Analytics"},{path:"/budget-breakdown",icon:v.jsx(dL,{className:"w-5 h-5"}),label:"Budget Breakdown"}],h=({path:p,icon:m,label:b})=>{const _=u(p);return v.jsxs("button",{onClick:w=>{w.stopPropagation(),e(p)},className:`
          relative group flex flex-col items-center justify-center
          w-12 h-12 rounded-2xl transition-all duration-300
          ${_?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
        `,children:[v.jsx("div",{className:`transition-transform duration-300 ${_?"scale-110":"group-hover:scale-105"}`,children:m}),v.jsx("span",{className:"sr-only",children:b}),_&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]})};return v.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-[100] pointer-events-none safe-area-inset-bottom",children:v.jsxs("nav",{className:`
          pointer-events-auto
          flex items-center gap-1 p-2 pl-4 pr-4
          bg-white/60 dark:bg-zinc-900/60 backdrop-blur-xl
          border border-zinc-200/30 dark:border-zinc-800/30
          rounded-full shadow-2xl shadow-zinc-900/10
          transform transition-all duration-500 ease-out
        `,onClick:p=>p.stopPropagation(),onTouchStart:p=>p.stopPropagation(),onTouchEnd:p=>p.stopPropagation(),children:[v.jsx(h,{path:"/",label:"Budget",icon:v.jsx(bv,{className:"w-6 h-6"})}),v.jsx(h,{path:"/transactions",label:"Transactions",icon:v.jsx(FL,{className:"w-6 h-6"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsx("button",{onClick:p=>{if(p.stopPropagation(),i(!1),n){n();return}e("/add-transaction")},className:`
            -mt-8 mb-2 mx-1
            group relative flex items-center justify-center
            w-16 h-16 rounded-full
            bg-blue-600 text-white
            shadow-xl shadow-blue-600/30
            hover:shadow-blue-600/50 hover:scale-105 hover:-translate-y-1
            active:scale-95 active:translate-y-0
            transition-all duration-300 cubic-bezier(0.175, 0.885, 0.32, 1.275)
          `,children:v.jsx(hh,{className:"w-8 h-8 transition-transform duration-300 group-hover:rotate-90"})}),v.jsx("div",{className:"w-px h-8 bg-zinc-200 dark:bg-zinc-800 mx-2"}),v.jsxs("div",{className:"relative",ref:a,children:[v.jsxs("button",{onClick:p=>{p.stopPropagation(),i(!r)},className:`
              relative group flex flex-col items-center justify-center
              w-12 h-12 rounded-2xl transition-all duration-300
              ${r?"text-blue-500 bg-blue-50 dark:bg-blue-500/20 dark:text-blue-400":"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-800"}
            `,children:[v.jsx("div",{className:`transition-transform duration-300 ${r?"scale-110":"group-hover:scale-105"}`,children:v.jsx(hN,{className:"w-6 h-6"})}),v.jsx("span",{className:"sr-only",children:"More"}),r&&v.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-current rounded-full opacity-80"})]}),r&&v.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-56 bg-white dark:bg-zinc-900 rounded-2xl shadow-2xl border border-zinc-200/50 dark:border-zinc-800/50 backdrop-blur-xl z-50 overflow-hidden",onClick:p=>p.stopPropagation(),onTouchStart:p=>p.stopPropagation(),onTouchEnd:p=>p.stopPropagation(),children:v.jsxs("div",{className:"p-2 space-y-1",children:[d.map((p,m)=>v.jsxs("button",{onClick:b=>{b.stopPropagation(),e(p.path),i(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:"text-zinc-600 dark:text-zinc-400",children:p.icon}),v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:p.label})]},m)),v.jsx("div",{className:"h-px bg-zinc-100 dark:bg-zinc-800 mx-2 my-1"}),v.jsxs("button",{onClick:p=>{p.stopPropagation(),c()},className:"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-left",children:[v.jsx("div",{className:o?"text-blue-500":"text-zinc-600 dark:text-zinc-400",children:o?v.jsx(YL,{className:"w-5 h-5"}):v.jsx(XL,{className:"w-5 h-5"})}),v.jsxs("div",{className:"flex flex-col",children:[v.jsx("span",{className:"text-sm font-medium text-zinc-900 dark:text-white",children:"Reorder Envelopes"}),v.jsx("span",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:o?"Unlocked":"Locked"})]})]})]})})]}),v.jsx(h,{path:"/settings",label:"Settings",icon:v.jsx(o9,{className:"w-6 h-6"})})]})})};function fW(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.map(function(r){return r.split(" ").map(function(i){return i?""+n+i:""}).join(" ")}).join(" ")}function hW(n,e){return e.replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+n+"$1")+"{"})}function ks(n,e){return function(t){t&&(n[e]=t)}}function p3(n,e,t){return function(r){r&&(n[e][t]=r)}}function HD(n,e){return function(t){var r=t.prototype;n.forEach(function(i){e(r,i)})}}function pW(n,e){return e===void 0&&(e={}),function(t,r){n.forEach(function(i){var a=e[i]||i;a in t||(t[a]=function(){for(var o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=(o=this[r])[i].apply(o,c);return d===this[r]?this:d})})}}var gW="function",mW="object",vW="string",yW="number",ZE="undefined",g3=typeof window!==ZE,bW=typeof document!==ZE&&document,xW=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Yn=1e-7,Om={cm:function(n){return n*96/2.54},mm:function(n){return n*96/254},in:function(n){return n*96},pt:function(n){return n*96/72},pc:function(n){return n*96/6},"%":function(n,e){return n*e/100},vw:function(n,e){return e===void 0&&(e=window.innerWidth),n/100*e},vh:function(n,e){return e===void 0&&(e=window.innerHeight),n/100*e},vmax:function(n,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),n/100*e},vmin:function(n,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),n/100*e}};function _W(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function nv(n,e,t,r){return(n*r+e*t)/(t+r)}function Jv(n){return typeof n===ZE}function ga(n){return n&&typeof n===mW}function Qn(n){return Array.isArray(n)}function ei(n){return typeof n===vW}function Ed(n){return typeof n===yW}function JE(n){return typeof n===gW}function wW(n,e){var t=n===""||n==" ",r=e===""||e==" ";return r&&t||n===e}function m3(n,e,t,r,i){var a=eS(n,e,t);return a?t:EW(n,e,t+1,r,i)}function eS(n,e,t){if(!n.ignore)return null;var r=e.slice(Math.max(t-3,0),t+3).join("");return new RegExp(n.ignore).exec(r)}function EW(n,e,t,r,i){for(var a=function(d){var h=e[d].trim();if(h===n.close&&!eS(n,e,d))return{value:d};var p=d,m=ti(i,function(b){var _=b.open;return _===h});if(m&&(p=m3(m,e,d,r,i)),p===-1)return o=d,"break";d=p,o=d},o,c=t;c<r;++c){var u=a(c);if(c=o,typeof u=="object")return u.value;if(u==="break")break}return-1}function tS(n,e){var t=ei(e)?{separator:e}:e,r=t.separator,i=r===void 0?",":r,a=t.isSeparateFirst,o=t.isSeparateOnlyOpenClose,c=t.isSeparateOpenClose,u=c===void 0?o:c,d=t.openCloseCharacters,h=d===void 0?xW:d,p=h.map(function(A){var I=A.open,k=A.close;return I===k?I:I+"|"+k}).join("|"),m="(\\s*"+i+"\\s*|"+p+"|\\s+)",b=new RegExp(m,"g"),_=n.split(b).filter(function(A){return A&&A!=="undefined"}),w=_.length,S=[],T=[];function C(){return T.length?(S.push(T.join("")),T=[],!0):!1}for(var D=function(A){var I=_[A].trim(),k=A,V=ti(h,function(P){var Z=P.open;return Z===I}),B=ti(h,function(P){var Z=P.close;return Z===I});if(V){if(k=m3(V,_,A,w,h),k!==-1&&u)return C()&&a||(S.push(_.slice(A,k+1).join("")),A=k,a)?(M=A,"break"):(M=A,"continue")}else if(B&&!eS(B,_,A)){var L=_W(h);return L.splice(h.indexOf(B),1),{value:tS(n,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:u,openCloseCharacters:L})}}else if(wW(I,i)&&!o)return C(),a?(M=A,"break"):(M=A,"continue");k===-1&&(k=w-1),T.push(_.slice(A,k+1).join("")),A=k,M=A},M,j=0;j<w;++j){var z=D(j);if(j=M,typeof z=="object")return z.value;if(z==="break")break}return T.length&&S.push(T.join("")),S}function ul(n){return tS(n,"")}function uc(n){return tS(n,",")}function v3(n){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Fp(n){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(n);if(!e)return{prefix:"",unit:"",value:NaN};var t=e[1],r=e[2],i=e[3];return{prefix:t,unit:i,value:parseFloat(r)}}function SW(n){return n.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function v0(n,e){return n.replace(/([a-z])([A-Z])/g,function(t,r,i){return""+r+e+i.toLowerCase()})}function sp(){return Date.now?Date.now():new Date().getTime()}function Fs(n,e,t){t===void 0&&(t=-1);for(var r=n.length,i=0;i<r;++i)if(e(n[i],i,n))return i;return t}function ti(n,e,t){var r=Fs(n,e);return r>-1?n[r]:t}var y3=(function(){var n=sp(),e=g3&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(t){var r=sp(),i=setTimeout(function(){t(r-n)},1e3/60);return i}})(),TW=(function(){var n=g3&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return n?n.bind(window):function(e){clearTimeout(e)}})();function Gs(n){return Object.keys(n)}function AW(n){var e=Gs(n);return e.map(function(t){return n[t]})}function Jt(n,e){var t=Fp(n),r=t.value,i=t.unit;if(ga(e)){var a=e[i];if(a){if(JE(a))return a(r);if(Om[i])return Om[i](r,a)}}else if(i==="%")return r*e/100;return Om[i]?Om[i](r):r}function S_(n,e,t){return Math.max(e,Math.min(n,t))}function $D(n,e,t,r){return r===void 0&&(r=n[0]/n[1]),[[dt(e[0],Yn),dt(e[0]/r,Yn)],[dt(e[1]*r,Yn),dt(e[1],Yn)]].filter(function(i){return i.every(function(a,o){var c=e[o],u=dt(c,Yn);return t?a<=c||a<=u:a>=c||a>=u})})[0]||n}function b3(n,e,t,r){if(!r)return n.map(function(b,_){return S_(b,e[_],t[_])});var i=n[0],a=n[1],o=r===!0?i/a:r,c=$D(n,e,!1,o),u=c[0],d=c[1],h=$D(n,t,!0,o),p=h[0],m=h[1];return i<u||a<d?(i=u,a=d):(i>p||a>m)&&(i=p,a=m),[i,a]}function CW(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return t}function T_(n){for(var e=n.length,t=0,r=e-1;r>=0;--r)t+=n[r];return e?t/e:0}function On(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function IW(n){return[0,1].map(function(e){return T_(n.map(function(t){return t[e]}))})}function YD(n){var e=IW(n),t=On(e,n[0]),r=On(e,n[1]);return t<r&&r-t<Math.PI||t>r&&r-t<-Math.PI?1:-1}function Ns(n,e){return Math.sqrt(Math.pow((e?e[0]:0)-n[0],2)+Math.pow((e?e[1]:0)-n[1],2))}function dt(n,e){if(!e)return n;var t=1/e;return Math.round(n/e)/t}function KD(n,e){return n.forEach(function(t,r){n[r]=dt(n[r],e)}),n}function RW(n){for(var e=[],t=0;t<n;++t)e.push(t);return e}function x3(n){return n.reduce(function(e,t){return e.concat(t)},[])}function _3(n,e){n.indexOf(e)===-1&&n.push(e)}function tr(n,e){return n.classList?n.classList.contains(e):!!n.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function w3(n,e){n.classList?n.classList.add(e):n.className+=" "+e}function E3(n,e){if(n.classList)n.classList.remove(e);else{var t=new RegExp("(\\s|^)"+e+"(\\s|$)");n.className=n.className.replace(t," ")}}function yr(n,e,t,r){n.addEventListener(e,t,r)}function Jn(n,e,t,r){n.removeEventListener(e,t,r)}function Gd(n){return n?.ownerDocument||bW}function nS(n){return Gd(n).documentElement}function yl(n){return Gd(n).body}function nl(n){var e;return((e=n?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function S3(n){return n&&"postMessage"in n&&"blur"in n&&"self"in n}function qd(n){return ga(n)&&n.nodeName&&n.nodeType&&"ownerDocument"in n}var DW=(function(){function n(){this.keys=[],this.values=[]}var e=n.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,r){var i=this.keys,a=this.values,o=i.indexOf(t),c=o===-1?i.length:o;i[c]=t,a[c]=r},n})(),kW=(function(){function n(){this.object={}}var e=n.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,r){this.object[t]=r},n})(),NW=typeof Map=="function",MW=(function(){function n(){}var e=n.prototype;return e.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},e.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},e.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},n})();function PW(n,e){var t=[],r=[];return n.forEach(function(i){var a=i[0],o=i[1],c=new MW;t[a]=c,r[o]=c}),t.forEach(function(i,a){i.connect(t[a-1])}),n.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],c=i[1];if(o===c)return[0,0];var u=t[o],d=r[c-1],h=u.getIndex();u.disconnect(),d?u.connect(d,d.next):u.connect(void 0,t[0]);var p=u.getIndex();return[h,p]})}var OW=(function(){function n(t,r,i,a,o,c,u,d){this.prevList=t,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=c,this.changedBeforeAdded=u,this.fixed=d}var e=n.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=PW(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=t.filter(function(a,o){var c=a[0],u=a[1],d=r[o],h=d[0],p=d[1];if(c!==u)return i.push([h,p]),!0}),this.cachePureChanged=i},n})();function Gp(n,e,t){var r=NW?Map:t?kW:DW,i=t||function(C){return C},a=[],o=[],c=[],u=n.map(i),d=e.map(i),h=new r,p=new r,m=[],b=[],_={},w=[],S=0,T=0;return u.forEach(function(C,D){h.set(C,D)}),d.forEach(function(C,D){p.set(C,D)}),u.forEach(function(C,D){var M=p.get(C);typeof M>"u"?(++T,o.push(D)):_[M]=T}),d.forEach(function(C,D){var M=h.get(C);typeof M>"u"?(a.push(D),++S):(c.push([M,D]),T=_[D]||0,m.push([M-T,D-S]),b.push(D===M),M!==D&&w.push([M,D]))}),o.reverse(),new OW(n,e,a,o,w,c,m,b)}var VW=(function(){function n(t,r){t===void 0&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}var e=n.prototype;return e.update=function(t){var r=[].slice.call(t),i=Gp(this.list,r,this.findKeyCallback);return this.list=r,i},n})(),A_=function(n,e){return A_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},A_(n,e)};function qp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");A_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var qa=function(){return qa=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},qa.apply(this,arguments)};function T3(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function XD(n,e,t){for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function WD(n){var e=0;return n.map(function(t){return t==null?"$compat".concat(++e):"".concat(t)})}function A3(n){var e=[];return n.forEach(function(t){e=e.concat(Qn(t)?A3(t):t)}),e}function n1(n,e){if(!e)return n;for(var t in e)Jv(n[t])&&(n[t]=e[t]);return n}function rv(n,e){if(n===e)return!1;for(var t in n)if(!(t in e))return!0;for(var t in e)if(n[t]!==e[t])return!0;return!1}function QD(n){var e=n.className,t=T3(n,["className"]);return e!=null&&(t.class=e),delete t.style,delete t.children,t}function ZD(n){var e={},t={};for(var r in n)r.indexOf("on")===0?t[r]=n[r]:e[r]=n[r];return[e,t]}function ey(n){if(!n)return null;var e=n.b;return qd(e)?e:ey(n.c)}function C3(n){var e=n.parentNode;e&&e.removeChild(n)}function I3(n){n.forEach(function(e){e()})}function jW(){return this.constructor(this.props,this.context)}var rS=0,ty=(function(){function n(t,r,i,a,o,c,u){u===void 0&&(u={}),this.t=t,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=c,this.ps=u,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=n.prototype;return e.s=function(){return!0},e.u=function(t,r,i,a,o){var c=this,u=c.d,d=AW(r).filter(function(_){return _.$_req}),h=A3(d.map(function(_){return _.$_subs})),p=ti(h,function(_){return _.d===u});if(c.b&&!ei(i)&&!o&&!c.s(i.props,a)&&!p){var m=h.reduce(function(_,w){var S=w.d;return _[0]?_[0].d===S&&_.push(w):S>u&&_.push(w),_},[]);return m.forEach(function(_){Hp(_,_._ps,[_.o],t,r,!0)}),!1}c.o=i,c.ss(a);var b=c.ps;return ei(i)||(c.ps=i.props,c.ref=i.ref),iS(this),c.r(t,r,c.b?b:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this,r=t.ref,i=t.fr;r&&r(i?i.current:t.b)},n})();function R3(){return Object.__CROACT_CURRENT_INSTNACE__}function zW(){return rS}function LW(n){rS=n}function iS(n){return Object.__CROACT_CURRENT_INSTNACE__=n,rS=0,n}var aS=(function(){function n(t,r){t===void 0&&(t={}),this.props=t,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=n.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,r){return this.props!==t||this.state!==r},e.setState=function(t,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=qa(qa({},a.$_state),t),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,r){},e.componentWillUnmount=function(){},e.$_setState=function(t,r){var i=[],a=this.$_p,o=Hp(a.c,[a],[a.o],i,a._cs,qa(qa({},this.state),this.$_state),r);o&&(t&&i.push(t),I3(i),iS(null))},n})(),D3=(function(n){qp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}var t=e.prototype;return t.shouldComponentUpdate=function(r,i){return rv(this.props,r)||rv(this.state,i)},e})(aS);function k3(n){var e=function(t){e.current=t};return e.current=n,e}function BW(n){return n._fr=!0,n}function UW(n,e,t,r){var i,a;return!((i=n?.prototype)===null||i===void 0)&&i.render?a=new n(e,t):(a=new aS(e,t),a.constructor=n,n._fr?(r.fr=k3(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=jW),a.$_p=r,a}var FW=(function(n){qp(e,n);function e(r,i,a,o,c,u,d){d===void 0&&(d={});var h=n.call(this,r,i,a,o,c,u,n1(d,r.defaultProps))||this;return h.typ="comp",h._usefs=[],h._uefs=[],h._defs=[],h}var t=e.prototype;return t.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(n1(r,this.t.defaultProps),i||a.state)!==!1},t.r=function(r,i,a){var o,c,u=this,d=u.t;u.ps=n1(u.ps,u.t.defaultProps);var h=u.ps,p=!u.b,m=d.contextType,b=u.b,_=m?.get(u);u._cs=i,p?(b=UW(d,h,_,u),u.b=b):(b.props=h,b.context=_);var w=b.state;u._usefs=[],u._uefs=[];var S=b.render();((c=(o=S?.props)===null||o===void 0?void 0:o.children)===null||c===void 0?void 0:c.length)===0&&(S.props.children=u.ps.children);var T=qa(qa({},i),b.$_cs);Hp(u,u._ps,S?[S]:[],r,T),p?u._uefs.push(function(){m?.register(u),b.componentDidMount()}):u._uefs.push(function(){b.componentDidUpdate(a,w)}),r.push(function(){u._usefs.forEach(function(C){C()}),p?u.md():u.ud(),u._defs=u._uefs.map(function(C){return C()})})},t.ss=function(r){var i=this.b;!i||!r||(i.state=r)},t.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e})(ty);function GW(n,e,t){var r=sS(QD(n),QD(e)),i=r.added,a=r.removed,o=r.changed;for(var c in i)t.setAttribute(c,i[c]);for(var u in o)t.setAttribute(u,o[u][1]);for(var d in a)t.removeAttribute(d)}function qW(n,e,t){var r=sS(n,e),i=r.added,a=r.removed;for(var o in a)t.e(o,!0);for(var c in i)t.e(c)}function sS(n,e){var t=Gs(n),r=Gs(e),i=Gp(t,r,function(u){return u}),a={},o={},c={};return i.added.forEach(function(u){var d=r[u];a[d]=e[d]}),i.removed.forEach(function(u){var d=t[u];o[d]=n[d]}),i.maintained.forEach(function(u){var d=u[0],h=t[d],p=[n[h],e[h]];n[h]!==e[h]&&(c[h]=p)}),{added:a,removed:o,changed:c}}function HW(n,e,t){var r=t.style,i=sS(n,e),a=i.added,o=i.removed,c=i.changed;for(var u in a){var d=v0(u,"-");r.setProperty(d,a[u])}for(var u in c){var h=v0(u,"-");r.setProperty(h,c[u][1])}for(var u in o){var p=v0(u,"-");r.removeProperty(p)}}function $W(n){return n.replace(/^on/g,"").toLowerCase()}var YW=(function(n){qp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var t=e.prototype;return t.e=function(r,i){var a=this,o=a._es,c=a.b,u=$W(r);i?(Jn(c,u,o[r]),delete o[r]):(o[r]=function(d){var h,p;(p=(h=a.ps)[r])===null||p===void 0||p.call(h,d)},yr(c,u,o[r]))},t.s=function(r){return rv(this.ps,r)},t.r=function(r,i,a){var o,c=this,u=!c.b,d=c.ps;if(u){var h=ey(c.c),p=!1;c._svg||c.t==="svg"?p=!0:p=h&&h.ownerSVGElement,c._svg=p;var m=(o=c._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],b=c.t;if(m)c._hyd=[].slice.call(m.children||[]);else{var _=Gd(h);p?m=_.createElementNS("http://www.w3.org/2000/svg",b):m=_.createElement(b)}c.b=m}Hp(c,c._ps,d.children,r,i);var w=c.b,S=ZD(a),T=S[0],C=S[1],D=ZD(d),M=D[0],j=D[1];return GW(T,M,w),qW(C,j,c),HW(a.style||{},d.style||{},w),r.push(function(){u?c.md():c.ud()}),!0},t.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)Jn(a,o,i[o]);r._ps.forEach(function(c){c.un()}),r._es={},r._sel||C3(a)},e})(ty);function op(n){if(!n||qd(n))return n;var e=n.$_p._ps;return e.length?op(e[0].b):null}function N3(n){if(n){if(n.b&&qd(n.b))return n;var e=n._ps;return e.length?N3(e[0]):null}}function ua(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,c=T3(i,["key","ref"]);return{type:n,key:a,ref:o,props:qa(qa({},c),{children:x3(t).filter(function(u){return u!=null&&u!==!1})})}}var M3=(function(n){qp(e,n);function e(r,i){i===void 0&&(i=0);var a=n.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var t=e.prototype;return t.r=function(){return!0},t.un=function(){},e})(ty),KW=(function(n){qp(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r.typ="text",r}var t=e.prototype;return t.r=function(r){var i,a=this,o=!a.b;if(o){var c=ey(a.c),u=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=u||Gd(c).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},t.un=function(){C3(this.b)},e})(ty);function XW(n,e,t){var r=t.map(function(u){return ei(u)?null:u.key}),i=WD(e.map(function(u){return u.k})),a=WD(r),o=Gp(i,a,function(u){return u});o.removed.forEach(function(u){e.splice(u,1)[0].un()}),o.ordered.forEach(function(u){var d=u[0],h=u[1],p=e.splice(d,1)[0];e.splice(h,0,p);var m=op(p.b),b=op(e[h+1]&&e[h+1].b);m&&m.parentNode.insertBefore(m,b)}),o.added.forEach(function(u){e.splice(u,0,JD(t[u],r[u],u,n))});var c=o.maintained.filter(function(u){u[0];var d=u[1],h=t[d],p=e[d],m=ei(h)?"text_".concat(h):h.type;return m!==p.t?(p.un(),e.splice(d,1,JD(h,r[d],d,n)),!0):(p.i=d,!1)});return XD(XD([],o.added,!0),c.map(function(u){u[0];var d=u[1];return d}))}function WW(n,e){for(var t=n._ps,r=t.length,i=e.i+1;i<r;++i){var a=op(t[i].b);if(a)return a}return null}function JD(n,e,t,r){var i=r.d+1;if(ei(n)||Ed(n))return new KW("text_".concat(n),i,e,t,r,null,{});var a=n.type,o=typeof a=="string"?YW:FW;return new o(a,i,e,t,r,n.ref,n.props)}function Hp(n,e,t,r,i,a,o){var c=XW(n,e,t),u=n._hyd,d=e.filter(function(p,m){return p._hyd=u,p.u(r,i,t[m],a,o)});n.typ==="container"&&n._sel&&e.forEach(function(p){var m=N3(p);m&&(m._sel=!0)}),n._hyd=null;var h=ey(n);return h&&c.reverse().forEach(function(p){var m=e[p],b=op(m.b);if(b&&h!==b&&!b.parentNode){var _=WW(n,m);h.insertBefore(b,_)}}),d.length>0}function QW(n,e,t,r){t===void 0&&(t=e.__CROACT__),r===void 0&&(r={});var i=!!t;t||(t=new M3(e));var a=[];return Hp(t,t._ps,n?[n]:[],a,r,void 0,void 0),I3(a),iS(null),i||(e.__CROACT__=t),t}function ek(n,e,t){return!t&&n&&(t=new M3(e.parentElement),t._hyd=[e],t._sel=!0),QW(n,e,t),t}function P3(n){var e=R3(),t=e._hs||(e._hs=[]),r=zW(),i=t[r];if(LW(r+1),i){if(!rv(i.deps,n.deps))return i.updated=!1,i;t[r]=n}else t.push(n);return n.value=n.func(),n.updated=!0,n}function ZW(n,e){var t=P3({func:n,deps:e});return t.value}function JW(n){return ZW(function(){return k3(n)},[])}function O3(n,e,t){var r=R3(),i=P3({func:function(){return n},deps:e}),a=t?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=n(),i.effect}):a.push(function(){return i.effect})}function eQ(n,e,t){O3(function(){n?.(e())},t,!0)}function oS(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return!0;return!1}function V3(n,e){for(var t=n.length,r=0;r<t;++r)if(e(n[r],r))return n[r];return null}function j3(n){var e=n;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function lS(n,e){try{return new RegExp(n,"g").exec(e)}catch{return null}}function tQ(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var n=navigator.userAgentData,e=n.brands||n.uaList;return!!(e&&e.length)}function nQ(n,e){var t=lS("("+n+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return t?t[3]:""}function C_(n){return n.replace(/_/g,".")}function uh(n,e){var t=null,r="-1";return oS(n,function(i){var a=lS("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(t=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=nQ(i.versionTest.toLowerCase(),e)||r),r=C_(r),!0)}),{preset:t,version:r}}function Vm(n,e){var t={brand:"",version:"-1"};return oS(n,function(r){var i=z3(e,r);return i?(t.brand=r.id,t.version=r.versionAlias||i.version,t.version!=="-1"):!1}),t}function z3(n,e){return V3(n,function(t){var r=t.brand;return lS(""+e.test,r.toLowerCase())})}var L3=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],B3=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],I_=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],U3=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],F3=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function G3(n){return!!uh(U3,n).preset}function rQ(n){var e=j3(n),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:G3(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=uh(L3,e),o=a.preset,c=a.version,u=uh(F3,e),d=u.preset,h=u.version,p=uh(B3,e);if(r.chromium=!!p.preset,r.chromiumVersion=p.version,!r.chromium){var m=uh(I_,e);r.webkit=!!m.preset,r.webkitVersion=m.version}return d&&(i.name=d.id,i.version=h,i.majorVersion=parseInt(h,10)),o&&(r.name=o.id,r.version=c,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function iQ(n){var e=navigator.userAgentData,t=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=t[0],a=(e.platform||navigator.platform).toLowerCase(),o={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Vm(U3,t).brand||G3(j3())},c={name:"unknown",version:"-1",majorVersion:-1};o.webkit=!o.chromium&&oS(I_,function(m){return z3(t,m)});var u=Vm(B3,t);if(o.chromium=!!u.brand,o.chromiumVersion=u.version||"-1",!o.chromium){var d=Vm(I_,t);o.webkit=!!d.brand,o.webkitVersion=d.version||"-1"}var h=V3(F3,function(m){return new RegExp(""+m.test,"g").exec(a)});c.name=h?h.id:"";{var p=Vm(L3,t);o.name=p.brand||o.name,o.version=p.brand&&n?n.uaFullVersion:p.version}return o.webkit&&(c.name=r?"ios":"mac"),c.name==="ios"&&o.webview&&(o.version="-1"),c.version=C_(c.version),o.version=C_(o.version),c.majorVersion=parseInt(c.version,10),o.majorVersion=parseInt(o.version,10),{browser:o,os:c,isMobile:r,isHints:!0}}function aQ(n){return tQ()?iQ():rQ(n)}function sQ(n,e,t,r,i,a){for(var o=0;o<i;++o){var c=t+o*i,u=r+o*i;n[c]+=n[u]*a,e[c]+=e[u]*a}}function oQ(n,e,t,r,i){for(var a=0;a<i;++a){var o=t+a*i,c=r+a*i,u=n[o],d=e[o];n[o]=n[c],n[c]=u,e[o]=e[c],e[c]=d}}function lQ(n,e,t,r,i){for(var a=0;a<r;++a){var o=t+a*r;n[o]/=i,e[o]/=i}}function q3(n,e,t){for(var r=n.slice(),i=0;i<t;++i)r[i*t+e-1]=0,r[(e-1)*t+i]=0;return r[(e-1)*(t+1)]=1,r}function ts(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=n.slice(),r=cn(e),i=0;i<e;++i){var a=e*i+i;if(!dt(t[a],Yn)){for(var o=i+1;o<e;++o)if(t[e*i+o]){oQ(t,r,i,o,e);break}}if(!dt(t[a],Yn))return[];lQ(t,r,i,e,t[a]);for(var o=0;o<e;++o){var c=o,u=o+i*e,d=t[u];!dt(d,Yn)||i===o||sQ(t,r,c,i,e,-d)}}return r}function cQ(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=0;r<e;++r)for(var i=0;i<e;++i)t[i*e+r]=n[e*r+i];return t}function H3(n,e){e===void 0&&(e=Math.sqrt(n.length));for(var t=[],r=n[e*e-1],i=0;i<e-1;++i)t[i]=n[e*(e-1)+i]/r;return t[e-1]=0,t}function uQ(n,e){for(var t=cn(e),r=0;r<e-1;++r)t[e*(e-1)+r]=n[r]||0;return t}function kc(n,e){for(var t=n.slice(),r=n.length;r<e-1;++r)t[r]=0;return t[e-1]=1,t}function ma(n,e,t){if(e===void 0&&(e=Math.sqrt(n.length)),e===t)return n;for(var r=cn(t),i=Math.min(e,t),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*t+o]=n[a*e+o];r[(a+1)*t-1]=n[(a+1)*e-1],r[(t-1)*t+a]=n[(e-1)*e+a]}return r[t*t-1]=n[e*e-1],r}function iv(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=cn(n);return e.forEach(function(i){r=en(r,i,n)}),r}function en(n,e,t){t===void 0&&(t=Math.sqrt(n.length));var r=[],i=n.length/t,a=e.length/i;if(i){if(!a)return n}else return e;for(var o=0;o<t;++o)for(var c=0;c<a;++c){r[c*t+o]=0;for(var u=0;u<i;++u)r[c*t+o]+=n[u*t+o]*e[c*i+u]}return r}function Ot(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]+e[i];return r}function Ke(n,e){for(var t=Math.min(n.length,e.length),r=n.slice(),i=0;i<t;++i)r[i]=r[i]-e[i];return r}function dQ(n,e){return e===void 0&&(e=n.length===6),e?[n[0],n[1],0,n[2],n[3],0,n[4],n[5],1]:n}function $3(n,e){return e===void 0&&(e=n.length===9),e?[n[0],n[1],n[3],n[4],n[6],n[7]]:n}function Dr(n,e,t){t===void 0&&(t=e.length);var r=en(n,e,t),i=r[t-1];return r.map(function(a){return a/i})}function fQ(n,e){return en(n,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function hQ(n,e){return en(n,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function pQ(n,e){return en(n,Yp(e,4))}function jm(n,e){var t=e[0],r=t===void 0?1:t,i=e[1],a=i===void 0?1:i,o=e[2],c=o===void 0?1:o;return en(n,[r,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1],4)}function $p(n,e){return Dr(Yp(e,3),kc(n,3))}function r1(n,e){var t=e[0],r=t===void 0?0:t,i=e[1],a=i===void 0?0:i,o=e[2],c=o===void 0?0:o;return en(n,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,c,1],4)}function tk(n,e){return en(n,e,4)}function Yp(n,e){var t=Math.cos(n),r=Math.sin(n),i=cn(e);return i[0]=t,i[1]=r,i[e]=-r,i[e+1]=t,i}function cn(n){for(var e=n*n,t=[],r=0;r<e;++r)t[r]=r%(n+1)?0:1;return t}function cS(n,e){for(var t=cn(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[(e+1)*i]=n[i];return t}function Nc(n,e){for(var t=cn(e),r=Math.min(n.length,e-1),i=0;i<r;++i)t[e*(e-1)+i]=n[i];return t}function uS(n,e,t,r,i,a,o,c){var u=n[0],d=n[1],h=e[0],p=e[1],m=t[0],b=t[1],_=r[0],w=r[1],S=i[0],T=i[1],C=a[0],D=a[1],M=o[0],j=o[1],z=c[0],A=c[1],I=[u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,0,0,u,0,h,0,m,0,_,0,d,0,p,0,b,0,w,0,1,0,1,0,1,0,1,-S*u,-T*u,-C*h,-D*h,-M*m,-j*m,-z*_,-A*_,-S*d,-T*d,-C*p,-D*p,-M*b,-j*b,-z*w,-A*w],k=ts(I,8);if(!k.length)return[];var V=en(k,[S,T,C,D,M,j,z,A],8);return V[8]=1,ma(cQ(V),3,4)}var Rh=function(){return Rh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Rh.apply(this,arguments)};function gQ(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function lp(n,e){return e===void 0&&(e=0),Lu(Sd(n,e))}function mQ(n,e){var t=Dr(n,[e[0],e[1]||0,e[2]||0,1],4),r=t[3]||1;return[t[0]/r,t[1]/r,t[2]/r]}function Lu(n){var e=gQ();return n.forEach(function(t){var r=t.matrixFunction,i=t.functionValue;r&&(e=r(e,i))}),e}function Sd(n,e){e===void 0&&(e=0);var t=Qn(n)?n:ul(n);return t.map(function(r){var i=v3(r),a=i.prefix,o=i.value,c=null,u=a,d="";if(a==="translate"||a==="translateX"||a==="translate3d"){var h=ga(e)?Rh(Rh({},e),{"o%":e["%"]}):{"%":e,"o%":e},p=uc(o).map(function(P,Z){return Z===0&&"x%"in h?h["%"]=e["x%"]:Z===1&&"y%"in h?h["%"]=e["y%"]:h["%"]=e["o%"],Jt(P,h)}),m=p[0],b=p[1],_=b===void 0?0:b,w=p[2],S=w===void 0?0:w;c=r1,d=[m,_,S]}else if(a==="translateY"){var T=ga(e)?Rh({"%":e["y%"]},e):{"%":e},_=Jt(o,T);c=r1,d=[0,_,0]}else if(a==="translateZ"){var S=parseFloat(o);c=r1,d=[0,0,S]}else if(a==="scale"||a==="scale3d"){var C=uc(o).map(function(P){return parseFloat(P)}),D=C[0],M=C[1],j=M===void 0?D:M,z=C[2],A=z===void 0?1:z;c=jm,d=[D,j,A]}else if(a==="scaleX"){var D=parseFloat(o);c=jm,d=[D,1,1]}else if(a==="scaleY"){var j=parseFloat(o);c=jm,d=[1,j,1]}else if(a==="scaleZ"){var A=parseFloat(o);c=jm,d=[1,1,A]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var I=Fp(o),k=I.unit,V=I.value,B=k==="rad"?V:V*Math.PI/180;a==="rotate"||a==="rotateZ"?(u="rotateZ",c=pQ):a==="rotateX"?c=fQ:a==="rotateY"&&(c=hQ),d=B}else if(a==="matrix3d")c=tk,d=uc(o).map(function(P){return parseFloat(P)});else if(a==="matrix"){var L=uc(o).map(function(P){return parseFloat(P)});c=tk,d=[L[0],L[1],0,0,L[2],L[3],0,0,0,0,1,0,L[4],L[5],0,1]}else u="";return{name:a,functionName:u,value:o,matrixFunction:c,functionValue:d}})}var R_=function(n,e){return R_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},R_(n,e)};function vQ(n,e){R_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Y3=typeof Map=="function"?void 0:(function(){var n=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++n)}})(),K3=(function(n){vQ(e,n);function e(t){return t===void 0&&(t=[]),n.call(this,t,Y3)||this}return e})(VW);function yQ(n,e){return Gp(n,e,Y3)}var D_=function(){return D_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},D_.apply(this,arguments)};function bQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}var ny=(function(){function n(){this._events={}}var e=n.prototype;return e.on=function(t,r){if(ga(t))for(var i in t)this.on(i,t[i]);else this._addEvent(t,r,{});return this},e.off=function(t,r){if(!t)this._events={};else if(ga(t))for(var i in t)this.off(i);else if(!r)this._events[t]=[];else{var a=this._events[t];if(a){var o=Fs(a,function(c){return c.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(t,r){var i=this;return r&&this._addEvent(t,r,{once:!0}),new Promise(function(a){i._addEvent(t,a,{once:!0})})},e.emit=function(t,r){var i=this;r===void 0&&(r={});var a=this._events[t];if(!t||!a)return!0;var o=!1;return r.eventType=t,r.stop=function(){o=!0},r.currentTarget=this,bQ(a).forEach(function(c){c.listener(r),c.once&&i.off(t,c.listener)}),!o},e.trigger=function(t,r){return r===void 0&&(r={}),this.emit(t,r)},e._addEvent=function(t,r,i){var a=this._events;a[t]=a[t]||[];var o=a[t];o.push(D_({listener:r},i))},n})();var k_=function(n,e){return k_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},k_(n,e)};function xQ(n,e){k_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $u=function(){return $u=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},$u.apply(this,arguments)};function _Q(n){var e=n.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function nk(n,e){return n.addEventListener("scroll",e),function(){n.removeEventListener("scroll",e)}}function zm(n){if(n){if(ei(n))return document.querySelector(n)}else return null;if(JE(n))return n();if(n instanceof Element)return n;if("current"in n)return n.current;if("value"in n)return n.value}var wQ=(function(n){xQ(e,n);function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var t=e.prototype;return t.dragStart=function(r,i){var a=zm(i.container);if(!a){this._flag=!1;return}var o=0,c=0,u=0,d=0;if(a===document.body)u=window.innerWidth,d=window.innerHeight;else{var h=a.getBoundingClientRect();o=h.top,c=h.left,u=h.width,d=h.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:c,width:u,height:d},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},t.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,c=i.threshold,u=c===void 0?0:c,d=this,h=d._startRect,p=d._startPos;this._currentOptions=i;var m=[0,0];return h.top>o-u?(p[1]>h.top||o<p[1])&&(m[1]=-1):h.top+h.height<o+u&&(p[1]<h.top+h.height||o>p[1])&&(m[1]=1),h.left>a-u?(p[0]>h.left||a<p[0])&&(m[0]=-1):h.left+h.width<a+u&&(p[0]<h.left+h.width||a>p[0])&&(m[0]=1),!m[0]&&!m[1]?!1:this._continueDrag($u($u({},i),{direction:m,inputEvent:r,isDrag:!0}))}},t.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,c=r.direction,u=r.throttleTime,d=u===void 0?0:u,h=r.inputEvent,p=r.isDrag,m=this._getScrollPosition(c||[0,0],r),b=m[0]-o[0],_=m[1]-o[1],w=c||[b?Math.abs(b)/b:0,_?Math.abs(_)/_:0];return this._prevScrollPos=m,this._lock=!1,!b&&!_?!1:(this.emit("move",{offsetX:w[0]?b:0,offsetY:w[1]?_:0,inputEvent:h}),d&&p&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},d)),!0)},t.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},t._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,c=o===void 0?_Q:o;return c({container:zm(a),direction:r})},t._continueDrag=function(r){var i=this,a,o=r.container,c=r.direction,u=r.throttleTime,d=r.useScroll,h=r.isDrag,p=r.inputEvent;if(!(!this._flag||h&&this._isWait)){var m=sp(),b=Math.max(u+this._prevTime-m,0);if(b>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},b),!1;this._prevTime=m;var _=this._getScrollPosition(c,r);this._prevScrollPos=_,h&&(this._isWait=!0),d||(this._lock=!0);var w={container:zm(o),direction:c,inputEvent:p};return(a=r.requestScroll)===null||a===void 0||a.call(r,w),this.emit("scroll",w),this._isWait=!1,d||this.checkScroll($u($u({},r),{prevScrollPos:_,direction:c,inputEvent:p}))}},t._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?nk:i,o=zm(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=nk(window,this._onScroll):this._unregister=a(o,this._onScroll)}},t._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e})(ny);function EQ(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)r[i]=a[o];return r}function Wr(n){return dt(n,Yn)}function SQ(n,e){return n.every(function(t,r){return Wr(t-e[r])===0})}function TQ(n,e){return!Wr(n[0]-e[0])&&!Wr(n[1]-e[1])}function X3(n){return n.length<3?0:Math.abs(CW(n.map(function(e,t){var r=n[t+1]||n[0];return e[0]*r[1]-r[0]*e[1]})))/2}function rk(n,e){var t=e.width,r=e.height,i=e.left,a=e.top,o=Mc(n),c=o.minX,u=o.minY,d=o.maxX,h=o.maxY,p=t/(d-c),m=r/(h-u);return n.map(function(b){return[i+(b[0]-c)*p,a+(b[1]-u)*m]})}function Mc(n){var e=n.map(function(r){return r[0]}),t=n.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function N_(n,e,t){var r=n[0],i=n[1],a=Mc(e),o=a.minX,c=a.maxX,u=[[o,i],[c,i]],d=av(u[0],u[1]),h=M_(e),p=[];if(h.forEach(function(_){var w=av(_[0],_[1]),S=_[0];if(SQ(d,w))p.push({pos:n,line:_,type:"line"});else{var T=W3(dS(d,w),[u,_]);T.forEach(function(C){_.some(function(D){return TQ(D,C)})?p.push({pos:C,line:_,type:"point"}):Wr(S[1]-i)!==0&&p.push({pos:C,line:_,type:"intersection"})})}}),ti(p,function(_){return _[0]===r}))return!0;var m=0,b={};return p.forEach(function(_){var w=_.pos,S=_.type,T=_.line;if(!(w[0]>r))if(S==="intersection")++m;else{if(S==="line")return;if(S==="point"){var C=ti(T,function(j){return j[1]!==i}),D=b[w[0]],M=C[1]>i?1:-1;D?D!==M&&++m:b[w[0]]=M}}}),m%2===1}function av(n,e){var t=n[0],r=n[1],i=e[0],a=e[1],o=i-t,c=a-r;Math.abs(o)<Yn&&(o=0),Math.abs(c)<Yn&&(c=0);var u=0,d=0,h=0;return o?c?(u=-c/o,d=1,h=-u*t-r):(d=1,h=-r):c&&(u=-1,h=t),[u,d,h]}function dS(n,e){var t=n[0],r=n[1],i=n[2],a=e[0],o=e[1],c=e[2],u=t===0&&a===0,d=r===0&&o===0,h=[];if(u&&d)return[];if(u){var p=-i/r,m=-c/o;return p!==m?[]:[[-1/0,p],[1/0,p]]}else if(d){var b=-i/t,_=-c/a;return b!==_?[]:[[b,-1/0],[b,1/0]]}else if(t===0){var w=-i/r,S=-(o*w+c)/a;h=[[S,w]]}else if(a===0){var w=-c/o,S=-(r*w+i)/t;h=[[S,w]]}else if(r===0){var S=-i/t,w=-(a*S+c)/o;h=[[S,w]]}else if(o===0){var S=-c/a,w=-(t*S+i)/r;h=[[S,w]]}else{var S=(r*c-o*i)/(o*t-r*a),w=-(t*S+i)/r;h=[[S,w]]}return h.map(function(T){return[T[0],T[1]]})}function W3(n,e){var t=e.map(function(p){return[0,1].map(function(m){return[Math.min(p[0][m],p[1][m]),Math.max(p[0][m],p[1][m])]})}),r=[];if(n.length===2){var i=n[0],a=i[0],o=i[1];if(Wr(a-n[1][0])){if(!Wr(o-n[1][1])){var d=Math.max.apply(Math,t.map(function(p){return p[0][0]})),h=Math.min.apply(Math,t.map(function(p){return p[0][1]}));if(Wr(d-h)>0)return[];r=[[d,o],[h,o]]}}else{var c=Math.max.apply(Math,t.map(function(p){return p[1][0]})),u=Math.min.apply(Math,t.map(function(p){return p[1][1]}));if(Wr(c-u)>0)return[];r=[[a,c],[a,u]]}}return r.length||(r=n.filter(function(p){var m=p[0],b=p[1];return t.every(function(_){return 0<=Wr(m-_[0][0])&&0<=Wr(_[0][1]-m)&&0<=Wr(b-_[1][0])&&0<=Wr(_[1][1]-b)})})),r.map(function(p){return[Wr(p[0]),Wr(p[1])]})}function M_(n){return EQ(n.slice(1),[n[0]]).map(function(e,t){return[n[t],e]})}function AQ(n,e){var t=n.slice(),r=e.slice();YD(t)===-1&&t.reverse(),YD(r)===-1&&r.reverse();var i=M_(t),a=M_(r),o=i.map(function(h){return av(h[0],h[1])}),c=a.map(function(h){return av(h[0],h[1])}),u=[];o.forEach(function(h,p){var m=i[p],b=[];c.forEach(function(_,w){var S=dS(h,_),T=W3(S,[m,a[w]]);b.push.apply(b,T.map(function(C){return{index1:p,index2:w,pos:C,type:"intersection"}}))}),b.sort(function(_,w){return Ns(m[0],_.pos)-Ns(m[0],w.pos)}),u.push.apply(u,b),N_(m[1],r)&&u.push({index1:p,index2:-1,pos:m[1],type:"inside"})}),a.forEach(function(h,p){if(N_(h[1],t)){var m=!1,b=Fs(u,function(_){var w=_.index2;return w===p?(m=!0,!1):!!m});b===-1&&(m=!1,b=Fs(u,function(_){var w=_.index1,S=_.index2;return w===-1&&S+1===p?(m=!0,!1):!!m})),b===-1?u.push({index1:-1,index2:p,pos:h[1],type:"inside"}):u.splice(b,0,{index1:-1,index2:p,pos:h[1],type:"inside"})}});var d={};return u.filter(function(h){var p=h.pos,m=p[0]+"x"+p[1];return d[m]?!1:(d[m]=!0,!0)})}function CQ(n,e){var t=AQ(n,e);return t.map(function(r){var i=r.pos;return i})}function IQ(n,e){var t=CQ(n,e);return X3(t)}var P_=function(n,e){return P_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},P_(n,e)};function RQ(n,e){P_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var qn=function(){return qn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},qn.apply(this,arguments)};function DQ(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=Math.atan2(r,t);return i>=0?i:i+Math.PI*2}function i1(n){return DQ([n[0].clientX,n[0].clientY],[n[1].clientX,n[1].clientY])/Math.PI*180}function kQ(n){return n.touches&&n.touches.length>=2}function Lm(n){return n?n.touches?MQ(n.touches):[Q3(n)]:[]}function NQ(n){return n&&(n.type.indexOf("mouse")>-1||"button"in n)}function ik(n,e,t){var r=t.length,i=Dh(n,r),a=i.clientX,o=i.clientY,c=i.originalClientX,u=i.originalClientY,d=Dh(e,r),h=d.clientX,p=d.clientY,m=Dh(t,r),b=m.clientX,_=m.clientY,w=a-h,S=o-p,T=a-b,C=o-_;return{clientX:c,clientY:u,deltaX:w,deltaY:S,distX:T,distY:C}}function a1(n){return Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2))}function MQ(n){for(var e=Math.min(n.length,2),t=[],r=0;r<e;++r)t.push(Q3(n[r]));return t}function Q3(n){return{clientX:n.clientX,clientY:n.clientY}}function Dh(n,e){e===void 0&&(e=n.length);for(var t={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(n.length,e),i=0;i<r;++i){var a=n[i];t.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,t.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,t.clientX+=a.clientX,t.clientY+=a.clientY}return e?{clientX:t.clientX/e,clientY:t.clientY/e,originalClientX:t.originalClientX/e,originalClientY:t.originalClientY/e}:t}var s1=(function(){function n(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return n.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),i1(e)},n.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),i1(e)-i1(this.startClients)},n.prototype.getPosition=function(e,t){e===void 0&&(e=this.prevClients);var r=ik(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},n.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),a=[],o=0;o<i;++o)a[o]=ik([e[o]],[t[o]],[r[o]]);return a},n.prototype.getMovement=function(e){var t=this.movement;if(!e)return t;var r=Dh(e,this.length),i=Dh(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+t},n.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),a1(e)},n.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),a1(e)/a1(this.startClients)},n.prototype.move=function(e,t){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=t}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=t})},n})(),ak=["textarea","input"],PQ=(function(n){RQ(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(m,b){if(b===void 0&&(b=!0),!(!i.flag&&m.cancelable===!1)){var _=m.type.indexOf("drag")>=-1;if(!(i.flag&&_)){i._isDragAPI=!0;var w=i.options,S=w.container,T=w.pinchOutside,C=w.preventWheelClick,D=w.preventRightClick,M=w.preventDefault,j=w.checkInput,z=w.dragFocusedInput,A=w.preventClickEventOnDragStart,I=w.preventClickEventOnDrag,k=w.preventClickEventByCondition,V=i._useTouch,B=!i.flag;if(i._isSecondaryButton=m.which===3||m.button===2,C&&(m.which===2||m.button===1)||D&&(m.which===3||m.button===2))return i.stop(),!1;if(B){var L=i._window.document.activeElement,P=m.target;if(P){var Z=P.tagName.toLowerCase(),K=ak.indexOf(Z)>-1,H=P.isContentEditable;if(K||H){if(j||!z&&L===P)return!1;if(L&&(L===P||H&&L.isContentEditable&&L.contains(P)))if(z)P.blur();else return!1}else if((M||m.type==="touchstart")&&L){var $=L.tagName.toLowerCase();(L.isContentEditable||ak.indexOf($)>-1)&&L.blur()}(A||I||k)&&yr(i._window,"click",i._onClick,!0)}i.clientStores=[new s1(Lm(m))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=b,i._dragFlag=!0,i._prevInputEvent=m,i.data={},i.doubleFlag=sp()-i.prevTime<200,i._isMouseEvent=NQ(m),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var Q=i._preventMouseEvent||i.emit("dragStart",qn(qn({data:i.data,datas:i.data,inputEvent:m,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:b,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){m.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));Q===!1&&i.stop(),i._isMouseEvent&&i.flag&&M&&m.preventDefault()}if(!i.flag)return!1;var re=0;if(B?(i._attchDragEvent(),V&&T&&(re=setTimeout(function(){yr(S,"touchstart",i.onDragStart,{passive:!1})}))):V&&T&&Jn(S,"touchstart",i.onDragStart),i.flag&&kQ(m)){if(clearTimeout(re),B&&m.touches.length!==m.changedTouches.length)return;i.pinchFlag||i.onPinchStart(m)}}}},i.onDrag=function(m,b){if(i.flag){var _=i.options.preventDefault;!i._isMouseEvent&&_&&m.preventDefault(),i._prevInputEvent=m;var w=Lm(m),S=i.moveClients(w,m,!1);if(i._dragFlag){if(i.pinchFlag||S.deltaX||S.deltaY){var T=i._preventMouseEvent||i.emit("drag",qn(qn({},S),{isScroll:!!b,inputEvent:m}));if(T===!1){i.stop();return}}i.pinchFlag&&i.onPinch(m,w)}i.getCurrentStore().getPosition(w,!0)}},i.onDragEnd=function(m){if(i.flag){var b=i.options,_=b.pinchOutside,w=b.container,S=b.preventClickEventOnDrag,T=b.preventClickEventOnDragStart,C=b.preventClickEventByCondition,D=i.isDrag;(S||T||C)&&requestAnimationFrame(function(){i._allowClickEvent()}),!C&&!T&&S&&!D&&i._allowClickEvent(),i._useTouch&&_&&Jn(w,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(m);var M=m?.touches?Lm(m):[],j=M.length;j===0||!i.options.keepDragging?i.flag=!1:i._addStore(new s1(M));var z=i._getPosition(),A=sp(),I=!D&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=D||I?0:A,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",qn({data:i.data,datas:i.data,isDouble:I,isDrag:D,isClick:!D,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:m,isTrusted:i._isTrusted},z)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){Jn(i._window,"click",i._onClick,!0)},i._onClick=function(m){i._allowClickEvent(),i._allowMouseEvent();var b=i.options.preventClickEventByCondition;b?.(m)||(m.stopPropagation(),m.preventDefault())},i._onContextMenu=function(m){var b=i.options;b.preventRightClick?i.onDragEnd(m):m.preventDefault()},i._passCallback=function(){};var a=[].concat(t),o=a[0];i._window=S3(o)?o:nl(o),i.options=qn({checkInput:!1,container:o&&!("document"in o)?nl(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var c=i.options,u=c.container,d=c.events,h=c.checkWindowBlur;if(i._useDrag=d.indexOf("drag")>-1,i._useTouch=d.indexOf("touch")>-1,i._useMouse=d.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(m){yr(m,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(m){yr(m,"mousedown",i.onDragStart),yr(m,"mousemove",i._passCallback)}),yr(u,"contextmenu",i._onContextMenu)),h&&yr(nl(),"blur",i.onBlur),i._useTouch){var p={passive:!1};a.forEach(function(m){yr(m,"touchstart",i.onDragStart,p),yr(m,"touchmove",i._passCallback,p)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(t,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(t,r),a&&this.onDrag(i,!0))},e.prototype.move=function(t,r){var i=t[0],a=t[1],o=this.getCurrentStore(),c=o.prevClients;return this.moveClients(c.map(function(u){var d=u.clientX,h=u.clientY;return{clientX:d+i,clientY:h+a,originalClientX:d,originalClientY:h}}),r,!0)},e.prototype.triggerDragStart=function(t){this.onDragStart(t,!1)},e.prototype.setEventData=function(t){var r=this.data;for(var i in t)r[i]=t[i];return this},e.prototype.setEventDatas=function(t){return this.setEventData(t)},e.prototype.getCurrentEvent=function(t){return t===void 0&&(t=this._prevInputEvent),qn(qn({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,r=this.targets,i=this.options.container;this.off(),Jn(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){Jn(a,"dragstart",t.onDragStart)}),this._useMouse&&(r.forEach(function(a){Jn(a,"mousedown",t.onDragStart)}),Jn(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){Jn(a,"touchstart",t.onDragStart)}),Jn(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(t){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new s1(Lm(t));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",qn(qn({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:t,isTrusted:this._isTrusted,preventDefault:function(){t.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(t,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",qn(qn({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:t,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(t){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",qn(qn({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:t}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(t,r,i){var a=this._getPosition(t,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var c=!1;return!o&&this.isDrag&&(c=!0),qn(qn({data:this.data,datas:this.data},a),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:c})},e.prototype._addStore=function(t){this.clientStores.splice(0,0,t)},e.prototype._getPosition=function(t,r){var i=this.getCurrentStore(),a=i.getPosition(t,r),o=this.clientStores.slice(1).reduce(function(d,h){var p=h.getPosition();return d.distX+=p.distX,d.distY+=p.distY,d},a),c=o.distX,u=o.distY;return qn(qn({},a),{distX:c,distY:u})},e.prototype._attchDragEvent=function(){var t=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(yr(r,"dragover",this.onDrag,i),yr(t,"dragend",this.onDragEnd)),this._useMouse&&(yr(r,"mousemove",this.onDrag),yr(t,"mouseup",this.onDragEnd)),this._useTouch&&(yr(r,"touchmove",this.onDrag,i),yr(t,"touchend",this.onDragEnd,i),yr(t,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var t=this._window,r=this.options.container;this._isDragAPI&&(Jn(r,"dragover",this.onDrag),Jn(t,"dragend",this.onDragEnd)),this._useMouse&&(Jn(r,"mousemove",this.onDrag),Jn(t,"mouseup",this.onDragEnd)),this._useTouch&&(Jn(r,"touchstart",this.onDragStart),Jn(r,"touchmove",this.onDrag),Jn(t,"touchend",this.onDragEnd),Jn(t,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(ny);function OQ(n){for(var e=5381,t=n.length;t;)e=e*33^n.charCodeAt(--t);return e>>>0}var VQ=OQ;function jQ(n){return VQ(n).toString(36)}function zQ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function LQ(n,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?uc(a):[""]).map(function(o){var c=o.trim();return c.indexOf("@")===0?c:c.indexOf(":global")>-1?c.replace(/\:global/g,""):c.indexOf(":host")>-1?"".concat(c.replace(/\:host/g,".".concat(n))):c?".".concat(n," ").concat(c):".".concat(n)}).join(", ")+" {"})}function BQ(n,e,t,r,i){var a=Gd(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",n),o.setAttribute("data-styled-count","1"),t.nonce&&o.setAttribute("nonce",t.nonce),o.innerHTML=LQ(n,e,t),(i||a.head||a.body).appendChild(o),o}function UQ(n){var e="rCS"+jQ(n);return{className:e,inject:function(t,r){r===void 0&&(r={});var i=zQ(t),a=(i||t.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=BQ(e,n,r,t,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var c,u=parseFloat(a.getAttribute("data-styled-count"))||0;u<=1?(a.remove?a.remove():(c=a.parentNode)===null||c===void 0||c.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(u-1))}}}}}var O_=function(){return O_=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},O_.apply(this,arguments)};function FQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Z3(n,e){var t=UQ(e),r=t.className;return BW(function(i,a){var o=i.className,c=o===void 0?"":o;i.cspNonce;var u=FQ(i,["className","cspNonce"]),d=JW();return eQ(a,function(){return d.current},[]),O3(function(){var h=t.inject(d.current,{nonce:i.cspNonce});return function(){h.destroy()}},[]),ua(n,O_({ref:d,"data-styled-id":r,className:"".concat(c," ").concat(r)},u))})}var V_=function(n,e){return V_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},V_(n,e)};function Kp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");V_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var W=function(){return W=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},W.apply(this,arguments)};function GQ(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function qQ(n,e,t,r){var i=arguments.length,a=i<3?e:r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function HQ(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function J(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Ce(n,e,t){if(arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function Xp(n,e){return W({events:[],props:[],name:n},e)}var $Q=["n","w","s","e"],fS=["n","w","s","e","nw","ne","sw","se"];function YQ(n,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*n,'px" height="').concat(32*n,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function KQ(n){var e=YQ(1,n),t=Math.round(n/45)*45%180,r="ns-resize";return t===135?r="nwse-resize":t===45?r="nesw-resize":t===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var Hd=aQ(),J3=Hd.browser.webkit,eV=J3&&(function(){var n=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(n.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),tV=Hd.browser.name,nV=parseInt(Hd.browser.version,10),XQ=tV==="chrome",WQ=Hd.browser.chromium,QQ=parseInt(Hd.browser.chromiumVersion,10)||0,ZQ=XQ&&nV>=109||WQ&&QQ>=109,JQ=tV==="firefox",eZ=parseInt(Hd.browser.webkitVersion,10)>=612||nV>=15,hS="moveable-",tZ=fS.map(function(n){var e="",t="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return n.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),n.indexOf("s")>-1&&(e="top: 0px;",i="top"),n.indexOf("w")>-1&&(t="left: ".concat(a,";"),r="right"),n.indexOf("e")>-1&&(t="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(n,`"] {
        `).concat(t).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),nZ=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(tZ,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(n){return`
.direction[data-rotation="`.concat(n,'"], :global .view-control-rotation').concat(n,` {
`).concat(KQ(n),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(eV?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),rZ=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],j_=1e-4,Fr=1e-7,Bm=1e-9,z_=Math.pow(10,10),sk=-z_,iZ={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},pS={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},rV={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},iV=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Wp(n,e,t,r,i,a){var o,c;a===void 0&&(a="draggable");var u=(c=(o=e.gestos[a])===null||o===void 0?void 0:o.move(t,n.inputEvent))!==null&&c!==void 0?c:{},d=u.originalDatas||u.datas,h=d[a]||(d[a]={});return W(W({},u),{isPinch:!!r,parentEvent:!0,datas:h,originalDatas:n.originalDatas})}var Td=(function(){function n(e){var t;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[e]={},t)}return n.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),W(W({},this.move(e,t.inputEvent)),{type:"dragstart"})},n.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},n.prototype.move=function(e,t){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},n})();function id(n,e,t,r){var i=n.length===16,a=i?4:3,o=Bc(n,t,r,a),c=J(o,4),u=J(c[0],2),d=u[0],h=u[1],p=J(c[1],2),m=p[0],b=p[1],_=J(c[2],2),w=_[0],S=_[1],T=J(c[3],2),C=T[0],D=T[1],M=J(vn(n,e,a),2),j=M[0],z=M[1],A=Math.min(d,m,w,C),I=Math.min(h,b,S,D),k=Math.max(d,m,w,C),V=Math.max(h,b,S,D);d=d-A||0,m=m-A||0,w=w-A||0,C=C-A||0,h=h-I||0,b=b-I||0,S=S-I||0,D=D-I||0,j=j-A||0,z=z-I||0;var B=n[0],L=n[a+1],P=jr(B*L);return{left:A,top:I,right:k,bottom:V,origin:[j,z],pos1:[d,h],pos2:[m,b],pos3:[w,S],pos4:[C,D],direction:P}}function aV(n,e){var t=e.clientX,r=e.clientY,i=e.datas,a=n.state,o=a.moveableClientRect,c=a.rootMatrix,u=a.is3d,d=a.pos1,h=o.left,p=o.top,m=u?4:3,b=J(Ke(Id(c,[t-h,r-p],m),d),2),_=b[0],w=b[1],S=J(as({datas:i,distX:_,distY:w}),2),T=S[0],C=S[1];return[T,C]}function Lc(n,e){var t=e.datas,r=n.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,c=r.left,u=r.top,d=r.origin,h=r.offsetMatrix,p=r.targetMatrix,m=r.transformOrigin,b=o?4:3;t.is3d=o,t.matrix=i,t.targetMatrix=p,t.beforeMatrix=a,t.offsetMatrix=h,t.transformOrigin=m,t.inverseMatrix=ts(i,b),t.inverseBeforeMatrix=ts(a,b),t.absoluteOrigin=kc(Ot([c,u],d),b),t.startDragBeforeDist=Dr(t.inverseBeforeMatrix,t.absoluteOrigin,b),t.startDragDist=Dr(t.inverseMatrix,t.absoluteOrigin,b)}function aZ(n){return id(n.datas.beforeTransform,[50,50],100,100).direction}function ry(n,e,t){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,c=o.length,u=i.nextTransformAppendedIndexes,d=-1;a===-1?(t==="translate"?d=0:t==="rotate"&&(d=Fs(o,function(b){return b.match(/scale\(/g)})),d===-1&&(d=o.length),r.transformIndex=d):ti(u,function(b){return b.index===a&&b.functionName===t})?d=a:d=a+u.filter(function(b){return b.index<a}).length;var h=kJ(o,n.state,d),p=h.targetFunction,m=t==="rotate"?"rotateZ":t;r.beforeFunctionTexts=h.beforeFunctionTexts,r.afterFunctionTexts=h.afterFunctionTexts,r.beforeTransform=h.beforeFunctionMatrix,r.beforeTransform2=h.beforeFunctionMatrix2,r.targetTansform=h.targetFunctionMatrix,r.afterTransform=h.afterFunctionMatrix,r.afterTransform2=h.afterFunctionMatrix2,r.targetAllTransform=h.allFunctionMatrix,p.functionName===m?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):c>d&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=Ce(Ce([],J(u),!1),[{functionName:t,index:d,isAppend:!0}],!1))}function iy(n,e,t){return"".concat(n.beforeFunctionTexts.join(" ")," ").concat(n.isAppendTransform?t:e," ").concat(n.afterFunctionTexts.join(" "))}function sZ(n){var e=n.datas,t=n.distX,r=n.distY,i=J(oV({datas:e,distX:t,distY:r}),2),a=i[0],o=i[1],c=sV(e,uQ([a,o],4));return Dr(c,kc([0,0,0],4),4)}function sV(n,e,t){var r=n.beforeTransform,i=n.afterTransform,a=n.beforeTransform2,o=n.afterTransform2,c=n.targetAllTransform,u=t?en(c,e,4):en(e,c,4),d=en(ts(t?a:r,4),u,4),h=en(d,ts(t?o:i,4),4);return h}function oV(n){var e=n.datas,t=n.distX,r=n.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,c=e.absoluteOrigin,u=a?4:3;return Ke(Dr(i,Ot(c,[t,r]),u),o)}function as(n,e){var t=n.datas,r=n.distX,i=n.distY,a=t.inverseBeforeMatrix,o=t.inverseMatrix,c=t.is3d,u=t.startDragBeforeDist,d=t.startDragDist,h=t.absoluteOrigin,p=c?4:3;return Ke(Dr(e?a:o,Ot(h,[r,i]),p),e?u:d)}function oZ(n,e){var t=n.datas,r=n.distX,i=n.distY;t.beforeMatrix;var a=t.matrix,o=t.is3d;t.startDragBeforeDist;var c=t.startDragDist,u=t.absoluteOrigin,d=o?4:3;return Ke(Dr(a,Ot(c,[r,i]),d),u)}function lZ(n,e,t,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=t),a===void 0&&(a=[0,0]),n?n.map(function(o,c){var u=Fp(o),d=u.value,h=u.unit,p=c?i:r,m=c?t:e;if(o==="%"||isNaN(d)){var b=p?a[c]/p:0;return m*b}else if(h!=="%")return d;return m*d/100}):a}function lV(n){var e=[];return n[1]>=0&&(n[0]>=0&&e.push(3),n[0]<=0&&e.push(2)),n[1]<=0&&(n[0]>=0&&e.push(1),n[0]<=0&&e.push(0)),e}function cZ(n,e){return lV(e).map(function(t){return n[t]})}function o1(n,e){var t=(e+1)/2;return[nv(n[0][0],n[1][0],t,1-t),nv(n[0][1],n[1][1],t,1-t)]}function nr(n,e){var t=o1([n[0],n[1]],e[0]),r=o1([n[2],n[3]],e[0]);return o1([t,r],e[1])}function uZ(n,e,t,r,i,a){var o=Bc(e,t,r,i),c=nr(o,a),u=n[0]-c[0],d=n[1]-c[1];return[u,d]}function Qp(n,e,t,r){return en(n,Nh(e,r,t),r)}function dZ(n,e,t,r){var i=n.transformOrigin,a=n.offsetMatrix,o=n.is3d,c=o?4:3,u;if(ei(t)){var d=e.beforeTransform,h=e.afterTransform;r?u=ma(lp(t),4,c):u=ma(en(en(d,lp([t]),4),h,4),4,c)}else u=t;return Qp(a,u,i,c)}function fZ(n,e){var t=n.transformOrigin,r=n.offsetMatrix,i=n.is3d,a=n.targetMatrix,o=n.targetAllTransform,c=i?4:3;return Qp(r,en(o||a,cS(e,c),c),t,c)}function ay(n,e){var t=$d(e);return{setTransform:function(r,i){i===void 0&&(i=-1),t.startTransforms=Qn(r)?r:ul(r),L_(n,e,i)},setTransformIndex:function(r){L_(n,e,r)}}}function sy(n,e,t){var r=$d(e),i=r.startTransforms;L_(n,e,Fs(i,function(a){return a.indexOf("".concat(t,"("))===0}))}function L_(n,e,t){var r=$d(e),i=e.datas;if(i.transformIndex=t,t!==-1){var a=r.startTransforms[t];if(a){var o=n.state,c=Sd([a],{"x%":function(u){return u/100*o.offsetWidth},"y%":function(u){return u/100*o.offsetHeight}});i.startValue=c[0].functionValue}}}function gS(n,e){var t=$d(n);t.nextTransforms=ul(e)}function $d(n){return n.originalDatas.beforeRenderable}function sv(n){var e=n.originalDatas.beforeRenderable;return e.nextTransforms}function Um(n){return(sv(n)||[]).join(" ")}function Fm(n){return $d(n).nextStyle}function cV(n,e,t,r,i){gS(i,e);var a=Vr.drag(n,Wp(i,n.state,t,r)),o=a?a.transform:e;return W(W({transform:e,drag:a},Br({transform:o},i)),{afterTransform:o})}function mS(n,e,t,r,i,a){var o=dZ(n.state,i,e,a),c=gZ(n,t,r,o);return c}function uV(n,e,t,r,i,a,o){var c=mS(n,e,t,i,a,o),u=n.state,d=u.left,h=u.top,p=n.props.groupable,m=p?d:0,b=p?h:0,_=Ke(r,c);return Ke(_,[m,b])}function hZ(n,e,t,r,i,a,o){var c=uV(n,e,t,r,i,a,o);return c}function pZ(n,e,t){return[e?-1+n[0]/(e/2):0,t?-1+n[1]/(t/2):0]}function gZ(n,e,t,r){r===void 0&&(r=n.state.allMatrix);var i=n.state,a=i.width,o=i.height,c=i.is3d,u=c?4:3,d=[a/2*(1+e[0])+t[0],o/2*(1+e[1])+t[1]];return vn(r,d,u)}function mZ(n,e,t){var r=t.fixedDirection,i=t.fixedPosition,a=t.fixedOffset;return uV(n,"rotate(".concat(e,"deg)"),r,i,a,t)}function vZ(n,e,t,r,i,a){var o=n.props.groupable,c=n.state,u=c.transformOrigin,d=c.offsetMatrix,h=c.is3d,p=c.width,m=c.height,b=c.left,_=c.top,w=a.fixedDirection,S=a.nextTargetMatrix||c.targetMatrix,T=h?4:3,C=lZ(i,e,t,p,m,u),D=o?b:0,M=o?_:0,j=Qp(d,S,C,T),z=uZ(r,j,e,t,T,w);return Ke(z,[D,M])}function yZ(n,e){return nr(Hi(n.state),e)}function bZ(n,e){var t=n.targetGesto,r=n.controlGesto,i;return t?.isFlag()&&(i=t.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function xZ(n){if(n&&n.getRootNode){var e=n.getRootNode();if(e.nodeType===11)return e}}function _Z(n){var e=n("scale"),t=n("rotate"),r=n("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&i.push("rotate(".concat(t,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function dV(n,e,t){for(var r=n,i=[],a=nS(n)||yl(n),o=!t&&n===e||n===a,c=o,u=!1,d=3,h,p,m,b=!1,_=up(e,e,!0).offsetParent,w=1;r&&!c;){c=o;var S=ni(r),T=S("position"),C=OV(r),D=T==="fixed",M=_Z(S),j=dQ(yJ(C)),z=void 0,A=!1,I=!1,k=0,V=0,B=0,L=0,P={hasTransform:!1,fixedContainer:null};D&&(b=!0,P=EJ(r),_=P.fixedContainer);var Z=j.length;!u&&(Z===16||M.length)&&(u=!0,d=4,H_(i),m&&(m=ma(m,3,4))),u&&Z===9&&(j=ma(j,3,4));var K=wJ(r,n),H=K.tagName,$=K.hasOffset,Q=K.isSVG,re=K.origin,ue=K.targetOrigin,G=K.offset,Y=J(G,2),ne=Y[0],te=Y[1];H==="svg"&&!r.ownerSVGElement&&m&&(i.push({type:"target",target:r,matrix:SJ(r,d)}),i.push({type:"offset",target:r,matrix:cn(d)}));var ce=parseFloat(S("zoom"))||1;if(D)z=P.fixedContainer,A=!0;else{var fe=up(r,e,!1,!0,S),ye=fe.offsetZoom;if(z=fe.offsetParent,A=fe.isEnd,I=fe.isStatic,w*=ye,(fe.isCustomElement||ye!==1)&&I)ne-=z.offsetLeft,te-=z.offsetTop;else if(JQ||ZQ){var Ae=fe.parentSlotElement;if(Ae){for(var Pe=z,Se=0,we=0;Pe&&xZ(Pe);)Se+=Pe.offsetLeft,we+=Pe.offsetTop,Pe=Pe.offsetParent;ne-=Se,te-=we}}}if(J3&&!eZ&&$&&!Q&&I&&(T==="relative"||T==="static")&&(ne-=z.offsetLeft,te-=z.offsetTop,o=o||A),D)$&&P.hasTransform&&(B=z.clientLeft,L=z.clientTop);else if($&&_!==z&&(k=z.clientLeft,V=z.clientTop),$&&z===a){var ke=VV(r,!1);ne+=ke[0],te+=ke[1]}if(i.push({type:"target",target:r,matrix:Nh(j,d,re)}),M.length&&(i.push({type:"offset",target:r,matrix:cn(d)}),i.push({type:"target",target:r,matrix:Nh(lp(M),d,re)})),$){var nt=r===n,Ue=nt?0:r.scrollLeft,Ee=nt?0:r.scrollTop;i.push({type:"offset",target:r,matrix:Nc([ne-Ue+k-B,te-Ee+V-L],d)})}else i.push({type:"offset",target:r,origin:re});if(ce!==1&&i.push({type:"zoom",target:r,matrix:Nh(cS([ce,ce],d),d,[0,0])}),m||(m=j),h||(h=re),p||(p=ue),c||D)break;r=z,o=A,(!t||r===a)&&(c=o)}return m||(m=cn(d)),h||(h=[0,0]),p||(p=[0,0]),{zoom:w,offsetContainer:_,matrixes:i,targetMatrix:m,transformOrigin:h,targetOrigin:p,is3d:u,hasFixed:b}}var nc=null,rc=null,Yu=null;function Ad(n){n?(window.Map&&(nc=new Map,rc=new Map),Yu=[]):(nc=null,Yu=null,rc=null)}function wZ(n){var e=rc?.get(n);if(e)return e;var t=Mh(n,!0);return rc&&rc.set(n,t),t}function EZ(n,e){if(Yu){var t=ti(Yu,function(i){return i[0][0]==n&&i[0][1]==e});if(t)return t[1]}var r=dV(n,e,!0);return Yu&&Yu.push([[n,e],r]),r}function ni(n){var e=nc?.get(n);if(!e){var t=nl(n).getComputedStyle(n);if(!nc)return function(a){return t[a]};e={style:t,cached:{}},nc.set(n,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function da(n,e,t){var r=t.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return n.moveables.map(function(o,c){return a[c]=a[c]||{},a[c][e]=a[c][e]||{},W(W({},t),{isRequestChild:!0,datas:a[c][e],originalDatas:a[c]})})}function l1(n,e,t,r,i,a,o){var c=!!t.match(/Start$/g),u=!!t.match(/End$/g),d=i.isPinch,h=i.datas,p=da(n,e.name,i),m=n.moveables,b=[],_=p.map(function(w,S){var T=m[S],C=T.state,D=C.gestos,M=w;if(c)M=new Td(o).dragStart(r,w),b.push(M);else{if(D[o]||(D[o]=h.childGestos[S]),!D[o])return;M=Wp(w,C,r,d,a,o),b.push(M)}var j=e[t](T,W(W({},M),{parentFlag:!0}));return u&&(D[o]=null),j});return c&&(h.childGestos=m.map(function(w){return w.state.gestos[o]})),{eventParams:_,childEvents:b}}function Ms(n,e,t,r,i,a){i===void 0&&(i=function(h,p){return p});var o=!!t.match(/End$/g),c=da(n,e.name,r),u=n.moveables,d=c.map(function(h,p){var m=u[p],b=h;b=i(m,h);var _=e[t](m,W(W({},b),{parentFlag:!0}));return o&&(m.state.gestos={}),_});return d}function ov(n,e,t,r){var i=t.fixedDirection,a=t.fixedPosition,o=r.datas.startPositions||Hi(e.state),c=nr(o,i),u=J(Dr(Yp(-n.rotation/180*Math.PI,3),[c[0]-a[0],c[1]-a[1],1],3),2),d=u[0],h=u[1];return r.datas.originalX=d,r.datas.originalY=h,r}function fV(n,e,t,r){var i=n.getState(),a=i.renderPoses,o=i.rotation,c=i.direction,u=Pc(n.props,e).zoom,d=kh(o/Math.PI*180),h={},p=n.renderState;p.renderDirectionMap||(p.renderDirectionMap={});var m=p.renderDirectionMap;t.forEach(function(_){var w=_.dir;h[w]=!0});var b=jr(c);return t.map(function(_){var w=_.data,S=_.classNames,T=_.dir,C=pS[T];if(!C||!h[T])return null;m[T]=!0;var D=(dt(d,15)+b*rV[T]+720)%180,M={};return Gs(w).forEach(function(j){M["data-".concat(j)]=w[j]}),r.createElement("div",W({className:He.apply(void 0,Ce(["control","direction",T,e],J(S),!1)),"data-rotation":D,"data-direction":T},M,{key:"direction-".concat(T),style:dv.apply(void 0,Ce([o,u],J(C.map(function(j){return a[j]})),!1))}))})}function hV(n,e,t,r){var i=Pc(n.props,t),a=i.renderDirections,o=a===void 0?e:a,c=i.displayAroundControls;if(!o)return[];var u=o===!0?fS:o;return Ce(Ce([],J(c?vV(n,r,t,u):[]),!1),J(fV(n,t,u.map(function(d){return{data:{},classNames:[],dir:d}}),r)),!1)}function cp(n,e,t,r,i,a){for(var o=[],c=6;c<arguments.length;c++)o[c-6]=arguments[c];var u=On(t,r),d=e?dt(u/Math.PI*180,15)%180:-1;return n.createElement("div",{key:"line-".concat(a),className:He.apply(void 0,Ce(["line","direction",e?"edge":"",e],J(o),!1)),"data-rotation":d,"data-line-key":a,"data-direction":e,style:fh(t,r,i,u)})}function pV(n,e,t,r,i){var a=t===!0?$Q:t;return a.map(function(o,c){var u=J(pS[o],2),d=u[0],h=u[1];if(h!=null)return cp(n,o,r[d],r[h],i,"".concat(e,"Edge").concat(c),e)}).filter(Boolean)}function gV(n){return function(e,t){var r=Pc(e.props,n).edge;return r&&(r===!0||r.length)?Ce(Ce([],J(pV(t,n,r,e.getState().renderPoses,e.props.zoom)),!1),J(SZ(e,n,t)),!1):mV(e,n,t)}}function mV(n,e,t){return hV(n,fS,e,t)}function SZ(n,e,t){return hV(n,["nw","ne","sw","se"],e,t)}function vV(n,e,t,r){var i=n.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=n.getState(),o=a.renderPoses,c=a.rotation,u=a.direction,d=i.renderDirectionMap,h=n.props.zoom,p=jr(u),m=c/Math.PI*180;return(r||Gs(d)).map(function(b){var _=pS[b];if(!_)return null;var w=(dt(m,15)+p*rV[b]+720)%180,S=["around-control"];return t&&S.push("direction",t),e.createElement("div",{className:He.apply(void 0,Ce([],J(S),!1)),"data-rotation":w,"data-direction":b,key:"direction-around-".concat(b),style:dv.apply(void 0,Ce([c,h],J(_.map(function(T){return o[T]})),!1))})})}function vS(n,e,t){var r=n||{},i=r.position,a=i===void 0?"client":i,o=r.left,c=o===void 0?-1/0:o,u=r.top,d=u===void 0?-1/0:u,h=r.right,p=h===void 0?1/0:h,m=r.bottom,b=m===void 0?1/0:m,_={position:a,left:c,top:d,right:p,bottom:b};return{vertical:ok(_,e,!0),horizontal:ok(_,t,!1)}}function oy(n,e){var t=n.state,r=t.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,c=r.clientTop,u=t.snapOffset,d=u.left,h=u.top,p=u.right,m=u.bottom,b=e||n.props.bounds||{},_=b.position||"client",w=_==="css",S=b.left,T=S===void 0?-1/0:S,C=b.top,D=C===void 0?-1/0:C,M=b.right,j=M===void 0?w?-1/0:1/0:M,z=b.bottom,A=z===void 0?w?-1/0:1/0:z;return w&&(j=a+p-d-j,A=i+m-h-A),{left:T+d-o,right:j+d-o,top:D+h-c,bottom:A+h-c}}function TZ(n,e,t){var r=oy(n),i=r.left,a=r.top,o=r.right,c=r.bottom,u=J(t,2),d=u[0],h=u[1],p=J(Ke(t,e),2),m=p[0],b=p[1];xe(m)<Fr&&(m=0),xe(b)<Fr&&(b=0);var _=b>0,w=m>0,S={isBound:!1,offset:0,pos:0},T={isBound:!1,offset:0,pos:0};if(m===0&&b===0)return{vertical:S,horizontal:T};if(m===0)_?c<h&&(T.pos=c,T.offset=h-c):a>h&&(T.pos=a,T.offset=h-a);else if(b===0)w?o<d&&(S.pos=o,S.offset=d-o):i>d&&(S.pos=i,S.offset=d-i);else{var C=b/m,D=t[1]-C*d,M=0,j=0,z=!1;w&&o<=d?(M=C*o+D,j=o,z=!0):!w&&d<=i&&(M=C*i+D,j=i,z=!0),z&&(M<a||M>c)&&(z=!1),z||(_&&c<=h?(M=c,j=(M-D)/C,z=!0):!_&&h<=a&&(M=a,j=(M-D)/C,z=!0)),z&&(S.isBound=!0,S.pos=j,S.offset=d-j,T.isBound=!0,T.pos=M,T.offset=h-M)}return{vertical:S,horizontal:T}}function ok(n,e,t){var r=n[t?"left":"top"],i=n[t?"right":"bottom"],a=Math.min.apply(Math,Ce([],J(e),!1)),o=Math.max.apply(Math,Ce([],J(e),!1)),c=[];return r+1>a&&c.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&c.push({direction:"end",isBound:!0,offset:o-i,pos:i}),c.length||c.push({isBound:!1,offset:0,pos:0}),c.sort(function(u,d){return xe(d.offset)-xe(u.offset)})}function lk(n,e,t){var r=t?n.map(function(i){return $p(i,t)}):n;return r.some(function(i){return i[0]<e.left&&xe(i[0]-e.left)>.1||i[0]>e.right&&xe(i[0]-e.right)>.1||i[1]<e.top&&xe(i[1]-e.top)>.1||i[1]>e.bottom&&xe(i[1]-e.bottom)>.1})}function AZ(n,e,t){var r=qi(n),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return xe(a-n[t?0:1])-xe(o-n[t?0:1])}).map(function(a){return On([0,0],t?[a,e]:[e,a])})}function CZ(n,e,t,r,i){if(!n.props.bounds)return[];var a=i*Math.PI/180,o=oy(n),c=o.left,u=o.top,d=o.right,h=o.bottom,p=c-r[0],m=d-r[0],b=u-r[1],_=h-r[1],w={left:p,top:b,right:m,bottom:_};if(!lk(t,w,0))return[];var S=[];return[[p,0],[m,0],[b,1],[_,1]].forEach(function(T){var C=J(T,2),D=C[0],M=C[1];t.forEach(function(j){var z=On([0,0],j);S.push.apply(S,Ce([],J(AZ(j,D,M).map(function(A){return a+A-z}).filter(function(A){return!lk(e,w,A)}).map(function(A){return dt(A*180/Math.PI,Fr)})),!1))})}),S}var IZ=["left","right","center"],RZ=["top","bottom","middle"],ck={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},dl={start:"left",end:"right",center:"center"},fl={start:"top",end:"bottom",center:"middle"};function Ku(){return{left:!1,top:!1,right:!1,bottom:!1}}function Yd(n,e){var t=n.props,r=t.snappable,i=t.bounds,a=t.innerBounds,o=t.verticalGuidelines,c=t.horizontalGuidelines,u=t.snapGridWidth,d=t.snapGridHeight,h=n.state,p=h.guidelines,m=h.enableSnap;return!r||!m||e&&r!==!0&&r.indexOf(e)<0?!1:!!(u||d||i||a||p&&p.length||o&&o.length||c&&c.length)}function yS(n){return n===!1?{}:n===!0||!n?{left:!0,right:!0,top:!0,bottom:!0}:n}function DZ(n,e){var t=yS(n),r={};for(var i in t)i in e&&t[i]&&(r[i]=e[i]);return r}function bS(n,e){var t=DZ(n,e),r=RZ.filter(function(a){return a in t}),i=IZ.filter(function(a){return a in t});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return t[a]}),vertical:i.map(function(a){return t[a]})}}function kZ(n,e,t){var r=vn(n,[e.clientLeft,e.clientTop],t);return[e.left+r[0],e.top+r[1]]}function NZ(n){var e=J(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];Math.abs(i)<Yn&&(i=0),Math.abs(a)<Yn&&(a=0);var o=0,c=0,u=0;return i?a?(o=-a/i,c=1,u=o*t[0]-t[1]):(c=1,u=-t[1]):(o=-1,u=t[0]),[o,c,u].map(function(d){return dt(d,Yn)})}var yV="snapRotationThreshold",bV="snapRotationDegrees",xV="snapHorizontalThreshold",_V="snapVerticalThreshold";function ly(n,e,t,r,i,a,o){var c;r===void 0&&(r=[]),i===void 0&&(i=[]);var u=n.props,d=((c=n.state.snapThresholdInfo)===null||c===void 0?void 0:c.multiples)||[1,1],h=Sk(o,u[xV],5),p=Sk(a,u[_V],5);return wV(n.state.guidelines,e,t,r,i,h,p,d)}function wV(n,e,t,r,i,a,o,c){return{vertical:dk(n,"vertical",e,o*c[0],r),horizontal:dk(n,"horizontal",t,a*c[1],i)}}function MZ(n,e,t){var r=J(t,2),i=r[0],a=r[1],o=J(e,2),c=o[0],u=o[1],d=J(Ke(t,e),2),h=d[0],p=d[1],m=p>0,b=h>0;h=fv(h),p=fv(p);var _={isSnap:!1,offset:0,pos:0},w={isSnap:!1,offset:0,pos:0};if(h===0&&p===0)return{vertical:_,horizontal:w};var S=ly(n,h?[i]:[],p?[a]:[],[],[],void 0,void 0),T=S.vertical,C=S.horizontal;T.posInfos.filter(function(H){var $=H.pos;return b?$>=c:$<=c}),C.posInfos.filter(function(H){var $=H.pos;return m?$>=u:$<=u}),T.isSnap=T.posInfos.length>0,C.isSnap=C.posInfos.length>0;var D=B_(T),M=D.isSnap,j=D.guideline,z=B_(C),A=z.isSnap,I=z.guideline,k=A?I.pos[1]:0,V=M?j.pos[0]:0;if(h===0)A&&(w.isSnap=!0,w.pos=I.pos[1],w.offset=a-w.pos);else if(p===0)M&&(_.isSnap=!0,_.pos=V,_.offset=i-V);else{var B=p/h,L=t[1]-B*i,P=0,Z=0,K=!1;M?(Z=V,P=B*Z+L,K=!0):A&&(P=k,Z=(P-L)/B,K=!0),K&&(_.isSnap=!0,_.pos=Z,_.offset=i-Z,w.isSnap=!0,w.pos=P,w.offset=a-P)}return{vertical:_,horizontal:w}}function Yo(n){var e="";return n===-1||n==="top"||n==="left"?e="start":n===0||n==="center"||n==="middle"?e="center":(n===1||n==="right"||n==="bottom")&&(e="end"),e}function uk(n,e,t,r){var i=bS(n.props.snapDirections,e),a=ly(n,i.vertical,i.horizontal,i.verticalNames.map(function(u){return Yo(u)}),i.horizontalNames.map(function(u){return Yo(u)}),t,r),o=Yo(i.horizontalNames[a.horizontal.index]),c=Yo(i.verticalNames[a.vertical.index]);return{vertical:W(W({},a.vertical),{direction:c}),horizontal:W(W({},a.horizontal),{direction:o})}}function B_(n){var e=n.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=n.posInfos[0],r=t.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:t.pos,guideline:o}}function dk(n,e,t,r,i){var a,o;if(i===void 0&&(i=[]),!n||!n.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var c=e==="vertical",u=c?0:1,d=t.map(function(p,m){var b=i[m]||"",_=n.map(function(w){var S=w.pos,T=p-S[u];return{offset:T,dist:xe(T),guideline:w,direction:b}}).filter(function(w){var S=w.guideline,T=w.dist,C=S.type;return!(C!==e||T>r)}).sort(function(w,S){return w.dist-S.dist});return{pos:p,index:m,guidelineInfos:_,direction:b}}).filter(function(p){return p.guidelineInfos.length>0}).sort(function(p,m){return p.guidelineInfos[0].dist-m.guidelineInfos[0].dist}),h=d.length>0;return{isSnap:h,index:h?d[0].index:-1,direction:(o=(a=d[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:d}}function PZ(n,e,t,r,i){var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(m,b,_){var w=_[b+1]||_[0];a.push(m),a.push([(m[0]+w[0])/2,(m[1]+w[1])/2])}):n.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,Ce([],J(cZ([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(m){return nr(e,m)}),c=o.map(function(m){return m[0]}),u=o.map(function(m){return m[1]}),d=ly(n,c,u,a.map(function(m){return Yo(m[0])}),a.map(function(m){return Yo(m[1])}),r,i),h=Yo(a.map(function(m){return m[0]})[d.vertical.index]),p=Yo(a.map(function(m){return m[1]})[d.horizontal.index]);return{vertical:W(W({},d.vertical),{direction:h}),horizontal:W(W({},d.horizontal),{direction:p})}}function EV(n,e){var t=xe(n.offset),r=xe(e.offset);return n.isBound&&e.isBound?r-t:n.isBound?-1:e.isBound?1:n.isSnap&&e.isSnap?r-t:n.isSnap?-1:e.isSnap||t<Fr?1:r<Fr?-1:t-r}function lv(n,e){return n.slice().sort(function(t,r){var i=t.sign[e],a=r.sign[e],o=t.offset[e],c=r.offset[e];if(i){if(!a)return-1}else return 1;return EV({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:c})})[0]}function OZ(n,e,t){var r=[];if(t)xe(e[0])!==1||xe(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[n[0],-n[1]]],[e,[-n[0],n[1]]]),r.push([e,n]);else if(n[0]&&n[1]||!n[0]&&!n[1]){var i=n[0]?n:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(c){var u=[o*i[0],c*i[1]];e[0]===u[0]&&e[1]===u[1]||r.push([e,u])})})}else if(n[0]){var a=xe(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*n[0],-1]],[[e[0],0],[o*n[0],0]],[[e[0],1],[o*n[0],1]])})}else if(n[1]){var a=xe(e[1])===1?[1]:[1,-1];a.forEach(function(c){r.push([[-1,e[1]],[-1,c*n[1]]],[[0,e[1]],[0,c*n[1]]],[[1,e[1]],[1,c*n[1]]])})}return r}function SV(n,e){var t=T_([e[0][0],e[1][0]]),r=T_([e[0][1],e[1][1]]);return{vertical:t<=n[0],horizontal:r<=n[1]}}function xS(n,e){var t=J(e,2),r=t[0],i=t[1],a=i[0]-r[0],o=i[1]-r[1];xe(a)<Fr&&(a=0),xe(o)<Fr&&(o=0);var c,u;if(!a)c=r[0],u=n[0];else if(!o)c=r[1],u=n[1];else{var d=o/a;c=d*(n[0]-r[0])+r[1],u=n[1]}return c-u}function TV(n,e,t,r){return r===void 0&&(r=Fr),n.every(function(i){var a=xS(i,e),o=a<=0;return o===t||xe(a)<=r})}function fk(n,e,t,r,i){return i===void 0&&(i=0),r&&e-i<=n||!r&&n<=t+i?{isBound:!0,offset:r?e-n:t-n}:{isBound:!1,offset:0}}function VZ(n,e){var t=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,c=n.props.innerBounds;if(!c)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var u=c.left,d=c.top,h=c.width,p=c.height,m=[[u,d],[u,d+p]],b=[[u,d],[u+h,d]],_=[[u+h,d],[u+h,d+p]],w=[[u,d+p],[u+h,d+p]];if(TV([[u,d],[u+h,d],[u,d+p],[u+h,d+p]],t,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var S=Ko(t,o,b,i),T=Ko(t,o,w,i),C=Ko(t,o,m,a),D=Ko(t,o,_,a),M=S.isBound&&T.isBound,j=S.isBound||T.isBound,z=C.isBound&&D.isBound,A=C.isBound||D.isBound,I=Cd(S.offset,T.offset),k=Cd(C.offset,D.offset),V=[0,0],B=!1,L=!1;return xe(k)<xe(I)?(V=[I,0],B=j,L=M):(V=[0,k],B=A,L=z),{isAllBound:L,isVerticalBound:j,isHorizontalBound:A,isBound:B,offset:V}}function Ko(n,e,t,r,i,a){var o=J(e,2),c=o[0],u=o[1],d=n[0],h=t[0],p=t[1],m=fv(p[1]-h[1]),b=fv(p[0]-h[0]),_=u,w=c,S=-c/u;if(b){if(!m){if(a&&!_)return{isBound:!1,offset:0};if(w){var M=(h[1]-d[1])/S+d[0];return fk(M,h[0],p[0],r,i)}else{var C=h[1]-d[1],D=xe(C)<=(i||0);return{isBound:D,offset:D?C:0}}}}else{if(a&&!w)return{isBound:!1,offset:0};if(_){var T=S*(h[0]-d[0])+d[1];return fk(T,h[1],p[1],r,i)}else{var C=h[0]-d[0],D=xe(C)<=(i||0);return{isBound:D,offset:D?C:0}}}return{isBound:!1,offset:0}}function AV(n,e,t){return e.map(function(r){var i=VZ(n,r),a=i.isBound,o=i.offset,c=i.isVerticalBound,u=i.isHorizontalBound,d=r.multiple,h=as({datas:t,distX:o[0],distY:o[1]}).map(function(p,m){return p*(d[m]?2/d[m]:0)});return{sign:d,isBound:a,isVerticalBound:c,isHorizontalBound:u,isSnap:!1,offset:h}})}function jZ(n,e,t){var r,i=_S(n,e,[0,0],!1).map(function(m){return W(W({},m),{multiple:m.multiple.map(function(b){return xe(b)*2})})}),a=AV(n,i,t),o=lv(a,0),c=lv(a,1),u=0,d=0,h=o.isVerticalBound||c.isVerticalBound,p=o.isHorizontalBound||c.isHorizontalBound;return(h||p)&&(r=J(oZ({datas:t,distX:-o.offset[0],distY:-c.offset[1]}),2),u=r[0],d=r[1]),{vertical:{isBound:h,offset:u},horizontal:{isBound:p,offset:d}}}function zZ(n,e){var t=[],r=n[0],i=n[1];return r&&i?t.push([[0,i*2],n,[-r,i]],[[r*2,0],n,[r,-i]]):r?(t.push([[r*2,0],[r,1],[r,-1]]),e&&t.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(t.push([[0,i*2],[1,i],[-1,i]]),e&&t.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function _S(n,e,t,r){var i=n.state,a=i.allMatrix,o=i.is3d,c=Bc(a,100,100,o?4:3),u=nr(c,[0,0]);return zZ(t,r).map(function(d){var h=J(d,3),p=h[0],m=h[1],b=h[2],_=[nr(c,m),nr(c,b)],w=NZ(_),S=SV(u,_),T=S.vertical,C=S.horizontal,D=xS(u,_)<=0;return{multiple:p,centerSign:D,verticalSign:T,horizontalSign:C,lineConstants:w,line:[nr(e,m),nr(e,b)]}})}function hk(n,e,t,r){var i=r?n.map(function(a){return $p(a,r)}):n;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=xS(t,a)<=0;return!TV(e,a,o)})}function LZ(n){var e=J(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return xe(t[0]);if(!a)return xe(t[1]);var o=a/i;return xe((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function BZ(n){var e=J(n,2),t=e[0],r=e[1],i=r[0]-t[0],a=r[1]-t[1];if(!i)return[t[0],0];if(!a)return[0,t[1]];var o=a/i,c=-o*t[0]+t[1];return[-c/(o+1/o),c/(o*o+1)]}function UZ(n,e,t,r,i){var a=n.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var c=a.left,u=a.top,d=a.width,h=a.height,p=c-r[0],m=c+d-r[0],b=u-r[1],_=u+h-r[1],w=[[p,b],[m,b],[p,_],[m,_]],S=nr(t,[0,0]);if(!hk(t,w,S,0))return[];var T=[],C=w.map(function(D){return[qi(D),On([0,0],D)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(D){var M=On([0,0],BZ(D)),j=LZ(D);T.push.apply(T,Ce([],J(C.filter(function(z){var A=J(z,1),I=A[0];return I&&j<=I}).map(function(z){var A=J(z,2),I=A[0],k=A[1],V=Math.acos(I?j/I:0),B=k+V,L=k-V;return[o+B-M,o+L-M]}).reduce(function(z,A){return z.push.apply(z,Ce([],J(A),!1)),z},[]).filter(function(z){return!hk(e,w,S,z)}).map(function(z){return dt(z*180/Math.PI,Fr)})),!1))}),T}function FZ(n){var e=n.props.innerBounds,t=Ku();if(!e)return{boundMap:t,vertical:[],horizontal:[]};var r=n.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,c=r.pos4,u=[i,a,o,c],d=nr(u,[0,0]),h=e.left,p=e.top,m=e.width,b=e.height,_=[[h,p],[h,p+b]],w=[[h,p],[h+m,p]],S=[[h+m,p],[h+m,p+b]],T=[[h,p+b],[h+m,p+b]],C=_S(n,u,[0,0],!1),D=[],M=[];return C.forEach(function(j){var z=j.line,A=j.lineConstants,I=SV(d,z),k=I.horizontal,V=I.vertical,B=Ko(z,A,w,V,1,!0),L=Ko(z,A,T,V,1,!0),P=Ko(z,A,_,k,1,!0),Z=Ko(z,A,S,k,1,!0);B.isBound&&!t.top&&(D.push(p),t.top=!0),L.isBound&&!t.bottom&&(D.push(p+b),t.bottom=!0),P.isBound&&!t.left&&(M.push(h),t.left=!0),Z.isBound&&!t.right&&(M.push(h+m),t.right=!0)}),{boundMap:t,horizontal:D,vertical:M}}function GZ(n,e,t,r){var i=e[0]-n[0],a=e[1]-n[1];if(xe(i)<Yn&&(i=0),xe(a)<Yn&&(a=0),!i)return r?[0,0]:[0,t];if(!a)return r?[t,0]:[0,0];var o=a/i,c=n[1]-o*n[0];if(r){var u=o*(e[0]+t)+c;return[t,u-e[1]]}else{var d=(e[1]+t-c)/o;return[d-e[0],t]}}function U_(n,e,t,r,i){var a=GZ(n,e,t,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=Ns(n,e),c=Ns(a,n),u=Ns(a,e),d=c>o||u>o,h=J(as({datas:i,distX:a[0],distY:a[1]}),2),p=h[0],m=h[1];return{offset:[p,m],isOutside:d}}function cv(n,e){return n.isBound?n.offset:e.isSnap?B_(e).offset:0}function qZ(n,e,t,r,i){var a=J(e,2),o=a[0],c=a[1],u=J(t,2),d=u[0],h=u[1],p=J(r,2),m=p[0],b=p[1],_=J(i,2),w=_[0],S=_[1],T=-w,C=-S;if(n&&o&&c){T=0,C=0;var D=[];if(d&&h?D.push([0,S],[w,0]):d?D.push([w,0]):h?D.push([0,S]):m&&b?D.push([0,S],[w,0]):m?D.push([w,0]):b&&D.push([0,S]),D.length){D.sort(function(A,I){return qi(Ke([o,c],A))-qi(Ke([o,c],I))});var M=D[0];if(M[0]&&xe(o)>Yn)T=-M[0],C=c*xe(o+T)/xe(o)-c;else if(M[1]&&xe(c)>Yn){var j=c;C=-M[1],T=o*xe(c+C)/xe(j)-o}if(n&&h&&d)if(xe(T)>Yn&&xe(T)<xe(w)){var z=xe(w)/xe(T);T*=z,C*=z}else if(xe(C)>Yn&&xe(C)<xe(S)){var z=xe(S)/xe(C);T*=z,C*=z}else T=Cd(-w,T),C=Cd(-S,C)}}else T=o||d?-w:0,C=c||h?-S:0;return[T,C]}function HZ(n,e,t,r,i,a){if(!Yd(n,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=SS(a.absolutePoses,[e,t]),c=Fi(o),u=c.left,d=c.right,h=c.top,p=c.bottom,m={horizontal:o.map(function(Z){return Z[1]}),vertical:o.map(function(Z){return Z[0]})},b=yS(n.props.snapDirections),_=bS(b,{left:u,right:d,top:h,bottom:p,center:(u+d)/2,middle:(h+p)/2}),w=cy(n,i,_,m),S=w.vertical,T=w.horizontal,C=jZ(n,o,a),D=C.vertical,M=C.horizontal,j=S.isSnap,z=T.isSnap,A=S.isBound||D.isBound,I=T.isBound||M.isBound,k=Cd(S.offset,D.offset),V=Cd(T.offset,M.offset),B=J(qZ(r,[e,t],[A,I],[j,z],[k,V]),2),L=B[0],P=B[1];return[{isBound:A,isSnap:j,offset:L},{isBound:I,isSnap:z,offset:P}]}function cy(n,e,t,r){r===void 0&&(r=t);var i=vS(oy(n),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,c=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:ly(n,t.vertical,t.horizontal,void 0,void 0,void 0,void 0),u=c.horizontal,d=c.vertical,h=cv(a[0],u),p=cv(o[0],d),m=xe(h),b=xe(p);return{horizontal:{isBound:a[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:h,dist:m,bounds:a,snap:u},vertical:{isBound:o[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:p,dist:b,bounds:o,snap:d}}}function pk(n,e,t,r,i,a,o){o===void 0&&(o=[1,1]);var c=vS(e,t,r),u=c.horizontal,d=c.vertical,h=wV(n,t,r,[],[],i,a,o),p=h.horizontal,m=h.vertical,b=cv(u[0],p),_=cv(d[0],m),w=xe(b),S=xe(_);return{horizontal:{isBound:u[0].isBound,isSnap:p.isSnap,snapIndex:p.index,offset:b,dist:w,bounds:u,snap:p},vertical:{isBound:d[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:_,dist:S,bounds:d,snap:m}}}function $Z(n,e,t,r){var i=On(n,e)/Math.PI*180,a=t.vertical,o=a.isBound,c=a.isSnap,u=a.dist,d=t.horizontal,h=d.isBound,p=d.isSnap,m=d.dist,b=i%180,_=b<3||b>177,w=b>87&&b<93;return m<u&&(o||c&&!w&&(!r||!_))?"vertical":h||p&&!_&&(!r||!w)?"horizontal":""}function YZ(n,e,t,r,i,a){return t.map(function(o){var c=J(o,2),u=c[0],d=c[1],h=nr(e,u),p=nr(e,d),m=r?KZ(n,h,p,i):cy(n,i,{vertical:[p[0]],horizontal:[p[1]]}),b=m.horizontal,_=b.offset,w=b.isBound,S=b.isSnap,T=m.vertical,C=T.offset,D=T.isBound,M=T.isSnap,j=Ke(d,u);if(!C&&!_)return{isBound:D||w,isSnap:M||S,sign:j,offset:[0,0]};var z=$Z(h,p,m,r);if(!z)return{sign:j,isBound:!1,isSnap:!1,offset:[0,0]};var A=z==="vertical",I=[0,0];return!r&&xe(d[0])===1&&xe(d[1])===1&&u[0]!==d[0]&&u[1]!==d[1]?I=as({datas:a,distX:-C,distY:-_}):I=U_(h,p,-(A?C:_),A,a).offset,I=I.map(function(k,V){return k*(j[V]?2/j[V]:0)}),{sign:j,isBound:A?D:w,isSnap:A?M:S,offset:I}})}function gk(n,e){return n.isBound?n.offset:e.isSnap?e.offset:0}function KZ(n,e,t,r){var i=TZ(n,e,t),a=i.horizontal,o=i.vertical,c=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:MZ(n,e,t),u=c.horizontal,d=c.vertical,h=gk(a,u),p=gk(o,d),m=xe(h),b=xe(p);return{horizontal:{isBound:a.isBound,isSnap:u.isSnap,offset:h,dist:m},vertical:{isBound:o.isBound,isSnap:d.isSnap,offset:p,dist:b}}}function XZ(n,e,t,r,i){var a=[-t[0],-t[1]],o=n.state,c=o.width,u=o.height,d=n.props.bounds,h=1/0,p=1/0;if(d){var m=[[t[0],-t[1]],[-t[0],t[1]]],b=d.left,_=b===void 0?-1/0:b,w=d.top,S=w===void 0?-1/0:w,T=d.right,C=T===void 0?1/0:T,D=d.bottom,M=D===void 0?1/0:D;m.forEach(function(j){var z=j[0]!==a[0],A=j[1]!==a[1],I=nr(e,j),k=On(r,I)*360/Math.PI;if(A){var V=I.slice();(xe(k-360)<2||xe(k-180)<2)&&(V[1]=r[1]);var B=U_(r,V,(r[1]<I[1]?M:S)-I[1],!1,i),L=J(B.offset,2),P=L[1],Z=B.isOutside;isNaN(P)||(p=u+(Z?1:-1)*xe(P))}if(z){var V=I.slice();(xe(k-90)<2||xe(k-270)<2)&&(V[0]=r[0]);var K=U_(r,V,(r[0]<I[0]?C:_)-I[0],!0,i),H=J(K.offset,1),$=H[0],Q=K.isOutside;isNaN($)||(h=c+(Q?1:-1)*xe($))}})}return{maxWidth:h,maxHeight:p}}var Vr={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(n,e){var t=n.props,r=t.hideThrottleDragRotateLine,i=t.throttleDragRotate,a=t.zoom,o=n.getState(),c=o.dragInfo,u=o.beforeOrigin;if(r||!i||!c)return[];var d=c.dist;if(!d[0]&&!d[1])return[];var h=qi(d),p=On(d,[0,0]);return[e.createElement("div",{className:He("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(h,"px"),transform:"translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(p,"rad) scaleY(").concat(a,")")}})]},dragStart:function(n,e){var t=e.datas,r=e.parentEvent,i=e.parentGesto,a=n.state,o=a.gestos,c=a.style;if(o.draggable)return!1;o.draggable=i||n.targetGesto,t.datas={},t.left=parseFloat(c.left||"")||0,t.top=parseFloat(c.top||"")||0,t.bottom=parseFloat(c.bottom||"")||0,t.right=parseFloat(c.right||"")||0,t.startValue=[0,0],Lc(n,e),sy(n,e,"translate"),pJ(n,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var u=yt(n,e,W({set:function(h){t.startValue=h}},ay(n,e))),d=r||Ve(n,"onDragStart",u);return d!==!1?(t.isDrag=!0,n.state.dragInfo={startRect:n.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?u:!1},drag:function(n,e){if(e){ry(n,e,"translate");var t=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,c=e.useSnap,u=e.isRequest,d=e.isGroup,h=e.parentThrottleDrag,p=e.distX,m=e.distY,b=t.isDrag,_=t.prevDist,w=t.prevBeforeDist,S=t.startValue;if(b){o&&(p+=o[0],m+=o[1]);var T=n.props,C=T.parentMoveable,D=d?0:T.throttleDrag||h||0,M=r?0:T.throttleDragRotate||0,j=0,z=!1,A=!1,I=!1,k=!1;if(!r&&M>0&&(p||m)){var V=T.startDragRotate||0,B=dt(V+On([0,0],[p,m])*180/Math.PI,M)-V,L=m*Math.abs(Math.cos((B-90)/180*Math.PI)),P=p*Math.abs(Math.cos(B/180*Math.PI)),Z=qi([P,L]);j=B*Math.PI/180,p=Z*Math.cos(j),m=Z*Math.sin(j)}if(!a&&!r&&!i){var K=J(HZ(n,p,m,M,!c&&u||o,t),2),H=K[0],$=K[1];z=H.isSnap,A=H.isBound,I=$.isSnap,k=$.isBound;var Q=H.offset,re=$.offset;p+=Q,m+=re}var ue=Ot(oV({datas:t,distX:p,distY:m}),S),G=Ot(sZ({datas:t,distX:p,distY:m}),S);KD(G,Fr),KD(ue,Fr),M||(!z&&!A&&(G[0]=dt(G[0],D),ue[0]=dt(ue[0],D)),!I&&!k&&(G[1]=dt(G[1],D),ue[1]=dt(ue[1],D)));var Y=Ke(ue,S),ne=Ke(G,S),te=Ke(ne,_),ce=Ke(Y,w);t.prevDist=ne,t.prevBeforeDist=Y,t.passDelta=te,t.passDist=ne;var fe=t.left+Y[0],ye=t.top+Y[1],Ae=t.right-Y[0],Pe=t.bottom-Y[1],Se=iy(t,"translate(".concat(G[0],"px, ").concat(G[1],"px)"),"translate(".concat(ne[0],"px, ").concat(ne[1],"px)"));if(gS(e,Se),n.state.dragInfo.dist=r?[0,0]:ne,!(!r&&!C&&te.every(function(Ee){return!Ee})&&ce.some(function(Ee){return!Ee}))){var we=n.state,ke=we.width,nt=we.height,Ue=yt(n,e,W({transform:Se,dist:ne,delta:te,translate:G,beforeDist:Y,beforeDelta:ce,beforeTranslate:ue,left:fe,top:ye,right:Ae,bottom:Pe,width:ke,height:nt,isPinch:a},Br({transform:Se},e)));return!r&&Ve(n,"onDrag",Ue),Ue}}}},dragAfter:function(n,e){var t=e.datas,r=t.deltaOffset;return r[0]||r[1]?(t.deltaOffset=[0,0],this.drag(n,W(W({},e),{deltaOffset:r}))):!1},dragEnd:function(n,e){var t=e.parentEvent,r=e.datas;if(n.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=bi(n,e,{});return!t&&Ve(n,"onDragEnd",i),i}},dragGroupStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=this.dragStart(n,e);if(!c)return!1;var u=l1(n,this,"dragStart",[a||0,o||0],e,!1,"draggable"),d=u.childEvents,h=u.eventParams,p=W(W({},c),{targets:n.props.targets,events:h}),m=Ve(n,"onDragGroupStart",p);i.isDrag=m!==!1;var b=(r=(t=d[0])===null||t===void 0?void 0:t.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[b[0]%1,b[1]%1],i.isDrag?c:!1},dragGroup:function(n,e){var t=e.datas;if(t.isDrag){var r=this.drag(n,W(W({},e),{parentThrottleDrag:n.props.throttleDrag})),i=e.datas.passDelta,a=l1(n,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=W({targets:n.props.targets,events:a},r);return Ve(n,"onDragGroup",o),o}}},dragGroupEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(n,e);var i=l1(n,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Ve(n,"onDragGroupEnd",bi(n,e,{targets:n.props.targets,events:i})),t}},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-t.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-t.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(n){n.state.gestos.draggable=null,n.state.dragInfo=null}};function CV(n,e){var t=nr(n,e),r=[0,0];return{fixedPosition:t,fixedDirection:e,fixedOffset:r}}function WZ(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=[i/2*(1+e[0]),a/2*(1+e[1])],u=vn(t,c,o),d=[0,0];return{fixedPosition:u,fixedDirection:e,fixedOffset:d}}function IV(n,e){var t=n.allMatrix,r=n.is3d,i=n.width,a=n.height,o=r?4:3,c=pZ(e,i,a),u=vn(t,e,o),d=[i?0:e[0],a?0:e[1]];return{fixedPosition:u,fixedDirection:c,fixedOffset:d}}var mk=CS("resizable"),F_={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:gV("resizable"),dragControlCondition:mk,viewClassName:AS("resizable"),dragControlStart:function(n,e){var t,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,c=e.parentGesto,u=e.datas,d=e.parentFixedDirection,h=e.parentEvent,p=UV(o,i,r,u),m=n.state,b=m.target,_=m.width,w=m.height,S=m.gestos;if(!p||!b||S.resizable)return!1;S.resizable=c||n.controlGesto,!i&&Lc(n,e),u.datas={},u.direction=p,u.startOffsetWidth=_,u.startOffsetHeight=w,u.prevWidth=0,u.prevHeight=0,u.minSize=[0,0],u.startWidth=m.inlineCSSWidth||m.cssWidth,u.startHeight=m.inlineCSSHeight||m.cssHeight,u.maxSize=[1/0,1/0],a||(u.minSize=[m.minOffsetWidth,m.minOffsetHeight],u.maxSize=[m.maxOffsetWidth,m.maxOffsetHeight]);var T=n.props.transformOrigin||"% %";u.transformOrigin=ei(T)?T.split(" "):T,u.startOffsetMatrix=m.offsetMatrix,u.startTransformOrigin=m.transformOrigin,u.isWidth=(t=e?.parentIsWidth)!==null&&t!==void 0?t:!p[0]&&!p[1]||p[0]||!p[1];function C(k){u.ratio=k&&isFinite(k)?k:0}u.startPositions=Hi(n.state);function D(k){var V=CV(u.startPositions,k);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function M(k){var V=IV(n.state,k);u.fixedDirection=V.fixedDirection,u.fixedPosition=V.fixedPosition,u.fixedOffset=V.fixedOffset}function j(k){u.minSize=[Jt("".concat(k[0]),0)||0,Jt("".concat(k[1]),0)||0]}function z(k){var V=[k[0]||1/0,k[1]||1/0];(!Ed(V[0])||isFinite(V[0]))&&(V[0]=Jt("".concat(V[0]),0)||1/0),(!Ed(V[1])||isFinite(V[1]))&&(V[1]=Jt("".concat(V[1]),0)||1/0),u.maxSize=V}C(_/w),D(d||[-p[0],-p[1]]),u.setFixedDirection=D,u.setFixedPosition=M,u.setMin=j,u.setMax=z;var A=yt(n,e,{direction:p,startRatio:u.ratio,set:function(k){var V=J(k,2),B=V[0],L=V[1];u.startWidth=B,u.startHeight=L},setMin:j,setMax:z,setRatio:C,setFixedDirection:D,setFixedPosition:M,setOrigin:function(k){u.transformOrigin=k},dragStart:Vr.dragStart(n,new Td().dragStart([0,0],e))}),I=h||Ve(n,"onResizeStart",A);return u.startFixedDirection=u.fixedDirection,u.startFixedPosition=u.fixedPosition,I!==!1&&(u.isResize=!0,n.state.snapRenderInfo={request:e.isRequest,direction:p}),u.isResize?A:!1},dragControl:function(n,e){var t,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,c=e.dragClient,u=e.parentDist,d=e.useSnap,h=e.isRequest,p=e.isGroup,m=e.parentEvent,b=e.resolveMatrix,_=r.isResize,w=r.transformOrigin,S=r.startWidth,T=r.startHeight,C=r.prevWidth,D=r.prevHeight,M=r.minSize,j=r.maxSize,z=r.ratio,A=r.startOffsetWidth,I=r.startOffsetHeight,k=r.isWidth;if(!_)return;if(b){var V=n.state.is3d,B=r.startOffsetMatrix,L=r.startTransformOrigin,P=V?4:3,Z=lp(sv(e)),K=Math.sqrt(Z.length);P!==K&&(Z=ma(Z,K,P));var H=Qp(B,Z,L,P),$=Bc(H,A,I,P);r.startPositions=$,r.nextTargetMatrix=Z,r.nextAllMatrix=H}var Q=Pc(n.props,"resizable"),re=Q.resizeFormat,ue=Q.throttleResize,G=ue===void 0?i?0:1:ue,Y=Q.parentMoveable,ne=Q.keepRatioFinally,te=r.direction,ce=te,fe=0,ye=0;!te[0]&&!te[1]&&(ce=[1,1]);var Ae=z&&(o??Q.keepRatio)||!1;function Pe(){var st=r.fixedDirection,at=YV(ce,Ae,r,e);fe=at.distWidth,ye=at.distHeight;var Kt=ce[0]-st[0]||Ae?Math.max(A+fe,Fr):A,Vn=ce[1]-st[1]||Ae?Math.max(I+ye,Fr):I;return Ae&&A&&I&&(k?Vn=Kt/z:Kt=Vn*z),[Kt,Vn]}var Se=J(Pe(),2),we=Se[0],ke=Se[1];m||(r.setFixedDirection(r.fixedDirection),Ve(n,"onBeforeResize",yt(n,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(st){var at;return r.setFixedDirection(st),at=J(Pe(),2),we=at[0],ke=at[1],[we,ke]},setFixedPosition:function(st){var at;return r.setFixedPosition(st),at=J(Pe(),2),we=at[0],ke=at[1],[we,ke]},boundingWidth:we,boundingHeight:ke,setSize:function(st){var at;at=J(st,2),we=at[0],ke=at[1]}},!0)));var nt=c;c||(!i&&a?nt=yZ(n,[0,0]):nt=r.fixedPosition);var Ue=[0,0];a||(Ue=fJ(n,we,ke,te,nt,!d&&h,r)),u&&(!u[0]&&(Ue[0]=0),!u[1]&&(Ue[1]=0));function Ee(){var st;re&&(st=J(re([we,ke]),2),we=st[0],ke=st[1]),we=dt(we,G),ke=dt(ke,G)}if(Ae){ce[0]&&ce[1]&&Ue[0]&&Ue[1]&&(xe(Ue[0])>xe(Ue[1])?Ue[1]=0:Ue[0]=0);var Ne=!Ue[0]&&!Ue[1];Ne&&Ee(),ce[0]&&!ce[1]||Ue[0]&&!Ue[1]||Ne&&k?(we+=Ue[0],ke=we/z):(!ce[0]&&ce[1]||!Ue[0]&&Ue[1]||Ne&&!k)&&(ke+=Ue[1],we=ke*z)}else we+=Ue[0],ke+=Ue[1],we=Math.max(0,we),ke=Math.max(0,ke);t=J(b3([we,ke],M,j,Ae?z:!1),2),we=t[0],ke=t[1],Ee(),Ae&&(p||ne)&&(k?ke=we/z:we=ke*z),fe=we-A,ye=ke-I;var Je=[fe-C,ye-D];r.prevWidth=fe,r.prevHeight=ye;var rt=vZ(n,we,ke,nt,w,r);if(!(!Y&&Je.every(function(st){return!st})&&rt.every(function(st){return!st}))){var De=Vr.drag(n,Wp(e,n.state,rt,!!a,!1,"draggable")),je=De.transform,We=S+fe,tn=T+ye,Yt=yt(n,e,W({width:We,height:tn,offsetWidth:Math.round(we),offsetHeight:Math.round(ke),startRatio:z,boundingWidth:we,boundingHeight:ke,direction:te,dist:[fe,ye],delta:Je,isPinch:!!a,drag:De},GV({style:{width:"".concat(We,"px"),height:"".concat(tn,"px")},transform:je},De,e)));return!m&&Ve(n,"onResize",Yt),Yt}},dragControlAfter:function(n,e){var t=e.datas,r=t.isResize,i=t.startOffsetWidth,a=t.startOffsetHeight,o=t.prevWidth,c=t.prevHeight;if(!(!r||n.props.checkResizableError===!1)){var u=n.state,d=u.width,h=u.height,p=d-(i+o),m=h-(a+c),b=xe(p)>3,_=xe(m)>3;if(b&&(t.startWidth+=p,t.startOffsetWidth+=p,t.prevWidth+=p),_&&(t.startHeight+=m,t.startOffsetHeight+=m,t.prevHeight+=m),b||_)return this.dragControl(n,e)}},dragControlEnd:function(n,e){var t=e.datas,r=e.parentEvent;if(t.isResize){t.isResize=!1;var i=bi(n,e,{});return!r&&Ve(n,"onResizeEnd",i),i}},dragGroupControlCondition:mk,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,W(W({},e),{isGroup:!0}));if(!r)return!1;var i=da(n,"resizable",e),a=t.startOffsetWidth,o=t.startOffsetHeight;function c(){var b=t.minSize;i.forEach(function(_){var w=_.datas,S=w.minSize,T=w.startOffsetWidth,C=w.startOffsetHeight,D=a*(T?S[0]/T:0),M=o*(C?S[1]/C:0);b[0]=Math.max(b[0],D),b[1]=Math.max(b[1],M)})}function u(){var b=t.maxSize;i.forEach(function(_){var w=_.datas,S=w.maxSize,T=w.startOffsetWidth,C=w.startOffsetHeight,D=a*(T?S[0]/T:0),M=o*(C?S[1]/C:0);b[0]=Math.min(b[0],D),b[1]=Math.min(b[1],M)})}var d=Ms(n,this,"dragControlStart",e,function(b,_){return ov(n,b,t,_)});c(),u();var h=function(b){r.setFixedDirection(b),d.forEach(function(_,w){_.setFixedDirection(b),ov(n,_.moveable,t,i[w])})};t.setFixedDirection=h;var p=W(W({},r),{targets:n.props.targets,events:d.map(function(b){return W(W({},b),{setMin:function(_){b.setMin(_),c()},setMax:function(_){b.setMax(_),u()}})}),setFixedDirection:h,setMin:function(b){r.setMin(b),c()},setMax:function(b){r.setMax(b),u()}}),m=Ve(n,"onResizeGroupStart",p);return t.isResize=m!==!1,t.isResize?r:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isResize){var r=Pc(n.props,"resizable");dy(n,"onBeforeResize",function(b){Ve(n,"onBeforeResizeGroup",yt(n,e,W(W({},b),{targets:r.targets}),!0))});var i=this.dragControl(n,W(W({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,c=i.dist,u=r.keepRatio,d=[a/(a-c[0]),o/(o-c[1])],h=t.fixedPosition,p=Ms(n,this,"dragControl",e,function(b,_){var w=J(Dr(Yp(n.rotation/180*Math.PI,3),[_.datas.originalX*d[0],_.datas.originalY*d[1],1],3),2),S=w[0],T=w[1];return W(W({},_),{parentDist:null,parentScale:d,dragClient:Ot(h,[S,T]),parentKeepRatio:u})}),m=W({targets:r.targets,events:p},i);return Ve(n,"onResizeGroup",m),m}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(n,e);var i=Ms(n,this,"dragControlEnd",e),a=bi(n,e,{targets:n.props.targets,events:i});return Ve(n,"onResizeGroupEnd",a),t}},request:function(n){var e={},t=0,r=0,i=!1,a=n.getRect();return{isControl:!0,requestStart:function(o){var c;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(c=o?.horizontal)!==null&&c!==void 0?c:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[t,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(n){n.state.gestos.resizable=null}};function c1(n,e,t,r,i){var a=n.props.groupable,o=n.state,c=o.is3d?4:3,u=e.origin,d=vn(n.state.rootMatrix,Ke([u[0],u[1]],a?[0,0]:[o.left,o.top]),c),h=Ot([i.left,i.top],d);e.startAbsoluteOrigin=h,e.prevDeg=On(h,[t,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=Ns(h,[t,r])}function y0(n,e,t){var r=t.defaultDeg,i=t.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>n&&a>270&&n<90?++o:a<n&&a<90&&n>270&&--o;var c=e*(o*360+n-r);return t.prevDeg=r+c,c}function u1(n,e,t,r){return y0(On(r.startAbsoluteOrigin,[n,e])/Math.PI*180,t,r)}function d1(n,e,t,r,i,a){var o=n.props.throttleRotate,c=o===void 0?0:o,u=t.prevSnapDeg,d=0,h=!1;if(a){var p=dJ(n,e,r,i+r);h=p.isSnap,d=i+p.dist}h||(d=dt(i+r,c));var m=d-i;return t.prevSnapDeg=m,[m-u,m,d]}function RV(n,e,t){var r=J(e,4),i=r[0],a=r[1],o=r[2],c=r[3];if(n==="none")return[];if(Qn(n))return n.map(function(S){return RV(S,[i,a,o,c],t)[0]});var u=J((n||"top").split("-"),2),d=u[0],h=u[1],p=[i,a];d==="left"?p=[o,i]:d==="right"?p=[a,c]:d==="bottom"&&(p=[c,o]);var m=[(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2],b=LV(p,t);if(h){var _=h==="top"||h==="left",w=d==="bottom"||d==="left";m=p[_&&!w||!_&&w?0:1]}return[[m,b]]}function G_(n,e){if(e.isRequest)return e.requestAble==="rotatable";var t=e.inputEvent.target;if(tr(t,He("rotation-control"))||n.props.rotateAroundControls&&tr(t,He("around-control"))||tr(t,He("control"))&&tr(t,He("rotatable")))return!0;var r=n.props.rotationTarget;return r?IS(r,!0).some(function(i){return i?t===i||t.contains(i):!1}):!1}var QZ=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,ZZ={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[QZ],viewClassName:function(n){return n.isDragging("rotatable")?He("view-rotation-dragging"):""},render:function(n,e){var t=Pc(n.props,"rotatable"),r=t.rotatable,i=t.rotationPosition,a=t.zoom,o=t.renderDirections,c=t.rotateAroundControls,u=t.resolveAblesWithRotatable,d=n.getState(),h=d.renderPoses,p=d.direction;if(!r)return null;var m=RV(i,h,p),b=[];if(m.forEach(function(T,C){var D=J(T,2),M=D[0],j=D[1];b.push(e.createElement("div",{key:"rotation".concat(C),className:He("rotation"),style:{transform:"translate(-50%) translate(".concat(M[0],"px, ").concat(M[1],"px) rotate(").concat(j,"rad)")}},e.createElement("div",{className:He("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:He("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var _=Gs(u||{}),w={};_.forEach(function(T){u[T].forEach(function(C){w[C]=T})});var S=[];Qn(o)&&(S=o.map(function(T){var C=w[T];return{data:C?{resolve:C}:{},classNames:C?["move"]:[],dir:T}})),b.push.apply(b,Ce([],J(fV(n,"rotatable",S,e)),!1))}return c&&b.push.apply(b,Ce([],J(vV(n,e)),!1)),b},dragControlCondition:G_,dragControlStart:function(n,e){var t,r,i=e.datas,a=e.clientX,o=e.clientY,c=e.parentRotate,u=e.parentFlag,d=e.isPinch,h=e.isRequest,p=n.state,m=p.target,b=p.left,_=p.top,w=p.direction,S=p.beforeDirection,T=p.targetTransform,C=p.moveableClientRect,D=p.offsetMatrix,M=p.targetMatrix,j=p.allMatrix,z=p.width,A=p.height;if(!h&&!m)return!1;var I=n.getRect();i.rect=I,i.transform=T,i.left=b,i.top=_;var k=function(ce){var fe=IV(n.state,ce);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedPosition(ce)},V=function(ce){var fe=WZ(n.state,ce);i.fixedDirection=fe.fixedDirection,i.fixedOffset=fe.fixedOffset,i.fixedPosition=fe.fixedPosition,G&&G.setFixedDirection(ce)},B=a,L=o;if(h||d||u){var P=c||0;i.beforeInfo={origin:I.beforeOrigin,prevDeg:P,defaultDeg:P,prevSnapDeg:0,startDist:0},i.afterInfo=W(W({},i.beforeInfo),{origin:I.origin}),i.absoluteInfo=W(W({},i.beforeInfo),{origin:I.origin,startValue:P})}else{var Z=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(Z){var K=Z.getAttribute("data-direction")||"",H=iZ[K];if(H){i.isControl=!0,i.isAroundControl=tr(Z,He("around-control")),i.controlDirection=H;var $=Z.getAttribute("data-resolve");$&&(i.resolveAble=$);var Q=CJ(p.rootMatrix,p.renderPoses,C);t=J(nr(Q,H),2),B=t[0],L=t[1]}}i.beforeInfo={origin:I.beforeOrigin},i.afterInfo={origin:I.origin},i.absoluteInfo={origin:I.origin,startValue:I.rotation};var re=k;k=function(ce){var fe=p.is3d?4:3,ye=J(Ot(H3(M,fe),ce),2),Ae=ye[0],Pe=ye[1],Se=Dr(D,kc([Ae,Pe],fe)),we=Dr(j,kc([ce[0],ce[1]],fe));re(ce);var ke=p.posDelta;i.beforeInfo.origin=Ke(Se,ke),i.afterInfo.origin=Ke(we,ke),i.absoluteInfo.origin=Ke(we,ke),c1(n,i.beforeInfo,B,L,C),c1(n,i.afterInfo,B,L,C),c1(n,i.absoluteInfo,B,L,C)},V=function(ce){var fe=nr([[0,0],[z,0],[0,A],[z,A]],ce);k(fe)}}i.startClientX=B,i.startClientY=L,i.direction=w,i.beforeDirection=S,i.startValue=0,i.datas={},sy(n,e,"rotate");var ue=!1,G=!1;if(i.isControl&&i.resolveAble){var Y=i.resolveAble;Y==="resizable"&&(G=F_.dragControlStart(n,W(W({},new Td("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}G||(ue=Vr.dragStart(n,new Td().dragStart([0,0],e))),k(IJ(n));var ne=yt(n,e,W(W({set:function(ce){i.startValue=ce*Math.PI/180},setFixedDirection:V,setFixedPosition:k},ay(n,e)),{dragStart:ue,resizeStart:G})),te=Ve(n,"onRotateStart",ne);return i.isRotate=te!==!1,p.snapRenderInfo={request:e.isRequest},i.isRotate?ne:!1},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.clientDistX,c=e.clientDistY,u=e.parentRotate,d=e.parentFlag,h=e.isPinch,p=e.groupDelta,m=e.resolveMatrix,b=a.beforeDirection,_=a.beforeInfo,w=a.afterInfo,S=a.absoluteInfo,T=a.isRotate,C=a.startValue,D=a.rect,M=a.startClientX,j=a.startClientY;if(T){ry(n,e,"rotate");var z=aZ(e),A=b*z,I=n.props.parentMoveable,k=0,V,B,L=0,P,Z,K=0,H,$,Q=180/Math.PI*C,re=S.startValue,ue=!1,G=M+o,Y=j+c;if(!d&&"parentDist"in e){var ne=e.parentDist;V=ne,P=ne,H=ne}else h||d?(V=y0(u,b,_),P=y0(u,A,w),H=y0(u,A,S)):(V=u1(G,Y,b,_),P=u1(G,Y,A,w),H=u1(G,Y,A,S),ue=!0);if(B=Q+V,Z=Q+P,$=re+H,Ve(n,"onBeforeRotate",yt(n,e,{beforeRotation:B,rotation:Z,absoluteRotation:$,setRotation:function(nt){P=nt-Q,V=P,H=P}},!0)),t=J(d1(n,D,_,V,Q,ue),3),k=t[0],V=t[1],B=t[2],r=J(d1(n,D,w,P,Q,ue),3),L=r[0],P=r[1],Z=r[2],i=J(d1(n,D,S,H,re,ue),3),K=i[0],H=i[1],$=i[2],!(!K&&!L&&!k&&!I&&!m)){var te=iy(a,"rotate(".concat(Z,"deg)"),"rotate(".concat(P,"deg)"));m&&(a.fixedPosition=mS(n,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var ce=mZ(n,P,a),fe=Ke(Ot(p||[0,0],ce),a.prevInverseDist||[0,0]);a.prevInverseDist=ce,a.requestValue=null;var ye=cV(n,te,fe,h,e),Ae=ye,Pe=Ns([G,Y],S.startAbsoluteOrigin)-S.startDist,Se=void 0;if(a.resolveAble==="resizable"){var we=F_.dragControl(n,W(W({},Wp(e,n.state,[e.deltaX,e.deltaY],!!h,!1,"resizable")),{resolveMatrix:!0,parentDistance:Pe}));we&&(Se=we,Ae=GV(Ae,we,e))}var ke=yt(n,e,W(W({delta:L,dist:P,rotate:Z,rotation:Z,beforeDist:V,beforeDelta:k,beforeRotate:B,beforeRotation:B,absoluteDist:H,absoluteDelta:K,absoluteRotate:$,absoluteRotation:$,isPinch:!!h,resize:Se},ye),Ae));return Ve(n,"onRotate",ke),ke}}},dragControlEnd:function(n,e){var t=e.datas;if(t.isRotate){t.isRotate=!1;var r=bi(n,e,{});return Ve(n,"onRotateEnd",r),r}},dragGroupControlCondition:G_,dragGroupControlStart:function(n,e){var t=e.datas,r=n.state,i=r.left,a=r.top,o=r.beforeOrigin,c=this.dragControlStart(n,e);if(!c)return!1;c.set(t.beforeDirection*n.rotation);var u=Ms(n,this,"dragControlStart",e,function(p,m){var b=p.state,_=b.left,w=b.top,S=b.beforeOrigin,T=Ot(Ke([_,w],[i,a]),Ke(S,o));return m.datas.startGroupClient=T,m.datas.groupClient=T,W(W({},m),{parentRotate:0})}),d=W(W({},c),{targets:n.props.targets,events:u}),h=Ve(n,"onRotateGroupStart",d);return t.isRotate=h!==!1,t.isRotate?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isRotate){dy(n,"onBeforeRotate",function(d){Ve(n,"onBeforeRotateGroup",yt(n,e,W(W({},d),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=t.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,c=Ms(n,this,"dragControl",e,function(d,h){var p=h.datas.startGroupClient,m=J(h.datas.groupClient,2),b=m[0],_=m[1],w=J($p(p,o*i),2),S=w[0],T=w[1],C=[S-b,T-_];return h.datas.groupClient=[S,T],W(W({},h),{parentRotate:a,groupDelta:C})});n.rotation=i*r.beforeRotation;var u=W({targets:n.props.targets,events:c,set:function(d){n.rotation=d},setGroupRotation:function(d){n.rotation=d}},r);return Ve(n,"onRotateGroup",u),u}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(n,e);var i=Ms(n,this,"dragControlEnd",e),a=bi(n,e,{targets:n.props.targets,events:i});return Ve(n,"onRotateGroupEnd",a),t}},request:function(n){var e={},t=0,r=n.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?t+=i.deltaRotate:"rotate"in i&&(t=i.rotate-r),{datas:e,parentDist:t}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function JZ(n,e){var t,r=n.direction,i=n.classNames,a=n.size,o=n.pos,c=n.zoom,u=n.key,d=r==="horizontal",h=d?"Y":"X";return e.createElement("div",{key:u,className:i.join(" "),style:(t={},t[d?"width":"height"]="".concat(a),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(h,"(-50%) scale").concat(h,"(").concat(c,")"),t)})}function wS(n,e){return JZ(W(W({},n),{classNames:Ce([He("line","guideline",n.direction)],J(n.classNames),!1).filter(function(t){return t}),size:n.size||"".concat(n.sizeValue,"px"),pos:n.pos||n.posValue.map(function(t){return"".concat(dt(t,.1),"px")})}),e)}function vk(n,e,t,r,i,a,o,c){var u=n.props.zoom;return t.map(function(d,h){var p=d.type,m=d.pos,b=[0,0];return b[o]=r,b[o?0:1]=-i+m,wS({key:"".concat(e,"TargetGuideline").concat(h),classNames:[He("target","bold",p)],posValue:b,sizeValue:a,zoom:u,direction:e},c)})}function yk(n,e,t,r,i,a){var o=n.props,c=o.zoom,u=o.isDisplayInnerSnapDigit,d=e==="horizontal"?dl:fl,h=i[d.start],p=i[d.end];return t.filter(function(m){var b=m.hide,_=m.elementRect;if(b)return!1;if(u&&_){var w=_.rect;if(w[d.start]<=h&&p<=w[d.end])return!1}return!0}).map(function(m,b){var _=m.pos,w=m.size,S=m.element,T=m.className,C=[-r[0]+_[0],-r[1]+_[1]];return wS({key:"".concat(e,"-default-guideline-").concat(b),classNames:S?[He("bold"),T]:[He("normal"),T],direction:e,posValue:C,sizeValue:w,zoom:c},a)})}function dh(n,e,t,r,i,a,o,c){var u,d=n.props,h=d.snapDigit,p=h===void 0?0:h,m=d.isDisplaySnapDigit,b=m===void 0?!0:m,_=d.snapDistFormat,w=_===void 0?function(j,z){return j}:_,S=d.zoom,T=e==="horizontal"?"X":"Y",C=e==="vertical"?"height":"width",D=Math.abs(i),M=b?parseFloat(D.toFixed(p)):0;return c.createElement("div",{key:"".concat(e,"-").concat(t,"-guideline-").concat(r),className:He("guideline-group",e),style:(u={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},u[C]="".concat(D,"px"),u)},wS({direction:e,classNames:[He(t),o],size:"100%",posValue:[0,0],sizeValue:D,zoom:S},c),c.createElement("div",{className:He("size-value","gap"),style:{transform:"translate".concat(T,"(-50%) scale(").concat(S,")")}},M>0?w(M,e):""))}function eJ(n,e,t,r){var i=n==="vertical"?0:1,a=n==="vertical"?1:0,o=i?dl:fl,c=t[o.start],u=t[o.end];return qV(e,function(d){return d.pos[i]}).map(function(d){var h=[],p=[],m=[];return d.forEach(function(b){var _,w,S=b.element,T=b.elementRect.rect;if(T[o.end]<c)h.push(b);else if(u<T[o.start])p.push(b);else if(T[o.start]<=c&&u<=T[o.end]&&r){var C=b.pos,D={element:S,rect:W(W({},T),(_={},_[o.end]=T[o.start],_))},M={element:S,rect:W(W({},T),(w={},w[o.start]=T[o.end],w))},j=[0,0],z=[0,0];j[i]=C[i],j[a]=C[a],z[i]=C[i],z[a]=C[a]+b.size,h.push({type:n,pos:j,size:0,elementRect:D,direction:"",elementDirection:"end"}),p.push({type:n,pos:z,size:0,elementRect:M,direction:"",elementDirection:"start"})}}),h.sort(function(b,_){return _.pos[a]-b.pos[a]}),p.sort(function(b,_){return b.pos[a]-_.pos[a]}),{total:d,start:h,end:p,inner:m}})}function tJ(n,e,t,r,i){var a=n.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(c){var u=e.filter(function(S){return S.type===c}),d=c==="vertical"?1:0,h=d?0:1,p=eJ(c,u,r,a),m=d?fl:dl,b=d?dl:fl,_=r[m.start],w=r[m.end];p.forEach(function(S){var T=S.total,C=S.start,D=S.end,M=S.inner,j=t[h]+T[0].pos[h]-r[b.start],z=r;C.forEach(function(A){var I=A.elementRect.rect,k=z[m.start]-I[m.end];if(k>0){var V=[0,0];V[d]=t[d]+z[m.start]-_-k,V[h]=j,o.push(dh(n,c,"dashed",o.length,k,V,A.className,i))}z=I}),z=r,D.forEach(function(A){var I=A.elementRect.rect,k=I[m.start]-z[m.end];if(k>0){var V=[0,0];V[d]=t[d]+z[m.end]-_,V[h]=j,o.push(dh(n,c,"dashed",o.length,k,V,A.className,i))}z=I}),M.forEach(function(A){var I=A.elementRect.rect,k=_-I[m.start],V=I[m.end]-w,B=[0,0],L=[0,0];B[d]=t[d]-k,B[h]=j,L[d]=t[d]+w-_,L[h]=j,o.push(dh(n,c,"dashed",o.length,k,B,A.className,i)),o.push(dh(n,c,"dashed",o.length,V,L,A.className,i))})})}),o}function nJ(n,e,t,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var c=e.filter(function(S){return S.type===o}).slice(0,1),u=o==="vertical"?0:1,d=u?0:1,h=u?fl:dl,p=u?dl:fl,m=r[h.start],b=r[h.end],_=r[p.start],w=r[p.end];c.forEach(function(S){var T=S.gap,C=S.gapRects,D=Math.max.apply(Math,Ce([_],J(C.map(function(z){var A=z.rect;return A[p.start]})),!1)),M=Math.min.apply(Math,Ce([w],J(C.map(function(z){var A=z.rect;return A[p.end]})),!1)),j=(D+M)/2;D===M||j===(_+w)/2||C.forEach(function(z){var A=z.rect,I=z.className,k=[t[0],t[1]];if(A[h.end]<m)k[u]+=A[h.end]-m;else if(b<A[h.start])k[u]+=A[h.start]-m-T;else return;k[d]+=j-_,a.push(dh(n,u?"vertical":"horizontal","gap",a.length,T,k,I,i))})})}),a}function q_(n){var e,t,r=n.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,c=i.scrollHeight,u=i.scrollWidth,d=i.clientHeight,h=i.clientWidth,p=i.clientLeft,m=i.clientTop,b=n.props,_=b.snapGap,w=_===void 0?!0:_,S=b.verticalGuidelines,T=b.horizontalGuidelines,C=b.snapThreshold,D=C===void 0?5:C,M=b.maxSnapElementGuidelineDistance,j=M===void 0?1/0:M,z=b.isDisplayGridGuidelines,A=Fi(Hi(n.state)),I=A.top,k=A.left,V=A.bottom,B=A.right,L={top:I,left:k,bottom:V,right:B,center:(k+B)/2,middle:(I+V)/2},P=sJ(n),Z=Ce([],J(P),!1),K=((t=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&t!==void 0?t:[1,1]).map(function(re){return re*D});w&&Z.push.apply(Z,Ce([],J(rJ(n,L,K)),!1));var H=W({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(Z.push.apply(Z,Ce([],J(aJ(n,o?u:h,o?c:d,p,m,H,z)),!1)),a){var $=i.left,Q=i.top;H.left+=$,H.top+=Q,H.right+=$,H.bottom+=Q}return Z.push.apply(Z,Ce([],J(kV(T||!1,S||!1,o?u:h,o?c:d,p,m,H)),!1)),Z=Z.filter(function(re){var ue=re.element,G=re.elementRect,Y=re.type;if(!ue||!G)return!0;var ne=G.rect;return DV(L,ne,Y,j)}),Z}function rJ(n,e,t){var r=n.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,c=o===void 0?1/0:o,u=n.state.elementRects,d=[];return[["vertical",dl,fl],["horizontal",fl,dl]].forEach(function(h){var p=J(h,3),m=p[0],b=p[1],_=p[2],w=e[b.start],S=e[b.end],T=e[b.center],C=e[_.start],D=e[_.end],M={left:t[0],top:t[1]};function j(I){var k=I.rect,V=M[b.start];return k[b.end]<w+V?w-k[b.end]:S-V<k[b.start]?k[b.start]-S:-1}var z=u.filter(function(I){var k=I.rect;return k[_.start]>D||k[_.end]<C?!1:j(I)>0}).sort(function(I,k){return j(I)-j(k)}),A=[];z.forEach(function(I){z.forEach(function(k){if(I!==k){var V=I.rect,B=k.rect,L=V[_.start],P=V[_.end],Z=B[_.start],K=B[_.end];L>K||Z>P||A.push([I,k])}})}),A.forEach(function(I){var k=J(I,2),V=k[0],B=k[1],L=V.rect,P=B.rect,Z=L[b.start],K=L[b.end],H=P[b.start],$=P[b.end],Q=M[b.start],re=0,ue=0,G=!1,Y=!1,ne=!1;if(K<=w&&S<=H){if(Y=!0,re=(H-K-(S-w))/2,ue=K+re+(S-w)/2,xe(ue-T)>Q)return}else if(K<H&&$<w+Q){if(G=!0,re=H-K,ue=$+re,xe(ue-w)>Q)return}else if(K<H&&S-Q<Z){if(ne=!0,re=H-K,ue=Z-re,xe(ue-S)>Q)return}else return;re&&DV(e,P,m,a)&&(re>c||d.push({type:m,pos:m==="vertical"?[ue,0]:[0,ue],element:B.element,size:0,className:B.className,isStart:G,isCenter:Y,isEnd:ne,gap:re,hide:!0,gapRects:[V,B],direction:"",elementDirection:""}))})}),d}function iJ(n,e,t,r){var i,a,o=n.props,c=n.state,u=o.snapGridAll,d=o.snapGridWidth,h=d===void 0?0:d,p=o.snapGridHeight,m=p===void 0?0:p,b=c.snapRenderInfo,_=b&&(((i=b.direction)===null||i===void 0?void 0:i[0])||((a=b.direction)===null||a===void 0?void 0:a[1])),w=n.moveables;if(u&&w&&_&&(h||m)){if(c.snapThresholdInfo)return;c.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var S=n.getRect(),T=S.children,C=b.direction;if(T){var D=C.map(function(j,z){var A=z===0?{snapSize:h,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:m,posName:"top",sizeName:"height",clientOffset:r.top-t},I=A.snapSize,k=A.posName,V=A.sizeName,B=A.clientOffset;if(!I)return{dir:j,multiple:1,snapSize:I,snapOffset:0};var L=S[V],P=S[k],Z=x3(T.map(function(G){return[G[k]-P,G[V],L-G[V]-G[k]+P]})).filter(function(G){return G}).sort(function(G,Y){return G-Y}),K=Z[0],H=Z.map(function(G){return dt(G/K,.1)*I}),$=1,Q=dt(L/K,.1);for($=1;$<=10&&!H.every(function(G){return G*$%1===0});++$);var re=(-j+1)/2,ue=nv(P-B,P-B+L,re,1-re);return{multiple:Q*$,dir:j,snapSize:I,snapOffset:Math.round(ue/I)}}),M=D.map(function(j){return j.multiple||1});c.snapThresholdInfo.multiples=M,c.snapThresholdInfo.offset=D.map(function(j){return j.snapOffset}),D.forEach(function(j,z){j.snapSize})}}else c.snapThresholdInfo=null}function aJ(n,e,t,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var c=n.props,u=n.state,d=c.snapGridWidth,h=d===void 0?0:d,p=c.snapGridHeight,m=p===void 0?0:p,b=[],_=a.left,w=a.top,S=[0,0];iJ(n,r,i,a);var T=u.snapThresholdInfo,C=h,D=m;if(T&&(h*=T.multiples[0]||1,m*=T.multiples[1]||1,S=T.offset),m){for(var M=function(z){b.push({type:"horizontal",pos:[_,dt(S[1]*D+z-i+w,.1)],className:He("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},j=0;j<=t*2;j+=m)M(j);for(var j=-m;j>=-t;j-=m)M(j)}if(h){for(var M=function(A){b.push({type:"vertical",pos:[dt(S[0]*C+A-r+_,.1),w],className:He("grid-guideline"),size:t,hide:!o,direction:"",grid:!0})},j=0;j<=e*2;j+=h)M(j);for(var j=-h;j>=-e;j-=h)M(j)}return b}function DV(n,e,t,r){return t==="horizontal"?xe(n.right-e.left)<=r||xe(n.left-e.right)<=r||n.left<=e.right&&e.left<=n.right:t==="vertical"?xe(n.bottom-e.top)<=r||xe(n.top-e.bottom)<=r||n.top<=e.bottom&&e.top<=n.bottom:!0}function sJ(n){var e=n.state,t=n.props.elementGuidelines,r=t===void 0?[]:t;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(m){return!m.refresh}),a=r.map(function(m){return ga(m)&&"element"in m?W(W({},m),{element:Ja(m.element,!0)}):{element:Ja(m,!0)}}).filter(function(m){return m.element}),o=yQ(i.map(function(m){return m.element}),a.map(function(m){return m.element})),c=o.maintained,u=o.added,d=[];c.forEach(function(m){var b=J(m,2),_=b[0],w=b[1];d[w]=i[_]}),oJ(n,u.map(function(m){return a[m]})).map(function(m,b){d[u[b]]=m}),e.elementRects=d;var h=yS(n.props.elementSnapDirections),p=[];return d.forEach(function(m){var b=m.element,_=m.top,w=_===void 0?h.top:_,S=m.left,T=S===void 0?h.left:S,C=m.right,D=C===void 0?h.right:C,M=m.bottom,j=M===void 0?h.bottom:M,z=m.center,A=z===void 0?h.center:z,I=m.middle,k=I===void 0?h.middle:I,V=m.className,B=m.rect,L=bS({top:w,right:D,left:T,bottom:j,center:A,middle:k},B),P=L.horizontal,Z=L.vertical,K=L.horizontalNames,H=L.verticalNames,$=B.top,Q=B.left,re=B.right-Q,ue=B.bottom-$,G=[re,ue];Z.forEach(function(Y,ne){p.push({type:"vertical",element:b,pos:[dt(Y,.1),$],size:ue,sizes:G,className:V,elementRect:m,elementDirection:ck[H[ne]]||H[ne],direction:""})}),P.forEach(function(Y,ne){p.push({type:"horizontal",element:b,pos:[Q,dt(Y,.1)],size:re,sizes:G,className:V,elementRect:m,elementDirection:ck[K[ne]]||K[ne],direction:""})})}),p}function bk(n,e){return n?n.map(function(t){var r=ga(t)?t:{pos:t},i=r.pos;return Ed(i)?r:W(W({},r),{pos:Jt(i,e)})}):[]}function kV(n,e,t,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var c=[],u=o.left,d=o.top,h=o.bottom,p=o.right,m=t+p-u,b=r+h-d;return bk(n,b).forEach(function(_){c.push({type:"horizontal",pos:[u,dt(_.pos-a+d,.1)],size:m,className:_.className,direction:""})}),bk(e,m).forEach(function(_){c.push({type:"vertical",pos:[dt(_.pos-i+u,.1),d],size:b,className:_.className,direction:""})}),c}function oJ(n,e){if(!e.length)return[];var t=n.props.groupable,r=n.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,c=r.offsetDelta,u=o?4:3,d=J(kZ(a,i,u),2),h=d[0],p=d[1],m=t?0:c[0],b=t?0:c[1];return e.map(function(_){var w=_.element.getBoundingClientRect(),S=w.left-h-m,T=w.top-p-b,C=T+w.height,D=S+w.width,M=J(Id(a,[S,T],u),2),j=M[0],z=M[1],A=J(Id(a,[D,C],u),2),I=A[0],k=A[1];return W(W({},_),{rect:{left:j,right:I,top:z,bottom:k,center:(j+I)/2,middle:(z+k)/2}})})}function Gm(n){var e=n.state,t=e.container,r=n.props.snapContainer||t;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(t!==r){var o=Ja(r,!0);if(o){var c=Mh(o),u=Tk(e,[c.left-i.left,c.top-i.top]),d=Tk(e,[c.right-i.right,c.bottom-i.bottom]);a.left=dt(u[0],1e-5),a.top=dt(u[1],1e-5),a.right=dt(d[0],1e-5),a.bottom=dt(d[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=q_(n),e.enableSnap=!0,!0}function NV(n,e,t,r,i,a){var o=Bc(n,e,t,a?4:3),c=nr(o,r);return SS(o,Ke(i,c))}function xk(n){return n?n/xe(n):0}function lJ(n,e,t,r,i,a){var o=a.fixedDirection,c=OZ(t,o,r),u=_S(n,e,t,r),d=Ce(Ce([],J(YZ(n,e,c,r,i,a)),!1),J(AV(n,u,a)),!1),h=lv(d,0),p=lv(d,1);return{width:{isBound:h.isBound,offset:h.offset[0]},height:{isBound:p.isBound,offset:p.offset[1]}}}function cJ(n,e,t,r,i,a,o,c,u){var d=nr(e,o),h=cy(n,c,{vertical:[d[0]],horizontal:[d[1]]}),p=h.horizontal.offset,m=h.vertical.offset;if(dt(m,j_)||dt(p,j_)){var b=J(as({datas:u,distX:-m,distY:-p}),2),_=b[0],w=b[1],S=Math.min(i||1/0,t+o[0]*_),T=Math.min(a||1/0,r+o[1]*w);return[S-t,T-r]}return[0,0]}function MV(n,e,t,r,i,a,o,c){for(var u=Hi(n.state),d=n.props.keepRatio,h=0,p=0,m=0;m<2;++m){var b=e(h,p),_=lJ(n,b,i,d,o,c),w=_.width,S=_.height,T=w.isBound,C=S.isBound,D=w.offset,M=S.offset;if(m===1&&(T||(D=0),C||(M=0)),m===0&&o&&!T&&!C)return[0,0];if(d){var j=xe(D)*(t?1/t:1),z=xe(M)*(r?1/r:1),A=T&&C?j<z:C||!T&&j<z;A?D=t*M/r:M=r*D/t}h+=D,p+=M}if(!d&&i[0]&&i[1]){var I=XZ(n,u,i,a,c),k=I.maxWidth,V=I.maxHeight,B=J(cJ(n,e(h,p).map(function(Z){return Z.map(function(K){return dt(K,j_)})}),t+h,r+p,k,V,i,o,c),2),D=B[0],M=B[1];h+=D,p+=M}return[h,p]}function kh(n){return n<0&&(n=n%360+360),n%=360,n}function uJ(n,e){e=kh(e);var t=Math.floor(n/360),r=t*360+360-e,i=t*360+e;return xe(n-r)<xe(n-i)?r:i}function f1(n,e){n=kh(n),e=kh(e);var t=kh(n-e);return Math.min(t,360-t)}function dJ(n,e,t,r){var i,a=n.props,o=(i=a[yV])!==null&&i!==void 0?i:5,c=a[bV];if(Yd(n,"rotatable")){var u=e.pos1,d=e.pos2,h=e.pos3,p=e.pos4,m=e.origin,b=t*Math.PI/180,_=[u,d,h,p].map(function(M){return Ke(M,m)}),w=_.map(function(M){return $p(M,b)}),S=Ce(Ce([],J(CZ(n,_,w,m,t)),!1),J(UZ(n,_,w,m,t)),!1);S.sort(function(M,j){return xe(M-t)-xe(j-t)});var T=S.length>0;if(T)return{isSnap:T,dist:T?S[0]:t}}if(c?.length&&o){var C=c.slice().sort(function(M,j){return f1(M,r)-f1(j,r)}),D=C[0];if(f1(D,r)<=o)return{isSnap:!0,dist:t+uJ(r,D)-r}}return{isSnap:!1,dist:t}}function fJ(n,e,t,r,i,a,o){if(!Yd(n,"resizable"))return[0,0];var c=o.fixedDirection,u=o.nextAllMatrix,d=n.state,h=d.allMatrix,p=d.is3d;return MV(n,function(m,b){return NV(u||h,e+m,t+b,c,i,p)},e,t,r,i,a,o)}function hJ(n,e,t,r,i){if(!Yd(n,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,c=i.fixedPosition,u=i.fixedDirection,d=i.is3d,h=MV(n,function(p,m){return NV(fZ(i,Ot(e,[p/a,m/o])),a,o,u,c,d)},a,o,t,c,r,i);return[h[0]/a,h[1]/o]}function pJ(n,e){e.absolutePoses=Hi(n.state)}function _k(n){var e=[];return n.forEach(function(t){t.guidelineInfos.forEach(function(r){var i=r.guideline;ti(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:t}))})}),e.map(function(t){var r=t.guideline,i=t.posInfo;return W(W({},r),{direction:i.direction})})}function wk(n,e,t,r,i,a){var o=vS(oy(n,a),e,t),c=o.vertical,u=o.horizontal,d=Ku();c.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.left=!0),_.direction==="end"&&(d.right=!0),r.push({type:"bounds",pos:_.pos}))}),u.forEach(function(_){_.isBound&&(_.direction==="start"&&(d.top=!0),_.direction==="end"&&(d.bottom=!0),i.push({type:"bounds",pos:_.pos}))});var h=FZ(n),p=h.boundMap,m=h.vertical,b=h.horizontal;return m.forEach(function(_){Fs(r,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||r.push({type:"bounds",pos:_})}),b.forEach(function(_){Fs(i,function(w){var S=w.type,T=w.pos;return S==="bounds"&&T===_})>=0||i.push({type:"bounds",pos:_})}),{boundMap:d,innerBoundMap:p}}var gJ=CS("",["resizable","scalable"]),mJ={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",yV,bV,xV,_V,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(n,e){var t=n.state,r=t.top,i=t.left,a=t.pos1,o=t.pos2,c=t.pos3,u=t.pos4,d=t.snapRenderInfo,h=n.props.snapRenderThreshold,p=h===void 0?1:h;if(!d||!d.render||!Yd(n,""))return Wu(n,"boundMap",Ku(),function(te){return JSON.stringify(te)}),Wu(n,"innerBoundMap",Ku(),function(te){return JSON.stringify(te)}),[];t.guidelines=q_(n);var m=Math.min(a[0],o[0],c[0],u[0]),b=Math.min(a[1],o[1],c[1],u[1]),_=d.externalPoses||[],w=Hi(n.state),S=[],T=[],C=[],D=[],M=[],j=Fi(w),z=j.width,A=j.height,I=j.top,k=j.left,V=j.bottom,B=j.right,L={left:k,right:B,top:I,bottom:V,center:(k+B)/2,middle:(I+V)/2},P=_.length>0,Z=P?Fi(_):{};if(!d.request){if(d.direction&&M.push(PZ(n,w,d.direction,p,p)),d.snap){var K=Fi(w);d.center&&(K.middle=(K.top+K.bottom)/2,K.center=(K.left+K.right)/2),M.push(uk(n,K,p,p))}P&&(d.center&&(Z.middle=(Z.top+Z.bottom)/2,Z.center=(Z.left+Z.right)/2),M.push(uk(n,Z,p,p))),M.forEach(function(te){var ce=te.vertical.posInfos,fe=te.horizontal.posInfos;S.push.apply(S,Ce([],J(ce.filter(function(ye){var Ae=ye.guidelineInfos;return Ae.some(function(Pe){var Se=Pe.guideline;return!Se.hide})}).map(function(ye){return{type:"snap",pos:ye.pos}})),!1)),T.push.apply(T,Ce([],J(fe.filter(function(ye){var Ae=ye.guidelineInfos;return Ae.some(function(Pe){var Se=Pe.guideline;return!Se.hide})}).map(function(ye){return{type:"snap",pos:ye.pos}})),!1)),C.push.apply(C,Ce([],J(_k(ce)),!1)),D.push.apply(D,Ce([],J(_k(fe)),!1))})}var H=wk(n,[k,B],[I,V],S,T),$=H.boundMap,Q=H.innerBoundMap;P&&wk(n,[Z.left,Z.right],[Z.top,Z.bottom],S,T,d.externalBounds);var re=Ce(Ce([],J(C),!1),J(D),!1),ue=re.filter(function(te){return te.element&&!te.gapRects}),G=re.filter(function(te){return te.gapRects}).sort(function(te,ce){return te.gap-ce.gap});Ve(n,"onSnap",{guidelines:re.filter(function(te){var ce=te.element;return!ce}),elements:ue,gaps:G},!0);var Y=Wu(n,"boundMap",$,function(te){return JSON.stringify(te)},Ku()),ne=Wu(n,"innerBoundMap",Q,function(te){return JSON.stringify(te)},Ku());return($===Y||Q===ne)&&Ve(n,"onBound",{bounds:$,innerBounds:Q},!0),Ce(Ce(Ce(Ce(Ce(Ce([],J(tJ(n,ue,[m,b],L,e)),!1),J(nJ(n,G,[m,b],L,e)),!1),J(yk(n,"horizontal",D,[i,r],L,e)),!1),J(yk(n,"vertical",C,[i,r],L,e)),!1),J(vk(n,"horizontal",T,m,r,z,0,e)),!1),J(vk(n,"vertical",S,b,i,A,1,e)),!1)},dragStart:function(n,e){n.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Gm(n)},drag:function(n){var e=n.state;Gm(n)||(e.guidelines=q_(n)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(n){this.unset(n)},dragEnd:function(n){this.unset(n)},dragControlCondition:function(n,e){if(gJ(n,e)||G_(n,e))return!0;if(!e.isRequest&&e.inputEvent)return tr(e.inputEvent.target,He("snap-control"))},dragControlStart:function(n){n.state.snapRenderInfo=null,Gm(n)},dragControl:function(n){this.drag(n)},dragControlEnd:function(n){this.unset(n)},dragGroupStart:function(n,e){this.dragStart(n,e)},dragGroup:function(n){this.drag(n)},dragGroupEnd:function(n){this.unset(n)},dragGroupControlStart:function(n){n.state.snapRenderInfo=null,Gm(n)},dragGroupControl:function(n){this.drag(n)},dragGroupControlEnd:function(n){this.unset(n)},unset:function(n){var e=n.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function vJ(n,e){return[n[0]*e[0],n[1]*e[1]]}function He(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return fW.apply(void 0,Ce([hS],J(n),!1))}function PV(n){n()}function yJ(n){return!n||n==="none"?[1,0,0,1,0,0]:ga(n)?n:lp(n)}function Nh(n,e,t){return iv(e,Nc(t,e),n,Nc(t.map(function(r){return-r}),e))}function bJ(n,e,t){if(e==="%"){var r=ES(n.ownerSVGElement);return r[t?"width":"height"]/100}return 1}function xJ(n){var e=_J(TS(n,":before"));return e.map(function(t,r){var i=Fp(t),a=i.value,o=i.unit;return a*bJ(n,o,r===0)})}function uv(n){return n?n.split(" "):["0","0"]}function _J(n){return uv(n.transformOrigin)}function OV(n){var e=ni(n),t=e("transform");if(t&&t!=="none")return t;if("transform"in n){var r=n.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],c=function(d){var h=i[d].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(p){return h[p]}).join(", "),")"))},u=0;u<a;++u)c(u);return o.join(" ")}return""}function up(n,e,t,r,i){var a,o,c=nS(n)||yl(n),u=!1,d,h;if(!n||t)d=n;else{var p=(a=n?.assignedSlot)===null||a===void 0?void 0:a.parentElement,m=n.parentElement;p?(u=!0,h=m,d=p):d=m}for(var b=!1,_=n===e||d===e,w="relative",S=1,T=parseFloat(i?.("zoom"))||1,C=i?.("position");d&&d!==c;){e===d&&(_=!0);var D=ni(d),M=d.tagName.toLowerCase(),j=OV(d),z=D("willChange"),A=parseFloat(D("zoom"))||1;if(w=D("position"),r&&A!==1){S=A;break}if(!t&&r&&T!==1&&C&&C!=="absolute"||M==="svg"||M==="foreignobject"||w!=="static"||j&&j!=="none"||z==="transform")break;var I=(o=n?.assignedSlot)===null||o===void 0?void 0:o.parentNode,k=d.parentNode;I&&(u=!0,h=k);var V=k;if(V&&V.nodeType===11){d=V.host,b=!0,w=ni(d)("position");break}d=V,w="relative"}return{offsetZoom:S,hasSlot:u,parentSlotElement:h,isCustomElement:b,isStatic:w==="static",isEnd:_||!d||d===c,offsetParent:d||c}}function wJ(n,e){var t,r=n.tagName.toLowerCase(),i=n.offsetLeft,a=n.offsetTop,o=ni(n),c=Jv(i),u=!c,d,h;return!u&&(r!=="svg"||n.ownerSVGElement)?(d=eV?xJ(n):uv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice(),u=!0,r==="svg"?(i=0,a=0):(t=J(TJ(n,d,n===e&&e.tagName.toLowerCase()==="g"),4),i=t[0],a=t[1],d[0]=t[2],d[1]=t[3])):(d=uv(o("transformOrigin")).map(function(p){return parseFloat(p)}),h=d.slice()),{tagName:r,isSVG:c,hasOffset:u,offset:[i||0,a||0],origin:d,targetOrigin:h}}function VV(n,e){var t=ni(n),r=ni(yl(n)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(a=0)),[a,o]}function H_(n){n.forEach(function(e){var t=e.matrix;t&&(e.matrix=ma(t,3,4))})}function EJ(n){for(var e=n.parentElement,t=!1,r=yl(n);e;){var i=TS(e).transform;if(i&&i!=="none"){t=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:t}}function uy(n,e){return e===void 0&&(e=n.length>9),"".concat(e?"matrix3d":"matrix","(").concat($3(n,!e).join(","),")")}function ES(n){var e=n.clientWidth,t=n.clientHeight;if(!n)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:t};var r=n.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||t,clientWidth:e,clientHeight:t}}function SJ(n,e){var t,r=ES(n),i=r.width,a=r.height,o=r.clientWidth,c=r.clientHeight,u=o/i,d=c/a,h=n.preserveAspectRatio.baseVal,p=h.align,m=h.meetOrSlice,b=[0,0],_=[u,d],w=[0,0];if(p!==1){var S=(p-2)%3,T=Math.floor((p-2)/3);b[0]=i*S/2,b[1]=a*T/2;var C=m===2?Math.max(d,u):Math.min(u,d);_[0]=C,_[1]=C,w[0]=(o-i)/2*S,w[1]=(c-a)/2*T}var D=cS(_,e);return t=J(w,2),D[e*(e-1)]=t[0],D[e*(e-1)+1]=t[1],Nh(D,e,b)}function TJ(n,e,t){var r=n.tagName.toLowerCase();if(!n.getBBox||!t&&r==="g")return[0,0,0,0];var i=ni(n),a=i("transform-box")==="fill-box",o=n.getBBox(),c=ES(n.ownerSVGElement),u=o.x,d=o.y;r==="foreignobject"&&!u&&!d&&(u=parseFloat(n.getAttribute("x"))||0,d=parseFloat(n.getAttribute("y"))||0);var h=u-c.x,p=d-c.y,m=a?e[0]:e[0]-h,b=a?e[1]:e[1]-p;return[h,p,m,b]}function vn(n,e,t){return Dr(n,kc(e,t),t)}function Bc(n,e,t,r){return[[0,0],[e,0],[0,t],[e,t]].map(function(i){return vn(n,i,r)})}function Fi(n){var e=n.map(function(d){return d[0]}),t=n.map(function(d){return d[1]}),r=Math.min.apply(Math,Ce([],J(e),!1)),i=Math.min.apply(Math,Ce([],J(t),!1)),a=Math.max.apply(Math,Ce([],J(e),!1)),o=Math.max.apply(Math,Ce([],J(t),!1)),c=a-r,u=o-i;return{left:r,top:i,right:a,bottom:o,width:c,height:u}}function Ek(n,e,t,r){var i=Bc(n,e,t,r);return Fi(i)}function AJ(n,e,t,r,i){var a,o=n.target,c=n.origin,u=e.matrix,d=zV(o),h=d.offsetWidth,p=d.offsetHeight,m=t.getBoundingClientRect(),b=[0,0];t===yl(t)&&(b=VV(o,!0));for(var _=o.getBoundingClientRect(),w=_.left-m.left+t.scrollLeft-(t.clientLeft||0)+b[0],S=_.top-m.top+t.scrollTop-(t.clientTop||0)+b[1],T=_.width,C=_.height,D=iv(r,i,u),M=Ek(D,h,p,r),j=M.left,z=M.top,A=M.width,I=M.height,k=vn(D,c,r),V=Ke(k,[j,z]),B=[w+V[0]*T/A,S+V[1]*C/I],L=[0,0],P=0;++P<10;){var Z=ts(i,r);a=J(Ke(vn(Z,B,r),vn(Z,k,r)),2),L[0]=a[0],L[1]=a[1];var K=iv(r,i,Nc(L,r),u),H=Ek(K,h,p,r),$=H.left,Q=H.top,re=$-w,ue=Q-S;if(xe(re)<2&&xe(ue)<2)break;B[0]-=re,B[1]-=ue}return L.map(function(G){return Math.round(G)})}function CJ(n,e,t){var r=n.length===16,i=r?4:3,a=e.map(function(u){return vn(n,u,i)}),o=t.left,c=t.top;return a.map(function(u){return[u[0]+o,u[1]+c]})}function qi(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function jV(n,e){return qi([e[0]-n[0],e[1]-n[1]])}function fh(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=On(n,e));var i=jV(n,e);return{transform:"translateY(-50%) translate(".concat(n[0],"px, ").concat(n[1],"px) rotate(").concat(r,"rad) scaleY(").concat(t,")"),width:"".concat(i,"px")}}function dv(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=t.length,a=t.reduce(function(c,u){return c+u[0]},0)/i,o=t.reduce(function(c,u){return c+u[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(n,"rad) scale(").concat(e,")")}}function Pc(n,e){var t=n[e];return ga(t)?W(W({},n),t):n}function zV(n){var e=n&&!Jv(n.offsetWidth),t=0,r=0,i=0,a=0,o=0,c=0,u=0,d=0,h=0,p=0,m=0,b=0,_=1/0,w=1/0,S=1/0,T=1/0,C=0,D=0,M=!1;if(n)if(!e&&n.ownerSVGElement){var j=n.getBBox();M=!0,t=j.width,r=j.height,o=t,c=r,u=t,d=r,i=t,a=r}else{var z=ni(n),A=n.style,I=z("boxSizing")==="border-box",k=parseFloat(z("borderLeftWidth"))||0,V=parseFloat(z("borderRightWidth"))||0,B=parseFloat(z("borderTopWidth"))||0,L=parseFloat(z("borderBottomWidth"))||0,P=parseFloat(z("paddingLeft"))||0,Z=parseFloat(z("paddingRight"))||0,K=parseFloat(z("paddingTop"))||0,H=parseFloat(z("paddingBottom"))||0,$=P+Z,Q=K+H,re=k+V,ue=B+L,G=$+re,Y=Q+ue,ne=z("position"),te=0,ce=0;if("clientLeft"in n){var fe=null;if(ne==="absolute"){var ye=up(n,yl(n));fe=ye.offsetParent}else fe=n.parentElement;if(fe){var Ae=ni(fe);te=parseFloat(Ae("width")),ce=parseFloat(Ae("height"))}}h=Math.max($,Jt(z("minWidth"),te)||0),p=Math.max(Q,Jt(z("minHeight"),ce)||0),_=Jt(z("maxWidth"),te),w=Jt(z("maxHeight"),ce),isNaN(_)&&(_=1/0),isNaN(w)&&(w=1/0),C=Jt(A.width,0)||0,D=Jt(A.height,0)||0,o=parseFloat(z("width"))||0,c=parseFloat(z("height"))||0,u=xe(o-C)<1?S_(h,C||o,_):o,d=xe(c-D)<1?S_(p,D||c,w):c,t=u,r=d,i=u,a=d,I?(S=_,T=w,m=h,b=p,u=t-G,d=r-Y):(S=_+G,T=w+Y,m=h+G,b=p+Y,t=u+G,r=d+Y),i=u+$,a=d+Q}return{svg:M,offsetWidth:t,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:u,contentHeight:d,inlineCSSWidth:C,inlineCSSHeight:D,cssWidth:o,cssHeight:c,minWidth:h,minHeight:p,maxWidth:_,maxHeight:w,minOffsetWidth:m,minOffsetHeight:b,maxOffsetWidth:S,maxOffsetHeight:T}}function LV(n,e){return On(e>0?n[0]:n[1],e>0?n[1]:n[0])}function qm(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function BV(n,e){var t=n===yl(n)||n===nS(n),r={clientLeft:n.clientLeft,clientTop:n.clientTop,clientWidth:n.clientWidth,clientHeight:n.clientHeight,scrollWidth:n.scrollWidth,scrollHeight:n.scrollHeight,overflow:!1};return t&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=ni(n)("overflow")!=="visible",W(W({},e),r)}function h1(n,e,t,r){var i=n.left,a=n.right,o=n.top,c=n.bottom,u=e.top,d=e.left,h={left:d+i,top:u+o,right:d+a,bottom:u+c,width:a-i,height:c-o};return t&&r?BV(t,h):h}function Mh(n,e){var t=0,r=0,i=0,a=0;if(n){var o=n.getBoundingClientRect();t=o.left,r=o.top,i=o.width,a=o.height}var c={left:t,top:r,width:i,height:a,right:t+i,bottom:r+a};return n&&e?BV(n,c):c}function IJ(n){var e=n.props,t=e.groupable,r=e.svgOrigin,i=n.getState(),a=i.offsetWidth,o=i.offsetHeight,c=i.svg,u=i.transformOrigin;return!t&&c&&r?RS(r,a,o):u}function UV(n,e,t,r){var i;if(n)i=n;else if(e)i=[0,0];else{var a=t.target;i=FV(a,r)}return i}function FV(n,e){if(n){var t=n.getAttribute("data-rotation")||"",r=n.getAttribute("data-direction");if(e.deg=t,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function SS(n,e){return[Ot(e,n[0]),Ot(e,n[1]),Ot(e,n[2]),Ot(e,n[3])]}function Hi(n){var e=n.left,t=n.top,r=n.pos1,i=n.pos2,a=n.pos3,o=n.pos4;return SS([r,i,a,o],[e,t])}function $_(n,e){n[e?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(n)})}function Xu(n,e){var t=e?"controlGesto":"targetGesto",r=n[t];r?.isIdle()===!1&&$_(n,e),r?.unset(),n[t]=null}function Br(n,e){if(e){var t=$d(e);t.nextStyle=W(W({},t.nextStyle),n)}return{style:n,cssText:Gs(n).map(function(r){return"".concat(v0(r,"-"),": ").concat(n[r],";")}).join("")}}function GV(n,e,t){var r=e.afterTransform||e.transform;return W(W({},Br(W(W(W({},n.style),e.style),{transform:r}),t)),{afterTransform:r,transform:n.transform})}function yt(n,e,t,r){var i=e.datas;i.datas||(i.datas={});var a=W(W({},t),{target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,moveable:n,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function bi(n,e,t){var r=e.datas,i="isDrag"in t?t.isDrag:e.isDrag;return r.datas||(r.datas={}),W(W({isDrag:i},t),{moveable:n,target:n.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:n,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function dy(n,e,t){n._emitter.on(e,t)}function Ve(n,e,t,r,i){return n.triggerEvent(e,t,r,i)}function TS(n,e){return nl(n).getComputedStyle(n,e)}function Hm(n,e,t){var r={},i={};return n.filter(function(a){var o=a.name;if(r[o]||!e.some(function(c){return a[c]}))return!1;if(!t&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function Y_(n,e){return n===e||n==null&&e==null}function Sk(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.length-1,r=0;r<t;++r){var i=n[r];if(!Jv(i))return i}return n[t]}function qV(n,e){var t=[],r=[];return n.forEach(function(i,a){var o=e(i,a,n),c=r.indexOf(o),u=t[c]||[];c===-1&&(r.push(o),t.push(u)),u.push(i)}),t}function RJ(n,e){var t=[],r={};return n.forEach(function(i,a){var o=e(i,a,n),c=r[o];c||(c=[],r[o]=c,t.push(c)),c.push(i)}),t}function HV(n){return n.reduce(function(e,t){return e.concat(t)},[])}function Cd(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.sort(function(t,r){return xe(r)-xe(t)}),n[0]}function Id(n,e,t){return Dr(ts(n,t),kc(e,t),t)}function DJ(n,e){var t,r=n.is3d,i=n.rootMatrix,a=r?4:3;return t=J(Id(i,[e.distX,e.distY],a),2),e.distX=t[0],e.distY=t[1],e}function Mi(n,e,t,r){if(!t[0]&&!t[1])return e;var i=vn(n,[xk(t[0]||1),0],r),a=vn(n,[0,xk(t[1]||1)],r),o=vn(n,[t[0]/qi(i),t[1]/qi(a)],r);return Ot(e,o)}function oa(n,e,t){return t?"".concat(n/e*100,"%"):"".concat(n,"px")}function fv(n){return xe(n)<=Fr?0:n}function AS(n){return function(e){if(!e.isDragging(n))return"";var t=bZ(e,n),r=t.deg;return r?He("view-control-rotation".concat(r)):""}}function CS(n,e){return e===void 0&&(e=[n]),function(t,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return tr(i,He("direction"))&&(!n||tr(i,He(n)))}}function kJ(n,e,t){var r,i=Sd(n,{"x%":function(j){return j/100*e.offsetWidth},"y%":function(j){return j/100*e.offsetHeight}}),a=n.slice(0,t<0?void 0:t),o=n.slice(0,t<0?void 0:t+1),c=n[t]||"",u=t<0?[]:n.slice(t),d=t<0?[]:n.slice(t+1),h=i.slice(0,t<0?void 0:t),p=i.slice(0,t<0?void 0:t+1),m=(r=i[t])!==null&&r!==void 0?r:Sd([""])[0],b=t<0?[]:i.slice(t),_=t<0?[]:i.slice(t+1),w=m?[m]:[],S=Lu(h),T=Lu(p),C=Lu(b),D=Lu(_),M=en(S,C,4);return{transforms:n,beforeFunctionMatrix:S,beforeFunctionMatrix2:T,targetFunctionMatrix:Lu(w),afterFunctionMatrix:C,afterFunctionMatrix2:D,allFunctionMatrix:M,beforeFunctions:h,beforeFunctions2:p,targetFunction:w[0],afterFunctions:b,afterFunctions2:_,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:c,afterFunctionTexts:u,afterFunctionTexts2:d}}function NJ(n){return!n||!ga(n)||qd(n)?!1:Qn(n)||"length"in n}function Ja(n,e){return n?qd(n)?n:ei(n)?e?document.querySelector(n):n:JE(n)?n():S3(n)?n:"current"in n?n.current:n:null}function IS(n,e){if(!n)return[];var t=NJ(n)?[].slice.call(n):[n];return t.reduce(function(r,i){return ei(i)&&e?Ce(Ce([],J(r),!1),J([].slice.call(document.querySelectorAll(i))),!1):(Qn(i)?r.push(IS(i,e)):r.push(Ja(i,e)),r)},[])}function MJ(n,e,t){var r=On(n,e)/Math.PI*180;return r=t>=0?r:180-r,r=r>=0?r:360+r,r}function Tk(n,e){var t=n.rootMatrix,r=n.is3d,i=r?4:3,a=ts(t,i);return r||(a=ma(a,3,4)),a[12]=0,a[13]=0,a[14]=0,mQ(a,e)}function $V(n,e,t,r,i){var a=J(n,2),o=a[0],c=a[1],u=0,d=0;if(i&&o&&c){var h=On([0,0],e),p=On([0,0],r),m=qi(e),b=Math.cos(h-p)*m;if(!r[0])d=b,u=d*t;else if(!r[1])u=b,d=u/t;else{var _=r[0]*o,w=r[1]*c,S=Math.atan2(_+e[0],w+e[1]),T=Math.atan2(_,w);S<0&&(S+=Math.PI*2),T<0&&(T+=Math.PI*2);var C=0;xe(S-T)<Math.PI/2||xe(S-T)>Math.PI/2*3||(T+=Math.PI),C=S-T,C>Math.PI*2?C-=Math.PI*2:C>Math.PI?C=2*Math.PI-C:C<-Math.PI&&(C=-2*Math.PI-C);var D=qi([_+e[0],w+e[1]])*Math.cos(C);u=D*Math.sin(T)-_,d=D*Math.cos(T)-w,r[0]<0&&(u*=-1),r[1]<0&&(d*=-1)}}else u=r[0]*e[0],d=r[1]*e[1];return[u,d]}function YV(n,e,t,r){var i,a=t.ratio,o=t.startOffsetWidth,c=t.startOffsetHeight,u=0,d=0,h=r.distX,p=r.distY,m=r.pinchScale,b=r.parentDistance,_=r.parentDist,w=r.parentScale,S=t.fixedDirection,T=[0,1].map(function(A){return xe(n[A]-S[A])}),C=[0,1].map(function(A){var I=T[A];return I!==0&&(I=2/I),I});if(_)u=_[0],d=_[1],e&&(u?d||(d=u/a):u=d*a);else if(Ed(m))u=(m-1)*o,d=(m-1)*c;else if(w)u=(w[0]-1)*o,d=(w[1]-1)*c;else if(b){var D=o*T[0],M=c*T[1],j=qi([D,M]);u=b/j*D*C[0],d=b/j*M*C[1]}else{var z=as({datas:t,distX:h,distY:p});z=C.map(function(A,I){return z[I]*A}),i=J($V([o,c],z,a,n,e),2),u=i[0],d=i[1]}return{distWidth:u,distHeight:d}}function K_(n,e){if(e){if(n==="left")return{x:"0%",y:"50%"};if(n==="top")return{x:"50%",y:"50%"};if(n==="center")return{x:"50%",y:"50%"};if(n==="right")return{x:"100%",y:"50%"};if(n==="bottom")return{x:"50%",y:"100%"};var t=J(n.split(" "),2),r=t[0],i=t[1],a=K_(r||""),o=K_(i||""),c=W(W({},a),o),u={x:"50%",y:"50%"};return c.x&&(u.x=c.x),c.y&&(u.y=c.y),c.value&&(c.x&&!c.y&&(u.y=c.value),!c.x&&c.y&&(u.x=c.value)),u}return n==="left"?{x:"0%"}:n==="right"?{x:"100%"}:n==="top"?{y:"0%"}:n==="bottom"?{y:"100%"}:n?n==="center"?{value:"50%"}:{value:n}:{}}function RS(n,e,t){var r=K_(n,!0),i=r.x,a=r.y;return[Jt(i,e)||0,Jt(a,t)||0]}function PJ(n,e,t){var r=n.map(function(a){return Ke(a,e)}),i=r.map(function(a){return $p(a,t)});return{prev:r,next:i,result:i.map(function(a){return Ot(a,e)})}}function KV(n,e){return n.length===e.length&&n.every(function(t,r){var i=e[r],a=Qn(t),o=Qn(i);return a&&o?KV(t,i):!a&&!o?t===i:!1})}function Wu(n,e,t,r,i){var a=n._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=t,t;return o===t||r(o)===r(t)?o:(a[e]=t,t)}function jr(n){return n>=0?1:-1}function xe(n){return Math.abs(n)}function p1(n,e){return RW(n).map(function(t){return e(t)})}function XV(n){return Ed(n)?{top:n,left:n,right:n,bottom:n}:{left:n.left||0,top:n.top||0,right:n.right||0,bottom:n.bottom||0}}var OJ=Xp("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(n,e){var t=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=n.props,c=o.pinchable,u=o.ables;if(!c)return!1;var d="onPinch".concat(r?"Group":"","Start"),h="drag".concat(r?"Group":"","ControlStart"),p=(c===!0?n.controlAbles:u.filter(function(w){return c.indexOf(w.name)>-1})).filter(function(w){return w.canPinch&&w[h]}),m=yt(n,e,{});r&&(m.targets=r);var b=Ve(n,d,m);t.isPinch=b!==!1,t.ables=p;var _=t.isPinch;return _?(p.forEach(function(w){if(a[w.name]=a[w.name]||{},!!w[h]){var S=W(W({},e),{datas:a[w.name],parentRotate:i,isPinch:!0});w[h](n,S)}}),n.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},_):!1},pinch:function(n,e){var t=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,c=e.targets,u=e.angle;if(t.isPinch){var d=i*(1-1/r),h=yt(n,e,{});c&&(h.targets=c);var p="onPinch".concat(c?"Group":"");Ve(n,p,h);var m=t.ables,b="drag".concat(c?"Group":"","Control");return m.forEach(function(_){_[b]&&_[b](n,W(W({},e),{datas:a[_.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:d,parentRotate:u,isPinch:!0}))}),h}},pinchEnd:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(t.isPinch){var c="onPinch".concat(a?"Group":"","End"),u=bi(n,e,{isDrag:r});a&&(u.targets=a),Ve(n,c,u);var d=t.ables,h="drag".concat(a?"Group":"","ControlEnd");return d.forEach(function(p){p[h]&&p[h](n,W(W({},e),{isDrag:r,datas:o[p.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(n,e){return this.pinchStart(n,W(W({},e),{targets:n.props.targets}))},pinchGroup:function(n,e){return this.pinch(n,W(W({},e),{targets:n.props.targets}))},pinchGroupEnd:function(n,e){return this.pinchEnd(n,W(W({},e),{targets:n.props.targets}))}}),Ak=CS("scalable"),VJ={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:gV("scalable"),dragControlCondition:Ak,viewClassName:AS("scalable"),dragControlStart:function(n,e){var t=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=UV(a,r,i,t),c=n.state,u=c.width,d=c.height,h=c.targetTransform,p=c.target,m=c.pos1,b=c.pos2,_=c.pos4;if(!o||!p)return!1;r||Lc(n,e),t.datas={},t.transform=h,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=u,t.startOffsetHeight=d,t.startValue=[1,1];var w=!o[0]&&!o[1]||o[0]||!o[1];sy(n,e,"scale"),t.isWidth=w;function S(z){t.ratio=z&&isFinite(z)?z:0}t.startPositions=Hi(n.state);function T(z){var A=CV(t.startPositions,z);t.fixedDirection=A.fixedDirection,t.fixedPosition=A.fixedPosition,t.fixedOffset=A.fixedOffset}t.setFixedDirection=T,S(Ns(m,b)/Ns(b,_)),T([-o[0],-o[1]]);var C=function(z){t.minScaleSize=z},D=function(z){t.maxScaleSize=z};C([-1/0,-1/0]),D([1/0,1/0]);var M=yt(n,e,W(W({direction:o,set:function(z){t.startValue=z},setRatio:S,setFixedDirection:T,setMinScaleSize:C,setMaxScaleSize:D},ay(n,e)),{dragStart:Vr.dragStart(n,new Td().dragStart([0,0],e))})),j=Ve(n,"onScaleStart",M);return t.startFixedDirection=t.fixedDirection,j!==!1&&(t.isScale=!0,n.state.snapRenderInfo={request:e.isRequest,direction:o}),t.isScale?M:!1},dragControl:function(n,e){ry(n,e,"scale");var t=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,c=e.isRequest,u=e.useSnap,d=e.resolveMatrix,h=t.prevDist,p=t.direction,m=t.startOffsetWidth,b=t.startOffsetHeight,_=t.isScale,w=t.startValue,S=t.isWidth,T=t.ratio;if(!_)return!1;var C=n.props,D=C.throttleScale,M=C.parentMoveable,j=p;!p[0]&&!p[1]&&(j=[1,1]);var z=T&&(r??C.keepRatio)||!1,A=n.state,I=[w[0],w[1]];function k(){var we=YV(j,z,t,e),ke=we.distWidth,nt=we.distHeight,Ue=m?(m+ke)/m:1,Ee=b?(b+nt)/b:1;w[0]||(I[0]=ke/m),w[1]||(I[1]=nt/b);var Ne=(j[0]||z?Ue:1)*I[0],Je=(j[1]||z?Ee:1)*I[1];return Ne===0&&(Ne=jr(h[0])*Bm),Je===0&&(Je=jr(h[1])*Bm),[Ne,Je]}var V=k();if(!a&&n.props.groupable){var B=A.snapRenderInfo||{},L=B.direction;Qn(L)&&(L[0]||L[1])&&(A.snapRenderInfo={direction:p,request:e.isRequest})}Ve(n,"onBeforeScale",yt(n,e,{scale:V,setFixedDirection:function(we){return t.setFixedDirection(we),V=k(),V},startFixedDirection:t.startFixedDirection,setScale:function(we){V=we}},!0));var P=[V[0]/I[0],V[1]/I[1]],Z=o,K=[0,0],H=jr(P[0]*P[1]),$=!o&&!i&&a;if($||d?Z=mS(n,t.targetAllTransform,[0,0],[0,0],t):o||(Z=t.fixedPosition),a||(K=hJ(n,P,p,!u&&c,t)),z){j[0]&&j[1]&&K[0]&&K[1]&&(Math.abs(K[0]*m)>Math.abs(K[1]*b)?K[1]=0:K[0]=0);var Q=!K[0]&&!K[1];if(Q&&(S?P[0]=dt(P[0]*I[0],D)/I[0]:P[1]=dt(P[1]*I[1],D)/I[1]),j[0]&&!j[1]||K[0]&&!K[1]||Q&&S){P[0]+=K[0];var re=m*P[0]*I[0]/T;P[1]=jr(H*P[0])*xe(re/b/I[1])}else if(!j[0]&&j[1]||!K[0]&&K[1]||Q&&!S){P[1]+=K[1];var ue=b*P[1]*I[1]*T;P[0]=jr(H*P[1])*xe(ue/m/I[0])}}else P[0]+=K[0],P[1]+=K[1],K[0]||(P[0]=dt(P[0]*I[0],D)/I[0]),K[1]||(P[1]=dt(P[1]*I[1],D)/I[1]);P[0]===0&&(P[0]=jr(h[0])*Bm),P[1]===0&&(P[1]=jr(h[1])*Bm),V=vJ(P,[I[0],I[1]]);var G=[m,b],Y=[m*V[0],b*V[1]];Y=b3(Y,t.minScaleSize,t.maxScaleSize,z?T:!1),V=p1(2,function(we){return G[we]?Y[we]/G[we]:Y[we]}),P=p1(2,function(we){return V[we]/I[we]});var ne=p1(2,function(we){return h[we]?P[we]/h[we]:P[we]}),te="scale(".concat(P.join(", "),")"),ce="scale(".concat(V.join(", "),")"),fe=iy(t,ce,te),ye=!w[0]||!w[1],Ae=hZ(n,ye?ce:te,t.fixedDirection,Z,t.fixedOffset,t,ye),Pe=$?Ae:Ke(Ae,t.prevInverseDist||[0,0]);if(t.prevDist=P,t.prevInverseDist=Ae,V[0]===h[0]&&V[1]===h[1]&&Pe.every(function(we){return!we})&&!M&&!$)return!1;var Se=yt(n,e,W({offsetWidth:m,offsetHeight:b,direction:p,scale:V,dist:P,delta:ne,isPinch:!!a},cV(n,fe,Pe,a,e)));return Ve(n,"onScale",Se),Se},dragControlEnd:function(n,e){var t=e.datas;if(!t.isScale)return!1;t.isScale=!1;var r=bi(n,e,{});return Ve(n,"onScaleEnd",r),r},dragGroupControlCondition:Ak,dragGroupControlStart:function(n,e){var t=e.datas,r=this.dragControlStart(n,e);if(!r)return!1;var i=da(n,"resizable",e);t.moveableScale=n.scale;var a=Ms(n,this,"dragControlStart",e,function(d,h){return ov(n,d,t,h)}),o=function(d){r.setFixedDirection(d),a.forEach(function(h,p){h.setFixedDirection(d),ov(n,h.moveable,t,i[p])})};t.setFixedDirection=o;var c=W(W({},r),{targets:n.props.targets,events:a,setFixedDirection:o}),u=Ve(n,"onScaleGroupStart",c);return t.isScale=u!==!1,t.isScale?c:!1},dragGroupControl:function(n,e){var t=e.datas;if(t.isScale){dy(n,"onBeforeScale",function(h){Ve(n,"onBeforeScaleGroup",yt(n,e,W(W({},h),{targets:n.props.targets}),!0))});var r=this.dragControl(n,e);if(r){var i=r.dist,a=t.moveableScale;n.scale=[i[0]*a[0],i[1]*a[1]];var o=n.props.keepRatio,c=t.fixedPosition,u=Ms(n,this,"dragControl",e,function(h,p){var m=J(Dr(Yp(n.rotation/180*Math.PI,3),[p.datas.originalX*i[0],p.datas.originalY*i[1],1],3),2),b=m[0],_=m[1];return W(W({},p),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:Ot(c,[b,_])})}),d=W({targets:n.props.targets,events:u},r);return Ve(n,"onScaleGroup",d),d}}},dragGroupControlEnd:function(n,e){var t=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(n,e);var i=Ms(n,this,"dragControlEnd",e),a=bi(n,e,{targets:n.props.targets,events:i});return Ve(n,"onScaleGroupEnd",a),t}},request:function(){var n={},e=0,t=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:n,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,t+=i.deltaHeight,{datas:n,parentDist:[e,t],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:n,isDrag:!0,useSnap:r}}}}};function Vo(n,e){return n.map(function(t,r){return nv(t,e[r],1,2)})}function Ck(n,e,t){var r=On(n,e),i=On(n,t),a=i-r;return a>=0?a:a+2*Math.PI}function jJ(n,e){var t=Ck(n[0],n[1],n[2]),r=Ck(e[0],e[1],e[2]),i=Math.PI;return!(t>=i&&r<=i||t<=i&&r>=i)}var zJ={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:AS("warpable"),render:function(n,e){var t=n.props,r=t.resizable,i=t.scalable,a=t.warpable,o=t.zoom;if(r||i||!a)return[];var c=n.state,u=c.pos1,d=c.pos2,h=c.pos3,p=c.pos4,m=Vo(u,d),b=Vo(d,u),_=Vo(u,h),w=Vo(h,u),S=Vo(h,p),T=Vo(p,h),C=Vo(d,p),D=Vo(p,d);return Ce([e.createElement("div",{className:He("line"),key:"middeLine1",style:fh(m,S,o)}),e.createElement("div",{className:He("line"),key:"middeLine2",style:fh(b,T,o)}),e.createElement("div",{className:He("line"),key:"middeLine3",style:fh(_,C,o)}),e.createElement("div",{className:He("line"),key:"middeLine4",style:fh(w,D,o)})],J(mV(n,"warpable",e)),!1)},dragControlCondition:function(n,e){if(e.isRequest)return!1;var t=e.inputEvent.target;return tr(t,He("direction"))&&tr(t,He("warpable"))},dragControlStart:function(n,e){var t=e.datas,r=e.inputEvent,i=n.props.target,a=r.target,o=FV(a,t);if(!o||!i)return!1;var c=n.state,u=c.transformOrigin,d=c.is3d,h=c.targetTransform,p=c.targetMatrix,m=c.width,b=c.height,_=c.left,w=c.top;t.datas={},t.targetTransform=h,t.warpTargetMatrix=d?p:ma(p,3,4),t.targetInverseMatrix=q3(ts(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=_,t.top=w,t.poses=[[0,0],[m,0],[0,b],[m,b]].map(function(C){return Ke(C,u)}),t.nextPoses=t.poses.map(function(C){var D=J(C,2),M=D[0],j=D[1];return Dr(t.warpTargetMatrix,[M,j,0,1],4)}),t.startValue=cn(4),t.prevMatrix=cn(4),t.absolutePoses=Hi(c),t.posIndexes=lV(o),Lc(n,e),sy(n,e,"matrix3d"),c.snapRenderInfo={request:e.isRequest,direction:o};var S=yt(n,e,W({set:function(C){t.startValue=C}},ay(n,e))),T=Ve(n,"onWarpStart",S);return T!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(n,e){var t=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=t.targetInverseMatrix,c=t.prevMatrix,u=t.isWarp,d=t.startValue,h=t.poses,p=t.posIndexes,m=t.absolutePoses;if(!u)return!1;if(ry(n,e,"matrix3d"),Yd(n,"warpable")){var b=p.map(function(k){return m[k]});b.length>1&&b.push([(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]);var _=cy(n,r,{horizontal:b.map(function(k){return k[1]+a}),vertical:b.map(function(k){return k[0]+i})}),w=_.horizontal,S=_.vertical;a-=w.offset,i-=S.offset}var T=as({datas:t,distX:i,distY:a},!0),C=t.nextPoses.slice();if(p.forEach(function(k){C[k]=Ot(C[k],T)}),!rZ.every(function(k){return jJ(k.map(function(V){return h[V]}),k.map(function(V){return C[V]}))}))return!1;var D=uS(h[0],h[2],h[1],h[3],C[0],C[2],C[1],C[3]);if(!D.length)return!1;var M=en(o,D,4),j=sV(t,M,!0),z=en(ts(c,4),j,4);t.prevMatrix=j;var A=en(d,j,4),I=iy(t,"matrix3d(".concat(A.join(", "),")"),"matrix3d(".concat(j.join(", "),")"));return gS(e,I),Ve(n,"onWarp",yt(n,e,W({delta:z,matrix:A,dist:j,multiply:en,transform:I},Br({transform:I},e)))),!0},dragControlEnd:function(n,e){var t=e.datas,r=e.isDrag;return t.isWarp?(t.isWarp=!1,Ve(n,"onWarpEnd",bi(n,e,{})),r):!1}},LJ=He("area-pieces"),$m=He("area-piece"),WV=He("avoid"),BJ=He("view-dragging");function g1(n){var e=n.areaElement;if(e){var t=n.state,r=t.width,i=t.height;E3(e,WV),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function Ik(n){return n.createElement("div",{key:"area_pieces",className:LJ},n.createElement("div",{className:$m}),n.createElement("div",{className:$m}),n.createElement("div",{className:$m}),n.createElement("div",{className:$m}))}var QV={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(n,e){var t=n.props,r=t.target,i=t.dragArea,a=t.groupable,o=t.passDragArea,c=n.getState(),u=c.width,d=c.height,h=c.renderPoses,p=o?He("area","pass"):He("area");if(a)return[e.createElement("div",{key:"area",ref:ks(n,"areaElement"),className:p}),Ik(e)];if(!r||!i)return[];var m=uS([0,0],[u,0],[0,d],[u,d],h[0],h[1],h[2],h[3]),b=m.length?uy(m,!0):"none";return[e.createElement("div",{key:"area",ref:ks(n,"areaElement"),className:p,style:{top:"0px",left:"0px",width:"".concat(u,"px"),height:"".concat(d,"px"),transformOrigin:"0 0",transform:b}}),Ik(e)]},dragStart:function(n,e){var t=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;t.isDragArea=!1;var o=n.areaElement,c=n.state,u=c.moveableClientRect,d=c.renderPoses,h=c.rootMatrix,p=c.is3d,m=u.left,b=u.top,_=Fi(d),w=_.left,S=_.top,T=_.width,C=_.height,D=p?4:3,M=J(Id(h,[r-m,i-b],D),2),j=M[0],z=M[1];j-=w,z-=S;var A=[{left:w,top:S,width:T,height:z-10},{left:w,top:S,width:j-10,height:C},{left:w,top:S+z+10,width:T,height:C-z-10},{left:w+j+10,top:S,width:T-j-10,height:C}],I=[].slice.call(o.nextElementSibling.children);A.forEach(function(k,V){I[V].style.cssText="left: ".concat(k.left,"px;top: ").concat(k.top,"px; width: ").concat(k.width,"px; height: ").concat(k.height,"px;")}),w3(o,WV),c.disableNativeEvent=!0},drag:function(n,e){var t=e.datas,r=e.inputEvent;if(this.enableNativeEvent(n),!r)return!1;t.isDragArea||(t.isDragArea=!0,g1(n))},dragEnd:function(n,e){this.enableNativeEvent(n);var t=e.inputEvent,r=e.datas;if(!t)return!1;r.isDragArea||g1(n)},dragGroupStart:function(n,e){return this.dragStart(n,e)},dragGroup:function(n,e){return this.drag(n,e)},dragGroupEnd:function(n,e){return this.dragEnd(n,e)},unset:function(n){g1(n),n.state.disableNativeEvent=!1},enableNativeEvent:function(n){var e=n.state;e.disableNativeEvent&&y3(function(){e.disableNativeEvent=!1})}},UJ=Xp("origin",{props:["origin","svgOrigin"],render:function(n,e){var t=n.props,r=t.zoom,i=t.svgOrigin,a=t.groupable,o=n.getState(),c=o.beforeOrigin,u=o.rotation,d=o.svg,h=o.allMatrix,p=o.is3d,m=o.left,b=o.top,_=o.offsetWidth,w=o.offsetHeight,S;if(!a&&d&&i){var T=J(RS(i,_,w),2),C=T[0],D=T[1],M=p?4:3,j=vn(h,[C,D],M);S=dv(u,r,Ke(j,[m,b]))}else S=dv(u,r,c);return[e.createElement("div",{className:He("control","origin"),style:S,key:"beforeOrigin"})]}});function FJ(n){var e=n.scrollContainer;return[e.scrollLeft,e.scrollTop]}var GJ={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(n,e){var t=n.props,r=t.scrollContainer,i=r===void 0?n.getContainer():r,a=t.scrollOptions,o=new wQ,c=Ja(i,!0);e.datas.dragScroll=o,n.state.dragScroll=o;var u=e.isControl?"controlGesto":"targetGesto",d=e.targets;o.on("scroll",function(h){var p=h.container,m=h.direction,b=yt(n,e,{scrollContainer:p,direction:m}),_=d?"onScrollGroup":"onScroll";d&&(b.targets=d),Ve(n,_,b)}).on("move",function(h){var p=h.offsetX,m=h.offsetY,b=h.inputEvent;n[u].scrollBy(p,m,b.inputEvent,!1)}).on("scrollDrag",function(h){var p=h.next;p(n[u].getCurrentEvent())}),o.dragStart(e,W({container:c},a))},checkScroll:function(n,e){var t=e.datas.dragScroll;if(t){var r=n.props,i=r.scrollContainer,a=i===void 0?n.getContainer():i,o=r.scrollThreshold,c=o===void 0?0:o,u=r.scrollThrottleTime,d=u===void 0?0:u,h=r.getScrollPosition,p=h===void 0?FJ:h,m=r.scrollOptions;return t.drag(e,W({container:a,threshold:c,throttleTime:d,getScrollPosition:function(b){return p({scrollContainer:b.container,direction:b.direction})}},m)),!0}},drag:function(n,e){return this.checkScroll(n,e)},dragEnd:function(n,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(n,e){return this.dragStart(n,W(W({},e),{isControl:!0}))},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupStart:function(n,e){return this.dragStart(n,W(W({},e),{targets:n.props.targets}))},dragGroup:function(n,e){return this.drag(n,W(W({},e),{targets:n.props.targets}))},dragGroupEnd:function(n,e){return this.dragEnd(n,W(W({},e),{targets:n.props.targets}))},dragGroupControlStart:function(n,e){return this.dragStart(n,W(W({},e),{targets:n.props.targets,isControl:!0}))},dragGroupControl:function(n,e){return this.drag(n,W(W({},e),{targets:n.props.targets}))},dragGroupControEnd:function(n,e){return this.dragEnd(n,W(W({},e),{targets:n.props.targets}))},unset:function(n){var e,t=n.state;(e=t.dragScroll)===null||e===void 0||e.dragEnd(),t.dragScroll=null}},ZV={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},qJ=Xp("padding",{props:["padding"],render:function(n,e){var t=n.props;if(t.dragArea)return[];var r=XV(t.padding||{}),i=r.left,a=r.top,o=r.right,c=r.bottom,u=n.getState(),d=u.renderPoses,h=u.pos1,p=u.pos2,m=u.pos3,b=u.pos4,_=[h,p,m,b],w=[];return i>0&&w.push([0,2]),a>0&&w.push([0,1]),o>0&&w.push([1,3]),c>0&&w.push([2,3]),w.map(function(S,T){var C=J(S,2),D=C[0],M=C[1],j=_[D],z=_[M],A=d[D],I=d[M],k=uS([0,0],[100,0],[0,100],[100,100],j,z,A,I);if(k.length)return e.createElement("div",{key:"padding".concat(T),className:He("padding"),style:{transform:uy(k,!0)}})})}}),Rk=["nw","ne","se","sw"];function Ym(n,e){var t=n[0]+n[1],r=t>e?e/t:1;return n[0]*=r,n[1]=e-n[1]*r,n}var HJ=[1,2,5,6],$J=[0,3,4,7],ic=[1,-1,-1,1],ac=[1,1,-1,-1];function DS(n,e,t,r,i,a,o,c){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=t),c===void 0&&(c=r);var u=[],d=!1,h=n.filter(function(m){return!m.virtual}),p=h.map(function(m){var b=m.horizontal,_=m.vertical,w=m.pos;if(_&&!d&&(d=!0,u.push("/")),d){var S=Math.max(0,_===1?w[1]-a:c-w[1]);return u.push(oa(S,r,e)),S}else{var S=Math.max(0,b===1?w[0]-i:o-w[0]);return u.push(oa(S,t,e)),S}});return{radiusPoses:h,styles:u,raws:p}}function JV(n){for(var e=[0,0],t=[0,0],r=n.length,i=0;i<r;++i){var a=n[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,t[0]=i+1),a.vertical&&(t[1]===0&&(t[0]=i),t[1]=i-t[0]+1))}return{horizontalRange:e,verticalRange:t}}function ej(n,e,t,r,i,a,o){var c,u,d,h;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var p=n.indexOf("/"),m=(p>-1?n.slice(0,p):n).length,b=n.slice(0,m),_=n.slice(m+1),w=b.length,S=_.length,T=S>0,C=J(b,4),D=C[0],M=D===void 0?"0px":D,j=C[1],z=j===void 0?M:j,A=C[2],I=A===void 0?M:A,k=C[3],V=k===void 0?z:k,B=J(_,4),L=B[0],P=L===void 0?M:L,Z=B[1],K=Z===void 0?T?P:z:Z,H=B[2],$=H===void 0?T?P:I:H,Q=B[3],re=Q===void 0?T?K:V:Q,ue=[M,z,I,V].map(function(fe){return Jt(fe,e)}),G=[P,K,$,re].map(function(fe){return Jt(fe,t)}),Y=ue.slice(),ne=G.slice();c=J(Ym([Y[0],Y[1]],e),2),Y[0]=c[0],Y[1]=c[1],u=J(Ym([Y[3],Y[2]],e),2),Y[3]=u[0],Y[2]=u[1],d=J(Ym([ne[0],ne[3]],t),2),ne[0]=d[0],ne[3]=d[1],h=J(Ym([ne[1],ne[2]],t),2),ne[1]=h[0],ne[2]=h[1];var te=o?Y:Y.slice(0,Math.max(a[0],w)),ce=o?ne:ne.slice(0,Math.max(a[1],S));return Ce(Ce([],J(te.map(function(fe,ye){var Ae=Rk[ye];return{virtual:ye>=w,horizontal:ic[ye],vertical:0,pos:[r+fe,i+(ac[ye]===-1?t:0)],sub:!0,raw:ue[ye],direction:Ae}})),!1),J(ce.map(function(fe,ye){var Ae=Rk[ye];return{virtual:ye>=S,horizontal:0,vertical:ac[ye],pos:[r+(ic[ye]===-1?e:0),i+fe],sub:!0,raw:G[ye],direction:Ae}})),!1)}function YJ(n,e,t,r,i){i===void 0&&(i=e.length);var a=JV(n.slice(r)),o=a.horizontalRange,c=a.verticalRange,u=t-r,d=0;if(u===0)d=i;else if(u>0&&u<o[1])d=o[1]-u;else if(u>=c[0])d=c[0]+c[1]-u;else return;n.splice(t,d),e.splice(t,d)}function KJ(n,e,t,r,i,a,o,c,u,d,h){d===void 0&&(d=0),h===void 0&&(h=0);var p=JV(n.slice(t)),m=p.horizontalRange,b=p.verticalRange;if(r>-1)for(var _=ic[r]===1?a-d:c-a,w=m[1];w<=r;++w){var S=ac[w]===1?h:u,T=0;if(r===w?T=a:w===0?T=d+_:ic[w]===-1&&(T=c-(e[t][0]-d)),n.splice(t+w,0,{horizontal:ic[w],vertical:0,pos:[T,S]}),e.splice(t+w,0,[T,S]),w===0)break}else if(i>-1){var C=ac[i]===1?o-h:u-o;if(m[1]===0&&b[1]===0){var D=[d+C,h];n.push({horizontal:ic[0],vertical:0,pos:D}),e.push(D)}for(var M=b[0],w=b[1];w<=i;++w){var T=ic[w]===1?d:c,S=0;if(i===w?S=o:w===0?S=h+C:ac[w]===1?S=e[t+M][1]:ac[w]===-1&&(S=u-(e[t+M][1]-h)),n.push({horizontal:0,vertical:ac[w],pos:[T,S]}),e.push([T,S]),w===0)break}}}function XJ(n,e){e===void 0&&(e=n.map(function(i){return i.raw}));var t=n.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=n.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:t,verticals:r}}var WJ=[[0,-1,"n"],[1,0,"e"]],QJ=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function kS(n,e,t){var r=n.props.clipRelative,i=n.state,a=i.width,o=i.height,c=e,u=c.type,d=c.poses,h=u==="rect",p=u==="circle";if(u==="polygon")return t.map(function(z){return"".concat(oa(z[0],a,r)," ").concat(oa(z[1],o,r))});if(h||u==="inset"){var m=t[1][1],b=t[3][0],_=t[7][0],w=t[5][1];if(h)return[m,b,w,_].map(function(z){return"".concat(z,"px")});var S=[m,a-b,o-w,_].map(function(z,A){return oa(z,A%2?a:o,r)});if(t.length>8){var T=J(Ke(t[4],t[0]),2),C=T[0],D=T[1];S.push.apply(S,Ce(["round"],J(DS(d.slice(8).map(function(z,A){return W(W({},z),{pos:t[A]})}),r,C,D,_,m,b,w).styles),!1))}return S}else if(p||u==="ellipse"){var M=t[0],j=oa(xe(t[1][1]-M[1]),p?Math.sqrt((a*a+o*o)/2):o,r),S=p?[j]:[oa(xe(t[2][0]-M[0]),a,r),j];return S.push("at",oa(M[0],a,r),oa(M[1],o,r)),S}}function hv(n,e,t,r){var i=[r,(r+e)/2,e],a=[n,(n+t)/2,t];return QJ.map(function(o){var c=J(o,3),u=c[0],d=c[1],h=c[2],p=i[u+1],m=a[d+1];return{vertical:xe(d),horizontal:xe(u),direction:h,pos:[p,m]}})}function tj(n){var e=[1/0,-1/0],t=[1/0,-1/0];return n.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),t[0]=Math.min(t[0],i[1]),t[1]=Math.max(t[1],i[1])}),[xe(e[1]-e[0]),xe(t[1]-t[0])]}function Dk(n,e,t,r,i){var a,o,c,u,d,h,p,m,b;if(n){var _=i;if(!_){var w=ni(n),S=w("clipPath");_=S!=="none"?S:w("clip")}if(!((!_||_==="none"||_==="auto")&&(_=r,!_))){var T=v3(_),C=T.prefix,D=C===void 0?_:C,M=T.value,j=M===void 0?"":M,z=D==="circle",A=" ";if(D==="polygon"){var I=uc(j||"0% 0%, 100% 0%, 100% 100%, 0% 100%");A=",";var k=I.map(function(We){var tn=J(We.split(" "),2),Yt=tn[0],st=tn[1];return{vertical:1,horizontal:1,pos:[Jt(Yt,e),Jt(st,t)]}}),V=Mc(k.map(function(We){return We.pos}));return{type:D,clipText:_,poses:k,splitter:A,left:V.minX,right:V.maxX,top:V.minY,bottom:V.maxY}}else if(z||D==="ellipse"){var B="",L="",P=0,Z=0,I=ul(j);if(z){var K="";a=J(I,4),o=a[0],K=o===void 0?"50%":o,c=a[2],B=c===void 0?"50%":c,u=a[3],L=u===void 0?"50%":u,P=Jt(K,Math.sqrt((e*e+t*t)/2)),Z=P}else{var H="",$="";d=J(I,5),h=d[0],H=h===void 0?"50%":h,p=d[1],$=p===void 0?"50%":p,m=d[3],B=m===void 0?"50%":m,b=d[4],L=b===void 0?"50%":b,P=Jt(H,e),Z=Jt($,t)}var Q=[Jt(B,e),Jt(L,t)],k=Ce([{vertical:1,horizontal:1,pos:Q,direction:"nesw"}],J(WJ.slice(0,z?1:2).map(function(Yt){return{vertical:xe(Yt[1]),horizontal:Yt[0],direction:Yt[2],sub:!0,pos:[Q[0]+Yt[0]*P,Q[1]+Yt[1]*Z]}})),!1);return{type:D,clipText:_,radiusX:P,radiusY:Z,left:Q[0]-P,top:Q[1]-Z,right:Q[0]+P,bottom:Q[1]+Z,poses:k,splitter:A}}else if(D==="inset"){var I=ul(j||"0 0 0 0"),re=I.indexOf("round"),ue=(re>-1?I.slice(0,re):I).length,G=I.slice(ue+1),Y=J(I.slice(0,ue),4),ne=Y[0],te=Y[1],ce=te===void 0?ne:te,fe=Y[2],ye=fe===void 0?ne:fe,Ae=Y[3],Pe=Ae===void 0?ce:Ae,Se=J([ne,ye].map(function(Yt){return Jt(Yt,t)}),2),we=Se[0],ke=Se[1],nt=J([Pe,ce].map(function(Yt){return Jt(Yt,e)}),2),Ue=nt[0],Ee=nt[1],Ne=e-Ee,Je=t-ke,rt=ej(G,Ne-Ue,Je-we,Ue,we),k=Ce(Ce([],J(hv(we,Ne,Je,Ue)),!1),J(rt),!1);return{type:"inset",clipText:_,poses:k,top:we,left:Ue,right:Ne,bottom:Je,radius:G,splitter:A}}else if(D==="rect"){var I=uc(j||"0px, ".concat(e,"px, ").concat(t,"px, 0px"));A=",";var De=J(I.map(function(Kt){var Vn=Fp(Kt).value;return Vn}),4),je=De[0],Ee=De[1],ke=De[2],Ue=De[3],k=hv(je,Ee,ke,Ue);return{type:"rect",clipText:_,poses:k,top:je,right:Ee,bottom:ke,left:Ue,values:I,splitter:A}}}}}function ZJ(n,e,t,r,i){var a=n[e],o=a.direction,c=a.sub,u=n.map(function(){return[0,0]}),d=o?o.split(""):[];if(r&&e<8){var h=d.filter(function(P){return P==="w"||P==="e"}),p=d.filter(function(P){return P==="n"||P==="s"}),m=h[0],b=p[0];u[e]=t;var _=J(tj(n),2),w=_[0],S=_[1],T=w&&S?w/S:0;if(T&&i){var C=(e+4)%8,D=n[C].pos,M=[0,0];o.indexOf("w")>-1?M[0]=-1:o.indexOf("e")>-1&&(M[0]=1),o.indexOf("n")>-1?M[1]=-1:o.indexOf("s")>-1&&(M[1]=1);var j=$V([w,S],t,T,M,!0),z=w+j[0],A=S+j[1],I=D[1],k=D[1],V=D[0],B=D[0];M[0]===-1?V=B-z:M[0]===1?B=V+z:(V=V-z/2,B=B+z/2),M[1]===-1?I=k-A:(M[1]===1||(I=k-A/2),k=I+A);var L=hv(I,B,k,V);n.forEach(function(P,Z){u[Z][0]=L[Z].pos[0]-P.pos[0],u[Z][1]=L[Z].pos[1]-P.pos[1]})}else n.forEach(function(P,Z){var K=P.direction;K&&(K.indexOf(m)>-1&&(u[Z][0]=t[0]),K.indexOf(b)>-1&&(u[Z][1]=t[1]))}),m&&(u[1][0]=t[0]/2,u[5][0]=t[0]/2),b&&(u[3][1]=t[1]/2,u[7][1]=t[1]/2)}else o&&!c?d.forEach(function(P){var Z=P==="n"||P==="s";n.forEach(function(K,H){var $=K.direction,Q=K.horizontal,re=K.vertical;!$||$.indexOf(P)===-1||(u[H]=[Z||!Q?0:t[0],!Z||!re?0:t[1]])})}):u[e]=t;return u}function JJ(n,e){var t=J(aV(n,e),2),r=t[0],i=t[1],a=e.datas,o=a.clipPath,c=a.clipIndex,u=o,d=u.type,h=u.poses,p=u.splitter,m=h.map(function(C){return C.pos});if(d==="polygon")m.splice(c,0,[r,i]);else if(d==="inset"){var b=HJ.indexOf(c),_=$J.indexOf(c),w=h.length;if(KJ(h,m,8,b,_,r,i,m[4][0],m[4][1],m[0][0],m[0][1]),w===h.length)return}else return;var S=kS(n,o,m),T="".concat(d,"(").concat(S.join(p),")");Ve(n,"onClip",yt(n,e,W({clipEventType:"added",clipType:d,poses:m,clipStyles:S,clipStyle:T,distX:0,distY:0},Br({clipPath:T},e))))}function eee(n,e){var t=e.datas,r=t.clipPath,i=t.clipIndex,a=r,o=a.type,c=a.poses,u=a.splitter,d=c.map(function(b){return b.pos}),h=d.length;if(o==="polygon")c.splice(i,1),d.splice(i,1);else if(o==="inset"){if(i<8||(YJ(c,d,i,8,h),h===c.length))return}else return;var p=kS(n,r,d),m="".concat(o,"(").concat(p.join(u),")");Ve(n,"onClip",yt(n,e,W({clipEventType:"removed",clipType:o,poses:d,clipStyles:p,clipStyle:m,distX:0,distY:0},Br({clipPath:m},e))))}var tee={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(n,e){var t=n.props,r=t.customClipPath,i=t.defaultClipPath,a=t.clipArea,o=t.zoom,c=t.groupable,u=n.getState(),d=u.target,h=u.width,p=u.height,m=u.allMatrix,b=u.is3d,_=u.left,w=u.top,S=u.pos1,T=u.pos2,C=u.pos3,D=u.pos4,M=u.clipPathState,j=u.snapBoundInfos,z=u.rotation;if(!d||c)return[];var A=Dk(d,h,p,i||"inset",M||r);if(!A)return[];var I=b?4:3,k=A.type,V=A.poses,B=V.map(function(Ee){var Ne=vn(m,Ee.pos,I);return[Ne[0]-_,Ne[1]-w]}),L=[],P=[],Z=k==="rect",K=k==="inset",H=k==="polygon";if(Z||K||H){var $=K?B.slice(0,8):B;P=$.map(function(Ee,Ne){var Je=Ne===0?$[$.length-1]:$[Ne-1],rt=On(Je,Ee),De=jV(Je,Ee);return e.createElement("div",{key:"clipLine".concat(Ne),className:He("line","clip-line","snap-control"),"data-clip-index":Ne,style:{width:"".concat(De,"px"),transform:"translate(".concat(Je[0],"px, ").concat(Je[1],"px) rotate(").concat(rt,"rad) scaleY(").concat(o,")")}})})}if(L=B.map(function(Ee,Ne){return e.createElement("div",{key:"clipControl".concat(Ne),className:He("control","clip-control","snap-control"),"data-clip-index":Ne,style:{transform:"translate(".concat(Ee[0],"px, ").concat(Ee[1],"px) rotate(").concat(z,"rad) scale(").concat(o,")")}})}),K&&L.push.apply(L,Ce([],J(B.slice(8).map(function(Ee,Ne){return e.createElement("div",{key:"clipRadiusControl".concat(Ne),className:He("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Ne,style:{transform:"translate(".concat(Ee[0],"px, ").concat(Ee[1],"px) rotate(").concat(z,"rad) scale(").concat(o,")")}})})),!1)),k==="circle"||k==="ellipse"){var Q=A.left,re=A.top,ue=A.radiusX,G=A.radiusY,Y=J(Ke(vn(m,[Q,re],I),vn(m,[0,0],I)),2),ne=Y[0],te=Y[1],ce="none";if(!a){for(var fe=Math.max(10,ue/5,G/5),ye=[],Ae=0;Ae<=fe;++Ae){var Pe=Math.PI*2/fe*Ae;ye.push([ue+(ue-o)*Math.cos(Pe),G+(G-o)*Math.sin(Pe)])}ye.push([ue,-2]),ye.push([-2,-2]),ye.push([-2,G*2+2]),ye.push([ue*2+2,G*2+2]),ye.push([ue*2+2,-2]),ye.push([ue,-2]),ce="polygon(".concat(ye.map(function(Ee){return"".concat(Ee[0],"px ").concat(Ee[1],"px")}).join(", "),")")}L.push(e.createElement("div",{key:"clipEllipse",className:He("clip-ellipse","snap-control"),style:{width:"".concat(ue*2,"px"),height:"".concat(G*2,"px"),clipPath:ce,transform:"translate(".concat(-_+ne,"px, ").concat(-w+te,"px) ").concat(uy(m))}}))}if(a){var Se=Fi(Ce([S,T,C,D],J(B),!1)),we=Se.width,ke=Se.height,nt=Se.left,Ue=Se.top;if(H||Z||K){var ye=K?B.slice(0,8):B;L.push(e.createElement("div",{key:"clipArea",className:He("clip-area","snap-control"),style:{width:"".concat(we,"px"),height:"".concat(ke,"px"),transform:"translate(".concat(nt,"px, ").concat(Ue,"px)"),clipPath:"polygon(".concat(ye.map(function(Ne){return"".concat(Ne[0]-nt,"px ").concat(Ne[1]-Ue,"px")}).join(", "),")")}}))}}return j&&["vertical","horizontal"].forEach(function(Ee){var Ne=j[Ee],Je=Ee==="horizontal";Ne.isSnap&&P.push.apply(P,Ce([],J(Ne.snap.posInfos.map(function(rt,De){var je=rt.pos,We=Ke(vn(m,Je?[0,je]:[je,0],I),[_,w]),tn=Ke(vn(m,Je?[h,je]:[je,p],I),[_,w]);return cp(e,"",We,tn,o,"clip".concat(Ee,"snap").concat(De),"guideline")})),!1)),Ne.isBound&&P.push.apply(P,Ce([],J(Ne.bounds.map(function(rt,De){var je=rt.pos,We=Ke(vn(m,Je?[0,je]:[je,0],I),[_,w]),tn=Ke(vn(m,Je?[h,je]:[je,p],I),[_,w]);return cp(e,"",We,tn,o,"clip".concat(Ee,"bounds").concat(De),"guideline","bounds","bold")})),!1))}),Ce(Ce([],J(L),!1),J(P),!1)},dragControlCondition:function(n,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(n,e){var t=n.props,r=t.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(n,e)},drag:function(n,e){return this.dragControl(n,W(W({},e),{isDragTarget:!0}))},dragEnd:function(n,e){return this.dragControlEnd(n,e)},dragControlStart:function(n,e){var t=n.state,r=n.props,i=r.defaultClipPath,a=r.customClipPath,o=t.target,c=t.width,u=t.height,d=e.inputEvent?e.inputEvent.target:null,h=d&&d.getAttribute("class")||"",p=e.datas,m=Dk(o,c,u,i||"inset",a);if(!m)return!1;var b=m.clipText,_=m.type,w=m.poses,S=Ve(n,"onClipStart",yt(n,e,{clipType:_,clipStyle:b,poses:w.map(function(T){return T.pos})}));return S===!1?(p.isClipStart=!1,!1):(p.isControl=h&&h.indexOf("clip-control")>-1,p.isLine=h.indexOf("clip-line")>-1,p.isArea=h.indexOf("clip-area")>-1||h.indexOf("clip-ellipse")>-1,p.clipIndex=d?parseInt(d.getAttribute("data-clip-index"),10):-1,p.clipPath=m,p.isClipStart=!0,t.clipPathState=b,Lc(n,e),!0)},dragControl:function(n,e){var t,r,i,a=e.datas,o=e.originalDatas,c=e.isDragTarget;if(!a.isClipStart)return!1;var u=a,d=u.isControl,h=u.isLine,p=u.isArea,m=u.clipIndex,b=u.clipPath;if(!b)return!1;var _=Pc(n.props,"clippable"),w=_.keepRatio,S=0,T=0,C=o.draggable,D=as(e);c&&C?(t=J(C.prevBeforeDist,2),S=t[0],T=t[1]):(r=J(D,2),S=r[0],T=r[1]);var M=[S,T],j=n.state,z=j.width,A=j.height,I=!p&&!d&&!h,k=b.type,V=b.poses,B=b.splitter,L=V.map(function(lt){return lt.pos});I&&(S=-S,T=-T);var P=!d||V[m].direction==="nesw",Z=k==="inset"||k==="rect",K=V.map(function(){return[0,0]});if(d&&!P){var H=V[m],$=H.horizontal,Q=H.vertical,re=[S*xe($),T*xe(Q)];K=ZJ(V,m,re,Z,w)}else P&&(K=L.map(function(){return[S,T]}));var ue=L.map(function(lt,Et){return Ot(lt,K[Et])}),G=Ce([],J(ue),!1);j.snapBoundInfos=null;var Y=b.type==="circle",ne=b.type==="ellipse";if(Y||ne){var te=Fi(ue),ce=xe(te.bottom-te.top),fe=xe(ne?te.right-te.left:ce),ye=ue[0][1]+ce,Ae=ue[0][0]-fe,Pe=ue[0][0]+fe;Y&&(G.push([Pe,te.bottom]),K.push([1,0])),G.push([te.left,ye]),K.push([0,1]),G.push([Ae,te.bottom]),K.push([1,0])}var Se=kV((_.clipHorizontalGuidelines||[]).map(function(lt){return Jt("".concat(lt),A)}),(_.clipVerticalGuidelines||[]).map(function(lt){return Jt("".concat(lt),z)}),z,A),we=[],ke=[];if(Y||ne)we=[G[4][0],G[2][0]],ke=[G[1][1],G[3][1]];else if(Z){var nt=[G[0],G[2],G[4],G[6]],Ue=[K[0],K[2],K[4],K[6]];we=nt.filter(function(lt,Et){return Ue[Et][0]}).map(function(lt){return lt[0]}),ke=nt.filter(function(lt,Et){return Ue[Et][1]}).map(function(lt){return lt[1]})}else we=G.filter(function(lt,Et){return K[Et][0]}).map(function(lt){return lt[0]}),ke=G.filter(function(lt,Et){return K[Et][1]}).map(function(lt){return lt[1]});var Ee=[0,0],Ne=pk(Se,_.clipTargetBounds&&{left:0,top:0,right:z,bottom:A},we,ke,5,5),Je=Ne.horizontal,rt=Ne.vertical,De=Je.offset,je=rt.offset;if(Je.isBound&&(Ee[1]+=De),rt.isBound&&(Ee[0]+=je),(ne||Y)&&K[0][0]===0&&K[0][1]===0){var te=Fi(ue),We=te.bottom-te.top,tn=ne?te.right-te.left:We,Yt=rt.isBound?xe(je):rt.snapIndex===0?-je:je,st=Je.isBound?xe(De):Je.snapIndex===0?-De:De;tn-=Yt,We-=st,Y&&(We=EV(rt,Je)>0?We:tn,tn=We);var at=G[0];G[1][1]=at[1]-We,G[2][0]=at[0]+tn,G[3][1]=at[1]+We,G[4][0]=at[0]-tn}else if(Z&&w&&d){var Kt=J(tj(V),2),Vn=Kt[0],ii=Kt[1],Qs=Vn&&ii?Vn/ii:0,Zs=V[m],Yi=Zs.direction||"",ya=G[1][1],ye=G[5][1],Ae=G[7][0],Pe=G[3][0];xe(De)<=xe(je)?De=jr(De)*xe(je)/Qs:je=jr(je)*xe(De)*Qs,Yi.indexOf("w")>-1?Ae-=je:Yi.indexOf("e")>-1?Pe-=je:(Ae+=je/2,Pe-=je/2),Yi.indexOf("n")>-1?ya-=De:Yi.indexOf("s")>-1?ye-=De:(ya+=De/2,ye-=De/2);var Nr=hv(ya,Pe,ye,Ae);G.forEach(function(kt,ct){var Nt;Nt=J(Nr[ct].pos,2),kt[0]=Nt[0],kt[1]=Nt[1]})}else G.forEach(function(lt,Et){var qe=K[Et];qe[0]&&(lt[0]-=je),qe[1]&&(lt[1]-=De)});var _n=kS(n,b,ue),ze="".concat(k,"(").concat(_n.join(B),")");if(j.clipPathState=ze,Y||ne)we=[G[4][0],G[2][0]],ke=[G[1][1],G[3][1]];else if(Z){var nt=[G[0],G[2],G[4],G[6]];we=nt.map(function(Et){return Et[0]}),ke=nt.map(function(Et){return Et[1]})}else we=G.map(function(lt){return lt[0]}),ke=G.map(function(lt){return lt[1]});if(j.snapBoundInfos=pk(Se,_.clipTargetBounds&&{left:0,top:0,right:z,bottom:A},we,ke,1,1),C){var Oe=j.is3d,ur=j.allMatrix,pt=Oe?4:3,At=Ee;c&&(At=[M[0]+Ee[0]-D[0],M[1]+Ee[1]-D[1]]),C.deltaOffset=en(ur,[At[0],At[1],0,0],pt)}return Ve(n,"onClip",yt(n,e,W({clipEventType:"changed",clipType:k,poses:ue,clipStyle:ze,clipStyles:_n,distX:S,distY:T},Br((i={},i[k==="rect"?"clip":"clipPath"]=ze,i),e)))),!0},dragControlEnd:function(n,e){this.unset(n);var t=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,c=r.isControl;return o?(Ve(n,"onClipEnd",bi(n,e,{})),i&&(c?eee(n,e):a&&JJ(n,e)),i||t):!1},unset:function(n){n.state.clipPathState="",n.state.snapBoundInfos=null}},nee={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(n,e){return e.isRequest?e.requestAble==="originDraggable":tr(e.inputEvent.target,He("origin"))},dragControlStart:function(n,e){var t=e.datas;Lc(n,e);var r=yt(n,e,{dragStart:Vr.dragStart(n,new Td().dragStart([0,0],e))}),i=Ve(n,"onDragOriginStart",r);return t.startOrigin=n.state.transformOrigin,t.startTargetOrigin=n.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,i===!1?(t.isDragOrigin=!1,!1):r},dragControl:function(n,e){var t=e.datas,r=e.isPinch,i=e.isRequest;if(!t.isDragOrigin)return!1;var a=J(as(e),2),o=a[0],c=a[1],u=n.state,d=u.width,h=u.height,p=u.offsetMatrix,m=u.targetMatrix,b=u.is3d,_=n.props.originRelative,w=_===void 0?!0:_,S=b?4:3,T=[o,c];if(i){var C=e.distOrigin;(C[0]||C[1])&&(T=C)}var D=Ot(t.startOrigin,T),M=Ot(t.startTargetOrigin,T),j=Ke(T,t.prevOrigin),z=Qp(p,m,D,S),A=n.getRect(),I=Fi(Bc(z,d,h,S)),k=[A.left-I.left,A.top-I.top];t.prevOrigin=T;var V=[oa(M[0],d,w),oa(M[1],h,w)].join(" "),B=Vr.drag(n,Wp(e,n.state,k,!!r)),L=yt(n,e,W(W({width:d,height:h,origin:D,dist:T,delta:j,transformOrigin:V,drag:B},Br({transformOrigin:V,transform:B.transform},e)),{afterTransform:B.transform}));return Ve(n,"onDragOrigin",L),L},dragControlEnd:function(n,e){var t=e.datas;return t.isDragOrigin?(Ve(n,"onDragOriginEnd",bi(n,e,{})),!0):!1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);return!!t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);return t?(n.transformOrigin=t.transformOrigin,!0):!1},request:function(n){var e={},t=n.getRect(),r=0,i=0,a=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(c){return"deltaOrigin"in c?(o[0]+=c.deltaOrigin[0],o[1]+=c.deltaOrigin[1]):"origin"in c?(o[0]=c.origin[0]-a[0],o[1]=c.origin[1]-a[1]):("x"in c?r=c.x-t.left:"deltaX"in c&&(r+=c.deltaX),"y"in c?i=c.y-t.top:"deltaY"in c&&(i+=c.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function ree(n,e,t,r){var i=n.filter(function(u){var d=u.virtual,h=u.horizontal;return h&&!d}).length,a=n.filter(function(u){var d=u.virtual,h=u.vertical;return h&&!d}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!n[o].virtual)){var c=n[o];iee(n,o),o<4?c.pos[0]=t:c.pos[1]=r}}function iee(n,e){e<4?n.slice(0,e+1).forEach(function(t){t.virtual=!1}):(n[0].virtual&&(n[0].virtual=!1),n.slice(4,e+1).forEach(function(t){t.virtual=!1}))}function aee(n,e){e<4?n.slice(e,4).forEach(function(t){t.virtual=!0}):n.slice(e).forEach(function(t){t.virtual=!0})}function kk(n,e,t,r,i){r===void 0&&(r=[0,0]);var a=[];return!n||n==="0px"?a=[]:a=ul(n),ej(a,e,t,0,0,r,i)}function Nk(n,e,t,r,i){var a=n.state,o=a.width,c=a.height,u=DS(i,n.props.roundRelative,o,c),d=u.raws,h=u.styles,p=u.radiusPoses,m=XJ(p,d),b=m.horizontals,_=m.verticals,w=h.join(" ");a.borderRadiusState=w;var S=yt(n,e,W({horizontals:b,verticals:_,borderRadius:w,width:o,height:c,delta:r,dist:t},Br({borderRadius:w},e)));return Ve(n,"onRound",S),S}function Mk(n){var e,t,r=n.getState().style,i=r.borderRadius||"";if(!i&&n.props.groupable){var a=n.moveables[0],o=n.getTargets()[0];o&&(a?.props.target===o?(i=(t=(e=n.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&t!==void 0?t:"",r.borderRadius=i):(i=TS(o).borderRadius,r.borderRadius=i))}return i}var see={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(n){var e=n.props.roundClickable;return e===!0||e==="line"?He("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(n,e){var t=n.getState(),r=t.target,i=t.width,a=t.height,o=t.allMatrix,c=t.is3d,u=t.left,d=t.top,h=t.borderRadiusState,p=n.props,m=p.minRoundControls,b=m===void 0?[0,0]:m,_=p.maxRoundControls,w=_===void 0?[4,4]:_,S=p.zoom,T=p.roundPadding,C=T===void 0?0:T,D=p.isDisplayShadowRoundControls,M=p.groupable;if(!r)return null;var j=h||Mk(n),z=c?4:3,A=kk(j,i,a,b,!0);if(!A)return null;var I=0,k=0,V=M?[0,0]:[u,d];return A.map(function(B,L){var P=B.horizontal,Z=B.vertical,K=B.direction||"",H=Ce([],J(B.pos),!1);k+=Math.abs(P),I+=Math.abs(Z),P&&K.indexOf("n")>-1&&(H[1]-=C),Z&&K.indexOf("w")>-1&&(H[0]-=C),P&&K.indexOf("s")>-1&&(H[1]+=C),Z&&K.indexOf("e")>-1&&(H[0]+=C);var $=Ke(vn(o,H,z),V),Q=D&&D!=="horizontal",re=B.vertical?I<=w[1]&&(Q||!B.virtual):k<=w[0]&&(D||!B.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(L),className:He("control","border-radius",B.vertical?"vertical":"",B.virtual?"virtual":""),"data-radius-index":L,style:{display:re?"block":"none",transform:"translate(".concat($[0],"px, ").concat($[1],"px) scale(").concat(S,")")}})})},dragControlCondition:function(n,e){if(!e.inputEvent||e.isRequest)return!1;var t=e.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(n,e){return this.dragControlCondition(n,e)},dragControlStart:function(n,e){var t=e.inputEvent,r=e.datas,i=t.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,c=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,u=o?parseInt(i.getAttribute("data-radius-index"),10):-1,d=-1;if(c){var h=i.getAttribute("data-line-key")||"";h&&(d=parseInt(h.replace(/render-line-/g,""),10),isNaN(d)&&(d=-1))}if(!o&&!c)return!1;var p=yt(n,e,{}),m=Ve(n,"onRoundStart",p);if(m===!1)return!1;r.lineIndex=d,r.controlIndex=u,r.isControl=o,r.isLine=c,Lc(n,e);var b=n.props,_=b.roundRelative,w=b.minRoundControls,S=w===void 0?[0,0]:w,T=n.state,C=T.width,D=T.height;r.isRound=!0,r.prevDist=[0,0];var M=Mk(n),j=kk(M||"",C,D,S,!0)||[];return r.controlPoses=j,T.borderRadiusState=DS(j,_,C,D).styles.join(" "),p},dragControl:function(n,e){var t=e.datas,r=t.controlPoses;if(!t.isRound||!t.isControl||!r.length)return!1;var i=t.controlIndex,a=J(as(e),2),o=a[0],c=a[1],u=[o,c],d=Ke(u,t.prevDist),h=n.props.maxRoundControls,p=h===void 0?[4,4]:h,m=n.state,b=m.width,_=m.height,w=r[i],S=w.vertical,T=w.horizontal,C=r.map(function(M){var j=M.horizontal,z=M.vertical,A=[j*T*u[0],z*S*u[1]];if(j){if(p[0]===1)return A;if(p[0]<4&&j!==T)return A}else{if(p[1]===0)return A[1]=z*T*u[0]/b*_,A;if(S){if(p[1]===1)return A;if(p[1]<4&&z!==S)return A}}return[0,0]});C[i]=u;var D=r.map(function(M,j){return W(W({},M),{pos:Ot(M.pos,C[j])})});return i<4?D.slice(0,i+1).forEach(function(M){M.virtual=!1}):D.slice(4,i+1).forEach(function(M){M.virtual=!1}),t.prevDist=[o,c],Nk(n,e,u,d,D)},dragControlEnd:function(n,e){var t=n.state;t.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,c=r.isLine,u=r.lineIndex,d=r.controlPoses,h=d.filter(function(T){var C=T.virtual;return C}).length,p=n.props.roundClickable,m=p===void 0?!0:p;if(i&&m){if(a&&(m===!0||m==="control"))aee(d,o);else if(c&&(m===!0||m==="line")){var b=J(aV(n,e),2),_=b[0],w=b[1];ree(d,u,_,w)}h!==d.filter(function(T){var C=T.virtual;return C}).length&&Nk(n,e,[0,0],[0,0],d)}var S=bi(n,e,{});return Ve(n,"onRoundEnd",S),t.borderRadiusState="",S},dragGroupControlStart:function(n,e){var t=this.dragControlStart(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=da(n,"roundable",e),o=W({targets:n.props.targets,events:a.map(function(c,u){return W(W({},c),{target:i[u],moveable:r[u],currentTarget:r[u]})})},t);return Ve(n,"onRoundGroupStart",o),t},dragGroupControl:function(n,e){var t=this.dragControl(n,e);if(!t)return!1;var r=n.moveables,i=n.props.targets,a=da(n,"roundable",e),o=W({targets:n.props.targets,events:a.map(function(c,u){return W(W(W({},c),{target:i[u],moveable:r[u],currentTarget:r[u]}),Br({borderRadius:t.borderRadius},c))})},t);return Ve(n,"onRoundGroup",o),o},dragGroupControlEnd:function(n,e){var t=n.moveables,r=n.props.targets,i=da(n,"roundable",e);dy(n,"onRound",function(c){var u=W({targets:n.props.targets,events:i.map(function(d,h){return W(W(W({},d),{target:r[h],moveable:t[h],currentTarget:t[h]}),Br({borderRadius:c.borderRadius},d))})},c);Ve(n,"onRoundGroup",u)});var a=this.dragControlEnd(n,e);if(!a)return!1;var o=W({targets:n.props.targets,events:i.map(function(c,u){var d;return W(W({},c),{target:r[u],moveable:t[u],currentTarget:t[u],lastEvent:(d=c.datas)===null||d===void 0?void 0:d.lastEvent})})},a);return Ve(n,"onRoundGroupEnd",o),o},unset:function(n){n.state.borderRadiusState=""}};function oee(n,e){var t=e?4:3,r=cn(t),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return n===i||n==="matrix(1,0,0,1,0,0)"}var nj={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(n,e){var t=n.state,r=t.is3d,i=t.targetMatrix,a=t.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat($3(i,!0),")"),c=!a||a==="none"?o:a;e.datas.startTransforms=oee(c,r)?[]:ul(c)},resetStyle:function(n){var e=n.datas;e.nextStyle={},e.nextTransforms=n.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(n,e){return yt(n,e,{setTransform:function(t){e.datas.startTransforms=Qn(t)?t:ul(t)},isPinch:!!e.isPinch})},fillDragParams:function(n,e){return yt(n,e,{isPinch:!!e.isPinch})},dragStart:function(n,e){this.setTransform(n,e),this.resetStyle(e),Ve(n,"onBeforeRenderStart",this.fillDragStartParams(n,e))},drag:function(n,e){e.datas.startTransforms||this.setTransform(n,e),this.resetStyle(e),Ve(n,"onBeforeRender",yt(n,e,{isPinch:!!e.isPinch}))},dragEnd:function(n,e){e.datas.startTransforms||(this.setTransform(n,e),this.resetStyle(e)),Ve(n,"onBeforeRenderEnd",yt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(n,e){var t=this;this.dragStart(n,e);var r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.setTransform(u,o),t.resetStyle(o),t.fillDragStartParams(u,o)});Ve(n,"onBeforeRenderGroupStart",yt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,setTransform:function(){},events:a}))},dragGroup:function(n,e){var t=this;this.drag(n,e);var r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.resetStyle(o),t.fillDragParams(u,o)});Ve(n,"onBeforeRenderGroup",yt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets,events:a}))},dragGroupEnd:function(n,e){this.dragEnd(n,e),Ve(n,"onBeforeRenderGroupEnd",yt(n,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets}))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)}},rj={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(n,e){Ve(n,"onRenderStart",yt(n,e,{isPinch:!!e.isPinch}))},drag:function(n,e){Ve(n,"onRender",this.fillDragParams(n,e))},dragAfter:function(n,e){return this.drag(n,e)},dragEnd:function(n,e){Ve(n,"onRenderEnd",this.fillDragEndParams(n,e))},dragGroupStart:function(n,e){Ve(n,"onRenderGroupStart",yt(n,e,{isPinch:!!e.isPinch,targets:n.props.targets}))},dragGroup:function(n,e){var t=this,r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragParams(u,o)});Ve(n,"onRenderGroup",yt(n,e,W(W({isPinch:!!e.isPinch,targets:n.props.targets,transform:Um(e),transformObject:{}},Br(Fm(e))),{events:a})))},dragGroupEnd:function(n,e){var t=this,r=da(n,"beforeRenderable",e),i=n.moveables,a=r.map(function(o,c){var u=i[c];return t.fillDragEndParams(u,o)});Ve(n,"onRenderGroupEnd",yt(n,e,W({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:n.props.targets,events:a,transformObject:{},transform:Um(e)},Br(Fm(e)))))},dragControlStart:function(n,e){return this.dragStart(n,e)},dragControl:function(n,e){return this.drag(n,e)},dragControlAfter:function(n,e){return this.dragAfter(n,e)},dragControlEnd:function(n,e){return this.dragEnd(n,e)},dragGroupControlStart:function(n,e){return this.dragGroupStart(n,e)},dragGroupControl:function(n,e){return this.dragGroup(n,e)},dragGroupControlEnd:function(n,e){return this.dragGroupEnd(n,e)},fillDragParams:function(n,e){var t={};return Sd(sv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),yt(n,e,W({isPinch:!!e.isPinch,transformObject:t,transform:Um(e)},Br(Fm(e))))},fillDragEndParams:function(n,e){var t={};return Sd(sv(e)||[]).forEach(function(r){t[r.name]=r.functionValue}),yt(n,e,W({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:t,transform:Um(e)},Br(Fm(e))))}};function Ph(n,e,t,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var c=i==="Start",u=i==="End",d=i==="After",h=n.state.target,p=a.isRequest,m=r.indexOf("Control")>-1;if(!h||c&&m&&!p&&n.areaElement===a.inputEvent.target)return!1;var b=Ce([],J(e),!1);if(p){var _=a.requestAble;b.some(function(L){return L.name===_})||b.push.apply(b,Ce([],J(n.props.ables.filter(function(L){return L.name===_})),!1))}if(!b.length||b.every(function(L){return L.dragRelation}))return!1;var w=a.inputEvent,S;u&&w&&(S=document.elementFromPoint(a.clientX,a.clientY)||w.target);var T=!1,C=function(){var L;T=!0,(L=a.stop)===null||L===void 0||L.call(a)},D=c&&(!n.targetGesto||!n.controlGesto||!n.targetGesto.isFlag()||!n.controlGesto.isFlag());D&&n.updateRect(i,!0,!1);var M=a.datas,j=m?"controlGesto":"targetGesto",z=n[j],A=function(L,P,Z){if(!(P in L)||z!==n[j])return!1;var K=L.name,H=M[K]||(M[K]={});if(c&&(H.isEventStart=!Z||!L[Z]||L[Z](n,a)),!H.isEventStart)return!1;var $=L[P](n,W(W({},a),{stop:C,datas:H,originalDatas:M,inputTarget:S}));return n._emitter.off(),c&&$===!1&&(H.isEventStart=!1),$};D&&b.forEach(function(L){L.unset&&L.unset(n)}),A(nj,"drag".concat(r).concat(i));var I=0,k=0;t.forEach(function(L){if(T)return!1;var P="".concat(L).concat(r).concat(i),Z="".concat(L).concat(r,"Condition");i===""&&!p&&DJ(n.state,a);var K=b.filter(function(Q){return Q[P]});K=K.filter(function(Q,re){return Q.name&&K.indexOf(Q)===re});var H=K.filter(function(Q){return A(Q,P,Z)}),$=H.length;T&&++I,$&&++k,!T&&c&&K.length&&!$&&(I+=K.filter(function(Q){var re=Q.name,ue=M[re];return ue.isEventStart?Q.dragRelation!=="strong":!1}).length?1:0)}),(!d||k)&&A(rj,"drag".concat(r).concat(i));var V=z!==n[j]||I===t.length;if((u||T||V)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(L){L.state.gestos={}}),b.forEach(function(L){L.unset&&L.unset(n)})),c&&!V&&!p&&k&&n.props.preventDefault&&a?.preventDefault(),n.isUnmounted||V)return!1;if(!c&&k&&!o||u){var B=n.props.flushSync||PV;B(function(){n.updateRect(u?i:"",!0,!1),n.forceUpdate()})}return!c&&!u&&!d&&k&&!o&&Ph(n,e,t,r,i+"After",a),!0}function NS(n,e){return function(t,r){var i;r===void 0&&(r=t.inputEvent.target);var a=r,o=n.areaElement,c=n._dragTarget;return!c||!e&&(!((i=n.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===c||c.contains(a)||a===o||!n.isMoveableElement(a)&&!n.controlBox.contains(a)||tr(a,"moveable-area")||tr(a,"moveable-padding")||tr(a,"moveable-edgeDraggable")}}function ij(n,e,t){var r=n.controlBox,i=[],a=n.props,o=a.dragArea,c=n.state.target,u=a.dragTarget;i.push(r),(!o||u)&&i.push(e),!o&&u&&c&&e!==c&&a.dragTargetSelf&&i.push(c);var d=NS(n);return sj(n,i,"targetAbles",t,{dragStart:d,pinchStart:d})}function aj(n,e){var t=n.controlBox,r=[];r.push(t);var i=NS(n,!0),a=function(o,c){if(c===void 0&&(c=o.inputEvent.target),c===t)return!0;var u=i(o,c);return!u};return sj(n,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function sj(n,e,t,r,i){i===void 0&&(i={});var a=t==="targetAbles",o=n.props,c=o.pinchOutside,u=o.pinchThreshold,d=o.preventClickEventOnDrag,h=o.preventClickDefault,p=o.checkInput,m=o.dragFocusedInput,b=o.preventDefault,_=b===void 0?!0:b,w=o.preventRightClick,S=w===void 0?!0:w,T=o.preventWheelClick,C=T===void 0?!0:T,D=o.dragContainer,M=Ja(D,!0),j={preventDefault:_,preventRightClick:S,preventWheelClick:C,container:M||nl(n.getControlBoxElement()),pinchThreshold:u,pinchOutside:c,preventClickEventOnDrag:a?d:!1,preventClickEventOnDragStart:a?h:!1,preventClickEventByCondition:a?null:function(I){return n.controlBox.contains(I.target)},checkInput:a?p:!1,dragFocusedInput:m},z=new PQ(e,j),A=r==="Control";return["drag","pinch"].forEach(function(I){["Start","","End"].forEach(function(k){z.on("".concat(I).concat(k),function(V){var B,L=V.eventType,P=I==="drag"&&V.isPinch;if(i[L]&&!i[L](V)){V.stop();return}if(!P){var Z=I==="drag"?[I]:["drag",I],K=Ce([],J(n[t]),!1),H=Ph(n,K,Z,r,k,V);H?(n.props.stopPropagation||k==="Start"&&A)&&((B=V?.inputEvent)===null||B===void 0||B.stopPropagation()):V.stop()}})})}),z}var lee=(function(){function n(e,t,r){var i=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,c=i.moveable;c.state.disableNativeEvent||i.ables.forEach(function(u){u[o](c,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return n.prototype.setAbles=function(e){this.ables=e},n.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},n})();function cee(n,e,t,r){var i;t===void 0&&(t=e);var a=dV(n,e),o=a.matrixes,c=a.is3d,u=a.targetMatrix,d=a.transformOrigin,h=a.targetOrigin,p=a.offsetContainer,m=a.hasFixed,b=a.zoom,_=EZ(p,t),w=_.matrixes,S=_.is3d,T=_.offsetContainer,C=_.zoom,D=r,M=4,j=n.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in n,z=u,A=cn(M),I=cn(M),k=cn(M),V=cn(M),B=o.length,L=w.map(function(re){return W(W({},re),{matrix:re.matrix?Ce([],J(re.matrix),!1):void 0})}).reverse();o.reverse(),!c&&D&&(z=ma(z,3,4),H_(o)),!S&&D&&H_(L),L.forEach(function(re){I=en(I,re.matrix,M)});var P=t||yl(n),Z=((i=L[0])===null||i===void 0?void 0:i.target)||up(P,P,!0).offsetParent,K=L.slice(1).reduce(function(re,ue){return en(re,ue.matrix,M)},cn(M));o.forEach(function(re,ue){if(B-2===ue&&(k=A.slice()),B-1===ue&&(V=A.slice()),!re.matrix){var G=o[ue+1],Y=AJ(re,G,Z,M,en(K,A,M));re.matrix=Nc(Y,M)}A=en(A,re.matrix,M)});var H=!j&&c;z||(z=cn(H?4:3));var $=uy(j&&z.length===16?ma(z,4,3):z,H),Q=I;return I=q3(I,M,M),{hasZoom:b!==1||C!==1,hasFixed:m,matrixes:o,rootMatrix:I,originalRootMatrix:Q,beforeMatrix:k,offsetMatrix:V,allMatrix:A,targetMatrix:z,targetTransform:$,inlineTransform:n.style.transform,transformOrigin:d,targetOrigin:h,is3d:D,offsetContainer:p,offsetRootContainer:T}}function uee(n,e,t,r){t===void 0&&(t=e);var i=0,a=0,o=0,c={},u=zV(n);if(n&&(i=u.offsetWidth,a=u.offsetHeight),n){var d=cee(n,e,t,r),h=id(d.allMatrix,d.transformOrigin,i,a);c=W(W({},d),h);var p=id(d.allMatrix,[50,50],100,100);o=LV([p.pos1,p.pos2],p.direction)}var m=4;return W(W(W({hasZoom:!1,width:i,height:a,rotation:o},u),{originalRootMatrix:cn(m),rootMatrix:cn(m),beforeMatrix:cn(m),offsetMatrix:cn(m),allMatrix:cn(m),targetMatrix:cn(m),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),c)}function X_(n,e,t,r,i,a){a===void 0&&(a=[]);var o=1,c=[0,0],u=qm(),d=qm(),h=qm(),p=qm(),m=[0,0],b={},_=uee(e,t,i,!0);if(e){var w=ni(e);a.forEach(function(L){b[L]=w(L)});var S=_.is3d?4:3,T=id(_.offsetMatrix,Ot(_.transformOrigin,H3(_.targetMatrix,S)),_.width,_.height);o=T.direction,c=Ot(T.origin,[T.left-_.left,T.top-_.top]),p=Mh(_.offsetRootContainer);var C=up(r,r,!0).offsetParent||_.offsetRootContainer;if(_.hasZoom){var D=id(en(_.originalRootMatrix,_.allMatrix),_.transformOrigin,_.width,_.height),M=id(_.originalRootMatrix,uv(ni(C)("transformOrigin")).map(function(L){return parseFloat(L)}),C.offsetWidth,C.offsetHeight);if(u=h1(D,p),h=h1(M,p,C,!0),n){var j=D.left,z=D.top;d=h1({left:j,top:z,bottom:z,right:z},p)}}else{u=Mh(e),h=wZ(C),n&&(d=Mh(n));var A=h.left,I=h.top,k=h.clientLeft,V=h.clientTop,B=[u.left-A,u.top-I];m=Ke(Id(_.rootMatrix,B,4),[k+_.left,V+_.top])}}return W({targetClientRect:u,containerClientRect:h,moveableClientRect:d,rootContainerClientRect:p,beforeDirection:o,beforeOrigin:c,originalBeforeOrigin:c,target:e,style:b,offsetDelta:m},_)}function Pk(n){var e=n.pos1,t=n.pos2,r=n.pos3,i=n.pos4;if(!e||!t||!r||!i)return null;var a=Mc([e,t,r,i]),o=[a.minX,a.minY],c=Ke(n.origin,o);return e=Ke(e,o),t=Ke(t,o),r=Ke(r,o),i=Ke(i,o),W(W({},n),{left:n.left,top:n.top,posDelta:o,pos1:e,pos2:t,pos3:r,pos4:i,origin:c,beforeOrigin:c,isPersisted:!0})}var Rd=(function(n){Kp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state=W({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},X_(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new ny,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var r=t.props.parentMoveable;if(r){r.checkUpdateRect();return}TW(t._observerId),t._observerId=y3(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},t}return e.prototype.render=function(){var t=this.props,r=this.getState(),i=t.parentPosition,a=t.className,o=t.target,c=t.zoom,u=t.cspNonce,d=t.translateZ,h=t.cssStyled,p=t.groupable,m=t.linePadding,b=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var _=J(i||[0,0],2),w=_[0],S=_[1],T=r.left,C=r.top,D=r.target,M=r.direction,j=r.hasFixed,z=r.offsetDelta,A=t.targets,I=this.isDragging(),k={};this.getEnabledAbles().forEach(function(K){k["data-able-".concat(K.name.toLowerCase())]=!0});var V=this._getAbleClassName(),B=A&&A.length&&(D||p)||o||!this._hasFirstTarget&&this.state.isPersisted,L=this.controlBox||this.props.firstRenderState||this.props.persistData,P=[T-w,C-S];!p&&t.useAccuratePosition&&(P[0]+=z[0],P[1]+=z[1]);var Z={position:j?"fixed":"absolute",display:B?"block":"none",visibility:L?"visible":"hidden",transform:"translate3d(".concat(P[0],"px, ").concat(P[1],"px, ").concat(d,")"),"--zoom":c,"--zoompx":"".concat(c,"px")};return m&&(Z["--moveable-line-padding"]=m),b&&(Z["--moveable-control-padding"]=b),ua(h,W({cspNonce:u,ref:ks(this,"controlBox"),className:"".concat(He("control-box",M===-1?"reverse":"",I?"dragging":"")," ").concat(V," ").concat(a)},k,{onClick:this._onPreventClick,style:Z}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,r=t.parentMoveable,i=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},e.prototype.componentWillUnmount=function(){var t,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Xu(this,!1),Xu(this,!0);var a=this.events;for(var o in a){var c=a[o];c&&c.destroy()}},e.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},e.prototype.getAble=function(t){var r=this.props.ables||[];return ti(r,function(i){return i.name===t})},e.prototype.getContainer=function(){var t=this.props,r=t.parentMoveable,i=t.wrapperMoveable,a=t.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(t){var r;return t&&(((r=t.getAttribute)===null||r===void 0?void 0:r.call(t,"class"))||"").indexOf(hS)>-1},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=this.targetGesto,a=this.controlGesto;return i&&NS(this)({inputEvent:t},r)?i.isFlag()||i.triggerDragStart(t):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(t)),this},e.prototype.hitTest=function(t){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,c=r.pos3,u=r.pos4,d=r.targetClientRect;if(!i)return 0;var h;if(qd(t)){var p=t.getBoundingClientRect();h={left:p.left,top:p.top,width:p.width,height:p.height}}else h=W({width:0,height:0},t);var m=h.left,b=h.top,_=h.width,w=h.height,S=rk([a,o,u,c],d),T=IQ(S,[[m,b],[m+_,b],[m+_,b+w],[m,b+w]]),C=X3(S);return!T||!C?0:Math.min(100,T/C*100)},e.prototype.isInside=function(t,r){var i=this.state,a=i.target,o=i.pos1,c=i.pos2,u=i.pos3,d=i.pos4,h=i.targetClientRect;return a?N_([t,r],rk([o,c,d,u],h)):!1},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Ad(!0);var c=a.parentMoveable,u=this.state,d=u.target||a.target,h=this.getContainer(),p=c?c._rootContainer:this._rootContainer,m=X_(this.controlBox,d,h,h,p||h,this._getRequestStyles());if(!d&&this._hasFirstTarget&&a.persistData){var b=Pk(a.persistData);for(var _ in b)m[_]=b[_]}o&&Ad(),this.updateState(m,c?!1:i)},e.prototype.isDragging=function(t){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!t)return!0;var c=a.getEventData();return!!(!((r=c[t])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!t)return!0;var c=o.getEventData();return!!(!((i=c[t])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(t){this.updateRect(t,!0)},e.prototype.getRect=function(){var t=this.state,r=Hi(this.state),i=J(r,4),a=i[0],o=i[1],c=i[2],u=i[3],d=Fi(r),h=t.width,p=t.height,m=d.width,b=d.height,_=d.left,w=d.top,S=[t.left,t.top],T=Ot(S,t.origin),C=Ot(S,t.beforeOrigin),D=t.transformOrigin;return{width:m,height:b,left:_,top:w,pos1:a,pos2:o,pos3:c,pos4:u,offsetWidth:h,offsetHeight:p,beforeOrigin:C,origin:T,transformOrigin:D,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(t){if(!t||t==="target"){var r=this.targetGesto;r?.isIdle()===!1&&$_(this,!1),r?.stop()}if(!t||t==="control"){var r=this.controlGesto;r?.isIdle()===!1&&$_(this,!0),r?.stop()}},e.prototype.getRotation=function(){var t=this.state,r=t.pos1,i=t.pos2,a=t.direction;return MJ(r,i,a)},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this,o=a.props,c=o.parentMoveable||o.wrapperMoveable||a,u=c.props.ables,d=o.groupable,h=ti(u,function(T){return T.name===t});if(this.isDragging()||!h||!h.request)return{request:function(){return this},requestEnd:function(){return this}};var p=h.request(a),m=i||r.isInstant,b=p.isControl?"controlAbles":"targetAbles",_="".concat(d?"Group":"").concat(p.isControl?"Control":""),w=Ce([],J(c[b]),!1),S={request:function(T){return Ph(a,w,["drag"],_,"",W(W({},p.request(T)),{requestAble:t,isRequest:!0}),m),S},requestEnd:function(){return Ph(a,w,["drag"],_,"End",W(W({},p.requestEnd()),{requestAble:t,isRequest:!0}),m),S}};return Ph(a,w,["drag"],_,"Start",W(W({},p.requestStart(r)),{requestAble:t,isRequest:!0}),m),m?S.request(r).requestEnd():S},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var t=this.getState(),r=this.props,i=r.padding,a=t.originalBeforeOrigin,o=t.transformOrigin,c=t.allMatrix,u=t.is3d,d=t.pos1,h=t.pos2,p=t.pos3,m=t.pos4,b=t.left,_=t.top,w=t.isPersisted,S=r.zoom||1;if(!i&&S<=1){t.renderPoses=[d,h,p,m],t.renderLines=[[d,h],[h,m],[m,p],[p,d]];return}var T=XV(i||{}),C=T.left,D=T.top,M=T.bottom,j=T.right,z=u?4:3,A=[];w?A=o:this.controlBox&&r.groupable?A=a:A=Ot(a,[b,_]);var I=iv(z,Nc(A.map(function(Z){return-Z}),z),c,Nc(o,z)),k=Mi(I,d,[-C,-D],z),V=Mi(I,h,[j,-D],z),B=Mi(I,p,[-C,M],z),L=Mi(I,m,[j,M],z);t.renderPoses=[k,V,B,L],t.renderLines=[[k,V],[V,L],[L,B],[B,k]];{var P=S/2;t.renderLines=[[Mi(I,d,[-C-P,-D],z),Mi(I,h,[j+P,-D],z)],[Mi(I,h,[j,-D-P],z),Mi(I,m,[j,M+P],z)],[Mi(I,m,[j+P,M],z),Mi(I,p,[-C-P,M],z)],[Mi(I,p,[-C,M+P],z),Mi(I,d,[-C,-D-P],z)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,r=t.target,i=t.container,a=t.parentMoveable,o=this.state,c=o.target,u=o.container;if(!(!c&&!r)){this.updateAbles();var d=!Y_(c,r),h=d||!Y_(u,i);if(h){var p=i||this.controlBox;p&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&p&&this.updateRect("End",!1,!1),this._isPropTargetChanged=d}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(t,r){var i=this.props;if(this._emitter.trigger(t,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(t,r,!0);var a=i[t];return a&&a(r)},e.prototype.useCSS=function(t,r){var i=this.props.customStyledMap,a=t+r;return i[a]||(i[a]=Z3(t,r)),i[a]},e.prototype.getState=function(){var t,r=this.props;(r.target||!((t=r.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var c=Pk(a);if(c)return this.updateState(c,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(t)})},e.prototype.updateAbles=function(t,r){t===void 0&&(t=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(t),c="drag".concat(r,"Start"),u="pinch".concat(r,"Start"),d="drag".concat(r,"ControlStart"),h=Hm(o,[c,u],a),p=Hm(o,[d],a);this.enabledAbles=o,this.targetAbles=h,this.controlAbles=p},e.prototype.updateState=function(t,r){if(r){if(this.isUnmounted)return;this.setState(t)}else{var i=this.state;for(var a in t)i[a]=t[a]}},e.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var r=this.props;return t.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var t=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:ua};return this.renderState={},RJ(HV(Hm(this.getEnabledAbles(),["render"],i).map(function(o){var c=o.render;return c(t,a)||[]})).filter(function(o){return o}),function(o){var c=o.key;return c}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],J(r),!1),J(c),!1)},Ce([],J(this.props.requestStyles||[]),!1));return t},e.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},e.prototype._updateEvents=function(){var t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!t&&this.targetGesto||this._isTargetChanged(!0);a&&(Xu(this,!1),this.updateState({gestos:{}})),r||Xu(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=ij(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=aj(this,"Control"))},e.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=Ja(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var t=this.props,r=t,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,c=r.parentMoveable;if(a||c&&o)return[];var u=this.getState(),d={createElement:ua};return u.renderLines.map(function(h,p){return cp(d,"",h[0],h[1],i,"render-line-".concat(p))})},e.prototype._isTargetChanged=function(t){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,c=r.dragArea,u=!c&&a!==i,d=(t||c)&&o!==c;return u||d||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var t=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=Gs(a);if(this._isTargetChanged())for(var c in a){var u=a[c];u&&u.destroy(),a[c]=null}if(i){var d=this.enabledAbles;o.forEach(function(h){var p=Hm(d,[h]),m=p.length>0,b=a[h];if(!m){b&&(b.destroy(),a[h]=null);return}b||(b=new lee(i,t,h),a[h]=b),b.setAbles(p)})}},e.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=Ja(t,!0))},e.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=Ja(t,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(Ce(Ce([],J(this._getAbleViewClassNames()),!1),[this.isDragging()?BJ:""],!1))},e.prototype._changeAbleViewClassNames=function(t){var r=this._viewContainer,i=qV(t.filter(Boolean),function(d){return d}).map(function(d){var h=J(d,1),p=h[0];return p}),a=this._viewClassNames,o=Gp(a,i),c=o.removed,u=o.added;c.forEach(function(d){E3(r,a[d])}),u.forEach(function(d){w3(r,i[d])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(t){var r=this;t===void 0&&(t="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,c=a?.isFlag()?a.getEventData():{},u=o?.isFlag()?o.getEventData():{};return i.map(function(d){var h,p,m,b=d.name,_=((h=d.className)===null||h===void 0?void 0:h.call(d,r))||"";return(!((p=c[b])===null||p===void 0)&&p.isEventStart||!((m=u[b])===null||m===void 0)&&m.isEventStart)&&(_+=" ".concat(He("".concat(b).concat(t,"-dragging")))),_.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(t){var r,i=this.props,a=i.target,o=nl(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(t.target===a&&this._reiszeObserver)){var c=new o.ResizeObserver(this.checkUpdateRect);c.observe(a,{box:"border-box"}),this._reiszeObserver=c}},e.prototype._updateMutationObserver=function(t){var r=this,i,a=this.props,o=a.target,c=nl(this.getControlBoxElement());if(!c.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var u=new c.MutationObserver(function(d){var h,p;try{for(var m=HQ(d),b=m.next();!b.done;b=m.next()){var _=b.value;_.type==="attributes"&&_.attributeName==="style"&&r.checkUpdateRect()}}catch(w){h={error:w}}finally{try{b&&!b.done&&(p=m.return)&&p.call(m)}finally{if(h)throw h.error}}});u.observe(o,{attributes:!0}),this._mutationObserver=u}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:PV,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(D3),MS={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(n,e){var t,r=n.props,i=r.targets||[],a=n.getState(),o=a.left,c=a.top,u=a.isPersisted,d=r.zoom||1,h=n.renderGroupRects,p=((t=r.persistData)===null||t===void 0?void 0:t.children)||[];u?i=p.map(function(){return null}):p=[];var m=Wu(n,"parentPosition",[o,c],function(_){return _.join(",")}),b=Wu(n,"requestStyles",n.getRequestChildStyles(),function(_){return _.join(",")});return n.moveables=n.moveables.slice(0,i.length),Ce(Ce([],J(i.map(function(_,w){return e.createElement(Rd,{key:"moveable"+w,ref:p3(n,"moveables",w),target:_,origin:!1,requestStyles:b,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:n,parentPosition:[o,c],persistData:p[w],zoom:d})})),!1),J(HV(h.map(function(_,w){var S=_.pos1,T=_.pos2,C=_.pos3,D=_.pos4,M=[S,T,C,D];return[[0,1],[1,3],[3,2],[2,0]].map(function(j,z){var A=J(j,2),I=A[0],k=A[1];return cp(e,"",Ke(M[I],m),Ke(M[k],m),d,"group-rect-".concat(w,"-").concat(z))})}))),!1)}},dee=Xp("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(n,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(n,e){var t=n.props.target,r=e.inputEvent,i=e.inputTarget,a=n.isMoveableElement(i),o=!a&&n.controlBox.contains(i);if(!(!r||!i||e.isDrag||n.isMoveableElement(i)||o)){var c=t.contains(i);Ve(n,"onClick",yt(n,e,{isDouble:e.isDouble,inputTarget:i,isTarget:t===i,moveableTarget:n.props.target,containsTarget:c}))}},dragGroupEnd:function(n,e){var t=e.inputEvent,r=e.inputTarget;if(!(!t||!r||e.isDrag||n.isMoveableElement(r)||e.datas.inputTarget===r)){var i=n.props.targets,a=i.indexOf(r),o=a>-1,c=!1;a===-1&&(a=Fs(i,function(u){return u.contains(r)}),c=a>-1),Ve(n,"onClickGroup",yt(n,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:c,moveableTarget:i[a]}))}},dragControlEnd:function(n,e){this.dragEnd(n,e)},dragGroupControlEnd:function(n,e){this.dragEnd(n,e)}});function Mu(n){var e=n.originalDatas.draggable;return e||(n.originalDatas.draggable={},e=n.originalDatas.draggable),W(W({},n),{datas:e})}var fee=Xp("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(n,e){var t=n.props,r=t.edgeDraggable;return r?pV(e,"edgeDraggable",r,n.getState().renderPoses,t.zoom):[]},dragCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&tr(i,He("direction"))&&tr(i,He("edge"))&&tr(i,He("edgeDraggable"))},dragStart:function(n,e){return Vr.dragStart(n,Mu(e))},drag:function(n,e){return Vr.drag(n,Mu(e))},dragEnd:function(n,e){return Vr.dragEnd(n,Mu(e))},dragGroupCondition:function(n,e){var t,r=n.props,i=(t=e.inputEvent)===null||t===void 0?void 0:t.target;return!r.edgeDraggable||!i?!1:!r.draggable&&tr(i,He("direction"))&&tr(i,He("line"))},dragGroupStart:function(n,e){return Vr.dragGroupStart(n,Mu(e))},dragGroup:function(n,e){return Vr.dragGroup(n,Mu(e))},dragGroupEnd:function(n,e){return Vr.dragGroupEnd(n,Mu(e))},unset:function(n){return Vr.unset(n)}}),oj={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},PS=[nj,ZV,mJ,OJ,Vr,fee,F_,VJ,zJ,ZZ,GJ,qJ,UJ,nee,tee,see,MS,oj,dee,QV,rj],hee=PS.reduce(function(n,e){return(e.events||[]).forEach(function(t){_3(n,t)}),n},[]),pee=PS.reduce(function(n,e){return(e.props||[]).forEach(function(t){_3(n,t)}),n},[]);function Ok(n,e){var t=J(n,3),r=t[0],i=t[1],a=t[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Km(n,e){var t=J(n,2),r=t[0],i=t[1];return-r*e[0]-i*e[1]}function Vk(n,e){return Math.max.apply(Math,Ce([],J(n.map(function(t){var r=J(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.max(i[e],a[e],o[e],c[e])})),!1))}function jk(n,e){return Math.min.apply(Math,Ce([],J(n.map(function(t){var r=J(t,4),i=r[0],a=r[1],o=r[2],c=r[3];return Math.min(i[e],a[e],o[e],c[e])})),!1))}function gee(n,e){var t,r,i,a=[0,0],o=[0,0],c=[0,0],u=[0,0],d=0,h=0;if(!n.length)return{pos1:a,pos2:o,pos3:c,pos4:u,minX:0,minY:0,maxX:0,maxY:0,width:d,height:h,rotation:e};var p=dt(e,Fr);if(p%90){var m=p/180*Math.PI,b=Math.tan(m),_=-1/b,w=[z_,sk],S=[[0,0],[0,0]],T=[z_,sk],C=[[0,0],[0,0]];n.forEach(function(ne){ne.forEach(function(te){var ce=Ok([-b,1,0],te),fe=Ok([-_,1,0],te);w[0]>ce&&(S[0]=te,w[0]=ce),w[1]<ce&&(S[1]=te,w[1]=ce),T[0]>fe&&(C[0]=te,T[0]=fe),T[1]<fe&&(C[1]=te,T[1]=fe)})});var D=J(S,2),M=D[0],j=D[1],z=J(C,2),A=z[0],I=z[1],k=[-b,1,Km([-b,1],M)],V=[-b,1,Km([-b,1],j)],B=[-_,1,Km([-_,1],A)],L=[-_,1,Km([-_,1],I)];t=J([[k,B],[k,L],[V,B],[V,L]].map(function(ne){var te=J(ne,2),ce=te[0],fe=te[1];return dS(ce,fe)[0]}),4),a=t[0],o=t[1],c=t[2],u=t[3],d=T[1]-T[0],h=w[1]-w[0]}else{var P=jk(n,0),Z=jk(n,1),K=Vk(n,0),H=Vk(n,1);if(a=[P,Z],o=[K,Z],c=[P,H],u=[K,H],d=K-P,h=H-Z,p%180){var $=[c,a,u,o];r=J($,4),a=r[0],o=r[1],c=r[2],u=r[3],d=H-Z,h=K-P}}if(p%360>180){var $=[u,c,o,a];i=J($,4),a=i[0],o=i[1],c=i[2],u=i[3]}var Q=Mc([a,o,c,u]),re=Q.minX,ue=Q.minY,G=Q.maxX,Y=Q.maxY;return{pos1:a,pos2:o,pos3:c,pos4:u,width:d,height:h,minX:re,minY:ue,maxX:G,maxY:Y,rotation:e}}function lj(n,e){var t=e.map(function(r){if(Qn(r)){var i=lj(n,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=ti(n,function(c){var u=c.manager;return u.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&Qn(t[0])?t[0]:t}var mee=(function(n){Kp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.differ=new K3,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Ad(!0),this.moveables.forEach(function(Ae){Ae.updateRect(t,!1,!1)});var c=this.props,u=this.moveables,d=o.target||c.target,h=u.map(function(Ae){return{finded:!1,manager:Ae}}),p=this.props.targetGroups||[],m=lj(h,p),b=c.useDefaultGroupRotate;m.push.apply(m,Ce([],J(h.filter(function(Ae){var Pe=Ae.finded;return!Pe}).map(function(Ae){var Pe=Ae.manager;return Pe})),!1));var _=[],w=!r||t!==""&&c.updateGroup,S=c.defaultGroupRotate||0;if(!this._hasFirstTargets){var T=(a=c.persistData)===null||a===void 0?void 0:a.rotation;T!=null&&(S=T)}function C(Ae,Pe,Se){var we=Ae.map(function(rt){if(Qn(rt)){var De=C(rt,Pe),je=[De.pos1,De.pos2,De.pos3,De.pos4];return _.push(De),{poses:je,rotation:De.rotation}}else return{poses:Hi(rt.state),rotation:rt.getRotation()}}),ke=we.map(function(rt){var De=rt.rotation;return De}),nt=0,Ue=ke[0],Ee=ke.every(function(rt){return Math.abs(Ue-rt)<.1});w?nt=!b&&Ee?Ue:S:nt=!b&&!Se&&Ee?Ue:Pe;var Ne=we.map(function(rt){var De=rt.poses;return De}),Je=gee(Ne,nt);return Je}var D=C(m,this.rotation,!0);w&&(this.rotation=D.rotation,this.transformOrigin=c.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=p,this.renderGroupRects=_;var M=this.transformOrigin,j=this.rotation,z=this.scale,A=D.width,I=D.height,k=D.minX,V=D.minY,B=PJ([[0,0],[A,0],[0,I],[A,I]],RS(M,A,I),this.rotation/180*Math.PI),L=Mc(B.result),P=L.minX,Z=L.minY,K=" rotate(".concat(j,"deg)")+" scale(".concat(jr(z[0]),", ").concat(jr(z[1]),")"),H="translate(".concat(-P,"px, ").concat(-Z,"px)").concat(K);this.controlBox.style.transform="translate3d(".concat(k,"px, ").concat(V,"px, ").concat(this.props.translateZ||0,")"),d.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(M,";")+"width:".concat(A,"px;height:").concat(I,"px;")+"transform: ".concat(H),o.width=A,o.height=I;var $=this.getContainer(),Q=X_(this.controlBox,d,this.controlBox,this.getContainer(),this._rootContainer||$,[]),re=[Q.left,Q.top],ue=J(Hi(Q),4),G=ue[0],Y=ue[1],ne=ue[2],te=ue[3],ce=Mc([G,Y,ne,te]),fe=[ce.minX,ce.minY],ye=jr(z[0]*z[1]);Q.pos1=Ke(G,fe),Q.pos2=Ke(Y,fe),Q.pos3=Ke(ne,fe),Q.pos4=Ke(te,fe),Q.left=k-Q.left+fe[0],Q.top=V-Q.top+fe[1],Q.origin=Ke(Ot(re,Q.origin),fe),Q.beforeOrigin=Ke(Ot(re,Q.beforeOrigin),fe),Q.originalBeforeOrigin=Ot(re,Q.originalBeforeOrigin),Q.transformOrigin=Ke(Ot(re,Q.transformOrigin),fe),d.style.transform="translate(".concat(-P-fe[0],"px, ").concat(-Z-fe[1],"px)")+K,Ad(),this.updateState(W(W({},Q),{posDelta:fe,direction:ye,beforeDirection:ye}),i)},e.prototype.getRect=function(){return W(W({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.triggerEvent=function(t,r,i){if(i||t.indexOf("Group")>-1)return n.prototype.triggerEvent.call(this,t,r);this._emitter.trigger(t,r)},e.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(r,i){var a,o,c=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return Ce(Ce([],J(r),!1),J(c),!1)},[]);return t},e.prototype.getMoveables=function(){return Ce([],J(this.moveables),!1)},e.prototype.updateAbles=function(){n.prototype.updateAbles.call(this,Ce(Ce([],J(this.props.ables),!1),[MS],!1),"Group")},e.prototype._updateTargets=function(){n.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=Ja(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var t=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,c=this.differ.update(o),u=c.added,d=c.changed,h=c.removed,p=u.length||h.length;(p||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Xu(this,!1),Xu(this,!0),this.updateState({gestos:{}})),i!==a&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=ij(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=aj(this,"GroupControl")));var m=!Y_(t.container,r.container);m&&(t.container=r.container),(m||p||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||d.length||o.length&&!KV(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!p},e.prototype._updateObserver=function(){},e.defaultProps=W(W({},Rd.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(Rd),vee=(function(n){Kp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.moveables=[],t}return e.prototype.render=function(){var t=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,c=i.persistData,u=i.targets||[],d=u.length,h=this.isUnmounted||!d,p=(r=c?.children)!==null&&r!==void 0?r:[];return h&&!d&&p.length?u=p.map(function(){return null}):h||(p=[]),ua(o,{cspNonce:a,ref:ks(this,"controlBox"),className:He("control-box")},u.map(function(m,b){var _,w,S=(w=(_=i.individualGroupableProps)===null||_===void 0?void 0:_.call(i,m,b))!==null&&w!==void 0?w:{};return ua(Rd,W({key:"moveable"+b,ref:p3(t,"moveables",b)},i,S,{target:m,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:p[b]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){i===void 0&&(i=!0),Ad(!0),this.moveables.forEach(function(a){a.updateRect(t,r,i)}),Ad()},e.prototype.getRect=function(){return W(W({},n.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},e.prototype.request=function(t,r,i){r===void 0&&(r={});var a=this.moveables.map(function(u){return u.request(t,W(W({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,c={request:function(u){return a.forEach(function(d){return d.request(u)}),this},requestEnd:function(){return a.forEach(function(u){return u.requestEnd()}),this}};return o?c.request(r).requestEnd():c},e.prototype.dragStart=function(t,r){r===void 0&&(r=t.target);var i=r,a=ti(this.moveables,function(o){var c=o.getTargets()[0],u=o.getControlBoxElement(),d=o.getDragElement();return!c||!d?!1:d===i||d.contains(i)||d!==c&&c===i||c.contains(i)||u===i||u.contains(i)});return a&&a.dragStart(t,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return Ce([],J(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(Rd);function cj(n,e){var t=[];return n.forEach(function(r){if(r){if(ei(r)){e[r]&&t.push.apply(t,Ce([],J(e[r]),!1));return}Qn(r)?t.push.apply(t,Ce([],J(cj(r,e)),!1)):t.push(r)}}),t}function uj(n,e){var t=[];return n.forEach(function(r){if(r){if(ei(r)){e[r]&&t.push.apply(t,Ce([],J(e[r]),!1));return}Qn(r)?t.push(uj(r,e)):t.push(r)}}),t}function dj(n,e){return n.length!==e.length||n.some(function(t,r){var i=e[r];return!t&&!i?!1:t!=i?Qn(t)&&Qn(i)?dj(t,i):!0:!1})}var yee=(function(n){Kp(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new K3,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return e.makeStyled=function(){var t={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(c){t[c]=!0})});var i=Gs(t).join(`
`);this.defaultStyled=Z3("div",hW(hS,nZ+i))},e.getTotalAbles=function(){return Ce([ZV,MS,oj,QV],J(this.defaultAbles),!1)},e.prototype.render=function(){var t,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,c=GQ(i,["ables","props"]),u=J(this._updateRefs(!0),2),d=u[0],h=u[1],p=cj(d,h),m=p.length>1,b=r.getTotalAbles(),_=Ce(Ce([],J(b),!1),J(a||[]),!1),w=W(W(W({},c),o||{}),{ables:_,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=p;var S=null,T=this.moveable,C=c.persistData;if(C?.children&&(m=!0),c.individualGroupable)return ua(vee,W({key:"individual-group",ref:ks(this,"moveable")},w,{target:null,targets:p}));if(m){var D=uj(d,h);if(T&&!T.props.groupable&&!T.props.individualGroupable){var M=T.props.target;M&&p.indexOf(M)>-1&&(S=W({},T.state))}return ua(mee,W({key:"group",ref:ks(this,"moveable")},w,(t=c.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:p,targetGroups:D,firstRenderState:S}))}else{var j=p[0];if(T&&(T.props.groupable||T.props.individualGroupable)){var z=T.moveables||[],A=ti(z,function(I){return I.props.target===j});A&&(S=W({},A.state))}return ua(Rd,W({key:"single",ref:ks(this,"moveable")},w,{target:j,firstRenderState:S}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var t,r;return(r=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var t=this,r;return this._onChangeTargets=function(){t._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(t){var r=this.refTargets,i=IS(this.props.target||this.props.targets),a=typeof document<"u",o=dj(r,i),c=this.selectorMap,u={};return this.refTargets.forEach(function d(h){if(ei(h)){var p=c[h];p?u[h]=c[h]:a&&(o=!0,u[h]=[].slice.call(document.querySelectorAll(h)))}else Qn(h)&&h.forEach(d)}),this._tmpRefTargets=i,this._tmpSelectorMap=u,[i,u,!t&&o]},e.prototype._checkChangeTargets=function(){var t,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,c=a.removed,u=o.length||c.length;u&&((r=(t=this.props).onChangeTargets)===null||r===void 0||r.call(t,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var d=J(this._updateRefs(),3),h=d[0],p=d[1],m=d[2];this.refTargets=h,this.selectorMap=p,m&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,qQ([pW(iV)],e.prototype,"moveable",void 0),e})(D3),bee=(function(n){Kp(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.defaultAbles=PS,e})(yee),W_=function(n,e){return W_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},W_(n,e)};function OS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");W_(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var dp=function(){return dp=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},dp.apply(this,arguments)};function xee(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}var _ee=(function(n){OS(e,n);function e(r){var i=n.call(this,r)||this;return i.state={},i.state=i.props,i}var t=e.prototype;return t.render=function(){return ua(bee,dp({ref:ks(this,"moveable")},this.state))},e})(aS),wee=pee,Eee=iV,See=hee,Tee=(function(n){OS(e,n);function e(r,i){i===void 0&&(i={});var a=n.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=dp({},i),c={};See.forEach(function(h){c[SW("on ".concat(h))]=function(p){return a.trigger(h,p)}});var u;i.warpSelf?(delete i.warpSelf,a._warp=!0,u=r):(u=Gd(r).createElement("div"),r.appendChild(u)),a.containerProvider=ek(ua(_ee,dp({ref:ks(a,"innerMoveable")},o,c)),u),a.selfElement=u;var d=o.target;return Qn(d)&&d.length>1&&a.updateRect(),a}var t=e.prototype;return t.setState=function(r,i){this.innerMoveable.setState(r,i)},t.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},t.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},t.destroy=function(){var r,i=this.selfElement;ek(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},t.getMoveable=function(){return this.innerMoveable.moveable},e=xee([HD(Eee,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var c=this.getMoveable();if(!(!c||!c[i]))return c[i].apply(c,a)})}),HD(wee,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e})(ny),zk=(function(n){OS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e})(Tee);var Qu=9e15,bl=1e9,Q_="0123456789abcdef",pv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",gv="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Z_={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Qu,maxE:Qu,crypto:!1},fj,Is,ot=!0,fy="[DecimalError] ",hl=fy+"Invalid argument: ",hj=fy+"Precision limit exceeded",pj=fy+"crypto unavailable",gj="[object Decimal]",kr=Math.floor,er=Math.pow,Aee=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Cee=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Iee=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,mj=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fa=1e7,Ze=7,Ree=9007199254740991,Dee=pv.length-1,J_=gv.length-1,_e={toStringTag:gj};_e.absoluteValue=_e.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),$e(n)};_e.ceil=function(){return $e(new this.constructor(this),this.e+1,2)};_e.clampedTo=_e.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(hl+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};_e.comparedTo=_e.cmp=function(n){var e,t,r,i,a=this,o=a.d,c=(n=new a.constructor(n)).d,u=a.s,d=n.s;if(!o||!c)return!u||!d?NaN:u!==d?u:o===c?0:!o^u<0?1:-1;if(!o[0]||!c[0])return o[0]?u:c[0]?-d:0;if(u!==d)return u;if(a.e!==n.e)return a.e>n.e^u<0?1:-1;for(r=o.length,i=c.length,e=0,t=r<i?r:i;e<t;++e)if(o[e]!==c[e])return o[e]>c[e]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};_e.cosine=_e.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Ze,r.rounding=1,t=kee(r,_j(r,t)),r.precision=n,r.rounding=e,$e(Is==2||Is==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};_e.cubeRoot=_e.cbrt=function(){var n,e,t,r,i,a,o,c,u,d,h=this,p=h.constructor;if(!h.isFinite()||h.isZero())return new p(h);for(ot=!1,a=h.s*er(h.s*h,1/3),!a||Math.abs(a)==1/0?(t=wr(h.d),n=h.e,(a=(n-t.length+1)%3)&&(t+=a==1||a==-2?"0":"00"),a=er(t,1/3),n=kr((n+1)/3)-(n%3==(n<0?-1:2)),a==1/0?t="5e"+n:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new p(t),r.s=h.s):r=new p(a.toString()),o=(n=p.precision)+3;;)if(c=r,u=c.times(c).times(c),d=u.plus(h),r=sn(d.plus(h).times(c),d.plus(u),o+2,1),wr(c.d).slice(0,o)===(t=wr(r.d)).slice(0,o))if(t=t.slice(o-3,o+1),t=="9999"||!i&&t=="4999"){if(!i&&($e(c,n+1,0),c.times(c).times(c).eq(h))){r=c;break}o+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&($e(r,n+1,1),e=!r.times(r).times(r).eq(h));break}return ot=!0,$e(r,n,p.rounding,e)};_e.decimalPlaces=_e.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-kr(this.e/Ze))*Ze,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};_e.dividedBy=_e.div=function(n){return sn(this,new this.constructor(n))};_e.dividedToIntegerBy=_e.divToInt=function(n){var e=this,t=e.constructor;return $e(sn(e,new t(n),0,1,1),t.precision,t.rounding)};_e.equals=_e.eq=function(n){return this.cmp(n)===0};_e.floor=function(){return $e(new this.constructor(this),this.e+1,3)};_e.greaterThan=_e.gt=function(n){return this.cmp(n)>0};_e.greaterThanOrEqualTo=_e.gte=function(n){var e=this.cmp(n);return e==1||e===0};_e.hyperbolicCosine=_e.cosh=function(){var n,e,t,r,i,a=this,o=a.constructor,c=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return c;t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(n=Math.ceil(i/3),e=(1/py(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),a=Dd(o,1,a.times(e),new o(1),!0);for(var u,d=n,h=new o(8);d--;)u=a.times(a),a=c.minus(u.times(h.minus(u.times(h))));return $e(a,o.precision=t,o.rounding=r,!0)};_e.hyperbolicSine=_e.sinh=function(){var n,e,t,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(e=a.precision,t=a.rounding,a.precision=e+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<3)i=Dd(a,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/py(5,n)),i=Dd(a,2,i,i,!0);for(var o,c=new a(5),u=new a(16),d=new a(20);n--;)o=i.times(i),i=i.times(c.plus(o.times(u.times(o).plus(d))))}return a.precision=e,a.rounding=t,$e(i,e,t,!0)};_e.hyperbolicTangent=_e.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,sn(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};_e.inverseCosine=_e.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?Ha(e,r,i):new e(0):new e(NaN):n.isZero()?Ha(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};_e.inverseHyperbolicCosine=_e.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,ot=!1,t=t.times(t).minus(1).sqrt().plus(t),ot=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};_e.inverseHyperbolicSine=_e.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,ot=!1,t=t.times(t).plus(1).sqrt().plus(t),ot=!0,r.precision=n,r.rounding=e,t.ln())};_e.inverseHyperbolicTangent=_e.atanh=function(){var n,e,t,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=a.precision,e=a.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?$e(new a(i),n,e,!0):(a.precision=t=r-i.e,i=sn(i.plus(1),new a(1).minus(i),t+n,1),a.precision=n+4,a.rounding=1,i=i.ln(),a.precision=n,a.rounding=e,i.times(.5))):new a(NaN)};_e.inverseSine=_e.asin=function(){var n,e,t,r,i=this,a=i.constructor;return i.isZero()?new a(i):(e=i.abs().cmp(1),t=a.precision,r=a.rounding,e!==-1?e===0?(n=Ha(a,t+4,r).times(.5),n.s=i.s,n):new a(NaN):(a.precision=t+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=t,a.rounding=r,i.times(2)))};_e.inverseTangent=_e.atan=function(){var n,e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding;if(d.isFinite()){if(d.isZero())return new h(d);if(d.abs().eq(1)&&p+4<=J_)return o=Ha(h,p+4,m).times(.25),o.s=d.s,o}else{if(!d.s)return new h(NaN);if(p+4<=J_)return o=Ha(h,p+4,m).times(.5),o.s=d.s,o}for(h.precision=c=p+10,h.rounding=1,t=Math.min(28,c/Ze+2|0),n=t;n;--n)d=d.div(d.times(d).plus(1).sqrt().plus(1));for(ot=!1,e=Math.ceil(c/Ze),r=1,u=d.times(d),o=new h(d),i=d;n!==-1;)if(i=i.times(u),a=o.minus(i.div(r+=2)),i=i.times(u),o=a.plus(i.div(r+=2)),o.d[e]!==void 0)for(n=e;o.d[n]===a.d[n]&&n--;);return t&&(o=o.times(2<<t-1)),ot=!0,$e(o,h.precision=p,h.rounding=m,!0)};_e.isFinite=function(){return!!this.d};_e.isInteger=_e.isInt=function(){return!!this.d&&kr(this.e/Ze)>this.d.length-2};_e.isNaN=function(){return!this.s};_e.isNegative=_e.isNeg=function(){return this.s<0};_e.isPositive=_e.isPos=function(){return this.s>0};_e.isZero=function(){return!!this.d&&this.d[0]===0};_e.lessThan=_e.lt=function(n){return this.cmp(n)<0};_e.lessThanOrEqualTo=_e.lte=function(n){return this.cmp(n)<1};_e.logarithm=_e.log=function(n){var e,t,r,i,a,o,c,u,d=this,h=d.constructor,p=h.precision,m=h.rounding,b=5;if(n==null)n=new h(10),e=!0;else{if(n=new h(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new h(NaN);e=n.eq(10)}if(t=d.d,d.s<0||!t||!t[0]||d.eq(1))return new h(t&&!t[0]?-1/0:d.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)a=!0;else{for(i=t[0];i%10===0;)i/=10;a=i!==1}if(ot=!1,c=p+b,o=Xo(d,c),r=e?mv(h,c+10):Xo(n,c),u=sn(o,r,c,1),fp(u.d,i=p,m))do if(c+=10,o=Xo(d,c),r=e?mv(h,c+10):Xo(n,c),u=sn(o,r,c,1),!a){+wr(u.d).slice(i+1,i+15)+1==1e14&&(u=$e(u,p+1,0));break}while(fp(u.d,i+=10,m));return ot=!0,$e(u,p,m)};_e.minus=_e.sub=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.constructor;if(n=new _(n),!b.d||!n.d)return!b.s||!n.s?n=new _(NaN):b.d?n.s=-n.s:n=new _(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(d=b.d,m=n.d,c=_.precision,u=_.rounding,!d[0]||!m[0]){if(m[0])n.s=-n.s;else if(d[0])n=new _(b);else return new _(u===3?-0:0);return ot?$e(n,c,u):n}if(t=kr(n.e/Ze),h=kr(b.e/Ze),d=d.slice(),a=h-t,a){for(p=a<0,p?(e=d,a=-a,o=m.length):(e=m,t=h,o=d.length),r=Math.max(Math.ceil(c/Ze),o)+2,a>r&&(a=r,e.length=1),e.reverse(),r=a;r--;)e.push(0);e.reverse()}else{for(r=d.length,o=m.length,p=r<o,p&&(o=r),r=0;r<o;r++)if(d[r]!=m[r]){p=d[r]<m[r];break}a=0}for(p&&(e=d,d=m,m=e,n.s=-n.s),o=d.length,r=m.length-o;r>0;--r)d[o++]=0;for(r=m.length;r>a;){if(d[--r]<m[r]){for(i=r;i&&d[--i]===0;)d[i]=fa-1;--d[i],d[r]+=fa}d[r]-=m[r]}for(;d[--o]===0;)d.pop();for(;d[0]===0;d.shift())--t;return d[0]?(n.d=d,n.e=hy(d,t),ot?$e(n,c,u):n):new _(u===3?-0:0)};_e.modulo=_e.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?$e(new r(t),r.precision,r.rounding):(ot=!1,r.modulo==9?(e=sn(t,n.abs(),0,3,1),e.s*=n.s):e=sn(t,n,0,r.modulo,1),e=e.times(n),ot=!0,t.minus(e))};_e.naturalExponential=_e.exp=function(){return ew(this)};_e.naturalLogarithm=_e.ln=function(){return Xo(this)};_e.negated=_e.neg=function(){var n=new this.constructor(this);return n.s=-n.s,$e(n)};_e.plus=_e.add=function(n){var e,t,r,i,a,o,c,u,d,h,p=this,m=p.constructor;if(n=new m(n),!p.d||!n.d)return!p.s||!n.s?n=new m(NaN):p.d||(n=new m(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(d=p.d,h=n.d,c=m.precision,u=m.rounding,!d[0]||!h[0])return h[0]||(n=new m(p)),ot?$e(n,c,u):n;if(a=kr(p.e/Ze),r=kr(n.e/Ze),d=d.slice(),i=a-r,i){for(i<0?(t=d,i=-i,o=h.length):(t=h,r=a,o=d.length),a=Math.ceil(c/Ze),o=a>o?a+1:o+1,i>o&&(i=o,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(o=d.length,i=h.length,o-i<0&&(i=o,t=h,h=d,d=t),e=0;i;)e=(d[--i]=d[i]+h[i]+e)/fa|0,d[i]%=fa;for(e&&(d.unshift(e),++r),o=d.length;d[--o]==0;)d.pop();return n.d=d,n.e=hy(d,r),ot?$e(n,c,u):n};_e.precision=_e.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(hl+n);return t.d?(e=vj(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};_e.round=function(){var n=this,e=n.constructor;return $e(new e(n),n.e+1,e.rounding)};_e.sine=_e.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Ze,r.rounding=1,t=Mee(r,_j(r,t)),r.precision=n,r.rounding=e,$e(Is>2?t.neg():t,n,e,!0)):new r(NaN)};_e.squareRoot=_e.sqrt=function(){var n,e,t,r,i,a,o=this,c=o.d,u=o.e,d=o.s,h=o.constructor;if(d!==1||!c||!c[0])return new h(!d||d<0&&(!c||c[0])?NaN:c?o:1/0);for(ot=!1,d=Math.sqrt(+o),d==0||d==1/0?(e=wr(c),(e.length+u)%2==0&&(e+="0"),d=Math.sqrt(e),u=kr((u+1)/2)-(u<0||u%2),d==1/0?e="5e"+u:(e=d.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),r=new h(e)):r=new h(d.toString()),t=(u=h.precision)+3;;)if(a=r,r=a.plus(sn(o,a,t+2,1)).times(.5),wr(a.d).slice(0,t)===(e=wr(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&($e(a,u+1,0),a.times(a).eq(o))){r=a;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&($e(r,u+1,1),n=!r.times(r).eq(o));break}return ot=!0,$e(r,u,h.rounding,n)};_e.tangent=_e.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=sn(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,$e(Is==2||Is==4?t.neg():t,n,e,!0)):new r(NaN)};_e.times=_e.mul=function(n){var e,t,r,i,a,o,c,u,d,h=this,p=h.constructor,m=h.d,b=(n=new p(n)).d;if(n.s*=h.s,!m||!m[0]||!b||!b[0])return new p(!n.s||m&&!m[0]&&!b||b&&!b[0]&&!m?NaN:!m||!b?n.s/0:n.s*0);for(t=kr(h.e/Ze)+kr(n.e/Ze),u=m.length,d=b.length,u<d&&(a=m,m=b,b=a,o=u,u=d,d=o),a=[],o=u+d,r=o;r--;)a.push(0);for(r=d;--r>=0;){for(e=0,i=u+r;i>r;)c=a[i]+b[r]*m[i-r-1]+e,a[i--]=c%fa|0,e=c/fa|0;a[i]=(a[i]+e)%fa|0}for(;!a[--o];)a.pop();return e?++t:a.shift(),n.d=a,n.e=hy(a,t),ot?$e(n,p.precision,p.rounding):n};_e.toBinary=function(n,e){return VS(this,2,n,e)};_e.toDecimalPlaces=_e.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(ri(n,0,bl),e===void 0?e=r.rounding:ri(e,0,8),$e(t,n+t.e+1,e))};_e.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=ns(r,!0):(ri(n,0,bl),e===void 0?e=i.rounding:ri(e,0,8),r=$e(new i(r),n+1,e),t=ns(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};_e.toFixed=function(n,e){var t,r,i=this,a=i.constructor;return n===void 0?t=ns(i):(ri(n,0,bl),e===void 0?e=a.rounding:ri(e,0,8),r=$e(new a(i),n+i.e+1,e),t=ns(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};_e.toFraction=function(n){var e,t,r,i,a,o,c,u,d,h,p,m,b=this,_=b.d,w=b.constructor;if(!_)return new w(b);if(d=t=new w(1),r=u=new w(0),e=new w(r),a=e.e=vj(_)-b.e-1,o=a%Ze,e.d[0]=er(10,o<0?Ze+o:o),n==null)n=a>0?e:d;else{if(c=new w(n),!c.isInt()||c.lt(d))throw Error(hl+c);n=c.gt(e)?a>0?e:d:c}for(ot=!1,c=new w(wr(_)),h=w.precision,w.precision=a=_.length*Ze*2;p=sn(c,e,0,1,1),i=t.plus(p.times(r)),i.cmp(n)!=1;)t=r,r=i,i=d,d=u.plus(p.times(i)),u=i,i=e,e=c.minus(p.times(i)),c=i;return i=sn(n.minus(t),r,0,1,1),u=u.plus(i.times(d)),t=t.plus(i.times(r)),u.s=d.s=b.s,m=sn(d,r,a,1).minus(b).abs().cmp(sn(u,t,a,1).minus(b).abs())<1?[d,r]:[u,t],w.precision=h,ot=!0,m};_e.toHexadecimal=_e.toHex=function(n,e){return VS(this,16,n,e)};_e.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:ri(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(ot=!1,t=sn(t,n,0,e,1).times(n),ot=!0,$e(t)):(n.s=t.s,t=n),t};_e.toNumber=function(){return+this};_e.toOctal=function(n,e){return VS(this,8,n,e)};_e.toPower=_e.pow=function(n){var e,t,r,i,a,o,c=this,u=c.constructor,d=+(n=new u(n));if(!c.d||!n.d||!c.d[0]||!n.d[0])return new u(er(+c,d));if(c=new u(c),c.eq(1))return c;if(r=u.precision,a=u.rounding,n.eq(1))return $e(c,r,a);if(e=kr(n.e/Ze),e>=n.d.length-1&&(t=d<0?-d:d)<=Ree)return i=yj(u,c,t,r),n.s<0?new u(1).div(i):$e(i,r,a);if(o=c.s,o<0){if(e<n.d.length-1)return new u(NaN);if((n.d[e]&1)==0&&(o=1),c.e==0&&c.d[0]==1&&c.d.length==1)return c.s=o,c}return t=er(+c,d),e=t==0||!isFinite(t)?kr(d*(Math.log("0."+wr(c.d))/Math.LN10+c.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?o/0:0):(ot=!1,u.rounding=c.s=1,t=Math.min(12,(e+"").length),i=ew(n.times(Xo(c,r+t)),r),i.d&&(i=$e(i,r+5,1),fp(i.d,r,a)&&(e=r+10,i=$e(ew(n.times(Xo(c,e+t)),e),e+5,1),+wr(i.d).slice(r+1,r+15)+1==1e14&&(i=$e(i,r+1,0)))),i.s=o,ot=!0,u.rounding=a,$e(i,r,a))};_e.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=ns(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(ri(n,1,bl),e===void 0?e=i.rounding:ri(e,0,8),r=$e(new i(r),n,e),t=ns(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};_e.toSignificantDigits=_e.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(ri(n,1,bl),e===void 0?e=r.rounding:ri(e,0,8)),$e(new r(t),n,e)};_e.toString=function(){var n=this,e=n.constructor,t=ns(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};_e.truncated=_e.trunc=function(){return $e(new this.constructor(this),this.e+1,1)};_e.valueOf=_e.toJSON=function(){var n=this,e=n.constructor,t=ns(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function wr(n){var e,t,r,i=n.length-1,a="",o=n[0];if(i>0){for(a+=o,e=1;e<i;e++)r=n[e]+"",t=Ze-r.length,t&&(a+=Bo(t)),a+=r;o=n[e],r=o+"",t=Ze-r.length,t&&(a+=Bo(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function ri(n,e,t){if(n!==~~n||n<e||n>t)throw Error(hl+n)}function fp(n,e,t,r){var i,a,o,c;for(a=n[0];a>=10;a/=10)--e;return--e<0?(e+=Ze,i=0):(i=Math.ceil((e+1)/Ze),e%=Ze),a=er(10,Ze-e),c=n[i]%a|0,r==null?e<3?(e==0?c=c/100|0:e==1&&(c=c/10|0),o=t<4&&c==99999||t>3&&c==49999||c==5e4||c==0):o=(t<4&&c+1==a||t>3&&c+1==a/2)&&(n[i+1]/a/100|0)==er(10,e-2)-1||(c==a/2||c==0)&&(n[i+1]/a/100|0)==0:e<4?(e==0?c=c/1e3|0:e==1?c=c/100|0:e==2&&(c=c/10|0),o=(r||t<4)&&c==9999||!r&&t>3&&c==4999):o=((r||t<4)&&c+1==a||!r&&t>3&&c+1==a/2)&&(n[i+1]/a/1e3|0)==er(10,e-3)-1,o}function b0(n,e,t){for(var r,i=[0],a,o=0,c=n.length;o<c;){for(a=i.length;a--;)i[a]*=e;for(i[0]+=Q_.indexOf(n.charAt(o++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function kee(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/py(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=Dd(n,1,e.times(i),new n(1));for(var a=t;a--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=t,e}var sn=(function(){function n(r,i,a){var o,c=0,u=r.length;for(r=r.slice();u--;)o=r[u]*i+c,r[u]=o%a|0,c=o/a|0;return c&&r.unshift(c),r}function e(r,i,a,o){var c,u;if(a!=o)u=a>o?1:-1;else for(c=u=0;c<a;c++)if(r[c]!=i[c]){u=r[c]>i[c]?1:-1;break}return u}function t(r,i,a,o){for(var c=0;a--;)r[a]-=c,c=r[a]<i[a]?1:0,r[a]=c*o+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o,c,u){var d,h,p,m,b,_,w,S,T,C,D,M,j,z,A,I,k,V,B,L,P=r.constructor,Z=r.s==i.s?1:-1,K=r.d,H=i.d;if(!K||!K[0]||!H||!H[0])return new P(!r.s||!i.s||(K?H&&K[0]==H[0]:!H)?NaN:K&&K[0]==0||!H?Z*0:Z/0);for(u?(b=1,h=r.e-i.e):(u=fa,b=Ze,h=kr(r.e/b)-kr(i.e/b)),B=H.length,k=K.length,T=new P(Z),C=T.d=[],p=0;H[p]==(K[p]||0);p++);if(H[p]>(K[p]||0)&&h--,a==null?(z=a=P.precision,o=P.rounding):c?z=a+(r.e-i.e)+1:z=a,z<0)C.push(1),_=!0;else{if(z=z/b+2|0,p=0,B==1){for(m=0,H=H[0],z++;(p<k||m)&&z--;p++)A=m*u+(K[p]||0),C[p]=A/H|0,m=A%H|0;_=m||p<k}else{for(m=u/(H[0]+1)|0,m>1&&(H=n(H,m,u),K=n(K,m,u),B=H.length,k=K.length),I=B,D=K.slice(0,B),M=D.length;M<B;)D[M++]=0;L=H.slice(),L.unshift(0),V=H[0],H[1]>=u/2&&++V;do m=0,d=e(H,D,B,M),d<0?(j=D[0],B!=M&&(j=j*u+(D[1]||0)),m=j/V|0,m>1?(m>=u&&(m=u-1),w=n(H,m,u),S=w.length,M=D.length,d=e(w,D,S,M),d==1&&(m--,t(w,B<S?L:H,S,u))):(m==0&&(d=m=1),w=H.slice()),S=w.length,S<M&&w.unshift(0),t(D,w,M,u),d==-1&&(M=D.length,d=e(H,D,B,M),d<1&&(m++,t(D,B<M?L:H,M,u))),M=D.length):d===0&&(m++,D=[0]),C[p++]=m,d&&D[0]?D[M++]=K[I]||0:(D=[K[I]],M=1);while((I++<k||D[0]!==void 0)&&z--);_=D[0]!==void 0}C[0]||C.shift()}if(b==1)T.e=h,fj=_;else{for(p=1,m=C[0];m>=10;m/=10)p++;T.e=p+h*b-1,$e(T,c?a+T.e+1:a,o,_)}return T}})();function $e(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor;e:if(e!=null){if(p=n.d,!p)return n;for(i=1,c=p[0];c>=10;c/=10)i++;if(a=e-i,a<0)a+=Ze,o=e,h=p[m=0],u=h/er(10,i-o-1)%10|0;else if(m=Math.ceil((a+1)/Ze),c=p.length,m>=c)if(r){for(;c++<=m;)p.push(0);h=u=0,i=1,a%=Ze,o=a-Ze+1}else break e;else{for(h=c=p[m],i=1;c>=10;c/=10)i++;a%=Ze,o=a-Ze+i,u=o<0?0:h/er(10,i-o-1)%10|0}if(r=r||e<0||p[m+1]!==void 0||(o<0?h:h%er(10,i-o-1)),d=t<4?(u||r)&&(t==0||t==(n.s<0?3:2)):u>5||u==5&&(t==4||r||t==6&&(a>0?o>0?h/er(10,i-o):0:p[m-1])%10&1||t==(n.s<0?8:7)),e<1||!p[0])return p.length=0,d?(e-=n.e+1,p[0]=er(10,(Ze-e%Ze)%Ze),n.e=-e||0):p[0]=n.e=0,n;if(a==0?(p.length=m,c=1,m--):(p.length=m+1,c=er(10,Ze-a),p[m]=o>0?(h/er(10,i-o)%er(10,o)|0)*c:0),d)for(;;)if(m==0){for(a=1,o=p[0];o>=10;o/=10)a++;for(o=p[0]+=c,c=1;o>=10;o/=10)c++;a!=c&&(n.e++,p[0]==fa&&(p[0]=1));break}else{if(p[m]+=c,p[m]!=fa)break;p[m--]=0,c=1}for(a=p.length;p[--a]===0;)p.pop()}return ot&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function ns(n,e,t){if(!n.isFinite())return xj(n);var r,i=n.e,a=wr(n.d),o=a.length;return e?(t&&(r=t-o)>0?a=a.charAt(0)+"."+a.slice(1)+Bo(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(n.e<0?"e":"e+")+n.e):i<0?(a="0."+Bo(-i-1)+a,t&&(r=t-o)>0&&(a+=Bo(r))):i>=o?(a+=Bo(i+1-o),t&&(r=t-i-1)>0&&(a=a+"."+Bo(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),t&&(r=t-o)>0&&(i+1===o&&(a+="."),a+=Bo(r))),a}function hy(n,e){var t=n[0];for(e*=Ze;t>=10;t/=10)e++;return e}function mv(n,e,t){if(e>Dee)throw ot=!0,t&&(n.precision=t),Error(hj);return $e(new n(pv),e,1,!0)}function Ha(n,e,t){if(e>J_)throw Error(hj);return $e(new n(gv),e,t,!0)}function vj(n){var e=n.length-1,t=e*Ze+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Bo(n){for(var e="";n--;)e+="0";return e}function yj(n,e,t,r){var i,a=new n(1),o=Math.ceil(r/Ze+4);for(ot=!1;;){if(t%2&&(a=a.times(e),Bk(a.d,o)&&(i=!0)),t=kr(t/2),t===0){t=a.d.length-1,i&&a.d[t]===0&&++a.d[t];break}e=e.times(e),Bk(e.d,o)}return ot=!0,a}function Lk(n){return n.d[n.d.length-1]&1}function bj(n,e,t){for(var r,i,a=new n(e[0]),o=0;++o<e.length;){if(i=new n(e[o]),!i.s){a=i;break}r=a.cmp(i),(r===t||r===0&&a.s===t)&&(a=i)}return a}function ew(n,e){var t,r,i,a,o,c,u,d=0,h=0,p=0,m=n.constructor,b=m.rounding,_=m.precision;if(!n.d||!n.d[0]||n.e>17)return new m(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(ot=!1,u=_):u=e,c=new m(.03125);n.e>-2;)n=n.times(c),p+=5;for(r=Math.log(er(2,p))/Math.LN10*2+5|0,u+=r,t=a=o=new m(1),m.precision=u;;){if(a=$e(a.times(n),u,1),t=t.times(++h),c=o.plus(sn(a,t,u,1)),wr(c.d).slice(0,u)===wr(o.d).slice(0,u)){for(i=p;i--;)o=$e(o.times(o),u,1);if(e==null)if(d<3&&fp(o.d,u-r,b,d))m.precision=u+=10,t=a=c=new m(1),h=0,d++;else return $e(o,m.precision=_,b,ot=!0);else return m.precision=_,o}o=c}}function Xo(n,e){var t,r,i,a,o,c,u,d,h,p,m,b=1,_=10,w=n,S=w.d,T=w.constructor,C=T.rounding,D=T.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new T(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(e==null?(ot=!1,h=D):h=e,T.precision=h+=_,t=wr(S),r=t.charAt(0),Math.abs(a=w.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)w=w.times(n),t=wr(w.d),r=t.charAt(0),b++;a=w.e,r>1?(w=new T("0."+t),a++):w=new T(r+"."+t.slice(1))}else return d=mv(T,h+2,D).times(a+""),w=Xo(new T(r+"."+t.slice(1)),h-_).plus(d),T.precision=D,e==null?$e(w,D,C,ot=!0):w;for(p=w,u=o=w=sn(w.minus(1),w.plus(1),h,1),m=$e(w.times(w),h,1),i=3;;){if(o=$e(o.times(m),h,1),d=u.plus(sn(o,new T(i),h,1)),wr(d.d).slice(0,h)===wr(u.d).slice(0,h))if(u=u.times(2),a!==0&&(u=u.plus(mv(T,h+2,D).times(a+""))),u=sn(u,new T(b),h,1),e==null)if(fp(u.d,h-_,C,c))T.precision=h+=_,d=o=w=sn(p.minus(1),p.plus(1),h,1),m=$e(w.times(w),h,1),i=c=1;else return $e(u,T.precision=D,C,ot=!0);else return T.precision=D,u;u=d,i+=2}}function xj(n){return String(n.s*n.s/0)}function x0(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Ze,t<0&&(r+=Ze),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Ze;r<i;)n.d.push(+e.slice(r,r+=Ze));e=e.slice(r),r=Ze-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),ot&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function Nee(n,e){var t,r,i,a,o,c,u,d,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),mj.test(e))return x0(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(Cee.test(e))t=16,e=e.toLowerCase();else if(Aee.test(e))t=2;else if(Iee.test(e))t=8;else throw Error(hl+e);for(a=e.search(/p/i),a>0?(u=+e.slice(a+1),e=e.substring(2,a)):e=e.slice(2),a=e.indexOf("."),o=a>=0,r=n.constructor,o&&(e=e.replace(".",""),c=e.length,a=c-a,i=yj(r,new r(t),a,a*2)),d=b0(e,t,fa),h=d.length-1,a=h;d[a]===0;--a)d.pop();return a<0?new r(n.s*0):(n.e=hy(d,h),n.d=d,ot=!1,o&&(n=sn(n,i,c*4)),u&&(n=n.times(Math.abs(u)<54?er(2,u):kd.pow(2,u))),ot=!0,n)}function Mee(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:Dd(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/py(5,t)),e=Dd(n,2,e,e);for(var i,a=new n(5),o=new n(16),c=new n(20);t--;)i=e.times(e),e=e.times(a.plus(i.times(o.times(i).minus(c))));return e}function Dd(n,e,t,r,i){var a,o,c,u,d=n.precision,h=Math.ceil(d/Ze);for(ot=!1,u=t.times(t),c=new n(r);;){if(o=sn(c.times(u),new n(e++*e++),d,1),c=i?r.plus(o):r.minus(o),r=sn(o.times(u),new n(e++*e++),d,1),o=c.plus(r),o.d[h]!==void 0){for(a=h;o.d[a]===c.d[a]&&a--;);if(a==-1)break}a=c,c=r,r=o,o=a}return ot=!0,o.d.length=h+1,o}function py(n,e){for(var t=n;--e;)t*=n;return t}function _j(n,e){var t,r=e.s<0,i=Ha(n,n.precision,1),a=i.times(.5);if(e=e.abs(),e.lte(a))return Is=r?4:1,e;if(t=e.divToInt(i),t.isZero())Is=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(a))return Is=Lk(t)?r?2:3:r?4:1,e;Is=Lk(t)?r?1:4:r?3:2}return e.minus(i).abs()}function VS(n,e,t,r){var i,a,o,c,u,d,h,p,m,b=n.constructor,_=t!==void 0;if(_?(ri(t,1,bl),r===void 0?r=b.rounding:ri(r,0,8)):(t=b.precision,r=b.rounding),!n.isFinite())h=xj(n);else{for(h=ns(n),o=h.indexOf("."),_?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,o>=0&&(h=h.replace(".",""),m=new b(1),m.e=h.length-o,m.d=b0(ns(m),10,i),m.e=m.d.length),p=b0(h,10,i),a=u=p.length;p[--u]==0;)p.pop();if(!p[0])h=_?"0p+0":"0";else{if(o<0?a--:(n=new b(n),n.d=p,n.e=a,n=sn(n,m,t,r,0,i),p=n.d,a=n.e,d=fj),o=p[t],c=i/2,d=d||p[t+1]!==void 0,d=r<4?(o!==void 0||d)&&(r===0||r===(n.s<0?3:2)):o>c||o===c&&(r===4||d||r===6&&p[t-1]&1||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>i-1;)p[t]=0,t||(++a,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,h="";o<u;o++)h+=Q_.charAt(p[o]);if(_){if(u>1)if(e==16||e==8){for(o=e==16?4:3,--u;u%o;u++)h+="0";for(p=b0(h,i,e),u=p.length;!p[u-1];--u);for(o=1,h="1.";o<u;o++)h+=Q_.charAt(p[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>u)for(a-=u;a--;)h+="0";else a<u&&(h=h.slice(0,a)+"."+h.slice(a))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return n.s<0?"-"+h:h}function Bk(n,e){if(n.length>e)return n.length=e,!0}function Pee(n){return new this(n).abs()}function Oee(n){return new this(n).acos()}function Vee(n){return new this(n).acosh()}function jee(n,e){return new this(n).plus(e)}function zee(n){return new this(n).asin()}function Lee(n){return new this(n).asinh()}function Bee(n){return new this(n).atan()}function Uee(n){return new this(n).atanh()}function Fee(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,a=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=Ha(this,a,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?Ha(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=Ha(this,a,1).times(.5),t.s=n.s):e.s<0?(this.precision=a,this.rounding=1,t=this.atan(sn(n,e,a,1)),e=Ha(this,a,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(sn(n,e,a,1)),t}function Gee(n){return new this(n).cbrt()}function qee(n){return $e(n=new this(n),n.e+1,2)}function Hee(n,e,t){return new this(n).clamp(e,t)}function $ee(n){if(!n||typeof n!="object")throw Error(fy+"Object expected");var e,t,r,i=n.defaults===!0,a=["precision",1,bl,"rounding",0,8,"toExpNeg",-Qu,0,"toExpPos",0,Qu,"maxE",0,Qu,"minE",-Qu,0,"modulo",0,9];for(e=0;e<a.length;e+=3)if(t=a[e],i&&(this[t]=Z_[t]),(r=n[t])!==void 0)if(kr(r)===r&&r>=a[e+1]&&r<=a[e+2])this[t]=r;else throw Error(hl+t+": "+r);if(t="crypto",i&&(this[t]=Z_[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(pj);else this[t]=!1;else throw Error(hl+t+": "+r);return this}function Yee(n){return new this(n).cos()}function Kee(n){return new this(n).cosh()}function wj(n){var e,t,r;function i(a){var o,c,u,d=this;if(!(d instanceof i))return new i(a);if(d.constructor=i,Uk(a)){d.s=a.s,ot?!a.d||a.e>i.maxE?(d.e=NaN,d.d=null):a.e<i.minE?(d.e=0,d.d=[0]):(d.e=a.e,d.d=a.d.slice()):(d.e=a.e,d.d=a.d?a.d.slice():a.d);return}if(u=typeof a,u==="number"){if(a===0){d.s=1/a<0?-1:1,d.e=0,d.d=[0];return}if(a<0?(a=-a,d.s=-1):d.s=1,a===~~a&&a<1e7){for(o=0,c=a;c>=10;c/=10)o++;ot?o>i.maxE?(d.e=NaN,d.d=null):o<i.minE?(d.e=0,d.d=[0]):(d.e=o,d.d=[a]):(d.e=o,d.d=[a]);return}if(a*0!==0){a||(d.s=NaN),d.e=NaN,d.d=null;return}return x0(d,a.toString())}if(u==="string")return(c=a.charCodeAt(0))===45?(a=a.slice(1),d.s=-1):(c===43&&(a=a.slice(1)),d.s=1),mj.test(a)?x0(d,a):Nee(d,a);if(u==="bigint")return a<0?(a=-a,d.s=-1):d.s=1,x0(d,a.toString());throw Error(hl+a)}if(i.prototype=_e,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=$ee,i.clone=wj,i.isDecimal=Uk,i.abs=Pee,i.acos=Oee,i.acosh=Vee,i.add=jee,i.asin=zee,i.asinh=Lee,i.atan=Bee,i.atanh=Uee,i.atan2=Fee,i.cbrt=Gee,i.ceil=qee,i.clamp=Hee,i.cos=Yee,i.cosh=Kee,i.div=Xee,i.exp=Wee,i.floor=Qee,i.hypot=Zee,i.ln=Jee,i.log=ete,i.log10=nte,i.log2=tte,i.max=rte,i.min=ite,i.mod=ate,i.mul=ste,i.pow=ote,i.random=lte,i.round=cte,i.sign=ute,i.sin=dte,i.sinh=fte,i.sqrt=hte,i.sub=pte,i.sum=gte,i.tan=mte,i.tanh=vte,i.trunc=yte,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function Xee(n,e){return new this(n).div(e)}function Wee(n){return new this(n).exp()}function Qee(n){return $e(n=new this(n),n.e+1,3)}function Zee(){var n,e,t=new this(0);for(ot=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return ot=!0,new this(1/0);t=e}return ot=!0,t.sqrt()}function Uk(n){return n instanceof kd||n&&n.toStringTag===gj||!1}function Jee(n){return new this(n).ln()}function ete(n,e){return new this(n).log(e)}function tte(n){return new this(n).log(2)}function nte(n){return new this(n).log(10)}function rte(){return bj(this,arguments,-1)}function ite(){return bj(this,arguments,1)}function ate(n,e){return new this(n).mod(e)}function ste(n,e){return new this(n).mul(e)}function ote(n,e){return new this(n).pow(e)}function lte(n){var e,t,r,i,a=0,o=new this(1),c=[];if(n===void 0?n=this.precision:ri(n,1,bl),r=Math.ceil(n/Ze),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));a<r;)i=e[a],i>=429e7?e[a]=crypto.getRandomValues(new Uint32Array(1))[0]:c[a++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);a<r;)i=e[a]+(e[a+1]<<8)+(e[a+2]<<16)+((e[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,a):(c.push(i%1e7),a+=4);a=r/4}else throw Error(pj);else for(;a<r;)c[a++]=Math.random()*1e7|0;for(r=c[--a],n%=Ze,r&&n&&(i=er(10,Ze-n),c[a]=(r/i|0)*i);c[a]===0;a--)c.pop();if(a<0)t=0,c=[0];else{for(t=-1;c[0]===0;t-=Ze)c.shift();for(r=1,i=c[0];i>=10;i/=10)r++;r<Ze&&(t-=Ze-r)}return o.e=t,o.d=c,o}function cte(n){return $e(n=new this(n),n.e+1,this.rounding)}function ute(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function dte(n){return new this(n).sin()}function fte(n){return new this(n).sinh()}function hte(n){return new this(n).sqrt()}function pte(n,e){return new this(n).sub(e)}function gte(){var n=0,e=arguments,t=new this(e[n]);for(ot=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return ot=!0,$e(t,this.precision,this.rounding)}function mte(n){return new this(n).tan()}function vte(n){return new this(n).tanh()}function yte(n){return $e(n=new this(n),n.e+1,1)}_e[Symbol.for("nodejs.util.inspect.custom")]=_e.toString;_e[Symbol.toStringTag]="Decimal";var kd=_e.constructor=wj(Z_);pv=new kd(pv);gv=new kd(gv);const bte=n=>{if(!n)return null;if(n instanceof Date)return n;if(typeof n=="object"&&typeof n.toDate=="function")return n.toDate();if(typeof n=="object"&&n.seconds!==void 0)return new Date(n.seconds*1e3);if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?null:e}if(typeof n=="number"){const e=new Date(n);return isNaN(e.getTime())?null:e}return null},xte=()=>{const{envelopes:n,transactions:e,fetchData:t,isLoading:r,isOnline:i,reorderEnvelopes:a}=Pn(),{currentUser:o}=ca(),{currentMonth:c,incomeSources:u,allocations:d,deleteIncomeSource:h,setEnvelopeAllocation:p,copyPreviousMonthAllocations:m,isLoading:b}=Pn(),{showToast:_}=Ws(),[w,S]=U.useState(!1),T=U.useRef(null),[C,D]=U.useState(!1),M=!C||r||b,[j,z]=U.useState([]),A=U.useRef([]),[I,k]=U.useState([]),V=U.useRef([]),B=U.useCallback(ne=>{if(n.find(fe=>fe.id===ne)?.isPiggybank){const fe=Pn.getState().getEnvelopeBalance(ne);return new kd(fe)}const ce=Pn.getState().getEnvelopeBalance(ne,c);return new kd(ce)},[n,c]);U.useEffect(()=>{const ne=n.filter(te=>{if(!te.isPiggybank||!te.isActive)return!1;if(te.createdAt)try{const ce=bte(te.createdAt);if(!ce)return console.error(` Invalid creation date for piggybank ${te.name}:`,te.createdAt),!1;const fe=`${ce.getFullYear()}-${String(ce.getMonth()+1).padStart(2,"0")}`;return c>=fe}catch(ce){return console.error(` Error processing piggybank ${te.name}:`,ce,{createdAt:te.createdAt,typeofCreatedAt:typeof te.createdAt}),!1}return!0}).sort((te,ce)=>{const fe=te.orderIndex??0,ye=ce.orderIndex??0;return fe-ye});k(ne),V.current=ne},[n,c]);const L=I,P=j;U.useEffect(()=>(T.current=setTimeout(()=>{S(!0)},8e3),t(),D(!0),()=>{T.current&&clearTimeout(T.current)}),[]),U.useEffect(()=>{C&&!r&&!b&&(S(!1),T.current&&clearTimeout(T.current))},[C,r,b]),U.useEffect(()=>{const ne=n.filter(te=>{if(te.isPiggybank||te.isActive===!1)return!1;const fe=(d[c]||[]).some(Ae=>Ae.envelopeId===te.id),ye=e.some(Ae=>Ae.envelopeId===te.id&&(Ae.month===c||Ae.date.startsWith(c)));return fe||ye}).sort((te,ce)=>{const fe=te.orderIndex??0,ye=ce.orderIndex??0;return fe-ye});z(ne),A.current=ne},[n,d,c,e]);const Z=(u[c]||[]).reduce((ne,te)=>ne+te.amount,0),K=(d[c]||[]).filter(ne=>P.some(te=>te.id===ne.envelopeId)||L.some(te=>te.id===ne.envelopeId)).reduce((ne,te)=>ne+te.budgetedAmount,0),H=Z-K,$=U.useCallback(async ne=>{if(!ne.length)return;const te=ne.map(ce=>ce.id);try{await a(te)}catch(ce){console.error("Failed to persist envelope order:",ce),_("Failed to save envelope order","error")}},[a,_]),Q=U.useCallback(async ne=>{await $(ne)},[$]),re=U.useCallback(ne=>{h(c,ne.id).catch(console.error),_(`Deleted "${ne.name}"`,"neutral")},[h,c,_]),ue=U.useCallback(async ne=>{try{const te=ne||c;console.log(" Copying to month:",te),await m(te),_("Previous month budget copied","success")}catch(te){console.error("Error copying previous month:",te),_("Failed to copy previous month","error")}},[m,_,c]),G=U.useCallback(async()=>{if(!o||!c){_("Cannot clear data: not logged in or no month selected","error");return}try{await Pn.getState().clearMonthData(c),_(`"${c}" budget and transactions cleared successfully`,"success")}catch(ne){console.error("Error clearing month data:",ne),_("Failed to clear month data","error")}},[o,c,_]),Y=U.useCallback(async(ne,te)=>{try{await p(ne,te),setTimeout(()=>{const ce=Pn.getState(),fe=ce.currentMonth,ye=ce.incomeSources[fe]||[],Ae=ce.allocations[fe]||[],Pe=ye.reduce((we,ke)=>we+ke.amount,0),Se=Ae.reduce((we,ke)=>we+ke.budgetedAmount,0);Pe-Se<-.01&&_(`You can't spend more than you make.
You're not in Congress!`,"error")},100)}catch(ce){console.error("Failed to set allocation:",ce),_("Failed to update budget","error")}},[p,_]);return{visibleEnvelopes:P,piggybanks:L,incomeSources:u,availableToBudget:H,currentMonth:c,allocations:d,transactions:e,isLoading:r,isInitialLoading:M,isOnline:i,showTimeoutMessage:w,getEnvelopeBalance:B,fetchData:t,reorderEnvelopes:Q,deleteIncomeSource:re,clearMonthData:G,copyFromPreviousMonth:ue,setEnvelopeAllocation:Y,localOrderRef:A,setLocalEnvelopes:z,localPiggybankOrderRef:V,setLocalPiggybanks:k}},_te=({currentMonth:n,onMonthChange:e,budgetStatus:t})=>{const[r,i]=n.split("-").map(Number),o=["January","February","March","April","May","June","July","August","September","October","November","December"][i-1],c=()=>{let p=r,m=i-1;m<1&&(p=r-1,m=12);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},u=()=>{let p=r,m=i+1;m>12&&(p=r+1,m=1);const b=`${p}-${m.toString().padStart(2,"0")}`;e(b)},d=()=>{const p=new Date,m=`${p.getFullYear()}-${(p.getMonth()+1).toString().padStart(2,"0")}`;e(m)},h=()=>{if(!t)return null;const{amount:p,totalIncome:m,totalAllocated:b}=t,_=typeof p=="number"?p:0,w=typeof m=="number"?m:0,S=typeof b=="number"?b:0,T=Math.abs(_)<=.01,C=_<-.01,D=w>0?S/w*100:0;let M="text-gray-900 dark:text-white",j="bg-green-500",z="Left to Budget",A=w>0?Math.min(D,100):0,I=!0;return w===0?(z="Add income to start budgeting",A=0,I=!1,M="text-gray-500 dark:text-zinc-500"):T?(M="text-green-600 dark:text-emerald-400",j="bg-green-500",z="Perfect! Every dollar has a job ",A=100,I=!1):C&&(M="text-red-600 dark:text-red-400",j="bg-red-500",z="You're not in Congress! Try again.",A=100),v.jsxs("div",{className:"flex flex-col justify-center min-w-0 w-full",children:[v.jsxs("div",{className:"flex items-baseline justify-start mb-1",children:[v.jsx("span",{className:`text-xs font-medium truncate mr-1.5 ${M}`,children:z}),I&&v.jsxs("span",{className:`text-sm font-bold truncate ${M}`,children:[C?"-":"","$",Math.abs(_).toFixed(2)]})]}),v.jsx("div",{className:"w-full h-1.5 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:v.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${j}`,style:{width:`${A}%`}})})]})};return v.jsxs("div",{className:"py-2 space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Previous month",children:v.jsx(mL,{size:20})}),v.jsx("div",{className:"text-center",children:v.jsxs("button",{onClick:d,className:"text-base font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors whitespace-nowrap",title:"Click to go to current month",children:[o," ",r]})}),v.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg transition-colors","aria-label":"Next month",children:v.jsx(zo,{size:20})})]}),t&&v.jsx("div",{className:"px-1",children:h()})]})},gy=({children:n,onDelete:e,threshold:t=-100})=>{const r=JX(),[i,a]=U.useState(!1),o=U.useRef(0),c=()=>{a(!0),o.current=Date.now()},u=async(d,h)=>{const p=h.offset.x,m=h.velocity.x;if(setTimeout(()=>a(!1),100),p<t||p<-50&&m<-500){const b=e();b===!1?r.start({x:0}):b instanceof Promise&&b.then(_=>{_===!1&&r.start({x:0})})}else r.start({x:0})};return v.jsxs("div",{className:"relative w-full overflow-hidden mb-2 rounded-xl group",children:[v.jsx("div",{className:"absolute inset-0 bg-red-500 flex items-center justify-end pr-6 rounded-xl",children:v.jsx(_1,{className:"text-white w-6 h-6"})}),v.jsx(Wn.div,{drag:"x",dragConstraints:{left:-500,right:0},dragElastic:.1,onDragStart:c,onDragEnd:u,animate:r,className:`relative bg-white dark:bg-zinc-900 rounded-xl ${i?"z-20":"z-10"}`,style:{touchAction:"pan-y",pointerEvents:i?"none":"auto"},children:n})]})},wte=({isVisible:n,onClose:e,mode:t,initialIncomeSource:r})=>{const{addIncomeSource:i,updateIncomeSource:a,currentMonth:o}=Pn(),{showToast:c}=Ws(),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(!1);U.useEffect(()=>{if(!n)return;const w=window.setTimeout(()=>{t==="edit"&&r?(d(r.name),p(r.amount.toString())):(d(""),p(""))},0);return()=>window.clearTimeout(w)},[n,t,r]);const _=async w=>{if(w.preventDefault(),!u.trim()||!h||parseFloat(h)<=0){c("Please fill in all required fields with valid values","error");return}b(!0);try{if(t==="add")await i(o,{name:u.trim(),amount:parseFloat(h),month:o,userId:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),c("Income source added successfully","success");else{if(!r){c("Error: No income source to edit","error");return}await a(o,{...r,name:u.trim(),amount:parseFloat(h),updatedAt:new Date().toISOString()}),c(`Updated "${u.trim()}" income source`,"success")}e()}catch(S){console.error("Error saving income source:",S),c("Failed to save income source. Please try again.","error")}finally{b(!1)}};return v.jsx(Jr,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Wn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(Wn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:t==="add"?"Add Income Source":"Edit Income Source"}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",children:""})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Income Source Name *"}),v.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"e.g., Primary Job, Freelance, Investments",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Amount *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:h,onChange:w=>{const S=w.target.value.replace(/\D/g,"");if(!S){p("");return}const C=(parseInt(S,10)/100).toFixed(2);p(C)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-zinc-800 dark:text-white",required:!0})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:m||!u.trim()||!h||parseFloat(h)<=0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":t==="add"?"Add Income":"Save Changes"})]})]})]})]})})},Ete=({currentMonth:n,onCopy:e,isLoading:t=!1})=>{const r=c=>{const[u,d]=c.split("-");return new Date(parseInt(u),parseInt(d)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},i=c=>{const[u,d]=c.split("-").map(Number);let h=u,p=d-1;return p<1&&(h=u-1,p=12),r(`${h}-${p.toString().padStart(2,"0")}`)},a=r(n),o=i(n);return v.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 py-12 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/30 blur-2xl rounded-full opacity-50"}),v.jsxs("div",{className:"relative bg-white dark:bg-zinc-800 p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-700",children:[v.jsx(oL,{className:"w-12 h-12 text-blue-500"}),v.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white p-1.5 rounded-full border-2 border-white dark:border-zinc-900",children:v.jsx(w0,{size:14})})]})]}),v.jsxs("div",{className:"max-w-xs mx-auto space-y-2",children:[v.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["It looks like you need a budget for ",a]}),v.jsxs("p",{className:"text-gray-500 dark:text-zinc-400",children:["We can copy your budget from ",o," to get you started right away."]})]}),v.jsx("div",{className:"w-full max-w-xs space-y-3 pt-2",children:v.jsx("button",{onClick:e,disabled:t,className:"w-full py-3.5 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-sm transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:t?"Creating...":v.jsx(v.Fragment,{children:v.jsxs("span",{children:["Create ",a," Budget"]})})})})]})},Ste=({currentMonth:n,onComplete:e})=>{const[t,r]=U.useState(0),a=(b=>{const[_,w]=b.split("-");return new Date(parseInt(_),parseInt(w)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})})(n),o=[{icon:w0,title:"Welcome to House Budget!",description:`Let's set up your budget for ${a}`,content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["House Budget helps you take control of your money using the ",v.jsx("strong",{children:"zero-based budgeting"})," method."]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Every dollar gets a job, and you'll know exactly where your money is going."}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium",children:" This quick guide will show you how to get started in just a few steps!"})})]}),color:"blue"},{icon:w2,title:"Step 1: Add Your Income",description:"Tell us how much money you have to work with",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"First, you'll add your income sources for the month. This could be:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Va,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Salary"})," - Your regular paycheck"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Va,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Freelance"})," - Side gig income"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Va,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Other Income"})," - Any other money coming in"]})]})]}),v.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-green-900 dark:text-green-200",children:[v.jsx("strong",{children:'Look for the "Income Sources" section'})," at the top of your budget and tap the ",v.jsx(hh,{className:"w-4 h-4 inline"})," button to add income."]})})]}),color:"green"},{icon:bv,title:"Step 2: Create Spending Envelopes",description:"Organize your spending into categories",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Spending envelopes are categories for your expenses. Common examples:"}),v.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-zinc-400",children:[v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Va,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Groceries"})," - Food and household items"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Va,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Rent/Mortgage"})," - Housing costs"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Va,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Transportation"})," - Gas, car payment, transit"]})]}),v.jsxs("li",{className:"flex items-start gap-2",children:[v.jsx(Va,{className:"w-5 h-5 text-purple-500 flex-shrink-0 mt-0.5"}),v.jsxs("span",{children:[v.jsx("strong",{children:"Entertainment"})," - Fun money"]})]})]}),v.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-200",children:[v.jsx("strong",{children:'Scroll down to "Spending Envelopes"'}),' and tap "Create New Envelope" to add your categories.']})})]}),color:"purple"},{icon:E0,title:"Step 3: Allocate Your Budget",description:"Assign money to each envelope",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Now comes the fun part - giving every dollar a job!"}),v.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-xl p-4",children:[v.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-2",children:'The "Available to Budget" amount shows unassigned money'}),v.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-200",children:["Your goal is to get this to ",v.jsx("strong",{children:"$0.00"})," by allocating all your income to envelopes."]})]}),v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:[v.jsx("strong",{children:"To allocate money:"})," Tap the budget amount on any envelope and enter how much you want to assign to it."]}),v.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-amber-900 dark:text-amber-200",children:[" ",v.jsx("strong",{children:"Pro tip:"})," Start with your essential expenses (rent, utilities, groceries) first, then allocate what's left to other categories."]})})]}),color:"blue"},{icon:yc,title:"Bonus: Piggybanks (Savings Goals)",description:"Save for future goals",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Piggybanks are special envelopes for ",v.jsx("strong",{children:"savings goals"})," that carry over month-to-month."]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(u9,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Set a Goal"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Vacation, emergency fund, new car - whatever you're saving for"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(w2,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Monthly Contributions"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Set an automatic monthly amount to save"})]})]}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(E0,{className:"w-5 h-5 text-pink-500 flex-shrink-0 mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Track Progress"}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Watch your savings grow toward your goal"})]})]})]}),v.jsx("div",{className:"bg-pink-50 dark:bg-pink-900/20 border border-pink-200 dark:border-pink-800 rounded-xl p-4",children:v.jsxs("p",{className:"text-sm text-pink-900 dark:text-pink-200",children:[v.jsx("strong",{children:"Find Piggybanks"})," at the bottom of your budget. They're optional but powerful for reaching your goals!"]})})]}),color:"pink"},{icon:Va,title:"You're Ready to Budget!",description:"Start taking control of your money",content:v.jsxs("div",{className:"space-y-4 text-left",children:[v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"That's it! You now know the basics of House Budget:"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"1"})}),v.jsx("span",{children:"Add your income sources"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"2"})}),v.jsx("span",{children:"Create spending envelopes"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"3"})}),v.jsx("span",{children:"Allocate until Available to Budget = $0"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-gray-700 dark:text-zinc-300",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:v.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"4"})}),v.jsx("span",{children:"Track spending and adjust as needed"})]})]}),v.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mt-6",children:v.jsx("p",{className:"text-sm text-center text-blue-900 dark:text-blue-200 font-medium",children:' Click "Start Budgeting" below to create your first budget!'})})]}),color:"green"}],c=o[t],u=c.icon,d=t===o.length-1,h=t===0,m={blue:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-600 dark:text-green-400",button:"bg-green-600 hover:bg-green-700"},purple:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-600 dark:text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},pink:{bg:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-600 dark:text-pink-400",button:"bg-pink-600 hover:bg-pink-700"}}[c.color];return v.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center p-4",children:v.jsx("div",{className:"w-full max-w-2xl",children:v.jsx(Jr,{mode:"wait",children:v.jsxs(Wn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:[v.jsxs("div",{className:"p-6 pb-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-6",children:[v.jsx("div",{className:`${m.bg} p-3 rounded-xl`,children:v.jsx(u,{className:`w-8 h-8 ${m.text}`})}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["Step ",t+1," of ",o.length]})]}),v.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:c.title}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:c.description})]}),v.jsx("div",{className:"px-6 pb-6",children:c.content}),v.jsx("div",{className:"px-6 pb-4 flex justify-center gap-2",children:o.map((b,_)=>v.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${_===t?`w-8 ${m.button}`:_<t?"w-2 bg-gray-400 dark:bg-zinc-600":"w-2 bg-gray-200 dark:bg-zinc-700"}`},_))}),v.jsxs("div",{className:"p-6 pt-0 flex gap-3",children:[!h&&v.jsxs("button",{onClick:()=>r(b=>b-1),className:"flex-1 py-3 px-4 border border-gray-300 dark:border-zinc-700 text-gray-700 dark:text-zinc-300 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2",children:[v.jsx(ad,{className:"w-5 h-5"}),"Back"]}),v.jsx("button",{onClick:()=>{d?e():r(b=>b+1)},className:`${h?"flex-1":"flex-[2]"} py-3 px-4 ${m.button} text-white rounded-xl font-semibold transition-all active:scale-[0.98] flex items-center justify-center gap-2`,children:d?v.jsxs(v.Fragment,{children:[v.jsx(w0,{className:"w-5 h-5"}),"Start Budgeting"]}):v.jsxs(v.Fragment,{children:["Next",v.jsx(aL,{className:"w-5 h-5"})]})})]})]},t)})})})},Tte=({isOpen:n,onClose:e,onSave:t,existingPiggybank:r})=>{const[i,a]=U.useState(""),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState("#3B82F6"),[m,b]=U.useState("piggy-bank"),[_,w]=U.useState(!1),[S,T]=U.useState(!1);U.useEffect(()=>{r?(a(r.name),c(r.piggybankConfig?.targetAmount?.toString()||""),d(r.piggybankConfig?.monthlyContribution.toString()||"0"),p(r.piggybankConfig?.color||"#3B82F6"),b(r.piggybankConfig?.icon||"piggy-bank"),w(r.piggybankConfig?.paused||!1)):(a(""),c(""),d(""),p("#3B82F6"),b("piggy-bank"),w(!1))},[r,n]);const C=async M=>{if(M.preventDefault(),!(!i.trim()||!u)){T(!0);try{const j={name:i.trim(),isPiggybank:!0,piggybankConfig:{monthlyContribution:parseFloat(u),color:h,icon:m,paused:_}};o&&parseFloat(o)>0&&(j.piggybankConfig.targetAmount=parseFloat(o)),r&&(j.id=r.id,j.currentBalance=r.currentBalance,j.lastUpdated=new Date().toISOString(),j.isActive=r.isActive,j.orderIndex=r.orderIndex,j.userId=r.userId),await t(j),e()}catch(j){console.error("Error saving piggybank:",j),alert("Failed to save piggybank")}finally{T(!1)}}},D=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}];return v.jsx(Jr,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Wn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),v.jsxs(Wn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"sticky top-0 bg-white dark:bg-zinc-900 border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:v.jsx(yc,{size:20,className:"text-blue-600 dark:text-blue-400"})}),v.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:r?"Edit Piggybank":"New Piggybank"})]}),v.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:v.jsx(xv,{size:24})})]}),v.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"piggybank-name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Piggybank Name *"}),v.jsx("input",{type:"text",id:"piggybank-name",value:i,onChange:M=>a(M.target.value),placeholder:"e.g. Vacation Fund, Emergency Savings",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0,autoFocus:!0})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"monthly-contribution",value:u,onChange:M=>{const j=M.target.value.replace(/\D/g,"");if(!j){d("");return}const A=(parseInt(j,10)/100).toFixed(2);d(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",id:"target-amount",value:o,onChange:M=>{const j=M.target.value.replace(/\D/g,"");if(!j){c("");return}const A=(parseInt(j,10)/100).toFixed(2);c(A)},placeholder:"0.00",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:_,onChange:M=>w(M.target.checked),className:"w-5 h-5 rounded border-gray-300 dark:border-zinc-700 text-blue-600 focus:ring-2 focus:ring-blue-500"}),v.jsxs("div",{children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Pause auto-contributions"}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Monthly contributions will be skipped while paused"})]})]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:D.map(M=>v.jsx("button",{type:"button",onClick:()=>p(M.value),className:`w-full aspect-square rounded-lg transition-all ${h===M.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:M.value},title:M.label},M.value))})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",disabled:S,children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!i.trim()||!u||S,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${i.trim()&&u&&!S?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:S?"Saving...":r?"Update":"Create"})]})]})]})]})})},Ate=({piggybank:n,balance:e,onNavigate:t,setMoveableRef:r,isReorderingActive:i,activelyDraggingId:a,onItemDragStart:o,onMoveUp:c,onMoveDown:u,isFirst:d,isLast:h,isReorderUnlocked:p})=>{const m=Pn(Se=>Se.updatePiggybankContribution),b=Pn(Se=>Se.updateEnvelope),_=Ws(Se=>Se.showToast),[w,S]=U.useState(!1),T=Se=>{Se.stopPropagation(),S(!0)},C=async Se=>{try{const we={...n,...Se,id:n.id,userId:n.userId,currentBalance:n.currentBalance,lastUpdated:new Date().toISOString(),isActive:n.isActive,orderIndex:n.orderIndex};await b(we),_("Piggybank updated successfully","success"),S(!1)}catch(we){console.error("Failed to update piggybank:",we),_("Failed to update piggybank","error")}},D=n.piggybankConfig?.targetAmount,M=n.piggybankConfig?.monthlyContribution??0,j=n.piggybankConfig?.color||"#3B82F6",z=n.piggybankConfig?.paused||!1,A=typeof e=="number"?e:e.toNumber(),I=(Se,we=1)=>{const ke=Se.replace("#",""),nt=parseInt(ke,16),Ue=nt>>16&255,Ee=nt>>8&255,Ne=nt&255;return`rgba(${Ue}, ${Ee}, ${Ne}, ${we})`},k=`linear-gradient(135deg, ${I(j,.14)} 0%, ${I(j,.05)} 100%)`,V=I(j,.4),[B,L]=U.useState(!1),[P,Z]=U.useState(M?M.toFixed(2):"0.00"),[K,H]=U.useState(!1),$=U.useRef(null),Q=U.useRef(null),[re,ue]=U.useState(!1),G=D&&D>0?Math.min(A/D*100,100):0,Y=D&&A>=D;U.useEffect(()=>{a&&a!==n.id&&ue(!1)},[a,n.id]),U.useEffect(()=>{a===n.id&&(ue(!0),o&&o(n.id))},[a,n.id,o]),U.useEffect(()=>{if(!a&&re){const Se=setTimeout(()=>{ue(!1)},300);return()=>clearTimeout(Se)}},[a,re]),U.useEffect(()=>{B||Z(M?M.toFixed(2):"0.00")},[M,B]),U.useEffect(()=>{B&&$.current&&($.current.focus(),$.current.select())},[B]);const ne=Se=>{Se.stopPropagation(),("touches"in Se||Se.type.startsWith("touch"))&&Se.preventDefault(),!K&&(Z(M?M.toFixed(2):"0.00"),L(!0))},te=()=>{L(!1),Z(M?M.toFixed(2):"0.00")},ce=async()=>{if(!B||K)return;const Se=parseFloat(P);if(Number.isNaN(Se)||Se<0){_("Enter a valid contribution amount","error");return}if(Se===M){L(!1);return}H(!0);try{await m(n.id,Se),_("Monthly contribution updated","success"),Z(Se.toFixed(2)),L(!1)}catch(we){console.error("Failed to update piggybank contribution",we),_("Failed to update contribution","error")}finally{H(!1)}},fe=Se=>{Se.key==="Enter"?(Se.preventDefault(),ce()):Se.key==="Escape"&&(Se.preventDefault(),te())},ye=Se=>{if(re||i){Se.preventDefault(),Se.stopPropagation();return}if(B){Se.preventDefault(),Se.stopPropagation();return}t(n.id)},Ae=a===n.id,Pe=v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[p&&c&&u&&v.jsxs("div",{className:"flex flex-col gap-1 mr-1",children:[v.jsx("button",{onClick:Se=>{Se.stopPropagation(),c()},disabled:d,className:`p-1 rounded transition-colors ${d?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move up","aria-label":"Move piggybank up",children:v.jsx(fN,{size:18})}),v.jsx("button",{onClick:Se=>{Se.stopPropagation(),u()},disabled:h,className:`p-1 rounded transition-colors ${h?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move down","aria-label":"Move piggybank down",children:v.jsx(dN,{size:18})})]}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-start justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:`${j}20`},children:v.jsx(yc,{size:20,style:{color:j}})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),Y&&v.jsx("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:" Goal Reached!"})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:"text-right",children:[v.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",A.toFixed(2)]}),D&&v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["of $",D.toFixed(2)]})]}),v.jsx("button",{onClick:T,className:"p-1.5 rounded-lg text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",title:"Edit piggybank",children:v.jsx(hN,{size:16})})]})]}),D&&D>0&&v.jsxs("div",{className:"mb-3",children:[v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-800 rounded-full h-2 overflow-hidden",children:v.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${G}%`,backgroundColor:j}})}),v.jsxs("div",{className:"flex justify-between items-center mt-1",children:[v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:[G.toFixed(0),"% complete"]}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["$",(D-A).toFixed(2)," to go"]}),v.jsx("span",{className:"ml-2 px-2 py-0.5 text-[11px] font-semibold rounded-full uppercase tracking-wide",style:{backgroundColor:I(j,.15),color:j},children:"Piggybank"})]})]}),v.jsx("div",{className:"mt-2",children:z?v.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[v.jsx(e9,{size:14,className:"text-orange-500"}),v.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"Paused"})]}):v.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-zinc-400",children:[v.jsx(E0,{size:14,style:{color:j}}),B?v.jsxs("form",{onSubmit:Se=>{Se.preventDefault(),ce()},className:"flex items-center gap-2",onClick:Se=>Se.stopPropagation(),children:[v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{ref:$,type:"number",min:"0",step:"0.01",value:P,onChange:Se=>Z(Se.target.value),onBlur:ce,onKeyDown:fe,disabled:K,autoFocus:!0,className:"w-28 pl-6 pr-3 py-1.5 rounded-lg border border-gray-300 dark:border-zinc-600 bg-white dark:bg-zinc-900 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),K&&v.jsx(qL,{size:16,className:"animate-spin text-gray-400"})]}):v.jsxs("div",{onClick:ne,onTouchEnd:ne,className:"font-medium text-gray-900 dark:text-white hover:underline cursor-pointer",children:["$",M.toFixed(2),"/month"]})]})})]})]});return v.jsxs(v.Fragment,{children:[v.jsx(Tte,{isOpen:w,onClose:()=>S(!1),onSave:C,existingPiggybank:n}),v.jsx(Wn.div,{layout:!Ae,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},ref:Se=>{r&&r(Se),Q.current=Se},onClick:ye,style:{background:k,borderColor:V},className:"rounded-xl p-4 border transition-all cursor-pointer shadow-sm hover:shadow-md select-none active:scale-[0.99]",children:Pe})]})},th=(n,e=1)=>{const t=n.replace("#",""),r=parseInt(t,16),i=r>>16&255,a=r>>8&255,o=r&255;return`rgba(${i}, ${a}, ${o}, ${e})`},Fk=12,Gk=(n,e,t)=>Math.min(Math.max(n,e),t),Cte=({env:n,budgetedAmount:e,remainingBalance:t,editingEnvelopeId:r,setEditingEnvelopeId:i,editingAmount:a,setEditingAmount:o,handleBudgetSave:c,navigate:u,inputRef:d,transactions:h,currentMonth:p,setMoveableRef:m,isReorderingActive:b,activelyDraggingId:_,onItemDragStart:w,onMoveUp:S,onMoveDown:T,isFirst:C,isLast:D,isReorderUnlocked:M})=>{const{showToast:j}=Ws(),z=!!n.isPiggybank,A=n.piggybankConfig?.color||"#3B82F6",I=z?`linear-gradient(135deg, ${th(A,.18)} 0%, ${th(A,.08)} 100%)`:void 0,k=z?th(A,.5):void 0,V=U.useRef(null),[B,L]=U.useState(!1),P=h.filter(Y=>Y.envelopeId===n.id&&Y.month===p),Z=P.filter(Y=>Y.type==="Expense"),K=P.filter(Y=>Y.type==="Income"),H=Z.reduce((Y,ne)=>Y+(ne.amount||0),0),$=K.reduce((Y,ne)=>Y+(ne.amount||0),0),Q=Math.max(0,H/$*100),re=Y=>{if(B||b){Y.preventDefault(),Y.stopPropagation();return}if(r===n.id){Y.preventDefault(),Y.stopPropagation();return}const ne=Y.target;if(ne.closest(".js-budget-target")||ne.tagName==="INPUT"){Y.preventDefault(),Y.stopPropagation(),M&&setTimeout(()=>{j("Lock envelope order to edit budget","neutral")},10);return}u(`/envelope/${n.id}`)};U.useEffect(()=>{_&&_!==n.id&&L(!1)},[_,n.id]),U.useEffect(()=>{_===n.id&&(L(!0),w(n.id))},[_,n.id,w]),U.useEffect(()=>{if(!_&&B){const Y=setTimeout(()=>{L(!1)},300);return()=>clearTimeout(Y)}},[_,B]);const ue=v.jsxs("div",{className:"flex items-center gap-2 w-full",children:[M&&v.jsxs("div",{className:"flex flex-col gap-1",children:[v.jsx("button",{onClick:Y=>{Y.stopPropagation(),S()},disabled:C,className:`p-1 rounded transition-colors ${C?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move up","aria-label":"Move envelope up",children:v.jsx(fN,{size:18})}),v.jsx("button",{onClick:Y=>{Y.stopPropagation(),T()},disabled:D,className:`p-1 rounded transition-colors ${D?"text-gray-300 dark:text-zinc-700 cursor-not-allowed":"text-gray-500 dark:text-zinc-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:"Move down","aria-label":"Move envelope down",children:v.jsx(dN,{size:18})})]}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[z&&v.jsx("span",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{borderColor:th(A,.4),backgroundColor:th(A,.15),color:A},children:v.jsx(yc,{size:16})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:n.name}),z&&v.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:A},children:"Piggybank"})]})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("div",{className:"flex items-center gap-x-4",onPointerDown:Y=>Y.stopPropagation(),children:r===n.id?v.jsxs("div",{className:"flex items-center gap-x-1",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsx("form",{onSubmit:Y=>{Y.preventDefault(),c()},children:v.jsx("input",{ref:d,type:"number",value:a,onChange:Y=>o(Y.target.value),onBlur:c,className:"w-24 px-2 py-1 text-sm border rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white",step:"0.01",autoFocus:!0})})]}):v.jsxs("div",{onTouchStart:Y=>{if(M){Y.preventDefault(),Y.stopPropagation(),j("Lock envelope order to edit budget","neutral");return}},onTouchEnd:Y=>{if(Y.preventDefault(),Y.stopPropagation(),M){j("Lock envelope order to edit budget","neutral");return}i(n.id),o(e.toString())},onClick:Y=>{if(M){Y.preventDefault(),Y.stopPropagation(),j("Lock envelope order to edit budget","neutral");return}i(n.id),o(e.toString())},className:"flex items-center gap-x-1 hover:bg-gray-200 dark:hover:bg-zinc-700 px-3 py-2 rounded transition-colors cursor-pointer js-budget-target",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Budgeted:"}),v.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",e.toFixed(2)]})]})}),v.jsxs("div",{className:"text-right",children:[v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 block",children:"Remaining"}),v.jsxs("span",{className:`font-bold ${(typeof t=="number"?t:t.toNumber())<0||100-Q<=5?"text-red-500":Q>=80?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-emerald-400"}`,children:["$",(typeof t=="number"?t:t.toNumber()).toFixed(2)]})]})]}),e>0&&v.jsx("div",{className:"mt-3",onClick:Y=>Y.stopPropagation(),children:v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-zinc-400 mb-1",children:[v.jsx("span",{children:"Budget Used"}),v.jsxs("span",{children:[Q.toFixed(0),"%"]})]}),v.jsx("div",{className:"w-full bg-gray-200 dark:bg-zinc-700 rounded-full h-2 overflow-hidden",children:v.jsx("div",{className:`h-full transition-all duration-300 ease-out ${(typeof t=="number"?t:t.toNumber())<0||100-Q<=5?"bg-red-500":Q>=80?"bg-yellow-500":"bg-green-400"}`,style:{width:`${Math.max(100-Q,2)}%`}})})]})})]})]}),G=_===n.id;return v.jsx(Wn.div,{layout:!G,transition:{layout:{type:"spring",stiffness:350,damping:30,mass:.8}},"data-envelope-id":n.id,ref:Y=>{m(n.id)(Y),V.current=Y},onClick:re,style:{boxShadow:"0 1px 2px rgba(15,23,42,0.08)",background:I,borderColor:k,cursor:"pointer"},className:`p-4 rounded-xl active:scale-[0.99] transition-all select-none border ${z?"bg-white/70 dark:bg-zinc-800/80":"bg-gray-50 dark:bg-zinc-800 border-transparent"}`,children:ue})},Ite=()=>{const{visibleEnvelopes:n,piggybanks:e,incomeSources:t,availableToBudget:r,currentMonth:i,allocations:a,transactions:o,isLoading:c,isInitialLoading:u,showTimeoutMessage:d,getEnvelopeBalance:h,reorderEnvelopes:p,deleteIncomeSource:m,copyFromPreviousMonth:b,setEnvelopeAllocation:_,localOrderRef:w,setLocalEnvelopes:S,localPiggybankOrderRef:T,setLocalPiggybanks:C}=xte(),{setMonth:D,isReorderUnlocked:M}=Pn(),{showToast:j}=Ws(),z=qs(),[A,I]=U.useState(!1),[k,V]=U.useState("add"),[B,L]=U.useState(null),[P,Z]=U.useState(!1),[K,H]=U.useState(!1),[$,Q]=U.useState(!1),re=U.useRef(null),[ue,G]=U.useState(null),[Y,ne]=U.useState(""),te=U.useRef(null);U.useEffect(()=>{if(!u&&!c){const ze=setTimeout(()=>{const Oe=(t[i]||[]).length===0&&(a[i]||[]).length===0,ur=Object.keys(t).some(pt=>(t[pt]||[]).length>0)||Object.keys(a).some(pt=>(a[pt]||[]).length>0);console.log(" Prompt check:",{currentMonth:i,hasIncome:(t[i]||[]).length>0,hasAllocations:(a[i]||[]).length>0,hasAnyDataInAnyMonth:ur,showPrompt:Oe,isNewUser:!ur}),Oe?ur?(H(!0),Q(!1)):(Q(!0),H(!1)):(H(!1),Q(!1))},500);return()=>clearTimeout(ze)}},[u,c,i,t,a]),U.useEffect(()=>{ue&&te.current&&te.current.select()},[ue]);const ce=U.useCallback(ze=>Oe=>{Oe?ye.current[ze]=Oe:delete ye.current[ze]},[]),fe=U.useCallback(ze=>Oe=>{Oe?ke.current[ze]=Oe:delete ke.current[ze]},[]),ye=U.useRef({}),Ae=U.useRef({}),[Pe,Se]=U.useState(null),we=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),ke=U.useRef({}),nt=U.useRef({}),Ue=U.useRef(null),[Ee,Ne]=U.useState(null),Je=U.useRef({activeId:null,startIndex:0,currentIndex:0,itemHeight:0}),[rt,De]=U.useState(!1),je=U.useRef(null),We=U.useRef(0),tn=U.useCallback(()=>De(!0),[]),Yt=U.useCallback(()=>{De(!1),w.current.length&&p(w.current)},[p]),st=U.useCallback(ze=>{},[]),at=U.useCallback(ze=>{M||ue!==ze&&z(`/envelope/${ze}`)},[ue,z,M]),Kt=U.useCallback(()=>De(!0),[]),Vn=U.useCallback(()=>{De(!1),T.current.length&&p(T.current)},[p]);U.useEffect(()=>{const ze=()=>{Object.values(nt.current).forEach(pt=>pt?.destroy()),nt.current={}};if(!e.length)return;const Oe=()=>{M&&e.forEach(pt=>{const At=ke.current[pt.id];if(!At)return;const lt=nt.current[pt.id];if(lt){lt.target=At;return}const Et=new zk(Ue.current,{target:At,draggable:M,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!0,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Et.on("dragStart",kt=>{const ct=kt.inputEvent.target;if(ct.closest(".js-budget-target")||ct.tagName==="INPUT"){j("Lock envelope order to edit budget","neutral"),kt.stop();return}const Nt=T.current.findIndex(rn=>rn.id===pt.id),nn=kt.target,gt=nn.getBoundingClientRect().height+Fk;Ne(pt.id),Je.current={activeId:pt.id,startIndex:Nt,currentIndex:Nt,itemHeight:gt},nn&&(nn.style.transition="none",nn.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",nn.style.zIndex="20"),Kt()});let qe=null;Et.on("drag",kt=>{const ct=kt.target;qe!==null&&cancelAnimationFrame(qe),qe=requestAnimationFrame(()=>{const Nt=Je.current;if(Nt.activeId!==pt.id)return;const nn=kt.beforeTranslate[1];ct.style.transform=`translateY(${nn}px)`,ct.style.transition="none";const{itemHeight:wn,startIndex:gt}=Nt;if(!wn)return;const rn=Math.round(nn/wn),dr=Gk(gt+rn,0,T.current.length-1);dr!==Nt.currentIndex&&(Nt.currentIndex=dr,T.current.forEach((ai,Mr)=>{if(ai.id===pt.id)return;const si=ke.current[ai.id];if(!si)return;let fr=0;gt<dr?Mr>gt&&Mr<=dr&&(fr=-wn):gt>dr&&Mr>=dr&&Mr<gt&&(fr=wn),si.style.transform=fr?`translateY(${fr}px)`:"",si.style.transition="transform 0.2s ease"})),qe=null})}),Et.on("dragEnd",kt=>{qe!==null&&(cancelAnimationFrame(qe),qe=null);const ct=kt.target,Nt=Je.current,{startIndex:nn,currentIndex:wn}=Nt;if(ct.style.transform="",ct.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",ct.style.boxShadow="",T.current.forEach(gt=>{if(gt.id===pt.id)return;const rn=ke.current[gt.id];rn&&(rn.style.transform="",rn.style.transition="")}),nn!==wn){const gt=[...T.current],[rn]=gt.splice(nn,1);gt.splice(wn,0,rn),T.current=gt,C(gt)}setTimeout(()=>{ct.style.zIndex="",ct.style.transition="",Ne(null)},300),Je.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},Vn()}),Et.on("click",kt=>{const ct=kt.inputEvent.target;if(ct.closest(".js-budget-target")||ct.tagName==="INPUT"||ct.tagName==="BUTTON"){ct.closest(".js-budget-target")&&M&&setTimeout(()=>{j("Lock envelope order to edit budget","neutral")},10);return}at(pt.id)}),nt.current[pt.id]=Et})},ur=window.setTimeout(Oe,80);return()=>{clearTimeout(ur),ze()}},[e,Kt,Vn,at,M,j]),U.useEffect(()=>{const ze=()=>{Object.values(Ae.current).forEach(pt=>pt?.destroy()),Ae.current={}};if(!n.length)return;const Oe=()=>{M&&n.forEach(pt=>{const At=ye.current[pt.id];if(!At)return;const lt=Ae.current[pt.id];if(lt){lt.target=At;return}const Et=new zk(je.current,{target:At,draggable:M,throttleDrag:0,edgeDraggable:!1,startDragRotate:0,throttleDragRotate:0,rotatable:!1,scalable:!1,resizable:!1,warpable:!1,pinchable:!1,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,bottom:!0,left:!1,right:!1},elementSnapDirections:{top:!0,bottom:!0,left:!1,right:!1},clickable:!0,preventClickDefault:!1,preventClickEventOnDrag:!0,checkInput:!0,dragArea:!0,hideDefaultLines:!0,hideChildMoveableDefaultLines:!0,renderDirections:[]});Et.on("dragStart",kt=>{const ct=kt.inputEvent.target;if(ct.closest(".js-budget-target")||ct.tagName==="INPUT"){kt.stop();return}const Nt=w.current.findIndex(rn=>rn.id===pt.id),nn=kt.target,gt=nn.getBoundingClientRect().height+Fk;Se(pt.id),we.current={activeId:pt.id,startIndex:Nt,currentIndex:Nt,itemHeight:gt},nn&&(nn.style.transition="none",nn.style.boxShadow="0 18px 45px rgba(15,23,42,0.35)",nn.style.zIndex="20"),tn()});let qe=null;Et.on("drag",kt=>{const ct=kt.target;qe!==null&&cancelAnimationFrame(qe),qe=requestAnimationFrame(()=>{const Nt=we.current;if(Nt.activeId!==pt.id)return;const nn=kt.beforeTranslate[1];ct.style.transform=`translateY(${nn}px)`,ct.style.transition="none";const{itemHeight:wn,startIndex:gt}=Nt;if(!wn)return;const rn=Math.round(nn/wn),dr=Gk(gt+rn,0,w.current.length-1);dr!==Nt.currentIndex&&(Nt.currentIndex=dr,w.current.forEach((ai,Mr)=>{if(ai.id===pt.id)return;const si=ye.current[ai.id];if(!si)return;let fr=0;gt<dr?Mr>gt&&Mr<=dr&&(fr=-wn):gt>dr&&Mr>=dr&&Mr<gt&&(fr=wn),si.style.transform=fr?`translateY(${fr}px)`:"",si.style.transition="transform 0.2s ease"})),qe=null})}),Et.on("dragEnd",kt=>{qe!==null&&(cancelAnimationFrame(qe),qe=null);const ct=kt.target,Nt=we.current,{startIndex:nn,currentIndex:wn}=Nt;if(ct.style.transform="",ct.style.transition="transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease",ct.style.boxShadow="",w.current.forEach(gt=>{if(gt.id===pt.id)return;const rn=ye.current[gt.id];rn&&(rn.style.transform="",rn.style.transition="")}),nn!==wn){const gt=[...w.current],[rn]=gt.splice(nn,1);gt.splice(wn,0,rn),w.current=gt,S(gt)}setTimeout(()=>{ct.style.zIndex="",ct.style.transition="",Se(null)},300),we.current={activeId:null,startIndex:0,currentIndex:0,itemHeight:0},We.current=Date.now(),Yt()}),Et.on("click",kt=>{const ct=kt.inputEvent.target;if(ct.closest(".js-budget-target")||ct.tagName==="INPUT"){ct.closest(".js-budget-target")&&M&&setTimeout(()=>{j("Lock envelope order to edit budget","neutral")},10);return}at(pt.id)}),Ae.current[pt.id]=Et})},ur=window.setTimeout(Oe,80);return()=>{clearTimeout(ur),ze()}},[n,tn,Yt,at,M,j]);const ii=async()=>{if(ue)try{const ze=parseFloat(Y)||0;await _(ue,ze)}catch(ze){console.error("Failed to save budget amount:",ze)}finally{G(null),ne("")}},Qs=()=>{V("add"),L(null),I(!0)},Zs=ze=>{re.current&&clearTimeout(re.current),!P&&(V("edit"),L(ze),I(!0))},Yi=ze=>{re.current&&clearTimeout(re.current),Z(!0),m(ze),setTimeout(()=>Z(!1),500)},ya=()=>{I(!1),L(null)},Nr=async()=>{H(!1),await b(i)},_n=()=>{Q(!1)};return u?v.jsx(PO,{message:d?"Still loading... This is normal on slow connections":"Loading your budget...",showTimeout:d}):v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:`
        .moveable-control { display: none !important; }
        .moveable-origin { display: none !important; }
        .moveable-line { display: none !important; }
      `}}),v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-20",children:[v.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-zinc-900 border-b border-gray-100 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+4px)] pb-1",children:v.jsx(_te,{currentMonth:i,onMonthChange:ze=>{H(!1),D(ze)},budgetStatus:{amount:r,totalIncome:(t[i]||[]).reduce((ze,Oe)=>ze+Oe.amount,0),totalAllocated:(a[i]||[]).filter(ze=>n.some(Oe=>Oe.id===ze.envelopeId)||e.some(Oe=>Oe.id===ze.envelopeId)).reduce((ze,Oe)=>ze+Oe.budgetedAmount,0)}})}),v.jsxs("div",{className:"pt-[calc(7.5rem+env(safe-area-inset-top))] pb-[calc(8rem+env(safe-area-inset-bottom))] p-4 max-w-4xl mx-auto space-y-4",children:[$?v.jsx(Ste,{currentMonth:i,onComplete:_n}):K?v.jsx(Ete,{currentMonth:i,onCopy:Nr}):v.jsxs(v.Fragment,{children:[v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Income Sources"}),v.jsx("button",{onClick:Qs,className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:v.jsx(hh,{size:20})})]}),(t[i]||[]).length===0?v.jsx("div",{className:"text-center py-6",children:v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm",children:"No income sources yet. Add your monthly income."})}):v.jsx("div",{className:"space-y-3",children:v.jsx(Jr,{initial:!1,mode:"popLayout",children:(t[i]||[]).map(ze=>v.jsx(Wn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(gy,{onDelete:()=>Yi(ze),children:v.jsxs("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 dark:bg-zinc-800 rounded-xl cursor-pointer",onClick:()=>Zs(ze),children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:ze.name}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Monthly income"})]}),v.jsxs("p",{className:"font-semibold text-green-600 dark:text-emerald-400",children:["$",ze.amount.toFixed(2)]})]})})},ze.id))})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Spending Envelopes"}),v.jsx("button",{onClick:()=>z("/add-envelope"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Envelope",children:v.jsx(hh,{size:20})})]}),n.length===0?v.jsxs("div",{className:"text-center py-6",children:[v.jsx(bv,{className:"w-12 h-12 text-gray-300 dark:text-zinc-700 mx-auto mb-3"}),v.jsx("p",{className:"text-gray-500 dark:text-zinc-400 text-sm mb-4",children:n.length===0?"No envelopes added to this month. Copy from previous month or add new ones.":"No envelopes yet. Create one to get started."}),v.jsx("button",{onClick:()=>z("/add-envelope"),className:"text-blue-600 dark:text-blue-300 font-medium hover:text-blue-700 dark:hover:text-blue-200 transition-colors",children:"Create First Envelope"})]}):v.jsx("div",{ref:je,children:v.jsx(Jr,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:n.map((ze,Oe)=>{const pt=(a[i]||[]).find(qe=>qe.envelopeId===ze.id)?.budgetedAmount||0,At=h(ze.id),lt=()=>{if(Oe===0)return;const qe=[...w.current];[qe[Oe-1],qe[Oe]]=[qe[Oe],qe[Oe-1]],w.current=qe,S(qe),p(qe)},Et=()=>{if(Oe===n.length-1)return;const qe=[...w.current];[qe[Oe],qe[Oe+1]]=[qe[Oe+1],qe[Oe]],w.current=qe,S(qe),p(qe)};return v.jsx(Cte,{env:ze,budgetedAmount:pt,remainingBalance:At,editingEnvelopeId:ue,setEditingEnvelopeId:G,editingAmount:Y,setEditingAmount:ne,handleBudgetSave:ii,navigate:z,inputRef:te,transactions:o,currentMonth:i,setMoveableRef:ce,isReorderingActive:rt,activelyDraggingId:Pe,onItemDragStart:st,onMoveUp:lt,onMoveDown:Et,isFirst:Oe===0,isLast:Oe===n.length-1,isReorderUnlocked:M},ze.id)})})})})]}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[v.jsx(yc,{size:20,className:"text-blue-600 dark:text-blue-400"}),"Piggybanks"]}),v.jsx("button",{onClick:()=>z("/add-envelope?type=piggybank"),className:"text-blue-600 dark:text-blue-300 hover:text-blue-700 dark:hover:text-blue-200 transition-colors",title:"Create New Piggybank",children:v.jsx(hh,{size:20})})]}),e.length>0?v.jsx("div",{ref:Ue,className:"relative",children:v.jsx(Jr,{initial:!1,children:v.jsx("div",{className:"space-y-3",children:e.map((ze,Oe)=>{const ur=()=>{if(Oe===0)return;const At=[...T.current];[At[Oe-1],At[Oe]]=[At[Oe],At[Oe-1]],T.current=At,C(At),p(At)},pt=()=>{if(Oe===e.length-1)return;const At=[...T.current];[At[Oe],At[Oe+1]]=[At[Oe+1],At[Oe]],T.current=At,C(At),p(At)};return v.jsx(Ate,{piggybank:ze,balance:h(ze.id),onNavigate:At=>z(`/envelope/${At}`),setMoveableRef:fe(ze.id),isReorderingActive:rt,activelyDraggingId:Ee,onItemDragStart:()=>{},onMoveUp:ur,onMoveDown:pt,isFirst:Oe===0,isLast:Oe===e.length-1,isReorderUnlocked:M},ze.id)})})})}):v.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-zinc-400",children:[v.jsx(yc,{size:48,className:"mx-auto mb-3 opacity-30"}),v.jsx("p",{className:"text-sm",children:"No piggybanks yet"}),v.jsx("p",{className:"text-xs mt-1",children:"Click the + button above to create your first piggybank"})]})]})]}),v.jsx(wte,{isVisible:A,onClose:ya,mode:k,initialIncomeSource:B})]})]})]})},Rte=[],Ej=({selectedCard:n,onCardSelect:e,initialCards:t=Rte,disabled:r=!1,isUserSelected:i=!1})=>{const[a,o]=U.useState(t.length>0?t[0]:{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}),[c,u]=U.useState(!1),[d,h]=U.useState(!1),[p,m]=U.useState(t),[b,_]=U.useState(null),[w,S]=U.useState({name:"",network:"Visa",last4:"",color:"#3b82f6"}),T=n||a;U.useEffect(()=>{!n&&e&&p.length>0&&e(p[0])},[n,e,p]);const C=k=>{r||(k.id==="add-new"?h(!0):(o(k),e?.(k),u(!1)))},D=()=>{r||u(!c)},M=k=>{r||_(k)},j=()=>{if(b&&!r){const k=p.filter(V=>V.id!==b.id);if(m(k),T.id===b.id&&k.length>0){const V=k[0];o(V),e?.(V)}_(null)}},z=()=>{_(null)},A=()=>{if(r)return;if(w.last4.length!==4||!/^\d{4}$/.test(w.last4)){alert("Please enter exactly 4 digits for the last 4 digits");return}if(!w.name.trim()){alert("Please enter a card name");return}const k={id:`custom-${Date.now()}`,name:w.name.trim(),network:w.network,last4:w.last4,color:w.color},V=[...p,k];m(V),o(k),e?.(k),h(!1),u(!1),S({name:"",network:"Visa",last4:"",color:"#3b82f6"})},I=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6b7280","#0f4c81","#fdbb30","#7fb5b5","#232f3e","#e3e3e3"];return v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Payment Method",!i&&v.jsx("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400 font-medium",children:"(Default selected)"})]}),v.jsxs("div",{onClick:D,className:`flex items-center gap-4 p-3 border rounded-lg transition-colors ${r?"cursor-not-allowed opacity-50 border-gray-300 dark:border-gray-600":"cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 border-gray-300 dark:border-gray-600"} ${i?"":"ring-2 ring-blue-200 dark:ring-blue-800"}`,children:[v.jsxs("div",{className:"w-[70px] h-[40px] rounded-lg flex flex-col justify-between p-[6px] shadow-lg text-white font-mono text-xs",style:{backgroundColor:T.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:T.network}),v.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",T.last4]})]}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:T.name}),v.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(...",T.last4,")"]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-gray-400",children:c?"":""}),!i&&v.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",title:"Default payment method - tap to change"})]})]}),c&&v.jsx("div",{className:"card-stack-dropdown",children:v.jsx("div",{className:"card-stack",children:v.jsx(Jr,{initial:!1,mode:"popLayout",children:[...p,{id:"add-new",name:"+ Add New Card",network:"Visa",last4:"",color:"#6b7280"}].map((k,V)=>{const B=T.id===k.id,L=k.id==="add-new";return v.jsx(Wn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(gy,{onDelete:()=>!L&&!r&&M(k),threshold:-80,children:v.jsxs("div",{className:`card-stack-item ${B?"selected":""} ${L?"add-new-card":""}`,onClick:()=>C(k),style:{backgroundColor:L?"#f3f4f6":k.color,color:L?"#374151":k.color==="#e3e3e3"?"#000":"#fff",zIndex:p.length-V},children:[v.jsxs("div",{className:"card-header",children:[v.jsx("span",{className:"card-network",children:L?"":k.network}),B&&!L&&v.jsx("span",{className:"selected-indicator",children:""})]}),v.jsxs("div",{className:"card-details",children:[v.jsx("div",{className:"card-name",children:k.name}),v.jsx("div",{className:"card-number",children:L?"":` ${k.last4}`})]}),L&&v.jsx("div",{className:"add-icon",children:v.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),v.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})},k.id)})})})})]}),d&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-md mx-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Add New Card"}),v.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Name"}),v.jsx("input",{type:"text",value:w.name,onChange:k=>S({...w,name:k.target.value}),placeholder:"e.g., My Chase Card",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),v.jsxs("select",{value:w.network,onChange:k=>S({...w,network:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[v.jsx("option",{value:"Visa",children:"Visa"}),v.jsx("option",{value:"Mastercard",children:"Mastercard"}),v.jsx("option",{value:"Amex",children:"Amex"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last 4 Digits"}),v.jsx("input",{type:"text",value:w.last4,onChange:k=>S({...w,last4:k.target.value.replace(/\D/g,"").slice(0,4)}),placeholder:"1234",maxLength:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Card Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:I.map(k=>v.jsx("button",{onClick:()=>S({...w,color:k}),className:`w-full h-10 rounded-lg border-2 transition-all ${w.color===k?"border-blue-500 scale-110":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:k}},k))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview"}),v.jsxs("div",{className:"w-full h-20 rounded-lg flex flex-col justify-between p-3 shadow-lg text-white font-mono text-xs",style:{backgroundColor:w.color},children:[v.jsx("span",{className:"text-right text-[7px] uppercase font-bold",children:w.network}),v.jsxs("span",{className:"text-left text-[9px] leading-none",children:[" ",w.last4||"0000"]})]})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:A,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"Add Card"})]})]})]})}),b&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-200 dark:border-zinc-700 shadow-xl p-6 w-full max-w-sm mx-4",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Delete Card"}),v.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",v.jsx("span",{className:"font-medium",children:b.name}),"?"]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:z,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:j,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors",children:"Delete"})]})]})})})]})},Sj=({isVisible:n,onClose:e,mode:t,currentEnvelope:r,initialTransaction:i})=>{const{addTransaction:a,updateTransaction:o,deleteTransaction:c,currentMonth:u}=Pn(),[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState(""),[w,S]=U.useState(new Date().toISOString().split("T")[0]),[T,C]=U.useState(null);U.useEffect(()=>{if(n)if(t==="edit"&&i){h(i.amount.toString()),m(i.merchant||""),_(i.description),C(i.paymentMethod||null);try{const A=new Date(i.date);isNaN(A.getTime())?(console.warn("Invalid date in transaction:",i.date),S(new Date().toISOString().split("T")[0])):S(A.toISOString().split("T")[0])}catch(A){console.error("Error parsing transaction date:",A),S(new Date().toISOString().split("T")[0])}}else h(""),m(""),_(""),S(new Date().toISOString().split("T")[0])},[n,t,i]);const D=async A=>{A.preventDefault();const I=parseFloat(d);if(isNaN(I)||I<=0){console.log(" Invalid amount:",d);return}console.log(" Saving transaction:",{mode:t,amount:I,note:b,date:w,envelopeId:r.id,paymentMethod:T});try{const k=new Date(w),V=`${k.getFullYear()}-${(k.getMonth()+1).toString().padStart(2,"0")}`;if(V!==u){const B=`This transaction date (${V}) does not match the current budget month (${u}). Are you sure you want to save it?`;if(!window.confirm(B))return}t==="add"?(console.log(" Adding income transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Income",reconciled:!1,paymentMethod:T||void 0})):t==="spend"?(console.log(" Adding expense transaction"),await a({amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),envelopeId:r.id,type:"Expense",reconciled:!1,paymentMethod:T||void 0})):t==="edit"&&i&&(console.log(" Updating transaction"),await o({...i,amount:I,description:b,merchant:p||void 0,date:new Date(w).toISOString(),paymentMethod:T||void 0})),console.log(" Transaction saved successfully"),e()}catch(k){console.error(" Error saving transaction:",k),alert("Failed to save transaction: "+(k instanceof Error?k.message:"Unknown error"))}},M=()=>{!i||!i.id||window.confirm("Are you sure you want to delete this transaction?")&&(c(i.id),e())},j=t==="add"?"Add Money":t==="spend"?"Spend Money":"Edit Transaction",z=t==="add"?"text-green-500":"text-red-500";return v.jsx(Jr,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Wn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(Wn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:j}),v.jsx("button",{onClick:D,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!d||parseFloat(d)<=0,children:"Save"})]}),v.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${z}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:d,onChange:A=>{const I=A.target.value.replace(/\D/g,"");if(!I){h("");return}const V=(parseInt(I,10)/100).toFixed(2);h(V)},onKeyDown:A=>{(A.key==="e"||A.key==="E"||A.key==="+"||A.key==="-")&&A.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${z} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:p,onChange:A=>m(A.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(Ej,{selectedCard:T,onCardSelect:C}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:b,onChange:A=>_(A.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const A=new Date(w);return`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}`!==u?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(Zu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:w,onChange:A=>{console.log("Date changed to:",A.target.value),S(A.target.value)},required:!0,className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),t==="edit"&&v.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-zinc-800",children:v.jsxs("button",{type:"button",onClick:M,className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-50 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-200 dark:border-zinc-800",children:[v.jsx(pN,{className:"w-5 h-5 mr-2"}),"Delete Transaction"]})})]})]})]})})},Dte=({isVisible:n,onClose:e,sourceEnvelope:t})=>{const{envelopes:r,transferFunds:i}=Pn(),[a,o]=U.useState(""),[c,u]=U.useState(""),[d,h]=U.useState(""),[p,m]=U.useState(new Date().toISOString().split("T")[0]),b=r.filter(S=>S.id!==t.id);U.useEffect(()=>{if(!n)return;const S=window.setTimeout(()=>{o(""),u(""),h(""),m(new Date().toISOString().split("T")[0])},0);return()=>window.clearTimeout(S)},[n]);const _=S=>{S.preventDefault();const T=parseFloat(c);isNaN(T)||T<=0||!a||(i(t.id,a,T,d,new Date(p)),e())},w=r.find(S=>S.id===a);return v.jsx(Jr,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Wn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"absolute inset-0 bg-black/80 backdrop-blur-sm"}),v.jsxs(Wn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 w-full max-w-md rounded-2xl border border-gray-200 dark:border-zinc-800 shadow-2xl overflow-hidden relative z-10",children:[v.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{onClick:e,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"Cancel"}),v.jsx("h2",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:"Transfer Money"}),v.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 font-bold disabled:opacity-50",disabled:!c||parseFloat(c)<=0||!a,children:"Transfer"})]}),v.jsxs("form",{onSubmit:_,className:"p-6 space-y-6",children:[v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"From"}),v.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.name})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"To"}),v.jsxs("select",{value:a,onChange:S=>o(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none cursor-pointer",children:[v.jsx("option",{value:"",className:"bg-white dark:bg-zinc-900",children:"Select envelope..."}),b.map(S=>v.jsx("option",{value:S.id,className:"bg-white dark:bg-zinc-900",children:S.name},S.id))]})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl text-blue-600 dark:text-blue-400",children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:c,onChange:S=>{const T=S.target.value.replace(/\D/g,"");if(!T){u("");return}const D=(parseInt(T,10)/100).toFixed(2);u(D)},onKeyDown:S=>{(S.key==="e"||S.key==="E"||S.key==="+"||S.key==="-")&&S.preventDefault()},placeholder:"0.00",autoFocus:!0,className:"bg-transparent text-4xl font-bold text-center w-40 focus:outline-none text-blue-600 dark:text-blue-400 placeholder-gray-400 dark:placeholder-gray-600"})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note (Optional)"}),v.jsx("input",{type:"text",value:d,onChange:S=>h(S.target.value),placeholder:"What is this transfer for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Date"}),v.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),w&&c&&parseFloat(c)>0&&v.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-zinc-400 pt-2 border-t border-gray-200 dark:border-zinc-800",children:["Moving ",v.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:["$",parseFloat(c).toFixed(2)]})," from"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:t.name})," to"," ",v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:w.name})]})]})]})]})})},kte=n=>{if(!n)return"No Date";try{let e;return n&&typeof n=="object"&&n.toDate&&typeof n.toDate=="function"?e=n.toDate():typeof n=="number"?n<1e10?e=new Date((n+978307200)*1e3):e=new Date(n):e=new Date(n),isNaN(e.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}catch(e){return console.error("Date error:",e),"Error"}},Nte=n=>{const e=typeof n=="string"?parseFloat(n):n;return typeof e!="number"||isNaN(e)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e))},Tj=({transaction:n,envelopeName:e,onReconcile:t,onEdit:r})=>{if(!n)return null;console.log(" Transaction payment method:",n.paymentMethod);const i=n.type==="Income",a=n.type==="Expense";let o="text-gray-900 dark:text-white";return i&&(o="text-green-600 dark:text-green-400"),a&&(o="text-red-600 dark:text-red-400"),v.jsxs("div",{onClick:r,className:"flex items-center justify-between p-4 bg-white dark:bg-zinc-900 active:bg-gray-50 dark:active:bg-zinc-800 active:scale-[0.99] transition-all cursor-pointer group border-b border-gray-100 dark:border-zinc-800 last:border-0",children:[v.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-semibold text-gray-900 dark:text-white truncate",children:n.merchant||n.description||"No Description"}),n.reconciled&&v.jsx("span",{className:"text-[10px] bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"R"})]}),n.merchant&&n.description&&n.description!==n.merchant&&v.jsx("div",{className:"text-xs text-gray-600 dark:text-zinc-400 truncate",children:n.description}),v.jsxs("div",{className:"text-xs text-gray-500 dark:text-zinc-500 flex items-center gap-1 flex-wrap",children:[v.jsx("span",{children:kte(n.date)}),e&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{className:"text-blue-500 dark:text-blue-400 truncate max-w-[150px]",children:e})]}),n.paymentMethod&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsxs("span",{className:"flex items-center gap-1",children:[v.jsx("span",{className:"w-[12px] h-[8px] rounded-[2px] flex-shrink-0",style:{backgroundColor:n.paymentMethod.color}}),v.jsx("span",{className:"truncate max-w-[80px]",children:n.paymentMethod.name})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:`font-bold font-mono whitespace-nowrap ${o}`,children:[a?"-":i?"+":"",Nte(n.amount)]}),t?v.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),t()},className:"p-1.5 rounded-full border border-transparent hover:border-green-200 dark:hover:border-green-500 transition-colors","aria-label":n.reconciled?"Mark as unreconciled":"Mark as reconciled",children:n.reconciled?v.jsx(Va,{className:"text-green-500",size:20}):v.jsx(_2,{className:"text-gray-400",size:20})}):v.jsx("span",{children:n.reconciled?v.jsx(Va,{className:"text-green-500",size:20}):v.jsx(_2,{className:"text-gray-400",size:20})})]})]})},Mte=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n),Pte=()=>{const{id:n}=J6(),{envelopes:e,transactions:t,fetchData:r,isLoading:i,deleteEnvelope:a,renameEnvelope:o,updateTransaction:c,deleteTransaction:u,restoreTransaction:d,getEnvelopeBalance:h,currentMonth:p}=Pn(),{showToast:m}=Ws(),b=qs(),_=va(),[w,S]=U.useState(!1),[T,C]=U.useState(!1),[D,M]=U.useState(!1),[j,z]=U.useState(null);U.useEffect(()=>{e.length===0&&r()},[]);const A=e.find(L=>L.id===n);if(!A)return i?v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Loading envelope..."})}):v.jsx("div",{className:"flex justify-center items-center h-screen bg-white dark:bg-black text-gray-900 dark:text-white",children:v.jsx("p",{children:"Envelope not found."})});if(A.isPiggybank){const L=t.filter(P=>P.envelopeId===A.id);console.log(" Piggybank:",A.name),console.log(" Created at:",A.createdAt),console.log(" Transactions:",L.map(P=>({date:P.date,description:P.description,amount:P.amount})))}const I=t.filter(L=>L.envelopeId===A.id).filter(L=>{if(A.isPiggybank){if((L.description==="Monthly Allocation"||L.description==="Piggybank Contribution")&&L.isAutomatic||!A.createdAt)return!0;const P=new Date(A.createdAt);return new Date(L.date)>=P}return L.month===p||!L.month}).sort((L,P)=>new Date(P.date).getTime()-new Date(L.date).getTime()),k=()=>{_.state?.fromGlobalFAB?b("/"):b(-1)},V=()=>{n&&(a(n),b(-1))},B=L=>{const P={...L,reconciled:!L.reconciled};c(P)};return v.jsxs("div",{className:"min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white p-4 pb-[calc(8rem+env(safe-area-inset-bottom))] max-w-4xl mx-auto",children:[v.jsxs("header",{className:"flex justify-between items-center pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 bg-white dark:bg-black z-10 border-b border-gray-100 dark:border-zinc-800",children:[v.jsx("button",{onClick:()=>{const L=prompt("Rename envelope:",A.name);L&&L.trim()&&n&&o(n,L)},className:"text-blue-600 dark:text-blue-400 font-medium",children:"Rename"}),v.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:A.name}),v.jsx("button",{onClick:k,className:"text-blue-600 dark:text-blue-400 font-bold",children:"Done"})]}),v.jsx("section",{className:"mt-4 bg-white dark:bg-zinc-900 rounded-lg p-4 shadow-lg mb-4 border border-gray-100 dark:border-zinc-800",children:v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-lg font-headline text-gray-900 dark:text-white",children:"Current Balance"}),(()=>{const L=A.isPiggybank?h(A.id):h(A.id,p);return console.log(`Debug: Envelope ${A.name} Balance:`,L),v.jsx("span",{className:`text-xl font-bold ${L<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:Mte(L)})})()]})}),v.jsxs("section",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg mb-4 divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:[v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-green-600 dark:text-green-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>S(!0),children:[v.jsx(wL,{className:"w-5 h-5 mr-3"}),"Add Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>C(!0),children:[v.jsx(xL,{className:"w-5 h-5 mr-3"}),"Spend Money"]}),v.jsxs("button",{className:"flex items-center w-full p-4 text-left text-blue-600 dark:text-blue-400 hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150",onClick:()=>M(!0),children:[v.jsx(rL,{className:"w-5 h-5 mr-3"}),"Transfer Money"]})]}),v.jsxs("section",{className:"mt-6",children:[v.jsx("h2",{className:"text-sm font-semibold uppercase text-gray-500 dark:text-zinc-400 mb-2 px-2",children:"Transaction History"}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg shadow-lg divide-y divide-gray-100 dark:divide-zinc-800 border border-gray-100 dark:border-zinc-800",children:I.length===0?v.jsx("p",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"No transactions yet for this envelope."}):v.jsx(Jr,{initial:!1,mode:"popLayout",children:I.map(L=>v.jsx(Wn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(gy,{onDelete:()=>{if(!L.id)return;const P={...L};u(L.id),m("Transaction deleted","neutral",()=>d(P))},children:v.jsx(Tj,{transaction:L,onReconcile:()=>B(L),onEdit:()=>z(L)})})},L.id))})})]}),v.jsx("div",{className:"mt-8",children:v.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-white dark:bg-zinc-900 text-red-600 dark:text-red-400 font-semibold hover:bg-gray-100 dark:hover:bg-zinc-800 transition duration-150 flex items-center justify-center border border-gray-100 dark:border-zinc-800",onClick:()=>{const L=A.isPiggybank?`Are you sure you want to delete "${A.name}"? This will delete the piggybank and all its history.`:`Are you sure you want to remove "${A.name}" from ${p}? This will delete all transactions for this month only.`;confirm(L)&&V()},children:[v.jsx(pN,{className:"w-5 h-5 mr-2"}),"Delete Envelope"]})}),v.jsx(Sj,{isVisible:w||T||!!j,onClose:()=>{S(!1),C(!1),z(null)},mode:w?"add":T?"spend":"edit",currentEnvelope:A,initialTransaction:j}),v.jsx(Dte,{isVisible:D,onClose:()=>M(!1),sourceEnvelope:A})]})},Ote=({isVisible:n,onClose:e,onConfirm:t,currentMonth:r,incomeCount:i,totalIncome:a,allocationCount:o,totalAllocated:c,transactionCount:u,totalTransactionAmount:d,isLoading:h=!1})=>{const[p,m]=U.useState(""),[b,_]=U.useState("confirm"),w=C=>{const[D,M]=C.split("-");return new Date(parseInt(D),parseInt(M)-1).toLocaleDateString("en-US",{year:"numeric",month:"long"})},S=()=>{b==="confirm"?_("type"):b==="type"&&p==="START FRESH"&&t()},T=()=>{_("confirm"),m(""),e()};return v.jsx(Jr,{children:n&&v.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[v.jsx(Wn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T,className:"absolute inset-0 bg-black bg-opacity-50"}),v.jsxs(Wn.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto relative z-10",children:[v.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-zinc-800",children:[v.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Start Fresh for ",w(r)]}),v.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 transition-colors",disabled:h,children:""})]}),v.jsx("div",{className:"p-6 space-y-4",children:b==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3",children:[v.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"This action will permanently delete:"}),v.jsx("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:v.jsxs("ul",{className:"space-y-1",children:[v.jsxs("li",{children:[" ",i," income source",i!==1?"s":""," (totaling $",a.toFixed(2),"/month)"]}),v.jsxs("li",{children:[" ",o," envelope allocation",o!==1?"s":""," (totaling $",c.toFixed(2),")"]}),v.jsxs("li",{children:[" ",u," transaction",u!==1?"s":""," (totaling $",d.toFixed(2),")"]})]})})]})]})}),v.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[v.jsx("strong",{children:"All other months will remain completely unchanged."})," This only affects the current month's budget data, income sources, allocations, and all transactions."]})})]})}),v.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"You can undo this action within 30 seconds if you change your mind."})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-sm text-gray-900 dark:text-white mb-4",children:["Type ",v.jsx("strong",{children:"START FRESH"})," to confirm:"]}),v.jsx("input",{type:"text",value:p,onChange:C=>m(C.target.value),placeholder:"START FRESH",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent dark:bg-zinc-800 dark:text-white text-center font-mono text-lg",autoFocus:!0})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500 text-center",children:"This action cannot be undone after 30 seconds"})]})}),v.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 dark:border-zinc-800",children:[v.jsx("button",{type:"button",onClick:T,className:"flex-1 px-4 py-2 text-gray-700 dark:text-zinc-300 border border-gray-300 dark:border-zinc-700 rounded-lg hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors",disabled:h,children:"Cancel"}),v.jsx("button",{type:"button",onClick:S,disabled:h||b==="type"&&p!=="START FRESH",className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Clearing...":b==="confirm"?"Continue":"Start Fresh"})]})]})]})})},Vte=()=>{const n=qs(),e=U.useRef(null),{envelopes:t,transactions:r,resetData:i,importData:a,getEnvelopeBalance:o,appSettings:c,updateAppSettings:u,initializeAppSettings:d,incomeSources:h,allocations:p,currentMonth:m,clearMonthData:b,handleUserLogout:_}=Pn(),{deleteAccount:w,currentUser:S,logout:T}=ca(),[C,D]=U.useState(null),[M,j]=U.useState(()=>localStorage.getItem("lastBackupDate")||"Never"),[z,A]=U.useState(!1),[I,k]=U.useState(""),[V,B]=U.useState(!1),[L,P]=U.useState(!1),[Z,K]=U.useState(null),[H,$]=U.useState(!1),[Q,re]=U.useState(!1),ue=978307200,G=c?.theme??"system";U.useEffect(()=>{c||d().catch(Ee=>{console.error("Failed to initialize app settings:",Ee)})},[d,c]);const Y=(Ee,Ne)=>{D({type:Ee,text:Ne}),setTimeout(()=>D(null),3500)},ne=U.useMemo(()=>{const Ee=t.length,Ne=r.length,Je=m?p[m]||[]:[],rt=Object.values(h).reduce((st,at)=>st+at.length,0),De=Je.length,je=t.reduce((st,at)=>{const Kt=o(at.id);return st+(typeof Kt=="number"?Kt:0)},0),We=0,tn=r.reduce((st,at)=>{let Kt=0;if(typeof at.date=="string"){const Vn=Date.parse(at.date);Kt=Number.isNaN(Vn)?0:Vn}else typeof at.date=="number"&&(Kt=at.date<2e9?(at.date+ue)*1e3:at.date);return Math.max(st,Kt)},0),Yt=We||tn?new Date(Math.max(We,tn)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"Never";return{envelopeCount:Ee,transactionCount:Ne,incomeSourceCount:rt,allocationCount:De,totalBalance:je,lastUpdated:Yt}},[t,r,h,p,m]),te=()=>{try{console.log(" Creating backup...");const Ee={appVersion:"2.1 (PWA)",backupDate:Date.now(),appSettings:c||{theme:"system"},envelopes:t.map(je=>({...je,currentBalance:(()=>{const We=o(je.id);return typeof We=="number"?We:0})(),lastUpdated:new Date().toISOString()})),transactions:r,allocations:p,incomeSources:h},Ne=new Blob([JSON.stringify(Ee,null,2)],{type:"application/json"}),Je=URL.createObjectURL(Ne),rt=document.createElement("a");rt.href=Je,rt.download=`HouseBudget_Backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(rt),rt.click(),document.body.removeChild(rt),URL.revokeObjectURL(Je);const De=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});localStorage.setItem("lastBackupDate",De),j(De),K({success:!0,message:"Backup downloaded successfully."})}catch(Ee){console.error(Ee),K({success:!1,message:"Failed to create backup file.",onRetry:te})}},ce=()=>{P(!0),K(null);try{const Ee=["Date","Merchant","Notes","Amount","Type","Envelope","Reconciled"],Ne=r.map(We=>{const tn=t.find(Kt=>Kt.id===We.envelopeId)?.name||"Unknown",Yt=(We.merchant||"").replace(/"/g,'""'),st=(We.description||"").replace(/"/g,'""');let at="Invalid Date";if(We.date){if(typeof We.date=="string")at=We.date.split("T")[0];else if(typeof We.date=="number"){const Kt=We.date<2e9?(We.date+ue)*1e3:We.date;at=new Date(Kt).toISOString().split("T")[0]}}return[at,`"${Yt}"`,`"${st}"`,We.amount.toFixed(2),We.type,`"${tn}"`,We.reconciled?"Yes":"No"].join(",")}),Je=[Ee.join(","),...Ne].join(`
`),rt=new Blob([Je],{type:"text/csv;charset=utf-8;"}),De=URL.createObjectURL(rt),je=document.createElement("a");je.href=De,je.download=`HouseBudget_Transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(je),je.click(),document.body.removeChild(je),URL.revokeObjectURL(De),K({success:!0,message:"Transactions CSV exported successfully."})}catch(Ee){console.error(Ee),K({success:!1,message:"Failed to export CSV. Please try again.",onRetry:ce})}finally{P(!1)}},fe=()=>{e.current?.click()},ye=Ee=>{const Ne=Ee.target.files?.[0];if(!Ne)return;const Je=new FileReader;Je.onload=async rt=>{try{const De=JSON.parse(rt.target?.result),je=await a(De);if(!je.success){Y("error",je.message);return}if(De.appSettings?.theme)try{await u({theme:De.appSettings.theme})}catch(We){console.error("Failed to update imported settings:",We)}Y("success",`Loaded ${De.envelopes?.length??0} envelopes, ${De.transactions?.length??0} transactions.`)}catch(De){console.error(De),Y("error","Invalid backup file. Please verify the JSON.")}},Je.readAsText(Ne),Ee.target.value=""},Ae=async()=>{if(window.confirm("Are you sure? This will permanently delete all envelopes, transactions, budget allocations, income sources, and settings from the cloud. This action cannot be undone."))try{await i(),Y("success","All data has been permanently deleted."),n("/")}catch(Ee){console.error("Reset failed:",Ee),Y("error","Failed to delete all data. Some data may remain.")}},Pe=async()=>{if(!I.trim()){Y("error","Please enter your password to confirm account deletion.");return}A(!0);try{await i(),await w(I)?Y("success","Your account has been permanently deleted."):Y("error","Failed to delete account. Please try again.")}catch(Ee){console.error("Account deletion failed:",Ee),Y("error","Failed to delete account. Please try again.")}finally{A(!1),B(!1),k("")}},Se=async()=>{if(!S){Y("error","You must be logged in to clean up data.");return}$(!0);try{const Ee=await QE.cleanupOrphanedData(S.id),Ne=Ee.orphanedAllocationsDeleted+Ee.orphanedTransactionsDeleted;Ne>0?Y("success",`Cleaned ${Ne} orphaned items: ${Ee.orphanedAllocationsDeleted} allocations and ${Ee.orphanedTransactionsDeleted} transactions.`):Y("success","No orphaned data found. Your database is already clean!")}catch(Ee){console.error("Cleanup failed:",Ee),Y("error","Failed to clean up orphaned data. Please try again.")}finally{$(!1)}},we=()=>{re(!0)},ke=async()=>{re(!1),await b(m),Y("success","Month data has been reset.")},nt=async()=>{if(window.confirm("Are you sure you want to log out? This will clear all your data from the app until you log back in."))try{_(),T(),n("/")}catch(Ee){console.error("Logout failed:",Ee)}},Ue=S?.displayName?.charAt(0)?.toUpperCase()||S?.email?.charAt(0)?.toUpperCase()||"U";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-center shadow-sm relative",children:[v.jsx("button",{onClick:()=>n(-1),className:"absolute left-4 text-blue-600 dark:text-blue-400 font-medium",children:"Done"}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Settings"})]}),v.jsxs("div",{className:"p-4 space-y-6 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[C&&v.jsxs("div",{className:`px-4 py-3 rounded-2xl text-sm font-medium flex items-center gap-2 ${C.type==="success"?"bg-green-50 text-green-700 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200"}`,children:[C.type==="success"?v.jsx(b1,{size:18}):v.jsx(_1,{size:18}),C.text]}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4 flex items-center gap-4",children:[v.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-semibold shadow-md",children:Ue}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white truncate",children:S?.displayName||S?.email?.split("@")[0]||"User"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400 truncate",children:S?.email}),v.jsxs("button",{onClick:nt,className:"mt-2 text-sm text-red-600 dark:text-red-400 font-medium flex items-center gap-1 hover:underline",children:[v.jsx(QL,{size:14})," Log Out"]})]})]})}),v.jsx("section",{children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-5 space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(E2,{className:"text-blue-500",size:22}),v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Backup & Restore"}),v.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create backups of all your data including envelopes, transactions, budget allocations, income sources, and settings."})]})]}),v.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 pt-2",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Envelopes"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ne.envelopeCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Transactions"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ne.transactionCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Income Sources"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ne.incomeSourceCount})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500 dark:text-zinc-500",children:"Allocations"}),v.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ne.allocationCount})]})]})]})}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Appearance"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-gray-100 dark:border-zinc-800 shadow-sm p-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[G==="light"&&v.jsx("span",{className:"text-orange-500 text-lg",children:""}),G==="dark"&&v.jsx("span",{className:"text-purple-500 text-lg",children:""}),G==="system"&&v.jsx("span",{className:"text-gray-500 text-lg",children:""}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Theme"})]}),v.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400 capitalize",children:G})]}),v.jsx("div",{className:"flex gap-2",children:[{label:"Light",value:"light"},{label:"Dark",value:"dark"},{label:"System",value:"system"}].map(Ee=>v.jsx("button",{onClick:async()=>{try{await u({theme:Ee.value})}catch(Ne){console.error("Failed to update theme setting:",Ne)}},className:`flex-1 py-2 rounded-lg text-sm font-medium border transition-colors ${G===Ee.value?"bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-700 dark:text-blue-200":"border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 hover:border-gray-300 dark:hover:border-zinc-600"}`,children:Ee.label},Ee.value))})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Actions"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm divide-y divide-gray-100 dark:divide-zinc-800",children:[v.jsxs("button",{onClick:te,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(E2,{className:"text-blue-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Create Backup"}),v.jsxs("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Last backup: ",M]})]})]}),v.jsx(zo,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:fe,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(y9,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Restore from Backup"})]}),v.jsx(zo,{className:"text-gray-400",size:18})]}),v.jsx("div",{className:"p-4",children:v.jsxs("button",{onClick:ce,disabled:L,className:"w-full flex items-center justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed rounded-xl border border-gray-100 dark:border-zinc-800 px-4 py-3 bg-white dark:bg-zinc-900",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[L?v.jsx(S2,{className:"text-blue-500 animate-spin",size:20}):v.jsx(PL,{className:"text-blue-500",size:20}),v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:L?"Preparing CSV":"Export Transactions (CSV)"})]}),v.jsx(zo,{className:"text-gray-400",size:18})]})}),v.jsx("input",{type:"file",ref:e,onChange:ye,accept:".json",className:"hidden"})]})]}),v.jsxs("section",{children:[v.jsx("h2",{className:"text-xs font-bold text-gray-500 dark:text-zinc-500 uppercase mb-2 px-1",children:"Danger Zone"}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl overflow-hidden border border-gray-100 dark:border-zinc-800 shadow-sm",children:[v.jsxs("button",{onClick:we,className:"w-full p-4 flex items-center justify-between hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Vh,{className:"text-orange-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Start Fresh (This Month)"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Clear all allocations and data for the current month only"})]})]}),v.jsx(zo,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Se,disabled:H,className:"w-full p-4 flex items-center justify-between hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[H?v.jsx(S2,{className:"text-yellow-500 animate-spin",size:20}):v.jsx(w0,{className:"text-yellow-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:H?"Cleaning Data...":"Purge Orphaned Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Remove allocations and transactions pointing to deleted envelopes"})]})]}),v.jsx(zo,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:Ae,className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors border-b border-gray-100 dark:border-zinc-800",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(_1,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Reset All Data"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete everything"})]})]}),v.jsx(zo,{className:"text-gray-400",size:18})]}),v.jsxs("button",{onClick:()=>B(!0),className:"w-full p-4 flex items-center justify-between hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Zu,{className:"text-red-500",size:20}),v.jsxs("div",{className:"flex flex-col items-start",children:[v.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:"Delete Account"}),v.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Permanently delete your account and all data"})]})]}),v.jsx(zo,{className:"text-gray-400",size:18})]})]})]}),v.jsxs("div",{className:"text-center py-4",children:[v.jsxs("p",{className:"text-xs text-gray-400 dark:text-zinc-500",children:["Version ","1.5.2"," (PWA)"]}),"        "]}),Z&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Z.success?v.jsx(b1,{className:"text-green-500",size:24}):v.jsx(Zu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:Z.success?"Success":"Error"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:Z.message}),v.jsxs("div",{className:"flex gap-2",children:[Z.onRetry&&v.jsx("button",{onClick:()=>{K(null),Z.onRetry?.()},className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Retry"}),v.jsx("button",{onClick:()=>K(null),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Close"})]})]})}),v.jsx(Ote,{isVisible:Q,onClose:()=>re(!1),onConfirm:ke,currentMonth:m,incomeCount:(h[m]||[]).length,totalIncome:(h[m]||[]).reduce((Ee,Ne)=>Ee+Ne.amount,0),allocationCount:(p[m]||[]).filter(Ee=>t.some(Ne=>Ne.id===Ee.envelopeId)).length,totalAllocated:(p[m]||[]).filter(Ee=>t.some(Ne=>Ne.id===Ee.envelopeId)).reduce((Ee,Ne)=>Ee+Ne.budgetedAmount,0),transactionCount:r.filter(Ee=>Ee.month===m).length,totalTransactionAmount:r.filter(Ee=>Ee.month===m).reduce((Ee,Ne)=>Ee+Ne.amount,0)}),V&&v.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-6 max-w-sm w-full",children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[v.jsx(Zu,{className:"text-red-500",size:24}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Account"})]}),v.jsx("p",{className:"text-gray-600 dark:text-zinc-300 mb-4",children:"This action cannot be undone. This will permanently delete your account and remove all data from our servers."}),v.jsx("input",{type:"password",value:I,onChange:Ee=>k(Ee.target.value),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 mb-4"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{B(!1),k("")},className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-zinc-700 text-gray-900 dark:text-white rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-zinc-600 transition-colors",children:"Cancel"}),v.jsx("button",{onClick:Pe,disabled:z||!I.trim(),className:"flex-1 py-2 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:z?"Deleting...":"Delete Account"})]})]})})]})]})},jte=()=>{const{addEnvelope:n,setEnvelopeAllocation:e,currentMonth:t}=Pn(),{showToast:r}=Ws(),i=qs(),[a]=qz(),[o,c]=U.useState(""),u=a.get("type")==="piggybank",[d,h]=U.useState(""),[p,m]=U.useState(""),[b,_]=U.useState("#3B82F6"),[w,S]=U.useState(!1),T=async C=>{if(C.preventDefault(),!o.trim()||w)return;S(!0);const D=Pn.getState().envelopes,j=(D.length>0?Math.max(...D.map(k=>k.orderIndex??0)):-1)+1,z=u?new Date(`${t}-01T00:00:00`):new Date,A={name:o,currentBalance:0,lastUpdated:new Date().toISOString(),createdAt:z.toISOString(),isActive:!0,orderIndex:j};if(u){A.isPiggybank=!0;const k={monthlyContribution:parseFloat(p||"0"),color:b,icon:"piggy-bank"};d&&parseFloat(d)>0&&(k.targetAmount=parseFloat(d)),A.piggybankConfig=k}n(A).then(k=>{if(k){const V=u?parseFloat(p||"0"):0;e(k,V).catch(B=>console.error("Failed to create allocation:",B)),setTimeout(()=>{i("/")},50)}}).catch(k=>{console.error("Failed to create envelope:",k),r(k.message||"Failed to create envelope","error"),S(!1)})};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))]",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-10 flex items-center shadow-sm",children:[v.jsx("button",{onClick:()=>i("/"),className:"mr-3 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-white",children:v.jsx(ad,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:u?"New Piggybank":"New Envelope"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:[v.jsx("div",{className:"p-6 bg-blue-50 dark:bg-zinc-800 border-b border-blue-100 dark:border-zinc-700 flex justify-center py-8",children:v.jsx("div",{className:"w-20 h-20 bg-blue-100 dark:bg-zinc-700 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center",children:u?v.jsx(yc,{size:40}):v.jsx(VL,{size:40})})}),v.jsxs("form",{onSubmit:T,className:"p-6 space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:u?"Piggybank Name":"Envelope Name"}),v.jsx("input",{type:"text",id:"name",value:o,onChange:C=>c(C.target.value),placeholder:u?"e.g. Vacation Fund, Emergency Savings":"e.g. Groceries, Rent, Fun Money",className:"w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",autoFocus:!0,required:!0})]}),u&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"monthly-contribution",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Monthly Auto-Contribution *"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"monthly-contribution",value:p,onChange:C=>m(C.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",required:u})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"This amount will be automatically added each month and deducted from Available to Budget"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Target Goal (Optional)"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-zinc-500 font-semibold",children:"$"}),v.jsx("input",{type:"number",id:"target-amount",value:d,onChange:C=>h(C.target.value),placeholder:"0.00",step:"0.01",min:"0",className:"w-full pl-8 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-zinc-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"})]}),v.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-500",children:"Set a savings goal to track progress"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Color"}),v.jsx("div",{className:"grid grid-cols-6 gap-2",children:[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#F59E0B",label:"Amber"},{value:"#EF4444",label:"Red"},{value:"#8B5CF6",label:"Purple"},{value:"#EC4899",label:"Pink"}].map(C=>v.jsx("button",{type:"button",onClick:()=>_(C.value),className:`w-full aspect-square rounded-lg transition-all ${b===C.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-zinc-900":"hover:scale-110"}`,style:{backgroundColor:C.value},title:C.label},C.value))})]})]}),v.jsxs("div",{className:"pt-4 flex gap-3",children:[v.jsx("button",{type:"button",onClick:()=>i("/"),className:"flex-1 py-3 px-4 rounded-xl border border-gray-200 dark:border-zinc-700 text-gray-600 dark:text-zinc-400 font-semibold bg-white dark:bg-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 transition-colors",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:!o.trim()||u&&!p||w,className:`flex-1 py-3 px-4 rounded-xl font-semibold shadow-sm text-white transition-colors ${o.trim()&&(!u||p)&&!w?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600":"bg-gray-300 dark:bg-zinc-600 cursor-not-allowed"}`,children:w?"Creating...":u?"Create Piggybank":"Create Envelope"})]})]})]})})]})},zte=({envelopes:n,transactionAmount:e,onSplitChange:t})=>{const[r,i]=U.useState([]),[a,o]=U.useState({}),[c,u]=U.useState(e),d=_=>{i(w=>w.includes(_)?w.filter(S=>S!==_):[...w,_])},h=(_,w)=>{o(S=>({...S,[_]:w}))};U.useEffect(()=>{if(r.length===1){const _=r[0];o({[_]:e})}},[r.length,e]),U.useEffect(()=>{const _=Object.values(a).reduce((w,S)=>w+(S||0),0);u(e-_),t(a)},[a,e,t]),U.useEffect(()=>{const _={...a};Object.keys(_).forEach(w=>{r.includes(w)||delete _[w]}),Object.keys(_).length!==Object.keys(a).length&&o(_)},[r,a]);const p=()=>{i([]),o({})},m=Math.abs(c)<.01&&r.length>0,b=r.length>0&&Math.abs(c)>.01;return v.jsxs("div",{className:"space-y-3",children:[r.length>1&&v.jsxs("div",{className:`p-3 rounded-lg ${b?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":m?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700"}`,children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Remaining to Split:"}),v.jsxs("span",{className:`font-bold text-lg ${b?"text-red-600 dark:text-red-400":m?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-white"}`,children:["$",c.toFixed(2)]})]}),b&&v.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Split amounts must equal transaction total"})]}),v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("label",{className:"text-xs text-gray-500 dark:text-zinc-400",children:r.length>1?"Split Across Envelopes":"Select Envelope"}),r.length>0&&v.jsx("button",{type:"button",onClick:p,className:"text-xs text-blue-600 dark:text-blue-400",children:"Clear All"})]}),v.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 dark:border-zinc-800 rounded-lg",children:n.map(_=>v.jsxs("div",{className:"flex items-center py-3 px-3 border-b border-gray-100 dark:border-zinc-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors",children:[v.jsx("input",{type:"checkbox",checked:r.includes(_.id),onChange:()=>d(_.id),className:"mr-3 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),v.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:_.name}),r.includes(_.id)&&r.length>1&&v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"mr-1 text-gray-500 dark:text-zinc-400",children:"$"}),v.jsx("input",{type:"number",min:"0",step:"0.01",value:a[_.id]||"",onChange:w=>h(_.id,parseFloat(w.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 dark:border-zinc-700 rounded bg-white dark:bg-zinc-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]},_.id))})]})},Aj=({onClose:n,onSaved:e})=>{const t=qs(),{envelopes:r,addTransaction:i,currentMonth:a}=Pn(),[o,c]=U.useState(""),[u,d]=U.useState(""),[h,p]=U.useState(""),[m,b]=U.useState(new Date().toISOString().split("T")[0]),[_,w]=U.useState("expense"),[S,T]=U.useState({}),[C,D]=U.useState(null),[M,j]=U.useState(!1),z=()=>{if(n){n();return}t(-1)},A=K=>{D(K),C&&j(!0)},I=Object.keys(S).length>0,k=Object.values(S).reduce((K,H)=>K+(H||0),0),V=Math.abs(k-parseFloat(o||"0"))<.01,B=o&&parseFloat(o)>0&&I&&V,L=async K=>{if(K.preventDefault(),!B)return;const[H,$,Q]=m.split("-").map(Number),re=new Date(H,$-1,Q,12,0,0);console.log(" Selected date:",m),console.log(" Parsed date:",re.toISOString());try{const[ue,G]=m.split("-").map(Number),Y=`${ue}-${G.toString().padStart(2,"0")}`;if(Y!==a){const te=`This transaction date (${Y}) does not match the current budget month (${a}). Are you sure you want to save it?`;if(!window.confirm(te))return}const ne=Object.entries(S).filter(([te,ce])=>ce>0);Promise.all(ne.map(([te,ce])=>i({amount:ce,description:h,merchant:u||void 0,date:re.toISOString(),envelopeId:te,type:_==="income"?"Income":"Expense",reconciled:!1,paymentMethod:C||void 0}).catch(fe=>console.error("Failed to create transaction:",fe)))).catch(te=>console.error("Failed to create transactions:",te)),e&&e(),n?n():t("/")}catch(ue){console.error("Error saving transaction:",ue),alert("Failed to save transaction: "+(ue instanceof Error?ue.message:"Unknown error"))}},P=[...r].filter(K=>K.isActive!==!1).sort((K,H)=>{const $=K.orderIndex??0,Q=H.orderIndex??0;return $!==Q?$-Q:K.name.localeCompare(H.name)}),Z=_==="income"?"text-green-500":"text-red-500";return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b border-gray-200 dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+6px)] pb-2 sticky top-0 z-10 flex items-center justify-between",children:[v.jsx("button",{onClick:z,className:"text-blue-600 dark:text-blue-400 font-medium",children:"Cancel"}),v.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"New Transaction"}),v.jsx("button",{onClick:L,disabled:!B,className:"text-blue-600 dark:text-blue-400 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto pb-[calc(8rem+env(safe-area-inset-bottom))]",children:v.jsxs("form",{onSubmit:L,className:"space-y-6",children:[v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl border border-gray-200 dark:border-zinc-800 overflow-hidden",children:v.jsxs("div",{className:"flex",children:[v.jsx("button",{type:"button",onClick:()=>w("expense"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Expense"}),v.jsx("button",{type:"button",onClick:()=>w("income"),className:`flex-1 px-4 py-3 text-center font-medium transition-colors ${_==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-zinc-400 hover:bg-gray-50 dark:hover:bg-zinc-800"}`,children:"Income"})]})}),v.jsxs("div",{className:"text-center",children:[v.jsx("label",{className:"block text-sm text-gray-600 dark:text-zinc-400 mb-1",children:"Amount"}),v.jsxs("div",{className:"relative inline-block",children:[v.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full pr-2 text-2xl ${Z}`,children:"$"}),v.jsx("input",{type:"text",inputMode:"numeric",value:o,onChange:K=>{const H=K.target.value.replace(/\D/g,"");if(!H){c("");return}const Q=(parseInt(H,10)/100).toFixed(2);c(Q)},onKeyDown:K=>{(K.key==="e"||K.key==="E"||K.key==="+"||K.key==="-")&&K.preventDefault()},placeholder:"0.00",autoFocus:!0,className:`bg-transparent text-4xl font-bold text-center w-40 focus:outline-none ${Z} placeholder-gray-700`})]})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Merchant"}),v.jsx("input",{type:"text",value:u,onChange:K=>d(K.target.value),placeholder:"Where did you make this transaction?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsx(Ej,{selectedCard:C,onCardSelect:A,isUserSelected:M}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400 mb-1",children:"Note"}),v.jsx("input",{type:"text",value:h,onChange:K=>p(K.target.value),placeholder:"What is this for?",className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none"})]}),v.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors",children:[v.jsxs("div",{className:"flex justify-between items-center mb-1",children:[v.jsx("label",{className:"block text-xs text-gray-500 dark:text-zinc-400",children:"Date"}),(()=>{const[K,H]=m.split("-").map(Number);return`${K}-${H.toString().padStart(2,"0")}`!==a?v.jsxs("div",{className:"flex items-center text-amber-500 gap-1",title:"Date is outside current budget month",children:[v.jsx(Zu,{size:14}),v.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Budget Mismatch"})]}):null})()]}),v.jsx("input",{type:"date",value:m,onChange:K=>b(K.target.value),className:"w-full bg-transparent text-gray-900 dark:text-white focus:outline-none [color-scheme:dark]"})]}),v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-lg p-3 border border-gray-200 dark:border-zinc-800 transition-colors",children:v.jsx(zte,{envelopes:P,transactionAmount:parseFloat(o)||0,onSplitChange:T})})]})})]})},Lte=()=>{const n=qs(),{transactions:e,envelopes:t,updateTransaction:r,deleteTransaction:i,restoreTransaction:a,currentMonth:o}=Pn(),{showToast:c}=Ws(),[u,d]=U.useState(!1),[h,p]=U.useState(""),[m,b]=U.useState("all"),[_,w]=U.useState("All"),[S,T]=U.useState(!1),[C,D]=U.useState("all"),[M,j]=U.useState(!1),[z,A]=U.useState("all"),[I,k]=U.useState(()=>{const $=new Date;return $.setMonth($.getMonth()-1),$.toISOString().split("T")[0]}),[V,B]=U.useState(()=>new Date().toISOString().split("T")[0]),[L,P]=U.useState(null),Z=U.useMemo(()=>{console.log(" Filtering transactions:",{totalTransactions:e.length,showAllTime:M,currentMonth:o,transactionMonths:e.map(re=>({id:re.id,month:re.month,date:re.date,description:re.description}))});let $=e;return M||($=e.filter(re=>re.month===o||!re.month),console.log(" After month filter:",{remaining:$.length,currentMonth:o,filteredTransactions:$.map(re=>({id:re.id,description:re.description,month:re.month,matchesCurrentMonth:re.month===o}))})),$.map(re=>{if(!re)return null;let ue=re.date;if(typeof re.date=="number"){const Y=(re.date+978307200)*1e3;ue=new Date(Y).toISOString()}else if(!re.date||typeof re.date!="string")return null;return{...re,date:ue}}).filter(Boolean).filter(re=>{if(h){const G=h.toLowerCase(),Y=t.find(ce=>ce.id===re.envelopeId)?.name.toLowerCase()||"",ne=re.amount.toFixed(2);if(!(re.description.toLowerCase().includes(G)||Y.includes(G)||ne.includes(G)))return!1}if(m!=="all"&&re.envelopeId!==m||_!=="All"&&re.type!==_||z!=="all"&&(!re.paymentMethod||re.paymentMethod.id!==z)||!re.date||typeof re.date!="string")return!1;const ue=re.date.split("T")[0];return!(C!=="all"&&new Date(ue).getMonth()!==parseInt(C)||S&&!re.reconciled)}).sort((re,ue)=>new Date(ue.date).getTime()-new Date(re.date).getTime())},[e,t,h,m,_,z,I,V,S,M,o]);console.log(" Final filtered transactions:",{count:Z.length,transactions:Z.map($=>({id:$.id,description:$.description,amount:$.amount,date:$.date,month:$.month,type:$.type}))});const K=L?t.find($=>$.id===L.envelopeId):null,H=$=>{const Q={...$,reconciled:!$.reconciled};r(Q)};return v.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black pb-[calc(8rem+env(safe-area-inset-bottom))] transition-colors duration-200",children:[v.jsxs("header",{className:"bg-white dark:bg-black border-b dark:border-zinc-800 px-4 pt-[calc(env(safe-area-inset-top)+12px)] pb-3 sticky top-0 z-20 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:()=>n(-1),className:"mr-3 text-gray-600 hover:text-gray-900 dark:text-zinc-400 dark:hover:text-white transition-colors",children:v.jsx(ad,{size:24})}),v.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"All Transactions"})]}),v.jsx("button",{onClick:()=>d(!u),className:`p-2 rounded-full transition-colors ${u?"bg-blue-100 text-blue-600 dark:bg-blue-900/40 dark:text-blue-400":"text-gray-400 dark:text-zinc-600 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:v.jsx(zL,{size:20,className:u?"fill-current":""})})]}),v.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 flex justify-between items-center",children:[v.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:["Month: ",o]}),v.jsx("button",{onClick:()=>j(!M),className:`text-sm px-3 py-1 rounded-md ${M?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-zinc-800 dark:text-zinc-300"}`,children:M?"Current Month Only":"All Time"})]}),v.jsx("div",{className:"px-4 py-3 bg-white dark:bg-zinc-900 border-b dark:border-zinc-800",children:v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Payment Method"}),v.jsxs("select",{value:z,onChange:$=>A($.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Payment Methods"}),[{id:"1",name:"Amazon Prime",network:"Visa",last4:"7474",color:"#232f3e"},{id:"2",name:"Apple Card",network:"Mastercard",last4:"0274",color:"#e3e3e3"},{id:"3",name:"AA Credit Union",network:"Visa",last4:"3386",color:"#5494DA"}].map($=>v.jsx("option",{value:$.id,children:$.name},$.id))]})]})}),v.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-white dark:bg-zinc-900 border-b dark:border-zinc-800 ${u?"max-h-[500px] opacity-100":"max-h-0 opacity-0"}`,children:v.jsxs("div",{className:"p-4 space-y-4",children:[v.jsxs("div",{className:"relative",children:[v.jsx(a9,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),v.jsx("input",{type:"text",placeholder:"Search transactions...",value:h,onChange:$=>p($.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none dark:text-white"}),h&&v.jsx("button",{onClick:()=>p(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:v.jsx(xv,{size:16})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Envelope"}),v.jsxs("select",{value:m,onChange:$=>b($.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Envelopes"}),t.sort(($,Q)=>$.name.localeCompare(Q.name)).map($=>v.jsx("option",{value:$.id,children:$.name},$.id))]})]}),v.jsx("div",{className:"bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg flex",children:["All","Income","Expense"].map($=>v.jsx("button",{onClick:()=>w($),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${_===$?"bg-white dark:bg-zinc-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 dark:text-zinc-500 hover:text-gray-700"}`,children:$},$))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Month"}),v.jsxs("select",{value:C,onChange:$=>D($.target.value),className:"w-full p-2 rounded-lg bg-gray-100 dark:bg-zinc-800 border-r-8 border-transparent text-sm dark:text-white outline-none",children:[v.jsx("option",{value:"all",children:"All Months"}),Array.from({length:12},($,Q)=>Q).map($=>v.jsx("option",{value:$,children:new Date(2022,$).toLocaleString("default",{month:"long"})},$))]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"From"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:I,onChange:$=>k($.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"To"}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"date",value:V,onChange:$=>B($.target.value),className:"w-full p-2 bg-gray-100 dark:bg-zinc-800 rounded-lg text-sm dark:text-white outline-none [color-scheme:light] dark:[color-scheme:dark]"})})]})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show only reconciled"}),v.jsx("button",{onClick:()=>T(!S),className:`w-11 h-6 rounded-full transition-colors relative ${S?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${S?"translate-x-5":"translate-x-0"}`})})]}),v.jsxs("div",{className:"flex items-center justify-between pt-2",children:[v.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300",children:"Show all time"}),v.jsx("button",{onClick:()=>j(!M),className:`w-11 h-6 rounded-full transition-colors relative ${M?"bg-green-500":"bg-gray-300 dark:bg-zinc-700"}`,children:v.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${M?"translate-x-5":"translate-x-0"}`})})]})]})}),v.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:v.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:Z.length===0?v.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-500",children:"No transactions match your filters."}):v.jsx(Jr,{initial:!1,mode:"popLayout",children:Z.map($=>{const Q=t.find(re=>re.id===$.envelopeId);return v.jsx(Wn.div,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:v.jsx(gy,{onDelete:()=>{if(!$.id)return;const re={...$};i($.id),c("Transaction deleted","neutral",()=>a(re))},children:v.jsx(Tj,{transaction:$,envelopeName:Q?.name||"Unknown Envelope",onReconcile:()=>H($),onEdit:()=>{Q?P($):alert("Cannot edit: Envelope deleted.")}})})},$.id)})})})}),v.jsx(Sj,{isVisible:!!L&&!!K,onClose:()=>P(null),mode:"edit",currentEnvelope:K||{},initialTransaction:L})]})},$l=({children:n})=>v.jsx(Wn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},className:"w-full h-full bg-gray-50 dark:bg-black",children:n}),Bte=()=>{const n=va();return v.jsx(Jr,{mode:"wait",children:v.jsxs(pz,{location:n,children:[v.jsx(jo,{path:"/",element:v.jsx($l,{children:v.jsx(La,{children:v.jsx(Ite,{})})})}),v.jsx(jo,{path:"/envelope/:id",element:v.jsx($l,{children:v.jsx(La,{children:v.jsx(Pte,{})})})}),v.jsx(jo,{path:"/add-envelope",element:v.jsx($l,{children:v.jsx(La,{children:v.jsx(jte,{})})})}),v.jsx(jo,{path:"/add-transaction",element:v.jsx($l,{children:v.jsx(La,{children:v.jsx(Aj,{})})})}),v.jsx(jo,{path:"/transactions",element:v.jsx($l,{children:v.jsx(La,{children:v.jsx(Lte,{})})})}),v.jsx(jo,{path:"/settings",element:v.jsx($l,{children:v.jsx(La,{children:v.jsx(Vte,{})})})}),v.jsx(jo,{path:"/verify-email",element:v.jsx($l,{children:v.jsx(La,{children:v.jsx(MO,{})})})})]},n.pathname)})};function Ute(){const[n,e]=U.useState(!0),[t,r]=U.useState(!1),{appSettings:i}=Pn(),{isAuthenticated:a,isInitialized:o,initializeAuth:c,lastAuthTime:u,offlineGracePeriod:d,currentUser:h}=ca();if(U.useEffect(()=>{const b=setTimeout(()=>{e(!1)},2e3);return()=>clearTimeout(b)},[]),U.useEffect(()=>c(),[c]),U.useEffect(()=>{const b=document.documentElement,_=window.matchMedia("(prefers-color-scheme: dark)"),w=()=>{const S=i?.theme??"system",T=_.matches;S==="dark"||S==="system"&&T?b.classList.add("dark"):b.classList.remove("dark")};if(w(),i?.theme==="system")return _.addEventListener("change",w),()=>_.removeEventListener("change",w)},[i]),n||!o)return v.jsx(PO,{message:"Initializing Personal Budget..."});if(!a)return h?v.jsx(La,{children:v.jsx(MO,{})}):v.jsx(La,{children:v.jsx(mH,{})});const m=typeof navigator<"u"&&!navigator.onLine&&a&&u&&Date.now()-u<d;return v.jsxs(La,{children:[m&&v.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 text-yellow-700 dark:text-yellow-200 p-4",children:v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),v.jsx("div",{className:"ml-3",children:v.jsxs("p",{className:"text-sm",children:[v.jsx("strong",{children:"Offline Access:"})," You're using cached authentication. Expires in"," ",Math.ceil((d-(Date.now()-u))/(1440*60*1e3))," ","days. Connect to internet to refresh."]})})]})}),v.jsxs(Lz,{children:[v.jsx(Bte,{}),t&&v.jsxs("div",{className:"fixed inset-0 z-[60]",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>r(!1)}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(Aj,{onClose:()=>r(!1),onSaved:()=>r(!1)})})]}),v.jsx(dW,{onAddTransaction:()=>r(!0)})]}),v.jsx(eW,{})]})}m6({onNeedRefresh(){},onOfflineReady(){console.log("App is ready for offline work")}});h6.createRoot(document.getElementById("root")).render(v.jsx(U.StrictMode,{children:v.jsx(Ute,{})}));export{_t as T,xt as a,uH as b,DR as c,Ut as d,Oi as e,Ba as f,Px as g,Ua as h,Vp as o,Ls as q,za as s,Ql as t,sa as u,sH as w};
